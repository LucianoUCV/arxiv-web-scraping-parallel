<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations</title>
<!--Generated on Mon May 26 12:14:12 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.19888v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S1" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S2" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Domain Generalization and Domain Adaptation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Transformation with Orthogonality.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S2.SS0.SSS0.Px3" title="In 2 Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Black-Box Foundation Model and Federated Learning.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS1" title="In 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Generalization and Personalization in FL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS2" title="In 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Global and Local Parameters</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS2.SSS0.Px1" title="In 3.2 Global and Local Parameters ‣ 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Orthogonal Transformations.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS3" title="In 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Parameter Update</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS3.SSS0.Px1" title="In 3.3 Parameter Update ‣ 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Algorithm of FedOT.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS4" title="In 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Protecting Proprietary Models and Data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Theoretical Analysis of FedOT</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.SS1" title="In 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Bounding the Gradient Difference Between Clients</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.SS1.SSS0.Px1" title="In 4.1 Bounding the Gradient Difference Between Clients ‣ 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Implications.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.SS2" title="In 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Benefits of Orthogonal Transformations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.SS2.SSS0.Px1" title="In 4.2 Benefits of Orthogonal Transformations ‣ 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Geometric and Semantic Advantages.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.SS3" title="In 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Block-Diagonal Orthogonal Transformations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS1" title="In 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS1.SSS0.Px1" title="In 5.1 Setup ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Datasets &amp; Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS1.SSS0.Px2" title="In 5.1 Setup ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS2" title="In 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS2.SSS0.Px1" title="In 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Effectiveness of FedOT.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS2.SSS0.Px2" title="In 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">DOF and Personalization via FedOT(+B).</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS2.SSS0.Px3" title="In 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Condition Number and Generalization.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3" title="In 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3.SSS0.Px1" title="In 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Global and Local Parameters.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3.SSS0.Px2" title="In 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Towards Vision Foundation Models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3.SSS0.Px3" title="In 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Robustness to Communication Rounds.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3.SSS0.Px4" title="In 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Multi-Client Scenario.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S6" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Limitations and Future Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S7" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A1" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A1.SS1" title="In Appendix A Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Foundation Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A1.SS2" title="In Appendix A Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Federated Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A2" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A2.SS1" title="In Appendix B Preliminaries ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Contrastive Language-Image Pretraining (CLIP)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A2.SS2" title="In Appendix B Preliminaries ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Federated Learning Setting</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A3" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>FedOT</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A3.SS1" title="In Appendix C FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Detailed of Parameter Update.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A3.SS2" title="In Appendix C FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Cayley Transform</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A3.SS2.SSS0.Px1" title="In C.2 Cayley Transform ‣ Appendix C FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">The process of the Cayley Transform.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A3.SS2.SSS0.Px2" title="In C.2 Cayley Transform ‣ Appendix C FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title">Differentiability of the Cayley Transform.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A4" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Comparison of Learning Frameworks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Theoretical Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS1" title="In Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>Gradient Analysis with a Linear <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline"><semantics><msubsup><mi>w</mi><mi mathvariant="normal">l</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">superscript</csymbol><apply><csymbol cd="ambiguous">subscript</csymbol><ci>𝑤</ci><ci>l</ci></apply><ci>𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS2" title="In Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>Bounding the Gradient Difference</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS3" title="In Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3 </span>Generalizing to Prompt Learning with <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline"><semantics><msup><mi>𝐩</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">superscript</csymbol><ci>𝐩</ci><ci>𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS3.SSS1" title="In E.3 Generalizing to Prompt Learning with 𝐩^(𝑖) ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3.1 </span>Gradient via Chain Rule</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS3.SSS2" title="In E.3 Generalizing to Prompt Learning with 𝐩^(𝑖) ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3.2 </span>Bounding the Gradient Difference in <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline"><semantics><msup><mi>𝐩</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">superscript</csymbol><ci>𝐩</ci><ci>𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>-Space</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS4" title="In Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4 </span>Degree of Freedom in Orthogonal and Block-Orthogonal Transformations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS4.SSS1" title="In E.4 Degree of Freedom in Orthogonal and Block-Orthogonal Transformations ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4.1 </span>DOF in a General Orthogonal Transformation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS4.SSS2" title="In E.4 Degree of Freedom in Orthogonal and Block-Orthogonal Transformations ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4.2 </span>DOF in a Block-Orthogonal Transformation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS4.SSS3" title="In E.4 Degree of Freedom in Orthogonal and Block-Orthogonal Transformations ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4.3 </span>Condition Number of a Orthogonal Transformation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS1" title="In Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS1.SSS1" title="In F.1 Setup ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1.1 </span>Datasets &amp; Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS1.SSS2" title="In F.1 Setup ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1.2 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS2" title="In Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS2.SSS1" title="In F.2 Results ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2.1 </span>Generalization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS2.SSS2" title="In F.2 Results ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2.2 </span>Personalization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS2.SSS3" title="In F.2 Results ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2.3 </span>Comprehensive</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A7" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Ablation</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A7.SS1" title="In Appendix G Ablation ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.1 </span>Robustness to Communication Rounds.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A7.SS2" title="In Appendix G Ablation ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G.2 </span>Multi-Client Scenario</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A8" title="In Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H </span>Social Impact</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Generalized and Personalized Federated Learning with Foundation Models
<br class="ltx_break"/>via Orthogonal Transformations</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Eun Gyung Kong  Je Won Yeom<sup class="ltx_sup" id="id2.2.id1">∗</sup>  Yonghoon Jeon  Taesup Kim 
<br class="ltx_break"/>Graduate School of Data Science, Seoul National University
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Equal contribution.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">Federated Learning (FL) aims to train models across decentralized clients or devices holding local data without the need for centralized data collection, thus enhancing data privacy and security.
However, achieving both generalization and personalization in heterogeneous settings remains a significant challenge.
To address this, we introduce FedOT, a novel approach that leverages black-box foundation models.
FedOT shares only a global task-dependent classifier across clients while locally adapting features through orthogonal transformations.
By enforcing orthogonality, FedOT mitigates gradient conflicts across diverse clients, preserves semantic integrity, and achieves robust performance even in the presence of substantial data heterogeneity.
The strategy of combining global and local parameters enables a more balanced approach for both generalization and personalization, outperforming baseline FL methods across multiple benchmarks.
Furthermore, our extensive analysis confirms that joint optimization of global classifiers and local orthogonal transformations yields superior performance and suggests broader applicability.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The advancement of deep learning has underscored the importance of leveraging large-scale datasets, yet data collection is often constrained by privacy and security concerns.
Federated Learning (FL) offers a promising alternative by enabling decentralized model training across distributed clients without requiring centralized data aggregation <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">RN705</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">RN706</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">mcmahan2017communication</span> </a></cite>.
The primary objective of FL is to develop a unified and generalized model that performs well across all participating clients.
Furthermore, the goal of generalization within FL extends to learning a shared model that remains effective not only for current clients but also for future, unseen ones.
However, variations in data distributions across clients (i.e., the non-IID setting) often necessitate personalized models rather than relying solely on a single generalized model.
This requirement is particularly critical in domains such as healthcare <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">lu2022personalized</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">chen2023metafed</span> </a></cite> and recommendation systems <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib76" title=""><span class="ltx_text" style="font-size:90%;">wu2021hierarchical</span> </a></cite>, where personalized models trained through FL are essential to provide high-quality services.
As a result, there is a growing demand for FL models that effectively balance generalization and personalization.
Despite this need, most existing approaches tend to prioritize one aspect over the other.
Achieving this balance within the FL framework presents a significant challenge, akin to simultaneously addressing domain generalization and domain adaptation.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="181" id="S1.F1.g1" src="extracted/6479317/figures/overview.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.3.1">Overview of our proposed FL framework.</span> <span class="ltx_text ltx_font_smallcaps" id="S1.F1.4.2">FedOT</span> leverages the pre-trained vision encoder into an FL environment. The image encoder, deployed in binary or embedded formats, operates with orthogonal transformation used in the local parameters for client-specific personalization, while holding a globally shared classifier. Through federated updates, our method strikes a balance between personalization and generalization, preserving both data privacy and model intellectual property.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, foundation models <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">Bommasani2021FM</span> </a></cite>, including pre-trained vision models and vision-language models (VLMs), have demonstrated strong generalization capabilities, exhibiting promising scalability and performance across various vision downstream tasks.
This makes the integration of foundation models into FL particularly compelling.
For instance, encoders from VLMs, such as CLIP <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">RN568</span> </a></cite>, possess inherent zero-shot capabilities and strong generalization, which can significantly enhance the efficiency of FL.
Inspired by this potential, in this paper, we tackle key challenges in FL by leveraging a pre-trained foundation model, specifically the vision encoder from CLIP, with the goal of simultaneously achieving both generalization and personalization.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We propose <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1">FedOT</span>, a simple yet effective FL framework in which clients share and communicate only a task-dependent classifier while locally transforming visual features using orthogonal transformations instead of fine-tuning the vision encoder’s parameters.
This approach enables a FL on black-box foundation model, ensuring both model security from the server’s perspective (as the model provider) and data security from the clients’ perspective (as data providers) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib77" title=""><span class="ltx_text" style="font-size:90%;">xiao2023offsite</span> </a></cite>.
Unlike existing methods <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">RN683</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">RN682</span> </a></cite>, which require access to the model architecture and involve modifying the internal parameters of pre-trained models, our method modifies only the final visual feature space through orthogonal transformations. Crucially, orthogonal transformations allow <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.2">FedOT</span> to mitigate gradient conflicts across heterogeneous clients, preserve the semantic properties of foundation model representations, and maintain robust performance even under significant data heterogeneity.
Notably, we show that orthogonal transformations, which are linear feature transformations with a condition number of 1 (<math alttext="\kappa=1" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mrow id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">κ</mi><mo id="S1.p3.1.m1.1.1.1" xref="S1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><eq id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1"></eq><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝜅</ci><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\kappa=1</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_κ = 1</annotation></semantics></math>), achieve the smallest upper bound on gradient discrepancy across clients, thereby enhancing generalization.
Our extensive evaluation demonstrates that <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.3">FedOT</span> consistently delivers strong personalization performance and confirms that orthogonality provides better generalization than unconstrained linear transformations.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The contributions of our framework can be summarized in three ways:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">To the best of our knowledge, this work is the first to demonstrate the effectiveness of Orthogonal Transformation in mitigating gradient conflicts within the context of FL. We leverage this property to efficiently harness the generalization capabilities of foundation models while simultaneously adapting client models to their unique data distributions for personalization.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Additionally, our framework integrates orthogonal transformations with a pre-trained image encoder (i.e., a vision foundation model), ensuring secure operation in FL environments. This design safeguards the intellectual property of the foundation model provider (server) while simultaneously protecting the data privacy of the participants (clients).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Our framework is built upon rigorous theoretical analysis and validated through extensive empirical evaluations. It consistently surpasses existing approaches in terms of generalization, personalization, and comprehensive performance, demonstrating its broad applicability across diverse datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we introduce three key topics. A more comprehensive discussion of related works on foundation models and federated learning is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A1" title="Appendix A Related Work ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Domain Generalization and Domain Adaptation.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Domain Generalization (DG) and Domain Adaptation (DA) enhance model robustness to distribution shifts across related domains. DG trains on multiple source domains and must generalize to unseen targets without accessing their data during training <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">RN521</span> </a></cite>. State-of-the-art DG relies on domain-invariant representations <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib53" title=""><span class="ltx_text" style="font-size:90%;">RN650</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib54" title=""><span class="ltx_text" style="font-size:90%;">RN547</span> </a></cite>,
meta-learning schemes <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">RN536</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">RN654</span> </a></cite>, and data-augmentation generators that synthesize novel styles <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib68" title=""><span class="ltx_text" style="font-size:90%;">RN658</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib55" title=""><span class="ltx_text" style="font-size:90%;">Niemeijer2024</span> </a></cite>. DA, in contrast, fine-tunes source-pre-trained models using limited target data <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">RN528</span> </a></cite>. It spans supervised <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib73" title=""><span class="ltx_text" style="font-size:90%;">RN662</span> </a></cite>, unsupervised <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">RN672</span> </a></cite>, and semi-supervised <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib78" title=""><span class="ltx_text" style="font-size:90%;">RN667</span> </a></cite> settings, with methods broadly grouped into discrepancy-based <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib47" title=""><span class="ltx_text" style="font-size:90%;">RN668</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">Sun2016</span> </a></cite>, reconstruction-based <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">RN671</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">Bousmalis2017</span> </a></cite>, and adversarial-based <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib62" title=""><span class="ltx_text" style="font-size:90%;">RN673</span> </a></cite> approaches. Recent work blurs the DG/DA boundary by performing online test-time adaptation <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">Chen2023ITTA</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">RN656</span> </a></cite>. Yet most solutions still assume centralized data access, a limitation now challenged by Federated DG frameworks <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib82" title=""><span class="ltx_text" style="font-size:90%;">Zhang2023FedDG</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">Gong2024PLAN</span> </a></cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Transformation with Orthogonality.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Recent studies have explored methods that leverage orthogonality for fine-tuning pre-trained models.
<span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px2.p1.1.1">Pro<sup class="ltx_sup" id="S2.SS0.SSS0.Px2.p1.1.1.1"><span class="ltx_text ltx_font_upright" id="S2.SS0.SSS0.Px2.p1.1.1.1.1">2</span></sup></span> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">chen2023project</span> </a></cite> employs a linear projection with an orthonormal basis to map pre-trained embeddings from a source dataset onto orthogonal directions, ensuring label predictability.
This method then trains a linear classifier on the projected features using a small target dataset.
Similarly, Qiu and Liu <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">RN683</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">RN682</span> </a></cite> propose Orthogonal Fine-Tuning (OFT), which fine-tunes foundation models by reparameterizing pre-trained weights with orthogonal matrices instead of using LoRA <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">RN771</span> </a></cite> adapters.
They demonstrate that OFT preserves the semantics from foundation models by maintaining hyper-spherical energy, thus preventing the destruction of pre-trained information.
While OFT methods effectively adapt foundation models, they require access to the model architecture and involve modifications to the internal mechanisms of pre-trained models.
In contrast, our novel approach maps an orthogonal transformation externally to the encoder, transforming the embedding space while applying the black-box nature to the models.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Black-Box Foundation Model and Federated Learning.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Foundation models have achieved remarkable success in various domains <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">Bommasani2021FM</span> </a></cite>.
However, practical scenarios frequently enforce black-box interactions due to intellectual property protection, proprietary software policies, restrictions in API access, or privacy concerns <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">sun2022black</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib80" title=""><span class="ltx_text" style="font-size:90%;">yu2023black</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib59" title=""><span class="ltx_text" style="font-size:90%;">paranjape2024blackboxadapt</span> </a></cite>.
Common black-box adaptation methods include gradient-free prompt tuning techniques <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">sun2022black</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib80" title=""><span class="ltx_text" style="font-size:90%;">yu2023black</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">meng2025black</span> </a></cite>, the integration of external lightweight wrappers <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib57" title=""><span class="ltx_text" style="font-size:90%;">ormazabal2023comblm</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">cardiel2025llmwrapper</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib83" title=""><span class="ltx_text" style="font-size:90%;">zhang2022tip</span> </a></cite>, and embedding-based feature transformations relying solely on precomputed embeddings <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib58" title=""><span class="ltx_text" style="font-size:90%;">ouali2023blackboxfewshot</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib56" title=""><span class="ltx_text" style="font-size:90%;">oh2023blackvip</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib77" title=""><span class="ltx_text" style="font-size:90%;">xiao2023offsite</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">guo2024blackboxtuning</span> </a></cite>.
In Federated learning (FL), BlackFed <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib60" title=""><span class="ltx_text" style="font-size:90%;">paranjape2024federated</span> </a></cite> defines the concept of black-box FL, where clients interact with a global model solely through outputs of two-layer convolution network under strict black-box conditions, which focuses on model security, yet overlooks multi-client personalization challenges.
ZooPFL <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib50" title=""><span class="ltx_text" style="font-size:90%;">lu2024zoopfl</span> </a></cite> introduces black-box foundation FL, in distinction to black-box FL introduced in BlackFed <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib60" title=""><span class="ltx_text" style="font-size:90%;">paranjape2024federated</span> </a></cite>, addressing resource limitations and personalization by adapting inputs via zeroth-order optimization with black-box foundation models.
Meanwhile, our method uniquely employs orthogonal transformations fully decoupled from foundation models in FL, which precisely belongs to black-box foundation FL, effectively supporting both personalization and generalization.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We propose FedOT, a simple yet parameter-efficient approach for FL that preserves data privacy and protects proprietary foundation models while effectively enhancing both generalization and personalization.
By leveraging orthogonal transformations, our method enhances generalization across diverse clients while enabling local adaptation to non-IID data distributions.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Generalization and Personalization in FL</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We clarify the fundamental concepts of generalization and personalization in FL, with reference to FedCLIP <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">RN587</span> </a></cite>.
We consider an FL scenario where diverse clients with unique data distributions participate, emphasizing the need for personalization, while new, unseen clients are expected to join after the learning process concludes, underscoring the need for generalization.
Based on this premise, we aim to evaluate performance not only from the perspective of clients actively participating in FL but also in terms of its applicability to future, unseen clients.
This evaluation directly corresponds to personalization and generalization, respectively, highlighting their critical roles in assessing the FL model’s adaptability and robustness across diverse and evolving client environments.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Global and Local Parameters</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">FedOT integrates both global and local parameters within the FL setting, leveraging the generalization capabilities of pre-trained foundation models without requiring explicit fine-tuning of their internal parameters, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">1</span></a>.
Specifically, we assume a black-box vision foundation model shared across all clients, serving as a fixed image encoder.
In parallel, we introduce client-specific local parameters in the form of <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">orthogonal transformations</span> that personalize representations, leaving the underlying foundation model unchanged.
To support a vision downstream task, we introduce a <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.2">global classifier</span> collaboratively trained and shared among clients to enhance generalization.
While the classifier can be randomly initialized, it may also be initialized with text features from a vision-language model (VLM) like CLIP, to potentially improve performance.
This dual approach, jointly optimizing global and local parameters, strikes a balance between generalization across heterogeneous clients and personalization tailored to each client’s unique data distribution.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.11">The global parameters are represented by a task-dependent linear classifier <math alttext="w_{\mathrm{g}}\in\mathbb{R}^{K\times d}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p2.1.m1.1.1.2.3" mathvariant="normal" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.p2.1.m1.1.1.3.3.2.cmml">K</mi><mo id="S3.SS2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><in id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></in><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝑤</ci><ci id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3">g</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><times id="S3.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.2">𝐾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">w_{\mathrm{g}}\in\mathbb{R}^{K\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_K</annotation></semantics></math> and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_d</annotation></semantics></math> denote the number of classes and the dimensionality of the feature space, respectively.
As mentioned, they can be randomly initialized or derived from a set of class embeddings <math alttext="t=\{\mathcal{T}(p_{c})\}_{c=1}^{K}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">t</mi><mo id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.3.cmml">𝒯</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p2.4.m4.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.1.1.3.2.cmml">c</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.3.1" xref="S3.SS2.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p2.4.m4.1.1.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.4.m4.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><eq id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2"></eq><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑡</ci><apply id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1">subscript</csymbol><set id="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1"><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1"><times id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.2"></times><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.3">𝒯</ci><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></set><apply id="S3.SS2.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3"><eq id="S3.SS2.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS2.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3.2">𝑐</ci><cn id="S3.SS2.p2.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.4.m4.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">t=\{\mathcal{T}(p_{c})\}_{c=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_t = { caligraphic_T ( italic_p start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="p_{c}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">p</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑝</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">p_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_p start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is a class-specific text prompt and <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">caligraphic_T</annotation></semantics></math> is the text encoder of CLIP.
For each client <math alttext="i\in 1,2,\cdots N" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.3"><semantics id="S3.SS2.p2.7.m7.3a"><mrow id="S3.SS2.p2.7.m7.3.3" xref="S3.SS2.p2.7.m7.3.3.cmml"><mi id="S3.SS2.p2.7.m7.3.3.3" xref="S3.SS2.p2.7.m7.3.3.3.cmml">i</mi><mo id="S3.SS2.p2.7.m7.3.3.2" xref="S3.SS2.p2.7.m7.3.3.2.cmml">∈</mo><mrow id="S3.SS2.p2.7.m7.3.3.1.1" xref="S3.SS2.p2.7.m7.3.3.1.2.cmml"><mn id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">1</mn><mo id="S3.SS2.p2.7.m7.3.3.1.1.2" xref="S3.SS2.p2.7.m7.3.3.1.2.cmml">,</mo><mn id="S3.SS2.p2.7.m7.2.2" xref="S3.SS2.p2.7.m7.2.2.cmml">2</mn><mo id="S3.SS2.p2.7.m7.3.3.1.1.3" xref="S3.SS2.p2.7.m7.3.3.1.2.cmml">,</mo><mrow id="S3.SS2.p2.7.m7.3.3.1.1.1" xref="S3.SS2.p2.7.m7.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.7.m7.3.3.1.1.1.2" mathvariant="normal" xref="S3.SS2.p2.7.m7.3.3.1.1.1.2.cmml">⋯</mi><mo id="S3.SS2.p2.7.m7.3.3.1.1.1.1" xref="S3.SS2.p2.7.m7.3.3.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.7.m7.3.3.1.1.1.3" xref="S3.SS2.p2.7.m7.3.3.1.1.1.3.cmml">N</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.3b"><apply id="S3.SS2.p2.7.m7.3.3.cmml" xref="S3.SS2.p2.7.m7.3.3"><in id="S3.SS2.p2.7.m7.3.3.2.cmml" xref="S3.SS2.p2.7.m7.3.3.2"></in><ci id="S3.SS2.p2.7.m7.3.3.3.cmml" xref="S3.SS2.p2.7.m7.3.3.3">𝑖</ci><list id="S3.SS2.p2.7.m7.3.3.1.2.cmml" xref="S3.SS2.p2.7.m7.3.3.1.1"><cn id="S3.SS2.p2.7.m7.1.1.cmml" type="integer" xref="S3.SS2.p2.7.m7.1.1">1</cn><cn id="S3.SS2.p2.7.m7.2.2.cmml" type="integer" xref="S3.SS2.p2.7.m7.2.2">2</cn><apply id="S3.SS2.p2.7.m7.3.3.1.1.1.cmml" xref="S3.SS2.p2.7.m7.3.3.1.1.1"><times id="S3.SS2.p2.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.3.3.1.1.1.1"></times><ci id="S3.SS2.p2.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.3.3.1.1.1.2">⋯</ci><ci id="S3.SS2.p2.7.m7.3.3.1.1.1.3.cmml" xref="S3.SS2.p2.7.m7.3.3.1.1.1.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.3c">i\in 1,2,\cdots N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.3d">italic_i ∈ 1 , 2 , ⋯ italic_N</annotation></semantics></math>, the local parameters <math alttext="w_{\mathrm{l}}^{(i)}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mrow id="S3.SS2.p2.8.m8.1.2" xref="S3.SS2.p2.8.m8.1.2.cmml"><msubsup id="S3.SS2.p2.8.m8.1.2.2" xref="S3.SS2.p2.8.m8.1.2.2.cmml"><mi id="S3.SS2.p2.8.m8.1.2.2.2.2" xref="S3.SS2.p2.8.m8.1.2.2.2.2.cmml">w</mi><mi id="S3.SS2.p2.8.m8.1.2.2.2.3" mathvariant="normal" xref="S3.SS2.p2.8.m8.1.2.2.2.3.cmml">l</mi><mrow id="S3.SS2.p2.8.m8.1.1.1.3" xref="S3.SS2.p2.8.m8.1.2.2.cmml"><mo id="S3.SS2.p2.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.8.m8.1.2.2.cmml">(</mo><mi id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p2.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS2.p2.8.m8.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p2.8.m8.1.2.1" xref="S3.SS2.p2.8.m8.1.2.1.cmml">∈</mo><msup id="S3.SS2.p2.8.m8.1.2.3" xref="S3.SS2.p2.8.m8.1.2.3.cmml"><mi id="S3.SS2.p2.8.m8.1.2.3.2" xref="S3.SS2.p2.8.m8.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.8.m8.1.2.3.3" xref="S3.SS2.p2.8.m8.1.2.3.3.cmml"><mi id="S3.SS2.p2.8.m8.1.2.3.3.2" xref="S3.SS2.p2.8.m8.1.2.3.3.2.cmml">d</mi><mo id="S3.SS2.p2.8.m8.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.8.m8.1.2.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.8.m8.1.2.3.3.3" xref="S3.SS2.p2.8.m8.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.2.cmml" xref="S3.SS2.p2.8.m8.1.2"><in id="S3.SS2.p2.8.m8.1.2.1.cmml" xref="S3.SS2.p2.8.m8.1.2.1"></in><apply id="S3.SS2.p2.8.m8.1.2.2.cmml" xref="S3.SS2.p2.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.2.2.1.cmml" xref="S3.SS2.p2.8.m8.1.2.2">superscript</csymbol><apply id="S3.SS2.p2.8.m8.1.2.2.2.cmml" xref="S3.SS2.p2.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.2.2.2.1.cmml" xref="S3.SS2.p2.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.1.2.2.2.2">𝑤</ci><ci id="S3.SS2.p2.8.m8.1.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.1.2.2.2.3">l</ci></apply><ci id="S3.SS2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.p2.8.m8.1.2.3.cmml" xref="S3.SS2.p2.8.m8.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.2.3.1.cmml" xref="S3.SS2.p2.8.m8.1.2.3">superscript</csymbol><ci id="S3.SS2.p2.8.m8.1.2.3.2.cmml" xref="S3.SS2.p2.8.m8.1.2.3.2">ℝ</ci><apply id="S3.SS2.p2.8.m8.1.2.3.3.cmml" xref="S3.SS2.p2.8.m8.1.2.3.3"><times id="S3.SS2.p2.8.m8.1.2.3.3.1.cmml" xref="S3.SS2.p2.8.m8.1.2.3.3.1"></times><ci id="S3.SS2.p2.8.m8.1.2.3.3.2.cmml" xref="S3.SS2.p2.8.m8.1.2.3.3.2">𝑑</ci><ci id="S3.SS2.p2.8.m8.1.2.3.3.3.cmml" xref="S3.SS2.p2.8.m8.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">w_{\mathrm{l}}^{(i)}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are kept and updated locally, and these parameters on the server side are fixed as the identity matrix <math alttext="I\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m9.1"><semantics id="S3.SS2.p2.9.m9.1a"><mrow id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">I</mi><mo id="S3.SS2.p2.9.m9.1.1.1" xref="S3.SS2.p2.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.3.2" xref="S3.SS2.p2.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.9.m9.1.1.3.3" xref="S3.SS2.p2.9.m9.1.1.3.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.3.3.2" xref="S3.SS2.p2.9.m9.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.p2.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.9.m9.1.1.3.3.3" xref="S3.SS2.p2.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><in id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1.1"></in><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝐼</ci><apply id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS2.p2.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS2.p2.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.9.m9.1.1.3.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3"><times id="S3.SS2.p2.9.m9.1.1.3.3.1.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3.1"></times><ci id="S3.SS2.p2.9.m9.1.1.3.3.2.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3.2">𝑑</ci><ci id="S3.SS2.p2.9.m9.1.1.3.3.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">I\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> throughout the FL process.
The combined parameter notation for each client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m10.1"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.1d">italic_i</annotation></semantics></math> is <math alttext="W^{(i)}=\{w_{\mathrm{g}}^{(i)},w_{\mathrm{l}}^{(i)}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.11.m11.5"><semantics id="S3.SS2.p2.11.m11.5a"><mrow id="S3.SS2.p2.11.m11.5.5" xref="S3.SS2.p2.11.m11.5.5.cmml"><msup id="S3.SS2.p2.11.m11.5.5.4" xref="S3.SS2.p2.11.m11.5.5.4.cmml"><mi id="S3.SS2.p2.11.m11.5.5.4.2" xref="S3.SS2.p2.11.m11.5.5.4.2.cmml">W</mi><mrow id="S3.SS2.p2.11.m11.1.1.1.3" xref="S3.SS2.p2.11.m11.5.5.4.cmml"><mo id="S3.SS2.p2.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.4.cmml">(</mo><mi id="S3.SS2.p2.11.m11.1.1.1.1" xref="S3.SS2.p2.11.m11.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p2.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.4.cmml">)</mo></mrow></msup><mo id="S3.SS2.p2.11.m11.5.5.3" xref="S3.SS2.p2.11.m11.5.5.3.cmml">=</mo><mrow id="S3.SS2.p2.11.m11.5.5.2.2" xref="S3.SS2.p2.11.m11.5.5.2.3.cmml"><mo id="S3.SS2.p2.11.m11.5.5.2.2.3" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.2.3.cmml">{</mo><msubsup id="S3.SS2.p2.11.m11.4.4.1.1.1" xref="S3.SS2.p2.11.m11.4.4.1.1.1.cmml"><mi id="S3.SS2.p2.11.m11.4.4.1.1.1.2.2" xref="S3.SS2.p2.11.m11.4.4.1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p2.11.m11.4.4.1.1.1.2.3" mathvariant="normal" xref="S3.SS2.p2.11.m11.4.4.1.1.1.2.3.cmml">g</mi><mrow id="S3.SS2.p2.11.m11.2.2.1.3" xref="S3.SS2.p2.11.m11.4.4.1.1.1.cmml"><mo id="S3.SS2.p2.11.m11.2.2.1.3.1" stretchy="false" xref="S3.SS2.p2.11.m11.4.4.1.1.1.cmml">(</mo><mi id="S3.SS2.p2.11.m11.2.2.1.1" xref="S3.SS2.p2.11.m11.2.2.1.1.cmml">i</mi><mo id="S3.SS2.p2.11.m11.2.2.1.3.2" stretchy="false" xref="S3.SS2.p2.11.m11.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p2.11.m11.5.5.2.2.4" xref="S3.SS2.p2.11.m11.5.5.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.11.m11.5.5.2.2.2" xref="S3.SS2.p2.11.m11.5.5.2.2.2.cmml"><mi id="S3.SS2.p2.11.m11.5.5.2.2.2.2.2" xref="S3.SS2.p2.11.m11.5.5.2.2.2.2.2.cmml">w</mi><mi id="S3.SS2.p2.11.m11.5.5.2.2.2.2.3" mathvariant="normal" xref="S3.SS2.p2.11.m11.5.5.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS2.p2.11.m11.3.3.1.3" xref="S3.SS2.p2.11.m11.5.5.2.2.2.cmml"><mo id="S3.SS2.p2.11.m11.3.3.1.3.1" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.2.2.2.cmml">(</mo><mi id="S3.SS2.p2.11.m11.3.3.1.1" xref="S3.SS2.p2.11.m11.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p2.11.m11.3.3.1.3.2" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p2.11.m11.5.5.2.2.5" stretchy="false" xref="S3.SS2.p2.11.m11.5.5.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.5b"><apply id="S3.SS2.p2.11.m11.5.5.cmml" xref="S3.SS2.p2.11.m11.5.5"><eq id="S3.SS2.p2.11.m11.5.5.3.cmml" xref="S3.SS2.p2.11.m11.5.5.3"></eq><apply id="S3.SS2.p2.11.m11.5.5.4.cmml" xref="S3.SS2.p2.11.m11.5.5.4"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.5.5.4.1.cmml" xref="S3.SS2.p2.11.m11.5.5.4">superscript</csymbol><ci id="S3.SS2.p2.11.m11.5.5.4.2.cmml" xref="S3.SS2.p2.11.m11.5.5.4.2">𝑊</ci><ci id="S3.SS2.p2.11.m11.1.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1.1.1">𝑖</ci></apply><set id="S3.SS2.p2.11.m11.5.5.2.3.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2"><apply id="S3.SS2.p2.11.m11.4.4.1.1.1.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.11.m11.4.4.1.1.1.2.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.4.4.1.1.1.2.1.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.11.m11.4.4.1.1.1.2.2.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1.2.2">𝑤</ci><ci id="S3.SS2.p2.11.m11.4.4.1.1.1.2.3.cmml" xref="S3.SS2.p2.11.m11.4.4.1.1.1.2.3">g</ci></apply><ci id="S3.SS2.p2.11.m11.2.2.1.1.cmml" xref="S3.SS2.p2.11.m11.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.p2.11.m11.5.5.2.2.2.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.5.5.2.2.2.1.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2">superscript</csymbol><apply id="S3.SS2.p2.11.m11.5.5.2.2.2.2.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.5.5.2.2.2.2.1.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.11.m11.5.5.2.2.2.2.2.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2.2.2">𝑤</ci><ci id="S3.SS2.p2.11.m11.5.5.2.2.2.2.3.cmml" xref="S3.SS2.p2.11.m11.5.5.2.2.2.2.3">l</ci></apply><ci id="S3.SS2.p2.11.m11.3.3.1.1.cmml" xref="S3.SS2.p2.11.m11.3.3.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.5c">W^{(i)}=\{w_{\mathrm{g}}^{(i)},w_{\mathrm{l}}^{(i)}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.m11.5d">italic_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = { italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT }</annotation></semantics></math>.
An ablation study in Section <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.SS3.SSS0.Px1" title="Global and Local Parameters. ‣ 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">5.3</span></a> investigates the impact of global and local parameters in our framework.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Orthogonal Transformations.</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">Orthogonal transformation refers to a linear operation that preserves the geometric properties of the vector space, specifically the lengths of vectors and the angles between them. In machine learning contexts, applying an orthogonal transformation to a feature space allows one to adapt the representation without distorting its underlying manifold, thus retaining the semantic integrity of the original features.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Parameter Update</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.5">Once clients join the FL process, synchronization with the server is initiated.
During the initialization phase, each client is configured to use a shared vision foundation model <math alttext="\mathcal{I}(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml">ℐ</mi><mo id="S3.SS3.p1.1.m1.1.2.1" xref="S3.SS3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.1.2.3.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><mo id="S3.SS3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.1.2.cmml">(</mo><mo id="S3.SS3.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.2"><times id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.1"></times><ci id="S3.SS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2">ℐ</ci><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{I}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">caligraphic_I ( ⋅ )</annotation></semantics></math>, with global parameters initialized to the server’s values <math alttext="w_{\mathrm{g}}^{(i)}\leftarrow w_{\mathrm{g}}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><msubsup id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.2.2" xref="S3.SS3.p1.2.m2.1.2.2.2.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.1.2.2.2.3" mathvariant="normal" xref="S3.SS3.p1.2.m2.1.2.2.2.3.cmml">g</mi><mrow id="S3.SS3.p1.2.m2.1.1.1.3" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mo id="S3.SS3.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.2.m2.1.2.1" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.1.cmml">←</mo><msub id="S3.SS3.p1.2.m2.1.2.3" xref="S3.SS3.p1.2.m2.1.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.3.2.cmml">w</mi><mi id="S3.SS3.p1.2.m2.1.2.3.3" mathvariant="normal" xref="S3.SS3.p1.2.m2.1.2.3.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><ci id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1">←</ci><apply id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">superscript</csymbol><apply id="S3.SS3.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.1.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2.3">g</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.p1.2.m2.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.2.3.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.1.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3.3">g</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">w_{\mathrm{g}}^{(i)}\leftarrow w_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math> and local parameters set to the identity matrix <math alttext="w_{\mathrm{l}}^{(i)}\leftarrow I" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.2" xref="S3.SS3.p1.3.m3.1.2.cmml"><msubsup id="S3.SS3.p1.3.m3.1.2.2" xref="S3.SS3.p1.3.m3.1.2.2.cmml"><mi id="S3.SS3.p1.3.m3.1.2.2.2.2" xref="S3.SS3.p1.3.m3.1.2.2.2.2.cmml">w</mi><mi id="S3.SS3.p1.3.m3.1.2.2.2.3" mathvariant="normal" xref="S3.SS3.p1.3.m3.1.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.p1.3.m3.1.1.1.3" xref="S3.SS3.p1.3.m3.1.2.2.cmml"><mo id="S3.SS3.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.3.m3.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.3.m3.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.3.m3.1.2.1" stretchy="false" xref="S3.SS3.p1.3.m3.1.2.1.cmml">←</mo><mi id="S3.SS3.p1.3.m3.1.2.3" xref="S3.SS3.p1.3.m3.1.2.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.2.cmml" xref="S3.SS3.p1.3.m3.1.2"><ci id="S3.SS3.p1.3.m3.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.2.1">←</ci><apply id="S3.SS3.p1.3.m3.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.2.2.1.cmml" xref="S3.SS3.p1.3.m3.1.2.2">superscript</csymbol><apply id="S3.SS3.p1.3.m3.1.2.2.2.cmml" xref="S3.SS3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.2.2.2.1.cmml" xref="S3.SS3.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.1.2.2.2.2">𝑤</ci><ci id="S3.SS3.p1.3.m3.1.2.2.2.3.cmml" xref="S3.SS3.p1.3.m3.1.2.2.2.3">l</ci></apply><ci id="S3.SS3.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.p1.3.m3.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.2.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">w_{\mathrm{l}}^{(i)}\leftarrow I</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_I</annotation></semantics></math>.
Following initialization, each client updates its trainable parameters based on its local data distribution.
The updated global parameters from all clients are then aggregated on the server using a standard FL approach, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">mcmahan2017communication</span> </a></cite>.
Meanwhile, each client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_i</annotation></semantics></math> holds a set of local parameters <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msubsup id="S3.SS3.p1.5.m5.1.2" xref="S3.SS3.p1.5.m5.1.2.cmml"><mi id="S3.SS3.p1.5.m5.1.2.2.2" xref="S3.SS3.p1.5.m5.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p1.5.m5.1.2.2.3" mathvariant="normal" xref="S3.SS3.p1.5.m5.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p1.5.m5.1.1.1.3" xref="S3.SS3.p1.5.m5.1.2.cmml"><mo id="S3.SS3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.2.cmml" xref="S3.SS3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.2">superscript</csymbol><apply id="S3.SS3.p1.5.m5.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.2.2.1.cmml" xref="S3.SS3.p1.5.m5.1.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.2.2.2.cmml" xref="S3.SS3.p1.5.m5.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.5.m5.1.2.2.3.cmml" xref="S3.SS3.p1.5.m5.1.2.2.3">l</ci></apply><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which serve as a learnable <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.5.1">orthogonal transformation</span> in FedOT.
This transformation allows the model to adapt to client-specific characteristics while leveraging the feature representation of the vision foundation model.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.9">Each client utilizes the classification probability to optimize its local updates.
Specifically, the original visual feature <math alttext="h=\mathcal{I}(x)" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.1.2.3" xref="S3.SS3.p2.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.2.3.2.cmml">ℐ</mi><mo id="S3.SS3.p2.1.m1.1.2.3.1" xref="S3.SS3.p2.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.1.2.3.3.2" xref="S3.SS3.p2.1.m1.1.2.3.cmml"><mo id="S3.SS3.p2.1.m1.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.3.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS3.p2.1.m1.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><eq id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></eq><ci id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2">ℎ</ci><apply id="S3.SS3.p2.1.m1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.2.3"><times id="S3.SS3.p2.1.m1.1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.1.2.3.1"></times><ci id="S3.SS3.p2.1.m1.1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.1.2.3.2">ℐ</ci><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">h=\mathcal{I}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_h = caligraphic_I ( italic_x )</annotation></semantics></math> is linearly transformed into <math alttext="h^{\prime}=w_{\mathrm{l}}^{(i)}h" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.2" xref="S3.SS3.p2.2.m2.1.2.cmml"><msup id="S3.SS3.p2.2.m2.1.2.2" xref="S3.SS3.p2.2.m2.1.2.2.cmml"><mi id="S3.SS3.p2.2.m2.1.2.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.cmml">h</mi><mo id="S3.SS3.p2.2.m2.1.2.2.3" xref="S3.SS3.p2.2.m2.1.2.2.3.cmml">′</mo></msup><mo id="S3.SS3.p2.2.m2.1.2.1" xref="S3.SS3.p2.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.1.2.3" xref="S3.SS3.p2.2.m2.1.2.3.cmml"><msubsup id="S3.SS3.p2.2.m2.1.2.3.2" xref="S3.SS3.p2.2.m2.1.2.3.2.cmml"><mi id="S3.SS3.p2.2.m2.1.2.3.2.2.2" xref="S3.SS3.p2.2.m2.1.2.3.2.2.2.cmml">w</mi><mi id="S3.SS3.p2.2.m2.1.2.3.2.2.3" mathvariant="normal" xref="S3.SS3.p2.2.m2.1.2.3.2.2.3.cmml">l</mi><mrow id="S3.SS3.p2.2.m2.1.1.1.3" xref="S3.SS3.p2.2.m2.1.2.3.2.cmml"><mo id="S3.SS3.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.2.m2.1.2.3.2.cmml">(</mo><mi id="S3.SS3.p2.2.m2.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.2.m2.1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.2.m2.1.2.3.1" xref="S3.SS3.p2.2.m2.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.2.3.3" xref="S3.SS3.p2.2.m2.1.2.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.2.cmml" xref="S3.SS3.p2.2.m2.1.2"><eq id="S3.SS3.p2.2.m2.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.1"></eq><apply id="S3.SS3.p2.2.m2.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2">ℎ</ci><ci id="S3.SS3.p2.2.m2.1.2.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.3">′</ci></apply><apply id="S3.SS3.p2.2.m2.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.3"><times id="S3.SS3.p2.2.m2.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.2.3.1"></times><apply id="S3.SS3.p2.2.m2.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.3.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.2.3.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.3.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.2.3.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2.2.2">𝑤</ci><ci id="S3.SS3.p2.2.m2.1.2.3.2.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.3.2.2.3">l</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.p2.2.m2.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.2.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">h^{\prime}=w_{\mathrm{l}}^{(i)}h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT italic_h</annotation></semantics></math>, where <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msubsup id="S3.SS3.p2.3.m3.1.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.2.2.2" xref="S3.SS3.p2.3.m3.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p2.3.m3.1.2.2.3" mathvariant="normal" xref="S3.SS3.p2.3.m3.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p2.3.m3.1.1.1.3" xref="S3.SS3.p2.3.m3.1.2.cmml"><mo id="S3.SS3.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p2.3.m3.1.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.2.cmml" xref="S3.SS3.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2.2">𝑤</ci><ci id="S3.SS3.p2.3.m3.1.2.2.3.cmml" xref="S3.SS3.p2.3.m3.1.2.2.3">l</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is constrained to be an orthogonal matrix, ensuring that the core feature representation is preserved while adapting to the unique data distribution of each client.
For each client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_i</annotation></semantics></math>, the classification probability is given by <math alttext="P(y\mid x;w_{\mathrm{g}},w_{\mathrm{l}}^{(i)})=\mathrm{softmax}\left(\tau w_{%
\mathrm{g}}\left({w_{\mathrm{l}}^{(i)}\mathcal{I}(x)}/{\|w_{\mathrm{l}}^{(i)}%
\mathcal{I}(x)\|}\right)\right)," class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.7"><semantics id="S3.SS3.p2.5.m5.7a"><mrow id="S3.SS3.p2.5.m5.7.7.1" xref="S3.SS3.p2.5.m5.7.7.1.1.cmml"><mrow id="S3.SS3.p2.5.m5.7.7.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.cmml"><mrow id="S3.SS3.p2.5.m5.7.7.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.1.3.cmml">P</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.4" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.4.cmml">y</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p2.5.m5.4.4" xref="S3.SS3.p2.5.m5.4.4.cmml">x</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.4" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><mi id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.3" mathvariant="normal" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.p2.5.m5.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.SS3.p2.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.SS3.p2.5.m5.1.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p2.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.3.cmml">=</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.3.cmml">softmax</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.2.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.3.cmml">τ</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.2.cmml">w</mi><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.3" mathvariant="normal" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.3.cmml">g</mi></msub><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2a" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.cmml"><msubsup id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.2.cmml">w</mi><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.3" mathvariant="normal" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.3.cmml">l</mi><mrow id="S3.SS3.p2.5.m5.2.2.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="S3.SS3.p2.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml">(</mo><mi id="S3.SS3.p2.5.m5.2.2.1.1" xref="S3.SS3.p2.5.m5.2.2.1.1.cmml">i</mi><mo id="S3.SS3.p2.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.3.cmml">ℐ</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1a" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.4.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.4.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p2.5.m5.5.5" xref="S3.SS3.p2.5.m5.5.5.cmml">x</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.4.2.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.3" mathvariant="normal" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p2.5.m5.3.3.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.5.m5.3.3.1.1" xref="S3.SS3.p2.5.m5.3.3.1.1.cmml">i</mi><mo id="S3.SS3.p2.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">ℐ</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1a" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.4.2" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.5.m5.6.6" xref="S3.SS3.p2.5.m5.6.6.cmml">x</mi><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.3" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p2.5.m5.7.7.1.2" xref="S3.SS3.p2.5.m5.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.7b"><apply id="S3.SS3.p2.5.m5.7.7.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1"><eq id="S3.SS3.p2.5.m5.7.7.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.3"></eq><apply id="S3.SS3.p2.5.m5.7.7.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1"><times id="S3.SS3.p2.5.m5.7.7.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.2"></times><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.3">𝑃</ci><apply id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.4">𝑦</ci><list id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2"><ci id="S3.SS3.p2.5.m5.4.4.cmml" xref="S3.SS3.p2.5.m5.4.4">𝑥</ci><apply id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.1.1.1.3">g</ci></apply><apply id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.1.1.1.1.2.2.2.2.3">l</ci></apply><ci id="S3.SS3.p2.5.m5.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1.1">𝑖</ci></apply></list></apply></apply><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2"><times id="S3.SS3.p2.5.m5.7.7.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.2"></times><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.3">softmax</ci><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1"><times id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.2"></times><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.3">𝜏</ci><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.4.3">g</ci></apply><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1"><divide id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.2"></divide><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3"><times id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.1"></times><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.2.2.3">l</ci></apply><ci id="S3.SS3.p2.5.m5.2.2.1.1.cmml" xref="S3.SS3.p2.5.m5.2.2.1.1">𝑖</ci></apply><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.3.3">ℐ</ci><ci id="S3.SS3.p2.5.m5.5.5.cmml" xref="S3.SS3.p2.5.m5.5.5">𝑥</ci></apply><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1"><times id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.2.2.3">l</ci></apply><ci id="S3.SS3.p2.5.m5.3.3.1.1.cmml" xref="S3.SS3.p2.5.m5.3.3.1.1">𝑖</ci></apply><ci id="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.7.7.1.1.2.1.1.1.1.1.1.1.1.1.3">ℐ</ci><ci id="S3.SS3.p2.5.m5.6.6.cmml" xref="S3.SS3.p2.5.m5.6.6">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.7c">P(y\mid x;w_{\mathrm{g}},w_{\mathrm{l}}^{(i)})=\mathrm{softmax}\left(\tau w_{%
\mathrm{g}}\left({w_{\mathrm{l}}^{(i)}\mathcal{I}(x)}/{\|w_{\mathrm{l}}^{(i)}%
\mathcal{I}(x)\|}\right)\right),</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.7d">italic_P ( italic_y ∣ italic_x ; italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) = roman_softmax ( italic_τ italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) / ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ ) ) ,</annotation></semantics></math>
where <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_τ</annotation></semantics></math> is a temperature value, and the transformed feature <math alttext="h^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><msup id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">h</mi><mo id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">ℎ</ci><ci id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">h^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is first normalized before being passed through the linear classifier <math alttext="w_{\mathrm{g}}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><msub id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">w</mi><mi id="S3.SS3.p2.8.m8.1.1.3" mathvariant="normal" xref="S3.SS3.p2.8.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">𝑤</ci><ci id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3">g</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">w_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math>.
The softmax function is then applied to convert the resulting logits into class probabilities.
In particular, each client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><mi id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><ci id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">italic_i</annotation></semantics></math> aims to minimize the following cross-entropy loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}\;=\;%
\mathbb{E}_{(x,y)\,\sim\,D^{(i)}}\bigl{[}\,-\log\,P\bigl{(}y\mid x;w_{\mathrm{%
g}}^{(i)},w_{\mathrm{l}}^{(i)}\bigr{)}\bigr{]}," class="ltx_Math" display="block" id="S3.Ex1.m1.10"><semantics id="S3.Ex1.m1.10a"><mrow id="S3.Ex1.m1.10.10.1" xref="S3.Ex1.m1.10.10.1.1.cmml"><mrow id="S3.Ex1.m1.10.10.1.1" xref="S3.Ex1.m1.10.10.1.1.cmml"><mrow id="S3.Ex1.m1.10.10.1.1.2" xref="S3.Ex1.m1.10.10.1.1.2.cmml"><msup id="S3.Ex1.m1.10.10.1.1.2.4" xref="S3.Ex1.m1.10.10.1.1.2.4.cmml"><mi id="S3.Ex1.m1.10.10.1.1.2.4.2" mathvariant="normal" xref="S3.Ex1.m1.10.10.1.1.2.4.2.cmml">ℓ</mi><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.10.10.1.1.2.4.cmml"><mo id="S3.Ex1.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.4.cmml">(</mo><mi id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">i</mi><mo id="S3.Ex1.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.4.cmml">)</mo></mrow></msup><mo id="S3.Ex1.m1.10.10.1.1.2.3" xref="S3.Ex1.m1.10.10.1.1.2.3.cmml">⁢</mo><mrow id="S3.Ex1.m1.10.10.1.1.2.2.2" xref="S3.Ex1.m1.10.10.1.1.2.2.3.cmml"><mo id="S3.Ex1.m1.10.10.1.1.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.10.10.1.1.2.2.3.cmml">(</mo><msubsup id="S3.Ex1.m1.10.10.1.1.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.3.cmml">g</mi><mrow id="S3.Ex1.m1.2.2.1.3" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.2.2.1.3.1" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml">i</mi><mo id="S3.Ex1.m1.2.2.1.3.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.10.10.1.1.2.2.2.4" rspace="0.337em" xref="S3.Ex1.m1.10.10.1.1.2.2.3.cmml">,</mo><msubsup id="S3.Ex1.m1.10.10.1.1.2.2.2.2" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.cmml"><mi id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.2" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.2.cmml">w</mi><mi id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.3" mathvariant="normal" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.Ex1.m1.3.3.1.3" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.cmml"><mo id="S3.Ex1.m1.3.3.1.3.1" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.cmml">(</mo><mi id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml">i</mi><mo id="S3.Ex1.m1.3.3.1.3.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.10.10.1.1.2.2.2.5" maxsize="120%" minsize="120%" rspace="0.280em" xref="S3.Ex1.m1.10.10.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.10.10.1.1.4" rspace="0.558em" xref="S3.Ex1.m1.10.10.1.1.4.cmml">=</mo><mrow id="S3.Ex1.m1.10.10.1.1.3" xref="S3.Ex1.m1.10.10.1.1.3.cmml"><msub id="S3.Ex1.m1.10.10.1.1.3.3" xref="S3.Ex1.m1.10.10.1.1.3.3.cmml"><mi id="S3.Ex1.m1.10.10.1.1.3.3.2" xref="S3.Ex1.m1.10.10.1.1.3.3.2.cmml">𝔼</mi><mrow id="S3.Ex1.m1.6.6.3" xref="S3.Ex1.m1.6.6.3.cmml"><mrow id="S3.Ex1.m1.6.6.3.5.2" xref="S3.Ex1.m1.6.6.3.5.1.cmml"><mo id="S3.Ex1.m1.6.6.3.5.2.1" stretchy="false" xref="S3.Ex1.m1.6.6.3.5.1.cmml">(</mo><mi id="S3.Ex1.m1.5.5.2.2" xref="S3.Ex1.m1.5.5.2.2.cmml">x</mi><mo id="S3.Ex1.m1.6.6.3.5.2.2" xref="S3.Ex1.m1.6.6.3.5.1.cmml">,</mo><mi id="S3.Ex1.m1.6.6.3.3" xref="S3.Ex1.m1.6.6.3.3.cmml">y</mi><mo id="S3.Ex1.m1.6.6.3.5.2.3" rspace="0.170em" stretchy="false" xref="S3.Ex1.m1.6.6.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.6.6.3.4" rspace="0.448em" xref="S3.Ex1.m1.6.6.3.4.cmml">∼</mo><msup id="S3.Ex1.m1.6.6.3.6" xref="S3.Ex1.m1.6.6.3.6.cmml"><mi id="S3.Ex1.m1.6.6.3.6.2" xref="S3.Ex1.m1.6.6.3.6.2.cmml">D</mi><mrow id="S3.Ex1.m1.4.4.1.1.1.3" xref="S3.Ex1.m1.6.6.3.6.cmml"><mo id="S3.Ex1.m1.4.4.1.1.1.3.1" stretchy="false" xref="S3.Ex1.m1.6.6.3.6.cmml">(</mo><mi id="S3.Ex1.m1.4.4.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.cmml">i</mi><mo id="S3.Ex1.m1.4.4.1.1.1.3.2" stretchy="false" xref="S3.Ex1.m1.6.6.3.6.cmml">)</mo></mrow></msup></mrow></msub><mo id="S3.Ex1.m1.10.10.1.1.3.2" xref="S3.Ex1.m1.10.10.1.1.3.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.2.cmml"><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.10.10.1.1.3.1.2.1.cmml">[</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.cmml"><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1a" rspace="0.167em" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.cmml">−</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.1.cmml">log</mi><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3a" lspace="0.337em" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.cmml">⁡</mo><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.4.cmml">y</mi><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.9.9" xref="S3.Ex1.m1.9.9.cmml">x</mi><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.3.cmml">;</mo><msubsup id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi><mrow id="S3.Ex1.m1.7.7.1.3" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.7.7.1.3.1" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m1.7.7.1.1" xref="S3.Ex1.m1.7.7.1.1.cmml">i</mi><mo id="S3.Ex1.m1.7.7.1.3.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.4" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><mi id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.3" mathvariant="normal" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml">l</mi><mrow id="S3.Ex1.m1.8.8.1.3" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.Ex1.m1.8.8.1.3.1" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.Ex1.m1.8.8.1.1" xref="S3.Ex1.m1.8.8.1.1.cmml">i</mi><mo id="S3.Ex1.m1.8.8.1.3.2" stretchy="false" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.10.10.1.1.3.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.10.10.1.1.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.10.10.1.2" xref="S3.Ex1.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.10b"><apply id="S3.Ex1.m1.10.10.1.1.cmml" xref="S3.Ex1.m1.10.10.1"><eq id="S3.Ex1.m1.10.10.1.1.4.cmml" xref="S3.Ex1.m1.10.10.1.1.4"></eq><apply id="S3.Ex1.m1.10.10.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.2"><times id="S3.Ex1.m1.10.10.1.1.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.2.3"></times><apply id="S3.Ex1.m1.10.10.1.1.2.4.cmml" xref="S3.Ex1.m1.10.10.1.1.2.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.2.4.1.cmml" xref="S3.Ex1.m1.10.10.1.1.2.4">superscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.2.4.2.cmml" xref="S3.Ex1.m1.10.10.1.1.2.4.2">ℓ</ci><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">𝑖</ci></apply><interval closure="open" id="S3.Ex1.m1.10.10.1.1.2.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2"><apply id="S3.Ex1.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.1.1.1.1.2.3">g</ci></apply><ci id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.Ex1.m1.10.10.1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2">superscript</csymbol><apply id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.2">𝑤</ci><ci id="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.2.2.2.2.2.3">l</ci></apply><ci id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1">𝑖</ci></apply></interval></apply><apply id="S3.Ex1.m1.10.10.1.1.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3"><times id="S3.Ex1.m1.10.10.1.1.3.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.2"></times><apply id="S3.Ex1.m1.10.10.1.1.3.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.3.3.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.3">subscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.3.3.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.3.2">𝔼</ci><apply id="S3.Ex1.m1.6.6.3.cmml" xref="S3.Ex1.m1.6.6.3"><csymbol cd="latexml" id="S3.Ex1.m1.6.6.3.4.cmml" xref="S3.Ex1.m1.6.6.3.4">similar-to</csymbol><interval closure="open" id="S3.Ex1.m1.6.6.3.5.1.cmml" xref="S3.Ex1.m1.6.6.3.5.2"><ci id="S3.Ex1.m1.5.5.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2">𝑥</ci><ci id="S3.Ex1.m1.6.6.3.3.cmml" xref="S3.Ex1.m1.6.6.3.3">𝑦</ci></interval><apply id="S3.Ex1.m1.6.6.3.6.cmml" xref="S3.Ex1.m1.6.6.3.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.3.6.1.cmml" xref="S3.Ex1.m1.6.6.3.6">superscript</csymbol><ci id="S3.Ex1.m1.6.6.3.6.2.cmml" xref="S3.Ex1.m1.6.6.3.6.2">𝐷</ci><ci id="S3.Ex1.m1.4.4.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.Ex1.m1.10.10.1.1.3.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.10.10.1.1.3.1.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1"><minus id="S3.Ex1.m1.10.10.1.1.3.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1"></minus><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1"><times id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.2"></times><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3"><log id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.1"></log><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.3.2">𝑃</ci></apply><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.4">𝑦</ci><list id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2"><ci id="S3.Ex1.m1.9.9.cmml" xref="S3.Ex1.m1.9.9">𝑥</ci><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3">g</ci></apply><ci id="S3.Ex1.m1.7.7.1.1.cmml" xref="S3.Ex1.m1.7.7.1.1">𝑖</ci></apply><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.2">𝑤</ci><ci id="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.10.10.1.1.3.1.1.1.1.1.1.1.2.2.2.2.3">l</ci></apply><ci id="S3.Ex1.m1.8.8.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.10c">\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}\;=\;%
\mathbb{E}_{(x,y)\,\sim\,D^{(i)}}\bigl{[}\,-\log\,P\bigl{(}y\mid x;w_{\mathrm{%
g}}^{(i)},w_{\mathrm{l}}^{(i)}\bigr{)}\bigr{]},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.10d">roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∼ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ - roman_log italic_P ( italic_y ∣ italic_x ; italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.11">where <math alttext="D^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m1.1"><semantics id="S3.SS3.p2.10.m1.1a"><msup id="S3.SS3.p2.10.m1.1.2" xref="S3.SS3.p2.10.m1.1.2.cmml"><mi id="S3.SS3.p2.10.m1.1.2.2" xref="S3.SS3.p2.10.m1.1.2.2.cmml">D</mi><mrow id="S3.SS3.p2.10.m1.1.1.1.3" xref="S3.SS3.p2.10.m1.1.2.cmml"><mo id="S3.SS3.p2.10.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.10.m1.1.2.cmml">(</mo><mi id="S3.SS3.p2.10.m1.1.1.1.1" xref="S3.SS3.p2.10.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p2.10.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.10.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m1.1b"><apply id="S3.SS3.p2.10.m1.1.2.cmml" xref="S3.SS3.p2.10.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m1.1.2.1.cmml" xref="S3.SS3.p2.10.m1.1.2">superscript</csymbol><ci id="S3.SS3.p2.10.m1.1.2.2.cmml" xref="S3.SS3.p2.10.m1.1.2.2">𝐷</ci><ci id="S3.SS3.p2.10.m1.1.1.1.1.cmml" xref="S3.SS3.p2.10.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m1.1c">D^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m1.1d">italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is a labeled dataset representing the unique data distribution of client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m2.1"><semantics id="S3.SS3.p2.11.m2.1a"><mi id="S3.SS3.p2.11.m2.1.1" xref="S3.SS3.p2.11.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m2.1b"><ci id="S3.SS3.p2.11.m2.1.1.cmml" xref="S3.SS3.p2.11.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m2.1d">italic_i</annotation></semantics></math>.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Algorithm of FedOT.</h5>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.11">Here, we specify the algorithm of FedOT. Initially, the server shares its learnable global parameter <math alttext="w_{g}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">w_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and sets the local transform to the
identity <math alttext="I" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_I</annotation></semantics></math>.
On the client side, let <math alttext="X^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><msup id="S3.SS3.SSS0.Px1.p1.3.m3.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.2.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m3.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> be an unconstrained matrix, initialized to the identity <math alttext="I" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.4.m4.1d">italic_I</annotation></semantics></math>, from which <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><msubsup id="S3.SS3.SSS0.Px1.p1.5.m5.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.2.2.3">l</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.5.m5.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is derived via a differentiable <em class="ltx_emph ltx_font_italic" id="S3.SS3.SSS0.Px1.p1.11.1">Cayley transform</em> to ensure orthogonality.
Specifically,
<math alttext="w_{\mathrm{l}}^{(i)}\;=\;\bigl{(}I+R^{(i)}\bigr{)}\,\bigl{(}I-R^{(i)}\bigr{)}^%
{-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.6.m6.5"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.5a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.5" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.cmml"><msubsup id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.3.cmml">l</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.3" lspace="0.558em" rspace="0.558em" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.3.cmml">=</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.2.cmml">I</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.1.cmml">+</mo><msup id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.3" lspace="0.170em" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.3.cmml">⁢</mo><msup id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.2" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.2.cmml">I</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.1.cmml">−</mo><msup id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.3" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3a" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.cmml">−</mo><mn id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.5b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5"><eq id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.3"></eq><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.4.2.3">l</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2"><times id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.3"></times><apply id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1"><plus id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.1"></plus><ci id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.2">𝐼</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.4.4.1.1.1.1.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.2.2.1.1">𝑖</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1"><minus id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.1"></minus><ci id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.2">𝐼</ci><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.1.1.1.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.3.3.1.1">𝑖</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3"><minus id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3"></minus><cn id="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.6.m6.5.5.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.5c">w_{\mathrm{l}}^{(i)}\;=\;\bigl{(}I+R^{(i)}\bigr{)}\,\bigl{(}I-R^{(i)}\bigr{)}^%
{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.6.m6.5d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = ( italic_I + italic_R start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ( italic_I - italic_R start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>
, where
<math alttext="R^{(i)}\;=\;\frac{1}{2}\Bigl{(}X^{(i)}-(X^{(i)})^{\top}\Bigr{)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.7.m7.4"><semantics id="S3.SS3.SSS0.Px1.p1.7.m7.4a"><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.4.4" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.cmml"><msup id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.2.cmml">R</mi><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.2" lspace="0.558em" rspace="0.558em" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.2.cmml">=</mo><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.cmml"><mfrac id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.cmml"><mn id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.2.cmml">1</mn><mn id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.3.cmml">2</mn></mfrac><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.cmml"><msup id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.2.cmml">−</mo><msup id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><mo id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.7.m7.4b"><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4"><eq id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.2"></eq><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.3.2">𝑅</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1"><times id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.2"></times><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3"><divide id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3"></divide><cn id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.2">1</cn><cn id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.3.3">2</cn></apply><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.2"></minus><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.3.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.2.2.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.3.3.1.1">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.4.4.1.1.1.1.1.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.7.m7.4c">R^{(i)}\;=\;\frac{1}{2}\Bigl{(}X^{(i)}-(X^{(i)})^{\top}\Bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.7.m7.4d">italic_R start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT )</annotation></semantics></math>.
During local training, the parameters are updated with respect to a sampled mini-batch over several epochs as
<math alttext="w_{\mathrm{g}}^{(i)}\leftarrow w_{\mathrm{g}}^{(i)}\;-\;\eta\,\nabla_{w_{%
\mathrm{g}}^{(i)}}\,\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(%
i)}\bigr{)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.8.m8.8"><semantics id="S3.SS3.SSS0.Px1.p1.8.m8.8a"><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.8.8" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.cmml"><msubsup id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.3.cmml">←</mo><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.cmml"><msubsup id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.3" rspace="0.502em" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.3.cmml">−</mo><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.4" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.4.cmml">η</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3" lspace="0.337em" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.cmml"><msub id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.2" rspace="0.167em" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.2.cmml">∇</mo><msubsup id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.2" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.2.cmml">ℓ</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3a" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.4" rspace="0.337em" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.3" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.1" xref="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.5" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.8.m8.8b"><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8"><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.3">←</ci><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.4.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2"><minus id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.3"></minus><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.4.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.2.2.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2"><times id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.3"></times><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.4.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.4">𝜂</ci><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5"><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.1.2">∇</ci><apply id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.3.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.3.3.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.5.2.2">ℓ</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.4.4.1.1">𝑖</ci></apply></apply><interval closure="open" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2"><apply id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.7.7.1.1.1.1.1.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.5.5.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.8.8.2.2.2.2.2.2.3">l</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.8.m8.6.6.1.1">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.8.m8.8c">w_{\mathrm{g}}^{(i)}\leftarrow w_{\mathrm{g}}^{(i)}\;-\;\eta\,\nabla_{w_{%
\mathrm{g}}^{(i)}}\,\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(%
i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.8.m8.8d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_η ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> and
<math alttext="X^{(i)}\leftarrow X^{(i)}\;-\;\eta\,\nabla_{X^{(i)}}\,\ell^{(i)}\bigl{(}w_{%
\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.9.m9.8"><semantics id="S3.SS3.SSS0.Px1.p1.9.m9.8a"><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.8.8" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.cmml"><msup id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.3.cmml">←</mo><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.cmml"><msup id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.3" rspace="0.502em" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.3.cmml">−</mo><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.4" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.4.cmml">η</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3" lspace="0.337em" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.cmml"><msub id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.2" rspace="0.167em" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.2.cmml">∇</mo><msup id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.3.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.cmml">)</mo></mrow></msup></msub><msup id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.2" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.2.cmml">ℓ</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.cmml">)</mo></mrow></msup></mrow><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3a" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.4" rspace="0.337em" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.3" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.1" xref="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.5" maxsize="120%" minsize="120%" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.9.m9.8b"><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8"><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.3">←</ci><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.4.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2"><minus id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.3"></minus><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.4.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.2.2.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2"><times id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.3"></times><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.4.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.4">𝜂</ci><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5"><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.1.2">∇</ci><apply id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.3">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.5.2.2">ℓ</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.4.4.1.1">𝑖</ci></apply></apply><interval closure="open" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2"><apply id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.7.7.1.1.1.1.1.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.5.5.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.8.8.2.2.2.2.2.2.3">l</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.9.m9.6.6.1.1">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.9.m9.8c">X^{(i)}\leftarrow X^{(i)}\;-\;\eta\,\nabla_{X^{(i)}}\,\ell^{(i)}\bigl{(}w_{%
\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.9.m9.8d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_η ∇ start_POSTSUBSCRIPT italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>,
then <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS3.SSS0.Px1.p1.10.m10.1a"><msubsup id="S3.SS3.SSS0.Px1.p1.10.m10.1.2" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.2" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.10.m10.1b"><apply id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.2.2.3">l</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.10.m10.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.10.m10.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.10.m10.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is recomputed from <math alttext="X^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS3.SSS0.Px1.p1.11.m11.1a"><msup id="S3.SS3.SSS0.Px1.p1.11.m11.1.2" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.11.m11.1.2.2" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.2.cmml">X</mi><mrow id="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.11.m11.1b"><apply id="S3.SS3.SSS0.Px1.p1.11.m11.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.11.m11.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.11.m11.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.2.2">𝑋</ci><ci id="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.11.m11.1c">X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.11.m11.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> via the Cayley transform to maintain orthogonality.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.6">After local training, the server gathers the updated <em class="ltx_emph ltx_font_italic" id="S3.SS3.SSS0.Px1.p2.6.1">global</em> parameters from the clients (i.e., <math alttext="\{w_{\mathrm{g}}^{(i)}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.1.m1.2"><semantics id="S3.SS3.SSS0.Px1.p2.1.m1.2a"><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.2.cmml"><mo id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.2.cmml">{</mo><msubsup id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.1.m1.2b"><set id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1"><apply id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.2.2.1.1.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.1.m1.2c">\{w_{\mathrm{g}}^{(i)}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.1.m1.2d">{ italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT }</annotation></semantics></math>) and updates as <math alttext="w_{\mathrm{g}}\;\leftarrow\;\frac{1}{N}\,\sum_{i=1}^{N}w_{\mathrm{g}}^{(i)}," class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.2.m2.2"><semantics id="S3.SS3.SSS0.Px1.p2.2.m2.2a"><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.3.cmml">g</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.1" lspace="0.558em" rspace="0.558em" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.1.cmml">←</mo><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.cmml"><mfrac id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.cmml"><mn id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.2.cmml">1</mn><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.3.cmml">N</mi></mfrac><mo id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.1" lspace="0.337em" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.cmml"><msubsup id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.cmml"><mo id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.3.cmml">N</mi></msubsup><msubsup id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.cmml"><mo id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.2.m2.2b"><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1"><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.1">←</ci><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.3">g</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3"><times id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.1"></times><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2"><divide id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2"></divide><cn id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.2">1</cn><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.2.3">𝑁</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3"><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1">subscript</csymbol><sum id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.2"></sum><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3"><eq id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.1.3">𝑁</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.3.2.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.2.m2.2c">w_{\mathrm{g}}\;\leftarrow\;\frac{1}{N}\,\sum_{i=1}^{N}w_{\mathrm{g}}^{(i)},</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.2.m2.2d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT ← divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ,</annotation></semantics></math> where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p2.3.m3.1a"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.3.m3.1b"><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.3.m3.1d">italic_N</annotation></semantics></math> is the number of participating clients.
Finally, each client <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS3.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.4.m4.1d">italic_i</annotation></semantics></math> receives the updated global parameter <math alttext="w_{\mathrm{g}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS3.SSS0.Px1.p2.5.m5.1a"><msub id="S3.SS3.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3">g</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.5.m5.1c">w_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.5.m5.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math> from the server and sets as <math alttext="w_{\mathrm{g}}^{(i)}\;\leftarrow\;w_{\mathrm{g}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS3.SSS0.Px1.p2.6.m6.1a"><mrow id="S3.SS3.SSS0.Px1.p2.6.m6.1.2" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.cmml"><msubsup id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.3.cmml">g</mi><mrow id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.cmml"><mo id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.1" lspace="0.558em" rspace="0.558em" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.1.cmml">←</mo><msub id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.2.cmml">w</mi><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2"><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.1">←</ci><apply id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.2.2.3">g</ci></apply><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.2">𝑤</ci><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.2.3.3">g</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.6.m6.1c">w_{\mathrm{g}}^{(i)}\;\leftarrow\;w_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.6.m6.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math>,
which completes one communication round. Refer to Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#alg1" title="Algorithm 1 ‣ C.1 Detailed of Parameter Update. ‣ Appendix C FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">1</span></a> for the pseudo-code.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Protecting Proprietary Models and Data</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Preserving the intellectual property of foundation models and protecting data ownership are critical concerns for model providers and data owners, respectively.
Our framework ensures data privacy by operating within an FL setting, where raw data remains on local devices and only model updates are exchanged.
This setup inherently protects user data privacy.
Furthermore, transforming the extracted image features enables adaptation without accessing or modifying the internal parameters of the image encoder.
This allows the image encoder to function as a black-box module, facilitating the deployment of foundation models in binary or embedded formats without exposing proprietary weights.
Thus, FedOT serves to protect both the foundation model and the data, offering tangible benefits for building secure and deployable distributed learning systems.
For a more in-depth comparison of learning frameworks and their applications, refer to Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A4.T4" title="Table 4 ‣ Appendix D Comparison of Learning Frameworks ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Theoretical Analysis of FedOT</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we present key theoretical insights behind FedOT, demonstrating how enforcing orthogonality on local parameters <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><msubsup id="S4.p1.1.m1.1.2" xref="S4.p1.1.m1.1.2.cmml"><mi id="S4.p1.1.m1.1.2.2.2" xref="S4.p1.1.m1.1.2.2.2.cmml">w</mi><mi id="S4.p1.1.m1.1.2.2.3" mathvariant="normal" xref="S4.p1.1.m1.1.2.2.3.cmml">l</mi><mrow id="S4.p1.1.m1.1.1.1.3" xref="S4.p1.1.m1.1.2.cmml"><mo id="S4.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.p1.1.m1.1.2.cmml">(</mo><mi id="S4.p1.1.m1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.2.cmml" xref="S4.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.2.1.cmml" xref="S4.p1.1.m1.1.2">superscript</csymbol><apply id="S4.p1.1.m1.1.2.2.cmml" xref="S4.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.2.2.1.cmml" xref="S4.p1.1.m1.1.2">subscript</csymbol><ci id="S4.p1.1.m1.1.2.2.2.cmml" xref="S4.p1.1.m1.1.2.2.2">𝑤</ci><ci id="S4.p1.1.m1.1.2.2.3.cmml" xref="S4.p1.1.m1.1.2.2.3">l</ci></apply><ci id="S4.p1.1.m1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> mitigates gradient conflicts among heterogeneous clients, thereby balancing personalization and generalization.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Bounding the Gradient Difference Between Clients</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">Recall that each client <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_i</annotation></semantics></math> transforms the visual feature <math alttext="h=\mathcal{I}(x)" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml">h</mi><mo id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.1.2.3" xref="S4.SS1.p1.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.2.3.2" xref="S4.SS1.p1.2.m2.1.2.3.2.cmml">ℐ</mi><mo id="S4.SS1.p1.2.m2.1.2.3.1" xref="S4.SS1.p1.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.1.2.3.3.2" xref="S4.SS1.p1.2.m2.1.2.3.cmml"><mo id="S4.SS1.p1.2.m2.1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.3.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">x</mi><mo id="S4.SS1.p1.2.m2.1.2.3.3.2.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><eq id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></eq><ci id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2">ℎ</ci><apply id="S4.SS1.p1.2.m2.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.2.3"><times id="S4.SS1.p1.2.m2.1.2.3.1.cmml" xref="S4.SS1.p1.2.m2.1.2.3.1"></times><ci id="S4.SS1.p1.2.m2.1.2.3.2.cmml" xref="S4.SS1.p1.2.m2.1.2.3.2">ℐ</ci><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">h=\mathcal{I}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_h = caligraphic_I ( italic_x )</annotation></semantics></math> into
<math alttext="h^{\prime}=w_{\mathrm{l}}^{(i)}\,h" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.2" xref="S4.SS1.p1.3.m3.1.2.cmml"><msup id="S4.SS1.p1.3.m3.1.2.2" xref="S4.SS1.p1.3.m3.1.2.2.cmml"><mi id="S4.SS1.p1.3.m3.1.2.2.2" xref="S4.SS1.p1.3.m3.1.2.2.2.cmml">h</mi><mo id="S4.SS1.p1.3.m3.1.2.2.3" xref="S4.SS1.p1.3.m3.1.2.2.3.cmml">′</mo></msup><mo id="S4.SS1.p1.3.m3.1.2.1" xref="S4.SS1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.1.2.3" xref="S4.SS1.p1.3.m3.1.2.3.cmml"><msubsup id="S4.SS1.p1.3.m3.1.2.3.2" xref="S4.SS1.p1.3.m3.1.2.3.2.cmml"><mi id="S4.SS1.p1.3.m3.1.2.3.2.2.2" xref="S4.SS1.p1.3.m3.1.2.3.2.2.2.cmml">w</mi><mi id="S4.SS1.p1.3.m3.1.2.3.2.2.3" mathvariant="normal" xref="S4.SS1.p1.3.m3.1.2.3.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.3.m3.1.1.1.3" xref="S4.SS1.p1.3.m3.1.2.3.2.cmml"><mo id="S4.SS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.3.m3.1.2.3.2.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.3.m3.1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.3.m3.1.2.3.1" xref="S4.SS1.p1.3.m3.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.1.2.3.3" xref="S4.SS1.p1.3.m3.1.2.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.2.cmml" xref="S4.SS1.p1.3.m3.1.2"><eq id="S4.SS1.p1.3.m3.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.2.1"></eq><apply id="S4.SS1.p1.3.m3.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.2.2.1.cmml" xref="S4.SS1.p1.3.m3.1.2.2">superscript</csymbol><ci id="S4.SS1.p1.3.m3.1.2.2.2.cmml" xref="S4.SS1.p1.3.m3.1.2.2.2">ℎ</ci><ci id="S4.SS1.p1.3.m3.1.2.2.3.cmml" xref="S4.SS1.p1.3.m3.1.2.2.3">′</ci></apply><apply id="S4.SS1.p1.3.m3.1.2.3.cmml" xref="S4.SS1.p1.3.m3.1.2.3"><times id="S4.SS1.p1.3.m3.1.2.3.1.cmml" xref="S4.SS1.p1.3.m3.1.2.3.1"></times><apply id="S4.SS1.p1.3.m3.1.2.3.2.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.2.3.2.1.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2">superscript</csymbol><apply id="S4.SS1.p1.3.m3.1.2.3.2.2.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.2.3.2.2.1.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.2.3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2.2.2">𝑤</ci><ci id="S4.SS1.p1.3.m3.1.2.3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.1.2.3.2.2.3">l</ci></apply><ci id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">𝑖</ci></apply><ci id="S4.SS1.p1.3.m3.1.2.3.3.cmml" xref="S4.SS1.p1.3.m3.1.2.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">h^{\prime}=w_{\mathrm{l}}^{(i)}\,h</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT italic_h</annotation></semantics></math>.
We then measure the cross-entropy loss
<math alttext="\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.5"><semantics id="S4.SS1.p1.4.m4.5a"><mrow id="S4.SS1.p1.4.m4.5.5" xref="S4.SS1.p1.4.m4.5.5.cmml"><msup id="S4.SS1.p1.4.m4.5.5.4" xref="S4.SS1.p1.4.m4.5.5.4.cmml"><mi id="S4.SS1.p1.4.m4.5.5.4.2" mathvariant="normal" xref="S4.SS1.p1.4.m4.5.5.4.2.cmml">ℓ</mi><mrow id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.5.5.4.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.4.m4.5.5.4.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.4.m4.5.5.4.cmml">)</mo></mrow></msup><mo id="S4.SS1.p1.4.m4.5.5.3" xref="S4.SS1.p1.4.m4.5.5.3.cmml">⁢</mo><mrow id="S4.SS1.p1.4.m4.5.5.2.2" xref="S4.SS1.p1.4.m4.5.5.2.3.cmml"><mo id="S4.SS1.p1.4.m4.5.5.2.2.3" maxsize="120%" minsize="120%" xref="S4.SS1.p1.4.m4.5.5.2.3.cmml">(</mo><msubsup id="S4.SS1.p1.4.m4.4.4.1.1.1" xref="S4.SS1.p1.4.m4.4.4.1.1.1.cmml"><mi id="S4.SS1.p1.4.m4.4.4.1.1.1.2.2" xref="S4.SS1.p1.4.m4.4.4.1.1.1.2.2.cmml">w</mi><mi id="S4.SS1.p1.4.m4.4.4.1.1.1.2.3" mathvariant="normal" xref="S4.SS1.p1.4.m4.4.4.1.1.1.2.3.cmml">g</mi><mrow id="S4.SS1.p1.4.m4.2.2.1.3" xref="S4.SS1.p1.4.m4.4.4.1.1.1.cmml"><mo id="S4.SS1.p1.4.m4.2.2.1.3.1" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.1.1.1.cmml">(</mo><mi id="S4.SS1.p1.4.m4.2.2.1.1" xref="S4.SS1.p1.4.m4.2.2.1.1.cmml">i</mi><mo id="S4.SS1.p1.4.m4.2.2.1.3.2" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.4.m4.5.5.2.2.4" rspace="0.337em" xref="S4.SS1.p1.4.m4.5.5.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.4.m4.5.5.2.2.2" xref="S4.SS1.p1.4.m4.5.5.2.2.2.cmml"><mi id="S4.SS1.p1.4.m4.5.5.2.2.2.2.2" xref="S4.SS1.p1.4.m4.5.5.2.2.2.2.2.cmml">w</mi><mi id="S4.SS1.p1.4.m4.5.5.2.2.2.2.3" mathvariant="normal" xref="S4.SS1.p1.4.m4.5.5.2.2.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.4.m4.3.3.1.3" xref="S4.SS1.p1.4.m4.5.5.2.2.2.cmml"><mo id="S4.SS1.p1.4.m4.3.3.1.3.1" stretchy="false" xref="S4.SS1.p1.4.m4.5.5.2.2.2.cmml">(</mo><mi id="S4.SS1.p1.4.m4.3.3.1.1" xref="S4.SS1.p1.4.m4.3.3.1.1.cmml">i</mi><mo id="S4.SS1.p1.4.m4.3.3.1.3.2" stretchy="false" xref="S4.SS1.p1.4.m4.5.5.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.4.m4.5.5.2.2.5" maxsize="120%" minsize="120%" xref="S4.SS1.p1.4.m4.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.5b"><apply id="S4.SS1.p1.4.m4.5.5.cmml" xref="S4.SS1.p1.4.m4.5.5"><times id="S4.SS1.p1.4.m4.5.5.3.cmml" xref="S4.SS1.p1.4.m4.5.5.3"></times><apply id="S4.SS1.p1.4.m4.5.5.4.cmml" xref="S4.SS1.p1.4.m4.5.5.4"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.5.5.4.1.cmml" xref="S4.SS1.p1.4.m4.5.5.4">superscript</csymbol><ci id="S4.SS1.p1.4.m4.5.5.4.2.cmml" xref="S4.SS1.p1.4.m4.5.5.4.2">ℓ</ci><ci id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">𝑖</ci></apply><interval closure="open" id="S4.SS1.p1.4.m4.5.5.2.3.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2"><apply id="S4.SS1.p1.4.m4.4.4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.4.4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m4.4.4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.4.4.1.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.2.2">𝑤</ci><ci id="S4.SS1.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.2.3">g</ci></apply><ci id="S4.SS1.p1.4.m4.2.2.1.1.cmml" xref="S4.SS1.p1.4.m4.2.2.1.1">𝑖</ci></apply><apply id="S4.SS1.p1.4.m4.5.5.2.2.2.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.5.5.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.4.m4.5.5.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.5.5.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.5.5.2.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2.2.2">𝑤</ci><ci id="S4.SS1.p1.4.m4.5.5.2.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.5.5.2.2.2.2.3">l</ci></apply><ci id="S4.SS1.p1.4.m4.3.3.1.1.cmml" xref="S4.SS1.p1.4.m4.3.3.1.1">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.5c">\ell^{(i)}\bigl{(}w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.5d">roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>
and compute a standard derivative with respect to <math alttext="w_{\mathrm{g}}^{(i)}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><msubsup id="S4.SS1.p1.5.m5.1.2" xref="S4.SS1.p1.5.m5.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.2.2.2" xref="S4.SS1.p1.5.m5.1.2.2.2.cmml">w</mi><mi id="S4.SS1.p1.5.m5.1.2.2.3" mathvariant="normal" xref="S4.SS1.p1.5.m5.1.2.2.3.cmml">g</mi><mrow id="S4.SS1.p1.5.m5.1.1.1.3" xref="S4.SS1.p1.5.m5.1.2.cmml"><mo id="S4.SS1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.p1.5.m5.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.2.cmml" xref="S4.SS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2">superscript</csymbol><apply id="S4.SS1.p1.5.m5.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.2.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.2.2.2.cmml" xref="S4.SS1.p1.5.m5.1.2.2.2">𝑤</ci><ci id="S4.SS1.p1.5.m5.1.2.2.3.cmml" xref="S4.SS1.p1.5.m5.1.2.2.3">g</ci></apply><ci id="S4.SS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">w_{\mathrm{g}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}\Bigl{[}\tau\,\bigl{(}r_%
{x}^{(i)}-y\bigr{)}\,\bigl{(}\tfrac{h^{\prime}}{\|h^{\prime}\|}\bigr{)}^{\top}%
\Bigr{]}," class="ltx_Math" display="block" id="S4.Ex2.m1.5"><semantics id="S4.Ex2.m1.5a"><mrow id="S4.Ex2.m1.5.5.1" xref="S4.Ex2.m1.5.5.1.1.cmml"><mrow id="S4.Ex2.m1.5.5.1.1" xref="S4.Ex2.m1.5.5.1.1.cmml"><mrow id="S4.Ex2.m1.5.5.1.1.3" xref="S4.Ex2.m1.5.5.1.1.3.cmml"><msub id="S4.Ex2.m1.5.5.1.1.3.1" xref="S4.Ex2.m1.5.5.1.1.3.1.cmml"><mo id="S4.Ex2.m1.5.5.1.1.3.1.2" xref="S4.Ex2.m1.5.5.1.1.3.1.2.cmml">∇</mo><msubsup id="S4.Ex2.m1.1.1.1" xref="S4.Ex2.m1.1.1.1.cmml"><mi id="S4.Ex2.m1.1.1.1.3.2" xref="S4.Ex2.m1.1.1.1.3.2.cmml">w</mi><mi id="S4.Ex2.m1.1.1.1.3.3" mathvariant="normal" xref="S4.Ex2.m1.1.1.1.3.3.cmml">g</mi><mrow id="S4.Ex2.m1.1.1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.cmml"><mo id="S4.Ex2.m1.1.1.1.1.1.3.1" stretchy="false" xref="S4.Ex2.m1.1.1.1.cmml">(</mo><mi id="S4.Ex2.m1.1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.Ex2.m1.1.1.1.1.1.3.2" stretchy="false" xref="S4.Ex2.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="S4.Ex2.m1.5.5.1.1.3.2" xref="S4.Ex2.m1.5.5.1.1.3.2.cmml"><mi id="S4.Ex2.m1.5.5.1.1.3.2.2" mathvariant="normal" xref="S4.Ex2.m1.5.5.1.1.3.2.2.cmml">ℓ</mi><mrow id="S4.Ex2.m1.2.2.1.3" xref="S4.Ex2.m1.5.5.1.1.3.2.cmml"><mo id="S4.Ex2.m1.2.2.1.3.1" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S4.Ex2.m1.2.2.1.1" xref="S4.Ex2.m1.2.2.1.1.cmml">i</mi><mo id="S4.Ex2.m1.2.2.1.3.2" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.3.2.cmml">)</mo></mrow></msup></mrow><mo id="S4.Ex2.m1.5.5.1.1.2" rspace="0.558em" xref="S4.Ex2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.Ex2.m1.5.5.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.cmml"><mi id="S4.Ex2.m1.5.5.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.3.cmml">𝔼</mi><mo id="S4.Ex2.m1.5.5.1.1.1.2" xref="S4.Ex2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S4.Ex2.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">τ</mi><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2" lspace="0.170em" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml">x</mi><mrow id="S4.Ex2.m1.3.3.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex2.m1.3.3.1.3.1" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.Ex2.m1.3.3.1.1" xref="S4.Ex2.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex2.m1.3.3.1.3.2" stretchy="false" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2a" lspace="0.170em" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml"><mrow id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.2.2" xref="S4.Ex2.m1.4.4.cmml"><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.2.2.1" maxsize="120%" minsize="120%" xref="S4.Ex2.m1.4.4.cmml">(</mo><mstyle displaystyle="false" id="S4.Ex2.m1.4.4" xref="S4.Ex2.m1.4.4.cmml"><mfrac id="S4.Ex2.m1.4.4a" xref="S4.Ex2.m1.4.4.cmml"><msup id="S4.Ex2.m1.4.4.3" xref="S4.Ex2.m1.4.4.3.cmml"><mi id="S4.Ex2.m1.4.4.3.2" xref="S4.Ex2.m1.4.4.3.2.cmml">h</mi><mo id="S4.Ex2.m1.4.4.3.3" xref="S4.Ex2.m1.4.4.3.3.cmml">′</mo></msup><mrow id="S4.Ex2.m1.4.4.1.1" xref="S4.Ex2.m1.4.4.1.2.cmml"><mo id="S4.Ex2.m1.4.4.1.1.2" stretchy="false" xref="S4.Ex2.m1.4.4.1.2.1.cmml">‖</mo><msup id="S4.Ex2.m1.4.4.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.cmml"><mi id="S4.Ex2.m1.4.4.1.1.1.2" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml">h</mi><mo id="S4.Ex2.m1.4.4.1.1.1.3" xref="S4.Ex2.m1.4.4.1.1.1.3.cmml">′</mo></msup><mo id="S4.Ex2.m1.4.4.1.1.3" stretchy="false" xref="S4.Ex2.m1.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.2.2.2" maxsize="120%" minsize="120%" xref="S4.Ex2.m1.4.4.cmml">)</mo></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.3" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup></mrow><mo id="S4.Ex2.m1.5.5.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S4.Ex2.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.Ex2.m1.5.5.1.2" xref="S4.Ex2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.5b"><apply id="S4.Ex2.m1.5.5.1.1.cmml" xref="S4.Ex2.m1.5.5.1"><eq id="S4.Ex2.m1.5.5.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.2"></eq><apply id="S4.Ex2.m1.5.5.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.3"><apply id="S4.Ex2.m1.5.5.1.1.3.1.cmml" xref="S4.Ex2.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.3.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.3.1">subscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.3.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.3.1.2">∇</ci><apply id="S4.Ex2.m1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.1">superscript</csymbol><apply id="S4.Ex2.m1.1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.1.1.1.3.2">𝑤</ci><ci id="S4.Ex2.m1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.1.1.1.3.3">g</ci></apply><ci id="S4.Ex2.m1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="S4.Ex2.m1.5.5.1.1.3.2.cmml" xref="S4.Ex2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.3.2">superscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.3.2.2">ℓ</ci><ci id="S4.Ex2.m1.2.2.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="S4.Ex2.m1.5.5.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1"><times id="S4.Ex2.m1.5.5.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.2"></times><ci id="S4.Ex2.m1.5.5.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.3">𝔼</ci><apply id="S4.Ex2.m1.5.5.1.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1"><times id="S4.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.2"></times><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.3">𝜏</ci><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3">𝑥</ci></apply><ci id="S4.Ex2.m1.3.3.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1">𝑖</ci></apply><ci id="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4">superscript</csymbol><apply id="S4.Ex2.m1.4.4.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.2.2"><divide id="S4.Ex2.m1.4.4.2.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.2.2"></divide><apply id="S4.Ex2.m1.4.4.3.cmml" xref="S4.Ex2.m1.4.4.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.3.1.cmml" xref="S4.Ex2.m1.4.4.3">superscript</csymbol><ci id="S4.Ex2.m1.4.4.3.2.cmml" xref="S4.Ex2.m1.4.4.3.2">ℎ</ci><ci id="S4.Ex2.m1.4.4.3.3.cmml" xref="S4.Ex2.m1.4.4.3.3">′</ci></apply><apply id="S4.Ex2.m1.4.4.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1"><csymbol cd="latexml" id="S4.Ex2.m1.4.4.1.2.1.cmml" xref="S4.Ex2.m1.4.4.1.1.2">norm</csymbol><apply id="S4.Ex2.m1.4.4.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1">superscript</csymbol><ci id="S4.Ex2.m1.4.4.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.2">ℎ</ci><ci id="S4.Ex2.m1.4.4.1.1.1.3.cmml" xref="S4.Ex2.m1.4.4.1.1.1.3">′</ci></apply></apply></apply><csymbol cd="latexml" id="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.3.cmml" xref="S4.Ex2.m1.5.5.1.1.1.1.1.1.4.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.5c">\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}\Bigl{[}\tau\,\bigl{(}r_%
{x}^{(i)}-y\bigr{)}\,\bigl{(}\tfrac{h^{\prime}}{\|h^{\prime}\|}\bigr{)}^{\top}%
\Bigr{]},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.5d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E [ italic_τ ( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_y ) ( divide start_ARG italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG start_ARG ∥ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.9">where <math alttext="r_{x}^{(i)}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m1.1"><semantics id="S4.SS1.p1.6.m1.1a"><msubsup id="S4.SS1.p1.6.m1.1.2" xref="S4.SS1.p1.6.m1.1.2.cmml"><mi id="S4.SS1.p1.6.m1.1.2.2.2" xref="S4.SS1.p1.6.m1.1.2.2.2.cmml">r</mi><mi id="S4.SS1.p1.6.m1.1.2.2.3" xref="S4.SS1.p1.6.m1.1.2.2.3.cmml">x</mi><mrow id="S4.SS1.p1.6.m1.1.1.1.3" xref="S4.SS1.p1.6.m1.1.2.cmml"><mo id="S4.SS1.p1.6.m1.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.6.m1.1.2.cmml">(</mo><mi id="S4.SS1.p1.6.m1.1.1.1.1" xref="S4.SS1.p1.6.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.6.m1.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.6.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m1.1b"><apply id="S4.SS1.p1.6.m1.1.2.cmml" xref="S4.SS1.p1.6.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m1.1.2.1.cmml" xref="S4.SS1.p1.6.m1.1.2">superscript</csymbol><apply id="S4.SS1.p1.6.m1.1.2.2.cmml" xref="S4.SS1.p1.6.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m1.1.2.2.1.cmml" xref="S4.SS1.p1.6.m1.1.2">subscript</csymbol><ci id="S4.SS1.p1.6.m1.1.2.2.2.cmml" xref="S4.SS1.p1.6.m1.1.2.2.2">𝑟</ci><ci id="S4.SS1.p1.6.m1.1.2.2.3.cmml" xref="S4.SS1.p1.6.m1.1.2.2.3">𝑥</ci></apply><ci id="S4.SS1.p1.6.m1.1.1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m1.1c">r_{x}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m1.1d">italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> corresponds to the classification probability
<math alttext="P\bigl{(}y\mid x;\;w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m2.4"><semantics id="S4.SS1.p1.7.m2.4a"><mrow id="S4.SS1.p1.7.m2.4.4" xref="S4.SS1.p1.7.m2.4.4.cmml"><mi id="S4.SS1.p1.7.m2.4.4.3" xref="S4.SS1.p1.7.m2.4.4.3.cmml">P</mi><mo id="S4.SS1.p1.7.m2.4.4.2" xref="S4.SS1.p1.7.m2.4.4.2.cmml">⁢</mo><mrow id="S4.SS1.p1.7.m2.4.4.1.1" xref="S4.SS1.p1.7.m2.4.4.1.1.1.cmml"><mo id="S4.SS1.p1.7.m2.4.4.1.1.2" maxsize="120%" minsize="120%" xref="S4.SS1.p1.7.m2.4.4.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.7.m2.4.4.1.1.1" xref="S4.SS1.p1.7.m2.4.4.1.1.1.cmml"><mi id="S4.SS1.p1.7.m2.4.4.1.1.1.4" xref="S4.SS1.p1.7.m2.4.4.1.1.1.4.cmml">y</mi><mo id="S4.SS1.p1.7.m2.4.4.1.1.1.3" xref="S4.SS1.p1.7.m2.4.4.1.1.1.3.cmml">∣</mo><mrow id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.3.cmml"><mi id="S4.SS1.p1.7.m2.3.3" xref="S4.SS1.p1.7.m2.3.3.cmml">x</mi><mo id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.3" rspace="0.447em" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.3.cmml">;</mo><msubsup id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.2" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.3.cmml">g</mi><mrow id="S4.SS1.p1.7.m2.1.1.1.3" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p1.7.m2.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.SS1.p1.7.m2.1.1.1.1" xref="S4.SS1.p1.7.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.7.m2.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.4" rspace="0.337em" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.cmml"><mi id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.2" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.2.cmml">w</mi><mi id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.3" mathvariant="normal" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.7.m2.2.2.1.3" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.cmml"><mo id="S4.SS1.p1.7.m2.2.2.1.3.1" stretchy="false" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.cmml">(</mo><mi id="S4.SS1.p1.7.m2.2.2.1.1" xref="S4.SS1.p1.7.m2.2.2.1.1.cmml">i</mi><mo id="S4.SS1.p1.7.m2.2.2.1.3.2" stretchy="false" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.SS1.p1.7.m2.4.4.1.1.3" maxsize="120%" minsize="120%" xref="S4.SS1.p1.7.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m2.4b"><apply id="S4.SS1.p1.7.m2.4.4.cmml" xref="S4.SS1.p1.7.m2.4.4"><times id="S4.SS1.p1.7.m2.4.4.2.cmml" xref="S4.SS1.p1.7.m2.4.4.2"></times><ci id="S4.SS1.p1.7.m2.4.4.3.cmml" xref="S4.SS1.p1.7.m2.4.4.3">𝑃</ci><apply id="S4.SS1.p1.7.m2.4.4.1.1.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1"><csymbol cd="latexml" id="S4.SS1.p1.7.m2.4.4.1.1.1.3.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.3">conditional</csymbol><ci id="S4.SS1.p1.7.m2.4.4.1.1.1.4.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.4">𝑦</ci><list id="S4.SS1.p1.7.m2.4.4.1.1.1.2.3.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2"><ci id="S4.SS1.p1.7.m2.3.3.cmml" xref="S4.SS1.p1.7.m2.3.3">𝑥</ci><apply id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.1.1.1.2.3">g</ci></apply><ci id="S4.SS1.p1.7.m2.1.1.1.1.cmml" xref="S4.SS1.p1.7.m2.1.1.1.1">𝑖</ci></apply><apply id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.1.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.2.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.2">𝑤</ci><ci id="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.3.cmml" xref="S4.SS1.p1.7.m2.4.4.1.1.1.2.2.2.2.3">l</ci></apply><ci id="S4.SS1.p1.7.m2.2.2.1.1.cmml" xref="S4.SS1.p1.7.m2.2.2.1.1">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m2.4c">P\bigl{(}y\mid x;\;w_{\mathrm{g}}^{(i)},\,w_{\mathrm{l}}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m2.4d">italic_P ( italic_y ∣ italic_x ; italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>.
Based on this, we now investigate how the difference of these gradients across two distinct
clients <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m3.1"><semantics id="S4.SS1.p1.8.m3.1a"><mi id="S4.SS1.p1.8.m3.1.1" xref="S4.SS1.p1.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m3.1b"><ci id="S4.SS1.p1.8.m3.1.1.cmml" xref="S4.SS1.p1.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m4.1"><semantics id="S4.SS1.p1.9.m4.1a"><mi id="S4.SS1.p1.9.m4.1.1" xref="S4.SS1.p1.9.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m4.1b"><ci id="S4.SS1.p1.9.m4.1.1.cmml" xref="S4.SS1.p1.9.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m4.1d">italic_j</annotation></semantics></math> can be bounded.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.1.1.1">Theorem 4.1</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.3"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.3.3">(Gradient Difference Bound)
Let <math alttext="i" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.2.2.m2.1"><semantics id="S4.Thmtheorem1.p1.2.2.m2.1a"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.2.2.m2.1b"><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.2.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.2.2.m2.1d">italic_j</annotation></semantics></math> be two distinct clients. Then the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.3.3.m3.1"><semantics id="S4.Thmtheorem1.p1.3.3.m3.1a"><msub id="S4.Thmtheorem1.p1.3.3.m3.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.2" mathvariant="normal" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">ℓ</mi><mn id="S4.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.3.3.m3.1b"><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2">ℓ</ci><cn id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.3.3.m3.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.3.3.m3.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-norm of the difference
between their global-parameter gradients satisfies</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Bigl{\|}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;-\;\nabla_{w_{\mathrm{g}}^{(%
j)}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\Bigl{[}\kappa\bigl{(}w_{\mathrm{l}}^{(i%
)}\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\Bigr{]}," class="ltx_Math" display="block" id="S4.Ex3.m1.7"><semantics id="S4.Ex3.m1.7a"><mrow id="S4.Ex3.m1.7.7.1" xref="S4.Ex3.m1.7.7.1.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1" xref="S4.Ex3.m1.7.7.1.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml"><mo fence="true" id="S4.Ex3.m1.7.7.1.1.1.1.2" mathsize="160%" rspace="0em" xref="S4.Ex3.m1.7.7.1.1.1.2.1.cmml">∥</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.cmml"><msub id="S4.Ex3.m1.7.7.1.1.1.1.1.2.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.2" rspace="0.167em" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="S4.Ex3.m1.1.1.1" xref="S4.Ex3.m1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.3.2" xref="S4.Ex3.m1.1.1.1.3.2.cmml">w</mi><mi id="S4.Ex3.m1.1.1.1.3.3" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.3.3.cmml">g</mi><mrow id="S4.Ex3.m1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.cmml"><mo id="S4.Ex3.m1.1.1.1.1.1.3.1" stretchy="false" xref="S4.Ex3.m1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.Ex3.m1.1.1.1.1.1.3.2" stretchy="false" xref="S4.Ex3.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="S4.Ex3.m1.7.7.1.1.1.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.2" mathvariant="normal" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.2.cmml">ℓ</mi><mrow id="S4.Ex3.m1.2.2.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.cmml"><mo id="S4.Ex3.m1.2.2.1.3.1" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.cmml">(</mo><mi id="S4.Ex3.m1.2.2.1.1" xref="S4.Ex3.m1.2.2.1.1.cmml">i</mi><mo id="S4.Ex3.m1.2.2.1.3.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1" rspace="0.502em" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.cmml"><msub id="S4.Ex3.m1.7.7.1.1.1.1.1.3.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.2" rspace="0.167em" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="S4.Ex3.m1.3.3.1" xref="S4.Ex3.m1.3.3.1.cmml"><mi id="S4.Ex3.m1.3.3.1.3.2" xref="S4.Ex3.m1.3.3.1.3.2.cmml">w</mi><mi id="S4.Ex3.m1.3.3.1.3.3" mathvariant="normal" xref="S4.Ex3.m1.3.3.1.3.3.cmml">g</mi><mrow id="S4.Ex3.m1.3.3.1.1.1.3" xref="S4.Ex3.m1.3.3.1.cmml"><mo id="S4.Ex3.m1.3.3.1.1.1.3.1" stretchy="false" xref="S4.Ex3.m1.3.3.1.cmml">(</mo><mi id="S4.Ex3.m1.3.3.1.1.1.1" xref="S4.Ex3.m1.3.3.1.1.1.1.cmml">j</mi><mo id="S4.Ex3.m1.3.3.1.1.1.3.2" stretchy="false" xref="S4.Ex3.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="S4.Ex3.m1.7.7.1.1.1.1.1.3.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="S4.Ex3.m1.4.4.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.cmml"><mo id="S4.Ex3.m1.4.4.1.3.1" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.cmml">(</mo><mi id="S4.Ex3.m1.4.4.1.1" xref="S4.Ex3.m1.4.4.1.1.cmml">j</mi><mo id="S4.Ex3.m1.4.4.1.3.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="S4.Ex3.m1.7.7.1.1.1.1.3" lspace="0em" mathsize="160%" xref="S4.Ex3.m1.7.7.1.1.1.2.1.cmml">∥</mo></mrow><mo id="S4.Ex3.m1.7.7.1.1.3" xref="S4.Ex3.m1.7.7.1.1.3.cmml">≤</mo><mrow id="S4.Ex3.m1.7.7.1.1.2" xref="S4.Ex3.m1.7.7.1.1.2.cmml"><mn id="S4.Ex3.m1.7.7.1.1.2.3" xref="S4.Ex3.m1.7.7.1.1.2.3.cmml"> 2</mn><mo id="S4.Ex3.m1.7.7.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.2.2.cmml">⁢</mo><mi id="S4.Ex3.m1.7.7.1.1.2.4" xref="S4.Ex3.m1.7.7.1.1.2.4.cmml">τ</mi><mo id="S4.Ex3.m1.7.7.1.1.2.2a" lspace="0.170em" xref="S4.Ex3.m1.7.7.1.1.2.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.2.cmml"><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.Ex3.m1.7.7.1.1.2.1.2.1.cmml">[</mo><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.cmml"><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.3.cmml">κ</mi><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml">l</mi><mrow id="S4.Ex3.m1.5.5.1.3" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.3.1" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.5.5.1.1" xref="S4.Ex3.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex3.m1.5.5.1.3.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.3.cmml">+</mo><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.cmml"><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.3" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.3.cmml">κ</mi><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><msubsup id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml">w</mi><mi id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3" mathvariant="normal" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml">l</mi><mrow id="S4.Ex3.m1.6.6.1.3" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="S4.Ex3.m1.6.6.1.3.1" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.6.6.1.1" xref="S4.Ex3.m1.6.6.1.1.cmml">j</mi><mo id="S4.Ex3.m1.6.6.1.3.2" stretchy="false" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex3.m1.7.7.1.1.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.Ex3.m1.7.7.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.Ex3.m1.7.7.1.2" xref="S4.Ex3.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.7b"><apply id="S4.Ex3.m1.7.7.1.1.cmml" xref="S4.Ex3.m1.7.7.1"><leq id="S4.Ex3.m1.7.7.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.3"></leq><apply id="S4.Ex3.m1.7.7.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.7.7.1.1.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1"><minus id="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1"></minus><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2"><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.1">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.1.2">∇</ci><apply id="S4.Ex3.m1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1">superscript</csymbol><apply id="S4.Ex3.m1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.1.1.1.3.2">𝑤</ci><ci id="S4.Ex3.m1.1.1.1.3.3.cmml" xref="S4.Ex3.m1.1.1.1.3.3">g</ci></apply><ci id="S4.Ex3.m1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.2.2.2">ℓ</ci><ci id="S4.Ex3.m1.2.2.1.1.cmml" xref="S4.Ex3.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3"><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.1.2">∇</ci><apply id="S4.Ex3.m1.3.3.1.cmml" xref="S4.Ex3.m1.3.3.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.3.3.1.2.cmml" xref="S4.Ex3.m1.3.3.1">superscript</csymbol><apply id="S4.Ex3.m1.3.3.1.3.cmml" xref="S4.Ex3.m1.3.3.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.3.3.1.3.1.cmml" xref="S4.Ex3.m1.3.3.1">subscript</csymbol><ci id="S4.Ex3.m1.3.3.1.3.2.cmml" xref="S4.Ex3.m1.3.3.1.3.2">𝑤</ci><ci id="S4.Ex3.m1.3.3.1.3.3.cmml" xref="S4.Ex3.m1.3.3.1.3.3">g</ci></apply><ci id="S4.Ex3.m1.3.3.1.1.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.3.2.2">ℓ</ci><ci id="S4.Ex3.m1.4.4.1.1.cmml" xref="S4.Ex3.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2"><times id="S4.Ex3.m1.7.7.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.2"></times><cn id="S4.Ex3.m1.7.7.1.1.2.3.cmml" type="integer" xref="S4.Ex3.m1.7.7.1.1.2.3">2</cn><ci id="S4.Ex3.m1.7.7.1.1.2.4.cmml" xref="S4.Ex3.m1.7.7.1.1.2.4">𝜏</ci><apply id="S4.Ex3.m1.7.7.1.1.2.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.7.7.1.1.2.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1"><plus id="S4.Ex3.m1.7.7.1.1.2.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.3"></plus><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1"><times id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.2"></times><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.3">𝜅</ci><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3">l</ci></apply><ci id="S4.Ex3.m1.5.5.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1">𝑖</ci></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2"><times id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.2"></times><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.3.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.3">𝜅</ci><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1">superscript</csymbol><apply id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2">𝑤</ci><ci id="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml" xref="S4.Ex3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3">l</ci></apply><ci id="S4.Ex3.m1.6.6.1.1.cmml" xref="S4.Ex3.m1.6.6.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.7c">\Bigl{\|}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;-\;\nabla_{w_{\mathrm{g}}^{(%
j)}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\Bigl{[}\kappa\bigl{(}w_{\mathrm{l}}^{(i%
)}\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\Bigr{]},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.7d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ ≤ 2 italic_τ [ italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) + italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.Thmtheorem1.p1.6"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.6.3">where <math alttext="\kappa(\cdot)" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.4.1.m1.1"><semantics id="S4.Thmtheorem1.p1.4.1.m1.1a"><mrow id="S4.Thmtheorem1.p1.4.1.m1.1.2" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.cmml"><mi id="S4.Thmtheorem1.p1.4.1.m1.1.2.2" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.2.cmml">κ</mi><mo id="S4.Thmtheorem1.p1.4.1.m1.1.2.1" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.4.1.m1.1.2.3.2" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.cmml"><mo id="S4.Thmtheorem1.p1.4.1.m1.1.2.3.2.1" stretchy="false" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.cmml">(</mo><mo id="S4.Thmtheorem1.p1.4.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.Thmtheorem1.p1.4.1.m1.1.1.cmml">⋅</mo><mo id="S4.Thmtheorem1.p1.4.1.m1.1.2.3.2.2" stretchy="false" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.4.1.m1.1b"><apply id="S4.Thmtheorem1.p1.4.1.m1.1.2.cmml" xref="S4.Thmtheorem1.p1.4.1.m1.1.2"><times id="S4.Thmtheorem1.p1.4.1.m1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.1"></times><ci id="S4.Thmtheorem1.p1.4.1.m1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.4.1.m1.1.2.2">𝜅</ci><ci id="S4.Thmtheorem1.p1.4.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.4.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.4.1.m1.1c">\kappa(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.4.1.m1.1d">italic_κ ( ⋅ )</annotation></semantics></math> is the condition number of the corresponding linear transformation.
Moreover, if <math alttext="\kappa\bigl{(}w_{\mathrm{l}}^{(i)}\bigr{)}=\kappa\bigl{(}w_{\mathrm{l}}^{(j)}%
\bigr{)}=1" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.5.2.m2.4"><semantics id="S4.Thmtheorem1.p1.5.2.m2.4a"><mrow id="S4.Thmtheorem1.p1.5.2.m2.4.4" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.cmml"><mrow id="S4.Thmtheorem1.p1.5.2.m2.3.3.1" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.cmml"><mi id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.3" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.3.cmml">κ</mi><mo id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.2" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml"><mo id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml">(</mo><msubsup id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.2" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.2.cmml">w</mi><mi id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.3.cmml">l</mi><mrow id="S4.Thmtheorem1.p1.5.2.m2.1.1.1.3" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml"><mo id="S4.Thmtheorem1.p1.5.2.m2.1.1.1.3.1" stretchy="false" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S4.Thmtheorem1.p1.5.2.m2.1.1.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.Thmtheorem1.p1.5.2.m2.1.1.1.3.2" stretchy="false" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Thmtheorem1.p1.5.2.m2.4.4.4" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.4.cmml">=</mo><mrow id="S4.Thmtheorem1.p1.5.2.m2.4.4.2" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.cmml"><mi id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.3" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.3.cmml">κ</mi><mo id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.2" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.2.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml"><mo id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.2" maxsize="120%" minsize="120%" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml">(</mo><msubsup id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.2" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.2.cmml">w</mi><mi id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.3" mathvariant="normal" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.3.cmml">l</mi><mrow id="S4.Thmtheorem1.p1.5.2.m2.2.2.1.3" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml"><mo id="S4.Thmtheorem1.p1.5.2.m2.2.2.1.3.1" stretchy="false" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml">(</mo><mi id="S4.Thmtheorem1.p1.5.2.m2.2.2.1.1" xref="S4.Thmtheorem1.p1.5.2.m2.2.2.1.1.cmml">j</mi><mo id="S4.Thmtheorem1.p1.5.2.m2.2.2.1.3.2" stretchy="false" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.3" maxsize="120%" minsize="120%" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Thmtheorem1.p1.5.2.m2.4.4.5" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.5.cmml">=</mo><mn id="S4.Thmtheorem1.p1.5.2.m2.4.4.6" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.5.2.m2.4b"><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4"><and id="S4.Thmtheorem1.p1.5.2.m2.4.4a.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4"></and><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4b.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4"><eq id="S4.Thmtheorem1.p1.5.2.m2.4.4.4.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.4"></eq><apply id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1"><times id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.2"></times><ci id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.3.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.3">𝜅</ci><apply id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1">superscript</csymbol><apply id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.2">𝑤</ci><ci id="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.3.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.3.3.1.1.1.1.2.3">l</ci></apply><ci id="S4.Thmtheorem1.p1.5.2.m2.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.1.1.1.1">𝑖</ci></apply></apply><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2"><times id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.2"></times><ci id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.3.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.3">𝜅</ci><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1">superscript</csymbol><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1">subscript</csymbol><ci id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.2">𝑤</ci><ci id="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.3.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.2.1.1.1.2.3">l</ci></apply><ci id="S4.Thmtheorem1.p1.5.2.m2.2.2.1.1.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="S4.Thmtheorem1.p1.5.2.m2.4.4c.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4"><eq id="S4.Thmtheorem1.p1.5.2.m2.4.4.5.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.5"></eq><share href="https://arxiv.org/html/2505.19888v1#S4.Thmtheorem1.p1.5.2.m2.4.4.2.cmml" id="S4.Thmtheorem1.p1.5.2.m2.4.4d.cmml" xref="S4.Thmtheorem1.p1.5.2.m2.4.4"></share><cn id="S4.Thmtheorem1.p1.5.2.m2.4.4.6.cmml" type="integer" xref="S4.Thmtheorem1.p1.5.2.m2.4.4.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.5.2.m2.4c">\kappa\bigl{(}w_{\mathrm{l}}^{(i)}\bigr{)}=\kappa\bigl{(}w_{\mathrm{l}}^{(j)}%
\bigr{)}=1</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.5.2.m2.4d">italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) = italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) = 1</annotation></semantics></math>,
then the bound becomes <math alttext="4\tau" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.6.3.m3.1"><semantics id="S4.Thmtheorem1.p1.6.3.m3.1a"><mrow id="S4.Thmtheorem1.p1.6.3.m3.1.1" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.cmml"><mn id="S4.Thmtheorem1.p1.6.3.m3.1.1.2" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.2.cmml">4</mn><mo id="S4.Thmtheorem1.p1.6.3.m3.1.1.1" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.6.3.m3.1.1.3" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.6.3.m3.1b"><apply id="S4.Thmtheorem1.p1.6.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.6.3.m3.1.1"><times id="S4.Thmtheorem1.p1.6.3.m3.1.1.1.cmml" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.1"></times><cn id="S4.Thmtheorem1.p1.6.3.m3.1.1.2.cmml" type="integer" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.2">4</cn><ci id="S4.Thmtheorem1.p1.6.3.m3.1.1.3.cmml" xref="S4.Thmtheorem1.p1.6.3.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.6.3.m3.1c">4\tau</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.6.3.m3.1d">4 italic_τ</annotation></semantics></math>, which is the smallest value possible.
For a detailed proof, see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5" title="Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">E</span></a>.</span></p>
</div>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Implications.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.3">This theorem indicates that if each local linear transformation <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.1.m1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.2.cmml">w</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.3" mathvariant="normal" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.3.cmml">l</mi><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.cmml"><mo id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2">superscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.2">𝑤</ci><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.2.2.3">l</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is <em class="ltx_emph ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.3.1">orthogonal</em> (hence <math alttext="\kappa=1" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">κ</mi><mo id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><eq id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝜅</ci><cn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">\kappa=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_κ = 1</annotation></semantics></math>), the gradient mismatch among clients is tightly bounded by <math alttext="4\tau" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">4</mn><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1"></times><cn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2">4</cn><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">4\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.1d">4 italic_τ</annotation></semantics></math>.
Thus, orthogonality <em class="ltx_emph ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.3.2">directly</em> reduces gradient conflicts between clients in FL, facilitating stable global parameters’ updates even under heterogeneous clients (i.e., non-IID data distributions).</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Benefits of Orthogonal Transformations</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.7">A matrix <math alttext="Q\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">Q</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.3.2" xref="S4.SS2.p1.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S4.SS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.1.m1.1.1.3.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><in id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></in><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑄</ci><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3"><times id="S4.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3.2">𝑑</ci><ci id="S4.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">Q\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is orthogonal, if <math alttext="Q^{\top}Q=I" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mrow id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><msup id="S4.SS2.p1.2.m2.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.2.cmml">Q</mi><mo id="S4.SS2.p1.2.m2.1.1.2.2.3" xref="S4.SS2.p1.2.m2.1.1.2.2.3.cmml">⊤</mo></msup><mo id="S4.SS2.p1.2.m2.1.1.2.1" xref="S4.SS2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.2.m2.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.2.3.cmml">Q</mi></mrow><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><eq id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></eq><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><times id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2.1"></times><apply id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.2">𝑄</ci><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.2.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.3">top</csymbol></apply><ci id="S4.SS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.3">𝑄</ci></apply><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">Q^{\top}Q=I</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_Q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_Q = italic_I</annotation></semantics></math>.
Moreover, all eigenvalues of <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_Q</annotation></semantics></math> lie on <math alttext="\{\pm 1\}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.2.cmml"><mo id="S4.SS2.p1.4.m4.1.1.1.2" stretchy="false" xref="S4.SS2.p1.4.m4.1.1.2.cmml">{</mo><mrow id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml"><mo id="S4.SS2.p1.4.m4.1.1.1.1a" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml">±</mo><mn id="S4.SS2.p1.4.m4.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.cmml">1</mn></mrow><mo id="S4.SS2.p1.4.m4.1.1.1.3" stretchy="false" xref="S4.SS2.p1.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><set id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1"><apply id="S4.SS2.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1">plus-or-minus</csymbol><cn id="S4.SS2.p1.4.m4.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.1.1.2">1</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\{\pm 1\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">{ ± 1 }</annotation></semantics></math>, so <math alttext="\kappa(Q)=1" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.2" xref="S4.SS2.p1.5.m5.1.2.cmml"><mrow id="S4.SS2.p1.5.m5.1.2.2" xref="S4.SS2.p1.5.m5.1.2.2.cmml"><mi id="S4.SS2.p1.5.m5.1.2.2.2" xref="S4.SS2.p1.5.m5.1.2.2.2.cmml">κ</mi><mo id="S4.SS2.p1.5.m5.1.2.2.1" xref="S4.SS2.p1.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.5.m5.1.2.2.3.2" xref="S4.SS2.p1.5.m5.1.2.2.cmml"><mo id="S4.SS2.p1.5.m5.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p1.5.m5.1.2.2.cmml">(</mo><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">Q</mi><mo id="S4.SS2.p1.5.m5.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p1.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.5.m5.1.2.1" xref="S4.SS2.p1.5.m5.1.2.1.cmml">=</mo><mn id="S4.SS2.p1.5.m5.1.2.3" xref="S4.SS2.p1.5.m5.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.2.cmml" xref="S4.SS2.p1.5.m5.1.2"><eq id="S4.SS2.p1.5.m5.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.2.1"></eq><apply id="S4.SS2.p1.5.m5.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.2.2"><times id="S4.SS2.p1.5.m5.1.2.2.1.cmml" xref="S4.SS2.p1.5.m5.1.2.2.1"></times><ci id="S4.SS2.p1.5.m5.1.2.2.2.cmml" xref="S4.SS2.p1.5.m5.1.2.2.2">𝜅</ci><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑄</ci></apply><cn id="S4.SS2.p1.5.m5.1.2.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\kappa(Q)=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_κ ( italic_Q ) = 1</annotation></semantics></math>. (Refer to <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.SS4.SSS3" title="E.4.3 Condition Number of a Orthogonal Transformation ‣ E.4 Degree of Freedom in Orthogonal and Block-Orthogonal Transformations ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">E.4.3</span></a> for the proof.)
Hence, substituting <math alttext="w_{\mathrm{l}}^{(i)}=Q" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><mrow id="S4.SS2.p1.6.m6.1.2" xref="S4.SS2.p1.6.m6.1.2.cmml"><msubsup id="S4.SS2.p1.6.m6.1.2.2" xref="S4.SS2.p1.6.m6.1.2.2.cmml"><mi id="S4.SS2.p1.6.m6.1.2.2.2.2" xref="S4.SS2.p1.6.m6.1.2.2.2.2.cmml">w</mi><mi id="S4.SS2.p1.6.m6.1.2.2.2.3" mathvariant="normal" xref="S4.SS2.p1.6.m6.1.2.2.2.3.cmml">l</mi><mrow id="S4.SS2.p1.6.m6.1.1.1.3" xref="S4.SS2.p1.6.m6.1.2.2.cmml"><mo id="S4.SS2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S4.SS2.p1.6.m6.1.2.2.cmml">(</mo><mi id="S4.SS2.p1.6.m6.1.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S4.SS2.p1.6.m6.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p1.6.m6.1.2.1" xref="S4.SS2.p1.6.m6.1.2.1.cmml">=</mo><mi id="S4.SS2.p1.6.m6.1.2.3" xref="S4.SS2.p1.6.m6.1.2.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.2.cmml" xref="S4.SS2.p1.6.m6.1.2"><eq id="S4.SS2.p1.6.m6.1.2.1.cmml" xref="S4.SS2.p1.6.m6.1.2.1"></eq><apply id="S4.SS2.p1.6.m6.1.2.2.cmml" xref="S4.SS2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.2.2.1.cmml" xref="S4.SS2.p1.6.m6.1.2.2">superscript</csymbol><apply id="S4.SS2.p1.6.m6.1.2.2.2.cmml" xref="S4.SS2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.1.2.2.2.2">𝑤</ci><ci id="S4.SS2.p1.6.m6.1.2.2.2.3.cmml" xref="S4.SS2.p1.6.m6.1.2.2.2.3">l</ci></apply><ci id="S4.SS2.p1.6.m6.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1">𝑖</ci></apply><ci id="S4.SS2.p1.6.m6.1.2.3.cmml" xref="S4.SS2.p1.6.m6.1.2.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">w_{\mathrm{l}}^{(i)}=Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_Q</annotation></semantics></math> into Theorem <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.1 Bounding the Gradient Difference Between Clients ‣ 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4.1</span></a> yields the minimal possible mismatch bound of <math alttext="4\tau" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mn id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">4</mn><mo id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><times id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1"></times><cn id="S4.SS2.p1.7.m7.1.1.2.cmml" type="integer" xref="S4.SS2.p1.7.m7.1.1.2">4</cn><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">4\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">4 italic_τ</annotation></semantics></math>.
This property preserves distances and angles in the visual feature space, preventing feature collapse while maintaining the semantic property of the pre-trained foundation model’s representation.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Geometric and Semantic Advantages.</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.4">In addition to bounding gradient discrepancies, orthogonal transformations are invertible, thereby one-to-one, ensuring that distinct features <math alttext="\{\mathcal{I}(x)\}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.2"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.2a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.2.cmml"><mo id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.2.cmml">{</mo><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.2.cmml">ℐ</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">x</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.2b"><set id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1"><times id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.1"></times><ci id="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.2">ℐ</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">𝑥</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.2c">\{\mathcal{I}(x)\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.2d">{ caligraphic_I ( italic_x ) }</annotation></semantics></math> remain distinct after transformation.
Furthermore, an orthogonal matrix in <math alttext="\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><msup id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">d</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">ℝ</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3"><times id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> has <math alttext="\tfrac{d(d-1)}{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.1a"><mfrac id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.3.cmml">d</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.2.cmml">d</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1"><divide id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1"></divide><apply id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1"><times id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.3">𝑑</ci><apply id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.2">𝑑</ci><cn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.3">1</cn></apply></apply><cn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.1c">\tfrac{d(d-1)}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.1d">divide start_ARG italic_d ( italic_d - 1 ) end_ARG start_ARG 2 end_ARG</annotation></semantics></math> degrees of freedom (DOF), approximately half that of a general linear transformation (<math alttext="d^{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><msup id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">d</mi><mn id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝑑</ci><cn id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">d^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m4.1d">italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>).
This reduction in DOF helps preserve the structure of the pre-trained manifold, mitigating excessive distortion and reducing the risk of overfitting to local data.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Block-Diagonal Orthogonal Transformations</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3">We can further reduce DOF via a <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.3.1">block-diagonal</em> design of orthogonal matrices.
Partition the dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_d</annotation></semantics></math> into <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_r</annotation></semantics></math> blocks, each block <math alttext="Q_{k}\in\mathbb{R}^{{d/r}\times{d/r}}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><msub id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.2.2.cmml">Q</mi><mi id="S4.SS3.p1.3.m3.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.3.3.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.3.3.2.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.3.2.2.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.2.cmml">d</mi><mo id="S4.SS3.p1.3.m3.1.1.3.3.2.2.1" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.1.cmml">/</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.2.2.3" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.3.cmml">r</mi></mrow><mo id="S4.SS3.p1.3.m3.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.2.3" xref="S4.SS3.p1.3.m3.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S4.SS3.p1.3.m3.1.1.3.3.1" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml">/</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><in id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></in><apply id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.2">𝑄</ci><ci id="S4.SS3.p1.3.m3.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3"><divide id="S4.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1"></divide><apply id="S4.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2"><times id="S4.SS3.p1.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.1"></times><apply id="S4.SS3.p1.3.m3.1.1.3.3.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2"><divide id="S4.SS3.p1.3.m3.1.1.3.3.2.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.1"></divide><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.2">𝑑</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.3">𝑟</ci></apply><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.3">𝑑</ci></apply><ci id="S4.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">Q_{k}\in\mathbb{R}^{{d/r}\times{d/r}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_Q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d / italic_r × italic_d / italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> being orthogonal:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="B\;=\;\mathrm{diag}\bigl{(}Q_{1},\,Q_{2},\,\dots,\,Q_{r}\bigr{)},\quad B^{\top%
}B\;=\;I." class="ltx_Math" display="block" id="S4.Ex4.m1.2"><semantics id="S4.Ex4.m1.2a"><mrow id="S4.Ex4.m1.2.2.1"><mrow id="S4.Ex4.m1.2.2.1.1.2" xref="S4.Ex4.m1.2.2.1.1.3.cmml"><mrow id="S4.Ex4.m1.2.2.1.1.1.1" xref="S4.Ex4.m1.2.2.1.1.1.1.cmml"><mi id="S4.Ex4.m1.2.2.1.1.1.1.5" xref="S4.Ex4.m1.2.2.1.1.1.1.5.cmml">B</mi><mo id="S4.Ex4.m1.2.2.1.1.1.1.4" lspace="0.558em" rspace="0.558em" xref="S4.Ex4.m1.2.2.1.1.1.1.4.cmml">=</mo><mrow id="S4.Ex4.m1.2.2.1.1.1.1.3" xref="S4.Ex4.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.Ex4.m1.2.2.1.1.1.1.3.5" xref="S4.Ex4.m1.2.2.1.1.1.1.3.5.cmml">diag</mi><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.4" xref="S4.Ex4.m1.2.2.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml"><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.4" maxsize="120%" minsize="120%" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml">(</mo><msub id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mn id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.5" rspace="0.337em" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.2" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.2.cmml">Q</mi><mn id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.3" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.6" rspace="0.337em" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml">,</mo><mi id="S4.Ex4.m1.1.1" mathvariant="normal" xref="S4.Ex4.m1.1.1.cmml">…</mi><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.7" rspace="0.337em" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.cmml"><mi id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.2" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.2.cmml">Q</mi><mi id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.3" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.3.cmml">r</mi></msub><mo id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.8" maxsize="120%" minsize="120%" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex4.m1.2.2.1.1.2.3" rspace="1.167em" xref="S4.Ex4.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S4.Ex4.m1.2.2.1.1.2.2" xref="S4.Ex4.m1.2.2.1.1.2.2.cmml"><mrow id="S4.Ex4.m1.2.2.1.1.2.2.2" xref="S4.Ex4.m1.2.2.1.1.2.2.2.cmml"><msup id="S4.Ex4.m1.2.2.1.1.2.2.2.2" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S4.Ex4.m1.2.2.1.1.2.2.2.2.2" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2.2.cmml">B</mi><mo id="S4.Ex4.m1.2.2.1.1.2.2.2.2.3" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2.3.cmml">⊤</mo></msup><mo id="S4.Ex4.m1.2.2.1.1.2.2.2.1" xref="S4.Ex4.m1.2.2.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.Ex4.m1.2.2.1.1.2.2.2.3" xref="S4.Ex4.m1.2.2.1.1.2.2.2.3.cmml">B</mi></mrow><mo id="S4.Ex4.m1.2.2.1.1.2.2.1" lspace="0.558em" rspace="0.558em" xref="S4.Ex4.m1.2.2.1.1.2.2.1.cmml">=</mo><mi id="S4.Ex4.m1.2.2.1.1.2.2.3" xref="S4.Ex4.m1.2.2.1.1.2.2.3.cmml">I</mi></mrow></mrow><mo id="S4.Ex4.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.2b"><apply id="S4.Ex4.m1.2.2.1.1.3.cmml" xref="S4.Ex4.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.1.1.3a.cmml" xref="S4.Ex4.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S4.Ex4.m1.2.2.1.1.1.1.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1"><eq id="S4.Ex4.m1.2.2.1.1.1.1.4.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.4"></eq><ci id="S4.Ex4.m1.2.2.1.1.1.1.5.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.5">𝐵</ci><apply id="S4.Ex4.m1.2.2.1.1.1.1.3.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3"><times id="S4.Ex4.m1.2.2.1.1.1.1.3.4.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.4"></times><ci id="S4.Ex4.m1.2.2.1.1.1.1.3.5.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.5">diag</ci><vector id="S4.Ex4.m1.2.2.1.1.1.1.3.3.4.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3"><apply id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.2">𝑄</ci><cn id="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.2">𝑄</ci><cn id="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S4.Ex4.m1.2.2.1.1.1.1.2.2.2.2.3">2</cn></apply><ci id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1">…</ci><apply id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.1.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.2.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.2">𝑄</ci><ci id="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.3.cmml" xref="S4.Ex4.m1.2.2.1.1.1.1.3.3.3.3.3">𝑟</ci></apply></vector></apply></apply><apply id="S4.Ex4.m1.2.2.1.1.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2"><eq id="S4.Ex4.m1.2.2.1.1.2.2.1.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.1"></eq><apply id="S4.Ex4.m1.2.2.1.1.2.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2"><times id="S4.Ex4.m1.2.2.1.1.2.2.2.1.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.1"></times><apply id="S4.Ex4.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.Ex4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2.2">𝐵</ci><csymbol cd="latexml" id="S4.Ex4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.2.3">top</csymbol></apply><ci id="S4.Ex4.m1.2.2.1.1.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.2.3">𝐵</ci></apply><ci id="S4.Ex4.m1.2.2.1.1.2.2.3.cmml" xref="S4.Ex4.m1.2.2.1.1.2.2.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.2c">B\;=\;\mathrm{diag}\bigl{(}Q_{1},\,Q_{2},\,\dots,\,Q_{r}\bigr{)},\quad B^{\top%
}B\;=\;I.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.2d">italic_B = roman_diag ( italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_Q start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_B start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_B = italic_I .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.6">Since each <math alttext="Q_{k}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m1.1"><semantics id="S4.SS3.p1.4.m1.1a"><msub id="S4.SS3.p1.4.m1.1.1" xref="S4.SS3.p1.4.m1.1.1.cmml"><mi id="S4.SS3.p1.4.m1.1.1.2" xref="S4.SS3.p1.4.m1.1.1.2.cmml">Q</mi><mi id="S4.SS3.p1.4.m1.1.1.3" xref="S4.SS3.p1.4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m1.1b"><apply id="S4.SS3.p1.4.m1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m1.1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m1.1.1.2.cmml" xref="S4.SS3.p1.4.m1.1.1.2">𝑄</ci><ci id="S4.SS3.p1.4.m1.1.1.3.cmml" xref="S4.SS3.p1.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m1.1c">Q_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m1.1d">italic_Q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is orthogonal, <math alttext="\kappa(B)=1" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m2.1"><semantics id="S4.SS3.p1.5.m2.1a"><mrow id="S4.SS3.p1.5.m2.1.2" xref="S4.SS3.p1.5.m2.1.2.cmml"><mrow id="S4.SS3.p1.5.m2.1.2.2" xref="S4.SS3.p1.5.m2.1.2.2.cmml"><mi id="S4.SS3.p1.5.m2.1.2.2.2" xref="S4.SS3.p1.5.m2.1.2.2.2.cmml">κ</mi><mo id="S4.SS3.p1.5.m2.1.2.2.1" xref="S4.SS3.p1.5.m2.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS3.p1.5.m2.1.2.2.3.2" xref="S4.SS3.p1.5.m2.1.2.2.cmml"><mo id="S4.SS3.p1.5.m2.1.2.2.3.2.1" stretchy="false" xref="S4.SS3.p1.5.m2.1.2.2.cmml">(</mo><mi id="S4.SS3.p1.5.m2.1.1" xref="S4.SS3.p1.5.m2.1.1.cmml">B</mi><mo id="S4.SS3.p1.5.m2.1.2.2.3.2.2" stretchy="false" xref="S4.SS3.p1.5.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.5.m2.1.2.1" xref="S4.SS3.p1.5.m2.1.2.1.cmml">=</mo><mn id="S4.SS3.p1.5.m2.1.2.3" xref="S4.SS3.p1.5.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m2.1b"><apply id="S4.SS3.p1.5.m2.1.2.cmml" xref="S4.SS3.p1.5.m2.1.2"><eq id="S4.SS3.p1.5.m2.1.2.1.cmml" xref="S4.SS3.p1.5.m2.1.2.1"></eq><apply id="S4.SS3.p1.5.m2.1.2.2.cmml" xref="S4.SS3.p1.5.m2.1.2.2"><times id="S4.SS3.p1.5.m2.1.2.2.1.cmml" xref="S4.SS3.p1.5.m2.1.2.2.1"></times><ci id="S4.SS3.p1.5.m2.1.2.2.2.cmml" xref="S4.SS3.p1.5.m2.1.2.2.2">𝜅</ci><ci id="S4.SS3.p1.5.m2.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1">𝐵</ci></apply><cn id="S4.SS3.p1.5.m2.1.2.3.cmml" type="integer" xref="S4.SS3.p1.5.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m2.1c">\kappa(B)=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m2.1d">italic_κ ( italic_B ) = 1</annotation></semantics></math>.
This preserves the lowest bound in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.1 Bounding the Gradient Difference Between Clients ‣ 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4.1</span></a> while lowering the DOF to
<math alttext="\displaystyle r\times\frac{\bigl{(}{d}/{r}\bigr{)}\bigl{(}{d}/{r}-1\bigr{)}}{2%
}=\frac{d\bigl{(}{d}/{r}-1\bigr{)}}{2}" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m3.3"><semantics id="S4.SS3.p1.6.m3.3a"><mrow id="S4.SS3.p1.6.m3.3.4" xref="S4.SS3.p1.6.m3.3.4.cmml"><mrow id="S4.SS3.p1.6.m3.3.4.2" xref="S4.SS3.p1.6.m3.3.4.2.cmml"><mi id="S4.SS3.p1.6.m3.3.4.2.2" xref="S4.SS3.p1.6.m3.3.4.2.2.cmml">r</mi><mo id="S4.SS3.p1.6.m3.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.6.m3.3.4.2.1.cmml">×</mo><mstyle displaystyle="true" id="S4.SS3.p1.6.m3.2.2" xref="S4.SS3.p1.6.m3.2.2.cmml"><mfrac id="S4.SS3.p1.6.m3.2.2a" xref="S4.SS3.p1.6.m3.2.2.cmml"><mrow id="S4.SS3.p1.6.m3.2.2.2" xref="S4.SS3.p1.6.m3.2.2.2.cmml"><mrow id="S4.SS3.p1.6.m3.1.1.1.1.1" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.6.m3.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.6.m3.1.1.1.1.1.1" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.6.m3.1.1.1.1.1.1.2" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.2.cmml">d</mi><mo id="S4.SS3.p1.6.m3.1.1.1.1.1.1.1" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.1.cmml">/</mo><mi id="S4.SS3.p1.6.m3.1.1.1.1.1.1.3" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S4.SS3.p1.6.m3.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p1.6.m3.2.2.2.3" xref="S4.SS3.p1.6.m3.2.2.2.3.cmml">⁢</mo><mrow id="S4.SS3.p1.6.m3.2.2.2.2.1" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.cmml"><mo id="S4.SS3.p1.6.m3.2.2.2.2.1.2" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS3.p1.6.m3.2.2.2.2.1.1" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.cmml"><mrow id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.cmml"><mi id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.2" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.2.cmml">d</mi><mo id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.1" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.1.cmml">/</mo><mi id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.3" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.3.cmml">r</mi></mrow><mo id="S4.SS3.p1.6.m3.2.2.2.2.1.1.1" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.1.cmml">−</mo><mn id="S4.SS3.p1.6.m3.2.2.2.2.1.1.3" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p1.6.m3.2.2.2.2.1.3" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mn id="S4.SS3.p1.6.m3.2.2.4" xref="S4.SS3.p1.6.m3.2.2.4.cmml">2</mn></mfrac></mstyle></mrow><mo id="S4.SS3.p1.6.m3.3.4.1" xref="S4.SS3.p1.6.m3.3.4.1.cmml">=</mo><mstyle displaystyle="true" id="S4.SS3.p1.6.m3.3.3" xref="S4.SS3.p1.6.m3.3.3.cmml"><mfrac id="S4.SS3.p1.6.m3.3.3a" xref="S4.SS3.p1.6.m3.3.3.cmml"><mrow id="S4.SS3.p1.6.m3.3.3.1" xref="S4.SS3.p1.6.m3.3.3.1.cmml"><mi id="S4.SS3.p1.6.m3.3.3.1.3" xref="S4.SS3.p1.6.m3.3.3.1.3.cmml">d</mi><mo id="S4.SS3.p1.6.m3.3.3.1.2" xref="S4.SS3.p1.6.m3.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.6.m3.3.3.1.1.1" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.cmml"><mo id="S4.SS3.p1.6.m3.3.3.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.6.m3.3.3.1.1.1.1" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.cmml"><mrow id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.2" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.2.cmml">d</mi><mo id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.1" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.1.cmml">/</mo><mi id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.3" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S4.SS3.p1.6.m3.3.3.1.1.1.1.1" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.1.cmml">−</mo><mn id="S4.SS3.p1.6.m3.3.3.1.1.1.1.3" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p1.6.m3.3.3.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S4.SS3.p1.6.m3.3.3.3" xref="S4.SS3.p1.6.m3.3.3.3.cmml">2</mn></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m3.3b"><apply id="S4.SS3.p1.6.m3.3.4.cmml" xref="S4.SS3.p1.6.m3.3.4"><eq id="S4.SS3.p1.6.m3.3.4.1.cmml" xref="S4.SS3.p1.6.m3.3.4.1"></eq><apply id="S4.SS3.p1.6.m3.3.4.2.cmml" xref="S4.SS3.p1.6.m3.3.4.2"><times id="S4.SS3.p1.6.m3.3.4.2.1.cmml" xref="S4.SS3.p1.6.m3.3.4.2.1"></times><ci id="S4.SS3.p1.6.m3.3.4.2.2.cmml" xref="S4.SS3.p1.6.m3.3.4.2.2">𝑟</ci><apply id="S4.SS3.p1.6.m3.2.2.cmml" xref="S4.SS3.p1.6.m3.2.2"><divide id="S4.SS3.p1.6.m3.2.2.3.cmml" xref="S4.SS3.p1.6.m3.2.2"></divide><apply id="S4.SS3.p1.6.m3.2.2.2.cmml" xref="S4.SS3.p1.6.m3.2.2.2"><times id="S4.SS3.p1.6.m3.2.2.2.3.cmml" xref="S4.SS3.p1.6.m3.2.2.2.3"></times><apply id="S4.SS3.p1.6.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m3.1.1.1.1.1"><divide id="S4.SS3.p1.6.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.1"></divide><ci id="S4.SS3.p1.6.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.2">𝑑</ci><ci id="S4.SS3.p1.6.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.6.m3.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="S4.SS3.p1.6.m3.2.2.2.2.1.1.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1"><minus id="S4.SS3.p1.6.m3.2.2.2.2.1.1.1.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.1"></minus><apply id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2"><divide id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.1.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.1"></divide><ci id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.2.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.2">𝑑</ci><ci id="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.3.cmml" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.2.3">𝑟</ci></apply><cn id="S4.SS3.p1.6.m3.2.2.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p1.6.m3.2.2.2.2.1.1.3">1</cn></apply></apply><cn id="S4.SS3.p1.6.m3.2.2.4.cmml" type="integer" xref="S4.SS3.p1.6.m3.2.2.4">2</cn></apply></apply><apply id="S4.SS3.p1.6.m3.3.3.cmml" xref="S4.SS3.p1.6.m3.3.3"><divide id="S4.SS3.p1.6.m3.3.3.2.cmml" xref="S4.SS3.p1.6.m3.3.3"></divide><apply id="S4.SS3.p1.6.m3.3.3.1.cmml" xref="S4.SS3.p1.6.m3.3.3.1"><times id="S4.SS3.p1.6.m3.3.3.1.2.cmml" xref="S4.SS3.p1.6.m3.3.3.1.2"></times><ci id="S4.SS3.p1.6.m3.3.3.1.3.cmml" xref="S4.SS3.p1.6.m3.3.3.1.3">𝑑</ci><apply id="S4.SS3.p1.6.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1"><minus id="S4.SS3.p1.6.m3.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.1"></minus><apply id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2"><divide id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.1"></divide><ci id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.2">𝑑</ci><ci id="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.2.3">𝑟</ci></apply><cn id="S4.SS3.p1.6.m3.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.6.m3.3.3.1.1.1.1.3">1</cn></apply></apply><cn id="S4.SS3.p1.6.m3.3.3.3.cmml" type="integer" xref="S4.SS3.p1.6.m3.3.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m3.3c">\displaystyle r\times\frac{\bigl{(}{d}/{r}\bigr{)}\bigl{(}{d}/{r}-1\bigr{)}}{2%
}=\frac{d\bigl{(}{d}/{r}-1\bigr{)}}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m3.3d">italic_r × divide start_ARG ( italic_d / italic_r ) ( italic_d / italic_r - 1 ) end_ARG start_ARG 2 end_ARG = divide start_ARG italic_d ( italic_d / italic_r - 1 ) end_ARG start_ARG 2 end_ARG</annotation></semantics></math>,
potentially yielding a lighter yet still <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.6.1">orthogonally constrained</em> transform.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup</h3>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Datasets &amp; Baselines.</h5>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p1.1">We validate the robustness of our proposed method to domain heterogeneity by using five datasets, where each subset has unique domain characteristics: FEMNIST <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">RN679</span> </a></cite>, PACS <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib42" title=""><span class="ltx_text" style="font-size:90%;">RN774</span> </a></cite>, Office-Home <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib74" title=""><span class="ltx_text" style="font-size:90%;">RN776</span> </a></cite>, VLCS <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">fang2013unbiased</span> </a></cite>, TerraIncognita <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">RN777</span> </a></cite>.
These datasets range from simplistic, less complex toy datasets to real-world datasets that capture the intricacies of real-life scenarios.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p2.1">We compare our method with CLIP’s zero-shot performance and other parameter-efficient fine-tuning approaches.
Specifically, we introduce FedCLIP <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">RN587</span> </a></cite>, which incorporates an adapter positioned behind the CLIP image encoder.
For modality-wise prompt tuning in VLMs, we adopt PromptFL <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">guo2023promptfl</span> </a></cite> based on CoOp <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib85" title=""><span class="ltx_text" style="font-size:90%;">zhou2022learning</span> </a></cite>, and implement CoCoOp <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib84" title=""><span class="ltx_text" style="font-size:90%;">zhou2022conditional</span> </a></cite> and VPT <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib38" title=""><span class="ltx_text" style="font-size:90%;">jia2022visual</span> </a></cite> within the federated setting.
We also experimented FedAKT(C) and FedGH(C), a variant of FedAKT <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">liu2025adapter</span> </a></cite> and FedGH <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib79" title=""><span class="ltx_text" style="font-size:90%;">yi2023fedgh</span> </a></cite> that adopts CLIP as client models, to ensure a more fair comparison.
Meanwhile, we include a variant of our method, treating all trainable parameters as global parameters, referred to as FedAVG.
To further validate our approach, we introduce FedOT(+B), an extension which incorporates block-diagonal orthogonal transformations.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p3">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p3.1">Additional details on the datasets and implementation are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS1" title="F.1 Setup ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">F.1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5>
<div class="ltx_para" id="S5.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px2.p1.1">We evaluate the baselines and our method using generalization, personalization, and comprehensive accuracy.
One domain is used as the test set, and this process is iteratively repeated for all domains.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S5.SS1.SSS0.Px2.p2.8">Let <math alttext="\mathrm{ACC}_{j}^{(i)}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.1.m1.1"><semantics id="S5.SS1.SSS0.Px2.p2.1.m1.1a"><msubsup id="S5.SS1.SSS0.Px2.p2.1.m1.1.2" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.cmml"><mi id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.2" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.2.cmml">ACC</mi><mi id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.3" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.3.cmml">j</mi><mrow id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.3" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.cmml"><mo id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.cmml">(</mo><mi id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.1" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.2">ACC</ci><ci id="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.2.2.3">𝑗</ci></apply><ci id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.1.m1.1c">\mathrm{ACC}_{j}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.1.m1.1d">roman_ACC start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="i,j\in\{1,\cdots,N\}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.2.m2.5"><semantics id="S5.SS1.SSS0.Px2.p2.2.m2.5a"><mrow id="S5.SS1.SSS0.Px2.p2.2.m2.5.6" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.cmml"><mrow id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.2" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.1.cmml"><mi id="S5.SS1.SSS0.Px2.p2.2.m2.4.4" xref="S5.SS1.SSS0.Px2.p2.2.m2.4.4.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.2.1" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.1.cmml">,</mo><mi id="S5.SS1.SSS0.Px2.p2.2.m2.5.5" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.5.cmml">j</mi></mrow><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.1" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.1.cmml">∈</mo><mrow id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2.1" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml">{</mo><mn id="S5.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.cmml">1</mn><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2.2" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml">,</mo><mi id="S5.SS1.SSS0.Px2.p2.2.m2.2.2" mathvariant="normal" xref="S5.SS1.SSS0.Px2.p2.2.m2.2.2.cmml">⋯</mi><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2.3" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml">,</mo><mi id="S5.SS1.SSS0.Px2.p2.2.m2.3.3" xref="S5.SS1.SSS0.Px2.p2.2.m2.3.3.cmml">N</mi><mo id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2.4" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.2.m2.5b"><apply id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6"><in id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.1.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.1"></in><list id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.2.2"><ci id="S5.SS1.SSS0.Px2.p2.2.m2.4.4.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.4.4">𝑖</ci><ci id="S5.SS1.SSS0.Px2.p2.2.m2.5.5.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.5">𝑗</ci></list><set id="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.5.6.3.2"><cn id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1">1</cn><ci id="S5.SS1.SSS0.Px2.p2.2.m2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.2.2">⋯</ci><ci id="S5.SS1.SSS0.Px2.p2.2.m2.3.3.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.2.m2.5c">i,j\in\{1,\cdots,N\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.2.m2.5d">italic_i , italic_j ∈ { 1 , ⋯ , italic_N }</annotation></semantics></math>, denote the test accuracy of the <math alttext="i^{\text{th}}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.3.m3.1"><semantics id="S5.SS1.SSS0.Px2.p2.3.m3.1a"><msup id="S5.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.2" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.2.cmml">i</mi><mtext id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.3.m3.1b"><apply id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1">superscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.2">𝑖</ci><ci id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3a.cmml" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3"><mtext id="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S5.SS1.SSS0.Px2.p2.3.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.3.m3.1c">i^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.3.m3.1d">italic_i start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> client when the <math alttext="j^{\text{th}}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.4.m4.1"><semantics id="S5.SS1.SSS0.Px2.p2.4.m4.1a"><msup id="S5.SS1.SSS0.Px2.p2.4.m4.1.1" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.2" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml">j</mi><mtext id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.4.m4.1b"><apply id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1">superscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.2">𝑗</ci><ci id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3a.cmml" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3"><mtext id="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S5.SS1.SSS0.Px2.p2.4.m4.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.4.m4.1c">j^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.4.m4.1d">italic_j start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> client is a test client.
We define the following evaluation metrics to assess model performance <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">RN587</span> </a></cite>: (1) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS0.Px2.p2.8.1">Generalization</span> performance is quantified as <math alttext="\frac{1}{N}\sum_{i=1}^{N}\textrm{ACC}_{i}^{(i)}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.5.m5.1"><semantics id="S5.SS1.SSS0.Px2.p2.5.m5.1a"><mrow id="S5.SS1.SSS0.Px2.p2.5.m5.1.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.cmml"><mfrac id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.cmml"><mn id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.2.cmml">1</mn><mi id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.3.cmml">N</mi></mfrac><mo id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.1" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.cmml"><msubsup id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.2.cmml">∑</mo><mrow id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.2.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.1" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.3.cmml">N</mi></msubsup><msubsup id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.cmml"><mtext id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2a.cmml">ACC</mtext><mi id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.3.cmml">i</mi><mrow id="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.3" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.cmml"><mo id="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.3.1" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.cmml">(</mo><mi id="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.1" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.3.2" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.5.m5.1b"><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2"><times id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.1"></times><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2"><divide id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2"></divide><cn id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.2.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.2">1</cn><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.2.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3"><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1">subscript</csymbol><sum id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.2"></sum><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3"><eq id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.1"></eq><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.2">𝑖</ci><cn id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.3.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.3.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.1.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2a.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2"><mtext id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.2">ACC</mtext></ci><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.2.3.2.2.3">𝑖</ci></apply><ci id="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.5.m5.1.1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.5.m5.1c">\frac{1}{N}\sum_{i=1}^{N}\textrm{ACC}_{i}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.5.m5.1d">divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ACC start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, evaluating how effectively the aggregated server model adapts to the test data of unseen clients. (2) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS0.Px2.p2.8.2">Personalization</span> performance is measured as <math alttext="\frac{1}{N}\sum_{j=1}^{N}\frac{1}{N-1}\sum_{i\neq j}\textrm{ACC}_{j}^{(i)}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.6.m6.1"><semantics id="S5.SS1.SSS0.Px2.p2.6.m6.1a"><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.cmml"><mfrac id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.cmml"><mn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.2.cmml">1</mn><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.3.cmml">N</mi></mfrac><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.cmml"><msubsup id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.2.cmml">∑</mo><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.2.cmml">j</mi><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.3.cmml">N</mi></msubsup><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.cmml"><mfrac id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.cmml"><mn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.2.cmml">1</mn><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.2.cmml">N</mi><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.1.cmml">−</mo><mn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.3.cmml">1</mn></mrow></mfrac><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.1.cmml">⁢</mo><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.cmml"><msub id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.2.cmml">∑</mo><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.cmml"><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.2.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.1.cmml">≠</mo><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.3.cmml">j</mi></mrow></msub><msubsup id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.cmml"><mtext id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2a.cmml">ACC</mtext><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.3.cmml">j</mi><mrow id="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.3" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.cmml"><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.3.1" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.cmml">(</mo><mi id="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.1" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.3.2" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.6.m6.1b"><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2"><times id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.1"></times><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2"><divide id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2"></divide><cn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.2.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.2">1</cn><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.2.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3"><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1">subscript</csymbol><sum id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.2"></sum><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3"><eq id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.1"></eq><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.2">𝑗</ci><cn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.3.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.1.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2"><times id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.1"></times><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2"><divide id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2"></divide><cn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.2.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.2">1</cn><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3"><minus id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.1"></minus><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.2">𝑁</ci><cn id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.3.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.2.3.3">1</cn></apply></apply><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3"><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1">subscript</csymbol><sum id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.2"></sum><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3"><neq id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.1"></neq><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.2">𝑖</ci><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.1.3.3">𝑗</ci></apply></apply><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2a.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2"><mtext id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.2">ACC</mtext></ci><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.2.3.2.3.2.2.3">𝑗</ci></apply><ci id="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.6.m6.1.1.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.6.m6.1c">\frac{1}{N}\sum_{j=1}^{N}\frac{1}{N-1}\sum_{i\neq j}\textrm{ACC}_{j}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.6.m6.1d">divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_i ≠ italic_j end_POSTSUBSCRIPT ACC start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which reflects the client model’s ability to perform well on its own domain after training. Finally, (3) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS0.Px2.p2.8.3">Comprehensive</span> performance is computed as <math alttext="\frac{1}{N}\sum_{j}\frac{1}{N}\sum_{i}\textrm{ACC}_{j}^{(i)}" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.7.m7.1"><semantics id="S5.SS1.SSS0.Px2.p2.7.m7.1a"><mrow id="S5.SS1.SSS0.Px2.p2.7.m7.1.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.cmml"><mfrac id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.cmml"><mn id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.2.cmml">1</mn><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.3.cmml">N</mi></mfrac><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.1" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.cmml"><msub id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.2.cmml">∑</mo><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.3.cmml">j</mi></msub><mrow id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.cmml"><mfrac id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.cmml"><mn id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.2.cmml">1</mn><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.3.cmml">N</mi></mfrac><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.1" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.1.cmml">⁢</mo><mrow id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.cmml"><msub id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.cmml"><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.2.cmml">∑</mo><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.3.cmml">i</mi></msub><msubsup id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.cmml"><mtext id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2a.cmml">ACC</mtext><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.3.cmml">j</mi><mrow id="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.3" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.cmml"><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.3.1" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.cmml">(</mo><mi id="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.1" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.3.2" stretchy="false" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.7.m7.1b"><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2"><times id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.1"></times><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2"><divide id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2"></divide><cn id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.2.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.2">1</cn><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.2.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3"><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1">subscript</csymbol><sum id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.2"></sum><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.1.3">𝑗</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2"><times id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.1"></times><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2"><divide id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2"></divide><cn id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.2.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.2">1</cn><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.2.3">𝑁</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3"><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1">subscript</csymbol><sum id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.2"></sum><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.1.3">𝑖</ci></apply><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2">superscript</csymbol><apply id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2a.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2"><mtext id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.2">ACC</mtext></ci><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.2.3.2.3.2.2.3">𝑗</ci></apply><ci id="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.7.m7.1.1.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.7.m7.1c">\frac{1}{N}\sum_{j}\frac{1}{N}\sum_{i}\textrm{ACC}_{j}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.7.m7.1d">divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ACC start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which provides an overall measure of model performance by considering both generalization and personalization aspects.
These metrics enable cross-validation experiments across all domains within each dataset, providing a holistic evaluation of model adaptability. In our experiments, we set <math alttext="N=4" class="ltx_Math" display="inline" id="S5.SS1.SSS0.Px2.p2.8.m8.1"><semantics id="S5.SS1.SSS0.Px2.p2.8.m8.1a"><mrow id="S5.SS1.SSS0.Px2.p2.8.m8.1.1" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.cmml"><mi id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.2" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.2.cmml">N</mi><mo id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.1" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.3" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.8.m8.1b"><apply id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1"><eq id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.1"></eq><ci id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.2">𝑁</ci><cn id="S5.SS1.SSS0.Px2.p2.8.m8.1.1.3.cmml" type="integer" xref="S5.SS1.SSS0.Px2.p2.8.m8.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.8.m8.1c">N=4</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS0.Px2.p2.8.m8.1d">italic_N = 4</annotation></semantics></math>, corresponding to the four clients (i.e., domains) in the datasets.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S5.T1.2.1">Overview of generalization, personalization, and comprehensive accuracies across five datasets.</span> The reported results for PromptFL, CoCoOp, and VPT correspond to their representative experiments. For more detailed results, refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A6.SS2" title="F.2 Results ‣ Appendix F Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">F.2</span></a>. FedAVG refers to a variant of our method, treating all trainable parameters (e.g. classifiers, orthogonal transformation) as global parameters.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.3" style="width:390.3pt;height:467.1pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-23.3pt,27.9pt) scale(0.893128212348766,0.893128212348766) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" colspan="2" id="S5.T1.3.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.1.1.2">FEMNIST</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.1.1.3">PACS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.1.1.4">Office-Home</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.1.1.5">VLCS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.1.1.6">TerraIncognita</th>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T1.3.1.2.2.1">Zero-Shot</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T1.3.1.2.2.2">CLIP</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.2.2.3">49.22</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.2.2.4">94.08</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.2.2.5">79.17</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.2.2.6">81.07</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.3.1.2.2.7">18.79</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.3.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.3.1.1" rowspan="9"><span class="ltx_text" id="S5.T1.3.1.3.1.1.1">Generalization</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.3.1.2">PromptFL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.3.1.3">96.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.3.1.4">94.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.3.1.5">81.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.3.1.6">81.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.3.1.7"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.3.1.7.1">39.72</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.4.2.1">CoCoOp</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.4.2.2">12.48</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.4.2.3">89.04</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.4.2.4">74.11</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.4.2.5">54.68</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.4.2.6">31.57</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.5.3.1">VPT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.5.3.2">68.13</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.5.3.3.1">94.73</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.5.3.4">81.11</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.5.3.5">81.26</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.5.3.6">35.05</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.6.4.1">FedAKT(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.6.4.2">10.45</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.6.4.3">15.40</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.6.4.4">1.41</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.6.4.5">27.45</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.6.4.6">5.80</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.7.5.1">FedGH(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.7.5.2">37.90</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.7.5.3">54.80</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.7.5.4">1.64</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.7.5.5">41.92</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.7.5.6">9.73</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.8.6.1">FedCLIP</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.8.6.2">80.07</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.8.6.3">94.61</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.8.6.4">80.15</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.8.6.5">81.41</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.8.6.6">34.33</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.9.7.1">FedAVG</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.9.7.2">92.70</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.9.7.3">94.48</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.9.7.4">81.80</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.9.7.5">82.23</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.9.7.6">32.21</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.10.8.1">FedOT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.10.8.2">94.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.10.8.3">94.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.10.8.4">81.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.10.8.5">81.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.10.8.6">34.80</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.11.9.1">FedOT(+B)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.11.9.2"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.11.9.2.1">97.85</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.11.9.3">94.26</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.11.9.4"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.11.9.4.1">82.53</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.11.9.5"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.11.9.5.1">82.42</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.11.9.6">31.92</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.12.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.12.10.1" rowspan="9"><span class="ltx_text" id="S5.T1.3.1.12.10.1.1">Personalization</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.12.10.2">PromptFL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.12.10.3">96.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.12.10.4">96.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.12.10.5">85.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.12.10.6">87.97</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.12.10.7">60.27</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.13.11.1">CoCoOp</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.13.11.2">95.31</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.13.11.3">96.11</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.13.11.4">81.80</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.13.11.5">88.98</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.13.11.6">66.67</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.14.12.1">VPT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.14.12.2">91.86</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.14.12.3">96.55</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.14.12.4">82.16</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.14.12.5">88.86</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.14.12.6">64.06</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.15.13.1">FedAKT(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.15.13.2">65.88</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.15.13.3">77.22</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.15.13.4">27.24</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.15.13.5">66.52</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.15.13.6">50.98</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.16.14.1">FedGH(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.16.14.2">40.68</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.16.14.3">63.31</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.16.14.4">1.97</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.16.14.5">55.62</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.16.14.6">5.33</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.17.15.1">FedCLIP</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.17.15.2">81.12</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.17.15.3">96.14</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.17.15.4">80.28</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.17.15.5">84.41</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.17.15.6">40.14</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.18.16.1">FedAVG</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.18.16.2">92.07</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.18.16.3">96.72</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.18.16.4">84.62</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.18.16.5">87.73</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.18.16.6">62.77</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.19.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.19.17.1">FedOT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.19.17.2">95.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.19.17.3">96.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.19.17.4">85.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.19.17.5">88.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.19.17.6">68.93</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.20.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.20.18.1">FedOT(+B)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.20.18.2"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.20.18.2.1">98.14</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.20.18.3"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.20.18.3.1">97.14</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.20.18.4"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.20.18.4.1">87.44</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.20.18.5"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.20.18.5.1">89.80</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.20.18.6"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.20.18.6.1">68.94</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.21.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T1.3.1.21.19.1" rowspan="9"><span class="ltx_text" id="S5.T1.3.1.21.19.1.1">Comprehensive</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.21.19.2">PromptFL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.21.19.3">96.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.21.19.4">96.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.21.19.5">84.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.21.19.6">86.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.21.19.7">55.13</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.22.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.22.20.1">CoCoOp</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.22.20.2">74.60</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.22.20.3">94.34</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.22.20.4">79.88</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.22.20.5">80.40</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.22.20.6">57.90</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.23.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.23.21.1">VPT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.23.21.2">85.93</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.23.21.3">96.09</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.23.21.4">81.89</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.23.21.5">86.96</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.23.21.6">56.81</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.24.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.24.22.1">FedAKT(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.24.22.2">52.02</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.24.22.3">61.76</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.24.22.4">20.78</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.24.22.5">58.82</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.24.22.6">39.68</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.25.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.25.23.1">FedGH(C)</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.25.23.2">39.99</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.25.23.3">61.18</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.25.23.4">1.91</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.25.23.5">52.76</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.25.23.6">6.79</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.26.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.26.24.1">FedCLIP</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.26.24.2">80.86</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.26.24.3">95.76</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.26.24.4">80.25</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.26.24.5">83.66</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.26.24.6">38.44</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.27.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.1.27.25.1">FedAVG</th>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.27.25.2">92.22</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.27.25.3">96.16</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.27.25.4">83.92</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.27.25.5">86.35</td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.1.27.25.6">55.13</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.28.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.1.28.26.1">FedOT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.28.26.2">95.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.28.26.3">96.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.28.26.4">84.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.28.26.5">86.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.1.28.26.6"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.28.26.6.1">60.39</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.1.29.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T1.3.1.29.27.1">FedOT(+B)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.1.29.27.2"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.29.27.2.1">98.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.1.29.27.3"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.29.27.3.1">96.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.1.29.27.4"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.29.27.4.1">86.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.1.29.27.5"><span class="ltx_text ltx_font_bold" id="S5.T1.3.1.29.27.5.1">87.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.1.29.27.6">59.69</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results</h3>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Effectiveness of FedOT.</h5>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.T1" title="Table 1 ‣ Metrics. ‣ 5.1 Setup ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">1</span></a>, our proposed methods, FedOT and FedOT(+B), consistently outperform all baselines across the evaluation metrics, achieving strong generalization and personalization.
Unlike methods such as FedAVG, FedCLIP, and PromptFL, which rely solely on global parameters, our approach incorporates local parameters, resulting in significantly better personalization while maintaining comparable or superior generalization performance.
This demonstrates that combining global and local components is crucial for effective domain adaptation in federated settings, overcoming the limitations of purely global methods.
On PACS, VPT shows the highest generalization accuracy—a result inconsistent with its performance on other datasets.
Nevertheless, our method achieves the best personalization score and ultimately ranks highest in overall accuracy, reflecting robust and balanced performance.
Even CoCoOp, FedGH, and FedAKT show modest gains or minimal drops in personalization, and fail to generalize to unseen domains, indicating poor robustness to distribution shifts, whereas ours not only achieves effective personalization but also demonstrates strong generalization to unseen domains.
These results underscore the importance of balancing local adaptability and global knowledge integration, a balance that FedOT fulfills through its orthogonal transformations and globally shared classifier.
</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">DOF and Personalization via FedOT(+B).</h5>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.F3" title="Figure 3 ‣ Condition Number and Generalization. ‣ 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates how personalization performance varies with degrees of freedom (DOF) in block-diagonal orthogonal transformations (FedOT(+B)). Simpler tasks, such as FEMNIST, benefit from lower DOF due to preserved pretrained manifolds, whereas the complex OfficeHome dataset achieves better performance with higher DOF, capturing richer patterns. This highlights the necessity of adjusting DOF according to dataset complexity, where block-orthogonality maintains parameter orthogonality and mitigates gradient conflicts, facilitating effective personalization in federated learning.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Condition Number and Generalization.</h5>
<div class="ltx_para" id="S5.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px3.p1.4">Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.T2" title="Table 2 ‣ Condition Number and Generalization. ‣ 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">2</span></a> compares FedOT (with orthogonality constraint) and FedOT(-o) (without orthogonality constraint).
Notably, FedOT preserves a low condition number (<math alttext="\kappa=1.0" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px3.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">κ</mi><mo id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1"><eq id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝜅</ci><cn id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="float" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.1.m1.1c">\kappa=1.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px3.p1.1.m1.1d">italic_κ = 1.0</annotation></semantics></math>) for all target clients and achieves high generalization accuracy.
Imposing orthogonality keeps the transformation matrix well-conditioned and prevents over-scaling or distortion, thus maintaining robust generalization.
By contrast, FedOT(-o) permits a steep rise in the condition number (<math alttext="\kappa" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S5.SS2.SSS0.Px3.p1.2.m2.1a"><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.2.m2.1b"><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.2.m2.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px3.p1.2.m2.1d">italic_κ</annotation></semantics></math> up to <math alttext="63.82" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px3.p1.3.m3.1"><semantics id="S5.SS2.SSS0.Px3.p1.3.m3.1a"><mn id="S5.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">63.82</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.3.m3.1b"><cn id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" type="float" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1">63.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.3.m3.1c">63.82</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px3.p1.3.m3.1d">63.82</annotation></semantics></math>), which severely impairs generalization performance.
As implied by Theorem <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S4.Thmtheorem1" title="Theorem 4.1. ‣ 4.1 Bounding the Gradient Difference Between Clients ‣ 4 Theoretical Analysis of FedOT ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4.1</span></a>, larger <math alttext="\kappa" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px3.p1.4.m4.1"><semantics id="S5.SS2.SSS0.Px3.p1.4.m4.1a"><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.4.m4.1b"><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.4.m4.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px3.p1.4.m4.1d">italic_κ</annotation></semantics></math> magnifies gradient discrepancies across clients, undermining accuracy.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S5.T2.2.1">Comparison of generalization accuracy (%) and the final condition number <math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.2.1.m1.1"><semantics id="S5.T2.2.1.m1.1b"><mi id="S5.T2.2.1.m1.1.1" xref="S5.T2.2.1.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.2.1.m1.1c"><ci id="S5.T2.2.1.m1.1.1.cmml" xref="S5.T2.2.1.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.1.m1.1d">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.1.m1.1e">italic_κ</annotation></semantics></math>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.8" style="width:433.6pt;height:110.8pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-67.0pt,17.0pt) scale(0.763974522927244,0.763974522927244) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.8.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.8.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.8.6.7.1.1" rowspan="3"><span class="ltx_text" id="S5.T2.8.6.7.1.1.1">Target</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T2.8.6.7.1.2">FEMNIST</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.8.6.7.1.3" rowspan="3"><span class="ltx_text" id="S5.T2.8.6.7.1.3.1">Target</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T2.8.6.7.1.4">PACS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.8.6.7.1.5" rowspan="3"><span class="ltx_text" id="S5.T2.8.6.7.1.5.1">Target</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T2.8.6.7.1.6">Terra-Incognita</th>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.1">FedOT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.2">FedOT(-o)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.3">FedOT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.4">FedOT(-o)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.5">FedOT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T2.8.6.8.2.6">FedOT(-o)</th>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.7">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.3.1.1.1"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.3.1.1.1.m1.1"><semantics id="S5.T2.3.1.1.1.m1.1a"><mi id="S5.T2.3.1.1.1.m1.1.1" xref="S5.T2.3.1.1.1.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.1.m1.1b"><ci id="S5.T2.3.1.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.1.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.1.1.1.m1.1d">italic_κ</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.8">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.2"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.4.2.2.2.m1.1"><semantics id="S5.T2.4.2.2.2.m1.1a"><mi id="S5.T2.4.2.2.2.m1.1.1" xref="S5.T2.4.2.2.2.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.2.m1.1b"><ci id="S5.T2.4.2.2.2.m1.1.1.cmml" xref="S5.T2.4.2.2.2.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.2.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.2.2.2.m1.1d">italic_κ</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.9">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.3.3.3"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.5.3.3.3.m1.1"><semantics id="S5.T2.5.3.3.3.m1.1a"><mi id="S5.T2.5.3.3.3.m1.1.1" xref="S5.T2.5.3.3.3.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.3.m1.1b"><ci id="S5.T2.5.3.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.3.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.3.3.3.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.3.3.3.m1.1d">italic_κ</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.10">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.6.4.4.4"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.6.4.4.4.m1.1"><semantics id="S5.T2.6.4.4.4.m1.1a"><mi id="S5.T2.6.4.4.4.m1.1.1" xref="S5.T2.6.4.4.4.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.4.m1.1b"><ci id="S5.T2.6.4.4.4.m1.1.1.cmml" xref="S5.T2.6.4.4.4.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.4.4.4.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.4.4.4.m1.1d">italic_κ</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.11">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.7.5.5.5"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.7.5.5.5.m1.1"><semantics id="S5.T2.7.5.5.5.m1.1a"><mi id="S5.T2.7.5.5.5.m1.1.1" xref="S5.T2.7.5.5.5.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.7.5.5.5.m1.1b"><ci id="S5.T2.7.5.5.5.m1.1.1.cmml" xref="S5.T2.7.5.5.5.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.5.5.5.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.5.5.5.m1.1d">italic_κ</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.12">Acc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.8.6.6.6"><math alttext="\kappa" class="ltx_Math" display="inline" id="S5.T2.8.6.6.6.m1.1"><semantics id="S5.T2.8.6.6.6.m1.1a"><mi id="S5.T2.8.6.6.6.m1.1.1" xref="S5.T2.8.6.6.6.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.8.6.6.6.m1.1b"><ci id="S5.T2.8.6.6.6.m1.1.1.cmml" xref="S5.T2.8.6.6.6.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.6.6.6.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.6.6.6.m1.1d">italic_κ</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.8.6.9.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T2.8.6.9.1.1">33</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.2">95.92%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.3">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.4">59.18%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.5">19.57</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.6">A</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.7">95.35%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.8">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.9">95.35%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.10">1.24</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.11">L38</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.12">44.34%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.13">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.14">33.18%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.8.6.9.1.15">1.37</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.10.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.8.6.10.2.1">0</th>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.2">96.15%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.3">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.4">74.04%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.5">43.45</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.6">C</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.7">97.44%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.8">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.9">97.01%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.10">1.30</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.11">L43</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.12">29.89%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.13">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.14">31.51%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.10.2.15">1.38</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.11.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.8.6.11.3.1">25</th>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.2">92.31%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.3">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.4">67.31%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.5">30.86</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.6">P</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.7">99.70%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.8">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.9">99.70%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.10">1.31</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.11">L46</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.12">42.19%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.13">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.14">36.22%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.11.3.15">1.34</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.12.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.8.6.12.4.1">26</th>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.2">95.19%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.3">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.4">84.13%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.5">35.15</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.6">S</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.7">86.24%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.8">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.9">85.99%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.10">1.12</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.11">L100</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.12">22.77%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.13">1.00</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.14">21.74%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.8.6.12.4.15">1.37</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.6.13.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.1">AVG</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.2">94.89%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.3">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.4">71.17%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.5">32.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.6">AVG</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.7">94.68%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.8">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.9">94.51%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.10">1.24</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.11">AVG</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.12">34.80%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.13">1.00</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.14">30.66%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.8.6.13.5.15">1.36</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F3.7" style="width:208.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="482" id="S5.F3.1.g1" src="x1.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S5.F3.7.8.1">Comparison of DOF and personalization accuracy on FEMNIST and OfficeHome.</span> We vary the number of blocks <math alttext="R=2^{N}" class="ltx_Math" display="inline" id="S5.F3.5.4.m1.1"><semantics id="S5.F3.5.4.m1.1b"><mrow id="S5.F3.5.4.m1.1.1" xref="S5.F3.5.4.m1.1.1.cmml"><mi id="S5.F3.5.4.m1.1.1.2" xref="S5.F3.5.4.m1.1.1.2.cmml">R</mi><mo id="S5.F3.5.4.m1.1.1.1" xref="S5.F3.5.4.m1.1.1.1.cmml">=</mo><msup id="S5.F3.5.4.m1.1.1.3" xref="S5.F3.5.4.m1.1.1.3.cmml"><mn id="S5.F3.5.4.m1.1.1.3.2" xref="S5.F3.5.4.m1.1.1.3.2.cmml">2</mn><mi id="S5.F3.5.4.m1.1.1.3.3" xref="S5.F3.5.4.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.5.4.m1.1c"><apply id="S5.F3.5.4.m1.1.1.cmml" xref="S5.F3.5.4.m1.1.1"><eq id="S5.F3.5.4.m1.1.1.1.cmml" xref="S5.F3.5.4.m1.1.1.1"></eq><ci id="S5.F3.5.4.m1.1.1.2.cmml" xref="S5.F3.5.4.m1.1.1.2">𝑅</ci><apply id="S5.F3.5.4.m1.1.1.3.cmml" xref="S5.F3.5.4.m1.1.1.3"><csymbol cd="ambiguous" id="S5.F3.5.4.m1.1.1.3.1.cmml" xref="S5.F3.5.4.m1.1.1.3">superscript</csymbol><cn id="S5.F3.5.4.m1.1.1.3.2.cmml" type="integer" xref="S5.F3.5.4.m1.1.1.3.2">2</cn><ci id="S5.F3.5.4.m1.1.1.3.3.cmml" xref="S5.F3.5.4.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.5.4.m1.1d">R=2^{N}</annotation><annotation encoding="application/x-llamapun" id="S5.F3.5.4.m1.1e">italic_R = 2 start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> in our block-diagonal transforms. The left axis depicts the change in personalization accuracy relative to <math alttext="N=0" class="ltx_Math" display="inline" id="S5.F3.6.5.m2.1"><semantics id="S5.F3.6.5.m2.1b"><mrow id="S5.F3.6.5.m2.1.1" xref="S5.F3.6.5.m2.1.1.cmml"><mi id="S5.F3.6.5.m2.1.1.2" xref="S5.F3.6.5.m2.1.1.2.cmml">N</mi><mo id="S5.F3.6.5.m2.1.1.1" xref="S5.F3.6.5.m2.1.1.1.cmml">=</mo><mn id="S5.F3.6.5.m2.1.1.3" xref="S5.F3.6.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.6.5.m2.1c"><apply id="S5.F3.6.5.m2.1.1.cmml" xref="S5.F3.6.5.m2.1.1"><eq id="S5.F3.6.5.m2.1.1.1.cmml" xref="S5.F3.6.5.m2.1.1.1"></eq><ci id="S5.F3.6.5.m2.1.1.2.cmml" xref="S5.F3.6.5.m2.1.1.2">𝑁</ci><cn id="S5.F3.6.5.m2.1.1.3.cmml" type="integer" xref="S5.F3.6.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.5.m2.1d">N=0</annotation><annotation encoding="application/x-llamapun" id="S5.F3.6.5.m2.1e">italic_N = 0</annotation></semantics></math> (<math alttext="R=1" class="ltx_Math" display="inline" id="S5.F3.7.6.m3.1"><semantics id="S5.F3.7.6.m3.1b"><mrow id="S5.F3.7.6.m3.1.1" xref="S5.F3.7.6.m3.1.1.cmml"><mi id="S5.F3.7.6.m3.1.1.2" xref="S5.F3.7.6.m3.1.1.2.cmml">R</mi><mo id="S5.F3.7.6.m3.1.1.1" xref="S5.F3.7.6.m3.1.1.1.cmml">=</mo><mn id="S5.F3.7.6.m3.1.1.3" xref="S5.F3.7.6.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.7.6.m3.1c"><apply id="S5.F3.7.6.m3.1.1.cmml" xref="S5.F3.7.6.m3.1.1"><eq id="S5.F3.7.6.m3.1.1.1.cmml" xref="S5.F3.7.6.m3.1.1.1"></eq><ci id="S5.F3.7.6.m3.1.1.2.cmml" xref="S5.F3.7.6.m3.1.1.2">𝑅</ci><cn id="S5.F3.7.6.m3.1.1.3.cmml" type="integer" xref="S5.F3.7.6.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.7.6.m3.1d">R=1</annotation><annotation encoding="application/x-llamapun" id="S5.F3.7.6.m3.1e">italic_R = 1</annotation></semantics></math>), while the right axis shows the corresponding DOF values.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F3.8" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="395" id="S5.F3.8.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S5.F3.8.2.1">Comparison of generalization and personalization performance for the local-only, global-only, and FedOT on FEMNIST, PACS, and TerraIncognita.</span> FedOT consistently outperforms both ablated methods, highlighting the complementary benefits of jointly leveraging local and global parameters.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Study</h3>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Global and Local Parameters.</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px1.p1.1">To demonstrate the significance of incorporating both global and local parameters in our proposed method, we compare our approach on FEMNIST, PACS, and TerraIncognita with two ablated methods, one without global parameters and the other without local parameters.
For generalization accuracy, we exclusively compare our method with the global-only method, as the local-only method is tied to domain-specific parameters, making it incompatible with the fundamental principles of FL settings.
Referring to Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.F3" title="Figure 3 ‣ Condition Number and Generalization. ‣ 5.2 Results ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">3</span></a>, FedOT improves generalization across all datasets by incorporating local parameters, compared to the global-only approach.
Additionally, our method surpasses both alternatives in personalization performance, highlighting that the joint utilization of global and local parameters provides significant advantages over relying solely on either.
These results underscore the effectiveness of jointly integrating local and global parameters, indicating their complementary contribution to achieving superior performance in both personalization and generalization.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Towards Vision Foundation Models.</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px2.p1.1">To investigate the potential applicability of our framework to vision foundation models, we conduct experiments under the same settings as FedOT, but with a randomly initialized classifier.
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S5.T3" title="Table 3 ‣ Towards Vision Foundation Models. ‣ 5.3 Ablation Study ‣ 5 Experiments ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">3</span></a>, despite the absence of explicit alignment between text and image representations, our framework demonstrates highly competitive performance when applied to foundation models composed solely of an image encoder.
Notably, on FEMNIST and Office-Home, the randomly initialized method outperforms across all metrics, which suggests that datasets with weaker zero-shot capabilities and less aligned representations may benefit from learning alignment from scratch.
These findings indicate that our approach maintains strong performance even without a pre-trained classifier, affirming that our framework can seamlessly integrate with any foundation model by leveraging only its image encoder.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="S5.T3.2.1">Accuracy results from experiments with different initialization methods for global parameters.</span> TextEnc uses the text encoder of CLIP for initialization, while RandInit uses random initialization.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.3" style="width:433.6pt;height:67.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.4pt,11.5pt) scale(0.744410838778901,0.744410838778901) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T3.3.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.3.1.1.1.2">FEMNIST</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.3.1.1.1.3">PACS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.3.1.1.1.4">OfficeHome</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.3.1.1.1.5">VLCS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.3.1.1.1.6">TerraIncognita</th>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.3.1.2.2.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.2">TextEnc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.3">RandInit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.4">TextEnc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.5">RandInit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.6">TextEnc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.7">RandInit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.8">TextEnc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.9">RandInit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.10">TextEnc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.3.1.2.2.11">RandInit</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.3.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T3.3.1.3.1.1">Generalization</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.2">94.89</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.3">96.15</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.4">94.68</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.5">90.91</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.6">81.30</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.7">82.67</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.8">81.11</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.9">76.12</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.10">34.80</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.3.1.11">27.20</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.3.1.4.2.1">Personalization</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.2">95.46</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.3">96.36</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.4">96.74</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.5">96.91</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.6">85.13</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.7">87.66</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.8">88.63</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.9">86.91</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.10">68.93</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.2.11">65.82</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.3.1.5.3.1">Comprehensive</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.2">95.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.3">96.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.4">96.22</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.5">95.41</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.6">84.17</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.7">86.42</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.8">86.75</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.9">84.21</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.10">60.39</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.5.3.11">56.17</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Robustness to Communication Rounds.</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px3.p1.1">In an FL environment, where performance is profoundly influenced by the frequency of communication rounds between clients and the server, it is essential to assess the impact of varying communication intervals.
To explore the effect of the local update epoch <math alttext="E" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S5.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS0.Px3.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px3.p1.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px3.p1.1.m1.1d">italic_E</annotation></semantics></math> in FL, we compare our method with FedCLIP while varying the number of local learning epochs to 1, 2, 4, and 8.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A7.F4" title="Figure 4 ‣ G.1 Robustness to Communication Rounds. ‣ Appendix G Ablation ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4</span></a>, our method consistently outperforms FedCLIP across all communication rounds and even exhibits performance improvement as the number of rounds increases.
In contrast, FedCLIP tends to degrade in performance with more communication rounds, indicating its limitations for practical deployment.
These results demonstrate the superiority of our method and its robustness for real-world FL applications.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Multi-Client Scenario.</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px4.p1.1">To assess the applicability of our method in a realistic FL environment, we consider a cross-device setting reflecting real-world conditions.
Specifically, we set up 5 selected test clients and training clients of 2, 5, 10, and 15, using the FEMNIST dataset.
The training environments for each client were kept consistent, as described in the implementation details.
As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A7.F5" title="Figure 5 ‣ G.2 Multi-Client Scenario ‣ Appendix G Ablation ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">5</span></a>, the average generalization performance improvement of the test clients, compared to zero-shot model inference performance, was observed to be 12.62%, 22.36%, 26.40%, and 25.83%, respectively.
These findings suggest that, despite the data heterogeneity among clients, an increase in the number of participating clients leads to a notable average performance enhancement when applying our framework in FL.
Thus, our approach is also well-suited for cross-device FL contexts.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations and Future Works</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Although FedOT treats the foundation model as a black box to protect proprietary information, the use of a shared global classifier introduces some white-box elements. This can be restrictive when a strict black-box approach is mandatory. Future research may consider richer, nonlinear mappings—instead of strictly linear (orthogonal) ones—to better handle heterogeneous client data, despite reduced transparency in theoretical guarantees. Additionally, projecting data transformations into lower-dimensional spaces could improve computational efficiency on resource-constrained devices, though it may risk losing important semantic distinctions. This is because, while block-diagonal designs effectively decrease model complexity, determining optimal block sizes or tailoring them to individual clients remains challenging.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this work, we proposed FedOT, a federated learning framework that integrates large-scale foundation models with orthogonal transformations to address both generalization and personalization. By leveraging a global classifier and local orthogonal transformations, our method mitigates gradient conflicts, preserves semantic information, and achieves consistent performance improvement on multiple datasets. The black-box nature introduced to the image encoder safeguards the intellectual property of the server and data privacy for clients, making FedOT a practical and effective solution for real-world federated applications that demand robust performance across highly diverse domains.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.2.2.1" style="font-size:90%;">(1)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.4.1" style="font-size:90%;">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, and Shyamal Anadkat.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.5.1" style="font-size:90%;">Gpt-4 technical report.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.6.1" style="font-size:90%;">arXiv preprint arXiv:2303.08774</span><span class="ltx_text" id="bib.bib1.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.2.2.1" style="font-size:90%;">(2)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.4.1" style="font-size:90%;">
Rohan Anil, Andrew M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin, Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, and Zhifeng Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.5.1" style="font-size:90%;">Palm 2 technical report.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.6.1" style="font-size:90%;">arXiv preprint arXiv:2305.10403</span><span class="ltx_text" id="bib.bib2.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.2.2.1" style="font-size:90%;">(3)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.4.1" style="font-size:90%;">
Yogesh Balaji, Swami Sankaranarayanan, and Rama Chellappa.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.5.1" style="font-size:90%;">Metareg: Towards domain generalization using meta-regularization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.6.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib3.7.2" style="font-size:90%;">, 31, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.2.2.1" style="font-size:90%;">(4)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.4.1" style="font-size:90%;">
Sara Beery, Grant Van Horn, and Pietro Perona.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.5.1" style="font-size:90%;">Recognition in terra incognita.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib4.7.2" style="font-size:90%;">Proceedings of the European conference on computer vision (ECCV)</span><span class="ltx_text" id="bib.bib4.8.3" style="font-size:90%;">, pages 456–473, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.2.2.1" style="font-size:90%;">(5)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.4.1" style="font-size:90%;">
Rishi Bommasani, Drew A. Hudson, Ehsan Adeli, Russ Altman, Simran Arora, Sydney von Arx, Michael S. Bernstein, Jeannette Bohg, Antoine Bosselut, Emma Brunskill, Erik Brynjolfsson, S. Buch, Dallas Card, Rodrigo Castellon, Niladri S. Chatterji, Annie S. Chen, Kathleen A. Creel, Jared Davis, Dora Demszky, Chris Donahue, Moussa Doumbouya, Esin Durmus, Stefano Ermon, John Etchemendy, Kawin Ethayarajh, Li Fei-Fei, Chelsea Finn, Trevor Gale, Lauren E. Gillespie, Karan Goel, Noah D. Goodman, Shelby Grossman, Neel Guha, Tatsunori Hashimoto, Peter Henderson, John Hewitt, Daniel E. Ho, Jenny Hong, Kyle Hsu, Jing Huang, Thomas F. Icard, Saahil Jain, Dan Jurafsky, Pratyusha Kalluri, Siddharth Karamcheti, Geoff Keeling, Fereshte Khani, O. Khattab, Pang Wei Koh, Mark S. Krass, Ranjay Krishna, Rohith Kuditipudi, Ananya Kumar, Faisal Ladhak, Mina Lee, Tony Lee, Jure Leskovec, Isabelle Levent, Xiang Lisa Li, Xuechen Li, Tengyu Ma, Ali Malik, Christopher D. Manning, Suvir P. Mirchandani, Eric Mitchell, Zanele Munyikwa, Suraj
Nair, Avanika Narayan, Deepak Narayanan, Benjamin Newman, Allen Nie, Juan Carlos Niebles, Hamed Nilforoshan, J. F. Nyarko, Giray Ogut, Laurel Orr, Isabel Papadimitriou, Joon Sung Park, Chris Piech, Eva Portelance, Christopher Potts, Aditi Raghunathan, Robert Reich, Hongyu Ren, Frieda Rong, Yusuf H. Roohani, Camilo Ruiz, Jack Ryan, Christopher R’e, Dorsa Sadigh, Shiori Sagawa, Keshav Santhanam, Andy Shih, Krishna Parasuram Srinivasan, Alex Tamkin, Rohan Taori, Armin W. Thomas, Florian Tramèr, Rose E. Wang, William Wang, Bohan Wu, Jiajun Wu, Yuhuai Wu, Sang Michael Xie, Michihiro Yasunaga, Jiaxuan You, Matei A. Zaharia, Michael Zhang, Tianyi Zhang, Xikun Zhang, Yuhui Zhang, Lucia Zheng, Kaitlyn Zhou, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.5.1" style="font-size:90%;">On the opportunities and risks of foundation models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.6.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib5.7.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.2.2.1" style="font-size:90%;">(6)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.4.1" style="font-size:90%;">
K. Bousmalis, G. Trigeorgis, N. Silberman, D. Krishnan, and D. Erhan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.5.1" style="font-size:90%;">Domain separation networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib6.7.2" style="font-size:90%;">Advances in Neural Information Processing Systems 29 (NeurIPS)</span><span class="ltx_text" id="bib.bib6.8.3" style="font-size:90%;">, pages 343–351, Barcelona, Spain, 2016. Curran Associates, Inc.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.2.2.1" style="font-size:90%;">(7)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.4.1" style="font-size:90%;">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, and Amanda Askell.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.5.1" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.6.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib7.7.2" style="font-size:90%;">, 33:1877–1901, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.2.2.1" style="font-size:90%;">(8)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.4.1" style="font-size:90%;">
Sebastian Caldas, Sai Meher Karthik Duddu, Peter Wu, Tian Li, Jakub Konečný, H Brendan McMahan, Virginia Smith, and Ameet Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.5.1" style="font-size:90%;">Leaf: A benchmark for federated settings.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.6.1" style="font-size:90%;">arXiv preprint arXiv:1812.01097</span><span class="ltx_text" id="bib.bib8.7.2" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.2.2.1" style="font-size:90%;">(9)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.4.1" style="font-size:90%;">
Amaia Cardiel et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.5.1" style="font-size:90%;">LLM-Wrapper: Black-box adaptation of VLMs for referring expression.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib9.7.2" style="font-size:90%;">International Conference on Learning Representations</span><span class="ltx_text" id="bib.bib9.8.3" style="font-size:90%;">, 2025.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.2.2.1" style="font-size:90%;">(10)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.4.1" style="font-size:90%;">
Mathilde Caron, Hugo Touvron, Ishan Misra, Hervé Jégou, Julien Mairal, Piotr Bojanowski, and Armand Joulin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.5.1" style="font-size:90%;">Emerging properties in self-supervised vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib10.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib10.8.3" style="font-size:90%;">, pages 9650–9660, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.2.2.1" style="font-size:90%;">(11)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.4.1" style="font-size:90%;">
Arthur Cayley.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.5.1" style="font-size:90%;">Sur quelques propriétés des déterminants gauches.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.6.1" style="font-size:90%;">1846.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.2.2.1" style="font-size:90%;">(12)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.4.1" style="font-size:90%;">
Annie S Chen, Yoonho Lee, Amrith Setlur, Sergey Levine, and Chelsea Finn.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.5.1" style="font-size:90%;">Project and probe: Sample-efficient domain adaptation by interpolating orthogonal features.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.6.1" style="font-size:90%;">arXiv preprint arXiv:2302.05441</span><span class="ltx_text" id="bib.bib12.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.2.2.1" style="font-size:90%;">(13)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.4.1" style="font-size:90%;">
L. Chen, Y. Zhang, Y. Song, Y. Shan, and L. Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.5.1" style="font-size:90%;">Improved test-time adaptation for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib13.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span><span class="ltx_text" id="bib.bib13.8.3" style="font-size:90%;">, pages 24172–24182, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.2.2.1" style="font-size:90%;">(14)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.4.1" style="font-size:90%;">
Xinlei Chen and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.5.1" style="font-size:90%;">Exploring simple siamese representation learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib14.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib14.8.3" style="font-size:90%;">, pages 15750–15758, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.2.2.1" style="font-size:90%;">(15)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.4.1" style="font-size:90%;">
Xinlei Chen, Saining Xie, and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.5.1" style="font-size:90%;">An empirical study of training self-supervised vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib15.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib15.8.3" style="font-size:90%;">, pages 9640–9649, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.2.2.1" style="font-size:90%;">(16)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.4.1" style="font-size:90%;">
Yiqiang Chen, Wang Lu, Xin Qin, Jindong Wang, and Xing Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.5.1" style="font-size:90%;">Metafed: Federated learning among federations with cyclic knowledge distillation for personalized healthcare.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.6.1" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span class="ltx_text" id="bib.bib16.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.2.2.1" style="font-size:90%;">(17)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.4.1" style="font-size:90%;">
Wonguk Cho, Jinha Park, and Taesup Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.5.1" style="font-size:90%;">Complementary domain adaptation and generalization for unsupervised continual domain shift learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.6.1" style="font-size:90%;">arXiv preprint arXiv:2303.15833</span><span class="ltx_text" id="bib.bib17.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.2.2.1" style="font-size:90%;">(18)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.4.1" style="font-size:90%;">
Myung Jin Choi, Joseph J Lim, Antonio Torralba, and Alan S Willsky.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.5.1" style="font-size:90%;">Exploiting hierarchical context on a large database of object categories.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib18.7.2" style="font-size:90%;">2010 IEEE computer society conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib18.8.3" style="font-size:90%;">, pages 129–136. IEEE, 2010.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.2.2.1" style="font-size:90%;">(19)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.4.1" style="font-size:90%;">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, and Sebastian Gehrmann.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.5.1" style="font-size:90%;">Palm: Scaling language modeling with pathways.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.6.1" style="font-size:90%;">Journal of Machine Learning Research</span><span class="ltx_text" id="bib.bib19.7.2" style="font-size:90%;">, 24(240):1–113, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.2.2.1" style="font-size:90%;">(20)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.4.1" style="font-size:90%;">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and Andre Van Schaik.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.5.1" style="font-size:90%;">Emnist: Extending mnist to handwritten letters.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib20.7.2" style="font-size:90%;">2017 international joint conference on neural networks (IJCNN)</span><span class="ltx_text" id="bib.bib20.8.3" style="font-size:90%;">, pages 2921–2926. IEEE, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.2.2.1" style="font-size:90%;">(21)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.4.1" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.5.1" style="font-size:90%;">Bert: Pre-training of deep bidirectional transformers for language understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.6.1" style="font-size:90%;">arXiv preprint arXiv:1810.04805</span><span class="ltx_text" id="bib.bib21.7.2" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.2.2.1" style="font-size:90%;">(22)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.4.1" style="font-size:90%;">
Mark Everingham, Luc Van Gool, Christopher KI Williams, John Winn, and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.5.1" style="font-size:90%;">The pascal visual object classes (voc) challenge.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.6.1" style="font-size:90%;">International journal of computer vision</span><span class="ltx_text" id="bib.bib22.7.2" style="font-size:90%;">, 88:303–338, 2010.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.2.2.1" style="font-size:90%;">(23)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.4.1" style="font-size:90%;">
Chen Fang, Ye Xu, and Daniel N Rockmore.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.5.1" style="font-size:90%;">Unbiased metric learning: On the utilization of multiple datasets and web images for softening bias.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib23.7.2" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib23.8.3" style="font-size:90%;">, pages 1657–1664, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.2.2.1" style="font-size:90%;">(24)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.4.1" style="font-size:90%;">
Abolfazl Farahani, Sahar Voghoei, Khaled Rasheed, and Hamid R Arabnia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.5.1" style="font-size:90%;">A brief review of domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.6.1" style="font-size:90%;">Advances in data science and information engineering</span><span class="ltx_text" id="bib.bib24.7.2" style="font-size:90%;">, pages 877–894, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.2.2.1" style="font-size:90%;">(25)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.4.1" style="font-size:90%;">
Li Fei-Fei, Rob Fergus, and Pietro Perona.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.5.1" style="font-size:90%;">Learning generative visual models from few training examples: An incremental bayesian approach tested on 101 object categories.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib25.7.2" style="font-size:90%;">2004 conference on computer vision and pattern recognition workshop</span><span class="ltx_text" id="bib.bib25.8.3" style="font-size:90%;">, pages 178–178. IEEE, 2004.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.2.2.1" style="font-size:90%;">(26)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.4.1" style="font-size:90%;">
Yaroslav Ganin and Victor Lempitsky.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.5.1" style="font-size:90%;">Unsupervised domain adaptation by backpropagation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib26.7.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib26.8.3" style="font-size:90%;">, pages 1180–1189. PMLR, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.2.2.1" style="font-size:90%;">(27)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.4.1" style="font-size:90%;">
Dashan Gao, Xin Yao, and Qiang Yang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.5.1" style="font-size:90%;">A survey on heterogeneous federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.6.1" style="font-size:90%;">arXiv preprint arXiv:2210.04505</span><span class="ltx_text" id="bib.bib27.7.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.2.2.1" style="font-size:90%;">(28)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.4.1" style="font-size:90%;">
Muhammad Ghifary, W Bastiaan Kleijn, Mengjie Zhang, David Balduzzi, and Wen Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.5.1" style="font-size:90%;">Deep reconstruction-classification networks for unsupervised domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib28.7.2" style="font-size:90%;">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11–14, 2016, Proceedings, Part IV 14</span><span class="ltx_text" id="bib.bib28.8.3" style="font-size:90%;">, pages 597–613. Springer, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.2.2.1" style="font-size:90%;">(29)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.4.1" style="font-size:90%;">
S. Gong, C. Cui, C. Zhang, W. Wang, X. Nie, and L. Zhu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.5.1" style="font-size:90%;">Federated domain generalization via prompt learning and aggregation (plan).
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.6.1" style="font-size:90%;">arXiv:2411.10063, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.2.2.1" style="font-size:90%;">(30)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.4.1" style="font-size:90%;">
Xuan Gong, Abhishek Sharma, Srikrishna Karanam, Ziyan Wu, Terrence Chen, David Doermann, and Arun Innanje.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.5.1" style="font-size:90%;">Preserving privacy in federated learning with ensemble cross-domain knowledge distillation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib30.7.2" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span class="ltx_text" id="bib.bib30.8.3" style="font-size:90%;">, volume 36, pages 11891–11899, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.2.2.1" style="font-size:90%;">(31)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.4.1" style="font-size:90%;">
Jean-Bastien Grill, Florian Strub, Florent Altché, Corentin Tallec, Pierre Richemond, Elena Buchatskaya, Carl Doersch, Bernardo Avila Pires, Zhaohan Guo, and Mohammad Gheshlaghi Azar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.5.1" style="font-size:90%;">Bootstrap your own latent-a new approach to self-supervised learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.6.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib31.7.2" style="font-size:90%;">, 33:21271–21284, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.2.2.1" style="font-size:90%;">(32)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.4.1" style="font-size:90%;">
Ishaan Gulrajani and David Lopez-Paz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.5.1" style="font-size:90%;">In search of lost domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.6.1" style="font-size:90%;">arXiv preprint arXiv:2007.01434</span><span class="ltx_text" id="bib.bib32.7.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.2.2.1" style="font-size:90%;">(33)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.4.1" style="font-size:90%;">
Tao Guo, Song Guo, Junxiao Wang, Xueyang Tang, and Wenchao Xu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.5.1" style="font-size:90%;">Promptfl: Let federated participants cooperatively learn prompts instead of models–federated learning in age of foundation model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.6.1" style="font-size:90%;">IEEE Transactions on Mobile Computing</span><span class="ltx_text" id="bib.bib33.7.2" style="font-size:90%;">, 23(5):5179–5194, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.2.2.1" style="font-size:90%;">(34)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.4.1" style="font-size:90%;">
Zixian Guo, Yuxiang Wei, Ming Liu, Zhilong Ji, Jinfeng Bai, Yiwen Guo, and Wangmeng Zuo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.5.1" style="font-size:90%;">Black-box tuning of vision-language models with effective gradient approximation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.6.1" style="font-size:90%;">arXiv preprint arXiv:2312.15901</span><span class="ltx_text" id="bib.bib34.7.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.2.2.1" style="font-size:90%;">(35)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.4.1" style="font-size:90%;">
Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.5.1" style="font-size:90%;">Momentum contrast for unsupervised visual representation learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib35.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib35.8.3" style="font-size:90%;">, pages 9729–9738, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.2.2.1" style="font-size:90%;">(36)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.4.1" style="font-size:90%;">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.5.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.6.1" style="font-size:90%;">arXiv preprint arXiv:2106.09685</span><span class="ltx_text" id="bib.bib36.7.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.2.2.1" style="font-size:90%;">(37)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.4.1" style="font-size:90%;">
Chao Jia, Yinfei Yang, Ye Xia, Yi-Ting Chen, Zarana Parekh, Hieu Pham, Quoc Le, Yun-Hsuan Sung, Zhen Li, and Tom Duerig.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.5.1" style="font-size:90%;">Scaling up visual and vision-language representation learning with noisy text supervision.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib37.7.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib37.8.3" style="font-size:90%;">, pages 4904–4916. PMLR, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.2.2.1" style="font-size:90%;">(38)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.4.1" style="font-size:90%;">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath Hariharan, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.5.1" style="font-size:90%;">Visual prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib38.7.2" style="font-size:90%;">European Conference on Computer Vision</span><span class="ltx_text" id="bib.bib38.8.3" style="font-size:90%;">, pages 709–727. Springer, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.2.2.1" style="font-size:90%;">(39)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.4.1" style="font-size:90%;">
Jakub Konečný, H Brendan McMahan, Daniel Ramage, and Peter Richtárik.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.5.1" style="font-size:90%;">Federated optimization: Distributed machine learning for on-device intelligence.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib39.6.1" style="font-size:90%;">arXiv preprint arXiv:1610.02527</span><span class="ltx_text" id="bib.bib39.7.2" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.2.2.1" style="font-size:90%;">(40)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.4.1" style="font-size:90%;">
Jakub Konečný, H Brendan McMahan, Felix X Yu, Peter Richtárik, Ananda Theertha Suresh, and Dave Bacon.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.5.1" style="font-size:90%;">Federated learning: Strategies for improving communication efficiency.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib40.6.1" style="font-size:90%;">arXiv preprint arXiv:1610.05492</span><span class="ltx_text" id="bib.bib40.7.2" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.2.2.1" style="font-size:90%;">(41)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.4.1" style="font-size:90%;">
Ang Li, Jingwei Sun, Xiao Zeng, Mi Zhang, Hai Li, and Yiran Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.5.1" style="font-size:90%;">Fedmask: Joint computation and communication-efficient personalized federated learning via heterogeneous masking.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib41.7.2" style="font-size:90%;">Proceedings of the 19th ACM Conference on Embedded Networked Sensor Systems</span><span class="ltx_text" id="bib.bib41.8.3" style="font-size:90%;">, pages 42–55, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.2.2.1" style="font-size:90%;">(42)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.4.1" style="font-size:90%;">
Da Li, Yongxin Yang, Yi-Zhe Song, and Timothy M Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.5.1" style="font-size:90%;">Deeper, broader and artier domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib42.7.2" style="font-size:90%;">Proceedings of the IEEE international conference on computer vision</span><span class="ltx_text" id="bib.bib42.8.3" style="font-size:90%;">, pages 5542–5550, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.2.2.1" style="font-size:90%;">(43)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.4.1" style="font-size:90%;">
Da Li, Jianshu Zhang, Yongxin Yang, Cong Liu, Yi-Zhe Song, and Timothy M Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.5.1" style="font-size:90%;">Episodic training for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib43.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib43.8.3" style="font-size:90%;">, pages 1446–1455, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.2.2.1" style="font-size:90%;">(44)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.4.1" style="font-size:90%;">
Daliang Li and Junpu Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.5.1" style="font-size:90%;">Fedmd: Heterogenous federated learning via model distillation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib44.6.1" style="font-size:90%;">arXiv preprint arXiv:1910.03581</span><span class="ltx_text" id="bib.bib44.7.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.2.2.1" style="font-size:90%;">(45)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.4.1" style="font-size:90%;">
Shichong Liu, Haozhe Jin, Zhiwei Tang, Rui Zhai, Ke Lu, Junyang Yu, and Chenxi Bai.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.5.1" style="font-size:90%;">Adapter-guided knowledge transfer for heterogeneous federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.6.1" style="font-size:90%;">Journal of Systems Architecture</span><span class="ltx_text" id="bib.bib45.7.2" style="font-size:90%;">, 159:103338, 2025.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.2.2.1" style="font-size:90%;">(46)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.4.1" style="font-size:90%;">
Weiyang Liu, Zeju Qiu, Yao Feng, Yuliang Xiu, Yuxuan Xue, Longhui Yu, Haiwen Feng, Zhen Liu, Juyeon Heo, and Songyou Peng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.5.1" style="font-size:90%;">Parameter-efficient orthogonal finetuning via butterfly factorization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.6.1" style="font-size:90%;">arXiv preprint arXiv:2311.06243</span><span class="ltx_text" id="bib.bib46.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.2.2.1" style="font-size:90%;">(47)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.4.1" style="font-size:90%;">
Mingsheng Long, Yue Cao, Jianmin Wang, and Michael Jordan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.5.1" style="font-size:90%;">Learning transferable features with deep adaptation networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib47.7.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib47.8.3" style="font-size:90%;">, pages 97–105. PMLR, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.2.2.1" style="font-size:90%;">(48)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.4.1" style="font-size:90%;">
Wang Lu, Xixu Hu, Jindong Wang, and Xing Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.5.1" style="font-size:90%;">Fedclip: Fast generalization and personalization for clip in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.6.1" style="font-size:90%;">arXiv preprint arXiv:2302.13485</span><span class="ltx_text" id="bib.bib48.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.2.2.1" style="font-size:90%;">(49)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.4.1" style="font-size:90%;">
Wang Lu, Jindong Wang, Yiqiang Chen, Xin Qin, Renjun Xu, Dimitrios Dimitriadis, and Tao Qin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.5.1" style="font-size:90%;">Personalized federated learning with adaptive batchnorm for healthcare.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.6.1" style="font-size:90%;">IEEE Transactions on Big Data</span><span class="ltx_text" id="bib.bib49.7.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib50.2.2.1" style="font-size:90%;">(50)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.4.1" style="font-size:90%;">
Wang Lu, Hao Yu, Jindong Wang, Damien Teney, Haohan Wang, Yao Zhu, Yiqiang Chen, Qiang Yang, Xing Xie, and Xiangyang Ji.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.5.1" style="font-size:90%;">Zoopfl: Exploring black-box foundation models for personalized federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib50.7.2" style="font-size:90%;">International Workshop on Trustworthy Federated Learning</span><span class="ltx_text" id="bib.bib50.8.3" style="font-size:90%;">, pages 19–35. Springer, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib51.2.2.1" style="font-size:90%;">(51)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.4.1" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.5.1" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib51.7.2" style="font-size:90%;">Artificial intelligence and statistics</span><span class="ltx_text" id="bib.bib51.8.3" style="font-size:90%;">, pages 1273–1282. PMLR, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib52.2.2.1" style="font-size:90%;">(52)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.4.1" style="font-size:90%;">
Fan’an Meng, Cheng Cui, Hao Dai, and Shaogang Gong.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.5.1" style="font-size:90%;">Black-box test-time prompt tuning for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib52.7.2" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span class="ltx_text" id="bib.bib52.8.3" style="font-size:90%;">, volume 39, pages 6099–6107, 2025.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib53.2.2.1" style="font-size:90%;">(53)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.4.1" style="font-size:90%;">
Krikamol Muandet, David Balduzzi, and Bernhard Schölkopf.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.5.1" style="font-size:90%;">Domain generalization via invariant feature representation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib53.7.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib53.8.3" style="font-size:90%;">, pages 10–18. PMLR, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib54.2.2.1" style="font-size:90%;">(54)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.4.1" style="font-size:90%;">
A Tuan Nguyen, Toan Tran, Yarin Gal, and Atilim Gunes Baydin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.5.1" style="font-size:90%;">Domain invariant representation learning with domain density transformations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.6.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib54.7.2" style="font-size:90%;">, 34:5264–5275, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib55.2.2.1" style="font-size:90%;">(55)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.4.1" style="font-size:90%;">
J. Niemeijer, M. Schwonberg, J.-A. Termöhlen, N. M. Schmidt, and T. Fingscheidt.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.5.1" style="font-size:90%;">Generalization by adaptation: Diffusion-based domain extension for domain-generalized semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib55.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision (WACV)</span><span class="ltx_text" id="bib.bib55.8.3" style="font-size:90%;">, pages 2830–2840, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib56.2.2.1" style="font-size:90%;">(56)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.4.1" style="font-size:90%;">
Changdae Oh, Hyeji Hwang, Hee-young Lee, YongTaek Lim, Geunyoung Jung, Jiyoung Jung, Hosik Choi, and Kyungwoo Song.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.5.1" style="font-size:90%;">BlackVIP: Black-box visual prompting for robust transfer learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib56.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib56.8.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib57.2.2.1" style="font-size:90%;">(57)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.4.1" style="font-size:90%;">
Aitor Ormazabal, Mikel Artetxe, and Eneko Agirre.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.5.1" style="font-size:90%;">CombLM: Adapting black-box language models through small fine-tuned models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib57.7.2" style="font-size:90%;">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</span><span class="ltx_text" id="bib.bib57.8.3" style="font-size:90%;">, pages 2961–2974, Singapore, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib58.2.2.1" style="font-size:90%;">(58)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.4.1" style="font-size:90%;">
Yassine Ouali, Adrian Bulat, Brais Martinez, and Georgios Tzimiropoulos.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.5.1" style="font-size:90%;">Black box few-shot adaptation for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib58.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib58.8.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib59.2.2.1" style="font-size:90%;">(59)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.4.1" style="font-size:90%;">
Jay N. Paranjape, Shameema Sikder, S. Swaroop Vedula, and Vishal M. Patel.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.5.1" style="font-size:90%;">Blackbox adaptation for medical image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib59.7.2" style="font-size:90%;">Proceedings of the International Conference on Medical Image Computing and Computer-Assisted Intervention (MICCAI)</span><span class="ltx_text" id="bib.bib59.8.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib60.2.2.1" style="font-size:90%;">(60)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.4.1" style="font-size:90%;">
Jay N. Paranjape, Shameema Sikder, S. Swaroop Vedula, and Vishal M. Patel.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.5.1" style="font-size:90%;">Federated black-box adaptation for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib60.7.2" style="font-size:90%;">Proceedings of the 38th Conference on Neural Information Processing Systems (NeurIPS)</span><span class="ltx_text" id="bib.bib60.8.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib61.2.2.1" style="font-size:90%;">(61)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.4.1" style="font-size:90%;">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, and Luca Antiga.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.5.1" style="font-size:90%;">Pytorch: An imperative style, high-performance deep learning library.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib61.7.2" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib61.8.3" style="font-size:90%;">, pages 8026–8037, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib62.2.2.1" style="font-size:90%;">(62)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.4.1" style="font-size:90%;">
Zhongyi Pei, Zhangjie Cao, Mingsheng Long, and Jianmin Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.5.1" style="font-size:90%;">Multi-adversarial domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib62.7.2" style="font-size:90%;">Proceedings of the AAAI conference on artificial intelligence</span><span class="ltx_text" id="bib.bib62.8.3" style="font-size:90%;">, volume 32, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib63.2.2.1" style="font-size:90%;">(63)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.4.1" style="font-size:90%;">
Krishna Pillutla, Kshitiz Malik, Abdel-Rahman Mohamed, Mike Rabbat, Maziar Sanjabi, and Lin Xiao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.5.1" style="font-size:90%;">Federated learning with partial model personalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib63.7.2" style="font-size:90%;">International Conference on Machine Learning</span><span class="ltx_text" id="bib.bib63.8.3" style="font-size:90%;">, pages 17716–17758. PMLR, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib64.2.2.1" style="font-size:90%;">(64)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.4.1" style="font-size:90%;">
Zeju Qiu, Weiyang Liu, Haiwen Feng, Yuxuan Xue, Yao Feng, Zhen Liu, Dan Zhang, Adrian Weller, and Bernhard Schölkopf.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.5.1" style="font-size:90%;">Controlling text-to-image diffusion by orthogonal finetuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib64.6.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib64.7.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib65.2.2.1" style="font-size:90%;">(65)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.4.1" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.5.1" style="font-size:90%;">Learning transferable visual models from natural language supervision.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib65.7.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib65.8.3" style="font-size:90%;">, pages 8748–8763. PMLR, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib66.2.2.1" style="font-size:90%;">(66)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.4.1" style="font-size:90%;">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.5.1" style="font-size:90%;">Language models are unsupervised multitask learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib66.6.1" style="font-size:90%;">OpenAI blog</span><span class="ltx_text" id="bib.bib66.7.2" style="font-size:90%;">, 1(8):9, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib67.2.2.1" style="font-size:90%;">(67)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.4.1" style="font-size:90%;">
Bryan C Russell, Antonio Torralba, Kevin P Murphy, and William T Freeman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.5.1" style="font-size:90%;">Labelme: a database and web-based tool for image annotation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib67.6.1" style="font-size:90%;">International journal of computer vision</span><span class="ltx_text" id="bib.bib67.7.2" style="font-size:90%;">, 77:157–173, 2008.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib68.2.2.1" style="font-size:90%;">(68)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.4.1" style="font-size:90%;">
Shiv Shankar, Vihari Piratla, Soumen Chakrabarti, Siddhartha Chaudhuri, Preethi Jyothi, and Sunita Sarawagi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.5.1" style="font-size:90%;">Generalizing across domains via cross-gradient training.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib68.6.1" style="font-size:90%;">arXiv preprint arXiv:1804.10745</span><span class="ltx_text" id="bib.bib68.7.2" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib69.2.2.1" style="font-size:90%;">(69)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.4.1" style="font-size:90%;">
Karan Singhal, Hakim Sidahmed, Zachary Garrett, Shanshan Wu, John Rush, and Sushant Prakash.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.5.1" style="font-size:90%;">Federated reconstruction: Partially local federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib69.6.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib69.7.2" style="font-size:90%;">, 34:11220–11232, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib70.2.2.1" style="font-size:90%;">(70)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.4.1" style="font-size:90%;">
B. Sun and K. Saenko.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.5.1" style="font-size:90%;">Deep coral: Correlation alignment for deep domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib70.7.2" style="font-size:90%;">Proceedings of the European Conference on Computer Vision (ECCV) Workshops</span><span class="ltx_text" id="bib.bib70.8.3" style="font-size:90%;">, pages 443–450, Amsterdam, The Netherlands, 2016. Springer.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib71.2.2.1" style="font-size:90%;">(71)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.4.1" style="font-size:90%;">
Tianxiang Sun, Yunfan Shao, Hong Qian, Xuanjing Huang, and Xipeng Qiu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.5.1" style="font-size:90%;">Black-box tuning for language-model-as-a-service.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib71.7.2" style="font-size:90%;">Proceedings of the 39th International Conference on Machine Learning</span><span class="ltx_text" id="bib.bib71.8.3" style="font-size:90%;">, volume 162, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib72.2.2.1" style="font-size:90%;">(72)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.4.1" style="font-size:90%;">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, and Faisal Azhar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.5.1" style="font-size:90%;">Llama: Open and efficient foundation language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib72.6.1" style="font-size:90%;">arXiv preprint arXiv:2302.13971</span><span class="ltx_text" id="bib.bib72.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib73.2.2.1" style="font-size:90%;">(73)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.4.1" style="font-size:90%;">
Eric Tzeng, Judy Hoffman, Trevor Darrell, and Kate Saenko.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.5.1" style="font-size:90%;">Simultaneous deep transfer across domains and tasks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib73.7.2" style="font-size:90%;">Proceedings of the IEEE international conference on computer vision</span><span class="ltx_text" id="bib.bib73.8.3" style="font-size:90%;">, pages 4068–4076, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib74.2.2.1" style="font-size:90%;">(74)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.4.1" style="font-size:90%;">
Hemanth Venkateswara, Jose Eusebio, Shayok Chakraborty, and Sethuraman Panchanathan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.5.1" style="font-size:90%;">Deep hashing network for unsupervised domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib74.7.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib74.8.3" style="font-size:90%;">, pages 5018–5027, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib75.2.2.1" style="font-size:90%;">(75)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.4.1" style="font-size:90%;">
Guoyizhe Wei, Feng Wang, Anshul Shah, and Rama Chellappa.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.5.1" style="font-size:90%;">Dual prompt tuning for domain-aware federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib75.6.1" style="font-size:90%;">arXiv preprint arXiv:2310.03103</span><span class="ltx_text" id="bib.bib75.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib76.2.2.1" style="font-size:90%;">(76)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.4.1" style="font-size:90%;">
Jinze Wu, Qi Liu, Zhenya Huang, Yuting Ning, Hao Wang, Enhong Chen, Jinfeng Yi, and Bowen Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.5.1" style="font-size:90%;">Hierarchical personalized federated learning for user modeling.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib76.7.2" style="font-size:90%;">Proceedings of the Web Conference 2021</span><span class="ltx_text" id="bib.bib76.8.3" style="font-size:90%;">, pages 957–968, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib77.2.2.1" style="font-size:90%;">(77)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.4.1" style="font-size:90%;">
Guangxuan Xiao, Ji Lin, and Song Han.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.5.1" style="font-size:90%;">Offsite-tuning: Transfer learning without full model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib77.6.1" style="font-size:90%;">arXiv preprint arXiv:2302.04870</span><span class="ltx_text" id="bib.bib77.7.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib78.2.2.1" style="font-size:90%;">(78)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.4.1" style="font-size:90%;">
Ting Yao, Yingwei Pan, Chong-Wah Ngo, Houqiang Li, and Tao Mei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.5.1" style="font-size:90%;">Semi-supervised domain adaptation with subspace learning for visual recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib78.7.2" style="font-size:90%;">Proceedings of the IEEE conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib78.8.3" style="font-size:90%;">, pages 2142–2150, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib79.2.2.1" style="font-size:90%;">(79)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.4.1" style="font-size:90%;">
Liping Yi, Gang Wang, Xiaoguang Liu, Zhuan Shi, and Han Yu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.5.1" style="font-size:90%;">Fedgh: Heterogeneous federated learning with generalized global header.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib79.7.2" style="font-size:90%;">Proceedings of the 31st ACM International Conference on Multimedia</span><span class="ltx_text" id="bib.bib79.8.3" style="font-size:90%;">, pages 8686–8696, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib80.2.2.1" style="font-size:90%;">(80)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.4.1" style="font-size:90%;">
Lang Yu, Qin Chen, Jiaju Lin, and Liang He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.5.1" style="font-size:90%;">Black-box prompt tuning for vision-language model as a service.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib80.7.2" style="font-size:90%;">Proceedings of the Thirty-Second International Joint Conference on Artificial Intelligence</span><span class="ltx_text" id="bib.bib80.8.3" style="font-size:90%;">, pages 1686–1694, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib81.2.2.1" style="font-size:90%;">(81)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.4.1" style="font-size:90%;">
Jie Zhang, Song Guo, Xiaosong Ma, Haozhao Wang, Wenchao Xu, and Feijie Wu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.5.1" style="font-size:90%;">Parameterized knowledge transfer for personalized federated learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib81.6.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib81.7.2" style="font-size:90%;">, 34:10092–10104, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib82.2.2.1" style="font-size:90%;">(82)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.4.1" style="font-size:90%;">
R. Zhang, Q. Xu, J. Yao, Y. Zhang, Q. Tian, and Y. Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.5.1" style="font-size:90%;">Federated domain generalization with generalization adjustment.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib82.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span><span class="ltx_text" id="bib.bib82.8.3" style="font-size:90%;">, pages 3954–3963, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib83.2.2.1" style="font-size:90%;">(83)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.4.1" style="font-size:90%;">
Renrui Zhang, Wei Zhang, Rongyao Fang, Peng Gao, Kunchang Li, Jifeng Dai, Yu Qiao, and Hongsheng Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.5.1" style="font-size:90%;">Tip-adapter: Training-free adaption of CLIP for few-shot classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib83.7.2" style="font-size:90%;">Computer Vision – ECCV 2022</span><span class="ltx_text" id="bib.bib83.8.3" style="font-size:90%;">, pages 493–510, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib84.2.2.1" style="font-size:90%;">(84)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.4.1" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.5.1" style="font-size:90%;">Conditional prompt learning for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.6.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib84.7.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib84.8.3" style="font-size:90%;">, pages 16816–16825, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib85.2.2.1" style="font-size:90%;">(85)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.4.1" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.5.1" style="font-size:90%;">Learning to prompt for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib85.6.1" style="font-size:90%;">International Journal of Computer Vision</span><span class="ltx_text" id="bib.bib85.7.2" style="font-size:90%;">, 130(9):2337–2348, 2022.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Foundation Models</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Foundation models <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">Bommasani2021FM</span> </a></cite>, exemplified by the GPT series <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">RN744</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">RN745</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">RN746</span> </a></cite>, vision-language models (VLMs)<cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">RN568</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">jia2021scaling</span> </a></cite>, and others<cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">RN747</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">RN748</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">RN749</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib72" title=""><span class="ltx_text" style="font-size:90%;">RN752</span> </a></cite>, represent a transformative phase in artificial intelligence.
These models are characterized by their unprecedented scale, extensive pre-training, and remarkable performance across a wide range of downstream tasks.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">Notably, the success of contrastive pre-training in visual tasks <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">RN754</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">RN756</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">RN757</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">RN758</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">RN759</span> </a></cite> has driven the adoption of multi-modal contrastive pre-training as a core strategy in contemporary research.
CLIP <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">RN568</span> </a></cite> serves as a representative example of this trend, showcasing the potential of aligning visual and language modalities for diverse applications.
In this study, we focus on vision foundation models, including VLMs such as CLIP, and highlight their potential for extension to federated learning in vision tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Federated Learning</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Federated Learning (FL) is a machine learning approach that enables model training across multiple devices or servers holding local data without requiring data centralization <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">RN705</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">RN706</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">mcmahan2017communication</span> </a></cite>.
This framework offers significant advantages, particularly in preserving data privacy and efficiently utilizing resources, as it eliminates the need to transmit large volumes of sensitive data to a central server.
FL is generally categorized into homogeneous and heterogeneous paradigms.
Homogeneous FL assumes similar computational power and data distribution across all clients, allowing for a uniform training process.
In contrast, heterogeneous FL involves clients with diverse computational resources and non-IID (independent and identically distributed) data, presenting substantial challenges in training and model aggregation <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">RN649</span> </a></cite>.
Designing systems that can effectively address such client diversity is crucial.
To this end, personalized FL—an approach that trains personalized local models alongside a global model—has emerged as a key strategy to handle model heterogeneity <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib63" title=""><span class="ltx_text" style="font-size:90%;">pillutla2022federated</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">RN723</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">RN727</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib81" title=""><span class="ltx_text" style="font-size:90%;">RN729</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">RN737</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib41" title=""><span class="ltx_text" style="font-size:90%;">RN714</span> </a></cite>.
The advent of large-scale pre-trained VLMs, such as CLIP <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">RN568</span> </a></cite>, has further driven research in FL, encouraging exploration into the integration of VLMs within the FL framework <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">RN587</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">guo2023promptfl</span> </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib75" title=""><span class="ltx_text" style="font-size:90%;">RN645</span> </a></cite>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Preliminaries</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Contrastive Language-Image Pretraining (CLIP)</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.13">A pre-trained CLIP model architecture features a dual-stream design, comprising a text encoder, denoted as <math alttext="\mathcal{T}_{\phi}" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><msub id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">𝒯</mi><mi id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.1.2">𝒯</ci><ci id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">\mathcal{T}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, and an image encoder, <math alttext="\mathcal{I}_{\theta}" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><msub id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">ℐ</mi><mi id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">ℐ</ci><ci id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">\mathcal{I}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">caligraphic_I start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\phi" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">italic_ϕ</annotation></semantics></math> and <math alttext="\theta" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.1"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.1d">italic_θ</annotation></semantics></math> represent the pre-trained parameters.
For a given task <math alttext="\tau" class="ltx_Math" display="inline" id="A2.SS1.p1.5.m5.1"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.5.m5.1d">italic_τ</annotation></semantics></math> with a set of classes <math alttext="{Y^{\tau}}=\{y_{c}^{\tau}\}_{c=1}^{K^{\tau}}" class="ltx_Math" display="inline" id="A2.SS1.p1.6.m6.1"><semantics id="A2.SS1.p1.6.m6.1a"><mrow id="A2.SS1.p1.6.m6.1.1" xref="A2.SS1.p1.6.m6.1.1.cmml"><msup id="A2.SS1.p1.6.m6.1.1.3" xref="A2.SS1.p1.6.m6.1.1.3.cmml"><mi id="A2.SS1.p1.6.m6.1.1.3.2" xref="A2.SS1.p1.6.m6.1.1.3.2.cmml">Y</mi><mi id="A2.SS1.p1.6.m6.1.1.3.3" xref="A2.SS1.p1.6.m6.1.1.3.3.cmml">τ</mi></msup><mo id="A2.SS1.p1.6.m6.1.1.2" xref="A2.SS1.p1.6.m6.1.1.2.cmml">=</mo><msubsup id="A2.SS1.p1.6.m6.1.1.1" xref="A2.SS1.p1.6.m6.1.1.1.cmml"><mrow id="A2.SS1.p1.6.m6.1.1.1.1.1.1" xref="A2.SS1.p1.6.m6.1.1.1.1.1.2.cmml"><mo id="A2.SS1.p1.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="A2.SS1.p1.6.m6.1.1.1.1.1.2.cmml">{</mo><msubsup id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml"><mi id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.2" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.3" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.3.cmml">c</mi><mi id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.3" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="A2.SS1.p1.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="A2.SS1.p1.6.m6.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A2.SS1.p1.6.m6.1.1.1.1.3" xref="A2.SS1.p1.6.m6.1.1.1.1.3.cmml"><mi id="A2.SS1.p1.6.m6.1.1.1.1.3.2" xref="A2.SS1.p1.6.m6.1.1.1.1.3.2.cmml">c</mi><mo id="A2.SS1.p1.6.m6.1.1.1.1.3.1" xref="A2.SS1.p1.6.m6.1.1.1.1.3.1.cmml">=</mo><mn id="A2.SS1.p1.6.m6.1.1.1.1.3.3" xref="A2.SS1.p1.6.m6.1.1.1.1.3.3.cmml">1</mn></mrow><msup id="A2.SS1.p1.6.m6.1.1.1.3" xref="A2.SS1.p1.6.m6.1.1.1.3.cmml"><mi id="A2.SS1.p1.6.m6.1.1.1.3.2" xref="A2.SS1.p1.6.m6.1.1.1.3.2.cmml">K</mi><mi id="A2.SS1.p1.6.m6.1.1.1.3.3" xref="A2.SS1.p1.6.m6.1.1.1.3.3.cmml">τ</mi></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.6.m6.1b"><apply id="A2.SS1.p1.6.m6.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1"><eq id="A2.SS1.p1.6.m6.1.1.2.cmml" xref="A2.SS1.p1.6.m6.1.1.2"></eq><apply id="A2.SS1.p1.6.m6.1.1.3.cmml" xref="A2.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.3.1.cmml" xref="A2.SS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.6.m6.1.1.3.2.cmml" xref="A2.SS1.p1.6.m6.1.1.3.2">𝑌</ci><ci id="A2.SS1.p1.6.m6.1.1.3.3.cmml" xref="A2.SS1.p1.6.m6.1.1.3.3">𝜏</ci></apply><apply id="A2.SS1.p1.6.m6.1.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.1.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1">superscript</csymbol><apply id="A2.SS1.p1.6.m6.1.1.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.1.1.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1">subscript</csymbol><set id="A2.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1"><apply id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1">superscript</csymbol><apply id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.3.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.1.1.1.3">𝜏</ci></apply></set><apply id="A2.SS1.p1.6.m6.1.1.1.1.3.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.3"><eq id="A2.SS1.p1.6.m6.1.1.1.1.3.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.3.1"></eq><ci id="A2.SS1.p1.6.m6.1.1.1.1.3.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1.1.3.2">𝑐</ci><cn id="A2.SS1.p1.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="A2.SS1.p1.6.m6.1.1.1.1.3.3">1</cn></apply></apply><apply id="A2.SS1.p1.6.m6.1.1.1.3.cmml" xref="A2.SS1.p1.6.m6.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.6.m6.1.1.1.3.1.cmml" xref="A2.SS1.p1.6.m6.1.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.6.m6.1.1.1.3.2.cmml" xref="A2.SS1.p1.6.m6.1.1.1.3.2">𝐾</ci><ci id="A2.SS1.p1.6.m6.1.1.1.3.3.cmml" xref="A2.SS1.p1.6.m6.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.6.m6.1c">{Y^{\tau}}=\{y_{c}^{\tau}\}_{c=1}^{K^{\tau}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.6.m6.1d">italic_Y start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT = { italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="{K^{\tau}}" class="ltx_Math" display="inline" id="A2.SS1.p1.7.m7.1"><semantics id="A2.SS1.p1.7.m7.1a"><msup id="A2.SS1.p1.7.m7.1.1" xref="A2.SS1.p1.7.m7.1.1.cmml"><mi id="A2.SS1.p1.7.m7.1.1.2" xref="A2.SS1.p1.7.m7.1.1.2.cmml">K</mi><mi id="A2.SS1.p1.7.m7.1.1.3" xref="A2.SS1.p1.7.m7.1.1.3.cmml">τ</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.7.m7.1b"><apply id="A2.SS1.p1.7.m7.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.7.m7.1.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="A2.SS1.p1.7.m7.1.1.2.cmml" xref="A2.SS1.p1.7.m7.1.1.2">𝐾</ci><ci id="A2.SS1.p1.7.m7.1.1.3.cmml" xref="A2.SS1.p1.7.m7.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.7.m7.1c">{K^{\tau}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.7.m7.1d">italic_K start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the number of classes for classification, the model utilizes a set of class embeddings <math alttext="t^{\tau}=\{\mathcal{T}_{\phi}(p_{c}^{\tau})\}_{c=1}^{K^{\tau}}" class="ltx_Math" display="inline" id="A2.SS1.p1.8.m8.1"><semantics id="A2.SS1.p1.8.m8.1a"><mrow id="A2.SS1.p1.8.m8.1.1" xref="A2.SS1.p1.8.m8.1.1.cmml"><msup id="A2.SS1.p1.8.m8.1.1.3" xref="A2.SS1.p1.8.m8.1.1.3.cmml"><mi id="A2.SS1.p1.8.m8.1.1.3.2" xref="A2.SS1.p1.8.m8.1.1.3.2.cmml">t</mi><mi id="A2.SS1.p1.8.m8.1.1.3.3" xref="A2.SS1.p1.8.m8.1.1.3.3.cmml">τ</mi></msup><mo id="A2.SS1.p1.8.m8.1.1.2" xref="A2.SS1.p1.8.m8.1.1.2.cmml">=</mo><msubsup id="A2.SS1.p1.8.m8.1.1.1" xref="A2.SS1.p1.8.m8.1.1.1.cmml"><mrow id="A2.SS1.p1.8.m8.1.1.1.1.1.1" xref="A2.SS1.p1.8.m8.1.1.1.1.1.2.cmml"><mo id="A2.SS1.p1.8.m8.1.1.1.1.1.1.2" stretchy="false" xref="A2.SS1.p1.8.m8.1.1.1.1.1.2.cmml">{</mo><mrow id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.cmml"><msub id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.2" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.3" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.2" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.2" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.3" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mi id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.3" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.SS1.p1.8.m8.1.1.1.1.1.1.3" stretchy="false" xref="A2.SS1.p1.8.m8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A2.SS1.p1.8.m8.1.1.1.1.3" xref="A2.SS1.p1.8.m8.1.1.1.1.3.cmml"><mi id="A2.SS1.p1.8.m8.1.1.1.1.3.2" xref="A2.SS1.p1.8.m8.1.1.1.1.3.2.cmml">c</mi><mo id="A2.SS1.p1.8.m8.1.1.1.1.3.1" xref="A2.SS1.p1.8.m8.1.1.1.1.3.1.cmml">=</mo><mn id="A2.SS1.p1.8.m8.1.1.1.1.3.3" xref="A2.SS1.p1.8.m8.1.1.1.1.3.3.cmml">1</mn></mrow><msup id="A2.SS1.p1.8.m8.1.1.1.3" xref="A2.SS1.p1.8.m8.1.1.1.3.cmml"><mi id="A2.SS1.p1.8.m8.1.1.1.3.2" xref="A2.SS1.p1.8.m8.1.1.1.3.2.cmml">K</mi><mi id="A2.SS1.p1.8.m8.1.1.1.3.3" xref="A2.SS1.p1.8.m8.1.1.1.3.3.cmml">τ</mi></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.8.m8.1b"><apply id="A2.SS1.p1.8.m8.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1"><eq id="A2.SS1.p1.8.m8.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.2"></eq><apply id="A2.SS1.p1.8.m8.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.3.1.cmml" xref="A2.SS1.p1.8.m8.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.8.m8.1.1.3.2.cmml" xref="A2.SS1.p1.8.m8.1.1.3.2">𝑡</ci><ci id="A2.SS1.p1.8.m8.1.1.3.3.cmml" xref="A2.SS1.p1.8.m8.1.1.3.3">𝜏</ci></apply><apply id="A2.SS1.p1.8.m8.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1">superscript</csymbol><apply id="A2.SS1.p1.8.m8.1.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1">subscript</csymbol><set id="A2.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1"><apply id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1"><times id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.2"></times><apply id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.2">𝒯</ci><ci id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply></set><apply id="A2.SS1.p1.8.m8.1.1.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.3"><eq id="A2.SS1.p1.8.m8.1.1.1.1.3.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.3.1"></eq><ci id="A2.SS1.p1.8.m8.1.1.1.1.3.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.1.3.2">𝑐</ci><cn id="A2.SS1.p1.8.m8.1.1.1.1.3.3.cmml" type="integer" xref="A2.SS1.p1.8.m8.1.1.1.1.3.3">1</cn></apply></apply><apply id="A2.SS1.p1.8.m8.1.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.3.1.cmml" xref="A2.SS1.p1.8.m8.1.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.8.m8.1.1.1.3.2.cmml" xref="A2.SS1.p1.8.m8.1.1.1.3.2">𝐾</ci><ci id="A2.SS1.p1.8.m8.1.1.1.3.3.cmml" xref="A2.SS1.p1.8.m8.1.1.1.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.8.m8.1c">t^{\tau}=\{\mathcal{T}_{\phi}(p_{c}^{\tau})\}_{c=1}^{K^{\tau}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.8.m8.1d">italic_t start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT = { caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
These embeddings are generated through natural language prompting <math alttext="p_{c}^{\tau}" class="ltx_Math" display="inline" id="A2.SS1.p1.9.m9.1"><semantics id="A2.SS1.p1.9.m9.1a"><msubsup id="A2.SS1.p1.9.m9.1.1" xref="A2.SS1.p1.9.m9.1.1.cmml"><mi id="A2.SS1.p1.9.m9.1.1.2.2" xref="A2.SS1.p1.9.m9.1.1.2.2.cmml">p</mi><mi id="A2.SS1.p1.9.m9.1.1.2.3" xref="A2.SS1.p1.9.m9.1.1.2.3.cmml">c</mi><mi id="A2.SS1.p1.9.m9.1.1.3" xref="A2.SS1.p1.9.m9.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.9.m9.1b"><apply id="A2.SS1.p1.9.m9.1.1.cmml" xref="A2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.9.m9.1.1.1.cmml" xref="A2.SS1.p1.9.m9.1.1">superscript</csymbol><apply id="A2.SS1.p1.9.m9.1.1.2.cmml" xref="A2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.9.m9.1.1.2.1.cmml" xref="A2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="A2.SS1.p1.9.m9.1.1.2.2.cmml" xref="A2.SS1.p1.9.m9.1.1.2.2">𝑝</ci><ci id="A2.SS1.p1.9.m9.1.1.2.3.cmml" xref="A2.SS1.p1.9.m9.1.1.2.3">𝑐</ci></apply><ci id="A2.SS1.p1.9.m9.1.1.3.cmml" xref="A2.SS1.p1.9.m9.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.9.m9.1c">p_{c}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.9.m9.1d">italic_p start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> = <span class="ltx_text ltx_font_typewriter" id="A2.SS1.p1.10.1">"a picture of a {class name of <math alttext="y_{c}^{\tau}" class="ltx_Math" display="inline" id="A2.SS1.p1.10.1.m1.1"><semantics id="A2.SS1.p1.10.1.m1.1a"><msubsup id="A2.SS1.p1.10.1.m1.1.1" xref="A2.SS1.p1.10.1.m1.1.1.cmml"><mi id="A2.SS1.p1.10.1.m1.1.1.2.2" xref="A2.SS1.p1.10.1.m1.1.1.2.2.cmml">y</mi><mi id="A2.SS1.p1.10.1.m1.1.1.2.3" xref="A2.SS1.p1.10.1.m1.1.1.2.3.cmml">c</mi><mi id="A2.SS1.p1.10.1.m1.1.1.3" xref="A2.SS1.p1.10.1.m1.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.10.1.m1.1b"><apply id="A2.SS1.p1.10.1.m1.1.1.cmml" xref="A2.SS1.p1.10.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.10.1.m1.1.1.1.cmml" xref="A2.SS1.p1.10.1.m1.1.1">superscript</csymbol><apply id="A2.SS1.p1.10.1.m1.1.1.2.cmml" xref="A2.SS1.p1.10.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.10.1.m1.1.1.2.1.cmml" xref="A2.SS1.p1.10.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p1.10.1.m1.1.1.2.2.cmml" xref="A2.SS1.p1.10.1.m1.1.1.2.2">𝑦</ci><ci id="A2.SS1.p1.10.1.m1.1.1.2.3.cmml" xref="A2.SS1.p1.10.1.m1.1.1.2.3">𝑐</ci></apply><ci id="A2.SS1.p1.10.1.m1.1.1.3.cmml" xref="A2.SS1.p1.10.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.10.1.m1.1c">y_{c}^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.10.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>}"</span>.
Upon receiving image data <math alttext="x" class="ltx_Math" display="inline" id="A2.SS1.p1.11.m10.1"><semantics id="A2.SS1.p1.11.m10.1a"><mi id="A2.SS1.p1.11.m10.1.1" xref="A2.SS1.p1.11.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.11.m10.1b"><ci id="A2.SS1.p1.11.m10.1.1.cmml" xref="A2.SS1.p1.11.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.11.m10.1c">x</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.11.m10.1d">italic_x</annotation></semantics></math>, the corresponding embedding <math alttext="\mathcal{I}_{\theta}(x)" class="ltx_Math" display="inline" id="A2.SS1.p1.12.m11.1"><semantics id="A2.SS1.p1.12.m11.1a"><mrow id="A2.SS1.p1.12.m11.1.2" xref="A2.SS1.p1.12.m11.1.2.cmml"><msub id="A2.SS1.p1.12.m11.1.2.2" xref="A2.SS1.p1.12.m11.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.12.m11.1.2.2.2" xref="A2.SS1.p1.12.m11.1.2.2.2.cmml">ℐ</mi><mi id="A2.SS1.p1.12.m11.1.2.2.3" xref="A2.SS1.p1.12.m11.1.2.2.3.cmml">θ</mi></msub><mo id="A2.SS1.p1.12.m11.1.2.1" xref="A2.SS1.p1.12.m11.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p1.12.m11.1.2.3.2" xref="A2.SS1.p1.12.m11.1.2.cmml"><mo id="A2.SS1.p1.12.m11.1.2.3.2.1" stretchy="false" xref="A2.SS1.p1.12.m11.1.2.cmml">(</mo><mi id="A2.SS1.p1.12.m11.1.1" xref="A2.SS1.p1.12.m11.1.1.cmml">x</mi><mo id="A2.SS1.p1.12.m11.1.2.3.2.2" stretchy="false" xref="A2.SS1.p1.12.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.12.m11.1b"><apply id="A2.SS1.p1.12.m11.1.2.cmml" xref="A2.SS1.p1.12.m11.1.2"><times id="A2.SS1.p1.12.m11.1.2.1.cmml" xref="A2.SS1.p1.12.m11.1.2.1"></times><apply id="A2.SS1.p1.12.m11.1.2.2.cmml" xref="A2.SS1.p1.12.m11.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p1.12.m11.1.2.2.1.cmml" xref="A2.SS1.p1.12.m11.1.2.2">subscript</csymbol><ci id="A2.SS1.p1.12.m11.1.2.2.2.cmml" xref="A2.SS1.p1.12.m11.1.2.2.2">ℐ</ci><ci id="A2.SS1.p1.12.m11.1.2.2.3.cmml" xref="A2.SS1.p1.12.m11.1.2.2.3">𝜃</ci></apply><ci id="A2.SS1.p1.12.m11.1.1.cmml" xref="A2.SS1.p1.12.m11.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.12.m11.1c">\mathcal{I}_{\theta}(x)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.12.m11.1d">caligraphic_I start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is matched against the class embeddings using cosine similarity <math alttext="\text{Sim}(\cdot,\cdot)" class="ltx_Math" display="inline" id="A2.SS1.p1.13.m12.2"><semantics id="A2.SS1.p1.13.m12.2a"><mrow id="A2.SS1.p1.13.m12.2.3" xref="A2.SS1.p1.13.m12.2.3.cmml"><mtext id="A2.SS1.p1.13.m12.2.3.2" xref="A2.SS1.p1.13.m12.2.3.2a.cmml">Sim</mtext><mo id="A2.SS1.p1.13.m12.2.3.1" xref="A2.SS1.p1.13.m12.2.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.13.m12.2.3.3.2" xref="A2.SS1.p1.13.m12.2.3.3.1.cmml"><mo id="A2.SS1.p1.13.m12.2.3.3.2.1" stretchy="false" xref="A2.SS1.p1.13.m12.2.3.3.1.cmml">(</mo><mo id="A2.SS1.p1.13.m12.1.1" lspace="0em" rspace="0em" xref="A2.SS1.p1.13.m12.1.1.cmml">⋅</mo><mo id="A2.SS1.p1.13.m12.2.3.3.2.2" rspace="0em" xref="A2.SS1.p1.13.m12.2.3.3.1.cmml">,</mo><mo id="A2.SS1.p1.13.m12.2.2" lspace="0em" rspace="0em" xref="A2.SS1.p1.13.m12.2.2.cmml">⋅</mo><mo id="A2.SS1.p1.13.m12.2.3.3.2.3" stretchy="false" xref="A2.SS1.p1.13.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.13.m12.2b"><apply id="A2.SS1.p1.13.m12.2.3.cmml" xref="A2.SS1.p1.13.m12.2.3"><times id="A2.SS1.p1.13.m12.2.3.1.cmml" xref="A2.SS1.p1.13.m12.2.3.1"></times><ci id="A2.SS1.p1.13.m12.2.3.2a.cmml" xref="A2.SS1.p1.13.m12.2.3.2"><mtext id="A2.SS1.p1.13.m12.2.3.2.cmml" xref="A2.SS1.p1.13.m12.2.3.2">Sim</mtext></ci><interval closure="open" id="A2.SS1.p1.13.m12.2.3.3.1.cmml" xref="A2.SS1.p1.13.m12.2.3.3.2"><ci id="A2.SS1.p1.13.m12.1.1.cmml" xref="A2.SS1.p1.13.m12.1.1">⋅</ci><ci id="A2.SS1.p1.13.m12.2.2.cmml" xref="A2.SS1.p1.13.m12.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.13.m12.2c">\text{Sim}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.13.m12.2d">Sim ( ⋅ , ⋅ )</annotation></semantics></math>, and the task-specific classification probability is then calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(y=y_{c}^{\tau}|x;\phi,\theta,\tau)=\frac{e^{\alpha\cdot\text{Sim}(\mathcal{I%
}_{\theta}(x),\mathcal{T}_{\phi}(p_{c}^{\tau}))}}{\sum_{c^{\prime}=1}^{C^{\tau%
}}e^{\alpha\cdot\text{Sim}(\mathcal{I}_{\theta}(x),\mathcal{T}_{\phi}(p_{c^{%
\prime}}^{\tau}))}}" class="ltx_Math" display="block" id="A2.Ex5.m1.11"><semantics id="A2.Ex5.m1.11a"><mrow id="A2.Ex5.m1.11.11" xref="A2.Ex5.m1.11.11.cmml"><mrow id="A2.Ex5.m1.11.11.1" xref="A2.Ex5.m1.11.11.1.cmml"><mi id="A2.Ex5.m1.11.11.1.3" xref="A2.Ex5.m1.11.11.1.3.cmml">p</mi><mo id="A2.Ex5.m1.11.11.1.2" xref="A2.Ex5.m1.11.11.1.2.cmml">⁢</mo><mrow id="A2.Ex5.m1.11.11.1.1.1" xref="A2.Ex5.m1.11.11.1.1.1.1.cmml"><mo id="A2.Ex5.m1.11.11.1.1.1.2" stretchy="false" xref="A2.Ex5.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="A2.Ex5.m1.11.11.1.1.1.1" xref="A2.Ex5.m1.11.11.1.1.1.1.cmml"><mi id="A2.Ex5.m1.11.11.1.1.1.1.2" xref="A2.Ex5.m1.11.11.1.1.1.1.2.cmml">y</mi><mo id="A2.Ex5.m1.11.11.1.1.1.1.1" xref="A2.Ex5.m1.11.11.1.1.1.1.1.cmml">=</mo><mrow id="A2.Ex5.m1.11.11.1.1.1.1.3" xref="A2.Ex5.m1.11.11.1.1.1.1.3.cmml"><msubsup id="A2.Ex5.m1.11.11.1.1.1.1.3.2" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.cmml"><mi id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.2" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.2.cmml">y</mi><mi id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.3" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.3.cmml">c</mi><mi id="A2.Ex5.m1.11.11.1.1.1.1.3.2.3" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.3.cmml">τ</mi></msubsup><mo fence="false" id="A2.Ex5.m1.11.11.1.1.1.1.3.1" xref="A2.Ex5.m1.11.11.1.1.1.1.3.1.cmml">|</mo><mrow id="A2.Ex5.m1.11.11.1.1.1.1.3.3.2" xref="A2.Ex5.m1.11.11.1.1.1.1.3.3.1.cmml"><mi id="A2.Ex5.m1.7.7" xref="A2.Ex5.m1.7.7.cmml">x</mi><mo id="A2.Ex5.m1.11.11.1.1.1.1.3.3.2.1" xref="A2.Ex5.m1.11.11.1.1.1.1.3.3.1.cmml">;</mo><mi id="A2.Ex5.m1.8.8" xref="A2.Ex5.m1.8.8.cmml">ϕ</mi><mo id="A2.Ex5.m1.11.11.1.1.1.1.3.3.2.2" xref="A2.Ex5.m1.11.11.1.1.1.1.3.3.1.cmml">,</mo><mi id="A2.Ex5.m1.9.9" xref="A2.Ex5.m1.9.9.cmml">θ</mi><mo id="A2.Ex5.m1.11.11.1.1.1.1.3.3.2.3" xref="A2.Ex5.m1.11.11.1.1.1.1.3.3.1.cmml">,</mo><mi id="A2.Ex5.m1.10.10" xref="A2.Ex5.m1.10.10.cmml">τ</mi></mrow></mrow></mrow><mo id="A2.Ex5.m1.11.11.1.1.1.3" stretchy="false" xref="A2.Ex5.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.11.11.2" xref="A2.Ex5.m1.11.11.2.cmml">=</mo><mfrac id="A2.Ex5.m1.6.6" xref="A2.Ex5.m1.6.6.cmml"><msup id="A2.Ex5.m1.3.3.3" xref="A2.Ex5.m1.3.3.3.cmml"><mi id="A2.Ex5.m1.3.3.3.5" xref="A2.Ex5.m1.3.3.3.5.cmml">e</mi><mrow id="A2.Ex5.m1.3.3.3.3.3" xref="A2.Ex5.m1.3.3.3.3.3.cmml"><mrow id="A2.Ex5.m1.3.3.3.3.3.5" xref="A2.Ex5.m1.3.3.3.3.3.5.cmml"><mi id="A2.Ex5.m1.3.3.3.3.3.5.2" xref="A2.Ex5.m1.3.3.3.3.3.5.2.cmml">α</mi><mo id="A2.Ex5.m1.3.3.3.3.3.5.1" lspace="0.222em" rspace="0.222em" xref="A2.Ex5.m1.3.3.3.3.3.5.1.cmml">⋅</mo><mtext id="A2.Ex5.m1.3.3.3.3.3.5.3" xref="A2.Ex5.m1.3.3.3.3.3.5.3a.cmml">Sim</mtext></mrow><mo id="A2.Ex5.m1.3.3.3.3.3.4" xref="A2.Ex5.m1.3.3.3.3.3.4.cmml">⁢</mo><mrow id="A2.Ex5.m1.3.3.3.3.3.3.2" xref="A2.Ex5.m1.3.3.3.3.3.3.3.cmml"><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.3" stretchy="false" xref="A2.Ex5.m1.3.3.3.3.3.3.3.cmml">(</mo><mrow id="A2.Ex5.m1.2.2.2.2.2.2.1.1" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.cmml"><msub id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.2" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.2.cmml">ℐ</mi><mi id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.3" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.3.cmml">θ</mi></msub><mo id="A2.Ex5.m1.2.2.2.2.2.2.1.1.1" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><mrow id="A2.Ex5.m1.2.2.2.2.2.2.1.1.3.2" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.cmml"><mo id="A2.Ex5.m1.2.2.2.2.2.2.1.1.3.2.1" stretchy="false" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.cmml">(</mo><mi id="A2.Ex5.m1.1.1.1.1.1.1" xref="A2.Ex5.m1.1.1.1.1.1.1.cmml">x</mi><mo id="A2.Ex5.m1.2.2.2.2.2.2.1.1.3.2.2" stretchy="false" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.4" xref="A2.Ex5.m1.3.3.3.3.3.3.3.cmml">,</mo><mrow id="A2.Ex5.m1.3.3.3.3.3.3.2.2" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.cmml"><msub id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.2" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.2.cmml">𝒯</mi><mi id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.3" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.3.cmml">ϕ</mi></msub><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.2.2" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.2.cmml">⁢</mo><mrow id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.cmml"><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.2" stretchy="false" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.cmml">(</mo><msubsup id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.cmml"><mi id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.2" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.2.cmml">p</mi><mi id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.3" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.3.cmml">c</mi><mi id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.3" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.3" stretchy="false" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.3.3.3.3.3.3.2.5" stretchy="false" xref="A2.Ex5.m1.3.3.3.3.3.3.3.cmml">)</mo></mrow></mrow></msup><mrow id="A2.Ex5.m1.6.6.6" xref="A2.Ex5.m1.6.6.6.cmml"><msubsup id="A2.Ex5.m1.6.6.6.4" xref="A2.Ex5.m1.6.6.6.4.cmml"><mo id="A2.Ex5.m1.6.6.6.4.2.2" xref="A2.Ex5.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="A2.Ex5.m1.6.6.6.4.2.3" xref="A2.Ex5.m1.6.6.6.4.2.3.cmml"><msup id="A2.Ex5.m1.6.6.6.4.2.3.2" xref="A2.Ex5.m1.6.6.6.4.2.3.2.cmml"><mi id="A2.Ex5.m1.6.6.6.4.2.3.2.2" xref="A2.Ex5.m1.6.6.6.4.2.3.2.2.cmml">c</mi><mo id="A2.Ex5.m1.6.6.6.4.2.3.2.3" xref="A2.Ex5.m1.6.6.6.4.2.3.2.3.cmml">′</mo></msup><mo id="A2.Ex5.m1.6.6.6.4.2.3.1" xref="A2.Ex5.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="A2.Ex5.m1.6.6.6.4.2.3.3" xref="A2.Ex5.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><msup id="A2.Ex5.m1.6.6.6.4.3" xref="A2.Ex5.m1.6.6.6.4.3.cmml"><mi id="A2.Ex5.m1.6.6.6.4.3.2" xref="A2.Ex5.m1.6.6.6.4.3.2.cmml">C</mi><mi id="A2.Ex5.m1.6.6.6.4.3.3" xref="A2.Ex5.m1.6.6.6.4.3.3.cmml">τ</mi></msup></msubsup><msup id="A2.Ex5.m1.6.6.6.5" xref="A2.Ex5.m1.6.6.6.5.cmml"><mi id="A2.Ex5.m1.6.6.6.5.2" xref="A2.Ex5.m1.6.6.6.5.2.cmml">e</mi><mrow id="A2.Ex5.m1.6.6.6.3.3" xref="A2.Ex5.m1.6.6.6.3.3.cmml"><mrow id="A2.Ex5.m1.6.6.6.3.3.5" xref="A2.Ex5.m1.6.6.6.3.3.5.cmml"><mi id="A2.Ex5.m1.6.6.6.3.3.5.2" xref="A2.Ex5.m1.6.6.6.3.3.5.2.cmml">α</mi><mo id="A2.Ex5.m1.6.6.6.3.3.5.1" lspace="0.222em" rspace="0.222em" xref="A2.Ex5.m1.6.6.6.3.3.5.1.cmml">⋅</mo><mtext id="A2.Ex5.m1.6.6.6.3.3.5.3" xref="A2.Ex5.m1.6.6.6.3.3.5.3a.cmml">Sim</mtext></mrow><mo id="A2.Ex5.m1.6.6.6.3.3.4" xref="A2.Ex5.m1.6.6.6.3.3.4.cmml">⁢</mo><mrow id="A2.Ex5.m1.6.6.6.3.3.3.2" xref="A2.Ex5.m1.6.6.6.3.3.3.3.cmml"><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.3" stretchy="false" xref="A2.Ex5.m1.6.6.6.3.3.3.3.cmml">(</mo><mrow id="A2.Ex5.m1.5.5.5.2.2.2.1.1" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.cmml"><msub id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.2" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.2.cmml">ℐ</mi><mi id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.3" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.3.cmml">θ</mi></msub><mo id="A2.Ex5.m1.5.5.5.2.2.2.1.1.1" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.1.cmml">⁢</mo><mrow id="A2.Ex5.m1.5.5.5.2.2.2.1.1.3.2" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.cmml"><mo id="A2.Ex5.m1.5.5.5.2.2.2.1.1.3.2.1" stretchy="false" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.cmml">(</mo><mi id="A2.Ex5.m1.4.4.4.1.1.1" xref="A2.Ex5.m1.4.4.4.1.1.1.cmml">x</mi><mo id="A2.Ex5.m1.5.5.5.2.2.2.1.1.3.2.2" stretchy="false" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.4" xref="A2.Ex5.m1.6.6.6.3.3.3.3.cmml">,</mo><mrow id="A2.Ex5.m1.6.6.6.3.3.3.2.2" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.cmml"><msub id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.2" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.2.cmml">𝒯</mi><mi id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.3" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.3.cmml">ϕ</mi></msub><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.2.2" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.2.cmml">⁢</mo><mrow id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.cmml"><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.2" stretchy="false" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.cmml">(</mo><msubsup id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.cmml"><mi id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.2" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.2.cmml">p</mi><msup id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.cmml"><mi id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.2" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.2.cmml">c</mi><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.3" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.3.cmml">′</mo></msup><mi id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.3" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.3.cmml">τ</mi></msubsup><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.3" stretchy="false" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m1.6.6.6.3.3.3.2.5" stretchy="false" xref="A2.Ex5.m1.6.6.6.3.3.3.3.cmml">)</mo></mrow></mrow></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex5.m1.11b"><apply id="A2.Ex5.m1.11.11.cmml" xref="A2.Ex5.m1.11.11"><eq id="A2.Ex5.m1.11.11.2.cmml" xref="A2.Ex5.m1.11.11.2"></eq><apply id="A2.Ex5.m1.11.11.1.cmml" xref="A2.Ex5.m1.11.11.1"><times id="A2.Ex5.m1.11.11.1.2.cmml" xref="A2.Ex5.m1.11.11.1.2"></times><ci id="A2.Ex5.m1.11.11.1.3.cmml" xref="A2.Ex5.m1.11.11.1.3">𝑝</ci><apply id="A2.Ex5.m1.11.11.1.1.1.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1"><eq id="A2.Ex5.m1.11.11.1.1.1.1.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.1"></eq><ci id="A2.Ex5.m1.11.11.1.1.1.1.2.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.2">𝑦</ci><apply id="A2.Ex5.m1.11.11.1.1.1.1.3.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3"><csymbol cd="latexml" id="A2.Ex5.m1.11.11.1.1.1.1.3.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.1">conditional</csymbol><apply id="A2.Ex5.m1.11.11.1.1.1.1.3.2.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.11.11.1.1.1.1.3.2.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2">superscript</csymbol><apply id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2">subscript</csymbol><ci id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.2.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.2">𝑦</ci><ci id="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.3.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.2.3">𝑐</ci></apply><ci id="A2.Ex5.m1.11.11.1.1.1.1.3.2.3.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.2.3">𝜏</ci></apply><list id="A2.Ex5.m1.11.11.1.1.1.1.3.3.1.cmml" xref="A2.Ex5.m1.11.11.1.1.1.1.3.3.2"><ci id="A2.Ex5.m1.7.7.cmml" xref="A2.Ex5.m1.7.7">𝑥</ci><ci id="A2.Ex5.m1.8.8.cmml" xref="A2.Ex5.m1.8.8">italic-ϕ</ci><ci id="A2.Ex5.m1.9.9.cmml" xref="A2.Ex5.m1.9.9">𝜃</ci><ci id="A2.Ex5.m1.10.10.cmml" xref="A2.Ex5.m1.10.10">𝜏</ci></list></apply></apply></apply><apply id="A2.Ex5.m1.6.6.cmml" xref="A2.Ex5.m1.6.6"><divide id="A2.Ex5.m1.6.6.7.cmml" xref="A2.Ex5.m1.6.6"></divide><apply id="A2.Ex5.m1.3.3.3.cmml" xref="A2.Ex5.m1.3.3.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.3.3.3.4.cmml" xref="A2.Ex5.m1.3.3.3">superscript</csymbol><ci id="A2.Ex5.m1.3.3.3.5.cmml" xref="A2.Ex5.m1.3.3.3.5">𝑒</ci><apply id="A2.Ex5.m1.3.3.3.3.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3"><times id="A2.Ex5.m1.3.3.3.3.3.4.cmml" xref="A2.Ex5.m1.3.3.3.3.3.4"></times><apply id="A2.Ex5.m1.3.3.3.3.3.5.cmml" xref="A2.Ex5.m1.3.3.3.3.3.5"><ci id="A2.Ex5.m1.3.3.3.3.3.5.1.cmml" xref="A2.Ex5.m1.3.3.3.3.3.5.1">⋅</ci><ci id="A2.Ex5.m1.3.3.3.3.3.5.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.5.2">𝛼</ci><ci id="A2.Ex5.m1.3.3.3.3.3.5.3a.cmml" xref="A2.Ex5.m1.3.3.3.3.3.5.3"><mtext id="A2.Ex5.m1.3.3.3.3.3.5.3.cmml" mathsize="70%" xref="A2.Ex5.m1.3.3.3.3.3.5.3">Sim</mtext></ci></apply><interval closure="open" id="A2.Ex5.m1.3.3.3.3.3.3.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2"><apply id="A2.Ex5.m1.2.2.2.2.2.2.1.1.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1"><times id="A2.Ex5.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.1"></times><apply id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.2">ℐ</ci><ci id="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="A2.Ex5.m1.2.2.2.2.2.2.1.1.2.3">𝜃</ci></apply><ci id="A2.Ex5.m1.1.1.1.1.1.1.cmml" xref="A2.Ex5.m1.1.1.1.1.1.1">𝑥</ci></apply><apply id="A2.Ex5.m1.3.3.3.3.3.3.2.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2"><times id="A2.Ex5.m1.3.3.3.3.3.3.2.2.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.2"></times><apply id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.1.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3">subscript</csymbol><ci id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.2">𝒯</ci><ci id="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.3.3">italic-ϕ</ci></apply><apply id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.1.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1">superscript</csymbol><apply id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.1.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1">subscript</csymbol><ci id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.2.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.2">𝑝</ci><ci id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.2.3">𝑐</ci></apply><ci id="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.3.cmml" xref="A2.Ex5.m1.3.3.3.3.3.3.2.2.1.1.1.3">𝜏</ci></apply></apply></interval></apply></apply><apply id="A2.Ex5.m1.6.6.6.cmml" xref="A2.Ex5.m1.6.6.6"><apply id="A2.Ex5.m1.6.6.6.4.cmml" xref="A2.Ex5.m1.6.6.6.4"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.4.1.cmml" xref="A2.Ex5.m1.6.6.6.4">superscript</csymbol><apply id="A2.Ex5.m1.6.6.6.4.2.cmml" xref="A2.Ex5.m1.6.6.6.4"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.4.2.1.cmml" xref="A2.Ex5.m1.6.6.6.4">subscript</csymbol><sum id="A2.Ex5.m1.6.6.6.4.2.2.cmml" xref="A2.Ex5.m1.6.6.6.4.2.2"></sum><apply id="A2.Ex5.m1.6.6.6.4.2.3.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3"><eq id="A2.Ex5.m1.6.6.6.4.2.3.1.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3.1"></eq><apply id="A2.Ex5.m1.6.6.6.4.2.3.2.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.4.2.3.2.1.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3.2">superscript</csymbol><ci id="A2.Ex5.m1.6.6.6.4.2.3.2.2.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3.2.2">𝑐</ci><ci id="A2.Ex5.m1.6.6.6.4.2.3.2.3.cmml" xref="A2.Ex5.m1.6.6.6.4.2.3.2.3">′</ci></apply><cn id="A2.Ex5.m1.6.6.6.4.2.3.3.cmml" type="integer" xref="A2.Ex5.m1.6.6.6.4.2.3.3">1</cn></apply></apply><apply id="A2.Ex5.m1.6.6.6.4.3.cmml" xref="A2.Ex5.m1.6.6.6.4.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.4.3.1.cmml" xref="A2.Ex5.m1.6.6.6.4.3">superscript</csymbol><ci id="A2.Ex5.m1.6.6.6.4.3.2.cmml" xref="A2.Ex5.m1.6.6.6.4.3.2">𝐶</ci><ci id="A2.Ex5.m1.6.6.6.4.3.3.cmml" xref="A2.Ex5.m1.6.6.6.4.3.3">𝜏</ci></apply></apply><apply id="A2.Ex5.m1.6.6.6.5.cmml" xref="A2.Ex5.m1.6.6.6.5"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.5.1.cmml" xref="A2.Ex5.m1.6.6.6.5">superscript</csymbol><ci id="A2.Ex5.m1.6.6.6.5.2.cmml" xref="A2.Ex5.m1.6.6.6.5.2">𝑒</ci><apply id="A2.Ex5.m1.6.6.6.3.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3"><times id="A2.Ex5.m1.6.6.6.3.3.4.cmml" xref="A2.Ex5.m1.6.6.6.3.3.4"></times><apply id="A2.Ex5.m1.6.6.6.3.3.5.cmml" xref="A2.Ex5.m1.6.6.6.3.3.5"><ci id="A2.Ex5.m1.6.6.6.3.3.5.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.5.1">⋅</ci><ci id="A2.Ex5.m1.6.6.6.3.3.5.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.5.2">𝛼</ci><ci id="A2.Ex5.m1.6.6.6.3.3.5.3a.cmml" xref="A2.Ex5.m1.6.6.6.3.3.5.3"><mtext id="A2.Ex5.m1.6.6.6.3.3.5.3.cmml" mathsize="70%" xref="A2.Ex5.m1.6.6.6.3.3.5.3">Sim</mtext></ci></apply><interval closure="open" id="A2.Ex5.m1.6.6.6.3.3.3.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2"><apply id="A2.Ex5.m1.5.5.5.2.2.2.1.1.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1"><times id="A2.Ex5.m1.5.5.5.2.2.2.1.1.1.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.1"></times><apply id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.1.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2">subscript</csymbol><ci id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.2.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.2">ℐ</ci><ci id="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.3.cmml" xref="A2.Ex5.m1.5.5.5.2.2.2.1.1.2.3">𝜃</ci></apply><ci id="A2.Ex5.m1.4.4.4.1.1.1.cmml" xref="A2.Ex5.m1.4.4.4.1.1.1">𝑥</ci></apply><apply id="A2.Ex5.m1.6.6.6.3.3.3.2.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2"><times id="A2.Ex5.m1.6.6.6.3.3.3.2.2.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.2"></times><apply id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3">subscript</csymbol><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.2">𝒯</ci><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.3.3">italic-ϕ</ci></apply><apply id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1">superscript</csymbol><apply id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1">subscript</csymbol><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.2">𝑝</ci><apply id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.1.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3">superscript</csymbol><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.2.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.2">𝑐</ci><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.2.3.3">′</ci></apply></apply><ci id="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.3.cmml" xref="A2.Ex5.m1.6.6.6.3.3.3.2.2.1.1.1.3">𝜏</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m1.11c">p(y=y_{c}^{\tau}|x;\phi,\theta,\tau)=\frac{e^{\alpha\cdot\text{Sim}(\mathcal{I%
}_{\theta}(x),\mathcal{T}_{\phi}(p_{c}^{\tau}))}}{\sum_{c^{\prime}=1}^{C^{\tau%
}}e^{\alpha\cdot\text{Sim}(\mathcal{I}_{\theta}(x),\mathcal{T}_{\phi}(p_{c^{%
\prime}}^{\tau}))}}</annotation><annotation encoding="application/x-llamapun" id="A2.Ex5.m1.11d">italic_p ( italic_y = italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT | italic_x ; italic_ϕ , italic_θ , italic_τ ) = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_α ⋅ Sim ( caligraphic_I start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) , caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) ) end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_α ⋅ Sim ( caligraphic_I start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) , caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT ) ) end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p1.15">where <math alttext="\alpha" class="ltx_Math" display="inline" id="A2.SS1.p1.14.m1.1"><semantics id="A2.SS1.p1.14.m1.1a"><mi id="A2.SS1.p1.14.m1.1.1" xref="A2.SS1.p1.14.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.14.m1.1b"><ci id="A2.SS1.p1.14.m1.1.1.cmml" xref="A2.SS1.p1.14.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.14.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.14.m1.1d">italic_α</annotation></semantics></math> is a learnable scaling parameter, often described as the inverse of temperature. This procedure allows the set of class embeddings <math alttext="t^{\tau}" class="ltx_Math" display="inline" id="A2.SS1.p1.15.m2.1"><semantics id="A2.SS1.p1.15.m2.1a"><msup id="A2.SS1.p1.15.m2.1.1" xref="A2.SS1.p1.15.m2.1.1.cmml"><mi id="A2.SS1.p1.15.m2.1.1.2" xref="A2.SS1.p1.15.m2.1.1.2.cmml">t</mi><mi id="A2.SS1.p1.15.m2.1.1.3" xref="A2.SS1.p1.15.m2.1.1.3.cmml">τ</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.15.m2.1b"><apply id="A2.SS1.p1.15.m2.1.1.cmml" xref="A2.SS1.p1.15.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.15.m2.1.1.1.cmml" xref="A2.SS1.p1.15.m2.1.1">superscript</csymbol><ci id="A2.SS1.p1.15.m2.1.1.2.cmml" xref="A2.SS1.p1.15.m2.1.1.2">𝑡</ci><ci id="A2.SS1.p1.15.m2.1.1.3.cmml" xref="A2.SS1.p1.15.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.15.m2.1c">t^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.15.m2.1d">italic_t start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> to act as a linear classifier.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Federated Learning Setting</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.11">In the conventional FL setting,
<math alttext="N" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mi id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><ci id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">italic_N</annotation></semantics></math> distinct clients collaborate to train a shared model. Each client, denoted as <math alttext="i\in{1,2,\cdots,N}" class="ltx_Math" display="inline" id="A2.SS2.p1.2.m2.4"><semantics id="A2.SS2.p1.2.m2.4a"><mrow id="A2.SS2.p1.2.m2.4.5" xref="A2.SS2.p1.2.m2.4.5.cmml"><mi id="A2.SS2.p1.2.m2.4.5.2" xref="A2.SS2.p1.2.m2.4.5.2.cmml">i</mi><mo id="A2.SS2.p1.2.m2.4.5.1" xref="A2.SS2.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="A2.SS2.p1.2.m2.4.5.3.2" xref="A2.SS2.p1.2.m2.4.5.3.1.cmml"><mn id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="A2.SS2.p1.2.m2.4.5.3.2.1" xref="A2.SS2.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="A2.SS2.p1.2.m2.2.2" xref="A2.SS2.p1.2.m2.2.2.cmml">2</mn><mo id="A2.SS2.p1.2.m2.4.5.3.2.2" xref="A2.SS2.p1.2.m2.4.5.3.1.cmml">,</mo><mi id="A2.SS2.p1.2.m2.3.3" mathvariant="normal" xref="A2.SS2.p1.2.m2.3.3.cmml">⋯</mi><mo id="A2.SS2.p1.2.m2.4.5.3.2.3" xref="A2.SS2.p1.2.m2.4.5.3.1.cmml">,</mo><mi id="A2.SS2.p1.2.m2.4.4" xref="A2.SS2.p1.2.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.4b"><apply id="A2.SS2.p1.2.m2.4.5.cmml" xref="A2.SS2.p1.2.m2.4.5"><in id="A2.SS2.p1.2.m2.4.5.1.cmml" xref="A2.SS2.p1.2.m2.4.5.1"></in><ci id="A2.SS2.p1.2.m2.4.5.2.cmml" xref="A2.SS2.p1.2.m2.4.5.2">𝑖</ci><list id="A2.SS2.p1.2.m2.4.5.3.1.cmml" xref="A2.SS2.p1.2.m2.4.5.3.2"><cn id="A2.SS2.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1">1</cn><cn id="A2.SS2.p1.2.m2.2.2.cmml" type="integer" xref="A2.SS2.p1.2.m2.2.2">2</cn><ci id="A2.SS2.p1.2.m2.3.3.cmml" xref="A2.SS2.p1.2.m2.3.3">⋯</ci><ci id="A2.SS2.p1.2.m2.4.4.cmml" xref="A2.SS2.p1.2.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.4c">i\in{1,2,\cdots,N}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.2.m2.4d">italic_i ∈ 1 , 2 , ⋯ , italic_N</annotation></semantics></math>, is characterized by its unique data distribution <math alttext="p^{(i)}(x,y)" class="ltx_Math" display="inline" id="A2.SS2.p1.3.m3.3"><semantics id="A2.SS2.p1.3.m3.3a"><mrow id="A2.SS2.p1.3.m3.3.4" xref="A2.SS2.p1.3.m3.3.4.cmml"><msup id="A2.SS2.p1.3.m3.3.4.2" xref="A2.SS2.p1.3.m3.3.4.2.cmml"><mi id="A2.SS2.p1.3.m3.3.4.2.2" xref="A2.SS2.p1.3.m3.3.4.2.2.cmml">p</mi><mrow id="A2.SS2.p1.3.m3.1.1.1.3" xref="A2.SS2.p1.3.m3.3.4.2.cmml"><mo id="A2.SS2.p1.3.m3.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.3.m3.3.4.2.cmml">(</mo><mi id="A2.SS2.p1.3.m3.1.1.1.1" xref="A2.SS2.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.3.m3.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.3.m3.3.4.2.cmml">)</mo></mrow></msup><mo id="A2.SS2.p1.3.m3.3.4.1" xref="A2.SS2.p1.3.m3.3.4.1.cmml">⁢</mo><mrow id="A2.SS2.p1.3.m3.3.4.3.2" xref="A2.SS2.p1.3.m3.3.4.3.1.cmml"><mo id="A2.SS2.p1.3.m3.3.4.3.2.1" stretchy="false" xref="A2.SS2.p1.3.m3.3.4.3.1.cmml">(</mo><mi id="A2.SS2.p1.3.m3.2.2" xref="A2.SS2.p1.3.m3.2.2.cmml">x</mi><mo id="A2.SS2.p1.3.m3.3.4.3.2.2" xref="A2.SS2.p1.3.m3.3.4.3.1.cmml">,</mo><mi id="A2.SS2.p1.3.m3.3.3" xref="A2.SS2.p1.3.m3.3.3.cmml">y</mi><mo id="A2.SS2.p1.3.m3.3.4.3.2.3" stretchy="false" xref="A2.SS2.p1.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.3b"><apply id="A2.SS2.p1.3.m3.3.4.cmml" xref="A2.SS2.p1.3.m3.3.4"><times id="A2.SS2.p1.3.m3.3.4.1.cmml" xref="A2.SS2.p1.3.m3.3.4.1"></times><apply id="A2.SS2.p1.3.m3.3.4.2.cmml" xref="A2.SS2.p1.3.m3.3.4.2"><csymbol cd="ambiguous" id="A2.SS2.p1.3.m3.3.4.2.1.cmml" xref="A2.SS2.p1.3.m3.3.4.2">superscript</csymbol><ci id="A2.SS2.p1.3.m3.3.4.2.2.cmml" xref="A2.SS2.p1.3.m3.3.4.2.2">𝑝</ci><ci id="A2.SS2.p1.3.m3.1.1.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1.1.1">𝑖</ci></apply><interval closure="open" id="A2.SS2.p1.3.m3.3.4.3.1.cmml" xref="A2.SS2.p1.3.m3.3.4.3.2"><ci id="A2.SS2.p1.3.m3.2.2.cmml" xref="A2.SS2.p1.3.m3.2.2">𝑥</ci><ci id="A2.SS2.p1.3.m3.3.3.cmml" xref="A2.SS2.p1.3.m3.3.3">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.3c">p^{(i)}(x,y)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.3.m3.3d">italic_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math>.
Each client <math alttext="i" class="ltx_Math" display="inline" id="A2.SS2.p1.4.m4.1"><semantics id="A2.SS2.p1.4.m4.1a"><mi id="A2.SS2.p1.4.m4.1.1" xref="A2.SS2.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.4.m4.1b"><ci id="A2.SS2.p1.4.m4.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.4.m4.1d">italic_i</annotation></semantics></math> holds its own dataset <math alttext="D^{(i)}" class="ltx_Math" display="inline" id="A2.SS2.p1.5.m5.1"><semantics id="A2.SS2.p1.5.m5.1a"><msup id="A2.SS2.p1.5.m5.1.2" xref="A2.SS2.p1.5.m5.1.2.cmml"><mi id="A2.SS2.p1.5.m5.1.2.2" xref="A2.SS2.p1.5.m5.1.2.2.cmml">D</mi><mrow id="A2.SS2.p1.5.m5.1.1.1.3" xref="A2.SS2.p1.5.m5.1.2.cmml"><mo id="A2.SS2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.5.m5.1.2.cmml">(</mo><mi id="A2.SS2.p1.5.m5.1.1.1.1" xref="A2.SS2.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.5.m5.1b"><apply id="A2.SS2.p1.5.m5.1.2.cmml" xref="A2.SS2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A2.SS2.p1.5.m5.1.2.1.cmml" xref="A2.SS2.p1.5.m5.1.2">superscript</csymbol><ci id="A2.SS2.p1.5.m5.1.2.2.cmml" xref="A2.SS2.p1.5.m5.1.2.2">𝐷</ci><ci id="A2.SS2.p1.5.m5.1.1.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.5.m5.1c">D^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.5.m5.1d">italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, comprising <math alttext="M^{(i)}" class="ltx_Math" display="inline" id="A2.SS2.p1.6.m6.1"><semantics id="A2.SS2.p1.6.m6.1a"><msup id="A2.SS2.p1.6.m6.1.2" xref="A2.SS2.p1.6.m6.1.2.cmml"><mi id="A2.SS2.p1.6.m6.1.2.2" xref="A2.SS2.p1.6.m6.1.2.2.cmml">M</mi><mrow id="A2.SS2.p1.6.m6.1.1.1.3" xref="A2.SS2.p1.6.m6.1.2.cmml"><mo id="A2.SS2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.6.m6.1.2.cmml">(</mo><mi id="A2.SS2.p1.6.m6.1.1.1.1" xref="A2.SS2.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.6.m6.1b"><apply id="A2.SS2.p1.6.m6.1.2.cmml" xref="A2.SS2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="A2.SS2.p1.6.m6.1.2.1.cmml" xref="A2.SS2.p1.6.m6.1.2">superscript</csymbol><ci id="A2.SS2.p1.6.m6.1.2.2.cmml" xref="A2.SS2.p1.6.m6.1.2.2">𝑀</ci><ci id="A2.SS2.p1.6.m6.1.1.1.1.cmml" xref="A2.SS2.p1.6.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.6.m6.1c">M^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.6.m6.1d">italic_M start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> data points: <math alttext="\{(x^{(i)}_{k},y_{k}^{(i)})\}_{k=1}^{M^{(i)}}" class="ltx_Math" display="inline" id="A2.SS2.p1.7.m7.4"><semantics id="A2.SS2.p1.7.m7.4a"><msubsup id="A2.SS2.p1.7.m7.4.4" xref="A2.SS2.p1.7.m7.4.4.cmml"><mrow id="A2.SS2.p1.7.m7.4.4.1.1.1" xref="A2.SS2.p1.7.m7.4.4.1.1.2.cmml"><mo id="A2.SS2.p1.7.m7.4.4.1.1.1.2" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.2.cmml">{</mo><mrow id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.3.cmml"><mo id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.3" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.3.cmml">(</mo><msubsup id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.cmml"><mi id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.2" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.3" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.3.cmml">k</mi><mrow id="A2.SS2.p1.7.m7.1.1.1.3" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.cmml"><mo id="A2.SS2.p1.7.m7.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="A2.SS2.p1.7.m7.1.1.1.1" xref="A2.SS2.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.7.m7.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.4" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.3.cmml">,</mo><msubsup id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.cmml"><mi id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.2" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.3" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.3.cmml">k</mi><mrow id="A2.SS2.p1.7.m7.2.2.1.3" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.cmml"><mo id="A2.SS2.p1.7.m7.2.2.1.3.1" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.cmml">(</mo><mi id="A2.SS2.p1.7.m7.2.2.1.1" xref="A2.SS2.p1.7.m7.2.2.1.1.cmml">i</mi><mo id="A2.SS2.p1.7.m7.2.2.1.3.2" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.5" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.3.cmml">)</mo></mrow><mo id="A2.SS2.p1.7.m7.4.4.1.1.1.3" stretchy="false" xref="A2.SS2.p1.7.m7.4.4.1.1.2.cmml">}</mo></mrow><mrow id="A2.SS2.p1.7.m7.4.4.1.3" xref="A2.SS2.p1.7.m7.4.4.1.3.cmml"><mi id="A2.SS2.p1.7.m7.4.4.1.3.2" xref="A2.SS2.p1.7.m7.4.4.1.3.2.cmml">k</mi><mo id="A2.SS2.p1.7.m7.4.4.1.3.1" xref="A2.SS2.p1.7.m7.4.4.1.3.1.cmml">=</mo><mn id="A2.SS2.p1.7.m7.4.4.1.3.3" xref="A2.SS2.p1.7.m7.4.4.1.3.3.cmml">1</mn></mrow><msup id="A2.SS2.p1.7.m7.3.3.1" xref="A2.SS2.p1.7.m7.3.3.1.cmml"><mi id="A2.SS2.p1.7.m7.3.3.1.3" xref="A2.SS2.p1.7.m7.3.3.1.3.cmml">M</mi><mrow id="A2.SS2.p1.7.m7.3.3.1.1.1.3" xref="A2.SS2.p1.7.m7.3.3.1.cmml"><mo id="A2.SS2.p1.7.m7.3.3.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.7.m7.3.3.1.cmml">(</mo><mi id="A2.SS2.p1.7.m7.3.3.1.1.1.1" xref="A2.SS2.p1.7.m7.3.3.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.7.m7.3.3.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.7.m7.3.3.1.cmml">)</mo></mrow></msup></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.7.m7.4b"><apply id="A2.SS2.p1.7.m7.4.4.cmml" xref="A2.SS2.p1.7.m7.4.4"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.2.cmml" xref="A2.SS2.p1.7.m7.4.4">superscript</csymbol><apply id="A2.SS2.p1.7.m7.4.4.1.cmml" xref="A2.SS2.p1.7.m7.4.4"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.1.2.cmml" xref="A2.SS2.p1.7.m7.4.4">subscript</csymbol><set id="A2.SS2.p1.7.m7.4.4.1.1.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1"><interval closure="open" id="A2.SS2.p1.7.m7.4.4.1.1.1.1.3.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2"><apply id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A2.SS2.p1.7.m7.1.1.1.1.cmml" xref="A2.SS2.p1.7.m7.1.1.1.1">𝑖</ci></apply><ci id="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.3.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2">superscript</csymbol><apply id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.2">𝑦</ci><ci id="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.3.cmml" xref="A2.SS2.p1.7.m7.4.4.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="A2.SS2.p1.7.m7.2.2.1.1.cmml" xref="A2.SS2.p1.7.m7.2.2.1.1">𝑖</ci></apply></interval></set><apply id="A2.SS2.p1.7.m7.4.4.1.3.cmml" xref="A2.SS2.p1.7.m7.4.4.1.3"><eq id="A2.SS2.p1.7.m7.4.4.1.3.1.cmml" xref="A2.SS2.p1.7.m7.4.4.1.3.1"></eq><ci id="A2.SS2.p1.7.m7.4.4.1.3.2.cmml" xref="A2.SS2.p1.7.m7.4.4.1.3.2">𝑘</ci><cn id="A2.SS2.p1.7.m7.4.4.1.3.3.cmml" type="integer" xref="A2.SS2.p1.7.m7.4.4.1.3.3">1</cn></apply></apply><apply id="A2.SS2.p1.7.m7.3.3.1.cmml" xref="A2.SS2.p1.7.m7.3.3.1"><csymbol cd="ambiguous" id="A2.SS2.p1.7.m7.3.3.1.2.cmml" xref="A2.SS2.p1.7.m7.3.3.1">superscript</csymbol><ci id="A2.SS2.p1.7.m7.3.3.1.3.cmml" xref="A2.SS2.p1.7.m7.3.3.1.3">𝑀</ci><ci id="A2.SS2.p1.7.m7.3.3.1.1.1.1.cmml" xref="A2.SS2.p1.7.m7.3.3.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.7.m7.4c">\{(x^{(i)}_{k},y_{k}^{(i)})\}_{k=1}^{M^{(i)}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.7.m7.4d">{ ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
It is important to note that the data distribution <math alttext="p^{(i)}(x,y)" class="ltx_Math" display="inline" id="A2.SS2.p1.8.m8.3"><semantics id="A2.SS2.p1.8.m8.3a"><mrow id="A2.SS2.p1.8.m8.3.4" xref="A2.SS2.p1.8.m8.3.4.cmml"><msup id="A2.SS2.p1.8.m8.3.4.2" xref="A2.SS2.p1.8.m8.3.4.2.cmml"><mi id="A2.SS2.p1.8.m8.3.4.2.2" xref="A2.SS2.p1.8.m8.3.4.2.2.cmml">p</mi><mrow id="A2.SS2.p1.8.m8.1.1.1.3" xref="A2.SS2.p1.8.m8.3.4.2.cmml"><mo id="A2.SS2.p1.8.m8.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.8.m8.3.4.2.cmml">(</mo><mi id="A2.SS2.p1.8.m8.1.1.1.1" xref="A2.SS2.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.8.m8.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.8.m8.3.4.2.cmml">)</mo></mrow></msup><mo id="A2.SS2.p1.8.m8.3.4.1" xref="A2.SS2.p1.8.m8.3.4.1.cmml">⁢</mo><mrow id="A2.SS2.p1.8.m8.3.4.3.2" xref="A2.SS2.p1.8.m8.3.4.3.1.cmml"><mo id="A2.SS2.p1.8.m8.3.4.3.2.1" stretchy="false" xref="A2.SS2.p1.8.m8.3.4.3.1.cmml">(</mo><mi id="A2.SS2.p1.8.m8.2.2" xref="A2.SS2.p1.8.m8.2.2.cmml">x</mi><mo id="A2.SS2.p1.8.m8.3.4.3.2.2" xref="A2.SS2.p1.8.m8.3.4.3.1.cmml">,</mo><mi id="A2.SS2.p1.8.m8.3.3" xref="A2.SS2.p1.8.m8.3.3.cmml">y</mi><mo id="A2.SS2.p1.8.m8.3.4.3.2.3" stretchy="false" xref="A2.SS2.p1.8.m8.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.8.m8.3b"><apply id="A2.SS2.p1.8.m8.3.4.cmml" xref="A2.SS2.p1.8.m8.3.4"><times id="A2.SS2.p1.8.m8.3.4.1.cmml" xref="A2.SS2.p1.8.m8.3.4.1"></times><apply id="A2.SS2.p1.8.m8.3.4.2.cmml" xref="A2.SS2.p1.8.m8.3.4.2"><csymbol cd="ambiguous" id="A2.SS2.p1.8.m8.3.4.2.1.cmml" xref="A2.SS2.p1.8.m8.3.4.2">superscript</csymbol><ci id="A2.SS2.p1.8.m8.3.4.2.2.cmml" xref="A2.SS2.p1.8.m8.3.4.2.2">𝑝</ci><ci id="A2.SS2.p1.8.m8.1.1.1.1.cmml" xref="A2.SS2.p1.8.m8.1.1.1.1">𝑖</ci></apply><interval closure="open" id="A2.SS2.p1.8.m8.3.4.3.1.cmml" xref="A2.SS2.p1.8.m8.3.4.3.2"><ci id="A2.SS2.p1.8.m8.2.2.cmml" xref="A2.SS2.p1.8.m8.2.2">𝑥</ci><ci id="A2.SS2.p1.8.m8.3.3.cmml" xref="A2.SS2.p1.8.m8.3.3">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.8.m8.3c">p^{(i)}(x,y)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.8.m8.3d">italic_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math> varies significantly across the clients, which are also interchangeably referred to as domains.
The primary goal within FL is the collaborative training of a shared model, parameterized by <math alttext="w" class="ltx_Math" display="inline" id="A2.SS2.p1.9.m9.1"><semantics id="A2.SS2.p1.9.m9.1a"><mi id="A2.SS2.p1.9.m9.1.1" xref="A2.SS2.p1.9.m9.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.9.m9.1b"><ci id="A2.SS2.p1.9.m9.1.1.cmml" xref="A2.SS2.p1.9.m9.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.9.m9.1c">w</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.9.m9.1d">italic_w</annotation></semantics></math>, where the loss function for a specific data point <math alttext="(x,y)" class="ltx_Math" display="inline" id="A2.SS2.p1.10.m10.2"><semantics id="A2.SS2.p1.10.m10.2a"><mrow id="A2.SS2.p1.10.m10.2.3.2" xref="A2.SS2.p1.10.m10.2.3.1.cmml"><mo id="A2.SS2.p1.10.m10.2.3.2.1" stretchy="false" xref="A2.SS2.p1.10.m10.2.3.1.cmml">(</mo><mi id="A2.SS2.p1.10.m10.1.1" xref="A2.SS2.p1.10.m10.1.1.cmml">x</mi><mo id="A2.SS2.p1.10.m10.2.3.2.2" xref="A2.SS2.p1.10.m10.2.3.1.cmml">,</mo><mi id="A2.SS2.p1.10.m10.2.2" xref="A2.SS2.p1.10.m10.2.2.cmml">y</mi><mo id="A2.SS2.p1.10.m10.2.3.2.3" stretchy="false" xref="A2.SS2.p1.10.m10.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.10.m10.2b"><interval closure="open" id="A2.SS2.p1.10.m10.2.3.1.cmml" xref="A2.SS2.p1.10.m10.2.3.2"><ci id="A2.SS2.p1.10.m10.1.1.cmml" xref="A2.SS2.p1.10.m10.1.1">𝑥</ci><ci id="A2.SS2.p1.10.m10.2.2.cmml" xref="A2.SS2.p1.10.m10.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.10.m10.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.10.m10.2d">( italic_x , italic_y )</annotation></semantics></math> is defined as <math alttext="\ell(w;x,y)" class="ltx_Math" display="inline" id="A2.SS2.p1.11.m11.3"><semantics id="A2.SS2.p1.11.m11.3a"><mrow id="A2.SS2.p1.11.m11.3.4" xref="A2.SS2.p1.11.m11.3.4.cmml"><mi id="A2.SS2.p1.11.m11.3.4.2" mathvariant="normal" xref="A2.SS2.p1.11.m11.3.4.2.cmml">ℓ</mi><mo id="A2.SS2.p1.11.m11.3.4.1" xref="A2.SS2.p1.11.m11.3.4.1.cmml">⁢</mo><mrow id="A2.SS2.p1.11.m11.3.4.3.2" xref="A2.SS2.p1.11.m11.3.4.3.1.cmml"><mo id="A2.SS2.p1.11.m11.3.4.3.2.1" stretchy="false" xref="A2.SS2.p1.11.m11.3.4.3.1.cmml">(</mo><mi id="A2.SS2.p1.11.m11.1.1" xref="A2.SS2.p1.11.m11.1.1.cmml">w</mi><mo id="A2.SS2.p1.11.m11.3.4.3.2.2" xref="A2.SS2.p1.11.m11.3.4.3.1.cmml">;</mo><mi id="A2.SS2.p1.11.m11.2.2" xref="A2.SS2.p1.11.m11.2.2.cmml">x</mi><mo id="A2.SS2.p1.11.m11.3.4.3.2.3" xref="A2.SS2.p1.11.m11.3.4.3.1.cmml">,</mo><mi id="A2.SS2.p1.11.m11.3.3" xref="A2.SS2.p1.11.m11.3.3.cmml">y</mi><mo id="A2.SS2.p1.11.m11.3.4.3.2.4" stretchy="false" xref="A2.SS2.p1.11.m11.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.11.m11.3b"><apply id="A2.SS2.p1.11.m11.3.4.cmml" xref="A2.SS2.p1.11.m11.3.4"><times id="A2.SS2.p1.11.m11.3.4.1.cmml" xref="A2.SS2.p1.11.m11.3.4.1"></times><ci id="A2.SS2.p1.11.m11.3.4.2.cmml" xref="A2.SS2.p1.11.m11.3.4.2">ℓ</ci><list id="A2.SS2.p1.11.m11.3.4.3.1.cmml" xref="A2.SS2.p1.11.m11.3.4.3.2"><ci id="A2.SS2.p1.11.m11.1.1.cmml" xref="A2.SS2.p1.11.m11.1.1">𝑤</ci><ci id="A2.SS2.p1.11.m11.2.2.cmml" xref="A2.SS2.p1.11.m11.2.2">𝑥</ci><ci id="A2.SS2.p1.11.m11.3.3.cmml" xref="A2.SS2.p1.11.m11.3.3">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.11.m11.3c">\ell(w;x,y)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.11.m11.3d">roman_ℓ ( italic_w ; italic_x , italic_y )</annotation></semantics></math>.
The global objective function, which the collaborative effort seeks to minimize, is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(w):={\frac{1}{N}}\sum_{i=1}^{N}f^{(i)}(w)" class="ltx_Math" display="block" id="A2.Ex6.m1.3"><semantics id="A2.Ex6.m1.3a"><mrow id="A2.Ex6.m1.3.4" xref="A2.Ex6.m1.3.4.cmml"><mrow id="A2.Ex6.m1.3.4.2" xref="A2.Ex6.m1.3.4.2.cmml"><mi id="A2.Ex6.m1.3.4.2.2" xref="A2.Ex6.m1.3.4.2.2.cmml">f</mi><mo id="A2.Ex6.m1.3.4.2.1" xref="A2.Ex6.m1.3.4.2.1.cmml">⁢</mo><mrow id="A2.Ex6.m1.3.4.2.3.2" xref="A2.Ex6.m1.3.4.2.cmml"><mo id="A2.Ex6.m1.3.4.2.3.2.1" stretchy="false" xref="A2.Ex6.m1.3.4.2.cmml">(</mo><mi id="A2.Ex6.m1.2.2" xref="A2.Ex6.m1.2.2.cmml">w</mi><mo id="A2.Ex6.m1.3.4.2.3.2.2" rspace="0.278em" stretchy="false" xref="A2.Ex6.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="A2.Ex6.m1.3.4.1" rspace="0.278em" xref="A2.Ex6.m1.3.4.1.cmml">:=</mo><mrow id="A2.Ex6.m1.3.4.3" xref="A2.Ex6.m1.3.4.3.cmml"><mfrac id="A2.Ex6.m1.3.4.3.2" xref="A2.Ex6.m1.3.4.3.2.cmml"><mn id="A2.Ex6.m1.3.4.3.2.2" xref="A2.Ex6.m1.3.4.3.2.2.cmml">1</mn><mi id="A2.Ex6.m1.3.4.3.2.3" xref="A2.Ex6.m1.3.4.3.2.3.cmml">N</mi></mfrac><mo id="A2.Ex6.m1.3.4.3.1" xref="A2.Ex6.m1.3.4.3.1.cmml">⁢</mo><mrow id="A2.Ex6.m1.3.4.3.3" xref="A2.Ex6.m1.3.4.3.3.cmml"><munderover id="A2.Ex6.m1.3.4.3.3.1" xref="A2.Ex6.m1.3.4.3.3.1.cmml"><mo id="A2.Ex6.m1.3.4.3.3.1.2.2" movablelimits="false" xref="A2.Ex6.m1.3.4.3.3.1.2.2.cmml">∑</mo><mrow id="A2.Ex6.m1.3.4.3.3.1.2.3" xref="A2.Ex6.m1.3.4.3.3.1.2.3.cmml"><mi id="A2.Ex6.m1.3.4.3.3.1.2.3.2" xref="A2.Ex6.m1.3.4.3.3.1.2.3.2.cmml">i</mi><mo id="A2.Ex6.m1.3.4.3.3.1.2.3.1" xref="A2.Ex6.m1.3.4.3.3.1.2.3.1.cmml">=</mo><mn id="A2.Ex6.m1.3.4.3.3.1.2.3.3" xref="A2.Ex6.m1.3.4.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A2.Ex6.m1.3.4.3.3.1.3" xref="A2.Ex6.m1.3.4.3.3.1.3.cmml">N</mi></munderover><mrow id="A2.Ex6.m1.3.4.3.3.2" xref="A2.Ex6.m1.3.4.3.3.2.cmml"><msup id="A2.Ex6.m1.3.4.3.3.2.2" xref="A2.Ex6.m1.3.4.3.3.2.2.cmml"><mi id="A2.Ex6.m1.3.4.3.3.2.2.2" xref="A2.Ex6.m1.3.4.3.3.2.2.2.cmml">f</mi><mrow id="A2.Ex6.m1.1.1.1.3" xref="A2.Ex6.m1.3.4.3.3.2.2.cmml"><mo id="A2.Ex6.m1.1.1.1.3.1" stretchy="false" xref="A2.Ex6.m1.3.4.3.3.2.2.cmml">(</mo><mi id="A2.Ex6.m1.1.1.1.1" xref="A2.Ex6.m1.1.1.1.1.cmml">i</mi><mo id="A2.Ex6.m1.1.1.1.3.2" stretchy="false" xref="A2.Ex6.m1.3.4.3.3.2.2.cmml">)</mo></mrow></msup><mo id="A2.Ex6.m1.3.4.3.3.2.1" xref="A2.Ex6.m1.3.4.3.3.2.1.cmml">⁢</mo><mrow id="A2.Ex6.m1.3.4.3.3.2.3.2" xref="A2.Ex6.m1.3.4.3.3.2.cmml"><mo id="A2.Ex6.m1.3.4.3.3.2.3.2.1" stretchy="false" xref="A2.Ex6.m1.3.4.3.3.2.cmml">(</mo><mi id="A2.Ex6.m1.3.3" xref="A2.Ex6.m1.3.3.cmml">w</mi><mo id="A2.Ex6.m1.3.4.3.3.2.3.2.2" stretchy="false" xref="A2.Ex6.m1.3.4.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex6.m1.3b"><apply id="A2.Ex6.m1.3.4.cmml" xref="A2.Ex6.m1.3.4"><csymbol cd="latexml" id="A2.Ex6.m1.3.4.1.cmml" xref="A2.Ex6.m1.3.4.1">assign</csymbol><apply id="A2.Ex6.m1.3.4.2.cmml" xref="A2.Ex6.m1.3.4.2"><times id="A2.Ex6.m1.3.4.2.1.cmml" xref="A2.Ex6.m1.3.4.2.1"></times><ci id="A2.Ex6.m1.3.4.2.2.cmml" xref="A2.Ex6.m1.3.4.2.2">𝑓</ci><ci id="A2.Ex6.m1.2.2.cmml" xref="A2.Ex6.m1.2.2">𝑤</ci></apply><apply id="A2.Ex6.m1.3.4.3.cmml" xref="A2.Ex6.m1.3.4.3"><times id="A2.Ex6.m1.3.4.3.1.cmml" xref="A2.Ex6.m1.3.4.3.1"></times><apply id="A2.Ex6.m1.3.4.3.2.cmml" xref="A2.Ex6.m1.3.4.3.2"><divide id="A2.Ex6.m1.3.4.3.2.1.cmml" xref="A2.Ex6.m1.3.4.3.2"></divide><cn id="A2.Ex6.m1.3.4.3.2.2.cmml" type="integer" xref="A2.Ex6.m1.3.4.3.2.2">1</cn><ci id="A2.Ex6.m1.3.4.3.2.3.cmml" xref="A2.Ex6.m1.3.4.3.2.3">𝑁</ci></apply><apply id="A2.Ex6.m1.3.4.3.3.cmml" xref="A2.Ex6.m1.3.4.3.3"><apply id="A2.Ex6.m1.3.4.3.3.1.cmml" xref="A2.Ex6.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="A2.Ex6.m1.3.4.3.3.1.1.cmml" xref="A2.Ex6.m1.3.4.3.3.1">superscript</csymbol><apply id="A2.Ex6.m1.3.4.3.3.1.2.cmml" xref="A2.Ex6.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="A2.Ex6.m1.3.4.3.3.1.2.1.cmml" xref="A2.Ex6.m1.3.4.3.3.1">subscript</csymbol><sum id="A2.Ex6.m1.3.4.3.3.1.2.2.cmml" xref="A2.Ex6.m1.3.4.3.3.1.2.2"></sum><apply id="A2.Ex6.m1.3.4.3.3.1.2.3.cmml" xref="A2.Ex6.m1.3.4.3.3.1.2.3"><eq id="A2.Ex6.m1.3.4.3.3.1.2.3.1.cmml" xref="A2.Ex6.m1.3.4.3.3.1.2.3.1"></eq><ci id="A2.Ex6.m1.3.4.3.3.1.2.3.2.cmml" xref="A2.Ex6.m1.3.4.3.3.1.2.3.2">𝑖</ci><cn id="A2.Ex6.m1.3.4.3.3.1.2.3.3.cmml" type="integer" xref="A2.Ex6.m1.3.4.3.3.1.2.3.3">1</cn></apply></apply><ci id="A2.Ex6.m1.3.4.3.3.1.3.cmml" xref="A2.Ex6.m1.3.4.3.3.1.3">𝑁</ci></apply><apply id="A2.Ex6.m1.3.4.3.3.2.cmml" xref="A2.Ex6.m1.3.4.3.3.2"><times id="A2.Ex6.m1.3.4.3.3.2.1.cmml" xref="A2.Ex6.m1.3.4.3.3.2.1"></times><apply id="A2.Ex6.m1.3.4.3.3.2.2.cmml" xref="A2.Ex6.m1.3.4.3.3.2.2"><csymbol cd="ambiguous" id="A2.Ex6.m1.3.4.3.3.2.2.1.cmml" xref="A2.Ex6.m1.3.4.3.3.2.2">superscript</csymbol><ci id="A2.Ex6.m1.3.4.3.3.2.2.2.cmml" xref="A2.Ex6.m1.3.4.3.3.2.2.2">𝑓</ci><ci id="A2.Ex6.m1.1.1.1.1.cmml" xref="A2.Ex6.m1.1.1.1.1">𝑖</ci></apply><ci id="A2.Ex6.m1.3.3.cmml" xref="A2.Ex6.m1.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex6.m1.3c">f(w):={\frac{1}{N}}\sum_{i=1}^{N}f^{(i)}(w)</annotation><annotation encoding="application/x-llamapun" id="A2.Ex6.m1.3d">italic_f ( italic_w ) := divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_f start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS2.p1.14">where <math alttext="f^{(i)}(w)" class="ltx_Math" display="inline" id="A2.SS2.p1.12.m1.2"><semantics id="A2.SS2.p1.12.m1.2a"><mrow id="A2.SS2.p1.12.m1.2.3" xref="A2.SS2.p1.12.m1.2.3.cmml"><msup id="A2.SS2.p1.12.m1.2.3.2" xref="A2.SS2.p1.12.m1.2.3.2.cmml"><mi id="A2.SS2.p1.12.m1.2.3.2.2" xref="A2.SS2.p1.12.m1.2.3.2.2.cmml">f</mi><mrow id="A2.SS2.p1.12.m1.1.1.1.3" xref="A2.SS2.p1.12.m1.2.3.2.cmml"><mo id="A2.SS2.p1.12.m1.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.12.m1.2.3.2.cmml">(</mo><mi id="A2.SS2.p1.12.m1.1.1.1.1" xref="A2.SS2.p1.12.m1.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.12.m1.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.12.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="A2.SS2.p1.12.m1.2.3.1" xref="A2.SS2.p1.12.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS2.p1.12.m1.2.3.3.2" xref="A2.SS2.p1.12.m1.2.3.cmml"><mo id="A2.SS2.p1.12.m1.2.3.3.2.1" stretchy="false" xref="A2.SS2.p1.12.m1.2.3.cmml">(</mo><mi id="A2.SS2.p1.12.m1.2.2" xref="A2.SS2.p1.12.m1.2.2.cmml">w</mi><mo id="A2.SS2.p1.12.m1.2.3.3.2.2" stretchy="false" xref="A2.SS2.p1.12.m1.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.12.m1.2b"><apply id="A2.SS2.p1.12.m1.2.3.cmml" xref="A2.SS2.p1.12.m1.2.3"><times id="A2.SS2.p1.12.m1.2.3.1.cmml" xref="A2.SS2.p1.12.m1.2.3.1"></times><apply id="A2.SS2.p1.12.m1.2.3.2.cmml" xref="A2.SS2.p1.12.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS2.p1.12.m1.2.3.2.1.cmml" xref="A2.SS2.p1.12.m1.2.3.2">superscript</csymbol><ci id="A2.SS2.p1.12.m1.2.3.2.2.cmml" xref="A2.SS2.p1.12.m1.2.3.2.2">𝑓</ci><ci id="A2.SS2.p1.12.m1.1.1.1.1.cmml" xref="A2.SS2.p1.12.m1.1.1.1.1">𝑖</ci></apply><ci id="A2.SS2.p1.12.m1.2.2.cmml" xref="A2.SS2.p1.12.m1.2.2">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.12.m1.2c">f^{(i)}(w)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.12.m1.2d">italic_f start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w )</annotation></semantics></math> represents the local objective function for each client <math alttext="i" class="ltx_Math" display="inline" id="A2.SS2.p1.13.m2.1"><semantics id="A2.SS2.p1.13.m2.1a"><mi id="A2.SS2.p1.13.m2.1.1" xref="A2.SS2.p1.13.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.13.m2.1b"><ci id="A2.SS2.p1.13.m2.1.1.cmml" xref="A2.SS2.p1.13.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.13.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.13.m2.1d">italic_i</annotation></semantics></math>, and it is defined as <math alttext="f^{(i)}(w)=\mathbb{E}_{p^{(i)}(x,y)}[\ell(w;x,y)]" class="ltx_Math" display="inline" id="A2.SS2.p1.14.m3.9"><semantics id="A2.SS2.p1.14.m3.9a"><mrow id="A2.SS2.p1.14.m3.9.9" xref="A2.SS2.p1.14.m3.9.9.cmml"><mrow id="A2.SS2.p1.14.m3.9.9.3" xref="A2.SS2.p1.14.m3.9.9.3.cmml"><msup id="A2.SS2.p1.14.m3.9.9.3.2" xref="A2.SS2.p1.14.m3.9.9.3.2.cmml"><mi id="A2.SS2.p1.14.m3.9.9.3.2.2" xref="A2.SS2.p1.14.m3.9.9.3.2.2.cmml">f</mi><mrow id="A2.SS2.p1.14.m3.1.1.1.3" xref="A2.SS2.p1.14.m3.9.9.3.2.cmml"><mo id="A2.SS2.p1.14.m3.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.3.2.cmml">(</mo><mi id="A2.SS2.p1.14.m3.1.1.1.1" xref="A2.SS2.p1.14.m3.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.14.m3.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.3.2.cmml">)</mo></mrow></msup><mo id="A2.SS2.p1.14.m3.9.9.3.1" xref="A2.SS2.p1.14.m3.9.9.3.1.cmml">⁢</mo><mrow id="A2.SS2.p1.14.m3.9.9.3.3.2" xref="A2.SS2.p1.14.m3.9.9.3.cmml"><mo id="A2.SS2.p1.14.m3.9.9.3.3.2.1" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.3.cmml">(</mo><mi id="A2.SS2.p1.14.m3.5.5" xref="A2.SS2.p1.14.m3.5.5.cmml">w</mi><mo id="A2.SS2.p1.14.m3.9.9.3.3.2.2" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.3.cmml">)</mo></mrow></mrow><mo id="A2.SS2.p1.14.m3.9.9.2" xref="A2.SS2.p1.14.m3.9.9.2.cmml">=</mo><mrow id="A2.SS2.p1.14.m3.9.9.1" xref="A2.SS2.p1.14.m3.9.9.1.cmml"><msub id="A2.SS2.p1.14.m3.9.9.1.3" xref="A2.SS2.p1.14.m3.9.9.1.3.cmml"><mi id="A2.SS2.p1.14.m3.9.9.1.3.2" xref="A2.SS2.p1.14.m3.9.9.1.3.2.cmml">𝔼</mi><mrow id="A2.SS2.p1.14.m3.4.4.3" xref="A2.SS2.p1.14.m3.4.4.3.cmml"><msup id="A2.SS2.p1.14.m3.4.4.3.5" xref="A2.SS2.p1.14.m3.4.4.3.5.cmml"><mi id="A2.SS2.p1.14.m3.4.4.3.5.2" xref="A2.SS2.p1.14.m3.4.4.3.5.2.cmml">p</mi><mrow id="A2.SS2.p1.14.m3.2.2.1.1.1.3" xref="A2.SS2.p1.14.m3.4.4.3.5.cmml"><mo id="A2.SS2.p1.14.m3.2.2.1.1.1.3.1" stretchy="false" xref="A2.SS2.p1.14.m3.4.4.3.5.cmml">(</mo><mi id="A2.SS2.p1.14.m3.2.2.1.1.1.1" xref="A2.SS2.p1.14.m3.2.2.1.1.1.1.cmml">i</mi><mo id="A2.SS2.p1.14.m3.2.2.1.1.1.3.2" stretchy="false" xref="A2.SS2.p1.14.m3.4.4.3.5.cmml">)</mo></mrow></msup><mo id="A2.SS2.p1.14.m3.4.4.3.4" xref="A2.SS2.p1.14.m3.4.4.3.4.cmml">⁢</mo><mrow id="A2.SS2.p1.14.m3.4.4.3.6.2" xref="A2.SS2.p1.14.m3.4.4.3.6.1.cmml"><mo id="A2.SS2.p1.14.m3.4.4.3.6.2.1" stretchy="false" xref="A2.SS2.p1.14.m3.4.4.3.6.1.cmml">(</mo><mi id="A2.SS2.p1.14.m3.3.3.2.2" xref="A2.SS2.p1.14.m3.3.3.2.2.cmml">x</mi><mo id="A2.SS2.p1.14.m3.4.4.3.6.2.2" xref="A2.SS2.p1.14.m3.4.4.3.6.1.cmml">,</mo><mi id="A2.SS2.p1.14.m3.4.4.3.3" xref="A2.SS2.p1.14.m3.4.4.3.3.cmml">y</mi><mo id="A2.SS2.p1.14.m3.4.4.3.6.2.3" stretchy="false" xref="A2.SS2.p1.14.m3.4.4.3.6.1.cmml">)</mo></mrow></mrow></msub><mo id="A2.SS2.p1.14.m3.9.9.1.2" xref="A2.SS2.p1.14.m3.9.9.1.2.cmml">⁢</mo><mrow id="A2.SS2.p1.14.m3.9.9.1.1.1" xref="A2.SS2.p1.14.m3.9.9.1.1.2.cmml"><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.2" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.1.1.2.1.cmml">[</mo><mrow id="A2.SS2.p1.14.m3.9.9.1.1.1.1" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.cmml"><mi id="A2.SS2.p1.14.m3.9.9.1.1.1.1.2" mathvariant="normal" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.2.cmml">ℓ</mi><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.1.1" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.1.cmml">⁢</mo><mrow id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml"><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2.1" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml">(</mo><mi id="A2.SS2.p1.14.m3.6.6" xref="A2.SS2.p1.14.m3.6.6.cmml">w</mi><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2.2" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml">;</mo><mi id="A2.SS2.p1.14.m3.7.7" xref="A2.SS2.p1.14.m3.7.7.cmml">x</mi><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2.3" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="A2.SS2.p1.14.m3.8.8" xref="A2.SS2.p1.14.m3.8.8.cmml">y</mi><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2.4" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="A2.SS2.p1.14.m3.9.9.1.1.1.3" stretchy="false" xref="A2.SS2.p1.14.m3.9.9.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.14.m3.9b"><apply id="A2.SS2.p1.14.m3.9.9.cmml" xref="A2.SS2.p1.14.m3.9.9"><eq id="A2.SS2.p1.14.m3.9.9.2.cmml" xref="A2.SS2.p1.14.m3.9.9.2"></eq><apply id="A2.SS2.p1.14.m3.9.9.3.cmml" xref="A2.SS2.p1.14.m3.9.9.3"><times id="A2.SS2.p1.14.m3.9.9.3.1.cmml" xref="A2.SS2.p1.14.m3.9.9.3.1"></times><apply id="A2.SS2.p1.14.m3.9.9.3.2.cmml" xref="A2.SS2.p1.14.m3.9.9.3.2"><csymbol cd="ambiguous" id="A2.SS2.p1.14.m3.9.9.3.2.1.cmml" xref="A2.SS2.p1.14.m3.9.9.3.2">superscript</csymbol><ci id="A2.SS2.p1.14.m3.9.9.3.2.2.cmml" xref="A2.SS2.p1.14.m3.9.9.3.2.2">𝑓</ci><ci id="A2.SS2.p1.14.m3.1.1.1.1.cmml" xref="A2.SS2.p1.14.m3.1.1.1.1">𝑖</ci></apply><ci id="A2.SS2.p1.14.m3.5.5.cmml" xref="A2.SS2.p1.14.m3.5.5">𝑤</ci></apply><apply id="A2.SS2.p1.14.m3.9.9.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1"><times id="A2.SS2.p1.14.m3.9.9.1.2.cmml" xref="A2.SS2.p1.14.m3.9.9.1.2"></times><apply id="A2.SS2.p1.14.m3.9.9.1.3.cmml" xref="A2.SS2.p1.14.m3.9.9.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.14.m3.9.9.1.3.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1.3">subscript</csymbol><ci id="A2.SS2.p1.14.m3.9.9.1.3.2.cmml" xref="A2.SS2.p1.14.m3.9.9.1.3.2">𝔼</ci><apply id="A2.SS2.p1.14.m3.4.4.3.cmml" xref="A2.SS2.p1.14.m3.4.4.3"><times id="A2.SS2.p1.14.m3.4.4.3.4.cmml" xref="A2.SS2.p1.14.m3.4.4.3.4"></times><apply id="A2.SS2.p1.14.m3.4.4.3.5.cmml" xref="A2.SS2.p1.14.m3.4.4.3.5"><csymbol cd="ambiguous" id="A2.SS2.p1.14.m3.4.4.3.5.1.cmml" xref="A2.SS2.p1.14.m3.4.4.3.5">superscript</csymbol><ci id="A2.SS2.p1.14.m3.4.4.3.5.2.cmml" xref="A2.SS2.p1.14.m3.4.4.3.5.2">𝑝</ci><ci id="A2.SS2.p1.14.m3.2.2.1.1.1.1.cmml" xref="A2.SS2.p1.14.m3.2.2.1.1.1.1">𝑖</ci></apply><interval closure="open" id="A2.SS2.p1.14.m3.4.4.3.6.1.cmml" xref="A2.SS2.p1.14.m3.4.4.3.6.2"><ci id="A2.SS2.p1.14.m3.3.3.2.2.cmml" xref="A2.SS2.p1.14.m3.3.3.2.2">𝑥</ci><ci id="A2.SS2.p1.14.m3.4.4.3.3.cmml" xref="A2.SS2.p1.14.m3.4.4.3.3">𝑦</ci></interval></apply></apply><apply id="A2.SS2.p1.14.m3.9.9.1.1.2.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1"><csymbol cd="latexml" id="A2.SS2.p1.14.m3.9.9.1.1.2.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1.2">delimited-[]</csymbol><apply id="A2.SS2.p1.14.m3.9.9.1.1.1.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1"><times id="A2.SS2.p1.14.m3.9.9.1.1.1.1.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.1"></times><ci id="A2.SS2.p1.14.m3.9.9.1.1.1.1.2.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.2">ℓ</ci><list id="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.1.cmml" xref="A2.SS2.p1.14.m3.9.9.1.1.1.1.3.2"><ci id="A2.SS2.p1.14.m3.6.6.cmml" xref="A2.SS2.p1.14.m3.6.6">𝑤</ci><ci id="A2.SS2.p1.14.m3.7.7.cmml" xref="A2.SS2.p1.14.m3.7.7">𝑥</ci><ci id="A2.SS2.p1.14.m3.8.8.cmml" xref="A2.SS2.p1.14.m3.8.8">𝑦</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.14.m3.9c">f^{(i)}(w)=\mathbb{E}_{p^{(i)}(x,y)}[\ell(w;x,y)]</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.14.m3.9d">italic_f start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w ) = blackboard_E start_POSTSUBSCRIPT italic_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_x , italic_y ) end_POSTSUBSCRIPT [ roman_ℓ ( italic_w ; italic_x , italic_y ) ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">In this paper, we implement the FedAvg approach <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">mcmahan2017communication</span> </a></cite>, a widely adopted federated averaging algorithm, as our base framework to train our global (shared) parameters in our proposed framework.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>FedOT</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Detailed of Parameter Update.</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">The algorithm of FedOT is presented in the form of a complete pseudo-code.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_bold" id="alg1.4.2">FedOT</span>: Orthogonal Local Updates via Cayley Transform</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Global initialisation</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>Initialise server parameter <math alttext="w_{\mathrm{g},0}" class="ltx_Math" display="inline" id="alg1.l2.m1.2"><semantics id="alg1.l2.m1.2a"><msub id="alg1.l2.m1.2.3" xref="alg1.l2.m1.2.3.cmml"><mi id="alg1.l2.m1.2.3.2" xref="alg1.l2.m1.2.3.2.cmml">w</mi><mrow id="alg1.l2.m1.2.2.2.4" xref="alg1.l2.m1.2.2.2.3.cmml"><mi id="alg1.l2.m1.1.1.1.1" mathvariant="normal" xref="alg1.l2.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l2.m1.2.2.2.4.1" xref="alg1.l2.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.3.cmml" xref="alg1.l2.m1.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.3.1.cmml" xref="alg1.l2.m1.2.3">subscript</csymbol><ci id="alg1.l2.m1.2.3.2.cmml" xref="alg1.l2.m1.2.3.2">𝑤</ci><list id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.4"><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">g</ci><cn id="alg1.l2.m1.2.2.2.2.cmml" type="integer" xref="alg1.l2.m1.2.2.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">w_{\mathrm{g},0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.2d">italic_w start_POSTSUBSCRIPT roman_g , 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">for all</span> client <math alttext="i\in\{1,\dots,N\}" class="ltx_Math" display="inline" id="alg1.l3.m1.3"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">i</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mo id="alg1.l3.m1.3.4.3.2.1" stretchy="false" xref="alg1.l3.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" mathvariant="normal" xref="alg1.l3.m1.2.2.cmml">…</mi><mo id="alg1.l3.m1.3.4.3.2.3" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">N</mi><mo id="alg1.l3.m1.3.4.3.2.4" stretchy="false" xref="alg1.l3.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><in id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></in><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑖</ci><set id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn id="alg1.l3.m1.1.1.cmml" type="integer" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">…</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">i\in\{1,\dots,N\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.3d">italic_i ∈ { 1 , … , italic_N }</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.3">in parallel</span> <span class="ltx_text ltx_font_bold" id="alg1.l3.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>     <math alttext="X^{(i)}_{0}\leftarrow I" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><msubsup id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml"><mi id="alg1.l4.m1.1.2.2.2.2" xref="alg1.l4.m1.1.2.2.2.2.cmml">X</mi><mn id="alg1.l4.m1.1.2.2.3" xref="alg1.l4.m1.1.2.2.3.cmml">0</mn><mrow id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.2.2.cmml"><mo id="alg1.l4.m1.1.1.1.3.1" stretchy="false" xref="alg1.l4.m1.1.2.2.cmml">(</mo><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l4.m1.1.1.1.3.2" stretchy="false" xref="alg1.l4.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l4.m1.1.2.1" stretchy="false" xref="alg1.l4.m1.1.2.1.cmml">←</mo><mi id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><ci id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1">←</ci><apply id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.2.1.cmml" xref="alg1.l4.m1.1.2.2">subscript</csymbol><apply id="alg1.l4.m1.1.2.2.2.cmml" xref="alg1.l4.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.2.2.1.cmml" xref="alg1.l4.m1.1.2.2">superscript</csymbol><ci id="alg1.l4.m1.1.2.2.2.2.cmml" xref="alg1.l4.m1.1.2.2.2.2">𝑋</ci><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝑖</ci></apply><cn id="alg1.l4.m1.1.2.2.3.cmml" type="integer" xref="alg1.l4.m1.1.2.2.3">0</cn></apply><ci id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">X^{(i)}_{0}\leftarrow I</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← italic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="P^{(i)}_{0}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}_{0}-X^{(i)\top}_{0}\bigr{)}" class="ltx_Math" display="inline" id="alg1.l5.m1.4"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><msubsup id="alg1.l5.m1.4.4.3" xref="alg1.l5.m1.4.4.3.cmml"><mi id="alg1.l5.m1.4.4.3.2.2" xref="alg1.l5.m1.4.4.3.2.2.cmml">P</mi><mn id="alg1.l5.m1.4.4.3.3" xref="alg1.l5.m1.4.4.3.3.cmml">0</mn><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.4.4.3.cmml"><mo id="alg1.l5.m1.1.1.1.3.1" stretchy="false" xref="alg1.l5.m1.4.4.3.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l5.m1.1.1.1.3.2" stretchy="false" xref="alg1.l5.m1.4.4.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l5.m1.4.4.2" stretchy="false" xref="alg1.l5.m1.4.4.2.cmml">←</mo><mrow id="alg1.l5.m1.4.4.1" xref="alg1.l5.m1.4.4.1.cmml"><mfrac id="alg1.l5.m1.4.4.1.3" xref="alg1.l5.m1.4.4.1.3.cmml"><mn id="alg1.l5.m1.4.4.1.3.2" xref="alg1.l5.m1.4.4.1.3.2.cmml">1</mn><mn id="alg1.l5.m1.4.4.1.3.3" xref="alg1.l5.m1.4.4.1.3.3.cmml">2</mn></mfrac><mo id="alg1.l5.m1.4.4.1.2" xref="alg1.l5.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l5.m1.4.4.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.4.4.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml"><msubsup id="alg1.l5.m1.4.4.1.1.1.1.2" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.1.2.2.2" xref="alg1.l5.m1.4.4.1.1.1.1.2.2.2.cmml">X</mi><mn id="alg1.l5.m1.4.4.1.1.1.1.2.3" xref="alg1.l5.m1.4.4.1.1.1.1.2.3.cmml">0</mn><mrow id="alg1.l5.m1.2.2.1.3" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml"><mo id="alg1.l5.m1.2.2.1.3.1" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l5.m1.2.2.1.3.2" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l5.m1.4.4.1.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.1.cmml">−</mo><msubsup id="alg1.l5.m1.4.4.1.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.1.3.2.2" xref="alg1.l5.m1.4.4.1.1.1.1.3.2.2.cmml">X</mi><mn id="alg1.l5.m1.4.4.1.1.1.1.3.3" xref="alg1.l5.m1.4.4.1.1.1.1.3.3.cmml">0</mn><mrow id="alg1.l5.m1.3.3.1" xref="alg1.l5.m1.3.3.1.cmml"><mrow id="alg1.l5.m1.3.3.1.3.2" xref="alg1.l5.m1.3.3.1.cmml"><mo id="alg1.l5.m1.3.3.1.3.2.1" stretchy="false" xref="alg1.l5.m1.3.3.1.cmml">(</mo><mi id="alg1.l5.m1.3.3.1.1" xref="alg1.l5.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l5.m1.3.3.1.3.2.2" stretchy="false" xref="alg1.l5.m1.3.3.1.cmml">)</mo></mrow><mo id="alg1.l5.m1.3.3.1.4" lspace="0.222em" xref="alg1.l5.m1.3.3.1.4.cmml">⊤</mo></mrow></msubsup></mrow><mo id="alg1.l5.m1.4.4.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><ci id="alg1.l5.m1.4.4.2.cmml" xref="alg1.l5.m1.4.4.2">←</ci><apply id="alg1.l5.m1.4.4.3.cmml" xref="alg1.l5.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.3.1.cmml" xref="alg1.l5.m1.4.4.3">subscript</csymbol><apply id="alg1.l5.m1.4.4.3.2.cmml" xref="alg1.l5.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.3.2.1.cmml" xref="alg1.l5.m1.4.4.3">superscript</csymbol><ci id="alg1.l5.m1.4.4.3.2.2.cmml" xref="alg1.l5.m1.4.4.3.2.2">𝑃</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑖</ci></apply><cn id="alg1.l5.m1.4.4.3.3.cmml" type="integer" xref="alg1.l5.m1.4.4.3.3">0</cn></apply><apply id="alg1.l5.m1.4.4.1.cmml" xref="alg1.l5.m1.4.4.1"><times id="alg1.l5.m1.4.4.1.2.cmml" xref="alg1.l5.m1.4.4.1.2"></times><apply id="alg1.l5.m1.4.4.1.3.cmml" xref="alg1.l5.m1.4.4.1.3"><divide id="alg1.l5.m1.4.4.1.3.1.cmml" xref="alg1.l5.m1.4.4.1.3"></divide><cn id="alg1.l5.m1.4.4.1.3.2.cmml" type="integer" xref="alg1.l5.m1.4.4.1.3.2">1</cn><cn id="alg1.l5.m1.4.4.1.3.3.cmml" type="integer" xref="alg1.l5.m1.4.4.1.3.3">2</cn></apply><apply id="alg1.l5.m1.4.4.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1"><minus id="alg1.l5.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.1"></minus><apply id="alg1.l5.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2">subscript</csymbol><apply id="alg1.l5.m1.4.4.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.1.2.2.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="alg1.l5.m1.4.4.1.1.1.1.2.2.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2.2.2">𝑋</ci><ci id="alg1.l5.m1.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.1.1">𝑖</ci></apply><cn id="alg1.l5.m1.4.4.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l5.m1.4.4.1.1.1.1.2.3">0</cn></apply><apply id="alg1.l5.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3">subscript</csymbol><apply id="alg1.l5.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.1.3.2.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="alg1.l5.m1.4.4.1.1.1.1.3.2.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3.2.2">𝑋</ci><apply id="alg1.l5.m1.3.3.1.cmml" xref="alg1.l5.m1.3.3.1"><csymbol cd="latexml" id="alg1.l5.m1.3.3.1.2.cmml" xref="alg1.l5.m1.3.3.1">limit-from</csymbol><ci id="alg1.l5.m1.3.3.1.1.cmml" xref="alg1.l5.m1.3.3.1.1">𝑖</ci><csymbol cd="latexml" id="alg1.l5.m1.3.3.1.4.cmml" xref="alg1.l5.m1.3.3.1.4">top</csymbol></apply></apply><cn id="alg1.l5.m1.4.4.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l5.m1.4.4.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">P^{(i)}_{0}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}_{0}-X^{(i)\top}_{0}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.4d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - italic_X start_POSTSUPERSCRIPT ( italic_i ) ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="w^{(i)}_{\mathrm{l},0}\leftarrow(I+P^{(i)}_{0})(I-P^{(i)}_{0})^{-1}" class="ltx_Math" display="inline" id="alg1.l6.m1.7"><semantics id="alg1.l6.m1.7a"><mrow id="alg1.l6.m1.7.7" xref="alg1.l6.m1.7.7.cmml"><msubsup id="alg1.l6.m1.7.7.4" xref="alg1.l6.m1.7.7.4.cmml"><mi id="alg1.l6.m1.7.7.4.2.2" xref="alg1.l6.m1.7.7.4.2.2.cmml">w</mi><mrow id="alg1.l6.m1.3.3.2.4" xref="alg1.l6.m1.3.3.2.3.cmml"><mi id="alg1.l6.m1.2.2.1.1" mathvariant="normal" xref="alg1.l6.m1.2.2.1.1.cmml">l</mi><mo id="alg1.l6.m1.3.3.2.4.1" xref="alg1.l6.m1.3.3.2.3.cmml">,</mo><mn id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.2.cmml">0</mn></mrow><mrow id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.7.7.4.cmml"><mo id="alg1.l6.m1.1.1.1.3.1" stretchy="false" xref="alg1.l6.m1.7.7.4.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l6.m1.1.1.1.3.2" stretchy="false" xref="alg1.l6.m1.7.7.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l6.m1.7.7.3" stretchy="false" xref="alg1.l6.m1.7.7.3.cmml">←</mo><mrow id="alg1.l6.m1.7.7.2" xref="alg1.l6.m1.7.7.2.cmml"><mrow id="alg1.l6.m1.6.6.1.1.1" xref="alg1.l6.m1.6.6.1.1.1.1.cmml"><mo id="alg1.l6.m1.6.6.1.1.1.2" stretchy="false" xref="alg1.l6.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.6.6.1.1.1.1" xref="alg1.l6.m1.6.6.1.1.1.1.cmml"><mi id="alg1.l6.m1.6.6.1.1.1.1.2" xref="alg1.l6.m1.6.6.1.1.1.1.2.cmml">I</mi><mo id="alg1.l6.m1.6.6.1.1.1.1.1" xref="alg1.l6.m1.6.6.1.1.1.1.1.cmml">+</mo><msubsup id="alg1.l6.m1.6.6.1.1.1.1.3" xref="alg1.l6.m1.6.6.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.6.6.1.1.1.1.3.2.2" xref="alg1.l6.m1.6.6.1.1.1.1.3.2.2.cmml">P</mi><mn id="alg1.l6.m1.6.6.1.1.1.1.3.3" xref="alg1.l6.m1.6.6.1.1.1.1.3.3.cmml">0</mn><mrow id="alg1.l6.m1.4.4.1.3" xref="alg1.l6.m1.6.6.1.1.1.1.3.cmml"><mo id="alg1.l6.m1.4.4.1.3.1" stretchy="false" xref="alg1.l6.m1.6.6.1.1.1.1.3.cmml">(</mo><mi id="alg1.l6.m1.4.4.1.1" xref="alg1.l6.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l6.m1.4.4.1.3.2" stretchy="false" xref="alg1.l6.m1.6.6.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="alg1.l6.m1.6.6.1.1.1.3" stretchy="false" xref="alg1.l6.m1.6.6.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l6.m1.7.7.2.3" xref="alg1.l6.m1.7.7.2.3.cmml">⁢</mo><msup id="alg1.l6.m1.7.7.2.2" xref="alg1.l6.m1.7.7.2.2.cmml"><mrow id="alg1.l6.m1.7.7.2.2.1.1" xref="alg1.l6.m1.7.7.2.2.1.1.1.cmml"><mo id="alg1.l6.m1.7.7.2.2.1.1.2" stretchy="false" xref="alg1.l6.m1.7.7.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.7.7.2.2.1.1.1" xref="alg1.l6.m1.7.7.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.7.7.2.2.1.1.1.2" xref="alg1.l6.m1.7.7.2.2.1.1.1.2.cmml">I</mi><mo id="alg1.l6.m1.7.7.2.2.1.1.1.1" xref="alg1.l6.m1.7.7.2.2.1.1.1.1.cmml">−</mo><msubsup id="alg1.l6.m1.7.7.2.2.1.1.1.3" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.cmml"><mi id="alg1.l6.m1.7.7.2.2.1.1.1.3.2.2" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.2.2.cmml">P</mi><mn id="alg1.l6.m1.7.7.2.2.1.1.1.3.3" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.3.cmml">0</mn><mrow id="alg1.l6.m1.5.5.1.3" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.cmml"><mo id="alg1.l6.m1.5.5.1.3.1" stretchy="false" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.cmml">(</mo><mi id="alg1.l6.m1.5.5.1.1" xref="alg1.l6.m1.5.5.1.1.cmml">i</mi><mo id="alg1.l6.m1.5.5.1.3.2" stretchy="false" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="alg1.l6.m1.7.7.2.2.1.1.3" stretchy="false" xref="alg1.l6.m1.7.7.2.2.1.1.1.cmml">)</mo></mrow><mrow id="alg1.l6.m1.7.7.2.2.3" xref="alg1.l6.m1.7.7.2.2.3.cmml"><mo id="alg1.l6.m1.7.7.2.2.3a" xref="alg1.l6.m1.7.7.2.2.3.cmml">−</mo><mn id="alg1.l6.m1.7.7.2.2.3.2" xref="alg1.l6.m1.7.7.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.7b"><apply id="alg1.l6.m1.7.7.cmml" xref="alg1.l6.m1.7.7"><ci id="alg1.l6.m1.7.7.3.cmml" xref="alg1.l6.m1.7.7.3">←</ci><apply id="alg1.l6.m1.7.7.4.cmml" xref="alg1.l6.m1.7.7.4"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.4.1.cmml" xref="alg1.l6.m1.7.7.4">subscript</csymbol><apply id="alg1.l6.m1.7.7.4.2.cmml" xref="alg1.l6.m1.7.7.4"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.4.2.1.cmml" xref="alg1.l6.m1.7.7.4">superscript</csymbol><ci id="alg1.l6.m1.7.7.4.2.2.cmml" xref="alg1.l6.m1.7.7.4.2.2">𝑤</ci><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑖</ci></apply><list id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.4"><ci id="alg1.l6.m1.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.1.1">l</ci><cn id="alg1.l6.m1.3.3.2.2.cmml" type="integer" xref="alg1.l6.m1.3.3.2.2">0</cn></list></apply><apply id="alg1.l6.m1.7.7.2.cmml" xref="alg1.l6.m1.7.7.2"><times id="alg1.l6.m1.7.7.2.3.cmml" xref="alg1.l6.m1.7.7.2.3"></times><apply id="alg1.l6.m1.6.6.1.1.1.1.cmml" xref="alg1.l6.m1.6.6.1.1.1"><plus id="alg1.l6.m1.6.6.1.1.1.1.1.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.1"></plus><ci id="alg1.l6.m1.6.6.1.1.1.1.2.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.2">𝐼</ci><apply id="alg1.l6.m1.6.6.1.1.1.1.3.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.6.6.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="alg1.l6.m1.6.6.1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.6.6.1.1.1.1.3.2.2">𝑃</ci><ci id="alg1.l6.m1.4.4.1.1.cmml" xref="alg1.l6.m1.4.4.1.1">𝑖</ci></apply><cn id="alg1.l6.m1.6.6.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l6.m1.6.6.1.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.l6.m1.7.7.2.2.cmml" xref="alg1.l6.m1.7.7.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.2.2.2.cmml" xref="alg1.l6.m1.7.7.2.2">superscript</csymbol><apply id="alg1.l6.m1.7.7.2.2.1.1.1.cmml" xref="alg1.l6.m1.7.7.2.2.1.1"><minus id="alg1.l6.m1.7.7.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.1"></minus><ci id="alg1.l6.m1.7.7.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.2">𝐼</ci><apply id="alg1.l6.m1.7.7.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.2.2.1.1.1.3.1.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.7.7.2.2.1.1.1.3.2.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.7.7.2.2.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.3">superscript</csymbol><ci id="alg1.l6.m1.7.7.2.2.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.2.2">𝑃</ci><ci id="alg1.l6.m1.5.5.1.1.cmml" xref="alg1.l6.m1.5.5.1.1">𝑖</ci></apply><cn id="alg1.l6.m1.7.7.2.2.1.1.1.3.3.cmml" type="integer" xref="alg1.l6.m1.7.7.2.2.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.l6.m1.7.7.2.2.3.cmml" xref="alg1.l6.m1.7.7.2.2.3"><minus id="alg1.l6.m1.7.7.2.2.3.1.cmml" xref="alg1.l6.m1.7.7.2.2.3"></minus><cn id="alg1.l6.m1.7.7.2.2.3.2.cmml" type="integer" xref="alg1.l6.m1.7.7.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.7c">w^{(i)}_{\mathrm{l},0}\leftarrow(I+P^{(i)}_{0})(I-P^{(i)}_{0})^{-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.7d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_l , 0 end_POSTSUBSCRIPT ← ( italic_I + italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l7.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>Server broadcasts <math alttext="w_{\mathrm{g},0}" class="ltx_Math" display="inline" id="alg1.l8.m1.2"><semantics id="alg1.l8.m1.2a"><msub id="alg1.l8.m1.2.3" xref="alg1.l8.m1.2.3.cmml"><mi id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.2.cmml">w</mi><mrow id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.3.cmml"><mi id="alg1.l8.m1.1.1.1.1" mathvariant="normal" xref="alg1.l8.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l8.m1.2.2.2.4.1" xref="alg1.l8.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.3.cmml" xref="alg1.l8.m1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3">subscript</csymbol><ci id="alg1.l8.m1.2.3.2.cmml" xref="alg1.l8.m1.2.3.2">𝑤</ci><list id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.4"><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">g</ci><cn id="alg1.l8.m1.2.2.2.2.cmml" type="integer" xref="alg1.l8.m1.2.2.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">w_{\mathrm{g},0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.2d">italic_w start_POSTSUBSCRIPT roman_g , 0 end_POSTSUBSCRIPT</annotation></semantics></math> to all clients


</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l9.2">for</span> round <math alttext="t=0" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑡</ci><cn id="alg1.l9.m1.1.1.3.cmml" type="integer" xref="alg1.l9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_t = 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">to</span> <math alttext="T-1" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">T</mi><mo id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml">−</mo><mn id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><minus id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"></minus><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑇</ci><cn id="alg1.l9.m2.1.1.3.cmml" type="integer" xref="alg1.l9.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">T-1</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_T - 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l10.2">for all</span> client <math alttext="i" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_i</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.3">in parallel</span> <span class="ltx_text ltx_font_bold" id="alg1.l10.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>         <math alttext="(w^{(i)}_{\mathrm{g},t+1},\,X^{(i)}_{t+1})\leftarrow\textsc{LocalUpdate}(i,\,w%
_{\mathrm{g},t},\,X^{(i)}_{t})" class="ltx_Math" display="inline" id="alg1.l11.m1.12"><semantics id="alg1.l11.m1.12a"><mrow id="alg1.l11.m1.12.12" xref="alg1.l11.m1.12.12.cmml"><mrow id="alg1.l11.m1.10.10.2.2" xref="alg1.l11.m1.10.10.2.3.cmml"><mo id="alg1.l11.m1.10.10.2.2.3" stretchy="false" xref="alg1.l11.m1.10.10.2.3.cmml">(</mo><msubsup id="alg1.l11.m1.9.9.1.1.1" xref="alg1.l11.m1.9.9.1.1.1.cmml"><mi id="alg1.l11.m1.9.9.1.1.1.2.2" xref="alg1.l11.m1.9.9.1.1.1.2.2.cmml">w</mi><mrow id="alg1.l11.m1.3.3.2.2" xref="alg1.l11.m1.3.3.2.3.cmml"><mi id="alg1.l11.m1.2.2.1.1" mathvariant="normal" xref="alg1.l11.m1.2.2.1.1.cmml">g</mi><mo id="alg1.l11.m1.3.3.2.2.2" xref="alg1.l11.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l11.m1.3.3.2.2.1" xref="alg1.l11.m1.3.3.2.2.1.cmml"><mi id="alg1.l11.m1.3.3.2.2.1.2" xref="alg1.l11.m1.3.3.2.2.1.2.cmml">t</mi><mo id="alg1.l11.m1.3.3.2.2.1.1" xref="alg1.l11.m1.3.3.2.2.1.1.cmml">+</mo><mn id="alg1.l11.m1.3.3.2.2.1.3" xref="alg1.l11.m1.3.3.2.2.1.3.cmml">1</mn></mrow></mrow><mrow id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.9.9.1.1.1.cmml"><mo id="alg1.l11.m1.1.1.1.3.1" stretchy="false" xref="alg1.l11.m1.9.9.1.1.1.cmml">(</mo><mi id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l11.m1.1.1.1.3.2" stretchy="false" xref="alg1.l11.m1.9.9.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l11.m1.10.10.2.2.4" rspace="0.337em" xref="alg1.l11.m1.10.10.2.3.cmml">,</mo><msubsup id="alg1.l11.m1.10.10.2.2.2" xref="alg1.l11.m1.10.10.2.2.2.cmml"><mi id="alg1.l11.m1.10.10.2.2.2.2.2" xref="alg1.l11.m1.10.10.2.2.2.2.2.cmml">X</mi><mrow id="alg1.l11.m1.10.10.2.2.2.3" xref="alg1.l11.m1.10.10.2.2.2.3.cmml"><mi id="alg1.l11.m1.10.10.2.2.2.3.2" xref="alg1.l11.m1.10.10.2.2.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.10.10.2.2.2.3.1" xref="alg1.l11.m1.10.10.2.2.2.3.1.cmml">+</mo><mn id="alg1.l11.m1.10.10.2.2.2.3.3" xref="alg1.l11.m1.10.10.2.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l11.m1.4.4.1.3" xref="alg1.l11.m1.10.10.2.2.2.cmml"><mo id="alg1.l11.m1.4.4.1.3.1" stretchy="false" xref="alg1.l11.m1.10.10.2.2.2.cmml">(</mo><mi id="alg1.l11.m1.4.4.1.1" xref="alg1.l11.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l11.m1.4.4.1.3.2" stretchy="false" xref="alg1.l11.m1.10.10.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l11.m1.10.10.2.2.5" stretchy="false" xref="alg1.l11.m1.10.10.2.3.cmml">)</mo></mrow><mo id="alg1.l11.m1.12.12.5" stretchy="false" xref="alg1.l11.m1.12.12.5.cmml">←</mo><mrow id="alg1.l11.m1.12.12.4" xref="alg1.l11.m1.12.12.4.cmml"><mtext class="ltx_font_smallcaps" id="alg1.l11.m1.12.12.4.4" xref="alg1.l11.m1.12.12.4.4a.cmml">LocalUpdate</mtext><mo id="alg1.l11.m1.12.12.4.3" xref="alg1.l11.m1.12.12.4.3.cmml">⁢</mo><mrow id="alg1.l11.m1.12.12.4.2.2" xref="alg1.l11.m1.12.12.4.2.3.cmml"><mo id="alg1.l11.m1.12.12.4.2.2.3" stretchy="false" xref="alg1.l11.m1.12.12.4.2.3.cmml">(</mo><mi id="alg1.l11.m1.8.8" xref="alg1.l11.m1.8.8.cmml">i</mi><mo id="alg1.l11.m1.12.12.4.2.2.4" rspace="0.337em" xref="alg1.l11.m1.12.12.4.2.3.cmml">,</mo><msub id="alg1.l11.m1.11.11.3.1.1.1" xref="alg1.l11.m1.11.11.3.1.1.1.cmml"><mi id="alg1.l11.m1.11.11.3.1.1.1.2" xref="alg1.l11.m1.11.11.3.1.1.1.2.cmml">w</mi><mrow id="alg1.l11.m1.6.6.2.4" xref="alg1.l11.m1.6.6.2.3.cmml"><mi id="alg1.l11.m1.5.5.1.1" mathvariant="normal" xref="alg1.l11.m1.5.5.1.1.cmml">g</mi><mo id="alg1.l11.m1.6.6.2.4.1" xref="alg1.l11.m1.6.6.2.3.cmml">,</mo><mi id="alg1.l11.m1.6.6.2.2" xref="alg1.l11.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l11.m1.12.12.4.2.2.5" rspace="0.337em" xref="alg1.l11.m1.12.12.4.2.3.cmml">,</mo><msubsup id="alg1.l11.m1.12.12.4.2.2.2" xref="alg1.l11.m1.12.12.4.2.2.2.cmml"><mi id="alg1.l11.m1.12.12.4.2.2.2.2.2" xref="alg1.l11.m1.12.12.4.2.2.2.2.2.cmml">X</mi><mi id="alg1.l11.m1.12.12.4.2.2.2.3" xref="alg1.l11.m1.12.12.4.2.2.2.3.cmml">t</mi><mrow id="alg1.l11.m1.7.7.1.3" xref="alg1.l11.m1.12.12.4.2.2.2.cmml"><mo id="alg1.l11.m1.7.7.1.3.1" stretchy="false" xref="alg1.l11.m1.12.12.4.2.2.2.cmml">(</mo><mi id="alg1.l11.m1.7.7.1.1" xref="alg1.l11.m1.7.7.1.1.cmml">i</mi><mo id="alg1.l11.m1.7.7.1.3.2" stretchy="false" xref="alg1.l11.m1.12.12.4.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l11.m1.12.12.4.2.2.6" stretchy="false" xref="alg1.l11.m1.12.12.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.12b"><apply id="alg1.l11.m1.12.12.cmml" xref="alg1.l11.m1.12.12"><ci id="alg1.l11.m1.12.12.5.cmml" xref="alg1.l11.m1.12.12.5">←</ci><interval closure="open" id="alg1.l11.m1.10.10.2.3.cmml" xref="alg1.l11.m1.10.10.2.2"><apply id="alg1.l11.m1.9.9.1.1.1.cmml" xref="alg1.l11.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.9.9.1.1.1.1.cmml" xref="alg1.l11.m1.9.9.1.1.1">subscript</csymbol><apply id="alg1.l11.m1.9.9.1.1.1.2.cmml" xref="alg1.l11.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.9.9.1.1.1.2.1.cmml" xref="alg1.l11.m1.9.9.1.1.1">superscript</csymbol><ci id="alg1.l11.m1.9.9.1.1.1.2.2.cmml" xref="alg1.l11.m1.9.9.1.1.1.2.2">𝑤</ci><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝑖</ci></apply><list id="alg1.l11.m1.3.3.2.3.cmml" xref="alg1.l11.m1.3.3.2.2"><ci id="alg1.l11.m1.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.1.1">g</ci><apply id="alg1.l11.m1.3.3.2.2.1.cmml" xref="alg1.l11.m1.3.3.2.2.1"><plus id="alg1.l11.m1.3.3.2.2.1.1.cmml" xref="alg1.l11.m1.3.3.2.2.1.1"></plus><ci id="alg1.l11.m1.3.3.2.2.1.2.cmml" xref="alg1.l11.m1.3.3.2.2.1.2">𝑡</ci><cn id="alg1.l11.m1.3.3.2.2.1.3.cmml" type="integer" xref="alg1.l11.m1.3.3.2.2.1.3">1</cn></apply></list></apply><apply id="alg1.l11.m1.10.10.2.2.2.cmml" xref="alg1.l11.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.10.10.2.2.2.1.cmml" xref="alg1.l11.m1.10.10.2.2.2">subscript</csymbol><apply id="alg1.l11.m1.10.10.2.2.2.2.cmml" xref="alg1.l11.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.10.10.2.2.2.2.1.cmml" xref="alg1.l11.m1.10.10.2.2.2">superscript</csymbol><ci id="alg1.l11.m1.10.10.2.2.2.2.2.cmml" xref="alg1.l11.m1.10.10.2.2.2.2.2">𝑋</ci><ci id="alg1.l11.m1.4.4.1.1.cmml" xref="alg1.l11.m1.4.4.1.1">𝑖</ci></apply><apply id="alg1.l11.m1.10.10.2.2.2.3.cmml" xref="alg1.l11.m1.10.10.2.2.2.3"><plus id="alg1.l11.m1.10.10.2.2.2.3.1.cmml" xref="alg1.l11.m1.10.10.2.2.2.3.1"></plus><ci id="alg1.l11.m1.10.10.2.2.2.3.2.cmml" xref="alg1.l11.m1.10.10.2.2.2.3.2">𝑡</ci><cn id="alg1.l11.m1.10.10.2.2.2.3.3.cmml" type="integer" xref="alg1.l11.m1.10.10.2.2.2.3.3">1</cn></apply></apply></interval><apply id="alg1.l11.m1.12.12.4.cmml" xref="alg1.l11.m1.12.12.4"><times id="alg1.l11.m1.12.12.4.3.cmml" xref="alg1.l11.m1.12.12.4.3"></times><ci id="alg1.l11.m1.12.12.4.4a.cmml" xref="alg1.l11.m1.12.12.4.4"><mtext class="ltx_font_smallcaps" id="alg1.l11.m1.12.12.4.4.cmml" xref="alg1.l11.m1.12.12.4.4">LocalUpdate</mtext></ci><vector id="alg1.l11.m1.12.12.4.2.3.cmml" xref="alg1.l11.m1.12.12.4.2.2"><ci id="alg1.l11.m1.8.8.cmml" xref="alg1.l11.m1.8.8">𝑖</ci><apply id="alg1.l11.m1.11.11.3.1.1.1.cmml" xref="alg1.l11.m1.11.11.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.11.11.3.1.1.1.1.cmml" xref="alg1.l11.m1.11.11.3.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.11.11.3.1.1.1.2.cmml" xref="alg1.l11.m1.11.11.3.1.1.1.2">𝑤</ci><list id="alg1.l11.m1.6.6.2.3.cmml" xref="alg1.l11.m1.6.6.2.4"><ci id="alg1.l11.m1.5.5.1.1.cmml" xref="alg1.l11.m1.5.5.1.1">g</ci><ci id="alg1.l11.m1.6.6.2.2.cmml" xref="alg1.l11.m1.6.6.2.2">𝑡</ci></list></apply><apply id="alg1.l11.m1.12.12.4.2.2.2.cmml" xref="alg1.l11.m1.12.12.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.12.12.4.2.2.2.1.cmml" xref="alg1.l11.m1.12.12.4.2.2.2">subscript</csymbol><apply id="alg1.l11.m1.12.12.4.2.2.2.2.cmml" xref="alg1.l11.m1.12.12.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.12.12.4.2.2.2.2.1.cmml" xref="alg1.l11.m1.12.12.4.2.2.2">superscript</csymbol><ci id="alg1.l11.m1.12.12.4.2.2.2.2.2.cmml" xref="alg1.l11.m1.12.12.4.2.2.2.2.2">𝑋</ci><ci id="alg1.l11.m1.7.7.1.1.cmml" xref="alg1.l11.m1.7.7.1.1">𝑖</ci></apply><ci id="alg1.l11.m1.12.12.4.2.2.2.3.cmml" xref="alg1.l11.m1.12.12.4.2.2.2.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.12c">(w^{(i)}_{\mathrm{g},t+1},\,X^{(i)}_{t+1})\leftarrow\textsc{LocalUpdate}(i,\,w%
_{\mathrm{g},t},\,X^{(i)}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.12d">( italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g , italic_t + 1 end_POSTSUBSCRIPT , italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ← LocalUpdate ( italic_i , italic_w start_POSTSUBSCRIPT roman_g , italic_t end_POSTSUBSCRIPT , italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>         Client sends <math alttext="w^{(i)}_{\mathrm{g},t+1}" class="ltx_Math" display="inline" id="alg1.l12.m1.3"><semantics id="alg1.l12.m1.3a"><msubsup id="alg1.l12.m1.3.4" xref="alg1.l12.m1.3.4.cmml"><mi id="alg1.l12.m1.3.4.2.2" xref="alg1.l12.m1.3.4.2.2.cmml">w</mi><mrow id="alg1.l12.m1.3.3.2.2" xref="alg1.l12.m1.3.3.2.3.cmml"><mi id="alg1.l12.m1.2.2.1.1" mathvariant="normal" xref="alg1.l12.m1.2.2.1.1.cmml">g</mi><mo id="alg1.l12.m1.3.3.2.2.2" xref="alg1.l12.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l12.m1.3.3.2.2.1" xref="alg1.l12.m1.3.3.2.2.1.cmml"><mi id="alg1.l12.m1.3.3.2.2.1.2" xref="alg1.l12.m1.3.3.2.2.1.2.cmml">t</mi><mo id="alg1.l12.m1.3.3.2.2.1.1" xref="alg1.l12.m1.3.3.2.2.1.1.cmml">+</mo><mn id="alg1.l12.m1.3.3.2.2.1.3" xref="alg1.l12.m1.3.3.2.2.1.3.cmml">1</mn></mrow></mrow><mrow id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.3.4.cmml"><mo id="alg1.l12.m1.1.1.1.3.1" stretchy="false" xref="alg1.l12.m1.3.4.cmml">(</mo><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l12.m1.1.1.1.3.2" stretchy="false" xref="alg1.l12.m1.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.4.cmml" xref="alg1.l12.m1.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.1.cmml" xref="alg1.l12.m1.3.4">subscript</csymbol><apply id="alg1.l12.m1.3.4.2.cmml" xref="alg1.l12.m1.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.2.1.cmml" xref="alg1.l12.m1.3.4">superscript</csymbol><ci id="alg1.l12.m1.3.4.2.2.cmml" xref="alg1.l12.m1.3.4.2.2">𝑤</ci><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑖</ci></apply><list id="alg1.l12.m1.3.3.2.3.cmml" xref="alg1.l12.m1.3.3.2.2"><ci id="alg1.l12.m1.2.2.1.1.cmml" xref="alg1.l12.m1.2.2.1.1">g</ci><apply id="alg1.l12.m1.3.3.2.2.1.cmml" xref="alg1.l12.m1.3.3.2.2.1"><plus id="alg1.l12.m1.3.3.2.2.1.1.cmml" xref="alg1.l12.m1.3.3.2.2.1.1"></plus><ci id="alg1.l12.m1.3.3.2.2.1.2.cmml" xref="alg1.l12.m1.3.3.2.2.1.2">𝑡</ci><cn id="alg1.l12.m1.3.3.2.2.1.3.cmml" type="integer" xref="alg1.l12.m1.3.3.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">w^{(i)}_{\mathrm{g},t+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.3d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g , italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> to server

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l14.2">Server aggregation</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>     <math alttext="w_{\mathrm{g},t+1}\leftarrow\frac{1}{N}\sum_{i=1}^{N}w^{(i)}_{\mathrm{g},t+1}" class="ltx_Math" display="inline" id="alg1.l15.m1.5"><semantics id="alg1.l15.m1.5a"><mrow id="alg1.l15.m1.5.6" xref="alg1.l15.m1.5.6.cmml"><msub id="alg1.l15.m1.5.6.2" xref="alg1.l15.m1.5.6.2.cmml"><mi id="alg1.l15.m1.5.6.2.2" xref="alg1.l15.m1.5.6.2.2.cmml">w</mi><mrow id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1" mathvariant="normal" xref="alg1.l15.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l15.m1.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l15.m1.2.2.2.2.1" xref="alg1.l15.m1.2.2.2.2.1.cmml"><mi id="alg1.l15.m1.2.2.2.2.1.2" xref="alg1.l15.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.2.2.1.1" xref="alg1.l15.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.2.2.1.3" xref="alg1.l15.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="alg1.l15.m1.5.6.1" stretchy="false" xref="alg1.l15.m1.5.6.1.cmml">←</mo><mrow id="alg1.l15.m1.5.6.3" xref="alg1.l15.m1.5.6.3.cmml"><mfrac id="alg1.l15.m1.5.6.3.2" xref="alg1.l15.m1.5.6.3.2.cmml"><mn id="alg1.l15.m1.5.6.3.2.2" xref="alg1.l15.m1.5.6.3.2.2.cmml">1</mn><mi id="alg1.l15.m1.5.6.3.2.3" xref="alg1.l15.m1.5.6.3.2.3.cmml">N</mi></mfrac><mo id="alg1.l15.m1.5.6.3.1" xref="alg1.l15.m1.5.6.3.1.cmml">⁢</mo><mrow id="alg1.l15.m1.5.6.3.3" xref="alg1.l15.m1.5.6.3.3.cmml"><msubsup id="alg1.l15.m1.5.6.3.3.1" xref="alg1.l15.m1.5.6.3.3.1.cmml"><mo id="alg1.l15.m1.5.6.3.3.1.2.2" xref="alg1.l15.m1.5.6.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l15.m1.5.6.3.3.1.2.3" xref="alg1.l15.m1.5.6.3.3.1.2.3.cmml"><mi id="alg1.l15.m1.5.6.3.3.1.2.3.2" xref="alg1.l15.m1.5.6.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l15.m1.5.6.3.3.1.2.3.1" xref="alg1.l15.m1.5.6.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l15.m1.5.6.3.3.1.2.3.3" xref="alg1.l15.m1.5.6.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l15.m1.5.6.3.3.1.3" xref="alg1.l15.m1.5.6.3.3.1.3.cmml">N</mi></msubsup><msubsup id="alg1.l15.m1.5.6.3.3.2" xref="alg1.l15.m1.5.6.3.3.2.cmml"><mi id="alg1.l15.m1.5.6.3.3.2.2.2" xref="alg1.l15.m1.5.6.3.3.2.2.2.cmml">w</mi><mrow id="alg1.l15.m1.5.5.2.2" xref="alg1.l15.m1.5.5.2.3.cmml"><mi id="alg1.l15.m1.4.4.1.1" mathvariant="normal" xref="alg1.l15.m1.4.4.1.1.cmml">g</mi><mo id="alg1.l15.m1.5.5.2.2.2" xref="alg1.l15.m1.5.5.2.3.cmml">,</mo><mrow id="alg1.l15.m1.5.5.2.2.1" xref="alg1.l15.m1.5.5.2.2.1.cmml"><mi id="alg1.l15.m1.5.5.2.2.1.2" xref="alg1.l15.m1.5.5.2.2.1.2.cmml">t</mi><mo id="alg1.l15.m1.5.5.2.2.1.1" xref="alg1.l15.m1.5.5.2.2.1.1.cmml">+</mo><mn id="alg1.l15.m1.5.5.2.2.1.3" xref="alg1.l15.m1.5.5.2.2.1.3.cmml">1</mn></mrow></mrow><mrow id="alg1.l15.m1.3.3.1.3" xref="alg1.l15.m1.5.6.3.3.2.cmml"><mo id="alg1.l15.m1.3.3.1.3.1" stretchy="false" xref="alg1.l15.m1.5.6.3.3.2.cmml">(</mo><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l15.m1.3.3.1.3.2" stretchy="false" xref="alg1.l15.m1.5.6.3.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.5b"><apply id="alg1.l15.m1.5.6.cmml" xref="alg1.l15.m1.5.6"><ci id="alg1.l15.m1.5.6.1.cmml" xref="alg1.l15.m1.5.6.1">←</ci><apply id="alg1.l15.m1.5.6.2.cmml" xref="alg1.l15.m1.5.6.2"><csymbol cd="ambiguous" id="alg1.l15.m1.5.6.2.1.cmml" xref="alg1.l15.m1.5.6.2">subscript</csymbol><ci id="alg1.l15.m1.5.6.2.2.cmml" xref="alg1.l15.m1.5.6.2.2">𝑤</ci><list id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">g</ci><apply id="alg1.l15.m1.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.1"><plus id="alg1.l15.m1.2.2.2.2.1.1.cmml" xref="alg1.l15.m1.2.2.2.2.1.1"></plus><ci id="alg1.l15.m1.2.2.2.2.1.2.cmml" xref="alg1.l15.m1.2.2.2.2.1.2">𝑡</ci><cn id="alg1.l15.m1.2.2.2.2.1.3.cmml" type="integer" xref="alg1.l15.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="alg1.l15.m1.5.6.3.cmml" xref="alg1.l15.m1.5.6.3"><times id="alg1.l15.m1.5.6.3.1.cmml" xref="alg1.l15.m1.5.6.3.1"></times><apply id="alg1.l15.m1.5.6.3.2.cmml" xref="alg1.l15.m1.5.6.3.2"><divide id="alg1.l15.m1.5.6.3.2.1.cmml" xref="alg1.l15.m1.5.6.3.2"></divide><cn id="alg1.l15.m1.5.6.3.2.2.cmml" type="integer" xref="alg1.l15.m1.5.6.3.2.2">1</cn><ci id="alg1.l15.m1.5.6.3.2.3.cmml" xref="alg1.l15.m1.5.6.3.2.3">𝑁</ci></apply><apply id="alg1.l15.m1.5.6.3.3.cmml" xref="alg1.l15.m1.5.6.3.3"><apply id="alg1.l15.m1.5.6.3.3.1.cmml" xref="alg1.l15.m1.5.6.3.3.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.6.3.3.1.1.cmml" xref="alg1.l15.m1.5.6.3.3.1">superscript</csymbol><apply id="alg1.l15.m1.5.6.3.3.1.2.cmml" xref="alg1.l15.m1.5.6.3.3.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.6.3.3.1.2.1.cmml" xref="alg1.l15.m1.5.6.3.3.1">subscript</csymbol><sum id="alg1.l15.m1.5.6.3.3.1.2.2.cmml" xref="alg1.l15.m1.5.6.3.3.1.2.2"></sum><apply id="alg1.l15.m1.5.6.3.3.1.2.3.cmml" xref="alg1.l15.m1.5.6.3.3.1.2.3"><eq id="alg1.l15.m1.5.6.3.3.1.2.3.1.cmml" xref="alg1.l15.m1.5.6.3.3.1.2.3.1"></eq><ci id="alg1.l15.m1.5.6.3.3.1.2.3.2.cmml" xref="alg1.l15.m1.5.6.3.3.1.2.3.2">𝑖</ci><cn id="alg1.l15.m1.5.6.3.3.1.2.3.3.cmml" type="integer" xref="alg1.l15.m1.5.6.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l15.m1.5.6.3.3.1.3.cmml" xref="alg1.l15.m1.5.6.3.3.1.3">𝑁</ci></apply><apply id="alg1.l15.m1.5.6.3.3.2.cmml" xref="alg1.l15.m1.5.6.3.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.5.6.3.3.2.1.cmml" xref="alg1.l15.m1.5.6.3.3.2">subscript</csymbol><apply id="alg1.l15.m1.5.6.3.3.2.2.cmml" xref="alg1.l15.m1.5.6.3.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.5.6.3.3.2.2.1.cmml" xref="alg1.l15.m1.5.6.3.3.2">superscript</csymbol><ci id="alg1.l15.m1.5.6.3.3.2.2.2.cmml" xref="alg1.l15.m1.5.6.3.3.2.2.2">𝑤</ci><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝑖</ci></apply><list id="alg1.l15.m1.5.5.2.3.cmml" xref="alg1.l15.m1.5.5.2.2"><ci id="alg1.l15.m1.4.4.1.1.cmml" xref="alg1.l15.m1.4.4.1.1">g</ci><apply id="alg1.l15.m1.5.5.2.2.1.cmml" xref="alg1.l15.m1.5.5.2.2.1"><plus id="alg1.l15.m1.5.5.2.2.1.1.cmml" xref="alg1.l15.m1.5.5.2.2.1.1"></plus><ci id="alg1.l15.m1.5.5.2.2.1.2.cmml" xref="alg1.l15.m1.5.5.2.2.1.2">𝑡</ci><cn id="alg1.l15.m1.5.5.2.2.1.3.cmml" type="integer" xref="alg1.l15.m1.5.5.2.2.1.3">1</cn></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.5c">w_{\mathrm{g},t+1}\leftarrow\frac{1}{N}\sum_{i=1}^{N}w^{(i)}_{\mathrm{g},t+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.5d">italic_w start_POSTSUBSCRIPT roman_g , italic_t + 1 end_POSTSUBSCRIPT ← divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g , italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>     Server broadcasts <math alttext="w_{\mathrm{g},t+1}" class="ltx_Math" display="inline" id="alg1.l16.m1.2"><semantics id="alg1.l16.m1.2a"><msub id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><mi id="alg1.l16.m1.2.3.2" xref="alg1.l16.m1.2.3.2.cmml">w</mi><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1" mathvariant="normal" xref="alg1.l16.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l16.m1.2.2.2.2.1" xref="alg1.l16.m1.2.2.2.2.1.cmml"><mi id="alg1.l16.m1.2.2.2.2.1.2" xref="alg1.l16.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l16.m1.2.2.2.2.1.1" xref="alg1.l16.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l16.m1.2.2.2.2.1.3" xref="alg1.l16.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3">subscript</csymbol><ci id="alg1.l16.m1.2.3.2.cmml" xref="alg1.l16.m1.2.3.2">𝑤</ci><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">g</ci><apply id="alg1.l16.m1.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.1"><plus id="alg1.l16.m1.2.2.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.2.2.1.1"></plus><ci id="alg1.l16.m1.2.2.2.2.1.2.cmml" xref="alg1.l16.m1.2.2.2.2.1.2">𝑡</ci><cn id="alg1.l16.m1.2.2.2.2.1.3.cmml" type="integer" xref="alg1.l16.m1.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">w_{\mathrm{g},t+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.2d">italic_w start_POSTSUBSCRIPT roman_g , italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> to all clients

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l17.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l18.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg1.l18.3">LocalUpdate</span>(<math alttext="i,\,w_{\mathrm{g}},\,X^{(i)}" class="ltx_Math" display="inline" id="alg1.l18.m1.4"><semantics id="alg1.l18.m1.4a"><mrow id="alg1.l18.m1.4.4.2" xref="alg1.l18.m1.4.4.3.cmml"><mi id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml">i</mi><mo id="alg1.l18.m1.4.4.2.3" rspace="0.337em" xref="alg1.l18.m1.4.4.3.cmml">,</mo><msub id="alg1.l18.m1.3.3.1.1" xref="alg1.l18.m1.3.3.1.1.cmml"><mi id="alg1.l18.m1.3.3.1.1.2" xref="alg1.l18.m1.3.3.1.1.2.cmml">w</mi><mi id="alg1.l18.m1.3.3.1.1.3" mathvariant="normal" xref="alg1.l18.m1.3.3.1.1.3.cmml">g</mi></msub><mo id="alg1.l18.m1.4.4.2.4" rspace="0.337em" xref="alg1.l18.m1.4.4.3.cmml">,</mo><msup id="alg1.l18.m1.4.4.2.2" xref="alg1.l18.m1.4.4.2.2.cmml"><mi id="alg1.l18.m1.4.4.2.2.2" xref="alg1.l18.m1.4.4.2.2.2.cmml">X</mi><mrow id="alg1.l18.m1.1.1.1.3" xref="alg1.l18.m1.4.4.2.2.cmml"><mo id="alg1.l18.m1.1.1.1.3.1" stretchy="false" xref="alg1.l18.m1.4.4.2.2.cmml">(</mo><mi id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l18.m1.1.1.1.3.2" stretchy="false" xref="alg1.l18.m1.4.4.2.2.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.4b"><list id="alg1.l18.m1.4.4.3.cmml" xref="alg1.l18.m1.4.4.2"><ci id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2">𝑖</ci><apply id="alg1.l18.m1.3.3.1.1.cmml" xref="alg1.l18.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.3.3.1.1.1.cmml" xref="alg1.l18.m1.3.3.1.1">subscript</csymbol><ci id="alg1.l18.m1.3.3.1.1.2.cmml" xref="alg1.l18.m1.3.3.1.1.2">𝑤</ci><ci id="alg1.l18.m1.3.3.1.1.3.cmml" xref="alg1.l18.m1.3.3.1.1.3">g</ci></apply><apply id="alg1.l18.m1.4.4.2.2.cmml" xref="alg1.l18.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.2.2.1.cmml" xref="alg1.l18.m1.4.4.2.2">superscript</csymbol><ci id="alg1.l18.m1.4.4.2.2.2.cmml" xref="alg1.l18.m1.4.4.2.2.2">𝑋</ci><ci id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.4c">i,\,w_{\mathrm{g}},\,X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.4d">italic_i , italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT , italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>     <math alttext="P^{(i)}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}-X^{(i)\top}\bigr{)}" class="ltx_Math" display="inline" id="alg1.l19.m1.4"><semantics id="alg1.l19.m1.4a"><mrow id="alg1.l19.m1.4.4" xref="alg1.l19.m1.4.4.cmml"><msup id="alg1.l19.m1.4.4.3" xref="alg1.l19.m1.4.4.3.cmml"><mi id="alg1.l19.m1.4.4.3.2" xref="alg1.l19.m1.4.4.3.2.cmml">P</mi><mrow id="alg1.l19.m1.1.1.1.3" xref="alg1.l19.m1.4.4.3.cmml"><mo id="alg1.l19.m1.1.1.1.3.1" stretchy="false" xref="alg1.l19.m1.4.4.3.cmml">(</mo><mi id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l19.m1.1.1.1.3.2" stretchy="false" xref="alg1.l19.m1.4.4.3.cmml">)</mo></mrow></msup><mo id="alg1.l19.m1.4.4.2" stretchy="false" xref="alg1.l19.m1.4.4.2.cmml">←</mo><mrow id="alg1.l19.m1.4.4.1" xref="alg1.l19.m1.4.4.1.cmml"><mfrac id="alg1.l19.m1.4.4.1.3" xref="alg1.l19.m1.4.4.1.3.cmml"><mn id="alg1.l19.m1.4.4.1.3.2" xref="alg1.l19.m1.4.4.1.3.2.cmml">1</mn><mn id="alg1.l19.m1.4.4.1.3.3" xref="alg1.l19.m1.4.4.1.3.3.cmml">2</mn></mfrac><mo id="alg1.l19.m1.4.4.1.2" xref="alg1.l19.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l19.m1.4.4.1.1.1" xref="alg1.l19.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l19.m1.4.4.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l19.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l19.m1.4.4.1.1.1.1" xref="alg1.l19.m1.4.4.1.1.1.1.cmml"><msup id="alg1.l19.m1.4.4.1.1.1.1.2" xref="alg1.l19.m1.4.4.1.1.1.1.2.cmml"><mi id="alg1.l19.m1.4.4.1.1.1.1.2.2" xref="alg1.l19.m1.4.4.1.1.1.1.2.2.cmml">X</mi><mrow id="alg1.l19.m1.2.2.1.3" xref="alg1.l19.m1.4.4.1.1.1.1.2.cmml"><mo id="alg1.l19.m1.2.2.1.3.1" stretchy="false" xref="alg1.l19.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="alg1.l19.m1.2.2.1.1" xref="alg1.l19.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l19.m1.2.2.1.3.2" stretchy="false" xref="alg1.l19.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="alg1.l19.m1.4.4.1.1.1.1.1" xref="alg1.l19.m1.4.4.1.1.1.1.1.cmml">−</mo><msup id="alg1.l19.m1.4.4.1.1.1.1.3" xref="alg1.l19.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l19.m1.4.4.1.1.1.1.3.2" xref="alg1.l19.m1.4.4.1.1.1.1.3.2.cmml">X</mi><mrow id="alg1.l19.m1.3.3.1" xref="alg1.l19.m1.3.3.1.cmml"><mrow id="alg1.l19.m1.3.3.1.3.2" xref="alg1.l19.m1.3.3.1.cmml"><mo id="alg1.l19.m1.3.3.1.3.2.1" stretchy="false" xref="alg1.l19.m1.3.3.1.cmml">(</mo><mi id="alg1.l19.m1.3.3.1.1" xref="alg1.l19.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l19.m1.3.3.1.3.2.2" stretchy="false" xref="alg1.l19.m1.3.3.1.cmml">)</mo></mrow><mo id="alg1.l19.m1.3.3.1.4" lspace="0.222em" xref="alg1.l19.m1.3.3.1.4.cmml">⊤</mo></mrow></msup></mrow><mo id="alg1.l19.m1.4.4.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l19.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.4b"><apply id="alg1.l19.m1.4.4.cmml" xref="alg1.l19.m1.4.4"><ci id="alg1.l19.m1.4.4.2.cmml" xref="alg1.l19.m1.4.4.2">←</ci><apply id="alg1.l19.m1.4.4.3.cmml" xref="alg1.l19.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.3.1.cmml" xref="alg1.l19.m1.4.4.3">superscript</csymbol><ci id="alg1.l19.m1.4.4.3.2.cmml" xref="alg1.l19.m1.4.4.3.2">𝑃</ci><ci id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1">𝑖</ci></apply><apply id="alg1.l19.m1.4.4.1.cmml" xref="alg1.l19.m1.4.4.1"><times id="alg1.l19.m1.4.4.1.2.cmml" xref="alg1.l19.m1.4.4.1.2"></times><apply id="alg1.l19.m1.4.4.1.3.cmml" xref="alg1.l19.m1.4.4.1.3"><divide id="alg1.l19.m1.4.4.1.3.1.cmml" xref="alg1.l19.m1.4.4.1.3"></divide><cn id="alg1.l19.m1.4.4.1.3.2.cmml" type="integer" xref="alg1.l19.m1.4.4.1.3.2">1</cn><cn id="alg1.l19.m1.4.4.1.3.3.cmml" type="integer" xref="alg1.l19.m1.4.4.1.3.3">2</cn></apply><apply id="alg1.l19.m1.4.4.1.1.1.1.cmml" xref="alg1.l19.m1.4.4.1.1.1"><minus id="alg1.l19.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.1"></minus><apply id="alg1.l19.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="alg1.l19.m1.4.4.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.2.2">𝑋</ci><ci id="alg1.l19.m1.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l19.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="alg1.l19.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l19.m1.4.4.1.1.1.1.3.2">𝑋</ci><apply id="alg1.l19.m1.3.3.1.cmml" xref="alg1.l19.m1.3.3.1"><csymbol cd="latexml" id="alg1.l19.m1.3.3.1.2.cmml" xref="alg1.l19.m1.3.3.1">limit-from</csymbol><ci id="alg1.l19.m1.3.3.1.1.cmml" xref="alg1.l19.m1.3.3.1.1">𝑖</ci><csymbol cd="latexml" id="alg1.l19.m1.3.3.1.4.cmml" xref="alg1.l19.m1.3.3.1.4">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.4c">P^{(i)}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}-X^{(i)\top}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.4d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_X start_POSTSUPERSCRIPT ( italic_i ) ⊤ end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>     <math alttext="w^{(i)}_{\mathrm{l}}\leftarrow(I+P^{(i)})(I-P^{(i)})^{-1}" class="ltx_Math" display="inline" id="alg1.l20.m1.5"><semantics id="alg1.l20.m1.5a"><mrow id="alg1.l20.m1.5.5" xref="alg1.l20.m1.5.5.cmml"><msubsup id="alg1.l20.m1.5.5.4" xref="alg1.l20.m1.5.5.4.cmml"><mi id="alg1.l20.m1.5.5.4.2.2" xref="alg1.l20.m1.5.5.4.2.2.cmml">w</mi><mi id="alg1.l20.m1.5.5.4.3" mathvariant="normal" xref="alg1.l20.m1.5.5.4.3.cmml">l</mi><mrow id="alg1.l20.m1.1.1.1.3" xref="alg1.l20.m1.5.5.4.cmml"><mo id="alg1.l20.m1.1.1.1.3.1" stretchy="false" xref="alg1.l20.m1.5.5.4.cmml">(</mo><mi id="alg1.l20.m1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l20.m1.1.1.1.3.2" stretchy="false" xref="alg1.l20.m1.5.5.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l20.m1.5.5.3" stretchy="false" xref="alg1.l20.m1.5.5.3.cmml">←</mo><mrow id="alg1.l20.m1.5.5.2" xref="alg1.l20.m1.5.5.2.cmml"><mrow id="alg1.l20.m1.4.4.1.1.1" xref="alg1.l20.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l20.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l20.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l20.m1.4.4.1.1.1.1" xref="alg1.l20.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l20.m1.4.4.1.1.1.1.2" xref="alg1.l20.m1.4.4.1.1.1.1.2.cmml">I</mi><mo id="alg1.l20.m1.4.4.1.1.1.1.1" xref="alg1.l20.m1.4.4.1.1.1.1.1.cmml">+</mo><msup id="alg1.l20.m1.4.4.1.1.1.1.3" xref="alg1.l20.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l20.m1.4.4.1.1.1.1.3.2" xref="alg1.l20.m1.4.4.1.1.1.1.3.2.cmml">P</mi><mrow id="alg1.l20.m1.2.2.1.3" xref="alg1.l20.m1.4.4.1.1.1.1.3.cmml"><mo id="alg1.l20.m1.2.2.1.3.1" stretchy="false" xref="alg1.l20.m1.4.4.1.1.1.1.3.cmml">(</mo><mi id="alg1.l20.m1.2.2.1.1" xref="alg1.l20.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l20.m1.2.2.1.3.2" stretchy="false" xref="alg1.l20.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l20.m1.4.4.1.1.1.3" stretchy="false" xref="alg1.l20.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l20.m1.5.5.2.3" xref="alg1.l20.m1.5.5.2.3.cmml">⁢</mo><msup id="alg1.l20.m1.5.5.2.2" xref="alg1.l20.m1.5.5.2.2.cmml"><mrow id="alg1.l20.m1.5.5.2.2.1.1" xref="alg1.l20.m1.5.5.2.2.1.1.1.cmml"><mo id="alg1.l20.m1.5.5.2.2.1.1.2" stretchy="false" xref="alg1.l20.m1.5.5.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l20.m1.5.5.2.2.1.1.1" xref="alg1.l20.m1.5.5.2.2.1.1.1.cmml"><mi id="alg1.l20.m1.5.5.2.2.1.1.1.2" xref="alg1.l20.m1.5.5.2.2.1.1.1.2.cmml">I</mi><mo id="alg1.l20.m1.5.5.2.2.1.1.1.1" xref="alg1.l20.m1.5.5.2.2.1.1.1.1.cmml">−</mo><msup id="alg1.l20.m1.5.5.2.2.1.1.1.3" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.cmml"><mi id="alg1.l20.m1.5.5.2.2.1.1.1.3.2" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.2.cmml">P</mi><mrow id="alg1.l20.m1.3.3.1.3" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.cmml"><mo id="alg1.l20.m1.3.3.1.3.1" stretchy="false" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="alg1.l20.m1.3.3.1.1" xref="alg1.l20.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l20.m1.3.3.1.3.2" stretchy="false" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l20.m1.5.5.2.2.1.1.3" stretchy="false" xref="alg1.l20.m1.5.5.2.2.1.1.1.cmml">)</mo></mrow><mrow id="alg1.l20.m1.5.5.2.2.3" xref="alg1.l20.m1.5.5.2.2.3.cmml"><mo id="alg1.l20.m1.5.5.2.2.3a" xref="alg1.l20.m1.5.5.2.2.3.cmml">−</mo><mn id="alg1.l20.m1.5.5.2.2.3.2" xref="alg1.l20.m1.5.5.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.5b"><apply id="alg1.l20.m1.5.5.cmml" xref="alg1.l20.m1.5.5"><ci id="alg1.l20.m1.5.5.3.cmml" xref="alg1.l20.m1.5.5.3">←</ci><apply id="alg1.l20.m1.5.5.4.cmml" xref="alg1.l20.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.4.1.cmml" xref="alg1.l20.m1.5.5.4">subscript</csymbol><apply id="alg1.l20.m1.5.5.4.2.cmml" xref="alg1.l20.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.4.2.1.cmml" xref="alg1.l20.m1.5.5.4">superscript</csymbol><ci id="alg1.l20.m1.5.5.4.2.2.cmml" xref="alg1.l20.m1.5.5.4.2.2">𝑤</ci><ci id="alg1.l20.m1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1">𝑖</ci></apply><ci id="alg1.l20.m1.5.5.4.3.cmml" xref="alg1.l20.m1.5.5.4.3">l</ci></apply><apply id="alg1.l20.m1.5.5.2.cmml" xref="alg1.l20.m1.5.5.2"><times id="alg1.l20.m1.5.5.2.3.cmml" xref="alg1.l20.m1.5.5.2.3"></times><apply id="alg1.l20.m1.4.4.1.1.1.1.cmml" xref="alg1.l20.m1.4.4.1.1.1"><plus id="alg1.l20.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l20.m1.4.4.1.1.1.1.1"></plus><ci id="alg1.l20.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l20.m1.4.4.1.1.1.1.2">𝐼</ci><apply id="alg1.l20.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l20.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l20.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="alg1.l20.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l20.m1.4.4.1.1.1.1.3.2">𝑃</ci><ci id="alg1.l20.m1.2.2.1.1.cmml" xref="alg1.l20.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="alg1.l20.m1.5.5.2.2.cmml" xref="alg1.l20.m1.5.5.2.2"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.2.2.2.cmml" xref="alg1.l20.m1.5.5.2.2">superscript</csymbol><apply id="alg1.l20.m1.5.5.2.2.1.1.1.cmml" xref="alg1.l20.m1.5.5.2.2.1.1"><minus id="alg1.l20.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l20.m1.5.5.2.2.1.1.1.1"></minus><ci id="alg1.l20.m1.5.5.2.2.1.1.1.2.cmml" xref="alg1.l20.m1.5.5.2.2.1.1.1.2">𝐼</ci><apply id="alg1.l20.m1.5.5.2.2.1.1.1.3.cmml" xref="alg1.l20.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.2.2.1.1.1.3.1.cmml" xref="alg1.l20.m1.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="alg1.l20.m1.5.5.2.2.1.1.1.3.2.cmml" xref="alg1.l20.m1.5.5.2.2.1.1.1.3.2">𝑃</ci><ci id="alg1.l20.m1.3.3.1.1.cmml" xref="alg1.l20.m1.3.3.1.1">𝑖</ci></apply></apply><apply id="alg1.l20.m1.5.5.2.2.3.cmml" xref="alg1.l20.m1.5.5.2.2.3"><minus id="alg1.l20.m1.5.5.2.2.3.1.cmml" xref="alg1.l20.m1.5.5.2.2.3"></minus><cn id="alg1.l20.m1.5.5.2.2.3.2.cmml" type="integer" xref="alg1.l20.m1.5.5.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.5c">w^{(i)}_{\mathrm{l}}\leftarrow(I+P^{(i)})(I-P^{(i)})^{-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.5d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT ← ( italic_I + italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l21.2">for</span> epoch <math alttext="e=1" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">e</mi><mo id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">=</mo><mn id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><eq id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></eq><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑒</ci><cn id="alg1.l21.m1.1.1.3.cmml" type="integer" xref="alg1.l21.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">e=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_e = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l21.3">to</span> <math alttext="E" class="ltx_Math" display="inline" id="alg1.l21.m2.1"><semantics id="alg1.l21.m2.1a"><mi id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><ci id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.1d">italic_E</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l21.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l22.2">for all</span> mini-batch <math alttext="B\subset D^{(i)}" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.2" xref="alg1.l22.m1.1.2.cmml"><mi id="alg1.l22.m1.1.2.2" xref="alg1.l22.m1.1.2.2.cmml">B</mi><mo id="alg1.l22.m1.1.2.1" xref="alg1.l22.m1.1.2.1.cmml">⊂</mo><msup id="alg1.l22.m1.1.2.3" xref="alg1.l22.m1.1.2.3.cmml"><mi id="alg1.l22.m1.1.2.3.2" xref="alg1.l22.m1.1.2.3.2.cmml">D</mi><mrow id="alg1.l22.m1.1.1.1.3" xref="alg1.l22.m1.1.2.3.cmml"><mo id="alg1.l22.m1.1.1.1.3.1" stretchy="false" xref="alg1.l22.m1.1.2.3.cmml">(</mo><mi id="alg1.l22.m1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l22.m1.1.1.1.3.2" stretchy="false" xref="alg1.l22.m1.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.2.cmml" xref="alg1.l22.m1.1.2"><subset id="alg1.l22.m1.1.2.1.cmml" xref="alg1.l22.m1.1.2.1"></subset><ci id="alg1.l22.m1.1.2.2.cmml" xref="alg1.l22.m1.1.2.2">𝐵</ci><apply id="alg1.l22.m1.1.2.3.cmml" xref="alg1.l22.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.2.3.1.cmml" xref="alg1.l22.m1.1.2.3">superscript</csymbol><ci id="alg1.l22.m1.1.2.3.2.cmml" xref="alg1.l22.m1.1.2.3.2">𝐷</ci><ci id="alg1.l22.m1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">B\subset D^{(i)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">italic_B ⊂ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l22.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>              <math alttext="w^{(i)}_{\mathrm{g}}\!\leftarrow w^{(i)}_{\mathrm{g}}-\eta\,\nabla_{w^{(i)}_{%
\mathrm{g}}}\ell^{(i)}(w^{(i)}_{\mathrm{g}},\,w^{(i)}_{\mathrm{l}};B)" class="ltx_Math" display="inline" id="alg1.l23.m1.9"><semantics id="alg1.l23.m1.9a"><mrow id="alg1.l23.m1.9.9" xref="alg1.l23.m1.9.9.cmml"><msubsup id="alg1.l23.m1.9.9.4" xref="alg1.l23.m1.9.9.4.cmml"><mi id="alg1.l23.m1.9.9.4.2.2" xref="alg1.l23.m1.9.9.4.2.2.cmml">w</mi><mi id="alg1.l23.m1.9.9.4.3" mathvariant="normal" xref="alg1.l23.m1.9.9.4.3.cmml">g</mi><mrow id="alg1.l23.m1.1.1.1.3" xref="alg1.l23.m1.9.9.4.cmml"><mo id="alg1.l23.m1.1.1.1.3.1" stretchy="false" xref="alg1.l23.m1.9.9.4.cmml">(</mo><mi id="alg1.l23.m1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l23.m1.1.1.1.3.2" stretchy="false" xref="alg1.l23.m1.9.9.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l23.m1.9.9.3" lspace="0.108em" stretchy="false" xref="alg1.l23.m1.9.9.3.cmml">←</mo><mrow id="alg1.l23.m1.9.9.2" xref="alg1.l23.m1.9.9.2.cmml"><msubsup id="alg1.l23.m1.9.9.2.4" xref="alg1.l23.m1.9.9.2.4.cmml"><mi id="alg1.l23.m1.9.9.2.4.2.2" xref="alg1.l23.m1.9.9.2.4.2.2.cmml">w</mi><mi id="alg1.l23.m1.9.9.2.4.3" mathvariant="normal" xref="alg1.l23.m1.9.9.2.4.3.cmml">g</mi><mrow id="alg1.l23.m1.2.2.1.3" xref="alg1.l23.m1.9.9.2.4.cmml"><mo id="alg1.l23.m1.2.2.1.3.1" stretchy="false" xref="alg1.l23.m1.9.9.2.4.cmml">(</mo><mi id="alg1.l23.m1.2.2.1.1" xref="alg1.l23.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l23.m1.2.2.1.3.2" stretchy="false" xref="alg1.l23.m1.9.9.2.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l23.m1.9.9.2.3" xref="alg1.l23.m1.9.9.2.3.cmml">−</mo><mrow id="alg1.l23.m1.9.9.2.2" xref="alg1.l23.m1.9.9.2.2.cmml"><mi id="alg1.l23.m1.9.9.2.2.4" xref="alg1.l23.m1.9.9.2.2.4.cmml">η</mi><mo id="alg1.l23.m1.9.9.2.2.3" lspace="0.337em" xref="alg1.l23.m1.9.9.2.2.3.cmml">⁢</mo><mrow id="alg1.l23.m1.9.9.2.2.5" xref="alg1.l23.m1.9.9.2.2.5.cmml"><msub id="alg1.l23.m1.9.9.2.2.5.1" xref="alg1.l23.m1.9.9.2.2.5.1.cmml"><mo id="alg1.l23.m1.9.9.2.2.5.1.2" rspace="0.167em" xref="alg1.l23.m1.9.9.2.2.5.1.2.cmml">∇</mo><msubsup id="alg1.l23.m1.3.3.1" xref="alg1.l23.m1.3.3.1.cmml"><mi id="alg1.l23.m1.3.3.1.3.2" xref="alg1.l23.m1.3.3.1.3.2.cmml">w</mi><mi id="alg1.l23.m1.3.3.1.4" mathvariant="normal" xref="alg1.l23.m1.3.3.1.4.cmml">g</mi><mrow id="alg1.l23.m1.3.3.1.1.1.3" xref="alg1.l23.m1.3.3.1.cmml"><mo id="alg1.l23.m1.3.3.1.1.1.3.1" stretchy="false" xref="alg1.l23.m1.3.3.1.cmml">(</mo><mi id="alg1.l23.m1.3.3.1.1.1.1" xref="alg1.l23.m1.3.3.1.1.1.1.cmml">i</mi><mo id="alg1.l23.m1.3.3.1.1.1.3.2" stretchy="false" xref="alg1.l23.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="alg1.l23.m1.9.9.2.2.5.2" xref="alg1.l23.m1.9.9.2.2.5.2.cmml"><mi id="alg1.l23.m1.9.9.2.2.5.2.2" mathvariant="normal" xref="alg1.l23.m1.9.9.2.2.5.2.2.cmml">ℓ</mi><mrow id="alg1.l23.m1.4.4.1.3" xref="alg1.l23.m1.9.9.2.2.5.2.cmml"><mo id="alg1.l23.m1.4.4.1.3.1" stretchy="false" xref="alg1.l23.m1.9.9.2.2.5.2.cmml">(</mo><mi id="alg1.l23.m1.4.4.1.1" xref="alg1.l23.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l23.m1.4.4.1.3.2" stretchy="false" xref="alg1.l23.m1.9.9.2.2.5.2.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l23.m1.9.9.2.2.3a" xref="alg1.l23.m1.9.9.2.2.3.cmml">⁢</mo><mrow id="alg1.l23.m1.9.9.2.2.2.2" xref="alg1.l23.m1.9.9.2.2.2.3.cmml"><mo id="alg1.l23.m1.9.9.2.2.2.2.3" stretchy="false" xref="alg1.l23.m1.9.9.2.2.2.3.cmml">(</mo><msubsup id="alg1.l23.m1.8.8.1.1.1.1.1" xref="alg1.l23.m1.8.8.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.8.8.1.1.1.1.1.2.2" xref="alg1.l23.m1.8.8.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l23.m1.8.8.1.1.1.1.1.3" mathvariant="normal" xref="alg1.l23.m1.8.8.1.1.1.1.1.3.cmml">g</mi><mrow id="alg1.l23.m1.5.5.1.3" xref="alg1.l23.m1.8.8.1.1.1.1.1.cmml"><mo id="alg1.l23.m1.5.5.1.3.1" stretchy="false" xref="alg1.l23.m1.8.8.1.1.1.1.1.cmml">(</mo><mi id="alg1.l23.m1.5.5.1.1" xref="alg1.l23.m1.5.5.1.1.cmml">i</mi><mo id="alg1.l23.m1.5.5.1.3.2" stretchy="false" xref="alg1.l23.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l23.m1.9.9.2.2.2.2.4" rspace="0.337em" xref="alg1.l23.m1.9.9.2.2.2.3.cmml">,</mo><msubsup id="alg1.l23.m1.9.9.2.2.2.2.2" xref="alg1.l23.m1.9.9.2.2.2.2.2.cmml"><mi id="alg1.l23.m1.9.9.2.2.2.2.2.2.2" xref="alg1.l23.m1.9.9.2.2.2.2.2.2.2.cmml">w</mi><mi id="alg1.l23.m1.9.9.2.2.2.2.2.3" mathvariant="normal" xref="alg1.l23.m1.9.9.2.2.2.2.2.3.cmml">l</mi><mrow id="alg1.l23.m1.6.6.1.3" xref="alg1.l23.m1.9.9.2.2.2.2.2.cmml"><mo id="alg1.l23.m1.6.6.1.3.1" stretchy="false" xref="alg1.l23.m1.9.9.2.2.2.2.2.cmml">(</mo><mi id="alg1.l23.m1.6.6.1.1" xref="alg1.l23.m1.6.6.1.1.cmml">i</mi><mo id="alg1.l23.m1.6.6.1.3.2" stretchy="false" xref="alg1.l23.m1.9.9.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l23.m1.9.9.2.2.2.2.5" xref="alg1.l23.m1.9.9.2.2.2.3.cmml">;</mo><mi id="alg1.l23.m1.7.7" xref="alg1.l23.m1.7.7.cmml">B</mi><mo id="alg1.l23.m1.9.9.2.2.2.2.6" stretchy="false" xref="alg1.l23.m1.9.9.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.9b"><apply id="alg1.l23.m1.9.9.cmml" xref="alg1.l23.m1.9.9"><ci id="alg1.l23.m1.9.9.3.cmml" xref="alg1.l23.m1.9.9.3">←</ci><apply id="alg1.l23.m1.9.9.4.cmml" xref="alg1.l23.m1.9.9.4"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.4.1.cmml" xref="alg1.l23.m1.9.9.4">subscript</csymbol><apply id="alg1.l23.m1.9.9.4.2.cmml" xref="alg1.l23.m1.9.9.4"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.4.2.1.cmml" xref="alg1.l23.m1.9.9.4">superscript</csymbol><ci id="alg1.l23.m1.9.9.4.2.2.cmml" xref="alg1.l23.m1.9.9.4.2.2">𝑤</ci><ci id="alg1.l23.m1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1">𝑖</ci></apply><ci id="alg1.l23.m1.9.9.4.3.cmml" xref="alg1.l23.m1.9.9.4.3">g</ci></apply><apply id="alg1.l23.m1.9.9.2.cmml" xref="alg1.l23.m1.9.9.2"><minus id="alg1.l23.m1.9.9.2.3.cmml" xref="alg1.l23.m1.9.9.2.3"></minus><apply id="alg1.l23.m1.9.9.2.4.cmml" xref="alg1.l23.m1.9.9.2.4"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.4.1.cmml" xref="alg1.l23.m1.9.9.2.4">subscript</csymbol><apply id="alg1.l23.m1.9.9.2.4.2.cmml" xref="alg1.l23.m1.9.9.2.4"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.4.2.1.cmml" xref="alg1.l23.m1.9.9.2.4">superscript</csymbol><ci id="alg1.l23.m1.9.9.2.4.2.2.cmml" xref="alg1.l23.m1.9.9.2.4.2.2">𝑤</ci><ci id="alg1.l23.m1.2.2.1.1.cmml" xref="alg1.l23.m1.2.2.1.1">𝑖</ci></apply><ci id="alg1.l23.m1.9.9.2.4.3.cmml" xref="alg1.l23.m1.9.9.2.4.3">g</ci></apply><apply id="alg1.l23.m1.9.9.2.2.cmml" xref="alg1.l23.m1.9.9.2.2"><times id="alg1.l23.m1.9.9.2.2.3.cmml" xref="alg1.l23.m1.9.9.2.2.3"></times><ci id="alg1.l23.m1.9.9.2.2.4.cmml" xref="alg1.l23.m1.9.9.2.2.4">𝜂</ci><apply id="alg1.l23.m1.9.9.2.2.5.cmml" xref="alg1.l23.m1.9.9.2.2.5"><apply id="alg1.l23.m1.9.9.2.2.5.1.cmml" xref="alg1.l23.m1.9.9.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.2.5.1.1.cmml" xref="alg1.l23.m1.9.9.2.2.5.1">subscript</csymbol><ci id="alg1.l23.m1.9.9.2.2.5.1.2.cmml" xref="alg1.l23.m1.9.9.2.2.5.1.2">∇</ci><apply id="alg1.l23.m1.3.3.1.cmml" xref="alg1.l23.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l23.m1.3.3.1.2.cmml" xref="alg1.l23.m1.3.3.1">subscript</csymbol><apply id="alg1.l23.m1.3.3.1.3.cmml" xref="alg1.l23.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l23.m1.3.3.1.3.1.cmml" xref="alg1.l23.m1.3.3.1">superscript</csymbol><ci id="alg1.l23.m1.3.3.1.3.2.cmml" xref="alg1.l23.m1.3.3.1.3.2">𝑤</ci><ci id="alg1.l23.m1.3.3.1.1.1.1.cmml" xref="alg1.l23.m1.3.3.1.1.1.1">𝑖</ci></apply><ci id="alg1.l23.m1.3.3.1.4.cmml" xref="alg1.l23.m1.3.3.1.4">g</ci></apply></apply><apply id="alg1.l23.m1.9.9.2.2.5.2.cmml" xref="alg1.l23.m1.9.9.2.2.5.2"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.2.5.2.1.cmml" xref="alg1.l23.m1.9.9.2.2.5.2">superscript</csymbol><ci id="alg1.l23.m1.9.9.2.2.5.2.2.cmml" xref="alg1.l23.m1.9.9.2.2.5.2.2">ℓ</ci><ci id="alg1.l23.m1.4.4.1.1.cmml" xref="alg1.l23.m1.4.4.1.1">𝑖</ci></apply></apply><vector id="alg1.l23.m1.9.9.2.2.2.3.cmml" xref="alg1.l23.m1.9.9.2.2.2.2"><apply id="alg1.l23.m1.8.8.1.1.1.1.1.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.8.8.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1">subscript</csymbol><apply id="alg1.l23.m1.8.8.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.8.8.1.1.1.1.1.2.1.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.8.8.1.1.1.1.1.2.2.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l23.m1.5.5.1.1.cmml" xref="alg1.l23.m1.5.5.1.1">𝑖</ci></apply><ci id="alg1.l23.m1.8.8.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.8.8.1.1.1.1.1.3">g</ci></apply><apply id="alg1.l23.m1.9.9.2.2.2.2.2.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2">subscript</csymbol><apply id="alg1.l23.m1.9.9.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.9.9.2.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2">superscript</csymbol><ci id="alg1.l23.m1.9.9.2.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l23.m1.6.6.1.1.cmml" xref="alg1.l23.m1.6.6.1.1">𝑖</ci></apply><ci id="alg1.l23.m1.9.9.2.2.2.2.2.3.cmml" xref="alg1.l23.m1.9.9.2.2.2.2.2.3">l</ci></apply><ci id="alg1.l23.m1.7.7.cmml" xref="alg1.l23.m1.7.7">𝐵</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.9c">w^{(i)}_{\mathrm{g}}\!\leftarrow w^{(i)}_{\mathrm{g}}-\eta\,\nabla_{w^{(i)}_{%
\mathrm{g}}}\ell^{(i)}(w^{(i)}_{\mathrm{g}},\,w^{(i)}_{\mathrm{l}};B)</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.9d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT ← italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT - italic_η ∇ start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT , italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT ; italic_B )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>              <math alttext="X^{(i)}\leftarrow X^{(i)}-\eta\,\nabla_{X^{(i)}}\ell^{(i)}(w^{(i)}_{\mathrm{g}%
},\,w^{(i)}_{\mathrm{l}};B)" class="ltx_Math" display="inline" id="alg1.l24.m1.9"><semantics id="alg1.l24.m1.9a"><mrow id="alg1.l24.m1.9.9" xref="alg1.l24.m1.9.9.cmml"><msup id="alg1.l24.m1.9.9.4" xref="alg1.l24.m1.9.9.4.cmml"><mi id="alg1.l24.m1.9.9.4.2" xref="alg1.l24.m1.9.9.4.2.cmml">X</mi><mrow id="alg1.l24.m1.1.1.1.3" xref="alg1.l24.m1.9.9.4.cmml"><mo id="alg1.l24.m1.1.1.1.3.1" stretchy="false" xref="alg1.l24.m1.9.9.4.cmml">(</mo><mi id="alg1.l24.m1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l24.m1.1.1.1.3.2" stretchy="false" xref="alg1.l24.m1.9.9.4.cmml">)</mo></mrow></msup><mo id="alg1.l24.m1.9.9.3" stretchy="false" xref="alg1.l24.m1.9.9.3.cmml">←</mo><mrow id="alg1.l24.m1.9.9.2" xref="alg1.l24.m1.9.9.2.cmml"><msup id="alg1.l24.m1.9.9.2.4" xref="alg1.l24.m1.9.9.2.4.cmml"><mi id="alg1.l24.m1.9.9.2.4.2" xref="alg1.l24.m1.9.9.2.4.2.cmml">X</mi><mrow id="alg1.l24.m1.2.2.1.3" xref="alg1.l24.m1.9.9.2.4.cmml"><mo id="alg1.l24.m1.2.2.1.3.1" stretchy="false" xref="alg1.l24.m1.9.9.2.4.cmml">(</mo><mi id="alg1.l24.m1.2.2.1.1" xref="alg1.l24.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l24.m1.2.2.1.3.2" stretchy="false" xref="alg1.l24.m1.9.9.2.4.cmml">)</mo></mrow></msup><mo id="alg1.l24.m1.9.9.2.3" xref="alg1.l24.m1.9.9.2.3.cmml">−</mo><mrow id="alg1.l24.m1.9.9.2.2" xref="alg1.l24.m1.9.9.2.2.cmml"><mi id="alg1.l24.m1.9.9.2.2.4" xref="alg1.l24.m1.9.9.2.2.4.cmml">η</mi><mo id="alg1.l24.m1.9.9.2.2.3" lspace="0.337em" xref="alg1.l24.m1.9.9.2.2.3.cmml">⁢</mo><mrow id="alg1.l24.m1.9.9.2.2.5" xref="alg1.l24.m1.9.9.2.2.5.cmml"><msub id="alg1.l24.m1.9.9.2.2.5.1" xref="alg1.l24.m1.9.9.2.2.5.1.cmml"><mo id="alg1.l24.m1.9.9.2.2.5.1.2" rspace="0.167em" xref="alg1.l24.m1.9.9.2.2.5.1.2.cmml">∇</mo><msup id="alg1.l24.m1.3.3.1" xref="alg1.l24.m1.3.3.1.cmml"><mi id="alg1.l24.m1.3.3.1.3" xref="alg1.l24.m1.3.3.1.3.cmml">X</mi><mrow id="alg1.l24.m1.3.3.1.1.1.3" xref="alg1.l24.m1.3.3.1.cmml"><mo id="alg1.l24.m1.3.3.1.1.1.3.1" stretchy="false" xref="alg1.l24.m1.3.3.1.cmml">(</mo><mi id="alg1.l24.m1.3.3.1.1.1.1" xref="alg1.l24.m1.3.3.1.1.1.1.cmml">i</mi><mo id="alg1.l24.m1.3.3.1.1.1.3.2" stretchy="false" xref="alg1.l24.m1.3.3.1.cmml">)</mo></mrow></msup></msub><msup id="alg1.l24.m1.9.9.2.2.5.2" xref="alg1.l24.m1.9.9.2.2.5.2.cmml"><mi id="alg1.l24.m1.9.9.2.2.5.2.2" mathvariant="normal" xref="alg1.l24.m1.9.9.2.2.5.2.2.cmml">ℓ</mi><mrow id="alg1.l24.m1.4.4.1.3" xref="alg1.l24.m1.9.9.2.2.5.2.cmml"><mo id="alg1.l24.m1.4.4.1.3.1" stretchy="false" xref="alg1.l24.m1.9.9.2.2.5.2.cmml">(</mo><mi id="alg1.l24.m1.4.4.1.1" xref="alg1.l24.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l24.m1.4.4.1.3.2" stretchy="false" xref="alg1.l24.m1.9.9.2.2.5.2.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l24.m1.9.9.2.2.3a" xref="alg1.l24.m1.9.9.2.2.3.cmml">⁢</mo><mrow id="alg1.l24.m1.9.9.2.2.2.2" xref="alg1.l24.m1.9.9.2.2.2.3.cmml"><mo id="alg1.l24.m1.9.9.2.2.2.2.3" stretchy="false" xref="alg1.l24.m1.9.9.2.2.2.3.cmml">(</mo><msubsup id="alg1.l24.m1.8.8.1.1.1.1.1" xref="alg1.l24.m1.8.8.1.1.1.1.1.cmml"><mi id="alg1.l24.m1.8.8.1.1.1.1.1.2.2" xref="alg1.l24.m1.8.8.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l24.m1.8.8.1.1.1.1.1.3" mathvariant="normal" xref="alg1.l24.m1.8.8.1.1.1.1.1.3.cmml">g</mi><mrow id="alg1.l24.m1.5.5.1.3" xref="alg1.l24.m1.8.8.1.1.1.1.1.cmml"><mo id="alg1.l24.m1.5.5.1.3.1" stretchy="false" xref="alg1.l24.m1.8.8.1.1.1.1.1.cmml">(</mo><mi id="alg1.l24.m1.5.5.1.1" xref="alg1.l24.m1.5.5.1.1.cmml">i</mi><mo id="alg1.l24.m1.5.5.1.3.2" stretchy="false" xref="alg1.l24.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l24.m1.9.9.2.2.2.2.4" rspace="0.337em" xref="alg1.l24.m1.9.9.2.2.2.3.cmml">,</mo><msubsup id="alg1.l24.m1.9.9.2.2.2.2.2" xref="alg1.l24.m1.9.9.2.2.2.2.2.cmml"><mi id="alg1.l24.m1.9.9.2.2.2.2.2.2.2" xref="alg1.l24.m1.9.9.2.2.2.2.2.2.2.cmml">w</mi><mi id="alg1.l24.m1.9.9.2.2.2.2.2.3" mathvariant="normal" xref="alg1.l24.m1.9.9.2.2.2.2.2.3.cmml">l</mi><mrow id="alg1.l24.m1.6.6.1.3" xref="alg1.l24.m1.9.9.2.2.2.2.2.cmml"><mo id="alg1.l24.m1.6.6.1.3.1" stretchy="false" xref="alg1.l24.m1.9.9.2.2.2.2.2.cmml">(</mo><mi id="alg1.l24.m1.6.6.1.1" xref="alg1.l24.m1.6.6.1.1.cmml">i</mi><mo id="alg1.l24.m1.6.6.1.3.2" stretchy="false" xref="alg1.l24.m1.9.9.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l24.m1.9.9.2.2.2.2.5" xref="alg1.l24.m1.9.9.2.2.2.3.cmml">;</mo><mi id="alg1.l24.m1.7.7" xref="alg1.l24.m1.7.7.cmml">B</mi><mo id="alg1.l24.m1.9.9.2.2.2.2.6" stretchy="false" xref="alg1.l24.m1.9.9.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.9b"><apply id="alg1.l24.m1.9.9.cmml" xref="alg1.l24.m1.9.9"><ci id="alg1.l24.m1.9.9.3.cmml" xref="alg1.l24.m1.9.9.3">←</ci><apply id="alg1.l24.m1.9.9.4.cmml" xref="alg1.l24.m1.9.9.4"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.4.1.cmml" xref="alg1.l24.m1.9.9.4">superscript</csymbol><ci id="alg1.l24.m1.9.9.4.2.cmml" xref="alg1.l24.m1.9.9.4.2">𝑋</ci><ci id="alg1.l24.m1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1">𝑖</ci></apply><apply id="alg1.l24.m1.9.9.2.cmml" xref="alg1.l24.m1.9.9.2"><minus id="alg1.l24.m1.9.9.2.3.cmml" xref="alg1.l24.m1.9.9.2.3"></minus><apply id="alg1.l24.m1.9.9.2.4.cmml" xref="alg1.l24.m1.9.9.2.4"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.2.4.1.cmml" xref="alg1.l24.m1.9.9.2.4">superscript</csymbol><ci id="alg1.l24.m1.9.9.2.4.2.cmml" xref="alg1.l24.m1.9.9.2.4.2">𝑋</ci><ci id="alg1.l24.m1.2.2.1.1.cmml" xref="alg1.l24.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l24.m1.9.9.2.2.cmml" xref="alg1.l24.m1.9.9.2.2"><times id="alg1.l24.m1.9.9.2.2.3.cmml" xref="alg1.l24.m1.9.9.2.2.3"></times><ci id="alg1.l24.m1.9.9.2.2.4.cmml" xref="alg1.l24.m1.9.9.2.2.4">𝜂</ci><apply id="alg1.l24.m1.9.9.2.2.5.cmml" xref="alg1.l24.m1.9.9.2.2.5"><apply id="alg1.l24.m1.9.9.2.2.5.1.cmml" xref="alg1.l24.m1.9.9.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.2.2.5.1.1.cmml" xref="alg1.l24.m1.9.9.2.2.5.1">subscript</csymbol><ci id="alg1.l24.m1.9.9.2.2.5.1.2.cmml" xref="alg1.l24.m1.9.9.2.2.5.1.2">∇</ci><apply id="alg1.l24.m1.3.3.1.cmml" xref="alg1.l24.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l24.m1.3.3.1.2.cmml" xref="alg1.l24.m1.3.3.1">superscript</csymbol><ci id="alg1.l24.m1.3.3.1.3.cmml" xref="alg1.l24.m1.3.3.1.3">𝑋</ci><ci id="alg1.l24.m1.3.3.1.1.1.1.cmml" xref="alg1.l24.m1.3.3.1.1.1.1">𝑖</ci></apply></apply><apply id="alg1.l24.m1.9.9.2.2.5.2.cmml" xref="alg1.l24.m1.9.9.2.2.5.2"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.2.2.5.2.1.cmml" xref="alg1.l24.m1.9.9.2.2.5.2">superscript</csymbol><ci id="alg1.l24.m1.9.9.2.2.5.2.2.cmml" xref="alg1.l24.m1.9.9.2.2.5.2.2">ℓ</ci><ci id="alg1.l24.m1.4.4.1.1.cmml" xref="alg1.l24.m1.4.4.1.1">𝑖</ci></apply></apply><vector id="alg1.l24.m1.9.9.2.2.2.3.cmml" xref="alg1.l24.m1.9.9.2.2.2.2"><apply id="alg1.l24.m1.8.8.1.1.1.1.1.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.8.8.1.1.1.1.1.1.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1">subscript</csymbol><apply id="alg1.l24.m1.8.8.1.1.1.1.1.2.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.8.8.1.1.1.1.1.2.1.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1">superscript</csymbol><ci id="alg1.l24.m1.8.8.1.1.1.1.1.2.2.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l24.m1.5.5.1.1.cmml" xref="alg1.l24.m1.5.5.1.1">𝑖</ci></apply><ci id="alg1.l24.m1.8.8.1.1.1.1.1.3.cmml" xref="alg1.l24.m1.8.8.1.1.1.1.1.3">g</ci></apply><apply id="alg1.l24.m1.9.9.2.2.2.2.2.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.2.2.2.2.2.1.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2">subscript</csymbol><apply id="alg1.l24.m1.9.9.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.9.9.2.2.2.2.2.2.1.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2">superscript</csymbol><ci id="alg1.l24.m1.9.9.2.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l24.m1.6.6.1.1.cmml" xref="alg1.l24.m1.6.6.1.1">𝑖</ci></apply><ci id="alg1.l24.m1.9.9.2.2.2.2.2.3.cmml" xref="alg1.l24.m1.9.9.2.2.2.2.2.3">l</ci></apply><ci id="alg1.l24.m1.7.7.cmml" xref="alg1.l24.m1.7.7">𝐵</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.9c">X^{(i)}\leftarrow X^{(i)}-\eta\,\nabla_{X^{(i)}}\ell^{(i)}(w^{(i)}_{\mathrm{g}%
},\,w^{(i)}_{\mathrm{l}};B)</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.9d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_η ∇ start_POSTSUBSCRIPT italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT , italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT ; italic_B )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span>              <math alttext="P^{(i)}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}-X^{(i)\top}\bigr{)}" class="ltx_Math" display="inline" id="alg1.l25.m1.4"><semantics id="alg1.l25.m1.4a"><mrow id="alg1.l25.m1.4.4" xref="alg1.l25.m1.4.4.cmml"><msup id="alg1.l25.m1.4.4.3" xref="alg1.l25.m1.4.4.3.cmml"><mi id="alg1.l25.m1.4.4.3.2" xref="alg1.l25.m1.4.4.3.2.cmml">P</mi><mrow id="alg1.l25.m1.1.1.1.3" xref="alg1.l25.m1.4.4.3.cmml"><mo id="alg1.l25.m1.1.1.1.3.1" stretchy="false" xref="alg1.l25.m1.4.4.3.cmml">(</mo><mi id="alg1.l25.m1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l25.m1.1.1.1.3.2" stretchy="false" xref="alg1.l25.m1.4.4.3.cmml">)</mo></mrow></msup><mo id="alg1.l25.m1.4.4.2" stretchy="false" xref="alg1.l25.m1.4.4.2.cmml">←</mo><mrow id="alg1.l25.m1.4.4.1" xref="alg1.l25.m1.4.4.1.cmml"><mfrac id="alg1.l25.m1.4.4.1.3" xref="alg1.l25.m1.4.4.1.3.cmml"><mn id="alg1.l25.m1.4.4.1.3.2" xref="alg1.l25.m1.4.4.1.3.2.cmml">1</mn><mn id="alg1.l25.m1.4.4.1.3.3" xref="alg1.l25.m1.4.4.1.3.3.cmml">2</mn></mfrac><mo id="alg1.l25.m1.4.4.1.2" xref="alg1.l25.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l25.m1.4.4.1.1.1" xref="alg1.l25.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l25.m1.4.4.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l25.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l25.m1.4.4.1.1.1.1" xref="alg1.l25.m1.4.4.1.1.1.1.cmml"><msup id="alg1.l25.m1.4.4.1.1.1.1.2" xref="alg1.l25.m1.4.4.1.1.1.1.2.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.2.2" xref="alg1.l25.m1.4.4.1.1.1.1.2.2.cmml">X</mi><mrow id="alg1.l25.m1.2.2.1.3" xref="alg1.l25.m1.4.4.1.1.1.1.2.cmml"><mo id="alg1.l25.m1.2.2.1.3.1" stretchy="false" xref="alg1.l25.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="alg1.l25.m1.2.2.1.1" xref="alg1.l25.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l25.m1.2.2.1.3.2" stretchy="false" xref="alg1.l25.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="alg1.l25.m1.4.4.1.1.1.1.1" xref="alg1.l25.m1.4.4.1.1.1.1.1.cmml">−</mo><msup id="alg1.l25.m1.4.4.1.1.1.1.3" xref="alg1.l25.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.3.2" xref="alg1.l25.m1.4.4.1.1.1.1.3.2.cmml">X</mi><mrow id="alg1.l25.m1.3.3.1" xref="alg1.l25.m1.3.3.1.cmml"><mrow id="alg1.l25.m1.3.3.1.3.2" xref="alg1.l25.m1.3.3.1.cmml"><mo id="alg1.l25.m1.3.3.1.3.2.1" stretchy="false" xref="alg1.l25.m1.3.3.1.cmml">(</mo><mi id="alg1.l25.m1.3.3.1.1" xref="alg1.l25.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l25.m1.3.3.1.3.2.2" stretchy="false" xref="alg1.l25.m1.3.3.1.cmml">)</mo></mrow><mo id="alg1.l25.m1.3.3.1.4" lspace="0.222em" xref="alg1.l25.m1.3.3.1.4.cmml">⊤</mo></mrow></msup></mrow><mo id="alg1.l25.m1.4.4.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l25.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.4b"><apply id="alg1.l25.m1.4.4.cmml" xref="alg1.l25.m1.4.4"><ci id="alg1.l25.m1.4.4.2.cmml" xref="alg1.l25.m1.4.4.2">←</ci><apply id="alg1.l25.m1.4.4.3.cmml" xref="alg1.l25.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.3.1.cmml" xref="alg1.l25.m1.4.4.3">superscript</csymbol><ci id="alg1.l25.m1.4.4.3.2.cmml" xref="alg1.l25.m1.4.4.3.2">𝑃</ci><ci id="alg1.l25.m1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1">𝑖</ci></apply><apply id="alg1.l25.m1.4.4.1.cmml" xref="alg1.l25.m1.4.4.1"><times id="alg1.l25.m1.4.4.1.2.cmml" xref="alg1.l25.m1.4.4.1.2"></times><apply id="alg1.l25.m1.4.4.1.3.cmml" xref="alg1.l25.m1.4.4.1.3"><divide id="alg1.l25.m1.4.4.1.3.1.cmml" xref="alg1.l25.m1.4.4.1.3"></divide><cn id="alg1.l25.m1.4.4.1.3.2.cmml" type="integer" xref="alg1.l25.m1.4.4.1.3.2">1</cn><cn id="alg1.l25.m1.4.4.1.3.3.cmml" type="integer" xref="alg1.l25.m1.4.4.1.3.3">2</cn></apply><apply id="alg1.l25.m1.4.4.1.1.1.1.cmml" xref="alg1.l25.m1.4.4.1.1.1"><minus id="alg1.l25.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1"></minus><apply id="alg1.l25.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.2.2">𝑋</ci><ci id="alg1.l25.m1.2.2.1.1.cmml" xref="alg1.l25.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l25.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.3.2">𝑋</ci><apply id="alg1.l25.m1.3.3.1.cmml" xref="alg1.l25.m1.3.3.1"><csymbol cd="latexml" id="alg1.l25.m1.3.3.1.2.cmml" xref="alg1.l25.m1.3.3.1">limit-from</csymbol><ci id="alg1.l25.m1.3.3.1.1.cmml" xref="alg1.l25.m1.3.3.1.1">𝑖</ci><csymbol cd="latexml" id="alg1.l25.m1.3.3.1.4.cmml" xref="alg1.l25.m1.3.3.1.4">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.4c">P^{(i)}\leftarrow\tfrac{1}{2}\!\bigl{(}X^{(i)}-X^{(i)\top}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.4d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ← divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_X start_POSTSUPERSCRIPT ( italic_i ) ⊤ end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l26.2.1.1" style="font-size:80%;">26:</span></span>              <math alttext="w^{(i)}_{\mathrm{l}}\leftarrow(I+P^{(i)})(I-P^{(i)})^{-1}" class="ltx_Math" display="inline" id="alg1.l26.m1.5"><semantics id="alg1.l26.m1.5a"><mrow id="alg1.l26.m1.5.5" xref="alg1.l26.m1.5.5.cmml"><msubsup id="alg1.l26.m1.5.5.4" xref="alg1.l26.m1.5.5.4.cmml"><mi id="alg1.l26.m1.5.5.4.2.2" xref="alg1.l26.m1.5.5.4.2.2.cmml">w</mi><mi id="alg1.l26.m1.5.5.4.3" mathvariant="normal" xref="alg1.l26.m1.5.5.4.3.cmml">l</mi><mrow id="alg1.l26.m1.1.1.1.3" xref="alg1.l26.m1.5.5.4.cmml"><mo id="alg1.l26.m1.1.1.1.3.1" stretchy="false" xref="alg1.l26.m1.5.5.4.cmml">(</mo><mi id="alg1.l26.m1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l26.m1.1.1.1.3.2" stretchy="false" xref="alg1.l26.m1.5.5.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l26.m1.5.5.3" stretchy="false" xref="alg1.l26.m1.5.5.3.cmml">←</mo><mrow id="alg1.l26.m1.5.5.2" xref="alg1.l26.m1.5.5.2.cmml"><mrow id="alg1.l26.m1.4.4.1.1.1" xref="alg1.l26.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l26.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l26.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l26.m1.4.4.1.1.1.1" xref="alg1.l26.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l26.m1.4.4.1.1.1.1.2" xref="alg1.l26.m1.4.4.1.1.1.1.2.cmml">I</mi><mo id="alg1.l26.m1.4.4.1.1.1.1.1" xref="alg1.l26.m1.4.4.1.1.1.1.1.cmml">+</mo><msup id="alg1.l26.m1.4.4.1.1.1.1.3" xref="alg1.l26.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l26.m1.4.4.1.1.1.1.3.2" xref="alg1.l26.m1.4.4.1.1.1.1.3.2.cmml">P</mi><mrow id="alg1.l26.m1.2.2.1.3" xref="alg1.l26.m1.4.4.1.1.1.1.3.cmml"><mo id="alg1.l26.m1.2.2.1.3.1" stretchy="false" xref="alg1.l26.m1.4.4.1.1.1.1.3.cmml">(</mo><mi id="alg1.l26.m1.2.2.1.1" xref="alg1.l26.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l26.m1.2.2.1.3.2" stretchy="false" xref="alg1.l26.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l26.m1.4.4.1.1.1.3" stretchy="false" xref="alg1.l26.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l26.m1.5.5.2.3" xref="alg1.l26.m1.5.5.2.3.cmml">⁢</mo><msup id="alg1.l26.m1.5.5.2.2" xref="alg1.l26.m1.5.5.2.2.cmml"><mrow id="alg1.l26.m1.5.5.2.2.1.1" xref="alg1.l26.m1.5.5.2.2.1.1.1.cmml"><mo id="alg1.l26.m1.5.5.2.2.1.1.2" stretchy="false" xref="alg1.l26.m1.5.5.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l26.m1.5.5.2.2.1.1.1" xref="alg1.l26.m1.5.5.2.2.1.1.1.cmml"><mi id="alg1.l26.m1.5.5.2.2.1.1.1.2" xref="alg1.l26.m1.5.5.2.2.1.1.1.2.cmml">I</mi><mo id="alg1.l26.m1.5.5.2.2.1.1.1.1" xref="alg1.l26.m1.5.5.2.2.1.1.1.1.cmml">−</mo><msup id="alg1.l26.m1.5.5.2.2.1.1.1.3" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.cmml"><mi id="alg1.l26.m1.5.5.2.2.1.1.1.3.2" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.2.cmml">P</mi><mrow id="alg1.l26.m1.3.3.1.3" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.cmml"><mo id="alg1.l26.m1.3.3.1.3.1" stretchy="false" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="alg1.l26.m1.3.3.1.1" xref="alg1.l26.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l26.m1.3.3.1.3.2" stretchy="false" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="alg1.l26.m1.5.5.2.2.1.1.3" stretchy="false" xref="alg1.l26.m1.5.5.2.2.1.1.1.cmml">)</mo></mrow><mrow id="alg1.l26.m1.5.5.2.2.3" xref="alg1.l26.m1.5.5.2.2.3.cmml"><mo id="alg1.l26.m1.5.5.2.2.3a" xref="alg1.l26.m1.5.5.2.2.3.cmml">−</mo><mn id="alg1.l26.m1.5.5.2.2.3.2" xref="alg1.l26.m1.5.5.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.5b"><apply id="alg1.l26.m1.5.5.cmml" xref="alg1.l26.m1.5.5"><ci id="alg1.l26.m1.5.5.3.cmml" xref="alg1.l26.m1.5.5.3">←</ci><apply id="alg1.l26.m1.5.5.4.cmml" xref="alg1.l26.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l26.m1.5.5.4.1.cmml" xref="alg1.l26.m1.5.5.4">subscript</csymbol><apply id="alg1.l26.m1.5.5.4.2.cmml" xref="alg1.l26.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l26.m1.5.5.4.2.1.cmml" xref="alg1.l26.m1.5.5.4">superscript</csymbol><ci id="alg1.l26.m1.5.5.4.2.2.cmml" xref="alg1.l26.m1.5.5.4.2.2">𝑤</ci><ci id="alg1.l26.m1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1">𝑖</ci></apply><ci id="alg1.l26.m1.5.5.4.3.cmml" xref="alg1.l26.m1.5.5.4.3">l</ci></apply><apply id="alg1.l26.m1.5.5.2.cmml" xref="alg1.l26.m1.5.5.2"><times id="alg1.l26.m1.5.5.2.3.cmml" xref="alg1.l26.m1.5.5.2.3"></times><apply id="alg1.l26.m1.4.4.1.1.1.1.cmml" xref="alg1.l26.m1.4.4.1.1.1"><plus id="alg1.l26.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l26.m1.4.4.1.1.1.1.1"></plus><ci id="alg1.l26.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l26.m1.4.4.1.1.1.1.2">𝐼</ci><apply id="alg1.l26.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l26.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l26.m1.4.4.1.1.1.1.3">superscript</csymbol><ci id="alg1.l26.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l26.m1.4.4.1.1.1.1.3.2">𝑃</ci><ci id="alg1.l26.m1.2.2.1.1.cmml" xref="alg1.l26.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="alg1.l26.m1.5.5.2.2.cmml" xref="alg1.l26.m1.5.5.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.5.5.2.2.2.cmml" xref="alg1.l26.m1.5.5.2.2">superscript</csymbol><apply id="alg1.l26.m1.5.5.2.2.1.1.1.cmml" xref="alg1.l26.m1.5.5.2.2.1.1"><minus id="alg1.l26.m1.5.5.2.2.1.1.1.1.cmml" xref="alg1.l26.m1.5.5.2.2.1.1.1.1"></minus><ci id="alg1.l26.m1.5.5.2.2.1.1.1.2.cmml" xref="alg1.l26.m1.5.5.2.2.1.1.1.2">𝐼</ci><apply id="alg1.l26.m1.5.5.2.2.1.1.1.3.cmml" xref="alg1.l26.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26.m1.5.5.2.2.1.1.1.3.1.cmml" xref="alg1.l26.m1.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="alg1.l26.m1.5.5.2.2.1.1.1.3.2.cmml" xref="alg1.l26.m1.5.5.2.2.1.1.1.3.2">𝑃</ci><ci id="alg1.l26.m1.3.3.1.1.cmml" xref="alg1.l26.m1.3.3.1.1">𝑖</ci></apply></apply><apply id="alg1.l26.m1.5.5.2.2.3.cmml" xref="alg1.l26.m1.5.5.2.2.3"><minus id="alg1.l26.m1.5.5.2.2.3.1.cmml" xref="alg1.l26.m1.5.5.2.2.3"></minus><cn id="alg1.l26.m1.5.5.2.2.3.2.cmml" type="integer" xref="alg1.l26.m1.5.5.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.5c">w^{(i)}_{\mathrm{l}}\leftarrow(I+P^{(i)})(I-P^{(i)})^{-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.5d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT ← ( italic_I + italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l26.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l26.1.m1.1"><semantics id="alg1.l26.1.m1.1a"><mo id="alg1.l26.1.m1.1.1" xref="alg1.l26.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l26.1.m1.1b"><ci id="alg1.l26.1.m1.1.1.cmml" xref="alg1.l26.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.1.m1.1d">▷</annotation></semantics></math> Cayley transform
</span>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">27:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l27.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l27.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">28:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l28.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l28.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l29.3.1.1" style="font-size:80%;">29:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l29.4">return</span> <math alttext="(w^{(i)}_{\mathrm{g}},\,X^{(i)})" class="ltx_Math" display="inline" id="alg1.l29.m1.4"><semantics id="alg1.l29.m1.4a"><mrow id="alg1.l29.m1.4.4.2" xref="alg1.l29.m1.4.4.3.cmml"><mo id="alg1.l29.m1.4.4.2.3" stretchy="false" xref="alg1.l29.m1.4.4.3.cmml">(</mo><msubsup id="alg1.l29.m1.3.3.1.1" xref="alg1.l29.m1.3.3.1.1.cmml"><mi id="alg1.l29.m1.3.3.1.1.2.2" xref="alg1.l29.m1.3.3.1.1.2.2.cmml">w</mi><mi id="alg1.l29.m1.3.3.1.1.3" mathvariant="normal" xref="alg1.l29.m1.3.3.1.1.3.cmml">g</mi><mrow id="alg1.l29.m1.1.1.1.3" xref="alg1.l29.m1.3.3.1.1.cmml"><mo id="alg1.l29.m1.1.1.1.3.1" stretchy="false" xref="alg1.l29.m1.3.3.1.1.cmml">(</mo><mi id="alg1.l29.m1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l29.m1.1.1.1.3.2" stretchy="false" xref="alg1.l29.m1.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l29.m1.4.4.2.4" rspace="0.337em" xref="alg1.l29.m1.4.4.3.cmml">,</mo><msup id="alg1.l29.m1.4.4.2.2" xref="alg1.l29.m1.4.4.2.2.cmml"><mi id="alg1.l29.m1.4.4.2.2.2" xref="alg1.l29.m1.4.4.2.2.2.cmml">X</mi><mrow id="alg1.l29.m1.2.2.1.3" xref="alg1.l29.m1.4.4.2.2.cmml"><mo id="alg1.l29.m1.2.2.1.3.1" stretchy="false" xref="alg1.l29.m1.4.4.2.2.cmml">(</mo><mi id="alg1.l29.m1.2.2.1.1" xref="alg1.l29.m1.2.2.1.1.cmml">i</mi><mo id="alg1.l29.m1.2.2.1.3.2" stretchy="false" xref="alg1.l29.m1.4.4.2.2.cmml">)</mo></mrow></msup><mo id="alg1.l29.m1.4.4.2.5" stretchy="false" xref="alg1.l29.m1.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.4b"><interval closure="open" id="alg1.l29.m1.4.4.3.cmml" xref="alg1.l29.m1.4.4.2"><apply id="alg1.l29.m1.3.3.1.1.cmml" xref="alg1.l29.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.3.3.1.1.1.cmml" xref="alg1.l29.m1.3.3.1.1">subscript</csymbol><apply id="alg1.l29.m1.3.3.1.1.2.cmml" xref="alg1.l29.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.3.3.1.1.2.1.cmml" xref="alg1.l29.m1.3.3.1.1">superscript</csymbol><ci id="alg1.l29.m1.3.3.1.1.2.2.cmml" xref="alg1.l29.m1.3.3.1.1.2.2">𝑤</ci><ci id="alg1.l29.m1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1">𝑖</ci></apply><ci id="alg1.l29.m1.3.3.1.1.3.cmml" xref="alg1.l29.m1.3.3.1.1.3">g</ci></apply><apply id="alg1.l29.m1.4.4.2.2.cmml" xref="alg1.l29.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.4.4.2.2.1.cmml" xref="alg1.l29.m1.4.4.2.2">superscript</csymbol><ci id="alg1.l29.m1.4.4.2.2.2.cmml" xref="alg1.l29.m1.4.4.2.2.2">𝑋</ci><ci id="alg1.l29.m1.2.2.1.1.cmml" xref="alg1.l29.m1.2.2.1.1">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.4c">(w^{(i)}_{\mathrm{g}},\,X^{(i)})</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.m1.4d">( italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT , italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l29.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l29.1.m1.1"><semantics id="alg1.l29.1.m1.1a"><mo id="alg1.l29.1.m1.1.1" xref="alg1.l29.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l29.1.m1.1b"><ci id="alg1.l29.1.m1.1.1.cmml" xref="alg1.l29.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.1.m1.1d">▷</annotation></semantics></math> Only <math alttext="w^{(i)}_{\mathrm{g}}" class="ltx_Math" display="inline" id="alg1.l29.2.m2.1"><semantics id="alg1.l29.2.m2.1a"><msubsup id="alg1.l29.2.m2.1.2" xref="alg1.l29.2.m2.1.2.cmml"><mi id="alg1.l29.2.m2.1.2.2.2" xref="alg1.l29.2.m2.1.2.2.2.cmml">w</mi><mi id="alg1.l29.2.m2.1.2.3" mathvariant="normal" xref="alg1.l29.2.m2.1.2.3.cmml">g</mi><mrow id="alg1.l29.2.m2.1.1.1.3" xref="alg1.l29.2.m2.1.2.cmml"><mo id="alg1.l29.2.m2.1.1.1.3.1" stretchy="false" xref="alg1.l29.2.m2.1.2.cmml">(</mo><mi id="alg1.l29.2.m2.1.1.1.1" xref="alg1.l29.2.m2.1.1.1.1.cmml">i</mi><mo id="alg1.l29.2.m2.1.1.1.3.2" stretchy="false" xref="alg1.l29.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l29.2.m2.1b"><apply id="alg1.l29.2.m2.1.2.cmml" xref="alg1.l29.2.m2.1.2"><csymbol cd="ambiguous" id="alg1.l29.2.m2.1.2.1.cmml" xref="alg1.l29.2.m2.1.2">subscript</csymbol><apply id="alg1.l29.2.m2.1.2.2.cmml" xref="alg1.l29.2.m2.1.2"><csymbol cd="ambiguous" id="alg1.l29.2.m2.1.2.2.1.cmml" xref="alg1.l29.2.m2.1.2">superscript</csymbol><ci id="alg1.l29.2.m2.1.2.2.2.cmml" xref="alg1.l29.2.m2.1.2.2.2">𝑤</ci><ci id="alg1.l29.2.m2.1.1.1.1.cmml" xref="alg1.l29.2.m2.1.1.1.1">𝑖</ci></apply><ci id="alg1.l29.2.m2.1.2.3.cmml" xref="alg1.l29.2.m2.1.2.3">g</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.2.m2.1c">w^{(i)}_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.2.m2.1d">italic_w start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math> sent to server
</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l30.1.1.1" style="font-size:80%;">30:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l30.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l30.3">function</span>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.10">In this pseudo-code, each client <math alttext="i" class="ltx_Math" display="inline" id="A3.SS1.p2.1.m1.1"><semantics id="A3.SS1.p2.1.m1.1a"><mi id="A3.SS1.p2.1.m1.1.1" xref="A3.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.1b"><ci id="A3.SS1.p2.1.m1.1.1.cmml" xref="A3.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.1.m1.1d">italic_i</annotation></semantics></math> maintains an unconstrained matrix <math alttext="X^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.2.m2.1"><semantics id="A3.SS1.p2.2.m2.1a"><msup id="A3.SS1.p2.2.m2.1.2" xref="A3.SS1.p2.2.m2.1.2.cmml"><mi id="A3.SS1.p2.2.m2.1.2.2" xref="A3.SS1.p2.2.m2.1.2.2.cmml">X</mi><mrow id="A3.SS1.p2.2.m2.1.1.1.3" xref="A3.SS1.p2.2.m2.1.2.cmml"><mo id="A3.SS1.p2.2.m2.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.2.m2.1.2.cmml">(</mo><mi id="A3.SS1.p2.2.m2.1.1.1.1" xref="A3.SS1.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.2.m2.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.1b"><apply id="A3.SS1.p2.2.m2.1.2.cmml" xref="A3.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.2.m2.1.2.1.cmml" xref="A3.SS1.p2.2.m2.1.2">superscript</csymbol><ci id="A3.SS1.p2.2.m2.1.2.2.cmml" xref="A3.SS1.p2.2.m2.1.2.2">𝑋</ci><ci id="A3.SS1.p2.2.m2.1.1.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.1c">X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.2.m2.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, from which <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.3.m3.1"><semantics id="A3.SS1.p2.3.m3.1a"><msubsup id="A3.SS1.p2.3.m3.1.2" xref="A3.SS1.p2.3.m3.1.2.cmml"><mi id="A3.SS1.p2.3.m3.1.2.2.2" xref="A3.SS1.p2.3.m3.1.2.2.2.cmml">w</mi><mi id="A3.SS1.p2.3.m3.1.2.2.3" mathvariant="normal" xref="A3.SS1.p2.3.m3.1.2.2.3.cmml">l</mi><mrow id="A3.SS1.p2.3.m3.1.1.1.3" xref="A3.SS1.p2.3.m3.1.2.cmml"><mo id="A3.SS1.p2.3.m3.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.3.m3.1.2.cmml">(</mo><mi id="A3.SS1.p2.3.m3.1.1.1.1" xref="A3.SS1.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.3.m3.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><apply id="A3.SS1.p2.3.m3.1.2.cmml" xref="A3.SS1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.2.1.cmml" xref="A3.SS1.p2.3.m3.1.2">superscript</csymbol><apply id="A3.SS1.p2.3.m3.1.2.2.cmml" xref="A3.SS1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.2.2.1.cmml" xref="A3.SS1.p2.3.m3.1.2">subscript</csymbol><ci id="A3.SS1.p2.3.m3.1.2.2.2.cmml" xref="A3.SS1.p2.3.m3.1.2.2.2">𝑤</ci><ci id="A3.SS1.p2.3.m3.1.2.2.3.cmml" xref="A3.SS1.p2.3.m3.1.2.2.3">l</ci></apply><ci id="A3.SS1.p2.3.m3.1.1.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.3.m3.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is derived via the Cayley transform. The function <math alttext="P^{(i)}=\tfrac{1}{2}\bigl{(}X^{(i)}-(X^{(i)})^{\top}\bigr{)}" class="ltx_Math" display="inline" id="A3.SS1.p2.4.m4.4"><semantics id="A3.SS1.p2.4.m4.4a"><mrow id="A3.SS1.p2.4.m4.4.4" xref="A3.SS1.p2.4.m4.4.4.cmml"><msup id="A3.SS1.p2.4.m4.4.4.3" xref="A3.SS1.p2.4.m4.4.4.3.cmml"><mi id="A3.SS1.p2.4.m4.4.4.3.2" xref="A3.SS1.p2.4.m4.4.4.3.2.cmml">P</mi><mrow id="A3.SS1.p2.4.m4.1.1.1.3" xref="A3.SS1.p2.4.m4.4.4.3.cmml"><mo id="A3.SS1.p2.4.m4.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.3.cmml">(</mo><mi id="A3.SS1.p2.4.m4.1.1.1.1" xref="A3.SS1.p2.4.m4.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.4.m4.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.3.cmml">)</mo></mrow></msup><mo id="A3.SS1.p2.4.m4.4.4.2" xref="A3.SS1.p2.4.m4.4.4.2.cmml">=</mo><mrow id="A3.SS1.p2.4.m4.4.4.1" xref="A3.SS1.p2.4.m4.4.4.1.cmml"><mfrac id="A3.SS1.p2.4.m4.4.4.1.3" xref="A3.SS1.p2.4.m4.4.4.1.3.cmml"><mn id="A3.SS1.p2.4.m4.4.4.1.3.2" xref="A3.SS1.p2.4.m4.4.4.1.3.2.cmml">1</mn><mn id="A3.SS1.p2.4.m4.4.4.1.3.3" xref="A3.SS1.p2.4.m4.4.4.1.3.3.cmml">2</mn></mfrac><mo id="A3.SS1.p2.4.m4.4.4.1.2" xref="A3.SS1.p2.4.m4.4.4.1.2.cmml">⁢</mo><mrow id="A3.SS1.p2.4.m4.4.4.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml"><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.2" maxsize="120%" minsize="120%" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml">(</mo><mrow id="A3.SS1.p2.4.m4.4.4.1.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml"><msup id="A3.SS1.p2.4.m4.4.4.1.1.1.1.3" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.cmml"><mi id="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.2" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.2.cmml">X</mi><mrow id="A3.SS1.p2.4.m4.2.2.1.3" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.cmml"><mo id="A3.SS1.p2.4.m4.2.2.1.3.1" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.cmml">(</mo><mi id="A3.SS1.p2.4.m4.2.2.1.1" xref="A3.SS1.p2.4.m4.2.2.1.1.cmml">i</mi><mo id="A3.SS1.p2.4.m4.2.2.1.3.2" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.cmml">)</mo></mrow></msup><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.1.2" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.2.cmml">−</mo><msup id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.cmml"><mrow id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="A3.SS1.p2.4.m4.3.3.1.3" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A3.SS1.p2.4.m4.3.3.1.3.1" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A3.SS1.p2.4.m4.3.3.1.1" xref="A3.SS1.p2.4.m4.3.3.1.1.cmml">i</mi><mo id="A3.SS1.p2.4.m4.3.3.1.3.2" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.3" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><mo id="A3.SS1.p2.4.m4.4.4.1.1.1.3" maxsize="120%" minsize="120%" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.4.m4.4b"><apply id="A3.SS1.p2.4.m4.4.4.cmml" xref="A3.SS1.p2.4.m4.4.4"><eq id="A3.SS1.p2.4.m4.4.4.2.cmml" xref="A3.SS1.p2.4.m4.4.4.2"></eq><apply id="A3.SS1.p2.4.m4.4.4.3.cmml" xref="A3.SS1.p2.4.m4.4.4.3"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.4.4.3.1.cmml" xref="A3.SS1.p2.4.m4.4.4.3">superscript</csymbol><ci id="A3.SS1.p2.4.m4.4.4.3.2.cmml" xref="A3.SS1.p2.4.m4.4.4.3.2">𝑃</ci><ci id="A3.SS1.p2.4.m4.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.1.1.1.1">𝑖</ci></apply><apply id="A3.SS1.p2.4.m4.4.4.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1"><times id="A3.SS1.p2.4.m4.4.4.1.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.2"></times><apply id="A3.SS1.p2.4.m4.4.4.1.3.cmml" xref="A3.SS1.p2.4.m4.4.4.1.3"><divide id="A3.SS1.p2.4.m4.4.4.1.3.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.3"></divide><cn id="A3.SS1.p2.4.m4.4.4.1.3.2.cmml" type="integer" xref="A3.SS1.p2.4.m4.4.4.1.3.2">1</cn><cn id="A3.SS1.p2.4.m4.4.4.1.3.3.cmml" type="integer" xref="A3.SS1.p2.4.m4.4.4.1.3.3">2</cn></apply><apply id="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1"><minus id="A3.SS1.p2.4.m4.4.4.1.1.1.1.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.2"></minus><apply id="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3">superscript</csymbol><ci id="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.3.2">𝑋</ci><ci id="A3.SS1.p2.4.m4.2.2.1.1.cmml" xref="A3.SS1.p2.4.m4.2.2.1.1">𝑖</ci></apply><apply id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1">superscript</csymbol><apply id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="A3.SS1.p2.4.m4.3.3.1.1.cmml" xref="A3.SS1.p2.4.m4.3.3.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.3.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.1.1.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.4.m4.4c">P^{(i)}=\tfrac{1}{2}\bigl{(}X^{(i)}-(X^{(i)})^{\top}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.4.m4.4d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ( italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT )</annotation></semantics></math> ensures <math alttext="P^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.5.m5.1"><semantics id="A3.SS1.p2.5.m5.1a"><msup id="A3.SS1.p2.5.m5.1.2" xref="A3.SS1.p2.5.m5.1.2.cmml"><mi id="A3.SS1.p2.5.m5.1.2.2" xref="A3.SS1.p2.5.m5.1.2.2.cmml">P</mi><mrow id="A3.SS1.p2.5.m5.1.1.1.3" xref="A3.SS1.p2.5.m5.1.2.cmml"><mo id="A3.SS1.p2.5.m5.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.5.m5.1.2.cmml">(</mo><mi id="A3.SS1.p2.5.m5.1.1.1.1" xref="A3.SS1.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.5.m5.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.5.m5.1b"><apply id="A3.SS1.p2.5.m5.1.2.cmml" xref="A3.SS1.p2.5.m5.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.5.m5.1.2.1.cmml" xref="A3.SS1.p2.5.m5.1.2">superscript</csymbol><ci id="A3.SS1.p2.5.m5.1.2.2.cmml" xref="A3.SS1.p2.5.m5.1.2.2">𝑃</ci><ci id="A3.SS1.p2.5.m5.1.1.1.1.cmml" xref="A3.SS1.p2.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.5.m5.1c">P^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.5.m5.1d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is skew-symmetric, so <math alttext="(I-P^{(i)})" class="ltx_Math" display="inline" id="A3.SS1.p2.6.m6.2"><semantics id="A3.SS1.p2.6.m6.2a"><mrow id="A3.SS1.p2.6.m6.2.2.1" xref="A3.SS1.p2.6.m6.2.2.1.1.cmml"><mo id="A3.SS1.p2.6.m6.2.2.1.2" stretchy="false" xref="A3.SS1.p2.6.m6.2.2.1.1.cmml">(</mo><mrow id="A3.SS1.p2.6.m6.2.2.1.1" xref="A3.SS1.p2.6.m6.2.2.1.1.cmml"><mi id="A3.SS1.p2.6.m6.2.2.1.1.2" xref="A3.SS1.p2.6.m6.2.2.1.1.2.cmml">I</mi><mo id="A3.SS1.p2.6.m6.2.2.1.1.1" xref="A3.SS1.p2.6.m6.2.2.1.1.1.cmml">−</mo><msup id="A3.SS1.p2.6.m6.2.2.1.1.3" xref="A3.SS1.p2.6.m6.2.2.1.1.3.cmml"><mi id="A3.SS1.p2.6.m6.2.2.1.1.3.2" xref="A3.SS1.p2.6.m6.2.2.1.1.3.2.cmml">P</mi><mrow id="A3.SS1.p2.6.m6.1.1.1.3" xref="A3.SS1.p2.6.m6.2.2.1.1.3.cmml"><mo id="A3.SS1.p2.6.m6.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.6.m6.2.2.1.1.3.cmml">(</mo><mi id="A3.SS1.p2.6.m6.1.1.1.1" xref="A3.SS1.p2.6.m6.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.6.m6.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.6.m6.2.2.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A3.SS1.p2.6.m6.2.2.1.3" stretchy="false" xref="A3.SS1.p2.6.m6.2.2.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.6.m6.2b"><apply id="A3.SS1.p2.6.m6.2.2.1.1.cmml" xref="A3.SS1.p2.6.m6.2.2.1"><minus id="A3.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="A3.SS1.p2.6.m6.2.2.1.1.1"></minus><ci id="A3.SS1.p2.6.m6.2.2.1.1.2.cmml" xref="A3.SS1.p2.6.m6.2.2.1.1.2">𝐼</ci><apply id="A3.SS1.p2.6.m6.2.2.1.1.3.cmml" xref="A3.SS1.p2.6.m6.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p2.6.m6.2.2.1.1.3.1.cmml" xref="A3.SS1.p2.6.m6.2.2.1.1.3">superscript</csymbol><ci id="A3.SS1.p2.6.m6.2.2.1.1.3.2.cmml" xref="A3.SS1.p2.6.m6.2.2.1.1.3.2">𝑃</ci><ci id="A3.SS1.p2.6.m6.1.1.1.1.cmml" xref="A3.SS1.p2.6.m6.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.6.m6.2c">(I-P^{(i)})</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.6.m6.2d">( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> remains invertible. After computing local updates, clients only send their updated global parameters <math alttext="w_{\mathrm{g}}^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.7.m7.1"><semantics id="A3.SS1.p2.7.m7.1a"><msubsup id="A3.SS1.p2.7.m7.1.2" xref="A3.SS1.p2.7.m7.1.2.cmml"><mi id="A3.SS1.p2.7.m7.1.2.2.2" xref="A3.SS1.p2.7.m7.1.2.2.2.cmml">w</mi><mi id="A3.SS1.p2.7.m7.1.2.2.3" mathvariant="normal" xref="A3.SS1.p2.7.m7.1.2.2.3.cmml">g</mi><mrow id="A3.SS1.p2.7.m7.1.1.1.3" xref="A3.SS1.p2.7.m7.1.2.cmml"><mo id="A3.SS1.p2.7.m7.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.7.m7.1.2.cmml">(</mo><mi id="A3.SS1.p2.7.m7.1.1.1.1" xref="A3.SS1.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.7.m7.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.7.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.7.m7.1b"><apply id="A3.SS1.p2.7.m7.1.2.cmml" xref="A3.SS1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.7.m7.1.2.1.cmml" xref="A3.SS1.p2.7.m7.1.2">superscript</csymbol><apply id="A3.SS1.p2.7.m7.1.2.2.cmml" xref="A3.SS1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.7.m7.1.2.2.1.cmml" xref="A3.SS1.p2.7.m7.1.2">subscript</csymbol><ci id="A3.SS1.p2.7.m7.1.2.2.2.cmml" xref="A3.SS1.p2.7.m7.1.2.2.2">𝑤</ci><ci id="A3.SS1.p2.7.m7.1.2.2.3.cmml" xref="A3.SS1.p2.7.m7.1.2.2.3">g</ci></apply><ci id="A3.SS1.p2.7.m7.1.1.1.1.cmml" xref="A3.SS1.p2.7.m7.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.7.m7.1c">w_{\mathrm{g}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.7.m7.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> back to the server; <math alttext="X^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.8.m8.1"><semantics id="A3.SS1.p2.8.m8.1a"><msup id="A3.SS1.p2.8.m8.1.2" xref="A3.SS1.p2.8.m8.1.2.cmml"><mi id="A3.SS1.p2.8.m8.1.2.2" xref="A3.SS1.p2.8.m8.1.2.2.cmml">X</mi><mrow id="A3.SS1.p2.8.m8.1.1.1.3" xref="A3.SS1.p2.8.m8.1.2.cmml"><mo id="A3.SS1.p2.8.m8.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.8.m8.1.2.cmml">(</mo><mi id="A3.SS1.p2.8.m8.1.1.1.1" xref="A3.SS1.p2.8.m8.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.8.m8.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.8.m8.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.8.m8.1b"><apply id="A3.SS1.p2.8.m8.1.2.cmml" xref="A3.SS1.p2.8.m8.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.8.m8.1.2.1.cmml" xref="A3.SS1.p2.8.m8.1.2">superscript</csymbol><ci id="A3.SS1.p2.8.m8.1.2.2.cmml" xref="A3.SS1.p2.8.m8.1.2.2">𝑋</ci><ci id="A3.SS1.p2.8.m8.1.1.1.1.cmml" xref="A3.SS1.p2.8.m8.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.8.m8.1c">X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.8.m8.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A3.SS1.p2.9.m9.1"><semantics id="A3.SS1.p2.9.m9.1a"><msubsup id="A3.SS1.p2.9.m9.1.2" xref="A3.SS1.p2.9.m9.1.2.cmml"><mi id="A3.SS1.p2.9.m9.1.2.2.2" xref="A3.SS1.p2.9.m9.1.2.2.2.cmml">w</mi><mi id="A3.SS1.p2.9.m9.1.2.2.3" mathvariant="normal" xref="A3.SS1.p2.9.m9.1.2.2.3.cmml">l</mi><mrow id="A3.SS1.p2.9.m9.1.1.1.3" xref="A3.SS1.p2.9.m9.1.2.cmml"><mo id="A3.SS1.p2.9.m9.1.1.1.3.1" stretchy="false" xref="A3.SS1.p2.9.m9.1.2.cmml">(</mo><mi id="A3.SS1.p2.9.m9.1.1.1.1" xref="A3.SS1.p2.9.m9.1.1.1.1.cmml">i</mi><mo id="A3.SS1.p2.9.m9.1.1.1.3.2" stretchy="false" xref="A3.SS1.p2.9.m9.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.9.m9.1b"><apply id="A3.SS1.p2.9.m9.1.2.cmml" xref="A3.SS1.p2.9.m9.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.9.m9.1.2.1.cmml" xref="A3.SS1.p2.9.m9.1.2">superscript</csymbol><apply id="A3.SS1.p2.9.m9.1.2.2.cmml" xref="A3.SS1.p2.9.m9.1.2"><csymbol cd="ambiguous" id="A3.SS1.p2.9.m9.1.2.2.1.cmml" xref="A3.SS1.p2.9.m9.1.2">subscript</csymbol><ci id="A3.SS1.p2.9.m9.1.2.2.2.cmml" xref="A3.SS1.p2.9.m9.1.2.2.2">𝑤</ci><ci id="A3.SS1.p2.9.m9.1.2.2.3.cmml" xref="A3.SS1.p2.9.m9.1.2.2.3">l</ci></apply><ci id="A3.SS1.p2.9.m9.1.1.1.1.cmml" xref="A3.SS1.p2.9.m9.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.9.m9.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.9.m9.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> remain local. The server then aggregates the global parameters and broadcasts the new global parameter <math alttext="w_{\mathrm{g}}" class="ltx_Math" display="inline" id="A3.SS1.p2.10.m10.1"><semantics id="A3.SS1.p2.10.m10.1a"><msub id="A3.SS1.p2.10.m10.1.1" xref="A3.SS1.p2.10.m10.1.1.cmml"><mi id="A3.SS1.p2.10.m10.1.1.2" xref="A3.SS1.p2.10.m10.1.1.2.cmml">w</mi><mi id="A3.SS1.p2.10.m10.1.1.3" mathvariant="normal" xref="A3.SS1.p2.10.m10.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.10.m10.1b"><apply id="A3.SS1.p2.10.m10.1.1.cmml" xref="A3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.10.m10.1.1.1.cmml" xref="A3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="A3.SS1.p2.10.m10.1.1.2.cmml" xref="A3.SS1.p2.10.m10.1.1.2">𝑤</ci><ci id="A3.SS1.p2.10.m10.1.1.3.cmml" xref="A3.SS1.p2.10.m10.1.1.3">g</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.10.m10.1c">w_{\mathrm{g}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.10.m10.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT</annotation></semantics></math> to all clients, thus completing one communication round.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Cayley Transform</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">In mathematics, the Cayley transform, introduced by Arthur Cayley <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">cayley1846quelques</span> </a></cite>, maps skew-symmetric matrices to special orthogonal matrices.
It is also used in real, complex, and quaternionic analysis.
To integrate orthogonal transformations into our framework, we employ the Cayley transform and obtain orthogonal matrices corresponding to each client’s local parameters.</p>
</div>
<section class="ltx_paragraph" id="A3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">The process of the Cayley Transform.</h5>
<div class="ltx_para" id="A3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A3.SS2.SSS0.Px1.p1.13">Given the original feature representations <math alttext="z\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="A3.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="A3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">z</mi><mo id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1"><in id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝑧</ci><apply id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.1.m1.1c">z\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.1.m1.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and an orthogonal matrix denoted <math alttext="Q\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="A3.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="A3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">d</mi><mo id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1"><in id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.1"></in><ci id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝑄</ci><apply id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3"><times id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.1"></times><ci id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.2">𝑑</ci><ci id="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.2.m2.1c">Q\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.2.m2.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, the resulting orthogonally transformed features are denoted as <math alttext="z^{\prime}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="A3.SS2.SSS0.Px1.p1.3.m3.1a"><mrow id="A3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><msup id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.2" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">z</mi><mo id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.3" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.1" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.3" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1"><in id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.1"></in><apply id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.2">𝑧</ci><ci id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.2.3">′</ci></apply><apply id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.2">ℝ</ci><ci id="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.3.m3.1c">z^{\prime}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.3.m3.1d">italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
Thus, the transformation is expressed as <math alttext="z^{\prime}=Q\cdot z" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="A3.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="A3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><msup id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2.cmml">z</mi><mo id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.3" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.3.cmml">′</mo></msup><mo id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">⋅</mo><mi id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.3" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml">z</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1"><eq id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.1"></eq><apply id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.1.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2">𝑧</ci><ci id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.2.3">′</ci></apply><apply id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3"><ci id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.1">⋅</ci><ci id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.2">𝑄</ci><ci id="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.4.m4.1.1.3.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.4.m4.1c">z^{\prime}=Q\cdot z</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.4.m4.1d">italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_Q ⋅ italic_z</annotation></semantics></math>, where <math alttext="Q\cdot Q^{\top}=Q^{\top}\cdot Q=I" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="A3.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="A3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><mrow id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1.cmml">⋅</mo><msup id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.2" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.3" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml">⊤</mo></msup></mrow><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml">=</mo><mrow id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.cmml"><msup id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.2" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.2.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.3" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.3.cmml">⊤</mo></msup><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.1.cmml">⋅</mo><mi id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.3" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.3.cmml">Q</mi></mrow><mo id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.5" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.5.cmml">=</mo><mi id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.6" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.6.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1"><and id="A3.SS2.SSS0.Px1.p1.5.m5.1.1a.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1"></and><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1b.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1"><eq id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.3"></eq><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2"><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1">⋅</ci><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2">𝑄</ci><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.2">𝑄</ci><csymbol cd="latexml" id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.3">top</csymbol></apply></apply><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4"><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.1.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.1">⋅</ci><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.1.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.2">𝑄</ci><csymbol cd="latexml" id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.2.3">top</csymbol></apply><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.3.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.3">𝑄</ci></apply></apply><apply id="A3.SS2.SSS0.Px1.p1.5.m5.1.1c.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1"><eq id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.5.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.5"></eq><share href="https://arxiv.org/html/2505.19888v1#A3.SS2.SSS0.Px1.p1.5.m5.1.1.4.cmml" id="A3.SS2.SSS0.Px1.p1.5.m5.1.1d.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1"></share><ci id="A3.SS2.SSS0.Px1.p1.5.m5.1.1.6.cmml" xref="A3.SS2.SSS0.Px1.p1.5.m5.1.1.6">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.5.m5.1c">Q\cdot Q^{\top}=Q^{\top}\cdot Q=I</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.5.m5.1d">italic_Q ⋅ italic_Q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = italic_Q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⋅ italic_Q = italic_I</annotation></semantics></math>, underscoring the orthogonality of <math alttext="Q" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="A3.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="A3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="A3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="A3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.6.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.6.m6.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.6.m6.1d">italic_Q</annotation></semantics></math>.
To ensure orthogonal weight matrices during fine-tuning, we utilize the <span class="ltx_text ltx_font_italic" id="A3.SS2.SSS0.Px1.p1.13.1">Cayley transform</span>, enforcing orthogonality.
In particular, the orthogonal matrix <math alttext="Q" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="A3.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="A3.SS2.SSS0.Px1.p1.7.m7.1.1" xref="A3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="A3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.7.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.7.m7.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.7.m7.1d">italic_Q</annotation></semantics></math> is derived using the equation <math alttext="Q=(I+P)(I-P)^{-1}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.8.m8.2"><semantics id="A3.SS2.SSS0.Px1.p1.8.m8.2a"><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.2.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.4" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.4.cmml">Q</mi><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.3" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.3.cmml">=</mo><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.cmml"><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml"><mo id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.2" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.cmml">I</mi><mo id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.cmml">+</mo><mi id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml">P</mi></mrow><mo id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.3" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.3" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.3.cmml">⁢</mo><msup id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.cmml"><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.cmml"><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.2" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.2.cmml">I</mi><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.1.cmml">−</mo><mi id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.3" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.3" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.cmml">)</mo></mrow><mrow id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.cmml"><mo id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3a" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.cmml">−</mo><mn id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.2" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.8.m8.2b"><apply id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2"><eq id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.3"></eq><ci id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.4.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.4">𝑄</ci><apply id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2"><times id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.3"></times><apply id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1"><plus id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.1"></plus><ci id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.2">𝐼</ci><ci id="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.3">𝑃</ci></apply><apply id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2">superscript</csymbol><apply id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1"><minus id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.1"></minus><ci id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.2">𝐼</ci><ci id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.1.1.1.3">𝑃</ci></apply><apply id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3"><minus id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3"></minus><cn id="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.2.cmml" type="integer" xref="A3.SS2.SSS0.Px1.p1.8.m8.2.2.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.8.m8.2c">Q=(I+P)(I-P)^{-1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.8.m8.2d">italic_Q = ( italic_I + italic_P ) ( italic_I - italic_P ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, subject to the condition that <math alttext="P=-P^{\top}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.9.m9.1"><semantics id="A3.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="A3.SS2.SSS0.Px1.p1.9.m9.1.1" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.2" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml">P</mi><mo id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.1" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml"><mo id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3a" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml">−</mo><msup id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.cmml"><mi id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.2" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.2.cmml">P</mi><mo id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.3" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1"><eq id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.1"></eq><ci id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.2">𝑃</ci><apply id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3"><minus id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3"></minus><apply id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.1.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.2.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.2">𝑃</ci><csymbol cd="latexml" id="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.3.cmml" xref="A3.SS2.SSS0.Px1.p1.9.m9.1.1.3.2.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.9.m9.1c">P=-P^{\top}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.9.m9.1d">italic_P = - italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>.
To satisfy the constraint on <math alttext="P" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.10.m10.1"><semantics id="A3.SS2.SSS0.Px1.p1.10.m10.1a"><mi id="A3.SS2.SSS0.Px1.p1.10.m10.1.1" xref="A3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.10.m10.1b"><ci id="A3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.10.m10.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.10.m10.1c">P</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.10.m10.1d">italic_P</annotation></semantics></math>, we formulate <math alttext="P" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.11.m11.1"><semantics id="A3.SS2.SSS0.Px1.p1.11.m11.1a"><mi id="A3.SS2.SSS0.Px1.p1.11.m11.1.1" xref="A3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.11.m11.1b"><ci id="A3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.11.m11.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.11.m11.1c">P</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.11.m11.1d">italic_P</annotation></semantics></math> as <math alttext="P=0.5(X-X^{\top})" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.12.m12.1"><semantics id="A3.SS2.SSS0.Px1.p1.12.m12.1a"><mrow id="A3.SS2.SSS0.Px1.p1.12.m12.1.1" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.3" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.3.cmml">P</mi><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.2" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml">=</mo><mrow id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.cmml"><mn id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.3" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.3.cmml">0.5</mn><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.2" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.2.cmml">⁢</mo><mrow id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml"><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.2" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml"><mi id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.2" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.2.cmml">X</mi><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.1" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.1.cmml">−</mo><msup id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.2" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.2.cmml">X</mi><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.3" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.3" stretchy="false" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.12.m12.1b"><apply id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1"><eq id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.2"></eq><ci id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.3">𝑃</ci><apply id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1"><times id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.2"></times><cn id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.3.cmml" type="float" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.3">0.5</cn><apply id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1"><minus id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.1"></minus><ci id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.2">𝑋</ci><apply id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.2">𝑋</ci><csymbol cd="latexml" id="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.3.cmml" xref="A3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.12.m12.1c">P=0.5(X-X^{\top})</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.12.m12.1d">italic_P = 0.5 ( italic_X - italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="X" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px1.p1.13.m13.1"><semantics id="A3.SS2.SSS0.Px1.p1.13.m13.1a"><mi id="A3.SS2.SSS0.Px1.p1.13.m13.1.1" xref="A3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px1.p1.13.m13.1b"><ci id="A3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml" xref="A3.SS2.SSS0.Px1.p1.13.m13.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px1.p1.13.m13.1c">X</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px1.p1.13.m13.1d">italic_X</annotation></semantics></math> is a given transformation matrix.</p>
</div>
</section>
<section class="ltx_paragraph" id="A3.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Differentiability of the Cayley Transform.</h5>
<div class="ltx_para" id="A3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A3.SS2.SSS0.Px2.p1.6">Because <math alttext="P^{(i)}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="A3.SS2.SSS0.Px2.p1.1.m1.1a"><msup id="A3.SS2.SSS0.Px2.p1.1.m1.1.2" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml"><mi id="A3.SS2.SSS0.Px2.p1.1.m1.1.2.2" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.2.cmml">P</mi><mrow id="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml"><mo id="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="A3.SS2.SSS0.Px2.p1.1.m1.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.1.m1.1.2.1.cmml" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.1.m1.1.2.2.cmml" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.2.2">𝑃</ci><ci id="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.1.m1.1c">P^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.1.m1.1d">italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is skew-symmetric, <math alttext="(I-P^{(i)})" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.2.m2.2"><semantics id="A3.SS2.SSS0.Px2.p1.2.m2.2a"><mrow id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mo id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mi id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.2" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml">I</mi><mo id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.1" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml">−</mo><msup id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.2" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.2.cmml">P</mi><mrow id="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml"><mo id="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.3" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.2.m2.2b"><apply id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1"><minus id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.1"></minus><ci id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.2">𝐼</ci><apply id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.2.2.1.1.3.2">𝑃</ci><ci id="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.2.m2.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.2.m2.2c">(I-P^{(i)})</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.2.m2.2d">( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> is guaranteed to be invertible (its eigenvalues cannot be <math alttext="1" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="A3.SS2.SSS0.Px2.p1.3.m3.1a"><mn id="A3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="A3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.3.m3.1b"><cn id="A3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" type="integer" xref="A3.SS2.SSS0.Px2.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.3.m3.1d">1</annotation></semantics></math>). Thus, the Cayley transform <math alttext="(I+P^{(i)})(I-P^{(i)})^{-1}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.4.m4.4"><semantics id="A3.SS2.SSS0.Px2.p1.4.m4.4a"><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.4.4" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.cmml"><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.cmml"><mo id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.cmml"><mi id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.2.cmml">I</mi><mo id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml">+</mo><msup id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.2.cmml">P</mi><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.cmml"><mo id="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.3" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.cmml">)</mo></mrow><mo id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.3.cmml">⁢</mo><msup id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.cmml"><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.cmml"><mo id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.cmml">(</mo><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.cmml"><mi id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.2.cmml">I</mi><mo id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.1.cmml">−</mo><msup id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.cmml"><mi id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.2.cmml">P</mi><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.cmml"><mo id="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.1" xref="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.3" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.cmml">)</mo></mrow><mrow id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.cmml"><mo id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3a" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.cmml">−</mo><mn id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.2" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.4.m4.4b"><apply id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4"><times id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.3.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.3"></times><apply id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1"><plus id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1"></plus><ci id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.2">𝐼</ci><apply id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.3.2">𝑃</ci><ci id="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.1.1.1.1">𝑖</ci></apply></apply><apply id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2">superscript</csymbol><apply id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1"><minus id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.1"></minus><ci id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.2">𝐼</ci><apply id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3">superscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.2.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.1.1.1.3.2">𝑃</ci><ci id="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.2.2.1.1">𝑖</ci></apply></apply><apply id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3"><minus id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.1.cmml" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3"></minus><cn id="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.2.cmml" type="integer" xref="A3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.4.m4.4c">(I+P^{(i)})(I-P^{(i)})^{-1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.4.m4.4d">( italic_I + italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ( italic_I - italic_P start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is well-defined and differentiable. In this way, standard optimizers can be applied to <math alttext="X^{(i)}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="A3.SS2.SSS0.Px2.p1.5.m5.1a"><msup id="A3.SS2.SSS0.Px2.p1.5.m5.1.2" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml"><mi id="A3.SS2.SSS0.Px2.p1.5.m5.1.2.2" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.2.cmml">X</mi><mrow id="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml"><mo id="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="A3.SS2.SSS0.Px2.p1.5.m5.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.5.m5.1.2.1.cmml" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2">superscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.5.m5.1.2.2.cmml" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.2.2">𝑋</ci><ci id="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.5.m5.1c">X^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.5.m5.1d">italic_X start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, and each forward/backward pass enforces the orthogonality of <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A3.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="A3.SS2.SSS0.Px2.p1.6.m6.1a"><msubsup id="A3.SS2.SSS0.Px2.p1.6.m6.1.2" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.cmml"><mi id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.2" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.2.cmml">w</mi><mi id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.3" mathvariant="normal" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.3.cmml">l</mi><mrow id="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.cmml"><mo id="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3.1" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.cmml">(</mo><mi id="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.3.2" stretchy="false" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS2.SSS0.Px2.p1.6.m6.1b"><apply id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.1.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2">superscript</csymbol><apply id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.1.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2">subscript</csymbol><ci id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.2.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.2">𝑤</ci><ci id="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.3.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.2.2.3">l</ci></apply><ci id="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="A3.SS2.SSS0.Px2.p1.6.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.SSS0.Px2.p1.6.m6.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.SSS0.Px2.p1.6.m6.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> while preserving smooth gradients for end-to-end training.</p>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Comparison of Learning Frameworks</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">To further clarify our statements in <a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#S3.SS4" title="3.4 Protecting Proprietary Models and Data ‣ 3 Method ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">3.4</span></a>, we compare different learning frameworks, with axis of data privacy, model ownership, computational efficiency, and their possible use cases. We refer to BlackFed <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib60" title=""><span class="ltx_text" style="font-size:90%;">paranjape2024federated</span> </a></cite> for the definition of Black-box FL, and refer to ZooPFL <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#bib.bib50" title=""><span class="ltx_text" style="font-size:90%;">lu2024zoopfl</span> </a></cite> for the definition of Black-box Foundation FL. Our method adopts Black-box Foundation FL, preserving proprietary foundation models.</p>
</div>
<figure class="ltx_table" id="A4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of learning frameworks and their applications.</figcaption>
<div class="ltx_inline-block ltx_minipage ltx_align_center ltx_align_middle ltx_transformed_outer" id="A4.T4.5.5" style="width:346.9pt;height:122.5pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-72.3pt,20.3pt) scale(0.749881795742092,0.749881795742092) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T4.5.5.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T4.5.5.5.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="A4.T4.5.5.5.6.1.1"><span class="ltx_text" id="A4.T4.5.5.5.6.1.1.1">Framework</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.5.5.5.6.1.2"><span class="ltx_text" id="A4.T4.5.5.5.6.1.2.1">
<span class="ltx_inline-block ltx_align_center" id="A4.T4.5.5.5.6.1.2.1.1">
<span class="ltx_p" id="A4.T4.5.5.5.6.1.2.1.1.1">Data</span>
<span class="ltx_p" id="A4.T4.5.5.5.6.1.2.1.1.2">Privacy</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.5.5.5.6.1.3"><span class="ltx_text" id="A4.T4.5.5.5.6.1.3.1">
<span class="ltx_inline-block ltx_align_center" id="A4.T4.5.5.5.6.1.3.1.1">
<span class="ltx_p" id="A4.T4.5.5.5.6.1.3.1.1.1">Model</span>
<span class="ltx_p" id="A4.T4.5.5.5.6.1.3.1.1.2">Ownership</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T4.5.5.5.6.1.4"><span class="ltx_text" id="A4.T4.5.5.5.6.1.4.1">
<span class="ltx_inline-block ltx_align_center" id="A4.T4.5.5.5.6.1.4.1.1">
<span class="ltx_p" id="A4.T4.5.5.5.6.1.4.1.1.1">Computational</span>
<span class="ltx_p" id="A4.T4.5.5.5.6.1.4.1.1.2">Efficiency</span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A4.T4.5.5.5.6.1.5"><span class="ltx_text" id="A4.T4.5.5.5.6.1.5.1">Use Case</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T4.1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A4.T4.1.1.1.1.2" rowspan="2"><span class="ltx_text" id="A4.T4.1.1.1.1.2.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.1.1.1.1.2.1.1">
<span class="ltx_p" id="A4.T4.1.1.1.1.2.1.1.1">White-box</span>
<span class="ltx_p" id="A4.T4.1.1.1.1.2.1.1.2">Learning</span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A4.T4.1.1.1.1.3"><span class="ltx_text" id="A4.T4.1.1.1.1.3.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.1.1.1.1.3.1.1">
<span class="ltx_p" id="A4.T4.1.1.1.1.3.1.1.1">Traditional</span>
<span class="ltx_p" id="A4.T4.1.1.1.1.3.1.1.2">Learning</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T4.1.1.1.1.4"><span class="ltx_text" id="A4.T4.1.1.1.1.4.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T4.1.1.1.1.5"><span class="ltx_text" id="A4.T4.1.1.1.1.5.1" style="color:#FF0000;">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A4.T4.1.1.1.1.1"><span class="ltx_text" id="A4.T4.1.1.1.1.1.1"><math alttext="\downarrow" class="ltx_Math" display="inline" id="A4.T4.1.1.1.1.1.1.m1.1"><semantics id="A4.T4.1.1.1.1.1.1.m1.1a"><mo id="A4.T4.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="A4.T4.1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.1.1.1.1.1.1.m1.1b"><ci id="A4.T4.1.1.1.1.1.1.m1.1.1.cmml" xref="A4.T4.1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.1.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T4.1.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T4.1.1.1.1.6"><span class="ltx_text" id="A4.T4.1.1.1.1.6.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.1.1.1.1.6.1.1">
<span class="ltx_p" id="A4.T4.1.1.1.1.6.1.1.1">Full fine-tuning on private GPU clusters</span>
<span class="ltx_p" id="A4.T4.1.1.1.1.6.1.1.2">(e.g., academic, enterprise internal data training)</span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.2.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T4.2.2.2.2.2"><span class="ltx_text" id="A4.T4.2.2.2.2.2.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.2.2.2.2.2.1.1">
<span class="ltx_p" id="A4.T4.2.2.2.2.2.1.1.1">Federated</span>
<span class="ltx_p" id="A4.T4.2.2.2.2.2.1.1.2">Learning</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.2.2.2.2.3"><span class="ltx_text" id="A4.T4.2.2.2.2.3.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.2.2.2.2.4"><span class="ltx_text" id="A4.T4.2.2.2.2.4.1" style="color:#FF0000;">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T4.2.2.2.2.1"><span class="ltx_text" id="A4.T4.2.2.2.2.1.1"><math alttext="\downarrow" class="ltx_Math" display="inline" id="A4.T4.2.2.2.2.1.1.m1.1"><semantics id="A4.T4.2.2.2.2.1.1.m1.1a"><mo id="A4.T4.2.2.2.2.1.1.m1.1.1" stretchy="false" xref="A4.T4.2.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.2.2.2.2.1.1.m1.1b"><ci id="A4.T4.2.2.2.2.1.1.m1.1.1.cmml" xref="A4.T4.2.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.2.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T4.2.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T4.2.2.2.2.5"><span class="ltx_text" id="A4.T4.2.2.2.2.5.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.2.2.2.2.5.1.1">
<span class="ltx_p" id="A4.T4.2.2.2.2.5.1.1.1">Edge-IoT with private data</span>
<span class="ltx_p" id="A4.T4.2.2.2.2.5.1.1.2">(e.g., smartphone keyboards, wearables,</span>
<span class="ltx_p" id="A4.T4.2.2.2.2.5.1.1.3">medical video collaboration)</span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.3.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A4.T4.3.3.3.3.2" rowspan="3"><span class="ltx_text" id="A4.T4.3.3.3.3.2.1">
<span class="ltx_inline-block ltx_align_center" id="A4.T4.3.3.3.3.2.1.1">
<span class="ltx_p" id="A4.T4.3.3.3.3.2.1.1.1">Black-box</span>
<span class="ltx_p" id="A4.T4.3.3.3.3.2.1.1.2">Learning</span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T4.3.3.3.3.3"><span class="ltx_text" id="A4.T4.3.3.3.3.3.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.3.3.3.3.3.1.1">
<span class="ltx_p" id="A4.T4.3.3.3.3.3.1.1.1">Black-box</span>
<span class="ltx_p" id="A4.T4.3.3.3.3.3.1.1.2">TL</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.3.3.3.3.4"><span class="ltx_text" id="A4.T4.3.3.3.3.4.1" style="color:#FF0000;">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.3.3.3.3.5"><span class="ltx_text" id="A4.T4.3.3.3.3.5.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T4.3.3.3.3.1"><span class="ltx_text" id="A4.T4.3.3.3.3.1.1"><math alttext="\uparrow" class="ltx_Math" display="inline" id="A4.T4.3.3.3.3.1.1.m1.1"><semantics id="A4.T4.3.3.3.3.1.1.m1.1a"><mo id="A4.T4.3.3.3.3.1.1.m1.1.1" stretchy="false" xref="A4.T4.3.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.3.3.3.3.1.1.m1.1b"><ci id="A4.T4.3.3.3.3.1.1.m1.1.1.cmml" xref="A4.T4.3.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.3.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A4.T4.3.3.3.3.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T4.3.3.3.3.6"><span class="ltx_text" id="A4.T4.3.3.3.3.6.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.3.3.3.3.6.1.1">
<span class="ltx_p" id="A4.T4.3.3.3.3.6.1.1.1">Cloud AI API-based SaaS</span>
<span class="ltx_p" id="A4.T4.3.3.3.3.6.1.1.2">(e.g., GPT-4 chatbot, document summarization)</span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.4.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T4.4.4.4.4.2"><span class="ltx_text" id="A4.T4.4.4.4.4.2.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.4.4.4.4.2.1.1">
<span class="ltx_p" id="A4.T4.4.4.4.4.2.1.1.1">Black-box FL</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.4.4.4.4.3"><span class="ltx_text" id="A4.T4.4.4.4.4.3.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.4.4.4.4.4"><span class="ltx_text" id="A4.T4.4.4.4.4.4.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T4.4.4.4.4.1"><span class="ltx_text" id="A4.T4.4.4.4.4.1.1"><math alttext="\downarrow" class="ltx_Math" display="inline" id="A4.T4.4.4.4.4.1.1.m1.1"><semantics id="A4.T4.4.4.4.4.1.1.m1.1a"><mo id="A4.T4.4.4.4.4.1.1.m1.1.1" stretchy="false" xref="A4.T4.4.4.4.4.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A4.T4.4.4.4.4.1.1.m1.1b"><ci id="A4.T4.4.4.4.4.1.1.m1.1.1.cmml" xref="A4.T4.4.4.4.4.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.4.4.4.4.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T4.4.4.4.4.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A4.T4.4.4.4.4.5" rowspan="2"><span class="ltx_text" id="A4.T4.4.4.4.4.5.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.4.4.4.4.5.1.1">
<span class="ltx_p" id="A4.T4.4.4.4.4.5.1.1.1">On-device personalization</span>
<span class="ltx_p" id="A4.T4.4.4.4.4.5.1.1.2">(e.g., automotive, smart home,</span>
<span class="ltx_p" id="A4.T4.4.4.4.4.5.1.1.3">regulated on-site black-box servers)</span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A4.T4.5.5.5.5.2"><span class="ltx_text" id="A4.T4.5.5.5.5.2.1">
<span class="ltx_inline-block ltx_align_left" id="A4.T4.5.5.5.5.2.1.1">
<span class="ltx_p" id="A4.T4.5.5.5.5.2.1.1.1">Black-box Foundation</span>
<span class="ltx_p" id="A4.T4.5.5.5.5.2.1.1.2">FL (Ours)</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T4.5.5.5.5.3"><span class="ltx_text" id="A4.T4.5.5.5.5.3.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T4.5.5.5.5.4"><span class="ltx_text" id="A4.T4.5.5.5.5.4.1" style="color:#00FF00;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A4.T4.5.5.5.5.1"><span class="ltx_text" id="A4.T4.5.5.5.5.1.1"><math alttext="\uparrow" class="ltx_Math" display="inline" id="A4.T4.5.5.5.5.1.1.m1.1"><semantics id="A4.T4.5.5.5.5.1.1.m1.1a"><mo id="A4.T4.5.5.5.5.1.1.m1.1.1" stretchy="false" xref="A4.T4.5.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A4.T4.5.5.5.5.1.1.m1.1b"><ci id="A4.T4.5.5.5.5.1.1.m1.1.1.cmml" xref="A4.T4.5.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.5.5.5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A4.T4.5.5.5.5.1.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Theoretical Analysis</h2>
<section class="ltx_subsection" id="A5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Gradient Analysis with a Linear <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A5.SS1.1.m1.1"><semantics id="A5.SS1.1.m1.1b"><msubsup id="A5.SS1.1.m1.1.2" xref="A5.SS1.1.m1.1.2.cmml"><mi id="A5.SS1.1.m1.1.2.2.2" xref="A5.SS1.1.m1.1.2.2.2.cmml">w</mi><mi id="A5.SS1.1.m1.1.2.2.3" mathvariant="normal" xref="A5.SS1.1.m1.1.2.2.3.cmml">l</mi><mrow id="A5.SS1.1.m1.1.1.1.3" xref="A5.SS1.1.m1.1.2.cmml"><mo id="A5.SS1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS1.1.m1.1.2.cmml">(</mo><mi id="A5.SS1.1.m1.1.1.1.1" xref="A5.SS1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A5.SS1.1.m1.1c"><apply id="A5.SS1.1.m1.1.2.cmml" xref="A5.SS1.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS1.1.m1.1.2.1.cmml" xref="A5.SS1.1.m1.1.2">superscript</csymbol><apply id="A5.SS1.1.m1.1.2.2.cmml" xref="A5.SS1.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS1.1.m1.1.2.2.1.cmml" xref="A5.SS1.1.m1.1.2">subscript</csymbol><ci id="A5.SS1.1.m1.1.2.2.2.cmml" xref="A5.SS1.1.m1.1.2.2.2">𝑤</ci><ci id="A5.SS1.1.m1.1.2.2.3.cmml" xref="A5.SS1.1.m1.1.2.2.3">l</ci></apply><ci id="A5.SS1.1.m1.1.1.1.1.cmml" xref="A5.SS1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.1.m1.1d">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.1.m1.1e">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>
</h3>
<div class="ltx_para" id="A5.SS1.p1">
<p class="ltx_p" id="A5.SS1.p1.1">We begin by defining the cross-entropy loss for client <math alttext="i" class="ltx_Math" display="inline" id="A5.SS1.p1.1.m1.1"><semantics id="A5.SS1.p1.1.m1.1a"><mi id="A5.SS1.p1.1.m1.1.1" xref="A5.SS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.1.m1.1b"><ci id="A5.SS1.p1.1.m1.1.1.cmml" xref="A5.SS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p1.1.m1.1d">italic_i</annotation></semantics></math> in a concise manner:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}\bigl{[}\mathrm{CE}(r_{x}^{(i)}%
,y)\bigr{]}," class="ltx_Math" display="block" id="A5.Ex7.m1.7"><semantics id="A5.Ex7.m1.7a"><mrow id="A5.Ex7.m1.7.7.1" xref="A5.Ex7.m1.7.7.1.1.cmml"><mrow id="A5.Ex7.m1.7.7.1.1" xref="A5.Ex7.m1.7.7.1.1.cmml"><msup id="A5.Ex7.m1.7.7.1.1.3" xref="A5.Ex7.m1.7.7.1.1.3.cmml"><mi id="A5.Ex7.m1.7.7.1.1.3.2" mathvariant="normal" xref="A5.Ex7.m1.7.7.1.1.3.2.cmml">ℓ</mi><mrow id="A5.Ex7.m1.1.1.1.3" xref="A5.Ex7.m1.7.7.1.1.3.cmml"><mo id="A5.Ex7.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.3.cmml">(</mo><mi id="A5.Ex7.m1.1.1.1.1" xref="A5.Ex7.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex7.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.3.cmml">)</mo></mrow></msup><mo id="A5.Ex7.m1.7.7.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex7.m1.7.7.1.1.2.cmml">=</mo><mrow id="A5.Ex7.m1.7.7.1.1.1" xref="A5.Ex7.m1.7.7.1.1.1.cmml"><msub id="A5.Ex7.m1.7.7.1.1.1.3" xref="A5.Ex7.m1.7.7.1.1.1.3.cmml"><mi id="A5.Ex7.m1.7.7.1.1.1.3.2" xref="A5.Ex7.m1.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="A5.Ex7.m1.4.4.3" xref="A5.Ex7.m1.4.4.3.cmml"><mrow id="A5.Ex7.m1.4.4.3.5.2" xref="A5.Ex7.m1.4.4.3.5.1.cmml"><mo id="A5.Ex7.m1.4.4.3.5.2.1" stretchy="false" xref="A5.Ex7.m1.4.4.3.5.1.cmml">(</mo><mi id="A5.Ex7.m1.3.3.2.2" xref="A5.Ex7.m1.3.3.2.2.cmml">x</mi><mo id="A5.Ex7.m1.4.4.3.5.2.2" xref="A5.Ex7.m1.4.4.3.5.1.cmml">,</mo><mi id="A5.Ex7.m1.4.4.3.3" xref="A5.Ex7.m1.4.4.3.3.cmml">y</mi><mo id="A5.Ex7.m1.4.4.3.5.2.3" rspace="0.170em" stretchy="false" xref="A5.Ex7.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="A5.Ex7.m1.4.4.3.4" rspace="0.448em" xref="A5.Ex7.m1.4.4.3.4.cmml">∈</mo><msup id="A5.Ex7.m1.4.4.3.6" xref="A5.Ex7.m1.4.4.3.6.cmml"><mi id="A5.Ex7.m1.4.4.3.6.2" xref="A5.Ex7.m1.4.4.3.6.2.cmml">D</mi><mrow id="A5.Ex7.m1.2.2.1.1.1.3" xref="A5.Ex7.m1.4.4.3.6.cmml"><mo id="A5.Ex7.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.Ex7.m1.4.4.3.6.cmml">(</mo><mi id="A5.Ex7.m1.2.2.1.1.1.1" xref="A5.Ex7.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.Ex7.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.Ex7.m1.4.4.3.6.cmml">)</mo></mrow></msup></mrow></msub><mo id="A5.Ex7.m1.7.7.1.1.1.2" xref="A5.Ex7.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex7.m1.7.7.1.1.1.1.1" xref="A5.Ex7.m1.7.7.1.1.1.1.2.cmml"><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex7.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.Ex7.m1.7.7.1.1.1.1.1.1" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.cmml"><mi id="A5.Ex7.m1.7.7.1.1.1.1.1.1.3" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.3.cmml">CE</mi><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.1.2" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">x</mi><mrow id="A5.Ex7.m1.5.5.1.3" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex7.m1.5.5.1.3.1" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex7.m1.5.5.1.1" xref="A5.Ex7.m1.5.5.1.1.cmml">i</mi><mo id="A5.Ex7.m1.5.5.1.3.2" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="A5.Ex7.m1.6.6" xref="A5.Ex7.m1.6.6.cmml">y</mi><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A5.Ex7.m1.7.7.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex7.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.Ex7.m1.7.7.1.2" xref="A5.Ex7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex7.m1.7b"><apply id="A5.Ex7.m1.7.7.1.1.cmml" xref="A5.Ex7.m1.7.7.1"><eq id="A5.Ex7.m1.7.7.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.2"></eq><apply id="A5.Ex7.m1.7.7.1.1.3.cmml" xref="A5.Ex7.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A5.Ex7.m1.7.7.1.1.3.1.cmml" xref="A5.Ex7.m1.7.7.1.1.3">superscript</csymbol><ci id="A5.Ex7.m1.7.7.1.1.3.2.cmml" xref="A5.Ex7.m1.7.7.1.1.3.2">ℓ</ci><ci id="A5.Ex7.m1.1.1.1.1.cmml" xref="A5.Ex7.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.Ex7.m1.7.7.1.1.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1"><times id="A5.Ex7.m1.7.7.1.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.2"></times><apply id="A5.Ex7.m1.7.7.1.1.1.3.cmml" xref="A5.Ex7.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex7.m1.7.7.1.1.1.3.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.3">subscript</csymbol><ci id="A5.Ex7.m1.7.7.1.1.1.3.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.3.2">𝔼</ci><apply id="A5.Ex7.m1.4.4.3.cmml" xref="A5.Ex7.m1.4.4.3"><in id="A5.Ex7.m1.4.4.3.4.cmml" xref="A5.Ex7.m1.4.4.3.4"></in><interval closure="open" id="A5.Ex7.m1.4.4.3.5.1.cmml" xref="A5.Ex7.m1.4.4.3.5.2"><ci id="A5.Ex7.m1.3.3.2.2.cmml" xref="A5.Ex7.m1.3.3.2.2">𝑥</ci><ci id="A5.Ex7.m1.4.4.3.3.cmml" xref="A5.Ex7.m1.4.4.3.3">𝑦</ci></interval><apply id="A5.Ex7.m1.4.4.3.6.cmml" xref="A5.Ex7.m1.4.4.3.6"><csymbol cd="ambiguous" id="A5.Ex7.m1.4.4.3.6.1.cmml" xref="A5.Ex7.m1.4.4.3.6">superscript</csymbol><ci id="A5.Ex7.m1.4.4.3.6.2.cmml" xref="A5.Ex7.m1.4.4.3.6.2">𝐷</ci><ci id="A5.Ex7.m1.2.2.1.1.1.1.cmml" xref="A5.Ex7.m1.2.2.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A5.Ex7.m1.7.7.1.1.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="A5.Ex7.m1.7.7.1.1.1.1.2.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.Ex7.m1.7.7.1.1.1.1.1.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1"><times id="A5.Ex7.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.2"></times><ci id="A5.Ex7.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.3">CE</ci><interval closure="open" id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1"><apply id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A5.Ex7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3">𝑥</ci></apply><ci id="A5.Ex7.m1.5.5.1.1.cmml" xref="A5.Ex7.m1.5.5.1.1">𝑖</ci></apply><ci id="A5.Ex7.m1.6.6.cmml" xref="A5.Ex7.m1.6.6">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex7.m1.7c">\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}\bigl{[}\mathrm{CE}(r_{x}^{(i)}%
,y)\bigr{]},</annotation><annotation encoding="application/x-llamapun" id="A5.Ex7.m1.7d">roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ roman_CE ( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS1.p1.6">where</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{x}^{(i)}\;=\;\mathrm{softmax}\!\Bigl{(}\tau\,w_{\mathrm{g}}^{(i)}\,\frac{\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(%
x)\|\,}\Bigr{)}." class="ltx_Math" display="block" id="A5.Ex8.m1.8"><semantics id="A5.Ex8.m1.8a"><mrow id="A5.Ex8.m1.8.8.1" xref="A5.Ex8.m1.8.8.1.1.cmml"><mrow id="A5.Ex8.m1.8.8.1.1" xref="A5.Ex8.m1.8.8.1.1.cmml"><msubsup id="A5.Ex8.m1.8.8.1.1.3" xref="A5.Ex8.m1.8.8.1.1.3.cmml"><mi id="A5.Ex8.m1.8.8.1.1.3.2.2" xref="A5.Ex8.m1.8.8.1.1.3.2.2.cmml">r</mi><mi id="A5.Ex8.m1.8.8.1.1.3.2.3" xref="A5.Ex8.m1.8.8.1.1.3.2.3.cmml">x</mi><mrow id="A5.Ex8.m1.1.1.1.3" xref="A5.Ex8.m1.8.8.1.1.3.cmml"><mo id="A5.Ex8.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex8.m1.8.8.1.1.3.cmml">(</mo><mi id="A5.Ex8.m1.1.1.1.1" xref="A5.Ex8.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex8.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex8.m1.8.8.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A5.Ex8.m1.8.8.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex8.m1.8.8.1.1.2.cmml">=</mo><mrow id="A5.Ex8.m1.8.8.1.1.1" xref="A5.Ex8.m1.8.8.1.1.1.cmml"><mpadded width="3.720em"><mi id="A5.Ex8.m1.8.8.1.1.1.3" xref="A5.Ex8.m1.8.8.1.1.1.3.cmml">softmax</mi></mpadded><mo id="A5.Ex8.m1.8.8.1.1.1.2" xref="A5.Ex8.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex8.m1.8.8.1.1.1.1.1" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.cmml"><mo id="A5.Ex8.m1.8.8.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.Ex8.m1.8.8.1.1.1.1.1.1" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.cmml"><mi id="A5.Ex8.m1.8.8.1.1.1.1.1.1.2" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.2.cmml">τ</mi><mo id="A5.Ex8.m1.8.8.1.1.1.1.1.1.1" lspace="0.170em" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.2" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.3" mathvariant="normal" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.3.cmml">g</mi><mrow id="A5.Ex8.m1.2.2.1.3" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml"><mo id="A5.Ex8.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml">(</mo><mi id="A5.Ex8.m1.2.2.1.1" xref="A5.Ex8.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex8.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A5.Ex8.m1.8.8.1.1.1.1.1.1.1a" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><mfrac id="A5.Ex8.m1.7.7" xref="A5.Ex8.m1.7.7.cmml"><mrow id="A5.Ex8.m1.4.4.2" xref="A5.Ex8.m1.4.4.2.cmml"><msubsup id="A5.Ex8.m1.4.4.2.4" xref="A5.Ex8.m1.4.4.2.4.cmml"><mi id="A5.Ex8.m1.4.4.2.4.2.2" xref="A5.Ex8.m1.4.4.2.4.2.2.cmml">w</mi><mi id="A5.Ex8.m1.4.4.2.4.2.3" mathvariant="normal" xref="A5.Ex8.m1.4.4.2.4.2.3.cmml">l</mi><mrow id="A5.Ex8.m1.3.3.1.1.1.3" xref="A5.Ex8.m1.4.4.2.4.cmml"><mo id="A5.Ex8.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex8.m1.4.4.2.4.cmml">(</mo><mi id="A5.Ex8.m1.3.3.1.1.1.1" xref="A5.Ex8.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A5.Ex8.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex8.m1.4.4.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex8.m1.4.4.2.3" lspace="0.170em" xref="A5.Ex8.m1.4.4.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex8.m1.4.4.2.5" xref="A5.Ex8.m1.4.4.2.5.cmml">ℐ</mi><mo id="A5.Ex8.m1.4.4.2.3a" xref="A5.Ex8.m1.4.4.2.3.cmml">⁢</mo><mrow id="A5.Ex8.m1.4.4.2.6.2" xref="A5.Ex8.m1.4.4.2.cmml"><mo id="A5.Ex8.m1.4.4.2.6.2.1" stretchy="false" xref="A5.Ex8.m1.4.4.2.cmml">(</mo><mi id="A5.Ex8.m1.4.4.2.2" xref="A5.Ex8.m1.4.4.2.2.cmml">x</mi><mo id="A5.Ex8.m1.4.4.2.6.2.2" stretchy="false" xref="A5.Ex8.m1.4.4.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex8.m1.7.7.5.3" xref="A5.Ex8.m1.7.7.5.4.cmml"><mo id="A5.Ex8.m1.7.7.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex8.m1.7.7.5.4.1.cmml">‖</mo><mrow id="A5.Ex8.m1.7.7.5.3.1" xref="A5.Ex8.m1.7.7.5.3.1.cmml"><msubsup id="A5.Ex8.m1.7.7.5.3.1.2" xref="A5.Ex8.m1.7.7.5.3.1.2.cmml"><mi id="A5.Ex8.m1.7.7.5.3.1.2.2.2" xref="A5.Ex8.m1.7.7.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex8.m1.7.7.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex8.m1.7.7.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex8.m1.5.5.3.1.1.3" xref="A5.Ex8.m1.7.7.5.3.1.2.cmml"><mo id="A5.Ex8.m1.5.5.3.1.1.3.1" stretchy="false" xref="A5.Ex8.m1.7.7.5.3.1.2.cmml">(</mo><mi id="A5.Ex8.m1.5.5.3.1.1.1" xref="A5.Ex8.m1.5.5.3.1.1.1.cmml">i</mi><mo id="A5.Ex8.m1.5.5.3.1.1.3.2" stretchy="false" xref="A5.Ex8.m1.7.7.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex8.m1.7.7.5.3.1.1" xref="A5.Ex8.m1.7.7.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex8.m1.7.7.5.3.1.3" xref="A5.Ex8.m1.7.7.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex8.m1.7.7.5.3.1.1a" xref="A5.Ex8.m1.7.7.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex8.m1.7.7.5.3.1.4.2" xref="A5.Ex8.m1.7.7.5.3.1.cmml"><mo id="A5.Ex8.m1.7.7.5.3.1.4.2.1" stretchy="false" xref="A5.Ex8.m1.7.7.5.3.1.cmml">(</mo><mi id="A5.Ex8.m1.6.6.4.2" xref="A5.Ex8.m1.6.6.4.2.cmml">x</mi><mo id="A5.Ex8.m1.7.7.5.3.1.4.2.2" stretchy="false" xref="A5.Ex8.m1.7.7.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex8.m1.7.7.5.3.3" stretchy="false" xref="A5.Ex8.m1.7.7.5.4.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A5.Ex8.m1.8.8.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex8.m1.8.8.1.2" lspace="0em" xref="A5.Ex8.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex8.m1.8b"><apply id="A5.Ex8.m1.8.8.1.1.cmml" xref="A5.Ex8.m1.8.8.1"><eq id="A5.Ex8.m1.8.8.1.1.2.cmml" xref="A5.Ex8.m1.8.8.1.1.2"></eq><apply id="A5.Ex8.m1.8.8.1.1.3.cmml" xref="A5.Ex8.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="A5.Ex8.m1.8.8.1.1.3.1.cmml" xref="A5.Ex8.m1.8.8.1.1.3">superscript</csymbol><apply id="A5.Ex8.m1.8.8.1.1.3.2.cmml" xref="A5.Ex8.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="A5.Ex8.m1.8.8.1.1.3.2.1.cmml" xref="A5.Ex8.m1.8.8.1.1.3">subscript</csymbol><ci id="A5.Ex8.m1.8.8.1.1.3.2.2.cmml" xref="A5.Ex8.m1.8.8.1.1.3.2.2">𝑟</ci><ci id="A5.Ex8.m1.8.8.1.1.3.2.3.cmml" xref="A5.Ex8.m1.8.8.1.1.3.2.3">𝑥</ci></apply><ci id="A5.Ex8.m1.1.1.1.1.cmml" xref="A5.Ex8.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.Ex8.m1.8.8.1.1.1.cmml" xref="A5.Ex8.m1.8.8.1.1.1"><times id="A5.Ex8.m1.8.8.1.1.1.2.cmml" xref="A5.Ex8.m1.8.8.1.1.1.2"></times><ci id="A5.Ex8.m1.8.8.1.1.1.3.cmml" xref="A5.Ex8.m1.8.8.1.1.1.3">softmax</ci><apply id="A5.Ex8.m1.8.8.1.1.1.1.1.1.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1"><times id="A5.Ex8.m1.8.8.1.1.1.1.1.1.1.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.1"></times><ci id="A5.Ex8.m1.8.8.1.1.1.1.1.1.2.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.2">𝜏</ci><apply id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3">superscript</csymbol><apply id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.1.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><ci id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.2.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.3.cmml" xref="A5.Ex8.m1.8.8.1.1.1.1.1.1.3.2.3">g</ci></apply><ci id="A5.Ex8.m1.2.2.1.1.cmml" xref="A5.Ex8.m1.2.2.1.1">𝑖</ci></apply><apply id="A5.Ex8.m1.7.7.cmml" xref="A5.Ex8.m1.7.7"><divide id="A5.Ex8.m1.7.7.6.cmml" xref="A5.Ex8.m1.7.7"></divide><apply id="A5.Ex8.m1.4.4.2.cmml" xref="A5.Ex8.m1.4.4.2"><times id="A5.Ex8.m1.4.4.2.3.cmml" xref="A5.Ex8.m1.4.4.2.3"></times><apply id="A5.Ex8.m1.4.4.2.4.cmml" xref="A5.Ex8.m1.4.4.2.4"><csymbol cd="ambiguous" id="A5.Ex8.m1.4.4.2.4.1.cmml" xref="A5.Ex8.m1.4.4.2.4">superscript</csymbol><apply id="A5.Ex8.m1.4.4.2.4.2.cmml" xref="A5.Ex8.m1.4.4.2.4"><csymbol cd="ambiguous" id="A5.Ex8.m1.4.4.2.4.2.1.cmml" xref="A5.Ex8.m1.4.4.2.4">subscript</csymbol><ci id="A5.Ex8.m1.4.4.2.4.2.2.cmml" xref="A5.Ex8.m1.4.4.2.4.2.2">𝑤</ci><ci id="A5.Ex8.m1.4.4.2.4.2.3.cmml" xref="A5.Ex8.m1.4.4.2.4.2.3">l</ci></apply><ci id="A5.Ex8.m1.3.3.1.1.1.1.cmml" xref="A5.Ex8.m1.3.3.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex8.m1.4.4.2.5.cmml" xref="A5.Ex8.m1.4.4.2.5">ℐ</ci><ci id="A5.Ex8.m1.4.4.2.2.cmml" xref="A5.Ex8.m1.4.4.2.2">𝑥</ci></apply><apply id="A5.Ex8.m1.7.7.5.4.cmml" xref="A5.Ex8.m1.7.7.5.3"><csymbol cd="latexml" id="A5.Ex8.m1.7.7.5.4.1.cmml" xref="A5.Ex8.m1.7.7.5.3.2">norm</csymbol><apply id="A5.Ex8.m1.7.7.5.3.1.cmml" xref="A5.Ex8.m1.7.7.5.3.1"><times id="A5.Ex8.m1.7.7.5.3.1.1.cmml" xref="A5.Ex8.m1.7.7.5.3.1.1"></times><apply id="A5.Ex8.m1.7.7.5.3.1.2.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex8.m1.7.7.5.3.1.2.1.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2">superscript</csymbol><apply id="A5.Ex8.m1.7.7.5.3.1.2.2.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex8.m1.7.7.5.3.1.2.2.1.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2">subscript</csymbol><ci id="A5.Ex8.m1.7.7.5.3.1.2.2.2.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex8.m1.7.7.5.3.1.2.2.3.cmml" xref="A5.Ex8.m1.7.7.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex8.m1.5.5.3.1.1.1.cmml" xref="A5.Ex8.m1.5.5.3.1.1.1">𝑖</ci></apply><ci id="A5.Ex8.m1.7.7.5.3.1.3.cmml" xref="A5.Ex8.m1.7.7.5.3.1.3">ℐ</ci><ci id="A5.Ex8.m1.6.6.4.2.cmml" xref="A5.Ex8.m1.6.6.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex8.m1.8c">r_{x}^{(i)}\;=\;\mathrm{softmax}\!\Bigl{(}\tau\,w_{\mathrm{g}}^{(i)}\,\frac{\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(%
x)\|\,}\Bigr{)}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex8.m1.8d">italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = roman_softmax ( italic_τ italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS1.p1.5">Here, <math alttext="\mathcal{I}(\cdot)" class="ltx_Math" display="inline" id="A5.SS1.p1.2.m1.1"><semantics id="A5.SS1.p1.2.m1.1a"><mrow id="A5.SS1.p1.2.m1.1.2" xref="A5.SS1.p1.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS1.p1.2.m1.1.2.2" xref="A5.SS1.p1.2.m1.1.2.2.cmml">ℐ</mi><mo id="A5.SS1.p1.2.m1.1.2.1" xref="A5.SS1.p1.2.m1.1.2.1.cmml">⁢</mo><mrow id="A5.SS1.p1.2.m1.1.2.3.2" xref="A5.SS1.p1.2.m1.1.2.cmml"><mo id="A5.SS1.p1.2.m1.1.2.3.2.1" stretchy="false" xref="A5.SS1.p1.2.m1.1.2.cmml">(</mo><mo id="A5.SS1.p1.2.m1.1.1" lspace="0em" rspace="0em" xref="A5.SS1.p1.2.m1.1.1.cmml">⋅</mo><mo id="A5.SS1.p1.2.m1.1.2.3.2.2" stretchy="false" xref="A5.SS1.p1.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.2.m1.1b"><apply id="A5.SS1.p1.2.m1.1.2.cmml" xref="A5.SS1.p1.2.m1.1.2"><times id="A5.SS1.p1.2.m1.1.2.1.cmml" xref="A5.SS1.p1.2.m1.1.2.1"></times><ci id="A5.SS1.p1.2.m1.1.2.2.cmml" xref="A5.SS1.p1.2.m1.1.2.2">ℐ</ci><ci id="A5.SS1.p1.2.m1.1.1.cmml" xref="A5.SS1.p1.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.2.m1.1c">\mathcal{I}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p1.2.m1.1d">caligraphic_I ( ⋅ )</annotation></semantics></math> is the (frozen) vision encoder, <math alttext="w_{\mathrm{g}}^{(i)}\in\mathbb{R}^{K\times d}" class="ltx_Math" display="inline" id="A5.SS1.p1.3.m2.1"><semantics id="A5.SS1.p1.3.m2.1a"><mrow id="A5.SS1.p1.3.m2.1.2" xref="A5.SS1.p1.3.m2.1.2.cmml"><msubsup id="A5.SS1.p1.3.m2.1.2.2" xref="A5.SS1.p1.3.m2.1.2.2.cmml"><mi id="A5.SS1.p1.3.m2.1.2.2.2.2" xref="A5.SS1.p1.3.m2.1.2.2.2.2.cmml">w</mi><mi id="A5.SS1.p1.3.m2.1.2.2.2.3" mathvariant="normal" xref="A5.SS1.p1.3.m2.1.2.2.2.3.cmml">g</mi><mrow id="A5.SS1.p1.3.m2.1.1.1.3" xref="A5.SS1.p1.3.m2.1.2.2.cmml"><mo id="A5.SS1.p1.3.m2.1.1.1.3.1" stretchy="false" xref="A5.SS1.p1.3.m2.1.2.2.cmml">(</mo><mi id="A5.SS1.p1.3.m2.1.1.1.1" xref="A5.SS1.p1.3.m2.1.1.1.1.cmml">i</mi><mo id="A5.SS1.p1.3.m2.1.1.1.3.2" stretchy="false" xref="A5.SS1.p1.3.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A5.SS1.p1.3.m2.1.2.1" xref="A5.SS1.p1.3.m2.1.2.1.cmml">∈</mo><msup id="A5.SS1.p1.3.m2.1.2.3" xref="A5.SS1.p1.3.m2.1.2.3.cmml"><mi id="A5.SS1.p1.3.m2.1.2.3.2" xref="A5.SS1.p1.3.m2.1.2.3.2.cmml">ℝ</mi><mrow id="A5.SS1.p1.3.m2.1.2.3.3" xref="A5.SS1.p1.3.m2.1.2.3.3.cmml"><mi id="A5.SS1.p1.3.m2.1.2.3.3.2" xref="A5.SS1.p1.3.m2.1.2.3.3.2.cmml">K</mi><mo id="A5.SS1.p1.3.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A5.SS1.p1.3.m2.1.2.3.3.1.cmml">×</mo><mi id="A5.SS1.p1.3.m2.1.2.3.3.3" xref="A5.SS1.p1.3.m2.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.3.m2.1b"><apply id="A5.SS1.p1.3.m2.1.2.cmml" xref="A5.SS1.p1.3.m2.1.2"><in id="A5.SS1.p1.3.m2.1.2.1.cmml" xref="A5.SS1.p1.3.m2.1.2.1"></in><apply id="A5.SS1.p1.3.m2.1.2.2.cmml" xref="A5.SS1.p1.3.m2.1.2.2"><csymbol cd="ambiguous" id="A5.SS1.p1.3.m2.1.2.2.1.cmml" xref="A5.SS1.p1.3.m2.1.2.2">superscript</csymbol><apply id="A5.SS1.p1.3.m2.1.2.2.2.cmml" xref="A5.SS1.p1.3.m2.1.2.2"><csymbol cd="ambiguous" id="A5.SS1.p1.3.m2.1.2.2.2.1.cmml" xref="A5.SS1.p1.3.m2.1.2.2">subscript</csymbol><ci id="A5.SS1.p1.3.m2.1.2.2.2.2.cmml" xref="A5.SS1.p1.3.m2.1.2.2.2.2">𝑤</ci><ci id="A5.SS1.p1.3.m2.1.2.2.2.3.cmml" xref="A5.SS1.p1.3.m2.1.2.2.2.3">g</ci></apply><ci id="A5.SS1.p1.3.m2.1.1.1.1.cmml" xref="A5.SS1.p1.3.m2.1.1.1.1">𝑖</ci></apply><apply id="A5.SS1.p1.3.m2.1.2.3.cmml" xref="A5.SS1.p1.3.m2.1.2.3"><csymbol cd="ambiguous" id="A5.SS1.p1.3.m2.1.2.3.1.cmml" xref="A5.SS1.p1.3.m2.1.2.3">superscript</csymbol><ci id="A5.SS1.p1.3.m2.1.2.3.2.cmml" xref="A5.SS1.p1.3.m2.1.2.3.2">ℝ</ci><apply id="A5.SS1.p1.3.m2.1.2.3.3.cmml" xref="A5.SS1.p1.3.m2.1.2.3.3"><times id="A5.SS1.p1.3.m2.1.2.3.3.1.cmml" xref="A5.SS1.p1.3.m2.1.2.3.3.1"></times><ci id="A5.SS1.p1.3.m2.1.2.3.3.2.cmml" xref="A5.SS1.p1.3.m2.1.2.3.3.2">𝐾</ci><ci id="A5.SS1.p1.3.m2.1.2.3.3.3.cmml" xref="A5.SS1.p1.3.m2.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.3.m2.1c">w_{\mathrm{g}}^{(i)}\in\mathbb{R}^{K\times d}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p1.3.m2.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the global classifier for client <math alttext="i" class="ltx_Math" display="inline" id="A5.SS1.p1.4.m3.1"><semantics id="A5.SS1.p1.4.m3.1a"><mi id="A5.SS1.p1.4.m3.1.1" xref="A5.SS1.p1.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.4.m3.1b"><ci id="A5.SS1.p1.4.m3.1.1.cmml" xref="A5.SS1.p1.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.4.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p1.4.m3.1d">italic_i</annotation></semantics></math>, and <math alttext="w_{\mathrm{l}}^{(i)}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A5.SS1.p1.5.m4.1"><semantics id="A5.SS1.p1.5.m4.1a"><mrow id="A5.SS1.p1.5.m4.1.2" xref="A5.SS1.p1.5.m4.1.2.cmml"><msubsup id="A5.SS1.p1.5.m4.1.2.2" xref="A5.SS1.p1.5.m4.1.2.2.cmml"><mi id="A5.SS1.p1.5.m4.1.2.2.2.2" xref="A5.SS1.p1.5.m4.1.2.2.2.2.cmml">w</mi><mi id="A5.SS1.p1.5.m4.1.2.2.2.3" mathvariant="normal" xref="A5.SS1.p1.5.m4.1.2.2.2.3.cmml">l</mi><mrow id="A5.SS1.p1.5.m4.1.1.1.3" xref="A5.SS1.p1.5.m4.1.2.2.cmml"><mo id="A5.SS1.p1.5.m4.1.1.1.3.1" stretchy="false" xref="A5.SS1.p1.5.m4.1.2.2.cmml">(</mo><mi id="A5.SS1.p1.5.m4.1.1.1.1" xref="A5.SS1.p1.5.m4.1.1.1.1.cmml">i</mi><mo id="A5.SS1.p1.5.m4.1.1.1.3.2" stretchy="false" xref="A5.SS1.p1.5.m4.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A5.SS1.p1.5.m4.1.2.1" xref="A5.SS1.p1.5.m4.1.2.1.cmml">∈</mo><msup id="A5.SS1.p1.5.m4.1.2.3" xref="A5.SS1.p1.5.m4.1.2.3.cmml"><mi id="A5.SS1.p1.5.m4.1.2.3.2" xref="A5.SS1.p1.5.m4.1.2.3.2.cmml">ℝ</mi><mrow id="A5.SS1.p1.5.m4.1.2.3.3" xref="A5.SS1.p1.5.m4.1.2.3.3.cmml"><mi id="A5.SS1.p1.5.m4.1.2.3.3.2" xref="A5.SS1.p1.5.m4.1.2.3.3.2.cmml">d</mi><mo id="A5.SS1.p1.5.m4.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A5.SS1.p1.5.m4.1.2.3.3.1.cmml">×</mo><mi id="A5.SS1.p1.5.m4.1.2.3.3.3" xref="A5.SS1.p1.5.m4.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.5.m4.1b"><apply id="A5.SS1.p1.5.m4.1.2.cmml" xref="A5.SS1.p1.5.m4.1.2"><in id="A5.SS1.p1.5.m4.1.2.1.cmml" xref="A5.SS1.p1.5.m4.1.2.1"></in><apply id="A5.SS1.p1.5.m4.1.2.2.cmml" xref="A5.SS1.p1.5.m4.1.2.2"><csymbol cd="ambiguous" id="A5.SS1.p1.5.m4.1.2.2.1.cmml" xref="A5.SS1.p1.5.m4.1.2.2">superscript</csymbol><apply id="A5.SS1.p1.5.m4.1.2.2.2.cmml" xref="A5.SS1.p1.5.m4.1.2.2"><csymbol cd="ambiguous" id="A5.SS1.p1.5.m4.1.2.2.2.1.cmml" xref="A5.SS1.p1.5.m4.1.2.2">subscript</csymbol><ci id="A5.SS1.p1.5.m4.1.2.2.2.2.cmml" xref="A5.SS1.p1.5.m4.1.2.2.2.2">𝑤</ci><ci id="A5.SS1.p1.5.m4.1.2.2.2.3.cmml" xref="A5.SS1.p1.5.m4.1.2.2.2.3">l</ci></apply><ci id="A5.SS1.p1.5.m4.1.1.1.1.cmml" xref="A5.SS1.p1.5.m4.1.1.1.1">𝑖</ci></apply><apply id="A5.SS1.p1.5.m4.1.2.3.cmml" xref="A5.SS1.p1.5.m4.1.2.3"><csymbol cd="ambiguous" id="A5.SS1.p1.5.m4.1.2.3.1.cmml" xref="A5.SS1.p1.5.m4.1.2.3">superscript</csymbol><ci id="A5.SS1.p1.5.m4.1.2.3.2.cmml" xref="A5.SS1.p1.5.m4.1.2.3.2">ℝ</ci><apply id="A5.SS1.p1.5.m4.1.2.3.3.cmml" xref="A5.SS1.p1.5.m4.1.2.3.3"><times id="A5.SS1.p1.5.m4.1.2.3.3.1.cmml" xref="A5.SS1.p1.5.m4.1.2.3.3.1"></times><ci id="A5.SS1.p1.5.m4.1.2.3.3.2.cmml" xref="A5.SS1.p1.5.m4.1.2.3.3.2">𝑑</ci><ci id="A5.SS1.p1.5.m4.1.2.3.3.3.cmml" xref="A5.SS1.p1.5.m4.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.5.m4.1c">w_{\mathrm{l}}^{(i)}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p1.5.m4.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the local linear transformation. A standard derivative computation gives</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}%
\Bigl{[}\tau\,\bigl{(}r_{x}^{(i)}-y\bigr{)}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{%
(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^%
{\!\top}\Bigr{]}." class="ltx_Math" display="block" id="A5.Ex9.m1.12"><semantics id="A5.Ex9.m1.12a"><mrow id="A5.Ex9.m1.12.12.1" xref="A5.Ex9.m1.12.12.1.1.cmml"><mrow id="A5.Ex9.m1.12.12.1.1" xref="A5.Ex9.m1.12.12.1.1.cmml"><mrow id="A5.Ex9.m1.12.12.1.1.3" xref="A5.Ex9.m1.12.12.1.1.3.cmml"><msub id="A5.Ex9.m1.12.12.1.1.3.1" xref="A5.Ex9.m1.12.12.1.1.3.1.cmml"><mo id="A5.Ex9.m1.12.12.1.1.3.1.2" xref="A5.Ex9.m1.12.12.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.Ex9.m1.1.1.1" xref="A5.Ex9.m1.1.1.1.cmml"><mi id="A5.Ex9.m1.1.1.1.3.2" xref="A5.Ex9.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.Ex9.m1.1.1.1.3.3" mathvariant="normal" xref="A5.Ex9.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.Ex9.m1.1.1.1.1.1.3" xref="A5.Ex9.m1.1.1.1.cmml"><mo id="A5.Ex9.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex9.m1.1.1.1.cmml">(</mo><mi id="A5.Ex9.m1.1.1.1.1.1.1" xref="A5.Ex9.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex9.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex9.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex9.m1.12.12.1.1.3.2" xref="A5.Ex9.m1.12.12.1.1.3.2.cmml"><mi id="A5.Ex9.m1.12.12.1.1.3.2.2" mathvariant="normal" xref="A5.Ex9.m1.12.12.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.Ex9.m1.2.2.1.3" xref="A5.Ex9.m1.12.12.1.1.3.2.cmml"><mo id="A5.Ex9.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex9.m1.12.12.1.1.3.2.cmml">(</mo><mi id="A5.Ex9.m1.2.2.1.1" xref="A5.Ex9.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex9.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex9.m1.12.12.1.1.3.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.Ex9.m1.12.12.1.1.2" rspace="0.558em" xref="A5.Ex9.m1.12.12.1.1.2.cmml">=</mo><mrow id="A5.Ex9.m1.12.12.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.cmml"><msub id="A5.Ex9.m1.12.12.1.1.1.3" xref="A5.Ex9.m1.12.12.1.1.1.3.cmml"><mi id="A5.Ex9.m1.12.12.1.1.1.3.2" xref="A5.Ex9.m1.12.12.1.1.1.3.2.cmml">𝔼</mi><mrow id="A5.Ex9.m1.5.5.3" xref="A5.Ex9.m1.5.5.3.cmml"><mrow id="A5.Ex9.m1.5.5.3.5.2" xref="A5.Ex9.m1.5.5.3.5.1.cmml"><mo id="A5.Ex9.m1.5.5.3.5.2.1" stretchy="false" xref="A5.Ex9.m1.5.5.3.5.1.cmml">(</mo><mi id="A5.Ex9.m1.4.4.2.2" xref="A5.Ex9.m1.4.4.2.2.cmml">x</mi><mo id="A5.Ex9.m1.5.5.3.5.2.2" xref="A5.Ex9.m1.5.5.3.5.1.cmml">,</mo><mi id="A5.Ex9.m1.5.5.3.3" xref="A5.Ex9.m1.5.5.3.3.cmml">y</mi><mo id="A5.Ex9.m1.5.5.3.5.2.3" rspace="0.170em" stretchy="false" xref="A5.Ex9.m1.5.5.3.5.1.cmml">)</mo></mrow><mo id="A5.Ex9.m1.5.5.3.4" rspace="0.448em" xref="A5.Ex9.m1.5.5.3.4.cmml">∈</mo><msup id="A5.Ex9.m1.5.5.3.6" xref="A5.Ex9.m1.5.5.3.6.cmml"><mi id="A5.Ex9.m1.5.5.3.6.2" xref="A5.Ex9.m1.5.5.3.6.2.cmml">D</mi><mrow id="A5.Ex9.m1.3.3.1.1.1.3" xref="A5.Ex9.m1.5.5.3.6.cmml"><mo id="A5.Ex9.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex9.m1.5.5.3.6.cmml">(</mo><mi id="A5.Ex9.m1.3.3.1.1.1.1" xref="A5.Ex9.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A5.Ex9.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex9.m1.5.5.3.6.cmml">)</mo></mrow></msup></mrow></msub><mo id="A5.Ex9.m1.12.12.1.1.1.2" xref="A5.Ex9.m1.12.12.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex9.m1.12.12.1.1.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.1.2.cmml"><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A5.Ex9.m1.12.12.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.Ex9.m1.12.12.1.1.1.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.cmml"><mi id="A5.Ex9.m1.12.12.1.1.1.1.1.1.3" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.3.cmml">τ</mi><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.2" lspace="0.170em" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.2" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.3" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.3.cmml">x</mi><mrow id="A5.Ex9.m1.6.6.1.3" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A5.Ex9.m1.6.6.1.3.1" stretchy="false" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A5.Ex9.m1.6.6.1.1" xref="A5.Ex9.m1.6.6.1.1.cmml">i</mi><mo id="A5.Ex9.m1.6.6.1.3.2" stretchy="false" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.1" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.3" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.2a" lspace="0.170em" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.cmml"><mrow id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.2.2" xref="A5.Ex9.m1.11.11.cmml"><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.2.2.1" maxsize="160%" minsize="160%" xref="A5.Ex9.m1.11.11.cmml">(</mo><mstyle displaystyle="false" id="A5.Ex9.m1.11.11" xref="A5.Ex9.m1.11.11.cmml"><mfrac id="A5.Ex9.m1.11.11a" xref="A5.Ex9.m1.11.11.cmml"><mrow id="A5.Ex9.m1.8.8.2" xref="A5.Ex9.m1.8.8.2.cmml"><msubsup id="A5.Ex9.m1.8.8.2.4" xref="A5.Ex9.m1.8.8.2.4.cmml"><mi id="A5.Ex9.m1.8.8.2.4.2.2" xref="A5.Ex9.m1.8.8.2.4.2.2.cmml">w</mi><mi id="A5.Ex9.m1.8.8.2.4.2.3" mathvariant="normal" xref="A5.Ex9.m1.8.8.2.4.2.3.cmml">l</mi><mrow id="A5.Ex9.m1.7.7.1.1.1.3" xref="A5.Ex9.m1.8.8.2.4.cmml"><mo id="A5.Ex9.m1.7.7.1.1.1.3.1" stretchy="false" xref="A5.Ex9.m1.8.8.2.4.cmml">(</mo><mi id="A5.Ex9.m1.7.7.1.1.1.1" xref="A5.Ex9.m1.7.7.1.1.1.1.cmml">i</mi><mo id="A5.Ex9.m1.7.7.1.1.1.3.2" stretchy="false" xref="A5.Ex9.m1.8.8.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex9.m1.8.8.2.3" lspace="0.170em" xref="A5.Ex9.m1.8.8.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex9.m1.8.8.2.5" xref="A5.Ex9.m1.8.8.2.5.cmml">ℐ</mi><mo id="A5.Ex9.m1.8.8.2.3a" xref="A5.Ex9.m1.8.8.2.3.cmml">⁢</mo><mrow id="A5.Ex9.m1.8.8.2.6.2" xref="A5.Ex9.m1.8.8.2.cmml"><mo id="A5.Ex9.m1.8.8.2.6.2.1" stretchy="false" xref="A5.Ex9.m1.8.8.2.cmml">(</mo><mi id="A5.Ex9.m1.8.8.2.2" xref="A5.Ex9.m1.8.8.2.2.cmml">x</mi><mo id="A5.Ex9.m1.8.8.2.6.2.2" stretchy="false" xref="A5.Ex9.m1.8.8.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex9.m1.11.11.5.3" xref="A5.Ex9.m1.11.11.5.4.cmml"><mo id="A5.Ex9.m1.11.11.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex9.m1.11.11.5.4.1.cmml">‖</mo><mrow id="A5.Ex9.m1.11.11.5.3.1" xref="A5.Ex9.m1.11.11.5.3.1.cmml"><msubsup id="A5.Ex9.m1.11.11.5.3.1.2" xref="A5.Ex9.m1.11.11.5.3.1.2.cmml"><mi id="A5.Ex9.m1.11.11.5.3.1.2.2.2" xref="A5.Ex9.m1.11.11.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex9.m1.11.11.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex9.m1.11.11.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex9.m1.9.9.3.1.1.3" xref="A5.Ex9.m1.11.11.5.3.1.2.cmml"><mo id="A5.Ex9.m1.9.9.3.1.1.3.1" stretchy="false" xref="A5.Ex9.m1.11.11.5.3.1.2.cmml">(</mo><mi id="A5.Ex9.m1.9.9.3.1.1.1" xref="A5.Ex9.m1.9.9.3.1.1.1.cmml">i</mi><mo id="A5.Ex9.m1.9.9.3.1.1.3.2" stretchy="false" xref="A5.Ex9.m1.11.11.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex9.m1.11.11.5.3.1.1" xref="A5.Ex9.m1.11.11.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex9.m1.11.11.5.3.1.3" xref="A5.Ex9.m1.11.11.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex9.m1.11.11.5.3.1.1a" xref="A5.Ex9.m1.11.11.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex9.m1.11.11.5.3.1.4.2" xref="A5.Ex9.m1.11.11.5.3.1.cmml"><mo id="A5.Ex9.m1.11.11.5.3.1.4.2.1" stretchy="false" xref="A5.Ex9.m1.11.11.5.3.1.cmml">(</mo><mi id="A5.Ex9.m1.10.10.4.2" xref="A5.Ex9.m1.10.10.4.2.cmml">x</mi><mo id="A5.Ex9.m1.11.11.5.3.1.4.2.2" stretchy="false" xref="A5.Ex9.m1.11.11.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex9.m1.11.11.5.3.3" stretchy="false" xref="A5.Ex9.m1.11.11.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.2.2.2" maxsize="160%" minsize="160%" xref="A5.Ex9.m1.11.11.cmml">)</mo></mrow><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.3" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup></mrow><mo id="A5.Ex9.m1.12.12.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A5.Ex9.m1.12.12.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.Ex9.m1.12.12.1.2" lspace="0em" xref="A5.Ex9.m1.12.12.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex9.m1.12b"><apply id="A5.Ex9.m1.12.12.1.1.cmml" xref="A5.Ex9.m1.12.12.1"><eq id="A5.Ex9.m1.12.12.1.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.2"></eq><apply id="A5.Ex9.m1.12.12.1.1.3.cmml" xref="A5.Ex9.m1.12.12.1.1.3"><apply id="A5.Ex9.m1.12.12.1.1.3.1.cmml" xref="A5.Ex9.m1.12.12.1.1.3.1"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.3.1.1.cmml" xref="A5.Ex9.m1.12.12.1.1.3.1">subscript</csymbol><ci id="A5.Ex9.m1.12.12.1.1.3.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.3.1.2">∇</ci><apply id="A5.Ex9.m1.1.1.1.cmml" xref="A5.Ex9.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex9.m1.1.1.1.2.cmml" xref="A5.Ex9.m1.1.1.1">superscript</csymbol><apply id="A5.Ex9.m1.1.1.1.3.cmml" xref="A5.Ex9.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex9.m1.1.1.1.3.1.cmml" xref="A5.Ex9.m1.1.1.1">subscript</csymbol><ci id="A5.Ex9.m1.1.1.1.3.2.cmml" xref="A5.Ex9.m1.1.1.1.3.2">𝑤</ci><ci id="A5.Ex9.m1.1.1.1.3.3.cmml" xref="A5.Ex9.m1.1.1.1.3.3">g</ci></apply><ci id="A5.Ex9.m1.1.1.1.1.1.1.cmml" xref="A5.Ex9.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex9.m1.12.12.1.1.3.2.cmml" xref="A5.Ex9.m1.12.12.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.3.2.1.cmml" xref="A5.Ex9.m1.12.12.1.1.3.2">superscript</csymbol><ci id="A5.Ex9.m1.12.12.1.1.3.2.2.cmml" xref="A5.Ex9.m1.12.12.1.1.3.2.2">ℓ</ci><ci id="A5.Ex9.m1.2.2.1.1.cmml" xref="A5.Ex9.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.Ex9.m1.12.12.1.1.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1"><times id="A5.Ex9.m1.12.12.1.1.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.2"></times><apply id="A5.Ex9.m1.12.12.1.1.1.3.cmml" xref="A5.Ex9.m1.12.12.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.1.3.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.3">subscript</csymbol><ci id="A5.Ex9.m1.12.12.1.1.1.3.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.3.2">𝔼</ci><apply id="A5.Ex9.m1.5.5.3.cmml" xref="A5.Ex9.m1.5.5.3"><in id="A5.Ex9.m1.5.5.3.4.cmml" xref="A5.Ex9.m1.5.5.3.4"></in><interval closure="open" id="A5.Ex9.m1.5.5.3.5.1.cmml" xref="A5.Ex9.m1.5.5.3.5.2"><ci id="A5.Ex9.m1.4.4.2.2.cmml" xref="A5.Ex9.m1.4.4.2.2">𝑥</ci><ci id="A5.Ex9.m1.5.5.3.3.cmml" xref="A5.Ex9.m1.5.5.3.3">𝑦</ci></interval><apply id="A5.Ex9.m1.5.5.3.6.cmml" xref="A5.Ex9.m1.5.5.3.6"><csymbol cd="ambiguous" id="A5.Ex9.m1.5.5.3.6.1.cmml" xref="A5.Ex9.m1.5.5.3.6">superscript</csymbol><ci id="A5.Ex9.m1.5.5.3.6.2.cmml" xref="A5.Ex9.m1.5.5.3.6.2">𝐷</ci><ci id="A5.Ex9.m1.3.3.1.1.1.1.cmml" xref="A5.Ex9.m1.3.3.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A5.Ex9.m1.12.12.1.1.1.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1"><csymbol cd="latexml" id="A5.Ex9.m1.12.12.1.1.1.1.2.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.Ex9.m1.12.12.1.1.1.1.1.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1"><times id="A5.Ex9.m1.12.12.1.1.1.1.1.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.2"></times><ci id="A5.Ex9.m1.12.12.1.1.1.1.1.1.3.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.3">𝜏</ci><apply id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1"><minus id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.3">𝑥</ci></apply><ci id="A5.Ex9.m1.6.6.1.1.cmml" xref="A5.Ex9.m1.6.6.1.1">𝑖</ci></apply><ci id="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.1.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4">superscript</csymbol><apply id="A5.Ex9.m1.11.11.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.2.2"><divide id="A5.Ex9.m1.11.11.6.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.2.2"></divide><apply id="A5.Ex9.m1.8.8.2.cmml" xref="A5.Ex9.m1.8.8.2"><times id="A5.Ex9.m1.8.8.2.3.cmml" xref="A5.Ex9.m1.8.8.2.3"></times><apply id="A5.Ex9.m1.8.8.2.4.cmml" xref="A5.Ex9.m1.8.8.2.4"><csymbol cd="ambiguous" id="A5.Ex9.m1.8.8.2.4.1.cmml" xref="A5.Ex9.m1.8.8.2.4">superscript</csymbol><apply id="A5.Ex9.m1.8.8.2.4.2.cmml" xref="A5.Ex9.m1.8.8.2.4"><csymbol cd="ambiguous" id="A5.Ex9.m1.8.8.2.4.2.1.cmml" xref="A5.Ex9.m1.8.8.2.4">subscript</csymbol><ci id="A5.Ex9.m1.8.8.2.4.2.2.cmml" xref="A5.Ex9.m1.8.8.2.4.2.2">𝑤</ci><ci id="A5.Ex9.m1.8.8.2.4.2.3.cmml" xref="A5.Ex9.m1.8.8.2.4.2.3">l</ci></apply><ci id="A5.Ex9.m1.7.7.1.1.1.1.cmml" xref="A5.Ex9.m1.7.7.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex9.m1.8.8.2.5.cmml" xref="A5.Ex9.m1.8.8.2.5">ℐ</ci><ci id="A5.Ex9.m1.8.8.2.2.cmml" xref="A5.Ex9.m1.8.8.2.2">𝑥</ci></apply><apply id="A5.Ex9.m1.11.11.5.4.cmml" xref="A5.Ex9.m1.11.11.5.3"><csymbol cd="latexml" id="A5.Ex9.m1.11.11.5.4.1.cmml" xref="A5.Ex9.m1.11.11.5.3.2">norm</csymbol><apply id="A5.Ex9.m1.11.11.5.3.1.cmml" xref="A5.Ex9.m1.11.11.5.3.1"><times id="A5.Ex9.m1.11.11.5.3.1.1.cmml" xref="A5.Ex9.m1.11.11.5.3.1.1"></times><apply id="A5.Ex9.m1.11.11.5.3.1.2.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex9.m1.11.11.5.3.1.2.1.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2">superscript</csymbol><apply id="A5.Ex9.m1.11.11.5.3.1.2.2.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex9.m1.11.11.5.3.1.2.2.1.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2">subscript</csymbol><ci id="A5.Ex9.m1.11.11.5.3.1.2.2.2.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex9.m1.11.11.5.3.1.2.2.3.cmml" xref="A5.Ex9.m1.11.11.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex9.m1.9.9.3.1.1.1.cmml" xref="A5.Ex9.m1.9.9.3.1.1.1">𝑖</ci></apply><ci id="A5.Ex9.m1.11.11.5.3.1.3.cmml" xref="A5.Ex9.m1.11.11.5.3.1.3">ℐ</ci><ci id="A5.Ex9.m1.10.10.4.2.cmml" xref="A5.Ex9.m1.10.10.4.2">𝑥</ci></apply></apply></apply><csymbol cd="latexml" id="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.3.cmml" xref="A5.Ex9.m1.12.12.1.1.1.1.1.1.4.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex9.m1.12c">\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}%
\Bigl{[}\tau\,\bigl{(}r_{x}^{(i)}-y\bigr{)}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{%
(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^%
{\!\top}\Bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex9.m1.12d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ italic_τ ( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_y ) ( divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS1.p2">
<p class="ltx_p" id="A5.SS1.p2.2"><span class="ltx_text ltx_font_bold" id="A5.SS1.p2.2.1">Linear Transformation Assumption.</span> 
We identify <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A5.SS1.p2.1.m1.1"><semantics id="A5.SS1.p2.1.m1.1a"><msubsup id="A5.SS1.p2.1.m1.1.2" xref="A5.SS1.p2.1.m1.1.2.cmml"><mi id="A5.SS1.p2.1.m1.1.2.2.2" xref="A5.SS1.p2.1.m1.1.2.2.2.cmml">w</mi><mi id="A5.SS1.p2.1.m1.1.2.2.3" mathvariant="normal" xref="A5.SS1.p2.1.m1.1.2.2.3.cmml">l</mi><mrow id="A5.SS1.p2.1.m1.1.1.1.3" xref="A5.SS1.p2.1.m1.1.2.cmml"><mo id="A5.SS1.p2.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="A5.SS1.p2.1.m1.1.1.1.1" xref="A5.SS1.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS1.p2.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.1.m1.1b"><apply id="A5.SS1.p2.1.m1.1.2.cmml" xref="A5.SS1.p2.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS1.p2.1.m1.1.2.1.cmml" xref="A5.SS1.p2.1.m1.1.2">superscript</csymbol><apply id="A5.SS1.p2.1.m1.1.2.2.cmml" xref="A5.SS1.p2.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS1.p2.1.m1.1.2.2.1.cmml" xref="A5.SS1.p2.1.m1.1.2">subscript</csymbol><ci id="A5.SS1.p2.1.m1.1.2.2.2.cmml" xref="A5.SS1.p2.1.m1.1.2.2.2">𝑤</ci><ci id="A5.SS1.p2.1.m1.1.2.2.3.cmml" xref="A5.SS1.p2.1.m1.1.2.2.3">l</ci></apply><ci id="A5.SS1.p2.1.m1.1.1.1.1.cmml" xref="A5.SS1.p2.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.1.m1.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.1.m1.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> as the client-specific linear map in <math alttext="\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A5.SS1.p2.2.m2.1"><semantics id="A5.SS1.p2.2.m2.1a"><msup id="A5.SS1.p2.2.m2.1.1" xref="A5.SS1.p2.2.m2.1.1.cmml"><mi id="A5.SS1.p2.2.m2.1.1.2" xref="A5.SS1.p2.2.m2.1.1.2.cmml">ℝ</mi><mrow id="A5.SS1.p2.2.m2.1.1.3" xref="A5.SS1.p2.2.m2.1.1.3.cmml"><mi id="A5.SS1.p2.2.m2.1.1.3.2" xref="A5.SS1.p2.2.m2.1.1.3.2.cmml">d</mi><mo id="A5.SS1.p2.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A5.SS1.p2.2.m2.1.1.3.1.cmml">×</mo><mi id="A5.SS1.p2.2.m2.1.1.3.3" xref="A5.SS1.p2.2.m2.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.2.m2.1b"><apply id="A5.SS1.p2.2.m2.1.1.cmml" xref="A5.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.2.m2.1.1.1.cmml" xref="A5.SS1.p2.2.m2.1.1">superscript</csymbol><ci id="A5.SS1.p2.2.m2.1.1.2.cmml" xref="A5.SS1.p2.2.m2.1.1.2">ℝ</ci><apply id="A5.SS1.p2.2.m2.1.1.3.cmml" xref="A5.SS1.p2.2.m2.1.1.3"><times id="A5.SS1.p2.2.m2.1.1.3.1.cmml" xref="A5.SS1.p2.2.m2.1.1.3.1"></times><ci id="A5.SS1.p2.2.m2.1.1.3.2.cmml" xref="A5.SS1.p2.2.m2.1.1.3.2">𝑑</ci><ci id="A5.SS1.p2.2.m2.1.1.3.3.cmml" xref="A5.SS1.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.2.m2.1c">\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Then,</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{I}^{\prime(i)}(x)\;=\;w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)." class="ltx_Math" display="block" id="A5.Ex10.m1.7"><semantics id="A5.Ex10.m1.7a"><mrow id="A5.Ex10.m1.7.7.1" xref="A5.Ex10.m1.7.7.1.1.cmml"><mrow id="A5.Ex10.m1.7.7.1.1" xref="A5.Ex10.m1.7.7.1.1.cmml"><mrow id="A5.Ex10.m1.7.7.1.1.2" xref="A5.Ex10.m1.7.7.1.1.2.cmml"><msup id="A5.Ex10.m1.7.7.1.1.2.2" xref="A5.Ex10.m1.7.7.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.Ex10.m1.7.7.1.1.2.2.2" xref="A5.Ex10.m1.7.7.1.1.2.2.2.cmml">ℐ</mi><mrow id="A5.Ex10.m1.3.3.3.3" xref="A5.Ex10.m1.3.3.3.4.cmml"><mo id="A5.Ex10.m1.2.2.2.2.1" mathsize="142%" xref="A5.Ex10.m1.2.2.2.2.1.cmml">′</mo><mo id="A5.Ex10.m1.3.3.3.3.3" lspace="0em" xref="A5.Ex10.m1.3.3.3.4.cmml">⁣</mo><mrow id="A5.Ex10.m1.3.3.3.3.2.2" xref="A5.Ex10.m1.3.3.3.4.cmml"><mo id="A5.Ex10.m1.3.3.3.3.2.2.1" stretchy="false" xref="A5.Ex10.m1.3.3.3.4.cmml">(</mo><mi id="A5.Ex10.m1.1.1.1.1" xref="A5.Ex10.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex10.m1.3.3.3.3.2.2.2" stretchy="false" xref="A5.Ex10.m1.3.3.3.4.cmml">)</mo></mrow></mrow></msup><mo id="A5.Ex10.m1.7.7.1.1.2.1" xref="A5.Ex10.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="A5.Ex10.m1.7.7.1.1.2.3.2" xref="A5.Ex10.m1.7.7.1.1.2.cmml"><mo id="A5.Ex10.m1.7.7.1.1.2.3.2.1" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.2.cmml">(</mo><mi id="A5.Ex10.m1.5.5" xref="A5.Ex10.m1.5.5.cmml">x</mi><mo id="A5.Ex10.m1.7.7.1.1.2.3.2.2" rspace="0.280em" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo id="A5.Ex10.m1.7.7.1.1.1" rspace="0.558em" xref="A5.Ex10.m1.7.7.1.1.1.cmml">=</mo><mrow id="A5.Ex10.m1.7.7.1.1.3" xref="A5.Ex10.m1.7.7.1.1.3.cmml"><msubsup id="A5.Ex10.m1.7.7.1.1.3.2" xref="A5.Ex10.m1.7.7.1.1.3.2.cmml"><mi id="A5.Ex10.m1.7.7.1.1.3.2.2.2" xref="A5.Ex10.m1.7.7.1.1.3.2.2.2.cmml">w</mi><mi id="A5.Ex10.m1.7.7.1.1.3.2.2.3" mathvariant="normal" xref="A5.Ex10.m1.7.7.1.1.3.2.2.3.cmml">l</mi><mrow id="A5.Ex10.m1.4.4.1.3" xref="A5.Ex10.m1.7.7.1.1.3.2.cmml"><mo id="A5.Ex10.m1.4.4.1.3.1" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.3.2.cmml">(</mo><mi id="A5.Ex10.m1.4.4.1.1" xref="A5.Ex10.m1.4.4.1.1.cmml">i</mi><mo id="A5.Ex10.m1.4.4.1.3.2" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex10.m1.7.7.1.1.3.1" xref="A5.Ex10.m1.7.7.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex10.m1.7.7.1.1.3.3" xref="A5.Ex10.m1.7.7.1.1.3.3.cmml">ℐ</mi><mo id="A5.Ex10.m1.7.7.1.1.3.1a" xref="A5.Ex10.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="A5.Ex10.m1.7.7.1.1.3.4.2" xref="A5.Ex10.m1.7.7.1.1.3.cmml"><mo id="A5.Ex10.m1.7.7.1.1.3.4.2.1" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.3.cmml">(</mo><mi id="A5.Ex10.m1.6.6" xref="A5.Ex10.m1.6.6.cmml">x</mi><mo id="A5.Ex10.m1.7.7.1.1.3.4.2.2" stretchy="false" xref="A5.Ex10.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex10.m1.7.7.1.2" lspace="0em" xref="A5.Ex10.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex10.m1.7b"><apply id="A5.Ex10.m1.7.7.1.1.cmml" xref="A5.Ex10.m1.7.7.1"><eq id="A5.Ex10.m1.7.7.1.1.1.cmml" xref="A5.Ex10.m1.7.7.1.1.1"></eq><apply id="A5.Ex10.m1.7.7.1.1.2.cmml" xref="A5.Ex10.m1.7.7.1.1.2"><times id="A5.Ex10.m1.7.7.1.1.2.1.cmml" xref="A5.Ex10.m1.7.7.1.1.2.1"></times><apply id="A5.Ex10.m1.7.7.1.1.2.2.cmml" xref="A5.Ex10.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="A5.Ex10.m1.7.7.1.1.2.2.1.cmml" xref="A5.Ex10.m1.7.7.1.1.2.2">superscript</csymbol><ci id="A5.Ex10.m1.7.7.1.1.2.2.2.cmml" xref="A5.Ex10.m1.7.7.1.1.2.2.2">ℐ</ci><list id="A5.Ex10.m1.3.3.3.4.cmml" xref="A5.Ex10.m1.3.3.3.3"><ci id="A5.Ex10.m1.2.2.2.2.1.cmml" xref="A5.Ex10.m1.2.2.2.2.1">′</ci><ci id="A5.Ex10.m1.1.1.1.1.cmml" xref="A5.Ex10.m1.1.1.1.1">𝑖</ci></list></apply><ci id="A5.Ex10.m1.5.5.cmml" xref="A5.Ex10.m1.5.5">𝑥</ci></apply><apply id="A5.Ex10.m1.7.7.1.1.3.cmml" xref="A5.Ex10.m1.7.7.1.1.3"><times id="A5.Ex10.m1.7.7.1.1.3.1.cmml" xref="A5.Ex10.m1.7.7.1.1.3.1"></times><apply id="A5.Ex10.m1.7.7.1.1.3.2.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex10.m1.7.7.1.1.3.2.1.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2">superscript</csymbol><apply id="A5.Ex10.m1.7.7.1.1.3.2.2.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex10.m1.7.7.1.1.3.2.2.1.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2">subscript</csymbol><ci id="A5.Ex10.m1.7.7.1.1.3.2.2.2.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2.2.2">𝑤</ci><ci id="A5.Ex10.m1.7.7.1.1.3.2.2.3.cmml" xref="A5.Ex10.m1.7.7.1.1.3.2.2.3">l</ci></apply><ci id="A5.Ex10.m1.4.4.1.1.cmml" xref="A5.Ex10.m1.4.4.1.1">𝑖</ci></apply><ci id="A5.Ex10.m1.7.7.1.1.3.3.cmml" xref="A5.Ex10.m1.7.7.1.1.3.3">ℐ</ci><ci id="A5.Ex10.m1.6.6.cmml" xref="A5.Ex10.m1.6.6">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex10.m1.7c">\mathcal{I}^{\prime(i)}(x)\;=\;w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x).</annotation><annotation encoding="application/x-llamapun" id="A5.Ex10.m1.7d">caligraphic_I start_POSTSUPERSCRIPT ′ ( italic_i ) end_POSTSUPERSCRIPT ( italic_x ) = italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS1.p2.4">Define</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta_{i}:=r_{x}^{(i)}-y,\quad\|\Delta_{i}\|\leq 2\quad\text{(since $\|r_{x}^%
{(i)}\|\leq 1$ and $\|y\|\leq 1$)}." class="ltx_Math" display="block" id="A5.Ex11.m1.5"><semantics id="A5.Ex11.m1.5a"><mrow id="A5.Ex11.m1.5.5.1"><mrow id="A5.Ex11.m1.5.5.1.1.2" xref="A5.Ex11.m1.5.5.1.1.3.cmml"><mrow id="A5.Ex11.m1.5.5.1.1.1.1" xref="A5.Ex11.m1.5.5.1.1.1.1.cmml"><msub id="A5.Ex11.m1.5.5.1.1.1.1.2" xref="A5.Ex11.m1.5.5.1.1.1.1.2.cmml"><mi id="A5.Ex11.m1.5.5.1.1.1.1.2.2" mathvariant="normal" xref="A5.Ex11.m1.5.5.1.1.1.1.2.2.cmml">Δ</mi><mi id="A5.Ex11.m1.5.5.1.1.1.1.2.3" xref="A5.Ex11.m1.5.5.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A5.Ex11.m1.5.5.1.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="A5.Ex11.m1.5.5.1.1.1.1.1.cmml">:=</mo><mrow id="A5.Ex11.m1.5.5.1.1.1.1.3" xref="A5.Ex11.m1.5.5.1.1.1.1.3.cmml"><msubsup id="A5.Ex11.m1.5.5.1.1.1.1.3.2" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.cmml"><mi id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.2" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.2.cmml">r</mi><mi id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.3" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.3.cmml">x</mi><mrow id="A5.Ex11.m1.3.3.1.3" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.cmml"><mo id="A5.Ex11.m1.3.3.1.3.1" stretchy="false" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.cmml">(</mo><mi id="A5.Ex11.m1.3.3.1.1" xref="A5.Ex11.m1.3.3.1.1.cmml">i</mi><mo id="A5.Ex11.m1.3.3.1.3.2" stretchy="false" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex11.m1.5.5.1.1.1.1.3.1" xref="A5.Ex11.m1.5.5.1.1.1.1.3.1.cmml">−</mo><mi id="A5.Ex11.m1.5.5.1.1.1.1.3.3" xref="A5.Ex11.m1.5.5.1.1.1.1.3.3.cmml">y</mi></mrow></mrow><mo id="A5.Ex11.m1.5.5.1.1.2.3" rspace="1.167em" xref="A5.Ex11.m1.5.5.1.1.3a.cmml">,</mo><mrow id="A5.Ex11.m1.5.5.1.1.2.2" xref="A5.Ex11.m1.5.5.1.1.2.2.cmml"><mrow id="A5.Ex11.m1.5.5.1.1.2.2.1.1" xref="A5.Ex11.m1.5.5.1.1.2.2.1.2.cmml"><mo id="A5.Ex11.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="A5.Ex11.m1.5.5.1.1.2.2.1.2.1.cmml">‖</mo><msub id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.cmml"><mi id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.2" mathvariant="normal" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.2.cmml">Δ</mi><mi id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.3" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A5.Ex11.m1.5.5.1.1.2.2.1.1.3" stretchy="false" xref="A5.Ex11.m1.5.5.1.1.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A5.Ex11.m1.5.5.1.1.2.2.2" xref="A5.Ex11.m1.5.5.1.1.2.2.2.cmml">≤</mo><mrow id="A5.Ex11.m1.5.5.1.1.2.2.3.2" xref="A5.Ex11.m1.5.5.1.1.2.2.3.1.cmml"><mn id="A5.Ex11.m1.4.4" xref="A5.Ex11.m1.4.4.cmml">2</mn><mspace id="A5.Ex11.m1.5.5.1.1.2.2.3.2.1" width="1em" xref="A5.Ex11.m1.5.5.1.1.2.2.3.1.cmml"></mspace><mrow id="A5.Ex11.m1.2.2.2" xref="A5.Ex11.m1.2.2.2d.cmml"><mtext id="A5.Ex11.m1.2.2.2a" xref="A5.Ex11.m1.2.2.2d.cmml">(since </mtext><mrow id="A5.Ex11.m1.1.1.1.m1.2.2" xref="A5.Ex11.m1.1.1.1.m1.2.2.cmml"><mrow id="A5.Ex11.m1.1.1.1.m1.2.2.1.1" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.cmml"><mo id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.2" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.cmml">‖</mo><msubsup id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.cmml"><mi id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.2" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.2.cmml">r</mi><mi id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.3" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.3.cmml">x</mi><mrow id="A5.Ex11.m1.1.1.1.m1.1.1.1.3" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3.cmml"><mo id="A5.Ex11.m1.1.1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3.cmml">(</mo><mi id="A5.Ex11.m1.1.1.1.m1.1.1.1.1" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex11.m1.1.1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.3" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.cmml">‖</mo></mrow><mo id="A5.Ex11.m1.1.1.1.m1.2.2.2" xref="A5.Ex11.m1.1.1.1.m1.2.2.2.cmml">≤</mo><mn id="A5.Ex11.m1.1.1.1.m1.2.2.3" xref="A5.Ex11.m1.1.1.1.m1.2.2.3.cmml">1</mn></mrow><mtext id="A5.Ex11.m1.2.2.2b" xref="A5.Ex11.m1.2.2.2d.cmml"> and </mtext><mrow id="A5.Ex11.m1.2.2.2.m2.1.2" xref="A5.Ex11.m1.2.2.2.m2.1.2.cmml"><mrow id="A5.Ex11.m1.2.2.2.m2.1.2.2.2" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2.cmml"><mo id="A5.Ex11.m1.2.2.2.m2.1.2.2.2.1" stretchy="false" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2.cmml">‖</mo><mi id="A5.Ex11.m1.2.2.2.m2.1.1" xref="A5.Ex11.m1.2.2.2.m2.1.1.cmml">y</mi><mo id="A5.Ex11.m1.2.2.2.m2.1.2.2.2.2" stretchy="false" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2.cmml">‖</mo></mrow><mo id="A5.Ex11.m1.2.2.2.m2.1.2.1" xref="A5.Ex11.m1.2.2.2.m2.1.2.1.cmml">≤</mo><mn id="A5.Ex11.m1.2.2.2.m2.1.2.3" xref="A5.Ex11.m1.2.2.2.m2.1.2.3.cmml">1</mn></mrow><mtext id="A5.Ex11.m1.2.2.2c" xref="A5.Ex11.m1.2.2.2d.cmml">)</mtext></mrow></mrow></mrow></mrow><mo id="A5.Ex11.m1.5.5.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex11.m1.5b"><apply id="A5.Ex11.m1.5.5.1.1.3.cmml" xref="A5.Ex11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A5.Ex11.m1.5.5.1.1.3a.cmml" xref="A5.Ex11.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="A5.Ex11.m1.5.5.1.1.1.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="A5.Ex11.m1.5.5.1.1.1.1.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.1">assign</csymbol><apply id="A5.Ex11.m1.5.5.1.1.1.1.2.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.Ex11.m1.5.5.1.1.1.1.2.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="A5.Ex11.m1.5.5.1.1.1.1.2.2.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.2.2">Δ</ci><ci id="A5.Ex11.m1.5.5.1.1.1.1.2.3.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><apply id="A5.Ex11.m1.5.5.1.1.1.1.3.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3"><minus id="A5.Ex11.m1.5.5.1.1.1.1.3.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.1"></minus><apply id="A5.Ex11.m1.5.5.1.1.1.1.3.2.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex11.m1.5.5.1.1.1.1.3.2.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2">superscript</csymbol><apply id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.1.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2">subscript</csymbol><ci id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.2">𝑟</ci><ci id="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.3.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.2.2.3">𝑥</ci></apply><ci id="A5.Ex11.m1.3.3.1.1.cmml" xref="A5.Ex11.m1.3.3.1.1">𝑖</ci></apply><ci id="A5.Ex11.m1.5.5.1.1.1.1.3.3.cmml" xref="A5.Ex11.m1.5.5.1.1.1.1.3.3">𝑦</ci></apply></apply><apply id="A5.Ex11.m1.5.5.1.1.2.2.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2"><leq id="A5.Ex11.m1.5.5.1.1.2.2.2.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.2"></leq><apply id="A5.Ex11.m1.5.5.1.1.2.2.1.2.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1"><csymbol cd="latexml" id="A5.Ex11.m1.5.5.1.1.2.2.1.2.1.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.2">norm</csymbol><apply id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1">subscript</csymbol><ci id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.2">Δ</ci><ci id="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.1.1.1.3">𝑖</ci></apply></apply><list id="A5.Ex11.m1.5.5.1.1.2.2.3.1.cmml" xref="A5.Ex11.m1.5.5.1.1.2.2.3.2"><cn id="A5.Ex11.m1.4.4.cmml" type="integer" xref="A5.Ex11.m1.4.4">2</cn><ci id="A5.Ex11.m1.2.2.2d.cmml" xref="A5.Ex11.m1.2.2.2"><mrow id="A5.Ex11.m1.2.2.2.cmml" xref="A5.Ex11.m1.2.2.2"><mtext id="A5.Ex11.m1.2.2.2a.cmml" xref="A5.Ex11.m1.2.2.2">(since </mtext><mrow id="A5.Ex11.m1.1.1.1.m1.2.2.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2"><mrow id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1"><mo id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.2.cmml" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1">‖</mo><msubsup id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1"><mi id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.2.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.2">r</mi><mi id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.3.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1.1.2.3">x</mi><mrow id="A5.Ex11.m1.1.1.1.m1.1.1.1.3.cmml" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3"><mo id="A5.Ex11.m1.1.1.1.m1.1.1.1.3.1.cmml" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3">(</mo><mi id="A5.Ex11.m1.1.1.1.m1.1.1.1.1.cmml" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.1">i</mi><mo id="A5.Ex11.m1.1.1.1.m1.1.1.1.3.2.cmml" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.1.1.1.3">)</mo></mrow></msubsup><mo id="A5.Ex11.m1.1.1.1.m1.2.2.1.1.3.cmml" stretchy="false" xref="A5.Ex11.m1.1.1.1.m1.2.2.1.1">‖</mo></mrow><mo id="A5.Ex11.m1.1.1.1.m1.2.2.2.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.2">≤</mo><mn id="A5.Ex11.m1.1.1.1.m1.2.2.3.cmml" xref="A5.Ex11.m1.1.1.1.m1.2.2.3">1</mn></mrow><mtext id="A5.Ex11.m1.2.2.2b.cmml" xref="A5.Ex11.m1.2.2.2"> and </mtext><mrow id="A5.Ex11.m1.2.2.2.m2.1.2.cmml" xref="A5.Ex11.m1.2.2.2.m2.1.2"><mrow id="A5.Ex11.m1.2.2.2.m2.1.2.2.2.cmml" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2"><mo id="A5.Ex11.m1.2.2.2.m2.1.2.2.2.1.cmml" stretchy="false" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2">‖</mo><mi id="A5.Ex11.m1.2.2.2.m2.1.1.cmml" xref="A5.Ex11.m1.2.2.2.m2.1.1">y</mi><mo id="A5.Ex11.m1.2.2.2.m2.1.2.2.2.2.cmml" stretchy="false" xref="A5.Ex11.m1.2.2.2.m2.1.2.2.2">‖</mo></mrow><mo id="A5.Ex11.m1.2.2.2.m2.1.2.1.cmml" xref="A5.Ex11.m1.2.2.2.m2.1.2.1">≤</mo><mn id="A5.Ex11.m1.2.2.2.m2.1.2.3.cmml" xref="A5.Ex11.m1.2.2.2.m2.1.2.3">1</mn></mrow><mtext id="A5.Ex11.m1.2.2.2c.cmml" xref="A5.Ex11.m1.2.2.2">)</mtext></mrow></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex11.m1.5c">\Delta_{i}:=r_{x}^{(i)}-y,\quad\|\Delta_{i}\|\leq 2\quad\text{(since $\|r_{x}^%
{(i)}\|\leq 1$ and $\|y\|\leq 1$)}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex11.m1.5d">roman_Δ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT := italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_y , ∥ roman_Δ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ ≤ 2 (since ∥ italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∥ ≤ 1 and ∥ italic_y ∥ ≤ 1 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS1.p2.3">Substituting these into <math alttext="\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}" class="ltx_Math" display="inline" id="A5.SS1.p2.3.m1.2"><semantics id="A5.SS1.p2.3.m1.2a"><mrow id="A5.SS1.p2.3.m1.2.3" xref="A5.SS1.p2.3.m1.2.3.cmml"><msub id="A5.SS1.p2.3.m1.2.3.1" xref="A5.SS1.p2.3.m1.2.3.1.cmml"><mo id="A5.SS1.p2.3.m1.2.3.1.2" xref="A5.SS1.p2.3.m1.2.3.1.2.cmml">∇</mo><msubsup id="A5.SS1.p2.3.m1.1.1.1" xref="A5.SS1.p2.3.m1.1.1.1.cmml"><mi id="A5.SS1.p2.3.m1.1.1.1.3.2" xref="A5.SS1.p2.3.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.SS1.p2.3.m1.1.1.1.3.3" mathvariant="normal" xref="A5.SS1.p2.3.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.SS1.p2.3.m1.1.1.1.1.1.3" xref="A5.SS1.p2.3.m1.1.1.1.cmml"><mo id="A5.SS1.p2.3.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.SS1.p2.3.m1.1.1.1.cmml">(</mo><mi id="A5.SS1.p2.3.m1.1.1.1.1.1.1" xref="A5.SS1.p2.3.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.SS1.p2.3.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.SS1.p2.3.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.SS1.p2.3.m1.2.3.2" xref="A5.SS1.p2.3.m1.2.3.2.cmml"><mi id="A5.SS1.p2.3.m1.2.3.2.2" mathvariant="normal" xref="A5.SS1.p2.3.m1.2.3.2.2.cmml">ℓ</mi><mrow id="A5.SS1.p2.3.m1.2.2.1.3" xref="A5.SS1.p2.3.m1.2.3.2.cmml"><mo id="A5.SS1.p2.3.m1.2.2.1.3.1" stretchy="false" xref="A5.SS1.p2.3.m1.2.3.2.cmml">(</mo><mi id="A5.SS1.p2.3.m1.2.2.1.1" xref="A5.SS1.p2.3.m1.2.2.1.1.cmml">i</mi><mo id="A5.SS1.p2.3.m1.2.2.1.3.2" stretchy="false" xref="A5.SS1.p2.3.m1.2.3.2.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.SS1.p2.3.m1.2b"><apply id="A5.SS1.p2.3.m1.2.3.cmml" xref="A5.SS1.p2.3.m1.2.3"><apply id="A5.SS1.p2.3.m1.2.3.1.cmml" xref="A5.SS1.p2.3.m1.2.3.1"><csymbol cd="ambiguous" id="A5.SS1.p2.3.m1.2.3.1.1.cmml" xref="A5.SS1.p2.3.m1.2.3.1">subscript</csymbol><ci id="A5.SS1.p2.3.m1.2.3.1.2.cmml" xref="A5.SS1.p2.3.m1.2.3.1.2">∇</ci><apply id="A5.SS1.p2.3.m1.1.1.1.cmml" xref="A5.SS1.p2.3.m1.1.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.3.m1.1.1.1.2.cmml" xref="A5.SS1.p2.3.m1.1.1.1">superscript</csymbol><apply id="A5.SS1.p2.3.m1.1.1.1.3.cmml" xref="A5.SS1.p2.3.m1.1.1.1"><csymbol cd="ambiguous" id="A5.SS1.p2.3.m1.1.1.1.3.1.cmml" xref="A5.SS1.p2.3.m1.1.1.1">subscript</csymbol><ci id="A5.SS1.p2.3.m1.1.1.1.3.2.cmml" xref="A5.SS1.p2.3.m1.1.1.1.3.2">𝑤</ci><ci id="A5.SS1.p2.3.m1.1.1.1.3.3.cmml" xref="A5.SS1.p2.3.m1.1.1.1.3.3">g</ci></apply><ci id="A5.SS1.p2.3.m1.1.1.1.1.1.1.cmml" xref="A5.SS1.p2.3.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.SS1.p2.3.m1.2.3.2.cmml" xref="A5.SS1.p2.3.m1.2.3.2"><csymbol cd="ambiguous" id="A5.SS1.p2.3.m1.2.3.2.1.cmml" xref="A5.SS1.p2.3.m1.2.3.2">superscript</csymbol><ci id="A5.SS1.p2.3.m1.2.3.2.2.cmml" xref="A5.SS1.p2.3.m1.2.3.2.2">ℓ</ci><ci id="A5.SS1.p2.3.m1.2.2.1.1.cmml" xref="A5.SS1.p2.3.m1.2.2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p2.3.m1.2c">\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS1.p2.3.m1.2d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx1">
<tbody id="A5.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,%
\in\,D^{(i)}}\!\Bigl{[}\tau\,\Delta_{i}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{(i)}%
\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^{\!%
\top}\Bigr{]}." class="ltx_Math" display="inline" id="A5.E1.m1.11"><semantics id="A5.E1.m1.11a"><mrow id="A5.E1.m1.11.11.1" xref="A5.E1.m1.11.11.1.1.cmml"><mrow id="A5.E1.m1.11.11.1.1" xref="A5.E1.m1.11.11.1.1.cmml"><mrow id="A5.E1.m1.11.11.1.1.3" xref="A5.E1.m1.11.11.1.1.3.cmml"><msub id="A5.E1.m1.11.11.1.1.3.1" xref="A5.E1.m1.11.11.1.1.3.1.cmml"><mo id="A5.E1.m1.11.11.1.1.3.1.2" xref="A5.E1.m1.11.11.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.E1.m1.1.1.1" xref="A5.E1.m1.1.1.1.cmml"><mi id="A5.E1.m1.1.1.1.3.2" xref="A5.E1.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.E1.m1.1.1.1.3.3" mathvariant="normal" xref="A5.E1.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.E1.m1.1.1.1.1.1.3" xref="A5.E1.m1.1.1.1.cmml"><mo id="A5.E1.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.E1.m1.1.1.1.cmml">(</mo><mi id="A5.E1.m1.1.1.1.1.1.1" xref="A5.E1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.E1.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.E1.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E1.m1.11.11.1.1.3.2" xref="A5.E1.m1.11.11.1.1.3.2.cmml"><mi id="A5.E1.m1.11.11.1.1.3.2.2" mathvariant="normal" xref="A5.E1.m1.11.11.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E1.m1.2.2.1.3" xref="A5.E1.m1.11.11.1.1.3.2.cmml"><mo id="A5.E1.m1.2.2.1.3.1" stretchy="false" xref="A5.E1.m1.11.11.1.1.3.2.cmml">(</mo><mi id="A5.E1.m1.2.2.1.1" xref="A5.E1.m1.2.2.1.1.cmml">i</mi><mo id="A5.E1.m1.2.2.1.3.2" stretchy="false" xref="A5.E1.m1.11.11.1.1.3.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.E1.m1.11.11.1.1.2" rspace="0.558em" xref="A5.E1.m1.11.11.1.1.2.cmml">=</mo><mrow id="A5.E1.m1.11.11.1.1.1" xref="A5.E1.m1.11.11.1.1.1.cmml"><msub id="A5.E1.m1.11.11.1.1.1.3" xref="A5.E1.m1.11.11.1.1.1.3.cmml"><mi id="A5.E1.m1.11.11.1.1.1.3.2" xref="A5.E1.m1.11.11.1.1.1.3.2.cmml">𝔼</mi><mrow id="A5.E1.m1.5.5.3" xref="A5.E1.m1.5.5.3.cmml"><mrow id="A5.E1.m1.5.5.3.5.2" xref="A5.E1.m1.5.5.3.5.1.cmml"><mo id="A5.E1.m1.5.5.3.5.2.1" stretchy="false" xref="A5.E1.m1.5.5.3.5.1.cmml">(</mo><mi id="A5.E1.m1.4.4.2.2" xref="A5.E1.m1.4.4.2.2.cmml">x</mi><mo id="A5.E1.m1.5.5.3.5.2.2" xref="A5.E1.m1.5.5.3.5.1.cmml">,</mo><mi id="A5.E1.m1.5.5.3.3" xref="A5.E1.m1.5.5.3.3.cmml">y</mi><mo id="A5.E1.m1.5.5.3.5.2.3" rspace="0.170em" stretchy="false" xref="A5.E1.m1.5.5.3.5.1.cmml">)</mo></mrow><mo id="A5.E1.m1.5.5.3.4" rspace="0.448em" xref="A5.E1.m1.5.5.3.4.cmml">∈</mo><msup id="A5.E1.m1.5.5.3.6" xref="A5.E1.m1.5.5.3.6.cmml"><mi id="A5.E1.m1.5.5.3.6.2" xref="A5.E1.m1.5.5.3.6.2.cmml">D</mi><mrow id="A5.E1.m1.3.3.1.1.1.3" xref="A5.E1.m1.5.5.3.6.cmml"><mo id="A5.E1.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.E1.m1.5.5.3.6.cmml">(</mo><mi id="A5.E1.m1.3.3.1.1.1.1" xref="A5.E1.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A5.E1.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.E1.m1.5.5.3.6.cmml">)</mo></mrow></msup></mrow></msub><mo id="A5.E1.m1.11.11.1.1.1.2" xref="A5.E1.m1.11.11.1.1.1.2.cmml">⁢</mo><mrow id="A5.E1.m1.11.11.1.1.1.1.1" xref="A5.E1.m1.11.11.1.1.1.1.2.cmml"><mo id="A5.E1.m1.11.11.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A5.E1.m1.11.11.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.E1.m1.11.11.1.1.1.1.1.1" xref="A5.E1.m1.11.11.1.1.1.1.1.1.cmml"><mi id="A5.E1.m1.11.11.1.1.1.1.1.1.2" xref="A5.E1.m1.11.11.1.1.1.1.1.1.2.cmml">τ</mi><mo id="A5.E1.m1.11.11.1.1.1.1.1.1.1" lspace="0.170em" xref="A5.E1.m1.11.11.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A5.E1.m1.11.11.1.1.1.1.1.1.3" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3.cmml"><mi id="A5.E1.m1.11.11.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3.2.cmml">Δ</mi><mi id="A5.E1.m1.11.11.1.1.1.1.1.1.3.3" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.E1.m1.11.11.1.1.1.1.1.1.1a" xref="A5.E1.m1.11.11.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="A5.E1.m1.11.11.1.1.1.1.1.1.4" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4.cmml"><mrow id="A5.E1.m1.11.11.1.1.1.1.1.1.4.2.2" xref="A5.E1.m1.10.10.cmml"><mo id="A5.E1.m1.11.11.1.1.1.1.1.1.4.2.2.1" maxsize="160%" minsize="160%" xref="A5.E1.m1.10.10.cmml">(</mo><mfrac id="A5.E1.m1.10.10" xref="A5.E1.m1.10.10.cmml"><mrow id="A5.E1.m1.7.7.2" xref="A5.E1.m1.7.7.2.cmml"><msubsup id="A5.E1.m1.7.7.2.4" xref="A5.E1.m1.7.7.2.4.cmml"><mi id="A5.E1.m1.7.7.2.4.2.2" xref="A5.E1.m1.7.7.2.4.2.2.cmml">w</mi><mi id="A5.E1.m1.7.7.2.4.2.3" mathvariant="normal" xref="A5.E1.m1.7.7.2.4.2.3.cmml">l</mi><mrow id="A5.E1.m1.6.6.1.1.1.3" xref="A5.E1.m1.7.7.2.4.cmml"><mo id="A5.E1.m1.6.6.1.1.1.3.1" stretchy="false" xref="A5.E1.m1.7.7.2.4.cmml">(</mo><mi id="A5.E1.m1.6.6.1.1.1.1" xref="A5.E1.m1.6.6.1.1.1.1.cmml">i</mi><mo id="A5.E1.m1.6.6.1.1.1.3.2" stretchy="false" xref="A5.E1.m1.7.7.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.E1.m1.7.7.2.3" lspace="0.170em" xref="A5.E1.m1.7.7.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E1.m1.7.7.2.5" xref="A5.E1.m1.7.7.2.5.cmml">ℐ</mi><mo id="A5.E1.m1.7.7.2.3a" xref="A5.E1.m1.7.7.2.3.cmml">⁢</mo><mrow id="A5.E1.m1.7.7.2.6.2" xref="A5.E1.m1.7.7.2.cmml"><mo id="A5.E1.m1.7.7.2.6.2.1" stretchy="false" xref="A5.E1.m1.7.7.2.cmml">(</mo><mi id="A5.E1.m1.7.7.2.2" xref="A5.E1.m1.7.7.2.2.cmml">x</mi><mo id="A5.E1.m1.7.7.2.6.2.2" stretchy="false" xref="A5.E1.m1.7.7.2.cmml">)</mo></mrow></mrow><mrow id="A5.E1.m1.10.10.5.3" xref="A5.E1.m1.10.10.5.4.cmml"><mo id="A5.E1.m1.10.10.5.3.2" rspace="0.170em" stretchy="false" xref="A5.E1.m1.10.10.5.4.1.cmml">‖</mo><mrow id="A5.E1.m1.10.10.5.3.1" xref="A5.E1.m1.10.10.5.3.1.cmml"><msubsup id="A5.E1.m1.10.10.5.3.1.2" xref="A5.E1.m1.10.10.5.3.1.2.cmml"><mi id="A5.E1.m1.10.10.5.3.1.2.2.2" xref="A5.E1.m1.10.10.5.3.1.2.2.2.cmml">w</mi><mi id="A5.E1.m1.10.10.5.3.1.2.2.3" mathvariant="normal" xref="A5.E1.m1.10.10.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.E1.m1.8.8.3.1.1.3" xref="A5.E1.m1.10.10.5.3.1.2.cmml"><mo id="A5.E1.m1.8.8.3.1.1.3.1" stretchy="false" xref="A5.E1.m1.10.10.5.3.1.2.cmml">(</mo><mi id="A5.E1.m1.8.8.3.1.1.1" xref="A5.E1.m1.8.8.3.1.1.1.cmml">i</mi><mo id="A5.E1.m1.8.8.3.1.1.3.2" stretchy="false" xref="A5.E1.m1.10.10.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.E1.m1.10.10.5.3.1.1" xref="A5.E1.m1.10.10.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E1.m1.10.10.5.3.1.3" xref="A5.E1.m1.10.10.5.3.1.3.cmml">ℐ</mi><mo id="A5.E1.m1.10.10.5.3.1.1a" xref="A5.E1.m1.10.10.5.3.1.1.cmml">⁢</mo><mrow id="A5.E1.m1.10.10.5.3.1.4.2" xref="A5.E1.m1.10.10.5.3.1.cmml"><mo id="A5.E1.m1.10.10.5.3.1.4.2.1" stretchy="false" xref="A5.E1.m1.10.10.5.3.1.cmml">(</mo><mi id="A5.E1.m1.9.9.4.2" xref="A5.E1.m1.9.9.4.2.cmml">x</mi><mo id="A5.E1.m1.10.10.5.3.1.4.2.2" stretchy="false" xref="A5.E1.m1.10.10.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.E1.m1.10.10.5.3.3" stretchy="false" xref="A5.E1.m1.10.10.5.4.1.cmml">‖</mo></mrow></mfrac><mo id="A5.E1.m1.11.11.1.1.1.1.1.1.4.2.2.2" maxsize="160%" minsize="160%" xref="A5.E1.m1.10.10.cmml">)</mo></mrow><mo id="A5.E1.m1.11.11.1.1.1.1.1.1.4.3" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup></mrow><mo id="A5.E1.m1.11.11.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A5.E1.m1.11.11.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.E1.m1.11.11.1.2" lspace="0em" xref="A5.E1.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E1.m1.11b"><apply id="A5.E1.m1.11.11.1.1.cmml" xref="A5.E1.m1.11.11.1"><eq id="A5.E1.m1.11.11.1.1.2.cmml" xref="A5.E1.m1.11.11.1.1.2"></eq><apply id="A5.E1.m1.11.11.1.1.3.cmml" xref="A5.E1.m1.11.11.1.1.3"><apply id="A5.E1.m1.11.11.1.1.3.1.cmml" xref="A5.E1.m1.11.11.1.1.3.1"><csymbol cd="ambiguous" id="A5.E1.m1.11.11.1.1.3.1.1.cmml" xref="A5.E1.m1.11.11.1.1.3.1">subscript</csymbol><ci id="A5.E1.m1.11.11.1.1.3.1.2.cmml" xref="A5.E1.m1.11.11.1.1.3.1.2">∇</ci><apply id="A5.E1.m1.1.1.1.cmml" xref="A5.E1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E1.m1.1.1.1.2.cmml" xref="A5.E1.m1.1.1.1">superscript</csymbol><apply id="A5.E1.m1.1.1.1.3.cmml" xref="A5.E1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E1.m1.1.1.1.3.1.cmml" xref="A5.E1.m1.1.1.1">subscript</csymbol><ci id="A5.E1.m1.1.1.1.3.2.cmml" xref="A5.E1.m1.1.1.1.3.2">𝑤</ci><ci id="A5.E1.m1.1.1.1.3.3.cmml" xref="A5.E1.m1.1.1.1.3.3">g</ci></apply><ci id="A5.E1.m1.1.1.1.1.1.1.cmml" xref="A5.E1.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E1.m1.11.11.1.1.3.2.cmml" xref="A5.E1.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="A5.E1.m1.11.11.1.1.3.2.1.cmml" xref="A5.E1.m1.11.11.1.1.3.2">superscript</csymbol><ci id="A5.E1.m1.11.11.1.1.3.2.2.cmml" xref="A5.E1.m1.11.11.1.1.3.2.2">ℓ</ci><ci id="A5.E1.m1.2.2.1.1.cmml" xref="A5.E1.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.E1.m1.11.11.1.1.1.cmml" xref="A5.E1.m1.11.11.1.1.1"><times id="A5.E1.m1.11.11.1.1.1.2.cmml" xref="A5.E1.m1.11.11.1.1.1.2"></times><apply id="A5.E1.m1.11.11.1.1.1.3.cmml" xref="A5.E1.m1.11.11.1.1.1.3"><csymbol cd="ambiguous" id="A5.E1.m1.11.11.1.1.1.3.1.cmml" xref="A5.E1.m1.11.11.1.1.1.3">subscript</csymbol><ci id="A5.E1.m1.11.11.1.1.1.3.2.cmml" xref="A5.E1.m1.11.11.1.1.1.3.2">𝔼</ci><apply id="A5.E1.m1.5.5.3.cmml" xref="A5.E1.m1.5.5.3"><in id="A5.E1.m1.5.5.3.4.cmml" xref="A5.E1.m1.5.5.3.4"></in><interval closure="open" id="A5.E1.m1.5.5.3.5.1.cmml" xref="A5.E1.m1.5.5.3.5.2"><ci id="A5.E1.m1.4.4.2.2.cmml" xref="A5.E1.m1.4.4.2.2">𝑥</ci><ci id="A5.E1.m1.5.5.3.3.cmml" xref="A5.E1.m1.5.5.3.3">𝑦</ci></interval><apply id="A5.E1.m1.5.5.3.6.cmml" xref="A5.E1.m1.5.5.3.6"><csymbol cd="ambiguous" id="A5.E1.m1.5.5.3.6.1.cmml" xref="A5.E1.m1.5.5.3.6">superscript</csymbol><ci id="A5.E1.m1.5.5.3.6.2.cmml" xref="A5.E1.m1.5.5.3.6.2">𝐷</ci><ci id="A5.E1.m1.3.3.1.1.1.1.cmml" xref="A5.E1.m1.3.3.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A5.E1.m1.11.11.1.1.1.1.2.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1"><csymbol cd="latexml" id="A5.E1.m1.11.11.1.1.1.1.2.1.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.E1.m1.11.11.1.1.1.1.1.1.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1"><times id="A5.E1.m1.11.11.1.1.1.1.1.1.1.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.1"></times><ci id="A5.E1.m1.11.11.1.1.1.1.1.1.2.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.2">𝜏</ci><apply id="A5.E1.m1.11.11.1.1.1.1.1.1.3.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E1.m1.11.11.1.1.1.1.1.1.3.1.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3">subscript</csymbol><ci id="A5.E1.m1.11.11.1.1.1.1.1.1.3.2.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3.2">Δ</ci><ci id="A5.E1.m1.11.11.1.1.1.1.1.1.3.3.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A5.E1.m1.11.11.1.1.1.1.1.1.4.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A5.E1.m1.11.11.1.1.1.1.1.1.4.1.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4">superscript</csymbol><apply id="A5.E1.m1.10.10.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4.2.2"><divide id="A5.E1.m1.10.10.6.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4.2.2"></divide><apply id="A5.E1.m1.7.7.2.cmml" xref="A5.E1.m1.7.7.2"><times id="A5.E1.m1.7.7.2.3.cmml" xref="A5.E1.m1.7.7.2.3"></times><apply id="A5.E1.m1.7.7.2.4.cmml" xref="A5.E1.m1.7.7.2.4"><csymbol cd="ambiguous" id="A5.E1.m1.7.7.2.4.1.cmml" xref="A5.E1.m1.7.7.2.4">superscript</csymbol><apply id="A5.E1.m1.7.7.2.4.2.cmml" xref="A5.E1.m1.7.7.2.4"><csymbol cd="ambiguous" id="A5.E1.m1.7.7.2.4.2.1.cmml" xref="A5.E1.m1.7.7.2.4">subscript</csymbol><ci id="A5.E1.m1.7.7.2.4.2.2.cmml" xref="A5.E1.m1.7.7.2.4.2.2">𝑤</ci><ci id="A5.E1.m1.7.7.2.4.2.3.cmml" xref="A5.E1.m1.7.7.2.4.2.3">l</ci></apply><ci id="A5.E1.m1.6.6.1.1.1.1.cmml" xref="A5.E1.m1.6.6.1.1.1.1">𝑖</ci></apply><ci id="A5.E1.m1.7.7.2.5.cmml" xref="A5.E1.m1.7.7.2.5">ℐ</ci><ci id="A5.E1.m1.7.7.2.2.cmml" xref="A5.E1.m1.7.7.2.2">𝑥</ci></apply><apply id="A5.E1.m1.10.10.5.4.cmml" xref="A5.E1.m1.10.10.5.3"><csymbol cd="latexml" id="A5.E1.m1.10.10.5.4.1.cmml" xref="A5.E1.m1.10.10.5.3.2">norm</csymbol><apply id="A5.E1.m1.10.10.5.3.1.cmml" xref="A5.E1.m1.10.10.5.3.1"><times id="A5.E1.m1.10.10.5.3.1.1.cmml" xref="A5.E1.m1.10.10.5.3.1.1"></times><apply id="A5.E1.m1.10.10.5.3.1.2.cmml" xref="A5.E1.m1.10.10.5.3.1.2"><csymbol cd="ambiguous" id="A5.E1.m1.10.10.5.3.1.2.1.cmml" xref="A5.E1.m1.10.10.5.3.1.2">superscript</csymbol><apply id="A5.E1.m1.10.10.5.3.1.2.2.cmml" xref="A5.E1.m1.10.10.5.3.1.2"><csymbol cd="ambiguous" id="A5.E1.m1.10.10.5.3.1.2.2.1.cmml" xref="A5.E1.m1.10.10.5.3.1.2">subscript</csymbol><ci id="A5.E1.m1.10.10.5.3.1.2.2.2.cmml" xref="A5.E1.m1.10.10.5.3.1.2.2.2">𝑤</ci><ci id="A5.E1.m1.10.10.5.3.1.2.2.3.cmml" xref="A5.E1.m1.10.10.5.3.1.2.2.3">l</ci></apply><ci id="A5.E1.m1.8.8.3.1.1.1.cmml" xref="A5.E1.m1.8.8.3.1.1.1">𝑖</ci></apply><ci id="A5.E1.m1.10.10.5.3.1.3.cmml" xref="A5.E1.m1.10.10.5.3.1.3">ℐ</ci><ci id="A5.E1.m1.9.9.4.2.cmml" xref="A5.E1.m1.9.9.4.2">𝑥</ci></apply></apply></apply><csymbol cd="latexml" id="A5.E1.m1.11.11.1.1.1.1.1.1.4.3.cmml" xref="A5.E1.m1.11.11.1.1.1.1.1.1.4.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E1.m1.11c">\displaystyle\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,%
\in\,D^{(i)}}\!\Bigl{[}\tau\,\Delta_{i}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{(i)}%
\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^{\!%
\top}\Bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.E1.m1.11d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ italic_τ roman_Δ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Bounding the Gradient Difference</h3>
<div class="ltx_para" id="A5.SS2.p1">
<p class="ltx_p" id="A5.SS2.p1.2">For clients <math alttext="i" class="ltx_Math" display="inline" id="A5.SS2.p1.1.m1.1"><semantics id="A5.SS2.p1.1.m1.1a"><mi id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b"><ci id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.1.m1.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="A5.SS2.p1.2.m2.1"><semantics id="A5.SS2.p1.2.m2.1a"><mi id="A5.SS2.p1.2.m2.1.1" xref="A5.SS2.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.2.m2.1b"><ci id="A5.SS2.p1.2.m2.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.2.m2.1d">italic_j</annotation></semantics></math>, the difference between their global-classifier gradients is</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;-\;\nabla_{w_{\mathrm{g}}^%
{(j)}}\ell^{(j)}\Bigr{\|}." class="ltx_Math" display="block" id="A5.Ex12.m1.5"><semantics id="A5.Ex12.m1.5a"><mrow id="A5.Ex12.m1.5.5.1"><mrow id="A5.Ex12.m1.5.5.1.1.1" xref="A5.Ex12.m1.5.5.1.1.2.cmml"><mo fence="true" id="A5.Ex12.m1.5.5.1.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.Ex12.m1.5.5.1.1.2.1.cmml">∥</mo><mrow id="A5.Ex12.m1.5.5.1.1.1.1" xref="A5.Ex12.m1.5.5.1.1.1.1.cmml"><mrow id="A5.Ex12.m1.5.5.1.1.1.1.2" xref="A5.Ex12.m1.5.5.1.1.1.1.2.cmml"><msub id="A5.Ex12.m1.5.5.1.1.1.1.2.1" xref="A5.Ex12.m1.5.5.1.1.1.1.2.1.cmml"><mo id="A5.Ex12.m1.5.5.1.1.1.1.2.1.2" rspace="0.167em" xref="A5.Ex12.m1.5.5.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="A5.Ex12.m1.1.1.1" xref="A5.Ex12.m1.1.1.1.cmml"><mi id="A5.Ex12.m1.1.1.1.3.2" xref="A5.Ex12.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.Ex12.m1.1.1.1.3.3" mathvariant="normal" xref="A5.Ex12.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.Ex12.m1.1.1.1.1.1.3" xref="A5.Ex12.m1.1.1.1.cmml"><mo id="A5.Ex12.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex12.m1.1.1.1.cmml">(</mo><mi id="A5.Ex12.m1.1.1.1.1.1.1" xref="A5.Ex12.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex12.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex12.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex12.m1.5.5.1.1.1.1.2.2" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.cmml"><mi id="A5.Ex12.m1.5.5.1.1.1.1.2.2.2" mathvariant="normal" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.Ex12.m1.2.2.1.3" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.cmml"><mo id="A5.Ex12.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.cmml">(</mo><mi id="A5.Ex12.m1.2.2.1.1" xref="A5.Ex12.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex12.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.Ex12.m1.5.5.1.1.1.1.1" rspace="0.502em" xref="A5.Ex12.m1.5.5.1.1.1.1.1.cmml">−</mo><mrow id="A5.Ex12.m1.5.5.1.1.1.1.3" xref="A5.Ex12.m1.5.5.1.1.1.1.3.cmml"><msub id="A5.Ex12.m1.5.5.1.1.1.1.3.1" xref="A5.Ex12.m1.5.5.1.1.1.1.3.1.cmml"><mo id="A5.Ex12.m1.5.5.1.1.1.1.3.1.2" rspace="0.167em" xref="A5.Ex12.m1.5.5.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.Ex12.m1.3.3.1" xref="A5.Ex12.m1.3.3.1.cmml"><mi id="A5.Ex12.m1.3.3.1.3.2" xref="A5.Ex12.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.Ex12.m1.3.3.1.3.3" mathvariant="normal" xref="A5.Ex12.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.Ex12.m1.3.3.1.1.1.3" xref="A5.Ex12.m1.3.3.1.cmml"><mo id="A5.Ex12.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex12.m1.3.3.1.cmml">(</mo><mi id="A5.Ex12.m1.3.3.1.1.1.1" xref="A5.Ex12.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.Ex12.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex12.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex12.m1.5.5.1.1.1.1.3.2" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.cmml"><mi id="A5.Ex12.m1.5.5.1.1.1.1.3.2.2" mathvariant="normal" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.Ex12.m1.4.4.1.3" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.cmml"><mo id="A5.Ex12.m1.4.4.1.3.1" stretchy="false" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.cmml">(</mo><mi id="A5.Ex12.m1.4.4.1.1" xref="A5.Ex12.m1.4.4.1.1.cmml">j</mi><mo id="A5.Ex12.m1.4.4.1.3.2" stretchy="false" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.Ex12.m1.5.5.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="A5.Ex12.m1.5.5.1.1.2.1.cmml">∥</mo></mrow><mo id="A5.Ex12.m1.5.5.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex12.m1.5b"><apply id="A5.Ex12.m1.5.5.1.1.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1"><csymbol cd="latexml" id="A5.Ex12.m1.5.5.1.1.2.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.Ex12.m1.5.5.1.1.1.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1"><minus id="A5.Ex12.m1.5.5.1.1.1.1.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.1"></minus><apply id="A5.Ex12.m1.5.5.1.1.1.1.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2"><apply id="A5.Ex12.m1.5.5.1.1.1.1.2.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.5.5.1.1.1.1.2.1.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.1">subscript</csymbol><ci id="A5.Ex12.m1.5.5.1.1.1.1.2.1.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.1.2">∇</ci><apply id="A5.Ex12.m1.1.1.1.cmml" xref="A5.Ex12.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.1.1.1.2.cmml" xref="A5.Ex12.m1.1.1.1">superscript</csymbol><apply id="A5.Ex12.m1.1.1.1.3.cmml" xref="A5.Ex12.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.1.1.1.3.1.cmml" xref="A5.Ex12.m1.1.1.1">subscript</csymbol><ci id="A5.Ex12.m1.1.1.1.3.2.cmml" xref="A5.Ex12.m1.1.1.1.3.2">𝑤</ci><ci id="A5.Ex12.m1.1.1.1.3.3.cmml" xref="A5.Ex12.m1.1.1.1.3.3">g</ci></apply><ci id="A5.Ex12.m1.1.1.1.1.1.1.cmml" xref="A5.Ex12.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex12.m1.5.5.1.1.1.1.2.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A5.Ex12.m1.5.5.1.1.1.1.2.2.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2">superscript</csymbol><ci id="A5.Ex12.m1.5.5.1.1.1.1.2.2.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.2.2.2">ℓ</ci><ci id="A5.Ex12.m1.2.2.1.1.cmml" xref="A5.Ex12.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.Ex12.m1.5.5.1.1.1.1.3.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3"><apply id="A5.Ex12.m1.5.5.1.1.1.1.3.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.5.5.1.1.1.1.3.1.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.1">subscript</csymbol><ci id="A5.Ex12.m1.5.5.1.1.1.1.3.1.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.1.2">∇</ci><apply id="A5.Ex12.m1.3.3.1.cmml" xref="A5.Ex12.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.3.3.1.2.cmml" xref="A5.Ex12.m1.3.3.1">superscript</csymbol><apply id="A5.Ex12.m1.3.3.1.3.cmml" xref="A5.Ex12.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex12.m1.3.3.1.3.1.cmml" xref="A5.Ex12.m1.3.3.1">subscript</csymbol><ci id="A5.Ex12.m1.3.3.1.3.2.cmml" xref="A5.Ex12.m1.3.3.1.3.2">𝑤</ci><ci id="A5.Ex12.m1.3.3.1.3.3.cmml" xref="A5.Ex12.m1.3.3.1.3.3">g</ci></apply><ci id="A5.Ex12.m1.3.3.1.1.1.1.cmml" xref="A5.Ex12.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.Ex12.m1.5.5.1.1.1.1.3.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex12.m1.5.5.1.1.1.1.3.2.1.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2">superscript</csymbol><ci id="A5.Ex12.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A5.Ex12.m1.5.5.1.1.1.1.3.2.2">ℓ</ci><ci id="A5.Ex12.m1.4.4.1.1.cmml" xref="A5.Ex12.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex12.m1.5c">\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}\;-\;\nabla_{w_{\mathrm{g}}^%
{(j)}}\ell^{(j)}\Bigr{\|}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex12.m1.5d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS2.p1.3">Following similar derivations for each side, we obtain:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx2">
<tbody id="A5.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}_{2}" class="ltx_Math" display="inline" id="A5.Ex13.m1.5"><semantics id="A5.Ex13.m1.5a"><msub id="A5.Ex13.m1.5.5" xref="A5.Ex13.m1.5.5.cmml"><mrow id="A5.Ex13.m1.5.5.1.1" xref="A5.Ex13.m1.5.5.1.2.cmml"><mo fence="true" id="A5.Ex13.m1.5.5.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.Ex13.m1.5.5.1.2.1.cmml">∥</mo><mrow id="A5.Ex13.m1.5.5.1.1.1" xref="A5.Ex13.m1.5.5.1.1.1.cmml"><mrow id="A5.Ex13.m1.5.5.1.1.1.2" xref="A5.Ex13.m1.5.5.1.1.1.2.cmml"><msub id="A5.Ex13.m1.5.5.1.1.1.2.1" xref="A5.Ex13.m1.5.5.1.1.1.2.1.cmml"><mo id="A5.Ex13.m1.5.5.1.1.1.2.1.2" rspace="0.167em" xref="A5.Ex13.m1.5.5.1.1.1.2.1.2.cmml">∇</mo><msubsup id="A5.Ex13.m1.1.1.1" xref="A5.Ex13.m1.1.1.1.cmml"><mi id="A5.Ex13.m1.1.1.1.3.2" xref="A5.Ex13.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.Ex13.m1.1.1.1.3.3" mathvariant="normal" xref="A5.Ex13.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.Ex13.m1.1.1.1.1.1.3" xref="A5.Ex13.m1.1.1.1.cmml"><mo id="A5.Ex13.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex13.m1.1.1.1.cmml">(</mo><mi id="A5.Ex13.m1.1.1.1.1.1.1" xref="A5.Ex13.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex13.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex13.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex13.m1.5.5.1.1.1.2.2" xref="A5.Ex13.m1.5.5.1.1.1.2.2.cmml"><mi id="A5.Ex13.m1.5.5.1.1.1.2.2.2" mathvariant="normal" xref="A5.Ex13.m1.5.5.1.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.Ex13.m1.2.2.1.3" xref="A5.Ex13.m1.5.5.1.1.1.2.2.cmml"><mo id="A5.Ex13.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex13.m1.5.5.1.1.1.2.2.cmml">(</mo><mi id="A5.Ex13.m1.2.2.1.1" xref="A5.Ex13.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex13.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex13.m1.5.5.1.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.Ex13.m1.5.5.1.1.1.1" xref="A5.Ex13.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="A5.Ex13.m1.5.5.1.1.1.3" xref="A5.Ex13.m1.5.5.1.1.1.3.cmml"><msub id="A5.Ex13.m1.5.5.1.1.1.3.1" xref="A5.Ex13.m1.5.5.1.1.1.3.1.cmml"><mo id="A5.Ex13.m1.5.5.1.1.1.3.1.2" rspace="0.167em" xref="A5.Ex13.m1.5.5.1.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.Ex13.m1.3.3.1" xref="A5.Ex13.m1.3.3.1.cmml"><mi id="A5.Ex13.m1.3.3.1.3.2" xref="A5.Ex13.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.Ex13.m1.3.3.1.3.3" mathvariant="normal" xref="A5.Ex13.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.Ex13.m1.3.3.1.1.1.3" xref="A5.Ex13.m1.3.3.1.cmml"><mo id="A5.Ex13.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex13.m1.3.3.1.cmml">(</mo><mi id="A5.Ex13.m1.3.3.1.1.1.1" xref="A5.Ex13.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.Ex13.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex13.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex13.m1.5.5.1.1.1.3.2" xref="A5.Ex13.m1.5.5.1.1.1.3.2.cmml"><mi id="A5.Ex13.m1.5.5.1.1.1.3.2.2" mathvariant="normal" xref="A5.Ex13.m1.5.5.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.Ex13.m1.4.4.1.3" xref="A5.Ex13.m1.5.5.1.1.1.3.2.cmml"><mo id="A5.Ex13.m1.4.4.1.3.1" stretchy="false" xref="A5.Ex13.m1.5.5.1.1.1.3.2.cmml">(</mo><mi id="A5.Ex13.m1.4.4.1.1" xref="A5.Ex13.m1.4.4.1.1.cmml">j</mi><mo id="A5.Ex13.m1.4.4.1.3.2" stretchy="false" xref="A5.Ex13.m1.5.5.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.Ex13.m1.5.5.1.1.3" lspace="0em" mathsize="160%" xref="A5.Ex13.m1.5.5.1.2.1.cmml">∥</mo></mrow><mn id="A5.Ex13.m1.5.5.3" xref="A5.Ex13.m1.5.5.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A5.Ex13.m1.5b"><apply id="A5.Ex13.m1.5.5.cmml" xref="A5.Ex13.m1.5.5"><csymbol cd="ambiguous" id="A5.Ex13.m1.5.5.2.cmml" xref="A5.Ex13.m1.5.5">subscript</csymbol><apply id="A5.Ex13.m1.5.5.1.2.cmml" xref="A5.Ex13.m1.5.5.1.1"><csymbol cd="latexml" id="A5.Ex13.m1.5.5.1.2.1.cmml" xref="A5.Ex13.m1.5.5.1.1.2">delimited-∥∥</csymbol><apply id="A5.Ex13.m1.5.5.1.1.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1"><minus id="A5.Ex13.m1.5.5.1.1.1.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.1"></minus><apply id="A5.Ex13.m1.5.5.1.1.1.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2"><apply id="A5.Ex13.m1.5.5.1.1.1.2.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.5.5.1.1.1.2.1.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.1">subscript</csymbol><ci id="A5.Ex13.m1.5.5.1.1.1.2.1.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.1.2">∇</ci><apply id="A5.Ex13.m1.1.1.1.cmml" xref="A5.Ex13.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.1.1.1.2.cmml" xref="A5.Ex13.m1.1.1.1">superscript</csymbol><apply id="A5.Ex13.m1.1.1.1.3.cmml" xref="A5.Ex13.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.1.1.1.3.1.cmml" xref="A5.Ex13.m1.1.1.1">subscript</csymbol><ci id="A5.Ex13.m1.1.1.1.3.2.cmml" xref="A5.Ex13.m1.1.1.1.3.2">𝑤</ci><ci id="A5.Ex13.m1.1.1.1.3.3.cmml" xref="A5.Ex13.m1.1.1.1.3.3">g</ci></apply><ci id="A5.Ex13.m1.1.1.1.1.1.1.cmml" xref="A5.Ex13.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex13.m1.5.5.1.1.1.2.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.2"><csymbol cd="ambiguous" id="A5.Ex13.m1.5.5.1.1.1.2.2.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.2">superscript</csymbol><ci id="A5.Ex13.m1.5.5.1.1.1.2.2.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.2.2.2">ℓ</ci><ci id="A5.Ex13.m1.2.2.1.1.cmml" xref="A5.Ex13.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.Ex13.m1.5.5.1.1.1.3.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3"><apply id="A5.Ex13.m1.5.5.1.1.1.3.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.5.5.1.1.1.3.1.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.1">subscript</csymbol><ci id="A5.Ex13.m1.5.5.1.1.1.3.1.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.1.2">∇</ci><apply id="A5.Ex13.m1.3.3.1.cmml" xref="A5.Ex13.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.3.3.1.2.cmml" xref="A5.Ex13.m1.3.3.1">superscript</csymbol><apply id="A5.Ex13.m1.3.3.1.3.cmml" xref="A5.Ex13.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex13.m1.3.3.1.3.1.cmml" xref="A5.Ex13.m1.3.3.1">subscript</csymbol><ci id="A5.Ex13.m1.3.3.1.3.2.cmml" xref="A5.Ex13.m1.3.3.1.3.2">𝑤</ci><ci id="A5.Ex13.m1.3.3.1.3.3.cmml" xref="A5.Ex13.m1.3.3.1.3.3">g</ci></apply><ci id="A5.Ex13.m1.3.3.1.1.1.1.cmml" xref="A5.Ex13.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.Ex13.m1.5.5.1.1.1.3.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex13.m1.5.5.1.1.1.3.2.1.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.2">superscript</csymbol><ci id="A5.Ex13.m1.5.5.1.1.1.3.2.2.cmml" xref="A5.Ex13.m1.5.5.1.1.1.3.2.2">ℓ</ci><ci id="A5.Ex13.m1.4.4.1.1.cmml" xref="A5.Ex13.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply><cn id="A5.Ex13.m1.5.5.3.cmml" type="integer" xref="A5.Ex13.m1.5.5.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex13.m1.5c">\displaystyle\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}_{2}</annotation><annotation encoding="application/x-llamapun" id="A5.Ex13.m1.5d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A5.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\;\leq\;\mathbb{E}_{D^{(i)}}\Bigl{\|}\,\tau\,\Delta_{i}\,\frac{\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(%
x)\|\,}\Bigr{\|}\;+\;\mathbb{E}_{D^{(j)}}\Bigl{\|}\,\tau\,\Delta_{j}\,\frac{\,%
w_{\mathrm{l}}^{(j)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(j)}\,\mathcal{I}(%
x)\|\,}\Bigr{\|}" class="ltx_Math" display="inline" id="A5.Ex14.m1.14"><semantics id="A5.Ex14.m1.14a"><mrow id="A5.Ex14.m1.14.14" xref="A5.Ex14.m1.14.14.cmml"><mi id="A5.Ex14.m1.14.14.4" xref="A5.Ex14.m1.14.14.4.cmml"></mi><mo id="A5.Ex14.m1.14.14.3" lspace="0.558em" rspace="0.558em" xref="A5.Ex14.m1.14.14.3.cmml">≤</mo><mrow id="A5.Ex14.m1.14.14.2" xref="A5.Ex14.m1.14.14.2.cmml"><mrow id="A5.Ex14.m1.13.13.1.1" xref="A5.Ex14.m1.13.13.1.1.cmml"><msub id="A5.Ex14.m1.13.13.1.1.3" xref="A5.Ex14.m1.13.13.1.1.3.cmml"><mi id="A5.Ex14.m1.13.13.1.1.3.2" xref="A5.Ex14.m1.13.13.1.1.3.2.cmml">𝔼</mi><msup id="A5.Ex14.m1.1.1.1" xref="A5.Ex14.m1.1.1.1.cmml"><mi id="A5.Ex14.m1.1.1.1.3" xref="A5.Ex14.m1.1.1.1.3.cmml">D</mi><mrow id="A5.Ex14.m1.1.1.1.1.1.3" xref="A5.Ex14.m1.1.1.1.cmml"><mo id="A5.Ex14.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.1.1.1.cmml">(</mo><mi id="A5.Ex14.m1.1.1.1.1.1.1" xref="A5.Ex14.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex14.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.1.1.1.cmml">)</mo></mrow></msup></msub><mo id="A5.Ex14.m1.13.13.1.1.2" lspace="0em" xref="A5.Ex14.m1.13.13.1.1.2.cmml">⁢</mo><mrow id="A5.Ex14.m1.13.13.1.1.1.1" xref="A5.Ex14.m1.13.13.1.1.1.2.cmml"><mo fence="true" id="A5.Ex14.m1.13.13.1.1.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.Ex14.m1.13.13.1.1.1.2.1.cmml">∥</mo><mrow id="A5.Ex14.m1.13.13.1.1.1.1.1" xref="A5.Ex14.m1.13.13.1.1.1.1.1.cmml"><mi id="A5.Ex14.m1.13.13.1.1.1.1.1.2" xref="A5.Ex14.m1.13.13.1.1.1.1.1.2.cmml">τ</mi><mo id="A5.Ex14.m1.13.13.1.1.1.1.1.1" lspace="0.170em" xref="A5.Ex14.m1.13.13.1.1.1.1.1.1.cmml">⁢</mo><msub id="A5.Ex14.m1.13.13.1.1.1.1.1.3" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3.cmml"><mi id="A5.Ex14.m1.13.13.1.1.1.1.1.3.2" mathvariant="normal" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3.2.cmml">Δ</mi><mi id="A5.Ex14.m1.13.13.1.1.1.1.1.3.3" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.Ex14.m1.13.13.1.1.1.1.1.1a" xref="A5.Ex14.m1.13.13.1.1.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="A5.Ex14.m1.6.6" xref="A5.Ex14.m1.6.6.cmml"><mfrac id="A5.Ex14.m1.6.6a" xref="A5.Ex14.m1.6.6.cmml"><mrow id="A5.Ex14.m1.3.3.2" xref="A5.Ex14.m1.3.3.2.cmml"><msubsup id="A5.Ex14.m1.3.3.2.4" xref="A5.Ex14.m1.3.3.2.4.cmml"><mi id="A5.Ex14.m1.3.3.2.4.2.2" xref="A5.Ex14.m1.3.3.2.4.2.2.cmml">w</mi><mi id="A5.Ex14.m1.3.3.2.4.2.3" mathvariant="normal" xref="A5.Ex14.m1.3.3.2.4.2.3.cmml">l</mi><mrow id="A5.Ex14.m1.2.2.1.1.1.3" xref="A5.Ex14.m1.3.3.2.4.cmml"><mo id="A5.Ex14.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.3.3.2.4.cmml">(</mo><mi id="A5.Ex14.m1.2.2.1.1.1.1" xref="A5.Ex14.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.Ex14.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.3.3.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex14.m1.3.3.2.3" lspace="0.170em" xref="A5.Ex14.m1.3.3.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex14.m1.3.3.2.5" xref="A5.Ex14.m1.3.3.2.5.cmml">ℐ</mi><mo id="A5.Ex14.m1.3.3.2.3a" xref="A5.Ex14.m1.3.3.2.3.cmml">⁢</mo><mrow id="A5.Ex14.m1.3.3.2.6.2" xref="A5.Ex14.m1.3.3.2.cmml"><mo id="A5.Ex14.m1.3.3.2.6.2.1" stretchy="false" xref="A5.Ex14.m1.3.3.2.cmml">(</mo><mi id="A5.Ex14.m1.3.3.2.2" xref="A5.Ex14.m1.3.3.2.2.cmml">x</mi><mo id="A5.Ex14.m1.3.3.2.6.2.2" stretchy="false" xref="A5.Ex14.m1.3.3.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex14.m1.6.6.5.3" xref="A5.Ex14.m1.6.6.5.4.cmml"><mo id="A5.Ex14.m1.6.6.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex14.m1.6.6.5.4.1.cmml">‖</mo><mrow id="A5.Ex14.m1.6.6.5.3.1" xref="A5.Ex14.m1.6.6.5.3.1.cmml"><msubsup id="A5.Ex14.m1.6.6.5.3.1.2" xref="A5.Ex14.m1.6.6.5.3.1.2.cmml"><mi id="A5.Ex14.m1.6.6.5.3.1.2.2.2" xref="A5.Ex14.m1.6.6.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex14.m1.6.6.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex14.m1.6.6.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex14.m1.4.4.3.1.1.3" xref="A5.Ex14.m1.6.6.5.3.1.2.cmml"><mo id="A5.Ex14.m1.4.4.3.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.6.6.5.3.1.2.cmml">(</mo><mi id="A5.Ex14.m1.4.4.3.1.1.1" xref="A5.Ex14.m1.4.4.3.1.1.1.cmml">i</mi><mo id="A5.Ex14.m1.4.4.3.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.6.6.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex14.m1.6.6.5.3.1.1" xref="A5.Ex14.m1.6.6.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex14.m1.6.6.5.3.1.3" xref="A5.Ex14.m1.6.6.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex14.m1.6.6.5.3.1.1a" xref="A5.Ex14.m1.6.6.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex14.m1.6.6.5.3.1.4.2" xref="A5.Ex14.m1.6.6.5.3.1.cmml"><mo id="A5.Ex14.m1.6.6.5.3.1.4.2.1" stretchy="false" xref="A5.Ex14.m1.6.6.5.3.1.cmml">(</mo><mi id="A5.Ex14.m1.5.5.4.2" xref="A5.Ex14.m1.5.5.4.2.cmml">x</mi><mo id="A5.Ex14.m1.6.6.5.3.1.4.2.2" stretchy="false" xref="A5.Ex14.m1.6.6.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex14.m1.6.6.5.3.3" stretchy="false" xref="A5.Ex14.m1.6.6.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo fence="true" id="A5.Ex14.m1.13.13.1.1.1.1.3" lspace="0em" mathsize="160%" xref="A5.Ex14.m1.13.13.1.1.1.2.1.cmml">∥</mo></mrow></mrow><mo id="A5.Ex14.m1.14.14.2.3" rspace="0.502em" xref="A5.Ex14.m1.14.14.2.3.cmml">+</mo><mrow id="A5.Ex14.m1.14.14.2.2" xref="A5.Ex14.m1.14.14.2.2.cmml"><msub id="A5.Ex14.m1.14.14.2.2.3" xref="A5.Ex14.m1.14.14.2.2.3.cmml"><mi id="A5.Ex14.m1.14.14.2.2.3.2" xref="A5.Ex14.m1.14.14.2.2.3.2.cmml">𝔼</mi><msup id="A5.Ex14.m1.7.7.1" xref="A5.Ex14.m1.7.7.1.cmml"><mi id="A5.Ex14.m1.7.7.1.3" xref="A5.Ex14.m1.7.7.1.3.cmml">D</mi><mrow id="A5.Ex14.m1.7.7.1.1.1.3" xref="A5.Ex14.m1.7.7.1.cmml"><mo id="A5.Ex14.m1.7.7.1.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.7.7.1.cmml">(</mo><mi id="A5.Ex14.m1.7.7.1.1.1.1" xref="A5.Ex14.m1.7.7.1.1.1.1.cmml">j</mi><mo id="A5.Ex14.m1.7.7.1.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.7.7.1.cmml">)</mo></mrow></msup></msub><mo id="A5.Ex14.m1.14.14.2.2.2" lspace="0em" xref="A5.Ex14.m1.14.14.2.2.2.cmml">⁢</mo><mrow id="A5.Ex14.m1.14.14.2.2.1.1" xref="A5.Ex14.m1.14.14.2.2.1.2.cmml"><mo fence="true" id="A5.Ex14.m1.14.14.2.2.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.Ex14.m1.14.14.2.2.1.2.1.cmml">∥</mo><mrow id="A5.Ex14.m1.14.14.2.2.1.1.1" xref="A5.Ex14.m1.14.14.2.2.1.1.1.cmml"><mi id="A5.Ex14.m1.14.14.2.2.1.1.1.2" xref="A5.Ex14.m1.14.14.2.2.1.1.1.2.cmml">τ</mi><mo id="A5.Ex14.m1.14.14.2.2.1.1.1.1" lspace="0.170em" xref="A5.Ex14.m1.14.14.2.2.1.1.1.1.cmml">⁢</mo><msub id="A5.Ex14.m1.14.14.2.2.1.1.1.3" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3.cmml"><mi id="A5.Ex14.m1.14.14.2.2.1.1.1.3.2" mathvariant="normal" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3.2.cmml">Δ</mi><mi id="A5.Ex14.m1.14.14.2.2.1.1.1.3.3" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3.3.cmml">j</mi></msub><mo id="A5.Ex14.m1.14.14.2.2.1.1.1.1a" xref="A5.Ex14.m1.14.14.2.2.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="A5.Ex14.m1.12.12" xref="A5.Ex14.m1.12.12.cmml"><mfrac id="A5.Ex14.m1.12.12a" xref="A5.Ex14.m1.12.12.cmml"><mrow id="A5.Ex14.m1.9.9.2" xref="A5.Ex14.m1.9.9.2.cmml"><msubsup id="A5.Ex14.m1.9.9.2.4" xref="A5.Ex14.m1.9.9.2.4.cmml"><mi id="A5.Ex14.m1.9.9.2.4.2.2" xref="A5.Ex14.m1.9.9.2.4.2.2.cmml">w</mi><mi id="A5.Ex14.m1.9.9.2.4.2.3" mathvariant="normal" xref="A5.Ex14.m1.9.9.2.4.2.3.cmml">l</mi><mrow id="A5.Ex14.m1.8.8.1.1.1.3" xref="A5.Ex14.m1.9.9.2.4.cmml"><mo id="A5.Ex14.m1.8.8.1.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.9.9.2.4.cmml">(</mo><mi id="A5.Ex14.m1.8.8.1.1.1.1" xref="A5.Ex14.m1.8.8.1.1.1.1.cmml">j</mi><mo id="A5.Ex14.m1.8.8.1.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.9.9.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex14.m1.9.9.2.3" lspace="0.170em" xref="A5.Ex14.m1.9.9.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex14.m1.9.9.2.5" xref="A5.Ex14.m1.9.9.2.5.cmml">ℐ</mi><mo id="A5.Ex14.m1.9.9.2.3a" xref="A5.Ex14.m1.9.9.2.3.cmml">⁢</mo><mrow id="A5.Ex14.m1.9.9.2.6.2" xref="A5.Ex14.m1.9.9.2.cmml"><mo id="A5.Ex14.m1.9.9.2.6.2.1" stretchy="false" xref="A5.Ex14.m1.9.9.2.cmml">(</mo><mi id="A5.Ex14.m1.9.9.2.2" xref="A5.Ex14.m1.9.9.2.2.cmml">x</mi><mo id="A5.Ex14.m1.9.9.2.6.2.2" stretchy="false" xref="A5.Ex14.m1.9.9.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex14.m1.12.12.5.3" xref="A5.Ex14.m1.12.12.5.4.cmml"><mo id="A5.Ex14.m1.12.12.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex14.m1.12.12.5.4.1.cmml">‖</mo><mrow id="A5.Ex14.m1.12.12.5.3.1" xref="A5.Ex14.m1.12.12.5.3.1.cmml"><msubsup id="A5.Ex14.m1.12.12.5.3.1.2" xref="A5.Ex14.m1.12.12.5.3.1.2.cmml"><mi id="A5.Ex14.m1.12.12.5.3.1.2.2.2" xref="A5.Ex14.m1.12.12.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex14.m1.12.12.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex14.m1.12.12.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex14.m1.10.10.3.1.1.3" xref="A5.Ex14.m1.12.12.5.3.1.2.cmml"><mo id="A5.Ex14.m1.10.10.3.1.1.3.1" stretchy="false" xref="A5.Ex14.m1.12.12.5.3.1.2.cmml">(</mo><mi id="A5.Ex14.m1.10.10.3.1.1.1" xref="A5.Ex14.m1.10.10.3.1.1.1.cmml">j</mi><mo id="A5.Ex14.m1.10.10.3.1.1.3.2" stretchy="false" xref="A5.Ex14.m1.12.12.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex14.m1.12.12.5.3.1.1" xref="A5.Ex14.m1.12.12.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex14.m1.12.12.5.3.1.3" xref="A5.Ex14.m1.12.12.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex14.m1.12.12.5.3.1.1a" xref="A5.Ex14.m1.12.12.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex14.m1.12.12.5.3.1.4.2" xref="A5.Ex14.m1.12.12.5.3.1.cmml"><mo id="A5.Ex14.m1.12.12.5.3.1.4.2.1" stretchy="false" xref="A5.Ex14.m1.12.12.5.3.1.cmml">(</mo><mi id="A5.Ex14.m1.11.11.4.2" xref="A5.Ex14.m1.11.11.4.2.cmml">x</mi><mo id="A5.Ex14.m1.12.12.5.3.1.4.2.2" stretchy="false" xref="A5.Ex14.m1.12.12.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex14.m1.12.12.5.3.3" stretchy="false" xref="A5.Ex14.m1.12.12.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo fence="true" id="A5.Ex14.m1.14.14.2.2.1.1.3" lspace="0em" mathsize="160%" xref="A5.Ex14.m1.14.14.2.2.1.2.1.cmml">∥</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex14.m1.14b"><apply id="A5.Ex14.m1.14.14.cmml" xref="A5.Ex14.m1.14.14"><leq id="A5.Ex14.m1.14.14.3.cmml" xref="A5.Ex14.m1.14.14.3"></leq><csymbol cd="latexml" id="A5.Ex14.m1.14.14.4.cmml" xref="A5.Ex14.m1.14.14.4">absent</csymbol><apply id="A5.Ex14.m1.14.14.2.cmml" xref="A5.Ex14.m1.14.14.2"><plus id="A5.Ex14.m1.14.14.2.3.cmml" xref="A5.Ex14.m1.14.14.2.3"></plus><apply id="A5.Ex14.m1.13.13.1.1.cmml" xref="A5.Ex14.m1.13.13.1.1"><times id="A5.Ex14.m1.13.13.1.1.2.cmml" xref="A5.Ex14.m1.13.13.1.1.2"></times><apply id="A5.Ex14.m1.13.13.1.1.3.cmml" xref="A5.Ex14.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="A5.Ex14.m1.13.13.1.1.3.1.cmml" xref="A5.Ex14.m1.13.13.1.1.3">subscript</csymbol><ci id="A5.Ex14.m1.13.13.1.1.3.2.cmml" xref="A5.Ex14.m1.13.13.1.1.3.2">𝔼</ci><apply id="A5.Ex14.m1.1.1.1.cmml" xref="A5.Ex14.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex14.m1.1.1.1.2.cmml" xref="A5.Ex14.m1.1.1.1">superscript</csymbol><ci id="A5.Ex14.m1.1.1.1.3.cmml" xref="A5.Ex14.m1.1.1.1.3">𝐷</ci><ci id="A5.Ex14.m1.1.1.1.1.1.1.cmml" xref="A5.Ex14.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex14.m1.13.13.1.1.1.2.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1"><csymbol cd="latexml" id="A5.Ex14.m1.13.13.1.1.1.2.1.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.Ex14.m1.13.13.1.1.1.1.1.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1"><times id="A5.Ex14.m1.13.13.1.1.1.1.1.1.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.1"></times><ci id="A5.Ex14.m1.13.13.1.1.1.1.1.2.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.2">𝜏</ci><apply id="A5.Ex14.m1.13.13.1.1.1.1.1.3.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex14.m1.13.13.1.1.1.1.1.3.1.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3">subscript</csymbol><ci id="A5.Ex14.m1.13.13.1.1.1.1.1.3.2.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3.2">Δ</ci><ci id="A5.Ex14.m1.13.13.1.1.1.1.1.3.3.cmml" xref="A5.Ex14.m1.13.13.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A5.Ex14.m1.6.6.cmml" xref="A5.Ex14.m1.6.6"><divide id="A5.Ex14.m1.6.6.6.cmml" xref="A5.Ex14.m1.6.6"></divide><apply id="A5.Ex14.m1.3.3.2.cmml" xref="A5.Ex14.m1.3.3.2"><times id="A5.Ex14.m1.3.3.2.3.cmml" xref="A5.Ex14.m1.3.3.2.3"></times><apply id="A5.Ex14.m1.3.3.2.4.cmml" xref="A5.Ex14.m1.3.3.2.4"><csymbol cd="ambiguous" id="A5.Ex14.m1.3.3.2.4.1.cmml" xref="A5.Ex14.m1.3.3.2.4">superscript</csymbol><apply id="A5.Ex14.m1.3.3.2.4.2.cmml" xref="A5.Ex14.m1.3.3.2.4"><csymbol cd="ambiguous" id="A5.Ex14.m1.3.3.2.4.2.1.cmml" xref="A5.Ex14.m1.3.3.2.4">subscript</csymbol><ci id="A5.Ex14.m1.3.3.2.4.2.2.cmml" xref="A5.Ex14.m1.3.3.2.4.2.2">𝑤</ci><ci id="A5.Ex14.m1.3.3.2.4.2.3.cmml" xref="A5.Ex14.m1.3.3.2.4.2.3">l</ci></apply><ci id="A5.Ex14.m1.2.2.1.1.1.1.cmml" xref="A5.Ex14.m1.2.2.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex14.m1.3.3.2.5.cmml" xref="A5.Ex14.m1.3.3.2.5">ℐ</ci><ci id="A5.Ex14.m1.3.3.2.2.cmml" xref="A5.Ex14.m1.3.3.2.2">𝑥</ci></apply><apply id="A5.Ex14.m1.6.6.5.4.cmml" xref="A5.Ex14.m1.6.6.5.3"><csymbol cd="latexml" id="A5.Ex14.m1.6.6.5.4.1.cmml" xref="A5.Ex14.m1.6.6.5.3.2">norm</csymbol><apply id="A5.Ex14.m1.6.6.5.3.1.cmml" xref="A5.Ex14.m1.6.6.5.3.1"><times id="A5.Ex14.m1.6.6.5.3.1.1.cmml" xref="A5.Ex14.m1.6.6.5.3.1.1"></times><apply id="A5.Ex14.m1.6.6.5.3.1.2.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex14.m1.6.6.5.3.1.2.1.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2">superscript</csymbol><apply id="A5.Ex14.m1.6.6.5.3.1.2.2.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex14.m1.6.6.5.3.1.2.2.1.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2">subscript</csymbol><ci id="A5.Ex14.m1.6.6.5.3.1.2.2.2.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex14.m1.6.6.5.3.1.2.2.3.cmml" xref="A5.Ex14.m1.6.6.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex14.m1.4.4.3.1.1.1.cmml" xref="A5.Ex14.m1.4.4.3.1.1.1">𝑖</ci></apply><ci id="A5.Ex14.m1.6.6.5.3.1.3.cmml" xref="A5.Ex14.m1.6.6.5.3.1.3">ℐ</ci><ci id="A5.Ex14.m1.5.5.4.2.cmml" xref="A5.Ex14.m1.5.5.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A5.Ex14.m1.14.14.2.2.cmml" xref="A5.Ex14.m1.14.14.2.2"><times id="A5.Ex14.m1.14.14.2.2.2.cmml" xref="A5.Ex14.m1.14.14.2.2.2"></times><apply id="A5.Ex14.m1.14.14.2.2.3.cmml" xref="A5.Ex14.m1.14.14.2.2.3"><csymbol cd="ambiguous" id="A5.Ex14.m1.14.14.2.2.3.1.cmml" xref="A5.Ex14.m1.14.14.2.2.3">subscript</csymbol><ci id="A5.Ex14.m1.14.14.2.2.3.2.cmml" xref="A5.Ex14.m1.14.14.2.2.3.2">𝔼</ci><apply id="A5.Ex14.m1.7.7.1.cmml" xref="A5.Ex14.m1.7.7.1"><csymbol cd="ambiguous" id="A5.Ex14.m1.7.7.1.2.cmml" xref="A5.Ex14.m1.7.7.1">superscript</csymbol><ci id="A5.Ex14.m1.7.7.1.3.cmml" xref="A5.Ex14.m1.7.7.1.3">𝐷</ci><ci id="A5.Ex14.m1.7.7.1.1.1.1.cmml" xref="A5.Ex14.m1.7.7.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.Ex14.m1.14.14.2.2.1.2.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1"><csymbol cd="latexml" id="A5.Ex14.m1.14.14.2.2.1.2.1.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.2">delimited-∥∥</csymbol><apply id="A5.Ex14.m1.14.14.2.2.1.1.1.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1"><times id="A5.Ex14.m1.14.14.2.2.1.1.1.1.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.1"></times><ci id="A5.Ex14.m1.14.14.2.2.1.1.1.2.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.2">𝜏</ci><apply id="A5.Ex14.m1.14.14.2.2.1.1.1.3.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex14.m1.14.14.2.2.1.1.1.3.1.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3">subscript</csymbol><ci id="A5.Ex14.m1.14.14.2.2.1.1.1.3.2.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3.2">Δ</ci><ci id="A5.Ex14.m1.14.14.2.2.1.1.1.3.3.cmml" xref="A5.Ex14.m1.14.14.2.2.1.1.1.3.3">𝑗</ci></apply><apply id="A5.Ex14.m1.12.12.cmml" xref="A5.Ex14.m1.12.12"><divide id="A5.Ex14.m1.12.12.6.cmml" xref="A5.Ex14.m1.12.12"></divide><apply id="A5.Ex14.m1.9.9.2.cmml" xref="A5.Ex14.m1.9.9.2"><times id="A5.Ex14.m1.9.9.2.3.cmml" xref="A5.Ex14.m1.9.9.2.3"></times><apply id="A5.Ex14.m1.9.9.2.4.cmml" xref="A5.Ex14.m1.9.9.2.4"><csymbol cd="ambiguous" id="A5.Ex14.m1.9.9.2.4.1.cmml" xref="A5.Ex14.m1.9.9.2.4">superscript</csymbol><apply id="A5.Ex14.m1.9.9.2.4.2.cmml" xref="A5.Ex14.m1.9.9.2.4"><csymbol cd="ambiguous" id="A5.Ex14.m1.9.9.2.4.2.1.cmml" xref="A5.Ex14.m1.9.9.2.4">subscript</csymbol><ci id="A5.Ex14.m1.9.9.2.4.2.2.cmml" xref="A5.Ex14.m1.9.9.2.4.2.2">𝑤</ci><ci id="A5.Ex14.m1.9.9.2.4.2.3.cmml" xref="A5.Ex14.m1.9.9.2.4.2.3">l</ci></apply><ci id="A5.Ex14.m1.8.8.1.1.1.1.cmml" xref="A5.Ex14.m1.8.8.1.1.1.1">𝑗</ci></apply><ci id="A5.Ex14.m1.9.9.2.5.cmml" xref="A5.Ex14.m1.9.9.2.5">ℐ</ci><ci id="A5.Ex14.m1.9.9.2.2.cmml" xref="A5.Ex14.m1.9.9.2.2">𝑥</ci></apply><apply id="A5.Ex14.m1.12.12.5.4.cmml" xref="A5.Ex14.m1.12.12.5.3"><csymbol cd="latexml" id="A5.Ex14.m1.12.12.5.4.1.cmml" xref="A5.Ex14.m1.12.12.5.3.2">norm</csymbol><apply id="A5.Ex14.m1.12.12.5.3.1.cmml" xref="A5.Ex14.m1.12.12.5.3.1"><times id="A5.Ex14.m1.12.12.5.3.1.1.cmml" xref="A5.Ex14.m1.12.12.5.3.1.1"></times><apply id="A5.Ex14.m1.12.12.5.3.1.2.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex14.m1.12.12.5.3.1.2.1.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2">superscript</csymbol><apply id="A5.Ex14.m1.12.12.5.3.1.2.2.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex14.m1.12.12.5.3.1.2.2.1.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2">subscript</csymbol><ci id="A5.Ex14.m1.12.12.5.3.1.2.2.2.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex14.m1.12.12.5.3.1.2.2.3.cmml" xref="A5.Ex14.m1.12.12.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex14.m1.10.10.3.1.1.1.cmml" xref="A5.Ex14.m1.10.10.3.1.1.1">𝑗</ci></apply><ci id="A5.Ex14.m1.12.12.5.3.1.3.cmml" xref="A5.Ex14.m1.12.12.5.3.1.3">ℐ</ci><ci id="A5.Ex14.m1.11.11.4.2.cmml" xref="A5.Ex14.m1.11.11.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex14.m1.14c">\displaystyle\;\leq\;\mathbb{E}_{D^{(i)}}\Bigl{\|}\,\tau\,\Delta_{i}\,\frac{\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(%
x)\|\,}\Bigr{\|}\;+\;\mathbb{E}_{D^{(j)}}\Bigl{\|}\,\tau\,\Delta_{j}\,\frac{\,%
w_{\mathrm{l}}^{(j)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(j)}\,\mathcal{I}(%
x)\|\,}\Bigr{\|}</annotation><annotation encoding="application/x-llamapun" id="A5.Ex14.m1.14d">≤ blackboard_E start_POSTSUBSCRIPT italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ italic_τ roman_Δ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ∥ + blackboard_E start_POSTSUBSCRIPT italic_D start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ italic_τ roman_Δ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A5.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\;\leq\;\mathbb{E}_{D^{(i)}}\Bigl{\|}\,2\tau\,\frac{\,w_{\mathrm{%
l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}%
\Bigr{\|}\;+\;\mathbb{E}_{D^{(j)}}\Bigl{\|}\,2\tau\,\frac{\,w_{\mathrm{l}}^{(j%
)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(j)}\,\mathcal{I}(x)\|\,}\Bigr{\|}," class="ltx_Math" display="inline" id="A5.E2.m1.13"><semantics id="A5.E2.m1.13a"><mrow id="A5.E2.m1.13.13.1" xref="A5.E2.m1.13.13.1.1.cmml"><mrow id="A5.E2.m1.13.13.1.1" xref="A5.E2.m1.13.13.1.1.cmml"><mi id="A5.E2.m1.13.13.1.1.4" xref="A5.E2.m1.13.13.1.1.4.cmml"></mi><mo id="A5.E2.m1.13.13.1.1.3" lspace="0.558em" rspace="0.558em" xref="A5.E2.m1.13.13.1.1.3.cmml">≤</mo><mrow id="A5.E2.m1.13.13.1.1.2" xref="A5.E2.m1.13.13.1.1.2.cmml"><mrow id="A5.E2.m1.13.13.1.1.1.1" xref="A5.E2.m1.13.13.1.1.1.1.cmml"><msub id="A5.E2.m1.13.13.1.1.1.1.3" xref="A5.E2.m1.13.13.1.1.1.1.3.cmml"><mi id="A5.E2.m1.13.13.1.1.1.1.3.2" xref="A5.E2.m1.13.13.1.1.1.1.3.2.cmml">𝔼</mi><msup id="A5.E2.m1.1.1.1" xref="A5.E2.m1.1.1.1.cmml"><mi id="A5.E2.m1.1.1.1.3" xref="A5.E2.m1.1.1.1.3.cmml">D</mi><mrow id="A5.E2.m1.1.1.1.1.1.3" xref="A5.E2.m1.1.1.1.cmml"><mo id="A5.E2.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.E2.m1.1.1.1.cmml">(</mo><mi id="A5.E2.m1.1.1.1.1.1.1" xref="A5.E2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.E2.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.E2.m1.1.1.1.cmml">)</mo></mrow></msup></msub><mo id="A5.E2.m1.13.13.1.1.1.1.2" lspace="0em" xref="A5.E2.m1.13.13.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E2.m1.13.13.1.1.1.1.1.1" xref="A5.E2.m1.13.13.1.1.1.1.1.2.cmml"><mo fence="true" id="A5.E2.m1.13.13.1.1.1.1.1.1.2" mathsize="160%" rspace="0em" xref="A5.E2.m1.13.13.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="A5.E2.m1.13.13.1.1.1.1.1.1.1" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.cmml"><mn id="A5.E2.m1.13.13.1.1.1.1.1.1.1.2" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.2.cmml"> 2</mn><mo id="A5.E2.m1.13.13.1.1.1.1.1.1.1.1" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A5.E2.m1.13.13.1.1.1.1.1.1.1.3" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.3.cmml">τ</mi><mo id="A5.E2.m1.13.13.1.1.1.1.1.1.1.1a" lspace="0.170em" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="A5.E2.m1.6.6" xref="A5.E2.m1.6.6.cmml"><mfrac id="A5.E2.m1.6.6a" xref="A5.E2.m1.6.6.cmml"><mrow id="A5.E2.m1.3.3.2" xref="A5.E2.m1.3.3.2.cmml"><msubsup id="A5.E2.m1.3.3.2.4" xref="A5.E2.m1.3.3.2.4.cmml"><mi id="A5.E2.m1.3.3.2.4.2.2" xref="A5.E2.m1.3.3.2.4.2.2.cmml">w</mi><mi id="A5.E2.m1.3.3.2.4.2.3" mathvariant="normal" xref="A5.E2.m1.3.3.2.4.2.3.cmml">l</mi><mrow id="A5.E2.m1.2.2.1.1.1.3" xref="A5.E2.m1.3.3.2.4.cmml"><mo id="A5.E2.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.E2.m1.3.3.2.4.cmml">(</mo><mi id="A5.E2.m1.2.2.1.1.1.1" xref="A5.E2.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.E2.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.E2.m1.3.3.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.E2.m1.3.3.2.3" lspace="0.170em" xref="A5.E2.m1.3.3.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E2.m1.3.3.2.5" xref="A5.E2.m1.3.3.2.5.cmml">ℐ</mi><mo id="A5.E2.m1.3.3.2.3a" xref="A5.E2.m1.3.3.2.3.cmml">⁢</mo><mrow id="A5.E2.m1.3.3.2.6.2" xref="A5.E2.m1.3.3.2.cmml"><mo id="A5.E2.m1.3.3.2.6.2.1" stretchy="false" xref="A5.E2.m1.3.3.2.cmml">(</mo><mi id="A5.E2.m1.3.3.2.2" xref="A5.E2.m1.3.3.2.2.cmml">x</mi><mo id="A5.E2.m1.3.3.2.6.2.2" stretchy="false" xref="A5.E2.m1.3.3.2.cmml">)</mo></mrow></mrow><mrow id="A5.E2.m1.6.6.5.3" xref="A5.E2.m1.6.6.5.4.cmml"><mo id="A5.E2.m1.6.6.5.3.2" rspace="0.170em" stretchy="false" xref="A5.E2.m1.6.6.5.4.1.cmml">‖</mo><mrow id="A5.E2.m1.6.6.5.3.1" xref="A5.E2.m1.6.6.5.3.1.cmml"><msubsup id="A5.E2.m1.6.6.5.3.1.2" xref="A5.E2.m1.6.6.5.3.1.2.cmml"><mi id="A5.E2.m1.6.6.5.3.1.2.2.2" xref="A5.E2.m1.6.6.5.3.1.2.2.2.cmml">w</mi><mi id="A5.E2.m1.6.6.5.3.1.2.2.3" mathvariant="normal" xref="A5.E2.m1.6.6.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.E2.m1.4.4.3.1.1.3" xref="A5.E2.m1.6.6.5.3.1.2.cmml"><mo id="A5.E2.m1.4.4.3.1.1.3.1" stretchy="false" xref="A5.E2.m1.6.6.5.3.1.2.cmml">(</mo><mi id="A5.E2.m1.4.4.3.1.1.1" xref="A5.E2.m1.4.4.3.1.1.1.cmml">i</mi><mo id="A5.E2.m1.4.4.3.1.1.3.2" stretchy="false" xref="A5.E2.m1.6.6.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.E2.m1.6.6.5.3.1.1" xref="A5.E2.m1.6.6.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E2.m1.6.6.5.3.1.3" xref="A5.E2.m1.6.6.5.3.1.3.cmml">ℐ</mi><mo id="A5.E2.m1.6.6.5.3.1.1a" xref="A5.E2.m1.6.6.5.3.1.1.cmml">⁢</mo><mrow id="A5.E2.m1.6.6.5.3.1.4.2" xref="A5.E2.m1.6.6.5.3.1.cmml"><mo id="A5.E2.m1.6.6.5.3.1.4.2.1" stretchy="false" xref="A5.E2.m1.6.6.5.3.1.cmml">(</mo><mi id="A5.E2.m1.5.5.4.2" xref="A5.E2.m1.5.5.4.2.cmml">x</mi><mo id="A5.E2.m1.6.6.5.3.1.4.2.2" stretchy="false" xref="A5.E2.m1.6.6.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.E2.m1.6.6.5.3.3" stretchy="false" xref="A5.E2.m1.6.6.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo fence="true" id="A5.E2.m1.13.13.1.1.1.1.1.1.3" lspace="0em" mathsize="160%" xref="A5.E2.m1.13.13.1.1.1.1.1.2.1.cmml">∥</mo></mrow></mrow><mo id="A5.E2.m1.13.13.1.1.2.3" rspace="0.502em" xref="A5.E2.m1.13.13.1.1.2.3.cmml">+</mo><mrow id="A5.E2.m1.13.13.1.1.2.2" xref="A5.E2.m1.13.13.1.1.2.2.cmml"><msub id="A5.E2.m1.13.13.1.1.2.2.3" xref="A5.E2.m1.13.13.1.1.2.2.3.cmml"><mi id="A5.E2.m1.13.13.1.1.2.2.3.2" xref="A5.E2.m1.13.13.1.1.2.2.3.2.cmml">𝔼</mi><msup id="A5.E2.m1.7.7.1" xref="A5.E2.m1.7.7.1.cmml"><mi id="A5.E2.m1.7.7.1.3" xref="A5.E2.m1.7.7.1.3.cmml">D</mi><mrow id="A5.E2.m1.7.7.1.1.1.3" xref="A5.E2.m1.7.7.1.cmml"><mo id="A5.E2.m1.7.7.1.1.1.3.1" stretchy="false" xref="A5.E2.m1.7.7.1.cmml">(</mo><mi id="A5.E2.m1.7.7.1.1.1.1" xref="A5.E2.m1.7.7.1.1.1.1.cmml">j</mi><mo id="A5.E2.m1.7.7.1.1.1.3.2" stretchy="false" xref="A5.E2.m1.7.7.1.cmml">)</mo></mrow></msup></msub><mo id="A5.E2.m1.13.13.1.1.2.2.2" lspace="0em" xref="A5.E2.m1.13.13.1.1.2.2.2.cmml">⁢</mo><mrow id="A5.E2.m1.13.13.1.1.2.2.1.1" xref="A5.E2.m1.13.13.1.1.2.2.1.2.cmml"><mo fence="true" id="A5.E2.m1.13.13.1.1.2.2.1.1.2" mathsize="160%" rspace="0em" xref="A5.E2.m1.13.13.1.1.2.2.1.2.1.cmml">∥</mo><mrow id="A5.E2.m1.13.13.1.1.2.2.1.1.1" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.cmml"><mn id="A5.E2.m1.13.13.1.1.2.2.1.1.1.2" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.2.cmml"> 2</mn><mo id="A5.E2.m1.13.13.1.1.2.2.1.1.1.1" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.1.cmml">⁢</mo><mi id="A5.E2.m1.13.13.1.1.2.2.1.1.1.3" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.3.cmml">τ</mi><mo id="A5.E2.m1.13.13.1.1.2.2.1.1.1.1a" lspace="0.170em" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="A5.E2.m1.12.12" xref="A5.E2.m1.12.12.cmml"><mfrac id="A5.E2.m1.12.12a" xref="A5.E2.m1.12.12.cmml"><mrow id="A5.E2.m1.9.9.2" xref="A5.E2.m1.9.9.2.cmml"><msubsup id="A5.E2.m1.9.9.2.4" xref="A5.E2.m1.9.9.2.4.cmml"><mi id="A5.E2.m1.9.9.2.4.2.2" xref="A5.E2.m1.9.9.2.4.2.2.cmml">w</mi><mi id="A5.E2.m1.9.9.2.4.2.3" mathvariant="normal" xref="A5.E2.m1.9.9.2.4.2.3.cmml">l</mi><mrow id="A5.E2.m1.8.8.1.1.1.3" xref="A5.E2.m1.9.9.2.4.cmml"><mo id="A5.E2.m1.8.8.1.1.1.3.1" stretchy="false" xref="A5.E2.m1.9.9.2.4.cmml">(</mo><mi id="A5.E2.m1.8.8.1.1.1.1" xref="A5.E2.m1.8.8.1.1.1.1.cmml">j</mi><mo id="A5.E2.m1.8.8.1.1.1.3.2" stretchy="false" xref="A5.E2.m1.9.9.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.E2.m1.9.9.2.3" lspace="0.170em" xref="A5.E2.m1.9.9.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E2.m1.9.9.2.5" xref="A5.E2.m1.9.9.2.5.cmml">ℐ</mi><mo id="A5.E2.m1.9.9.2.3a" xref="A5.E2.m1.9.9.2.3.cmml">⁢</mo><mrow id="A5.E2.m1.9.9.2.6.2" xref="A5.E2.m1.9.9.2.cmml"><mo id="A5.E2.m1.9.9.2.6.2.1" stretchy="false" xref="A5.E2.m1.9.9.2.cmml">(</mo><mi id="A5.E2.m1.9.9.2.2" xref="A5.E2.m1.9.9.2.2.cmml">x</mi><mo id="A5.E2.m1.9.9.2.6.2.2" stretchy="false" xref="A5.E2.m1.9.9.2.cmml">)</mo></mrow></mrow><mrow id="A5.E2.m1.12.12.5.3" xref="A5.E2.m1.12.12.5.4.cmml"><mo id="A5.E2.m1.12.12.5.3.2" rspace="0.170em" stretchy="false" xref="A5.E2.m1.12.12.5.4.1.cmml">‖</mo><mrow id="A5.E2.m1.12.12.5.3.1" xref="A5.E2.m1.12.12.5.3.1.cmml"><msubsup id="A5.E2.m1.12.12.5.3.1.2" xref="A5.E2.m1.12.12.5.3.1.2.cmml"><mi id="A5.E2.m1.12.12.5.3.1.2.2.2" xref="A5.E2.m1.12.12.5.3.1.2.2.2.cmml">w</mi><mi id="A5.E2.m1.12.12.5.3.1.2.2.3" mathvariant="normal" xref="A5.E2.m1.12.12.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.E2.m1.10.10.3.1.1.3" xref="A5.E2.m1.12.12.5.3.1.2.cmml"><mo id="A5.E2.m1.10.10.3.1.1.3.1" stretchy="false" xref="A5.E2.m1.12.12.5.3.1.2.cmml">(</mo><mi id="A5.E2.m1.10.10.3.1.1.1" xref="A5.E2.m1.10.10.3.1.1.1.cmml">j</mi><mo id="A5.E2.m1.10.10.3.1.1.3.2" stretchy="false" xref="A5.E2.m1.12.12.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.E2.m1.12.12.5.3.1.1" xref="A5.E2.m1.12.12.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.E2.m1.12.12.5.3.1.3" xref="A5.E2.m1.12.12.5.3.1.3.cmml">ℐ</mi><mo id="A5.E2.m1.12.12.5.3.1.1a" xref="A5.E2.m1.12.12.5.3.1.1.cmml">⁢</mo><mrow id="A5.E2.m1.12.12.5.3.1.4.2" xref="A5.E2.m1.12.12.5.3.1.cmml"><mo id="A5.E2.m1.12.12.5.3.1.4.2.1" stretchy="false" xref="A5.E2.m1.12.12.5.3.1.cmml">(</mo><mi id="A5.E2.m1.11.11.4.2" xref="A5.E2.m1.11.11.4.2.cmml">x</mi><mo id="A5.E2.m1.12.12.5.3.1.4.2.2" stretchy="false" xref="A5.E2.m1.12.12.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.E2.m1.12.12.5.3.3" stretchy="false" xref="A5.E2.m1.12.12.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo fence="true" id="A5.E2.m1.13.13.1.1.2.2.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="A5.E2.m1.13.13.1.1.2.2.1.2.1.cmml">∥</mo></mrow></mrow></mrow></mrow><mo id="A5.E2.m1.13.13.1.2" xref="A5.E2.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E2.m1.13b"><apply id="A5.E2.m1.13.13.1.1.cmml" xref="A5.E2.m1.13.13.1"><leq id="A5.E2.m1.13.13.1.1.3.cmml" xref="A5.E2.m1.13.13.1.1.3"></leq><csymbol cd="latexml" id="A5.E2.m1.13.13.1.1.4.cmml" xref="A5.E2.m1.13.13.1.1.4">absent</csymbol><apply id="A5.E2.m1.13.13.1.1.2.cmml" xref="A5.E2.m1.13.13.1.1.2"><plus id="A5.E2.m1.13.13.1.1.2.3.cmml" xref="A5.E2.m1.13.13.1.1.2.3"></plus><apply id="A5.E2.m1.13.13.1.1.1.1.cmml" xref="A5.E2.m1.13.13.1.1.1.1"><times id="A5.E2.m1.13.13.1.1.1.1.2.cmml" xref="A5.E2.m1.13.13.1.1.1.1.2"></times><apply id="A5.E2.m1.13.13.1.1.1.1.3.cmml" xref="A5.E2.m1.13.13.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E2.m1.13.13.1.1.1.1.3.1.cmml" xref="A5.E2.m1.13.13.1.1.1.1.3">subscript</csymbol><ci id="A5.E2.m1.13.13.1.1.1.1.3.2.cmml" xref="A5.E2.m1.13.13.1.1.1.1.3.2">𝔼</ci><apply id="A5.E2.m1.1.1.1.cmml" xref="A5.E2.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E2.m1.1.1.1.2.cmml" xref="A5.E2.m1.1.1.1">superscript</csymbol><ci id="A5.E2.m1.1.1.1.3.cmml" xref="A5.E2.m1.1.1.1.3">𝐷</ci><ci id="A5.E2.m1.1.1.1.1.1.1.cmml" xref="A5.E2.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E2.m1.13.13.1.1.1.1.1.2.cmml" xref="A5.E2.m1.13.13.1.1.1.1.1.1"><csymbol cd="latexml" id="A5.E2.m1.13.13.1.1.1.1.1.2.1.cmml" xref="A5.E2.m1.13.13.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.E2.m1.13.13.1.1.1.1.1.1.1.cmml" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1"><times id="A5.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.1"></times><cn id="A5.E2.m1.13.13.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.2">2</cn><ci id="A5.E2.m1.13.13.1.1.1.1.1.1.1.3.cmml" xref="A5.E2.m1.13.13.1.1.1.1.1.1.1.3">𝜏</ci><apply id="A5.E2.m1.6.6.cmml" xref="A5.E2.m1.6.6"><divide id="A5.E2.m1.6.6.6.cmml" xref="A5.E2.m1.6.6"></divide><apply id="A5.E2.m1.3.3.2.cmml" xref="A5.E2.m1.3.3.2"><times id="A5.E2.m1.3.3.2.3.cmml" xref="A5.E2.m1.3.3.2.3"></times><apply id="A5.E2.m1.3.3.2.4.cmml" xref="A5.E2.m1.3.3.2.4"><csymbol cd="ambiguous" id="A5.E2.m1.3.3.2.4.1.cmml" xref="A5.E2.m1.3.3.2.4">superscript</csymbol><apply id="A5.E2.m1.3.3.2.4.2.cmml" xref="A5.E2.m1.3.3.2.4"><csymbol cd="ambiguous" id="A5.E2.m1.3.3.2.4.2.1.cmml" xref="A5.E2.m1.3.3.2.4">subscript</csymbol><ci id="A5.E2.m1.3.3.2.4.2.2.cmml" xref="A5.E2.m1.3.3.2.4.2.2">𝑤</ci><ci id="A5.E2.m1.3.3.2.4.2.3.cmml" xref="A5.E2.m1.3.3.2.4.2.3">l</ci></apply><ci id="A5.E2.m1.2.2.1.1.1.1.cmml" xref="A5.E2.m1.2.2.1.1.1.1">𝑖</ci></apply><ci id="A5.E2.m1.3.3.2.5.cmml" xref="A5.E2.m1.3.3.2.5">ℐ</ci><ci id="A5.E2.m1.3.3.2.2.cmml" xref="A5.E2.m1.3.3.2.2">𝑥</ci></apply><apply id="A5.E2.m1.6.6.5.4.cmml" xref="A5.E2.m1.6.6.5.3"><csymbol cd="latexml" id="A5.E2.m1.6.6.5.4.1.cmml" xref="A5.E2.m1.6.6.5.3.2">norm</csymbol><apply id="A5.E2.m1.6.6.5.3.1.cmml" xref="A5.E2.m1.6.6.5.3.1"><times id="A5.E2.m1.6.6.5.3.1.1.cmml" xref="A5.E2.m1.6.6.5.3.1.1"></times><apply id="A5.E2.m1.6.6.5.3.1.2.cmml" xref="A5.E2.m1.6.6.5.3.1.2"><csymbol cd="ambiguous" id="A5.E2.m1.6.6.5.3.1.2.1.cmml" xref="A5.E2.m1.6.6.5.3.1.2">superscript</csymbol><apply id="A5.E2.m1.6.6.5.3.1.2.2.cmml" xref="A5.E2.m1.6.6.5.3.1.2"><csymbol cd="ambiguous" id="A5.E2.m1.6.6.5.3.1.2.2.1.cmml" xref="A5.E2.m1.6.6.5.3.1.2">subscript</csymbol><ci id="A5.E2.m1.6.6.5.3.1.2.2.2.cmml" xref="A5.E2.m1.6.6.5.3.1.2.2.2">𝑤</ci><ci id="A5.E2.m1.6.6.5.3.1.2.2.3.cmml" xref="A5.E2.m1.6.6.5.3.1.2.2.3">l</ci></apply><ci id="A5.E2.m1.4.4.3.1.1.1.cmml" xref="A5.E2.m1.4.4.3.1.1.1">𝑖</ci></apply><ci id="A5.E2.m1.6.6.5.3.1.3.cmml" xref="A5.E2.m1.6.6.5.3.1.3">ℐ</ci><ci id="A5.E2.m1.5.5.4.2.cmml" xref="A5.E2.m1.5.5.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A5.E2.m1.13.13.1.1.2.2.cmml" xref="A5.E2.m1.13.13.1.1.2.2"><times id="A5.E2.m1.13.13.1.1.2.2.2.cmml" xref="A5.E2.m1.13.13.1.1.2.2.2"></times><apply id="A5.E2.m1.13.13.1.1.2.2.3.cmml" xref="A5.E2.m1.13.13.1.1.2.2.3"><csymbol cd="ambiguous" id="A5.E2.m1.13.13.1.1.2.2.3.1.cmml" xref="A5.E2.m1.13.13.1.1.2.2.3">subscript</csymbol><ci id="A5.E2.m1.13.13.1.1.2.2.3.2.cmml" xref="A5.E2.m1.13.13.1.1.2.2.3.2">𝔼</ci><apply id="A5.E2.m1.7.7.1.cmml" xref="A5.E2.m1.7.7.1"><csymbol cd="ambiguous" id="A5.E2.m1.7.7.1.2.cmml" xref="A5.E2.m1.7.7.1">superscript</csymbol><ci id="A5.E2.m1.7.7.1.3.cmml" xref="A5.E2.m1.7.7.1.3">𝐷</ci><ci id="A5.E2.m1.7.7.1.1.1.1.cmml" xref="A5.E2.m1.7.7.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E2.m1.13.13.1.1.2.2.1.2.cmml" xref="A5.E2.m1.13.13.1.1.2.2.1.1"><csymbol cd="latexml" id="A5.E2.m1.13.13.1.1.2.2.1.2.1.cmml" xref="A5.E2.m1.13.13.1.1.2.2.1.1.2">delimited-∥∥</csymbol><apply id="A5.E2.m1.13.13.1.1.2.2.1.1.1.cmml" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1"><times id="A5.E2.m1.13.13.1.1.2.2.1.1.1.1.cmml" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.1"></times><cn id="A5.E2.m1.13.13.1.1.2.2.1.1.1.2.cmml" type="integer" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.2">2</cn><ci id="A5.E2.m1.13.13.1.1.2.2.1.1.1.3.cmml" xref="A5.E2.m1.13.13.1.1.2.2.1.1.1.3">𝜏</ci><apply id="A5.E2.m1.12.12.cmml" xref="A5.E2.m1.12.12"><divide id="A5.E2.m1.12.12.6.cmml" xref="A5.E2.m1.12.12"></divide><apply id="A5.E2.m1.9.9.2.cmml" xref="A5.E2.m1.9.9.2"><times id="A5.E2.m1.9.9.2.3.cmml" xref="A5.E2.m1.9.9.2.3"></times><apply id="A5.E2.m1.9.9.2.4.cmml" xref="A5.E2.m1.9.9.2.4"><csymbol cd="ambiguous" id="A5.E2.m1.9.9.2.4.1.cmml" xref="A5.E2.m1.9.9.2.4">superscript</csymbol><apply id="A5.E2.m1.9.9.2.4.2.cmml" xref="A5.E2.m1.9.9.2.4"><csymbol cd="ambiguous" id="A5.E2.m1.9.9.2.4.2.1.cmml" xref="A5.E2.m1.9.9.2.4">subscript</csymbol><ci id="A5.E2.m1.9.9.2.4.2.2.cmml" xref="A5.E2.m1.9.9.2.4.2.2">𝑤</ci><ci id="A5.E2.m1.9.9.2.4.2.3.cmml" xref="A5.E2.m1.9.9.2.4.2.3">l</ci></apply><ci id="A5.E2.m1.8.8.1.1.1.1.cmml" xref="A5.E2.m1.8.8.1.1.1.1">𝑗</ci></apply><ci id="A5.E2.m1.9.9.2.5.cmml" xref="A5.E2.m1.9.9.2.5">ℐ</ci><ci id="A5.E2.m1.9.9.2.2.cmml" xref="A5.E2.m1.9.9.2.2">𝑥</ci></apply><apply id="A5.E2.m1.12.12.5.4.cmml" xref="A5.E2.m1.12.12.5.3"><csymbol cd="latexml" id="A5.E2.m1.12.12.5.4.1.cmml" xref="A5.E2.m1.12.12.5.3.2">norm</csymbol><apply id="A5.E2.m1.12.12.5.3.1.cmml" xref="A5.E2.m1.12.12.5.3.1"><times id="A5.E2.m1.12.12.5.3.1.1.cmml" xref="A5.E2.m1.12.12.5.3.1.1"></times><apply id="A5.E2.m1.12.12.5.3.1.2.cmml" xref="A5.E2.m1.12.12.5.3.1.2"><csymbol cd="ambiguous" id="A5.E2.m1.12.12.5.3.1.2.1.cmml" xref="A5.E2.m1.12.12.5.3.1.2">superscript</csymbol><apply id="A5.E2.m1.12.12.5.3.1.2.2.cmml" xref="A5.E2.m1.12.12.5.3.1.2"><csymbol cd="ambiguous" id="A5.E2.m1.12.12.5.3.1.2.2.1.cmml" xref="A5.E2.m1.12.12.5.3.1.2">subscript</csymbol><ci id="A5.E2.m1.12.12.5.3.1.2.2.2.cmml" xref="A5.E2.m1.12.12.5.3.1.2.2.2">𝑤</ci><ci id="A5.E2.m1.12.12.5.3.1.2.2.3.cmml" xref="A5.E2.m1.12.12.5.3.1.2.2.3">l</ci></apply><ci id="A5.E2.m1.10.10.3.1.1.1.cmml" xref="A5.E2.m1.10.10.3.1.1.1">𝑗</ci></apply><ci id="A5.E2.m1.12.12.5.3.1.3.cmml" xref="A5.E2.m1.12.12.5.3.1.3">ℐ</ci><ci id="A5.E2.m1.11.11.4.2.cmml" xref="A5.E2.m1.11.11.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E2.m1.13c">\displaystyle\;\leq\;\mathbb{E}_{D^{(i)}}\Bigl{\|}\,2\tau\,\frac{\,w_{\mathrm{%
l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}%
\Bigr{\|}\;+\;\mathbb{E}_{D^{(j)}}\Bigl{\|}\,2\tau\,\frac{\,w_{\mathrm{l}}^{(j%
)}\,\mathcal{I}(x)\,}{\|\,w_{\mathrm{l}}^{(j)}\,\mathcal{I}(x)\|\,}\Bigr{\|},</annotation><annotation encoding="application/x-llamapun" id="A5.E2.m1.13d">≤ blackboard_E start_POSTSUBSCRIPT italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ 2 italic_τ divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ∥ + blackboard_E start_POSTSUBSCRIPT italic_D start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ 2 italic_τ divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ∥ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS2.p1.4">which, by noting that</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}{\|\,w_{\mathrm{l}}^{(i)}\,%
\mathcal{I}(x)\|\,}\;\leq\;\kappa\bigl{(}w_{\mathrm{l}}^{(i)}\bigr{)}," class="ltx_Math" display="block" id="A5.Ex15.m1.8"><semantics id="A5.Ex15.m1.8a"><mrow id="A5.Ex15.m1.8.8.1" xref="A5.Ex15.m1.8.8.1.1.cmml"><mrow id="A5.Ex15.m1.8.8.1.1" xref="A5.Ex15.m1.8.8.1.1.cmml"><mfrac id="A5.Ex15.m1.6.6" xref="A5.Ex15.m1.6.6.cmml"><mrow id="A5.Ex15.m1.3.3.3.3" xref="A5.Ex15.m1.3.3.3.4.cmml"><mo id="A5.Ex15.m1.3.3.3.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex15.m1.3.3.3.4.1.cmml">‖</mo><mrow id="A5.Ex15.m1.3.3.3.3.1" xref="A5.Ex15.m1.3.3.3.3.1.cmml"><msubsup id="A5.Ex15.m1.3.3.3.3.1.2" xref="A5.Ex15.m1.3.3.3.3.1.2.cmml"><mi id="A5.Ex15.m1.3.3.3.3.1.2.2.2" xref="A5.Ex15.m1.3.3.3.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex15.m1.3.3.3.3.1.2.2.3" mathvariant="normal" xref="A5.Ex15.m1.3.3.3.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex15.m1.1.1.1.1.1.3" xref="A5.Ex15.m1.3.3.3.3.1.2.cmml"><mo id="A5.Ex15.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex15.m1.3.3.3.3.1.2.cmml">(</mo><mi id="A5.Ex15.m1.1.1.1.1.1.1" xref="A5.Ex15.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex15.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex15.m1.3.3.3.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex15.m1.3.3.3.3.1.1" xref="A5.Ex15.m1.3.3.3.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex15.m1.3.3.3.3.1.3" xref="A5.Ex15.m1.3.3.3.3.1.3.cmml">ℐ</mi><mo id="A5.Ex15.m1.3.3.3.3.1.1a" xref="A5.Ex15.m1.3.3.3.3.1.1.cmml">⁢</mo><mrow id="A5.Ex15.m1.3.3.3.3.1.4.2" xref="A5.Ex15.m1.3.3.3.3.1.cmml"><mo id="A5.Ex15.m1.3.3.3.3.1.4.2.1" stretchy="false" xref="A5.Ex15.m1.3.3.3.3.1.cmml">(</mo><mi id="A5.Ex15.m1.2.2.2.2" xref="A5.Ex15.m1.2.2.2.2.cmml">x</mi><mo id="A5.Ex15.m1.3.3.3.3.1.4.2.2" stretchy="false" xref="A5.Ex15.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex15.m1.3.3.3.3.3" stretchy="false" xref="A5.Ex15.m1.3.3.3.4.1.cmml">‖</mo></mrow><mrow id="A5.Ex15.m1.6.6.6.3" xref="A5.Ex15.m1.6.6.6.4.cmml"><mo id="A5.Ex15.m1.6.6.6.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex15.m1.6.6.6.4.1.cmml">‖</mo><mrow id="A5.Ex15.m1.6.6.6.3.1" xref="A5.Ex15.m1.6.6.6.3.1.cmml"><msubsup id="A5.Ex15.m1.6.6.6.3.1.2" xref="A5.Ex15.m1.6.6.6.3.1.2.cmml"><mi id="A5.Ex15.m1.6.6.6.3.1.2.2.2" xref="A5.Ex15.m1.6.6.6.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex15.m1.6.6.6.3.1.2.2.3" mathvariant="normal" xref="A5.Ex15.m1.6.6.6.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex15.m1.4.4.4.1.1.3" xref="A5.Ex15.m1.6.6.6.3.1.2.cmml"><mo id="A5.Ex15.m1.4.4.4.1.1.3.1" stretchy="false" xref="A5.Ex15.m1.6.6.6.3.1.2.cmml">(</mo><mi id="A5.Ex15.m1.4.4.4.1.1.1" xref="A5.Ex15.m1.4.4.4.1.1.1.cmml">i</mi><mo id="A5.Ex15.m1.4.4.4.1.1.3.2" stretchy="false" xref="A5.Ex15.m1.6.6.6.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex15.m1.6.6.6.3.1.1" xref="A5.Ex15.m1.6.6.6.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex15.m1.6.6.6.3.1.3" xref="A5.Ex15.m1.6.6.6.3.1.3.cmml">ℐ</mi><mo id="A5.Ex15.m1.6.6.6.3.1.1a" xref="A5.Ex15.m1.6.6.6.3.1.1.cmml">⁢</mo><mrow id="A5.Ex15.m1.6.6.6.3.1.4.2" xref="A5.Ex15.m1.6.6.6.3.1.cmml"><mo id="A5.Ex15.m1.6.6.6.3.1.4.2.1" stretchy="false" xref="A5.Ex15.m1.6.6.6.3.1.cmml">(</mo><mi id="A5.Ex15.m1.5.5.5.2" xref="A5.Ex15.m1.5.5.5.2.cmml">x</mi><mo id="A5.Ex15.m1.6.6.6.3.1.4.2.2" stretchy="false" xref="A5.Ex15.m1.6.6.6.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex15.m1.6.6.6.3.3" stretchy="false" xref="A5.Ex15.m1.6.6.6.4.1.cmml">‖</mo></mrow></mfrac><mo id="A5.Ex15.m1.8.8.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex15.m1.8.8.1.1.2.cmml">≤</mo><mrow id="A5.Ex15.m1.8.8.1.1.1" xref="A5.Ex15.m1.8.8.1.1.1.cmml"><mi id="A5.Ex15.m1.8.8.1.1.1.3" xref="A5.Ex15.m1.8.8.1.1.1.3.cmml">κ</mi><mo id="A5.Ex15.m1.8.8.1.1.1.2" xref="A5.Ex15.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex15.m1.8.8.1.1.1.1.1" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml"><mo id="A5.Ex15.m1.8.8.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml">(</mo><msubsup id="A5.Ex15.m1.8.8.1.1.1.1.1.1" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml"><mi id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.2" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.3" mathvariant="normal" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.3.cmml">l</mi><mrow id="A5.Ex15.m1.7.7.1.3" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml"><mo id="A5.Ex15.m1.7.7.1.3.1" stretchy="false" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex15.m1.7.7.1.1" xref="A5.Ex15.m1.7.7.1.1.cmml">i</mi><mo id="A5.Ex15.m1.7.7.1.3.2" stretchy="false" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.Ex15.m1.8.8.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex15.m1.8.8.1.2" xref="A5.Ex15.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex15.m1.8b"><apply id="A5.Ex15.m1.8.8.1.1.cmml" xref="A5.Ex15.m1.8.8.1"><leq id="A5.Ex15.m1.8.8.1.1.2.cmml" xref="A5.Ex15.m1.8.8.1.1.2"></leq><apply id="A5.Ex15.m1.6.6.cmml" xref="A5.Ex15.m1.6.6"><divide id="A5.Ex15.m1.6.6.7.cmml" xref="A5.Ex15.m1.6.6"></divide><apply id="A5.Ex15.m1.3.3.3.4.cmml" xref="A5.Ex15.m1.3.3.3.3"><csymbol cd="latexml" id="A5.Ex15.m1.3.3.3.4.1.cmml" xref="A5.Ex15.m1.3.3.3.3.2">norm</csymbol><apply id="A5.Ex15.m1.3.3.3.3.1.cmml" xref="A5.Ex15.m1.3.3.3.3.1"><times id="A5.Ex15.m1.3.3.3.3.1.1.cmml" xref="A5.Ex15.m1.3.3.3.3.1.1"></times><apply id="A5.Ex15.m1.3.3.3.3.1.2.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="A5.Ex15.m1.3.3.3.3.1.2.1.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2">superscript</csymbol><apply id="A5.Ex15.m1.3.3.3.3.1.2.2.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="A5.Ex15.m1.3.3.3.3.1.2.2.1.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2">subscript</csymbol><ci id="A5.Ex15.m1.3.3.3.3.1.2.2.2.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2.2.2">𝑤</ci><ci id="A5.Ex15.m1.3.3.3.3.1.2.2.3.cmml" xref="A5.Ex15.m1.3.3.3.3.1.2.2.3">l</ci></apply><ci id="A5.Ex15.m1.1.1.1.1.1.1.cmml" xref="A5.Ex15.m1.1.1.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex15.m1.3.3.3.3.1.3.cmml" xref="A5.Ex15.m1.3.3.3.3.1.3">ℐ</ci><ci id="A5.Ex15.m1.2.2.2.2.cmml" xref="A5.Ex15.m1.2.2.2.2">𝑥</ci></apply></apply><apply id="A5.Ex15.m1.6.6.6.4.cmml" xref="A5.Ex15.m1.6.6.6.3"><csymbol cd="latexml" id="A5.Ex15.m1.6.6.6.4.1.cmml" xref="A5.Ex15.m1.6.6.6.3.2">norm</csymbol><apply id="A5.Ex15.m1.6.6.6.3.1.cmml" xref="A5.Ex15.m1.6.6.6.3.1"><times id="A5.Ex15.m1.6.6.6.3.1.1.cmml" xref="A5.Ex15.m1.6.6.6.3.1.1"></times><apply id="A5.Ex15.m1.6.6.6.3.1.2.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2"><csymbol cd="ambiguous" id="A5.Ex15.m1.6.6.6.3.1.2.1.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2">superscript</csymbol><apply id="A5.Ex15.m1.6.6.6.3.1.2.2.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2"><csymbol cd="ambiguous" id="A5.Ex15.m1.6.6.6.3.1.2.2.1.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2">subscript</csymbol><ci id="A5.Ex15.m1.6.6.6.3.1.2.2.2.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2.2.2">𝑤</ci><ci id="A5.Ex15.m1.6.6.6.3.1.2.2.3.cmml" xref="A5.Ex15.m1.6.6.6.3.1.2.2.3">l</ci></apply><ci id="A5.Ex15.m1.4.4.4.1.1.1.cmml" xref="A5.Ex15.m1.4.4.4.1.1.1">𝑖</ci></apply><ci id="A5.Ex15.m1.6.6.6.3.1.3.cmml" xref="A5.Ex15.m1.6.6.6.3.1.3">ℐ</ci><ci id="A5.Ex15.m1.5.5.5.2.cmml" xref="A5.Ex15.m1.5.5.5.2">𝑥</ci></apply></apply></apply><apply id="A5.Ex15.m1.8.8.1.1.1.cmml" xref="A5.Ex15.m1.8.8.1.1.1"><times id="A5.Ex15.m1.8.8.1.1.1.2.cmml" xref="A5.Ex15.m1.8.8.1.1.1.2"></times><ci id="A5.Ex15.m1.8.8.1.1.1.3.cmml" xref="A5.Ex15.m1.8.8.1.1.1.3">𝜅</ci><apply id="A5.Ex15.m1.8.8.1.1.1.1.1.1.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex15.m1.8.8.1.1.1.1.1.1.1.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1">superscript</csymbol><apply id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1">subscript</csymbol><ci id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.2">𝑤</ci><ci id="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="A5.Ex15.m1.8.8.1.1.1.1.1.1.2.3">l</ci></apply><ci id="A5.Ex15.m1.7.7.1.1.cmml" xref="A5.Ex15.m1.7.7.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex15.m1.8c">\frac{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}{\|\,w_{\mathrm{l}}^{(i)}\,%
\mathcal{I}(x)\|\,}\;\leq\;\kappa\bigl{(}w_{\mathrm{l}}^{(i)}\bigr{)},</annotation><annotation encoding="application/x-llamapun" id="A5.Ex15.m1.8d">divide start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ≤ italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS2.p1.5">leads to</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx3">
<tbody id="A5.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Bigl{\|}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\Bigl{[}\kappa\bigl{(}w_{%
\mathrm{l}}^{(i)}\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\Bigr{]}." class="ltx_Math" display="inline" id="A5.E3.m1.7"><semantics id="A5.E3.m1.7a"><mrow id="A5.E3.m1.7.7.1" xref="A5.E3.m1.7.7.1.1.cmml"><mrow id="A5.E3.m1.7.7.1.1" xref="A5.E3.m1.7.7.1.1.cmml"><mrow id="A5.E3.m1.7.7.1.1.1.1" xref="A5.E3.m1.7.7.1.1.1.2.cmml"><mo fence="true" id="A5.E3.m1.7.7.1.1.1.1.2" mathsize="160%" rspace="0em" xref="A5.E3.m1.7.7.1.1.1.2.1.cmml">∥</mo><mrow id="A5.E3.m1.7.7.1.1.1.1.1" xref="A5.E3.m1.7.7.1.1.1.1.1.cmml"><mrow id="A5.E3.m1.7.7.1.1.1.1.1.2" xref="A5.E3.m1.7.7.1.1.1.1.1.2.cmml"><msub id="A5.E3.m1.7.7.1.1.1.1.1.2.1" xref="A5.E3.m1.7.7.1.1.1.1.1.2.1.cmml"><mo id="A5.E3.m1.7.7.1.1.1.1.1.2.1.2" rspace="0.167em" xref="A5.E3.m1.7.7.1.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="A5.E3.m1.1.1.1" xref="A5.E3.m1.1.1.1.cmml"><mi id="A5.E3.m1.1.1.1.3.2" xref="A5.E3.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.E3.m1.1.1.1.3.3" mathvariant="normal" xref="A5.E3.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.E3.m1.1.1.1.1.1.3" xref="A5.E3.m1.1.1.1.cmml"><mo id="A5.E3.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.E3.m1.1.1.1.cmml">(</mo><mi id="A5.E3.m1.1.1.1.1.1.1" xref="A5.E3.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.E3.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.E3.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E3.m1.7.7.1.1.1.1.1.2.2" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.cmml"><mi id="A5.E3.m1.7.7.1.1.1.1.1.2.2.2" mathvariant="normal" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.E3.m1.2.2.1.3" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.cmml"><mo id="A5.E3.m1.2.2.1.3.1" stretchy="false" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.cmml">(</mo><mi id="A5.E3.m1.2.2.1.1" xref="A5.E3.m1.2.2.1.1.cmml">i</mi><mo id="A5.E3.m1.2.2.1.3.2" stretchy="false" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.E3.m1.7.7.1.1.1.1.1.1" xref="A5.E3.m1.7.7.1.1.1.1.1.1.cmml">−</mo><mrow id="A5.E3.m1.7.7.1.1.1.1.1.3" xref="A5.E3.m1.7.7.1.1.1.1.1.3.cmml"><msub id="A5.E3.m1.7.7.1.1.1.1.1.3.1" xref="A5.E3.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="A5.E3.m1.7.7.1.1.1.1.1.3.1.2" rspace="0.167em" xref="A5.E3.m1.7.7.1.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.E3.m1.3.3.1" xref="A5.E3.m1.3.3.1.cmml"><mi id="A5.E3.m1.3.3.1.3.2" xref="A5.E3.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.E3.m1.3.3.1.3.3" mathvariant="normal" xref="A5.E3.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.E3.m1.3.3.1.1.1.3" xref="A5.E3.m1.3.3.1.cmml"><mo id="A5.E3.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.E3.m1.3.3.1.cmml">(</mo><mi id="A5.E3.m1.3.3.1.1.1.1" xref="A5.E3.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.E3.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.E3.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E3.m1.7.7.1.1.1.1.1.3.2" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.cmml"><mi id="A5.E3.m1.7.7.1.1.1.1.1.3.2.2" mathvariant="normal" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E3.m1.4.4.1.3" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.cmml"><mo id="A5.E3.m1.4.4.1.3.1" stretchy="false" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.cmml">(</mo><mi id="A5.E3.m1.4.4.1.1" xref="A5.E3.m1.4.4.1.1.cmml">j</mi><mo id="A5.E3.m1.4.4.1.3.2" stretchy="false" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.E3.m1.7.7.1.1.1.1.3" lspace="0em" mathsize="160%" xref="A5.E3.m1.7.7.1.1.1.2.1.cmml">∥</mo></mrow><mo id="A5.E3.m1.7.7.1.1.3" xref="A5.E3.m1.7.7.1.1.3.cmml">≤</mo><mrow id="A5.E3.m1.7.7.1.1.2" xref="A5.E3.m1.7.7.1.1.2.cmml"><mn id="A5.E3.m1.7.7.1.1.2.3" xref="A5.E3.m1.7.7.1.1.2.3.cmml"> 2</mn><mo id="A5.E3.m1.7.7.1.1.2.2" xref="A5.E3.m1.7.7.1.1.2.2.cmml">⁢</mo><mi id="A5.E3.m1.7.7.1.1.2.4" xref="A5.E3.m1.7.7.1.1.2.4.cmml">τ</mi><mo id="A5.E3.m1.7.7.1.1.2.2a" lspace="0.170em" xref="A5.E3.m1.7.7.1.1.2.2.cmml">⁢</mo><mrow id="A5.E3.m1.7.7.1.1.2.1.1" xref="A5.E3.m1.7.7.1.1.2.1.2.cmml"><mo id="A5.E3.m1.7.7.1.1.2.1.1.2" maxsize="160%" minsize="160%" xref="A5.E3.m1.7.7.1.1.2.1.2.1.cmml">[</mo><mrow id="A5.E3.m1.7.7.1.1.2.1.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.cmml"><mrow id="A5.E3.m1.7.7.1.1.2.1.1.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.cmml"><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.1.3" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.3.cmml">κ</mi><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.1.2" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml">l</mi><mrow id="A5.E3.m1.5.5.1.3" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A5.E3.m1.5.5.1.3.1" stretchy="false" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.E3.m1.5.5.1.1" xref="A5.E3.m1.5.5.1.1.cmml">i</mi><mo id="A5.E3.m1.5.5.1.3.2" stretchy="false" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.3" xref="A5.E3.m1.7.7.1.1.2.1.1.1.3.cmml">+</mo><mrow id="A5.E3.m1.7.7.1.1.2.1.1.1.2" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.cmml"><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.2.3" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.3.cmml">κ</mi><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.2.2" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><msubsup id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml">w</mi><mi id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3" mathvariant="normal" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml">l</mi><mrow id="A5.E3.m1.6.6.1.3" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="A5.E3.m1.6.6.1.3.1" stretchy="false" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><mi id="A5.E3.m1.6.6.1.1" xref="A5.E3.m1.6.6.1.1.cmml">j</mi><mo id="A5.E3.m1.6.6.1.3.2" stretchy="false" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.E3.m1.7.7.1.1.2.1.1.3" maxsize="160%" minsize="160%" xref="A5.E3.m1.7.7.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.E3.m1.7.7.1.2" lspace="0em" xref="A5.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E3.m1.7b"><apply id="A5.E3.m1.7.7.1.1.cmml" xref="A5.E3.m1.7.7.1"><leq id="A5.E3.m1.7.7.1.1.3.cmml" xref="A5.E3.m1.7.7.1.1.3"></leq><apply id="A5.E3.m1.7.7.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="A5.E3.m1.7.7.1.1.1.2.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.E3.m1.7.7.1.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1"><minus id="A5.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.1"></minus><apply id="A5.E3.m1.7.7.1.1.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2"><apply id="A5.E3.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.1.1.1.2.1.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.1">subscript</csymbol><ci id="A5.E3.m1.7.7.1.1.1.1.1.2.1.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.1.2">∇</ci><apply id="A5.E3.m1.1.1.1.cmml" xref="A5.E3.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.1.1.1.2.cmml" xref="A5.E3.m1.1.1.1">superscript</csymbol><apply id="A5.E3.m1.1.1.1.3.cmml" xref="A5.E3.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.1.1.1.3.1.cmml" xref="A5.E3.m1.1.1.1">subscript</csymbol><ci id="A5.E3.m1.1.1.1.3.2.cmml" xref="A5.E3.m1.1.1.1.3.2">𝑤</ci><ci id="A5.E3.m1.1.1.1.3.3.cmml" xref="A5.E3.m1.1.1.1.3.3">g</ci></apply><ci id="A5.E3.m1.1.1.1.1.1.1.cmml" xref="A5.E3.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E3.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2">superscript</csymbol><ci id="A5.E3.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.2.2.2">ℓ</ci><ci id="A5.E3.m1.2.2.1.1.cmml" xref="A5.E3.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.E3.m1.7.7.1.1.1.1.1.3.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3"><apply id="A5.E3.m1.7.7.1.1.1.1.1.3.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><ci id="A5.E3.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.1.2">∇</ci><apply id="A5.E3.m1.3.3.1.cmml" xref="A5.E3.m1.3.3.1"><csymbol cd="ambiguous" id="A5.E3.m1.3.3.1.2.cmml" xref="A5.E3.m1.3.3.1">superscript</csymbol><apply id="A5.E3.m1.3.3.1.3.cmml" xref="A5.E3.m1.3.3.1"><csymbol cd="ambiguous" id="A5.E3.m1.3.3.1.3.1.cmml" xref="A5.E3.m1.3.3.1">subscript</csymbol><ci id="A5.E3.m1.3.3.1.3.2.cmml" xref="A5.E3.m1.3.3.1.3.2">𝑤</ci><ci id="A5.E3.m1.3.3.1.3.3.cmml" xref="A5.E3.m1.3.3.1.3.3">g</ci></apply><ci id="A5.E3.m1.3.3.1.1.1.1.cmml" xref="A5.E3.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E3.m1.7.7.1.1.1.1.1.3.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2">superscript</csymbol><ci id="A5.E3.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="A5.E3.m1.7.7.1.1.1.1.1.3.2.2">ℓ</ci><ci id="A5.E3.m1.4.4.1.1.cmml" xref="A5.E3.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply><apply id="A5.E3.m1.7.7.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2"><times id="A5.E3.m1.7.7.1.1.2.2.cmml" xref="A5.E3.m1.7.7.1.1.2.2"></times><cn id="A5.E3.m1.7.7.1.1.2.3.cmml" type="integer" xref="A5.E3.m1.7.7.1.1.2.3">2</cn><ci id="A5.E3.m1.7.7.1.1.2.4.cmml" xref="A5.E3.m1.7.7.1.1.2.4">𝜏</ci><apply id="A5.E3.m1.7.7.1.1.2.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1"><csymbol cd="latexml" id="A5.E3.m1.7.7.1.1.2.1.2.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1"><plus id="A5.E3.m1.7.7.1.1.2.1.1.1.3.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.3"></plus><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1"><times id="A5.E3.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.2"></times><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.1.3.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.3">𝜅</ci><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3">l</ci></apply><ci id="A5.E3.m1.5.5.1.1.cmml" xref="A5.E3.m1.5.5.1.1">𝑖</ci></apply></apply><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2"><times id="A5.E3.m1.7.7.1.1.2.1.1.1.2.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.2"></times><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.2.3.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.3">𝜅</ci><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1">superscript</csymbol><apply id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.1.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1">subscript</csymbol><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2">𝑤</ci><ci id="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml" xref="A5.E3.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3">l</ci></apply><ci id="A5.E3.m1.6.6.1.1.cmml" xref="A5.E3.m1.6.6.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E3.m1.7c">\displaystyle\Bigl{\|}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\Bigl{[}\kappa\bigl{(}w_{%
\mathrm{l}}^{(i)}\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\Bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.E3.m1.7d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ ≤ 2 italic_τ [ italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) + italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.3 </span>Generalizing to Prompt Learning with <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.1.m1.1"><semantics id="A5.SS3.1.m1.1b"><msup id="A5.SS3.1.m1.1.2" xref="A5.SS3.1.m1.1.2.cmml"><mi id="A5.SS3.1.m1.1.2.2" xref="A5.SS3.1.m1.1.2.2.cmml">𝐩</mi><mrow id="A5.SS3.1.m1.1.1.1.3" xref="A5.SS3.1.m1.1.2.cmml"><mo id="A5.SS3.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.1.m1.1.2.cmml">(</mo><mi id="A5.SS3.1.m1.1.1.1.1" xref="A5.SS3.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS3.1.m1.1c"><apply id="A5.SS3.1.m1.1.2.cmml" xref="A5.SS3.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS3.1.m1.1.2.1.cmml" xref="A5.SS3.1.m1.1.2">superscript</csymbol><ci id="A5.SS3.1.m1.1.2.2.cmml" xref="A5.SS3.1.m1.1.2.2">𝐩</ci><ci id="A5.SS3.1.m1.1.1.1.1.cmml" xref="A5.SS3.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.1.m1.1d">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.1.m1.1e">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>
</h3>
<div class="ltx_para" id="A5.SS3.p1">
<p class="ltx_p" id="A5.SS3.p1.6">The preceding analysis treats <math alttext="w_{\mathrm{g}}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.p1.1.m1.1"><semantics id="A5.SS3.p1.1.m1.1a"><msubsup id="A5.SS3.p1.1.m1.1.2" xref="A5.SS3.p1.1.m1.1.2.cmml"><mi id="A5.SS3.p1.1.m1.1.2.2.2" xref="A5.SS3.p1.1.m1.1.2.2.2.cmml">w</mi><mi id="A5.SS3.p1.1.m1.1.2.2.3" mathvariant="normal" xref="A5.SS3.p1.1.m1.1.2.2.3.cmml">g</mi><mrow id="A5.SS3.p1.1.m1.1.1.1.3" xref="A5.SS3.p1.1.m1.1.2.cmml"><mo id="A5.SS3.p1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.p1.1.m1.1.2.cmml">(</mo><mi id="A5.SS3.p1.1.m1.1.1.1.1" xref="A5.SS3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.p1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.1.m1.1b"><apply id="A5.SS3.p1.1.m1.1.2.cmml" xref="A5.SS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.1.m1.1.2.1.cmml" xref="A5.SS3.p1.1.m1.1.2">superscript</csymbol><apply id="A5.SS3.p1.1.m1.1.2.2.cmml" xref="A5.SS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.1.m1.1.2.2.1.cmml" xref="A5.SS3.p1.1.m1.1.2">subscript</csymbol><ci id="A5.SS3.p1.1.m1.1.2.2.2.cmml" xref="A5.SS3.p1.1.m1.1.2.2.2">𝑤</ci><ci id="A5.SS3.p1.1.m1.1.2.2.3.cmml" xref="A5.SS3.p1.1.m1.1.2.2.3">g</ci></apply><ci id="A5.SS3.p1.1.m1.1.1.1.1.cmml" xref="A5.SS3.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.1.m1.1c">w_{\mathrm{g}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> as a directly learnable classifier. In a prompt-learning setting, however, the actual trainable quantity is a <em class="ltx_emph ltx_font_italic" id="A5.SS3.p1.6.1">prompt embedding</em> <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.p1.2.m2.1"><semantics id="A5.SS3.p1.2.m2.1a"><msup id="A5.SS3.p1.2.m2.1.2" xref="A5.SS3.p1.2.m2.1.2.cmml"><mi id="A5.SS3.p1.2.m2.1.2.2" xref="A5.SS3.p1.2.m2.1.2.2.cmml">𝐩</mi><mrow id="A5.SS3.p1.2.m2.1.1.1.3" xref="A5.SS3.p1.2.m2.1.2.cmml"><mo id="A5.SS3.p1.2.m2.1.1.1.3.1" stretchy="false" xref="A5.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="A5.SS3.p1.2.m2.1.1.1.1" xref="A5.SS3.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="A5.SS3.p1.2.m2.1.1.1.3.2" stretchy="false" xref="A5.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.2.m2.1b"><apply id="A5.SS3.p1.2.m2.1.2.cmml" xref="A5.SS3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.2.m2.1.2.1.cmml" xref="A5.SS3.p1.2.m2.1.2">superscript</csymbol><ci id="A5.SS3.p1.2.m2.1.2.2.cmml" xref="A5.SS3.p1.2.m2.1.2.2">𝐩</ci><ci id="A5.SS3.p1.2.m2.1.1.1.1.cmml" xref="A5.SS3.p1.2.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.2.m2.1c">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.2.m2.1d">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which indirectly determines <math alttext="w_{\mathrm{g}}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.p1.3.m3.1"><semantics id="A5.SS3.p1.3.m3.1a"><msubsup id="A5.SS3.p1.3.m3.1.2" xref="A5.SS3.p1.3.m3.1.2.cmml"><mi id="A5.SS3.p1.3.m3.1.2.2.2" xref="A5.SS3.p1.3.m3.1.2.2.2.cmml">w</mi><mi id="A5.SS3.p1.3.m3.1.2.2.3" mathvariant="normal" xref="A5.SS3.p1.3.m3.1.2.2.3.cmml">g</mi><mrow id="A5.SS3.p1.3.m3.1.1.1.3" xref="A5.SS3.p1.3.m3.1.2.cmml"><mo id="A5.SS3.p1.3.m3.1.1.1.3.1" stretchy="false" xref="A5.SS3.p1.3.m3.1.2.cmml">(</mo><mi id="A5.SS3.p1.3.m3.1.1.1.1" xref="A5.SS3.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="A5.SS3.p1.3.m3.1.1.1.3.2" stretchy="false" xref="A5.SS3.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.3.m3.1b"><apply id="A5.SS3.p1.3.m3.1.2.cmml" xref="A5.SS3.p1.3.m3.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.3.m3.1.2.1.cmml" xref="A5.SS3.p1.3.m3.1.2">superscript</csymbol><apply id="A5.SS3.p1.3.m3.1.2.2.cmml" xref="A5.SS3.p1.3.m3.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.3.m3.1.2.2.1.cmml" xref="A5.SS3.p1.3.m3.1.2">subscript</csymbol><ci id="A5.SS3.p1.3.m3.1.2.2.2.cmml" xref="A5.SS3.p1.3.m3.1.2.2.2">𝑤</ci><ci id="A5.SS3.p1.3.m3.1.2.2.3.cmml" xref="A5.SS3.p1.3.m3.1.2.2.3">g</ci></apply><ci id="A5.SS3.p1.3.m3.1.1.1.1.cmml" xref="A5.SS3.p1.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.3.m3.1c">w_{\mathrm{g}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.3.m3.1d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>. Concretely, suppose we have a learnable <math alttext="\mathbf{p}^{(i)}\in\mathbb{R}^{K\times e}" class="ltx_Math" display="inline" id="A5.SS3.p1.4.m4.1"><semantics id="A5.SS3.p1.4.m4.1a"><mrow id="A5.SS3.p1.4.m4.1.2" xref="A5.SS3.p1.4.m4.1.2.cmml"><msup id="A5.SS3.p1.4.m4.1.2.2" xref="A5.SS3.p1.4.m4.1.2.2.cmml"><mi id="A5.SS3.p1.4.m4.1.2.2.2" xref="A5.SS3.p1.4.m4.1.2.2.2.cmml">𝐩</mi><mrow id="A5.SS3.p1.4.m4.1.1.1.3" xref="A5.SS3.p1.4.m4.1.2.2.cmml"><mo id="A5.SS3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="A5.SS3.p1.4.m4.1.2.2.cmml">(</mo><mi id="A5.SS3.p1.4.m4.1.1.1.1" xref="A5.SS3.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="A5.SS3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="A5.SS3.p1.4.m4.1.2.2.cmml">)</mo></mrow></msup><mo id="A5.SS3.p1.4.m4.1.2.1" xref="A5.SS3.p1.4.m4.1.2.1.cmml">∈</mo><msup id="A5.SS3.p1.4.m4.1.2.3" xref="A5.SS3.p1.4.m4.1.2.3.cmml"><mi id="A5.SS3.p1.4.m4.1.2.3.2" xref="A5.SS3.p1.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="A5.SS3.p1.4.m4.1.2.3.3" xref="A5.SS3.p1.4.m4.1.2.3.3.cmml"><mi id="A5.SS3.p1.4.m4.1.2.3.3.2" xref="A5.SS3.p1.4.m4.1.2.3.3.2.cmml">K</mi><mo id="A5.SS3.p1.4.m4.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A5.SS3.p1.4.m4.1.2.3.3.1.cmml">×</mo><mi id="A5.SS3.p1.4.m4.1.2.3.3.3" xref="A5.SS3.p1.4.m4.1.2.3.3.3.cmml">e</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.4.m4.1b"><apply id="A5.SS3.p1.4.m4.1.2.cmml" xref="A5.SS3.p1.4.m4.1.2"><in id="A5.SS3.p1.4.m4.1.2.1.cmml" xref="A5.SS3.p1.4.m4.1.2.1"></in><apply id="A5.SS3.p1.4.m4.1.2.2.cmml" xref="A5.SS3.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A5.SS3.p1.4.m4.1.2.2.1.cmml" xref="A5.SS3.p1.4.m4.1.2.2">superscript</csymbol><ci id="A5.SS3.p1.4.m4.1.2.2.2.cmml" xref="A5.SS3.p1.4.m4.1.2.2.2">𝐩</ci><ci id="A5.SS3.p1.4.m4.1.1.1.1.cmml" xref="A5.SS3.p1.4.m4.1.1.1.1">𝑖</ci></apply><apply id="A5.SS3.p1.4.m4.1.2.3.cmml" xref="A5.SS3.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="A5.SS3.p1.4.m4.1.2.3.1.cmml" xref="A5.SS3.p1.4.m4.1.2.3">superscript</csymbol><ci id="A5.SS3.p1.4.m4.1.2.3.2.cmml" xref="A5.SS3.p1.4.m4.1.2.3.2">ℝ</ci><apply id="A5.SS3.p1.4.m4.1.2.3.3.cmml" xref="A5.SS3.p1.4.m4.1.2.3.3"><times id="A5.SS3.p1.4.m4.1.2.3.3.1.cmml" xref="A5.SS3.p1.4.m4.1.2.3.3.1"></times><ci id="A5.SS3.p1.4.m4.1.2.3.3.2.cmml" xref="A5.SS3.p1.4.m4.1.2.3.3.2">𝐾</ci><ci id="A5.SS3.p1.4.m4.1.2.3.3.3.cmml" xref="A5.SS3.p1.4.m4.1.2.3.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.4.m4.1c">\mathbf{p}^{(i)}\in\mathbb{R}^{K\times e}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.4.m4.1d">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_e end_POSTSUPERSCRIPT</annotation></semantics></math> (e.g. <math alttext="K" class="ltx_Math" display="inline" id="A5.SS3.p1.5.m5.1"><semantics id="A5.SS3.p1.5.m5.1a"><mi id="A5.SS3.p1.5.m5.1.1" xref="A5.SS3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.5.m5.1b"><ci id="A5.SS3.p1.5.m5.1.1.cmml" xref="A5.SS3.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.5.m5.1d">italic_K</annotation></semantics></math> prompt tokens, each of dimension <math alttext="e" class="ltx_Math" display="inline" id="A5.SS3.p1.6.m6.1"><semantics id="A5.SS3.p1.6.m6.1a"><mi id="A5.SS3.p1.6.m6.1.1" xref="A5.SS3.p1.6.m6.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.6.m6.1b"><ci id="A5.SS3.p1.6.m6.1.1.cmml" xref="A5.SS3.p1.6.m6.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.6.m6.1c">e</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.6.m6.1d">italic_e</annotation></semantics></math>), and a function</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{\mathrm{g}}^{(i)}\;=\;\mathcal{T}_{\phi}\bigl{(}\mathbf{p}^{(i)}\bigr{)}," class="ltx_Math" display="block" id="A5.Ex16.m1.3"><semantics id="A5.Ex16.m1.3a"><mrow id="A5.Ex16.m1.3.3.1" xref="A5.Ex16.m1.3.3.1.1.cmml"><mrow id="A5.Ex16.m1.3.3.1.1" xref="A5.Ex16.m1.3.3.1.1.cmml"><msubsup id="A5.Ex16.m1.3.3.1.1.3" xref="A5.Ex16.m1.3.3.1.1.3.cmml"><mi id="A5.Ex16.m1.3.3.1.1.3.2.2" xref="A5.Ex16.m1.3.3.1.1.3.2.2.cmml">w</mi><mi id="A5.Ex16.m1.3.3.1.1.3.2.3" mathvariant="normal" xref="A5.Ex16.m1.3.3.1.1.3.2.3.cmml">g</mi><mrow id="A5.Ex16.m1.1.1.1.3" xref="A5.Ex16.m1.3.3.1.1.3.cmml"><mo id="A5.Ex16.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex16.m1.3.3.1.1.3.cmml">(</mo><mi id="A5.Ex16.m1.1.1.1.1" xref="A5.Ex16.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex16.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex16.m1.3.3.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A5.Ex16.m1.3.3.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex16.m1.3.3.1.1.2.cmml">=</mo><mrow id="A5.Ex16.m1.3.3.1.1.1" xref="A5.Ex16.m1.3.3.1.1.1.cmml"><msub id="A5.Ex16.m1.3.3.1.1.1.3" xref="A5.Ex16.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.Ex16.m1.3.3.1.1.1.3.2" xref="A5.Ex16.m1.3.3.1.1.1.3.2.cmml">𝒯</mi><mi id="A5.Ex16.m1.3.3.1.1.1.3.3" xref="A5.Ex16.m1.3.3.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A5.Ex16.m1.3.3.1.1.1.2" xref="A5.Ex16.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex16.m1.3.3.1.1.1.1.1" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A5.Ex16.m1.3.3.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="A5.Ex16.m1.3.3.1.1.1.1.1.1" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A5.Ex16.m1.3.3.1.1.1.1.1.1.2" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.Ex16.m1.2.2.1.3" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A5.Ex16.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex16.m1.2.2.1.1" xref="A5.Ex16.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex16.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.Ex16.m1.3.3.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex16.m1.3.3.1.2" xref="A5.Ex16.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex16.m1.3b"><apply id="A5.Ex16.m1.3.3.1.1.cmml" xref="A5.Ex16.m1.3.3.1"><eq id="A5.Ex16.m1.3.3.1.1.2.cmml" xref="A5.Ex16.m1.3.3.1.1.2"></eq><apply id="A5.Ex16.m1.3.3.1.1.3.cmml" xref="A5.Ex16.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A5.Ex16.m1.3.3.1.1.3.1.cmml" xref="A5.Ex16.m1.3.3.1.1.3">superscript</csymbol><apply id="A5.Ex16.m1.3.3.1.1.3.2.cmml" xref="A5.Ex16.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A5.Ex16.m1.3.3.1.1.3.2.1.cmml" xref="A5.Ex16.m1.3.3.1.1.3">subscript</csymbol><ci id="A5.Ex16.m1.3.3.1.1.3.2.2.cmml" xref="A5.Ex16.m1.3.3.1.1.3.2.2">𝑤</ci><ci id="A5.Ex16.m1.3.3.1.1.3.2.3.cmml" xref="A5.Ex16.m1.3.3.1.1.3.2.3">g</ci></apply><ci id="A5.Ex16.m1.1.1.1.1.cmml" xref="A5.Ex16.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.Ex16.m1.3.3.1.1.1.cmml" xref="A5.Ex16.m1.3.3.1.1.1"><times id="A5.Ex16.m1.3.3.1.1.1.2.cmml" xref="A5.Ex16.m1.3.3.1.1.1.2"></times><apply id="A5.Ex16.m1.3.3.1.1.1.3.cmml" xref="A5.Ex16.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex16.m1.3.3.1.1.1.3.1.cmml" xref="A5.Ex16.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A5.Ex16.m1.3.3.1.1.1.3.2.cmml" xref="A5.Ex16.m1.3.3.1.1.1.3.2">𝒯</ci><ci id="A5.Ex16.m1.3.3.1.1.1.3.3.cmml" xref="A5.Ex16.m1.3.3.1.1.1.3.3">italic-ϕ</ci></apply><apply id="A5.Ex16.m1.3.3.1.1.1.1.1.1.cmml" xref="A5.Ex16.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex16.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A5.Ex16.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="A5.Ex16.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A5.Ex16.m1.3.3.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.Ex16.m1.2.2.1.1.cmml" xref="A5.Ex16.m1.2.2.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex16.m1.3c">w_{\mathrm{g}}^{(i)}\;=\;\mathcal{T}_{\phi}\bigl{(}\mathbf{p}^{(i)}\bigr{)},</annotation><annotation encoding="application/x-llamapun" id="A5.Ex16.m1.3d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS3.p1.11">where <math alttext="\phi" class="ltx_Math" display="inline" id="A5.SS3.p1.7.m1.1"><semantics id="A5.SS3.p1.7.m1.1a"><mi id="A5.SS3.p1.7.m1.1.1" xref="A5.SS3.p1.7.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.7.m1.1b"><ci id="A5.SS3.p1.7.m1.1.1.cmml" xref="A5.SS3.p1.7.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.7.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.7.m1.1d">italic_ϕ</annotation></semantics></math> is the frozen text-encoder parameter, and <math alttext="\mathcal{T}_{\phi}" class="ltx_Math" display="inline" id="A5.SS3.p1.8.m2.1"><semantics id="A5.SS3.p1.8.m2.1a"><msub id="A5.SS3.p1.8.m2.1.1" xref="A5.SS3.p1.8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.p1.8.m2.1.1.2" xref="A5.SS3.p1.8.m2.1.1.2.cmml">𝒯</mi><mi id="A5.SS3.p1.8.m2.1.1.3" xref="A5.SS3.p1.8.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.8.m2.1b"><apply id="A5.SS3.p1.8.m2.1.1.cmml" xref="A5.SS3.p1.8.m2.1.1"><csymbol cd="ambiguous" id="A5.SS3.p1.8.m2.1.1.1.cmml" xref="A5.SS3.p1.8.m2.1.1">subscript</csymbol><ci id="A5.SS3.p1.8.m2.1.1.2.cmml" xref="A5.SS3.p1.8.m2.1.1.2">𝒯</ci><ci id="A5.SS3.p1.8.m2.1.1.3.cmml" xref="A5.SS3.p1.8.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.8.m2.1c">\mathcal{T}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.8.m2.1d">caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> outputs a final text-embedding matrix in <math alttext="\mathbb{R}^{K\times d}" class="ltx_Math" display="inline" id="A5.SS3.p1.9.m3.1"><semantics id="A5.SS3.p1.9.m3.1a"><msup id="A5.SS3.p1.9.m3.1.1" xref="A5.SS3.p1.9.m3.1.1.cmml"><mi id="A5.SS3.p1.9.m3.1.1.2" xref="A5.SS3.p1.9.m3.1.1.2.cmml">ℝ</mi><mrow id="A5.SS3.p1.9.m3.1.1.3" xref="A5.SS3.p1.9.m3.1.1.3.cmml"><mi id="A5.SS3.p1.9.m3.1.1.3.2" xref="A5.SS3.p1.9.m3.1.1.3.2.cmml">K</mi><mo id="A5.SS3.p1.9.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A5.SS3.p1.9.m3.1.1.3.1.cmml">×</mo><mi id="A5.SS3.p1.9.m3.1.1.3.3" xref="A5.SS3.p1.9.m3.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.9.m3.1b"><apply id="A5.SS3.p1.9.m3.1.1.cmml" xref="A5.SS3.p1.9.m3.1.1"><csymbol cd="ambiguous" id="A5.SS3.p1.9.m3.1.1.1.cmml" xref="A5.SS3.p1.9.m3.1.1">superscript</csymbol><ci id="A5.SS3.p1.9.m3.1.1.2.cmml" xref="A5.SS3.p1.9.m3.1.1.2">ℝ</ci><apply id="A5.SS3.p1.9.m3.1.1.3.cmml" xref="A5.SS3.p1.9.m3.1.1.3"><times id="A5.SS3.p1.9.m3.1.1.3.1.cmml" xref="A5.SS3.p1.9.m3.1.1.3.1"></times><ci id="A5.SS3.p1.9.m3.1.1.3.2.cmml" xref="A5.SS3.p1.9.m3.1.1.3.2">𝐾</ci><ci id="A5.SS3.p1.9.m3.1.1.3.3.cmml" xref="A5.SS3.p1.9.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.9.m3.1c">\mathbb{R}^{K\times d}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.9.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_K × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Adopting the same temperature <math alttext="\tau" class="ltx_Math" display="inline" id="A5.SS3.p1.10.m4.1"><semantics id="A5.SS3.p1.10.m4.1a"><mi id="A5.SS3.p1.10.m4.1.1" xref="A5.SS3.p1.10.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.10.m4.1b"><ci id="A5.SS3.p1.10.m4.1.1.cmml" xref="A5.SS3.p1.10.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.10.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.10.m4.1d">italic_τ</annotation></semantics></math> and local transform <math alttext="w_{\mathrm{l}}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.p1.11.m5.1"><semantics id="A5.SS3.p1.11.m5.1a"><msubsup id="A5.SS3.p1.11.m5.1.2" xref="A5.SS3.p1.11.m5.1.2.cmml"><mi id="A5.SS3.p1.11.m5.1.2.2.2" xref="A5.SS3.p1.11.m5.1.2.2.2.cmml">w</mi><mi id="A5.SS3.p1.11.m5.1.2.2.3" mathvariant="normal" xref="A5.SS3.p1.11.m5.1.2.2.3.cmml">l</mi><mrow id="A5.SS3.p1.11.m5.1.1.1.3" xref="A5.SS3.p1.11.m5.1.2.cmml"><mo id="A5.SS3.p1.11.m5.1.1.1.3.1" stretchy="false" xref="A5.SS3.p1.11.m5.1.2.cmml">(</mo><mi id="A5.SS3.p1.11.m5.1.1.1.1" xref="A5.SS3.p1.11.m5.1.1.1.1.cmml">i</mi><mo id="A5.SS3.p1.11.m5.1.1.1.3.2" stretchy="false" xref="A5.SS3.p1.11.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.11.m5.1b"><apply id="A5.SS3.p1.11.m5.1.2.cmml" xref="A5.SS3.p1.11.m5.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.11.m5.1.2.1.cmml" xref="A5.SS3.p1.11.m5.1.2">superscript</csymbol><apply id="A5.SS3.p1.11.m5.1.2.2.cmml" xref="A5.SS3.p1.11.m5.1.2"><csymbol cd="ambiguous" id="A5.SS3.p1.11.m5.1.2.2.1.cmml" xref="A5.SS3.p1.11.m5.1.2">subscript</csymbol><ci id="A5.SS3.p1.11.m5.1.2.2.2.cmml" xref="A5.SS3.p1.11.m5.1.2.2.2">𝑤</ci><ci id="A5.SS3.p1.11.m5.1.2.2.3.cmml" xref="A5.SS3.p1.11.m5.1.2.2.3">l</ci></apply><ci id="A5.SS3.p1.11.m5.1.1.1.1.cmml" xref="A5.SS3.p1.11.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.11.m5.1c">w_{\mathrm{l}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.11.m5.1d">italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, the logits become</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{x}^{(i)}\;=\;\mathrm{softmax}\!\Bigl{(}\tau\,\mathcal{T}_{\phi}\bigl{(}%
\mathbf{p}^{(i)}\bigr{)}\;\frac{\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}." class="ltx_Math" display="block" id="A5.Ex17.m1.8"><semantics id="A5.Ex17.m1.8a"><mrow id="A5.Ex17.m1.8.8.1" xref="A5.Ex17.m1.8.8.1.1.cmml"><mrow id="A5.Ex17.m1.8.8.1.1" xref="A5.Ex17.m1.8.8.1.1.cmml"><msubsup id="A5.Ex17.m1.8.8.1.1.3" xref="A5.Ex17.m1.8.8.1.1.3.cmml"><mi id="A5.Ex17.m1.8.8.1.1.3.2.2" xref="A5.Ex17.m1.8.8.1.1.3.2.2.cmml">r</mi><mi id="A5.Ex17.m1.8.8.1.1.3.2.3" xref="A5.Ex17.m1.8.8.1.1.3.2.3.cmml">x</mi><mrow id="A5.Ex17.m1.1.1.1.3" xref="A5.Ex17.m1.8.8.1.1.3.cmml"><mo id="A5.Ex17.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex17.m1.8.8.1.1.3.cmml">(</mo><mi id="A5.Ex17.m1.1.1.1.1" xref="A5.Ex17.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex17.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex17.m1.8.8.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A5.Ex17.m1.8.8.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex17.m1.8.8.1.1.2.cmml">=</mo><mrow id="A5.Ex17.m1.8.8.1.1.1" xref="A5.Ex17.m1.8.8.1.1.1.cmml"><mpadded width="3.720em"><mi id="A5.Ex17.m1.8.8.1.1.1.3" xref="A5.Ex17.m1.8.8.1.1.1.3.cmml">softmax</mi></mpadded><mo id="A5.Ex17.m1.8.8.1.1.1.2" xref="A5.Ex17.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex17.m1.8.8.1.1.1.1.1" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.cmml"><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.Ex17.m1.8.8.1.1.1.1.1.1" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.cmml"><mi id="A5.Ex17.m1.8.8.1.1.1.1.1.1.3" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.3.cmml">τ</mi><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.1.2" lspace="0.170em" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.2" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.2.cmml">𝒯</mi><mi id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.3" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.3.cmml">ϕ</mi></msub><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.1.2a" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mi id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.Ex17.m1.2.2.1.3" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex17.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex17.m1.2.2.1.1" xref="A5.Ex17.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex17.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.1.2b" lspace="0.280em" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><mfrac id="A5.Ex17.m1.7.7" xref="A5.Ex17.m1.7.7.cmml"><mrow id="A5.Ex17.m1.4.4.2" xref="A5.Ex17.m1.4.4.2.cmml"><msubsup id="A5.Ex17.m1.4.4.2.4" xref="A5.Ex17.m1.4.4.2.4.cmml"><mi id="A5.Ex17.m1.4.4.2.4.2.2" xref="A5.Ex17.m1.4.4.2.4.2.2.cmml">w</mi><mi id="A5.Ex17.m1.4.4.2.4.2.3" mathvariant="normal" xref="A5.Ex17.m1.4.4.2.4.2.3.cmml">l</mi><mrow id="A5.Ex17.m1.3.3.1.1.1.3" xref="A5.Ex17.m1.4.4.2.4.cmml"><mo id="A5.Ex17.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex17.m1.4.4.2.4.cmml">(</mo><mi id="A5.Ex17.m1.3.3.1.1.1.1" xref="A5.Ex17.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A5.Ex17.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex17.m1.4.4.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex17.m1.4.4.2.3" lspace="0.170em" xref="A5.Ex17.m1.4.4.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex17.m1.4.4.2.5" xref="A5.Ex17.m1.4.4.2.5.cmml">ℐ</mi><mo id="A5.Ex17.m1.4.4.2.3a" xref="A5.Ex17.m1.4.4.2.3.cmml">⁢</mo><mrow id="A5.Ex17.m1.4.4.2.6.2" xref="A5.Ex17.m1.4.4.2.cmml"><mo id="A5.Ex17.m1.4.4.2.6.2.1" stretchy="false" xref="A5.Ex17.m1.4.4.2.cmml">(</mo><mi id="A5.Ex17.m1.4.4.2.2" xref="A5.Ex17.m1.4.4.2.2.cmml">x</mi><mo id="A5.Ex17.m1.4.4.2.6.2.2" stretchy="false" xref="A5.Ex17.m1.4.4.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex17.m1.7.7.5.3" xref="A5.Ex17.m1.7.7.5.4.cmml"><mo id="A5.Ex17.m1.7.7.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex17.m1.7.7.5.4.1.cmml">‖</mo><mrow id="A5.Ex17.m1.7.7.5.3.1" xref="A5.Ex17.m1.7.7.5.3.1.cmml"><msubsup id="A5.Ex17.m1.7.7.5.3.1.2" xref="A5.Ex17.m1.7.7.5.3.1.2.cmml"><mi id="A5.Ex17.m1.7.7.5.3.1.2.2.2" xref="A5.Ex17.m1.7.7.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex17.m1.7.7.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex17.m1.7.7.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex17.m1.5.5.3.1.1.3" xref="A5.Ex17.m1.7.7.5.3.1.2.cmml"><mo id="A5.Ex17.m1.5.5.3.1.1.3.1" stretchy="false" xref="A5.Ex17.m1.7.7.5.3.1.2.cmml">(</mo><mi id="A5.Ex17.m1.5.5.3.1.1.1" xref="A5.Ex17.m1.5.5.3.1.1.1.cmml">i</mi><mo id="A5.Ex17.m1.5.5.3.1.1.3.2" stretchy="false" xref="A5.Ex17.m1.7.7.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex17.m1.7.7.5.3.1.1" xref="A5.Ex17.m1.7.7.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex17.m1.7.7.5.3.1.3" xref="A5.Ex17.m1.7.7.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex17.m1.7.7.5.3.1.1a" xref="A5.Ex17.m1.7.7.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex17.m1.7.7.5.3.1.4.2" xref="A5.Ex17.m1.7.7.5.3.1.cmml"><mo id="A5.Ex17.m1.7.7.5.3.1.4.2.1" stretchy="false" xref="A5.Ex17.m1.7.7.5.3.1.cmml">(</mo><mi id="A5.Ex17.m1.6.6.4.2" xref="A5.Ex17.m1.6.6.4.2.cmml">x</mi><mo id="A5.Ex17.m1.7.7.5.3.1.4.2.2" stretchy="false" xref="A5.Ex17.m1.7.7.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex17.m1.7.7.5.3.3" stretchy="false" xref="A5.Ex17.m1.7.7.5.4.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A5.Ex17.m1.8.8.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex17.m1.8.8.1.2" lspace="0em" xref="A5.Ex17.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex17.m1.8b"><apply id="A5.Ex17.m1.8.8.1.1.cmml" xref="A5.Ex17.m1.8.8.1"><eq id="A5.Ex17.m1.8.8.1.1.2.cmml" xref="A5.Ex17.m1.8.8.1.1.2"></eq><apply id="A5.Ex17.m1.8.8.1.1.3.cmml" xref="A5.Ex17.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="A5.Ex17.m1.8.8.1.1.3.1.cmml" xref="A5.Ex17.m1.8.8.1.1.3">superscript</csymbol><apply id="A5.Ex17.m1.8.8.1.1.3.2.cmml" xref="A5.Ex17.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="A5.Ex17.m1.8.8.1.1.3.2.1.cmml" xref="A5.Ex17.m1.8.8.1.1.3">subscript</csymbol><ci id="A5.Ex17.m1.8.8.1.1.3.2.2.cmml" xref="A5.Ex17.m1.8.8.1.1.3.2.2">𝑟</ci><ci id="A5.Ex17.m1.8.8.1.1.3.2.3.cmml" xref="A5.Ex17.m1.8.8.1.1.3.2.3">𝑥</ci></apply><ci id="A5.Ex17.m1.1.1.1.1.cmml" xref="A5.Ex17.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.Ex17.m1.8.8.1.1.1.cmml" xref="A5.Ex17.m1.8.8.1.1.1"><times id="A5.Ex17.m1.8.8.1.1.1.2.cmml" xref="A5.Ex17.m1.8.8.1.1.1.2"></times><ci id="A5.Ex17.m1.8.8.1.1.1.3.cmml" xref="A5.Ex17.m1.8.8.1.1.1.3">softmax</ci><apply id="A5.Ex17.m1.8.8.1.1.1.1.1.1.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1"><times id="A5.Ex17.m1.8.8.1.1.1.1.1.1.2.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.2"></times><ci id="A5.Ex17.m1.8.8.1.1.1.1.1.1.3.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.3">𝜏</ci><apply id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.1.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4">subscript</csymbol><ci id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.2.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.2">𝒯</ci><ci id="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.3.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.4.3">italic-ϕ</ci></apply><apply id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex17.m1.8.8.1.1.1.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.Ex17.m1.2.2.1.1.cmml" xref="A5.Ex17.m1.2.2.1.1">𝑖</ci></apply><apply id="A5.Ex17.m1.7.7.cmml" xref="A5.Ex17.m1.7.7"><divide id="A5.Ex17.m1.7.7.6.cmml" xref="A5.Ex17.m1.7.7"></divide><apply id="A5.Ex17.m1.4.4.2.cmml" xref="A5.Ex17.m1.4.4.2"><times id="A5.Ex17.m1.4.4.2.3.cmml" xref="A5.Ex17.m1.4.4.2.3"></times><apply id="A5.Ex17.m1.4.4.2.4.cmml" xref="A5.Ex17.m1.4.4.2.4"><csymbol cd="ambiguous" id="A5.Ex17.m1.4.4.2.4.1.cmml" xref="A5.Ex17.m1.4.4.2.4">superscript</csymbol><apply id="A5.Ex17.m1.4.4.2.4.2.cmml" xref="A5.Ex17.m1.4.4.2.4"><csymbol cd="ambiguous" id="A5.Ex17.m1.4.4.2.4.2.1.cmml" xref="A5.Ex17.m1.4.4.2.4">subscript</csymbol><ci id="A5.Ex17.m1.4.4.2.4.2.2.cmml" xref="A5.Ex17.m1.4.4.2.4.2.2">𝑤</ci><ci id="A5.Ex17.m1.4.4.2.4.2.3.cmml" xref="A5.Ex17.m1.4.4.2.4.2.3">l</ci></apply><ci id="A5.Ex17.m1.3.3.1.1.1.1.cmml" xref="A5.Ex17.m1.3.3.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex17.m1.4.4.2.5.cmml" xref="A5.Ex17.m1.4.4.2.5">ℐ</ci><ci id="A5.Ex17.m1.4.4.2.2.cmml" xref="A5.Ex17.m1.4.4.2.2">𝑥</ci></apply><apply id="A5.Ex17.m1.7.7.5.4.cmml" xref="A5.Ex17.m1.7.7.5.3"><csymbol cd="latexml" id="A5.Ex17.m1.7.7.5.4.1.cmml" xref="A5.Ex17.m1.7.7.5.3.2">norm</csymbol><apply id="A5.Ex17.m1.7.7.5.3.1.cmml" xref="A5.Ex17.m1.7.7.5.3.1"><times id="A5.Ex17.m1.7.7.5.3.1.1.cmml" xref="A5.Ex17.m1.7.7.5.3.1.1"></times><apply id="A5.Ex17.m1.7.7.5.3.1.2.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex17.m1.7.7.5.3.1.2.1.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2">superscript</csymbol><apply id="A5.Ex17.m1.7.7.5.3.1.2.2.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex17.m1.7.7.5.3.1.2.2.1.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2">subscript</csymbol><ci id="A5.Ex17.m1.7.7.5.3.1.2.2.2.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex17.m1.7.7.5.3.1.2.2.3.cmml" xref="A5.Ex17.m1.7.7.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex17.m1.5.5.3.1.1.1.cmml" xref="A5.Ex17.m1.5.5.3.1.1.1">𝑖</ci></apply><ci id="A5.Ex17.m1.7.7.5.3.1.3.cmml" xref="A5.Ex17.m1.7.7.5.3.1.3">ℐ</ci><ci id="A5.Ex17.m1.6.6.4.2.cmml" xref="A5.Ex17.m1.6.6.4.2">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex17.m1.8c">r_{x}^{(i)}\;=\;\mathrm{softmax}\!\Bigl{(}\tau\,\mathcal{T}_{\phi}\bigl{(}%
\mathbf{p}^{(i)}\bigr{)}\;\frac{\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,}{\|\,%
w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex17.m1.8d">italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = roman_softmax ( italic_τ caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS3.p1.12">Thus, the cross-entropy loss for client <math alttext="i" class="ltx_Math" display="inline" id="A5.SS3.p1.12.m1.1"><semantics id="A5.SS3.p1.12.m1.1a"><mi id="A5.SS3.p1.12.m1.1.1" xref="A5.SS3.p1.12.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.12.m1.1b"><ci id="A5.SS3.p1.12.m1.1.1.cmml" xref="A5.SS3.p1.12.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.12.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.p1.12.m1.1d">italic_i</annotation></semantics></math> retains the same form:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}\bigl{[}\mathrm{CE}\bigl{(}r_{x%
}^{(i)},\,y\bigr{)}\bigr{]}." class="ltx_Math" display="block" id="A5.Ex18.m1.7"><semantics id="A5.Ex18.m1.7a"><mrow id="A5.Ex18.m1.7.7.1" xref="A5.Ex18.m1.7.7.1.1.cmml"><mrow id="A5.Ex18.m1.7.7.1.1" xref="A5.Ex18.m1.7.7.1.1.cmml"><msup id="A5.Ex18.m1.7.7.1.1.3" xref="A5.Ex18.m1.7.7.1.1.3.cmml"><mi id="A5.Ex18.m1.7.7.1.1.3.2" mathvariant="normal" xref="A5.Ex18.m1.7.7.1.1.3.2.cmml">ℓ</mi><mrow id="A5.Ex18.m1.1.1.1.3" xref="A5.Ex18.m1.7.7.1.1.3.cmml"><mo id="A5.Ex18.m1.1.1.1.3.1" stretchy="false" xref="A5.Ex18.m1.7.7.1.1.3.cmml">(</mo><mi id="A5.Ex18.m1.1.1.1.1" xref="A5.Ex18.m1.1.1.1.1.cmml">i</mi><mo id="A5.Ex18.m1.1.1.1.3.2" stretchy="false" xref="A5.Ex18.m1.7.7.1.1.3.cmml">)</mo></mrow></msup><mo id="A5.Ex18.m1.7.7.1.1.2" lspace="0.558em" rspace="0.558em" xref="A5.Ex18.m1.7.7.1.1.2.cmml">=</mo><mrow id="A5.Ex18.m1.7.7.1.1.1" xref="A5.Ex18.m1.7.7.1.1.1.cmml"><msub id="A5.Ex18.m1.7.7.1.1.1.3" xref="A5.Ex18.m1.7.7.1.1.1.3.cmml"><mi id="A5.Ex18.m1.7.7.1.1.1.3.2" xref="A5.Ex18.m1.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="A5.Ex18.m1.4.4.3" xref="A5.Ex18.m1.4.4.3.cmml"><mrow id="A5.Ex18.m1.4.4.3.5.2" xref="A5.Ex18.m1.4.4.3.5.1.cmml"><mo id="A5.Ex18.m1.4.4.3.5.2.1" stretchy="false" xref="A5.Ex18.m1.4.4.3.5.1.cmml">(</mo><mi id="A5.Ex18.m1.3.3.2.2" xref="A5.Ex18.m1.3.3.2.2.cmml">x</mi><mo id="A5.Ex18.m1.4.4.3.5.2.2" xref="A5.Ex18.m1.4.4.3.5.1.cmml">,</mo><mi id="A5.Ex18.m1.4.4.3.3" xref="A5.Ex18.m1.4.4.3.3.cmml">y</mi><mo id="A5.Ex18.m1.4.4.3.5.2.3" rspace="0.170em" stretchy="false" xref="A5.Ex18.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="A5.Ex18.m1.4.4.3.4" rspace="0.448em" xref="A5.Ex18.m1.4.4.3.4.cmml">∈</mo><msup id="A5.Ex18.m1.4.4.3.6" xref="A5.Ex18.m1.4.4.3.6.cmml"><mi id="A5.Ex18.m1.4.4.3.6.2" xref="A5.Ex18.m1.4.4.3.6.2.cmml">D</mi><mrow id="A5.Ex18.m1.2.2.1.1.1.3" xref="A5.Ex18.m1.4.4.3.6.cmml"><mo id="A5.Ex18.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.Ex18.m1.4.4.3.6.cmml">(</mo><mi id="A5.Ex18.m1.2.2.1.1.1.1" xref="A5.Ex18.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.Ex18.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.Ex18.m1.4.4.3.6.cmml">)</mo></mrow></msup></mrow></msub><mo id="A5.Ex18.m1.7.7.1.1.1.2" xref="A5.Ex18.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex18.m1.7.7.1.1.1.1.1" xref="A5.Ex18.m1.7.7.1.1.1.1.2.cmml"><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex18.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.Ex18.m1.7.7.1.1.1.1.1.1" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.cmml"><mi id="A5.Ex18.m1.7.7.1.1.1.1.1.1.3" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.3.cmml">CE</mi><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.1.2" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">x</mi><mrow id="A5.Ex18.m1.5.5.1.3" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex18.m1.5.5.1.3.1" stretchy="false" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex18.m1.5.5.1.1" xref="A5.Ex18.m1.5.5.1.1.cmml">i</mi><mo id="A5.Ex18.m1.5.5.1.3.2" stretchy="false" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.3" rspace="0.337em" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="A5.Ex18.m1.6.6" xref="A5.Ex18.m1.6.6.cmml">y</mi><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.4" maxsize="120%" minsize="120%" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A5.Ex18.m1.7.7.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex18.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.Ex18.m1.7.7.1.2" lspace="0em" xref="A5.Ex18.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex18.m1.7b"><apply id="A5.Ex18.m1.7.7.1.1.cmml" xref="A5.Ex18.m1.7.7.1"><eq id="A5.Ex18.m1.7.7.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.2"></eq><apply id="A5.Ex18.m1.7.7.1.1.3.cmml" xref="A5.Ex18.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A5.Ex18.m1.7.7.1.1.3.1.cmml" xref="A5.Ex18.m1.7.7.1.1.3">superscript</csymbol><ci id="A5.Ex18.m1.7.7.1.1.3.2.cmml" xref="A5.Ex18.m1.7.7.1.1.3.2">ℓ</ci><ci id="A5.Ex18.m1.1.1.1.1.cmml" xref="A5.Ex18.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.Ex18.m1.7.7.1.1.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1"><times id="A5.Ex18.m1.7.7.1.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.2"></times><apply id="A5.Ex18.m1.7.7.1.1.1.3.cmml" xref="A5.Ex18.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="A5.Ex18.m1.7.7.1.1.1.3.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.3">subscript</csymbol><ci id="A5.Ex18.m1.7.7.1.1.1.3.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.3.2">𝔼</ci><apply id="A5.Ex18.m1.4.4.3.cmml" xref="A5.Ex18.m1.4.4.3"><in id="A5.Ex18.m1.4.4.3.4.cmml" xref="A5.Ex18.m1.4.4.3.4"></in><interval closure="open" id="A5.Ex18.m1.4.4.3.5.1.cmml" xref="A5.Ex18.m1.4.4.3.5.2"><ci id="A5.Ex18.m1.3.3.2.2.cmml" xref="A5.Ex18.m1.3.3.2.2">𝑥</ci><ci id="A5.Ex18.m1.4.4.3.3.cmml" xref="A5.Ex18.m1.4.4.3.3">𝑦</ci></interval><apply id="A5.Ex18.m1.4.4.3.6.cmml" xref="A5.Ex18.m1.4.4.3.6"><csymbol cd="ambiguous" id="A5.Ex18.m1.4.4.3.6.1.cmml" xref="A5.Ex18.m1.4.4.3.6">superscript</csymbol><ci id="A5.Ex18.m1.4.4.3.6.2.cmml" xref="A5.Ex18.m1.4.4.3.6.2">𝐷</ci><ci id="A5.Ex18.m1.2.2.1.1.1.1.cmml" xref="A5.Ex18.m1.2.2.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="A5.Ex18.m1.7.7.1.1.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="A5.Ex18.m1.7.7.1.1.1.1.2.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.Ex18.m1.7.7.1.1.1.1.1.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1"><times id="A5.Ex18.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.2"></times><ci id="A5.Ex18.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.3">CE</ci><interval closure="open" id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1"><apply id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A5.Ex18.m1.7.7.1.1.1.1.1.1.1.1.1.2.3">𝑥</ci></apply><ci id="A5.Ex18.m1.5.5.1.1.cmml" xref="A5.Ex18.m1.5.5.1.1">𝑖</ci></apply><ci id="A5.Ex18.m1.6.6.cmml" xref="A5.Ex18.m1.6.6">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex18.m1.7c">\ell^{(i)}\;=\;\mathbb{E}_{(x,y)\,\in\,D^{(i)}}\bigl{[}\mathrm{CE}\bigl{(}r_{x%
}^{(i)},\,y\bigr{)}\bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex18.m1.7d">roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ italic_D start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ roman_CE ( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<section class="ltx_subsubsection" id="A5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.3.1 </span>Gradient via Chain Rule</h4>
<div class="ltx_para" id="A5.SS3.SSS1.p1">
<p class="ltx_p" id="A5.SS3.SSS1.p1.5">By the same derivation as Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.E1" title="In E.1 Gradient Analysis with a Linear 𝑤ₗ^(𝑖) ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">1</span></a>), we have</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{w_{\mathrm{g}}^{(i)}}\,\ell^{(i)}\;=\;\mathbb{E}\Bigl{[}\tau\,\bigl{(}%
r_{x}^{(i)}-y\bigr{)}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,%
}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^{\top}\Bigr{]}." class="ltx_Math" display="block" id="A5.Ex19.m1.9"><semantics id="A5.Ex19.m1.9a"><mrow id="A5.Ex19.m1.9.9.1" xref="A5.Ex19.m1.9.9.1.1.cmml"><mrow id="A5.Ex19.m1.9.9.1.1" xref="A5.Ex19.m1.9.9.1.1.cmml"><mrow id="A5.Ex19.m1.9.9.1.1.3" xref="A5.Ex19.m1.9.9.1.1.3.cmml"><msub id="A5.Ex19.m1.9.9.1.1.3.1" xref="A5.Ex19.m1.9.9.1.1.3.1.cmml"><mo id="A5.Ex19.m1.9.9.1.1.3.1.2" xref="A5.Ex19.m1.9.9.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.Ex19.m1.1.1.1" xref="A5.Ex19.m1.1.1.1.cmml"><mi id="A5.Ex19.m1.1.1.1.3.2" xref="A5.Ex19.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.Ex19.m1.1.1.1.3.3" mathvariant="normal" xref="A5.Ex19.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.Ex19.m1.1.1.1.1.1.3" xref="A5.Ex19.m1.1.1.1.cmml"><mo id="A5.Ex19.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex19.m1.1.1.1.cmml">(</mo><mi id="A5.Ex19.m1.1.1.1.1.1.1" xref="A5.Ex19.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex19.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex19.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex19.m1.9.9.1.1.3.2" xref="A5.Ex19.m1.9.9.1.1.3.2.cmml"><mi id="A5.Ex19.m1.9.9.1.1.3.2.2" mathvariant="normal" xref="A5.Ex19.m1.9.9.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.Ex19.m1.2.2.1.3" xref="A5.Ex19.m1.9.9.1.1.3.2.cmml"><mo id="A5.Ex19.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex19.m1.9.9.1.1.3.2.cmml">(</mo><mi id="A5.Ex19.m1.2.2.1.1" xref="A5.Ex19.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex19.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex19.m1.9.9.1.1.3.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.Ex19.m1.9.9.1.1.2" rspace="0.558em" xref="A5.Ex19.m1.9.9.1.1.2.cmml">=</mo><mrow id="A5.Ex19.m1.9.9.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.cmml"><mi id="A5.Ex19.m1.9.9.1.1.1.3" xref="A5.Ex19.m1.9.9.1.1.1.3.cmml">𝔼</mi><mo id="A5.Ex19.m1.9.9.1.1.1.2" xref="A5.Ex19.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex19.m1.9.9.1.1.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.1.2.cmml"><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A5.Ex19.m1.9.9.1.1.1.1.2.1.cmml">[</mo><mrow id="A5.Ex19.m1.9.9.1.1.1.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.cmml"><mi id="A5.Ex19.m1.9.9.1.1.1.1.1.1.3" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.3.cmml">τ</mi><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.2" lspace="0.170em" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3.cmml">x</mi><mrow id="A5.Ex19.m1.3.3.1.3" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A5.Ex19.m1.3.3.1.3.1" stretchy="false" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A5.Ex19.m1.3.3.1.1" xref="A5.Ex19.m1.3.3.1.1.cmml">i</mi><mo id="A5.Ex19.m1.3.3.1.3.2" stretchy="false" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.2a" lspace="0.170em" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.cmml"><mrow id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.2.2" xref="A5.Ex19.m1.8.8.cmml"><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.2.2.1" maxsize="160%" minsize="160%" xref="A5.Ex19.m1.8.8.cmml">(</mo><mstyle displaystyle="false" id="A5.Ex19.m1.8.8" xref="A5.Ex19.m1.8.8.cmml"><mfrac id="A5.Ex19.m1.8.8a" xref="A5.Ex19.m1.8.8.cmml"><mrow id="A5.Ex19.m1.5.5.2" xref="A5.Ex19.m1.5.5.2.cmml"><msubsup id="A5.Ex19.m1.5.5.2.4" xref="A5.Ex19.m1.5.5.2.4.cmml"><mi id="A5.Ex19.m1.5.5.2.4.2.2" xref="A5.Ex19.m1.5.5.2.4.2.2.cmml">w</mi><mi id="A5.Ex19.m1.5.5.2.4.2.3" mathvariant="normal" xref="A5.Ex19.m1.5.5.2.4.2.3.cmml">l</mi><mrow id="A5.Ex19.m1.4.4.1.1.1.3" xref="A5.Ex19.m1.5.5.2.4.cmml"><mo id="A5.Ex19.m1.4.4.1.1.1.3.1" stretchy="false" xref="A5.Ex19.m1.5.5.2.4.cmml">(</mo><mi id="A5.Ex19.m1.4.4.1.1.1.1" xref="A5.Ex19.m1.4.4.1.1.1.1.cmml">i</mi><mo id="A5.Ex19.m1.4.4.1.1.1.3.2" stretchy="false" xref="A5.Ex19.m1.5.5.2.4.cmml">)</mo></mrow></msubsup><mo id="A5.Ex19.m1.5.5.2.3" lspace="0.170em" xref="A5.Ex19.m1.5.5.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex19.m1.5.5.2.5" xref="A5.Ex19.m1.5.5.2.5.cmml">ℐ</mi><mo id="A5.Ex19.m1.5.5.2.3a" xref="A5.Ex19.m1.5.5.2.3.cmml">⁢</mo><mrow id="A5.Ex19.m1.5.5.2.6.2" xref="A5.Ex19.m1.5.5.2.cmml"><mo id="A5.Ex19.m1.5.5.2.6.2.1" stretchy="false" xref="A5.Ex19.m1.5.5.2.cmml">(</mo><mi id="A5.Ex19.m1.5.5.2.2" xref="A5.Ex19.m1.5.5.2.2.cmml">x</mi><mo id="A5.Ex19.m1.5.5.2.6.2.2" stretchy="false" xref="A5.Ex19.m1.5.5.2.cmml">)</mo></mrow></mrow><mrow id="A5.Ex19.m1.8.8.5.3" xref="A5.Ex19.m1.8.8.5.4.cmml"><mo id="A5.Ex19.m1.8.8.5.3.2" rspace="0.170em" stretchy="false" xref="A5.Ex19.m1.8.8.5.4.1.cmml">‖</mo><mrow id="A5.Ex19.m1.8.8.5.3.1" xref="A5.Ex19.m1.8.8.5.3.1.cmml"><msubsup id="A5.Ex19.m1.8.8.5.3.1.2" xref="A5.Ex19.m1.8.8.5.3.1.2.cmml"><mi id="A5.Ex19.m1.8.8.5.3.1.2.2.2" xref="A5.Ex19.m1.8.8.5.3.1.2.2.2.cmml">w</mi><mi id="A5.Ex19.m1.8.8.5.3.1.2.2.3" mathvariant="normal" xref="A5.Ex19.m1.8.8.5.3.1.2.2.3.cmml">l</mi><mrow id="A5.Ex19.m1.6.6.3.1.1.3" xref="A5.Ex19.m1.8.8.5.3.1.2.cmml"><mo id="A5.Ex19.m1.6.6.3.1.1.3.1" stretchy="false" xref="A5.Ex19.m1.8.8.5.3.1.2.cmml">(</mo><mi id="A5.Ex19.m1.6.6.3.1.1.1" xref="A5.Ex19.m1.6.6.3.1.1.1.cmml">i</mi><mo id="A5.Ex19.m1.6.6.3.1.1.3.2" stretchy="false" xref="A5.Ex19.m1.8.8.5.3.1.2.cmml">)</mo></mrow></msubsup><mo id="A5.Ex19.m1.8.8.5.3.1.1" xref="A5.Ex19.m1.8.8.5.3.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A5.Ex19.m1.8.8.5.3.1.3" xref="A5.Ex19.m1.8.8.5.3.1.3.cmml">ℐ</mi><mo id="A5.Ex19.m1.8.8.5.3.1.1a" xref="A5.Ex19.m1.8.8.5.3.1.1.cmml">⁢</mo><mrow id="A5.Ex19.m1.8.8.5.3.1.4.2" xref="A5.Ex19.m1.8.8.5.3.1.cmml"><mo id="A5.Ex19.m1.8.8.5.3.1.4.2.1" stretchy="false" xref="A5.Ex19.m1.8.8.5.3.1.cmml">(</mo><mi id="A5.Ex19.m1.7.7.4.2" xref="A5.Ex19.m1.7.7.4.2.cmml">x</mi><mo id="A5.Ex19.m1.8.8.5.3.1.4.2.2" stretchy="false" xref="A5.Ex19.m1.8.8.5.3.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex19.m1.8.8.5.3.3" stretchy="false" xref="A5.Ex19.m1.8.8.5.4.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.2.2.2" maxsize="160%" minsize="160%" xref="A5.Ex19.m1.8.8.cmml">)</mo></mrow><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.3" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup></mrow><mo id="A5.Ex19.m1.9.9.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A5.Ex19.m1.9.9.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.Ex19.m1.9.9.1.2" lspace="0em" xref="A5.Ex19.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex19.m1.9b"><apply id="A5.Ex19.m1.9.9.1.1.cmml" xref="A5.Ex19.m1.9.9.1"><eq id="A5.Ex19.m1.9.9.1.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.2"></eq><apply id="A5.Ex19.m1.9.9.1.1.3.cmml" xref="A5.Ex19.m1.9.9.1.1.3"><apply id="A5.Ex19.m1.9.9.1.1.3.1.cmml" xref="A5.Ex19.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="A5.Ex19.m1.9.9.1.1.3.1.1.cmml" xref="A5.Ex19.m1.9.9.1.1.3.1">subscript</csymbol><ci id="A5.Ex19.m1.9.9.1.1.3.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.3.1.2">∇</ci><apply id="A5.Ex19.m1.1.1.1.cmml" xref="A5.Ex19.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex19.m1.1.1.1.2.cmml" xref="A5.Ex19.m1.1.1.1">superscript</csymbol><apply id="A5.Ex19.m1.1.1.1.3.cmml" xref="A5.Ex19.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex19.m1.1.1.1.3.1.cmml" xref="A5.Ex19.m1.1.1.1">subscript</csymbol><ci id="A5.Ex19.m1.1.1.1.3.2.cmml" xref="A5.Ex19.m1.1.1.1.3.2">𝑤</ci><ci id="A5.Ex19.m1.1.1.1.3.3.cmml" xref="A5.Ex19.m1.1.1.1.3.3">g</ci></apply><ci id="A5.Ex19.m1.1.1.1.1.1.1.cmml" xref="A5.Ex19.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex19.m1.9.9.1.1.3.2.cmml" xref="A5.Ex19.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex19.m1.9.9.1.1.3.2.1.cmml" xref="A5.Ex19.m1.9.9.1.1.3.2">superscript</csymbol><ci id="A5.Ex19.m1.9.9.1.1.3.2.2.cmml" xref="A5.Ex19.m1.9.9.1.1.3.2.2">ℓ</ci><ci id="A5.Ex19.m1.2.2.1.1.cmml" xref="A5.Ex19.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.Ex19.m1.9.9.1.1.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1"><times id="A5.Ex19.m1.9.9.1.1.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.2"></times><ci id="A5.Ex19.m1.9.9.1.1.1.3.cmml" xref="A5.Ex19.m1.9.9.1.1.1.3">𝔼</ci><apply id="A5.Ex19.m1.9.9.1.1.1.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="A5.Ex19.m1.9.9.1.1.1.1.2.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A5.Ex19.m1.9.9.1.1.1.1.1.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1"><times id="A5.Ex19.m1.9.9.1.1.1.1.1.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.2"></times><ci id="A5.Ex19.m1.9.9.1.1.1.1.1.1.3.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.3">𝜏</ci><apply id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1"><minus id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3">𝑥</ci></apply><ci id="A5.Ex19.m1.3.3.1.1.cmml" xref="A5.Ex19.m1.3.3.1.1">𝑖</ci></apply><ci id="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.1.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4">superscript</csymbol><apply id="A5.Ex19.m1.8.8.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.2.2"><divide id="A5.Ex19.m1.8.8.6.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.2.2"></divide><apply id="A5.Ex19.m1.5.5.2.cmml" xref="A5.Ex19.m1.5.5.2"><times id="A5.Ex19.m1.5.5.2.3.cmml" xref="A5.Ex19.m1.5.5.2.3"></times><apply id="A5.Ex19.m1.5.5.2.4.cmml" xref="A5.Ex19.m1.5.5.2.4"><csymbol cd="ambiguous" id="A5.Ex19.m1.5.5.2.4.1.cmml" xref="A5.Ex19.m1.5.5.2.4">superscript</csymbol><apply id="A5.Ex19.m1.5.5.2.4.2.cmml" xref="A5.Ex19.m1.5.5.2.4"><csymbol cd="ambiguous" id="A5.Ex19.m1.5.5.2.4.2.1.cmml" xref="A5.Ex19.m1.5.5.2.4">subscript</csymbol><ci id="A5.Ex19.m1.5.5.2.4.2.2.cmml" xref="A5.Ex19.m1.5.5.2.4.2.2">𝑤</ci><ci id="A5.Ex19.m1.5.5.2.4.2.3.cmml" xref="A5.Ex19.m1.5.5.2.4.2.3">l</ci></apply><ci id="A5.Ex19.m1.4.4.1.1.1.1.cmml" xref="A5.Ex19.m1.4.4.1.1.1.1">𝑖</ci></apply><ci id="A5.Ex19.m1.5.5.2.5.cmml" xref="A5.Ex19.m1.5.5.2.5">ℐ</ci><ci id="A5.Ex19.m1.5.5.2.2.cmml" xref="A5.Ex19.m1.5.5.2.2">𝑥</ci></apply><apply id="A5.Ex19.m1.8.8.5.4.cmml" xref="A5.Ex19.m1.8.8.5.3"><csymbol cd="latexml" id="A5.Ex19.m1.8.8.5.4.1.cmml" xref="A5.Ex19.m1.8.8.5.3.2">norm</csymbol><apply id="A5.Ex19.m1.8.8.5.3.1.cmml" xref="A5.Ex19.m1.8.8.5.3.1"><times id="A5.Ex19.m1.8.8.5.3.1.1.cmml" xref="A5.Ex19.m1.8.8.5.3.1.1"></times><apply id="A5.Ex19.m1.8.8.5.3.1.2.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex19.m1.8.8.5.3.1.2.1.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2">superscript</csymbol><apply id="A5.Ex19.m1.8.8.5.3.1.2.2.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2"><csymbol cd="ambiguous" id="A5.Ex19.m1.8.8.5.3.1.2.2.1.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2">subscript</csymbol><ci id="A5.Ex19.m1.8.8.5.3.1.2.2.2.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2.2.2">𝑤</ci><ci id="A5.Ex19.m1.8.8.5.3.1.2.2.3.cmml" xref="A5.Ex19.m1.8.8.5.3.1.2.2.3">l</ci></apply><ci id="A5.Ex19.m1.6.6.3.1.1.1.cmml" xref="A5.Ex19.m1.6.6.3.1.1.1">𝑖</ci></apply><ci id="A5.Ex19.m1.8.8.5.3.1.3.cmml" xref="A5.Ex19.m1.8.8.5.3.1.3">ℐ</ci><ci id="A5.Ex19.m1.7.7.4.2.cmml" xref="A5.Ex19.m1.7.7.4.2">𝑥</ci></apply></apply></apply><csymbol cd="latexml" id="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.3.cmml" xref="A5.Ex19.m1.9.9.1.1.1.1.1.1.4.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex19.m1.9c">\nabla_{w_{\mathrm{g}}^{(i)}}\,\ell^{(i)}\;=\;\mathbb{E}\Bigl{[}\tau\,\bigl{(}%
r_{x}^{(i)}-y\bigr{)}\,\Bigl{(}\tfrac{\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\,%
}{\|\,w_{\mathrm{l}}^{(i)}\,\mathcal{I}(x)\|\,}\Bigr{)}^{\top}\Bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex19.m1.9d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = blackboard_E [ italic_τ ( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_y ) ( divide start_ARG italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) end_ARG start_ARG ∥ italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_I ( italic_x ) ∥ end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS3.SSS1.p1.1">Since <math alttext="w_{\mathrm{g}}^{(i)}=\mathcal{T}_{\phi}\bigl{(}\mathbf{p}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="A5.SS3.SSS1.p1.1.m1.3"><semantics id="A5.SS3.SSS1.p1.1.m1.3a"><mrow id="A5.SS3.SSS1.p1.1.m1.3.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.cmml"><msubsup id="A5.SS3.SSS1.p1.1.m1.3.3.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.cmml"><mi id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.2" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.2.2.cmml">w</mi><mi id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.3" mathvariant="normal" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.2.3.cmml">g</mi><mrow id="A5.SS3.SSS1.p1.1.m1.1.1.1.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.cmml"><mo id="A5.SS3.SSS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.cmml">(</mo><mi id="A5.SS3.SSS1.p1.1.m1.1.1.1.1" xref="A5.SS3.SSS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.cmml">)</mo></mrow></msubsup><mo id="A5.SS3.SSS1.p1.1.m1.3.3.2" xref="A5.SS3.SSS1.p1.1.m1.3.3.2.cmml">=</mo><mrow id="A5.SS3.SSS1.p1.1.m1.3.3.1" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.cmml"><msub id="A5.SS3.SSS1.p1.1.m1.3.3.1.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.2" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3.3.cmml">ϕ</mi></msub><mo id="A5.SS3.SSS1.p1.1.m1.3.3.1.2" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml"><mo id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.2" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS1.p1.1.m1.2.2.1.3" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml"><mo id="A5.SS3.SSS1.p1.1.m1.2.2.1.3.1" stretchy="false" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS1.p1.1.m1.2.2.1.1" xref="A5.SS3.SSS1.p1.1.m1.2.2.1.1.cmml">i</mi><mo id="A5.SS3.SSS1.p1.1.m1.2.2.1.3.2" stretchy="false" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS1.p1.1.m1.3b"><apply id="A5.SS3.SSS1.p1.1.m1.3.3.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3"><eq id="A5.SS3.SSS1.p1.1.m1.3.3.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.2"></eq><apply id="A5.SS3.SSS1.p1.1.m1.3.3.3.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.1.m1.3.3.3.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3">superscript</csymbol><apply id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3">subscript</csymbol><ci id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.2.2">𝑤</ci><ci id="A5.SS3.SSS1.p1.1.m1.3.3.3.2.3.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.3.2.3">g</ci></apply><ci id="A5.SS3.SSS1.p1.1.m1.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="A5.SS3.SSS1.p1.1.m1.3.3.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1"><times id="A5.SS3.SSS1.p1.1.m1.3.3.1.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.2"></times><apply id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3">subscript</csymbol><ci id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3.2">𝒯</ci><ci id="A5.SS3.SSS1.p1.1.m1.3.3.1.3.3.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.3.3">italic-ϕ</ci></apply><apply id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1">superscript</csymbol><ci id="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="A5.SS3.SSS1.p1.1.m1.3.3.1.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS1.p1.1.m1.2.2.1.1.cmml" xref="A5.SS3.SSS1.p1.1.m1.2.2.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS1.p1.1.m1.3c">w_{\mathrm{g}}^{(i)}=\mathcal{T}_{\phi}\bigl{(}\mathbf{p}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS1.p1.1.m1.3d">italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>, a standard chain rule yields</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\mathbf{p}^{(i)}}\,\ell^{(i)}\;=\;\Bigl{(}\tfrac{\partial w_{\mathrm{g%
}}^{(i)}}{\partial\mathbf{p}^{(i)}}\Bigr{)}^{\!\top}\,\nabla_{w_{\mathrm{g}}^{%
(i)}}\,\ell^{(i)}\;=\;J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}%
^{\top}\,\nabla_{w_{\mathrm{g}}^{(i)}}\,\ell^{(i)}," class="ltx_Math" display="block" id="A5.E4.m1.10"><semantics id="A5.E4.m1.10a"><mrow id="A5.E4.m1.10.10.1" xref="A5.E4.m1.10.10.1.1.cmml"><mrow id="A5.E4.m1.10.10.1.1" xref="A5.E4.m1.10.10.1.1.cmml"><mrow id="A5.E4.m1.10.10.1.1.3" xref="A5.E4.m1.10.10.1.1.3.cmml"><msub id="A5.E4.m1.10.10.1.1.3.1" xref="A5.E4.m1.10.10.1.1.3.1.cmml"><mo id="A5.E4.m1.10.10.1.1.3.1.2" xref="A5.E4.m1.10.10.1.1.3.1.2.cmml">∇</mo><msup id="A5.E4.m1.1.1.1" xref="A5.E4.m1.1.1.1.cmml"><mi id="A5.E4.m1.1.1.1.3" xref="A5.E4.m1.1.1.1.3.cmml">𝐩</mi><mrow id="A5.E4.m1.1.1.1.1.1.3" xref="A5.E4.m1.1.1.1.cmml"><mo id="A5.E4.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.E4.m1.1.1.1.cmml">(</mo><mi id="A5.E4.m1.1.1.1.1.1.1" xref="A5.E4.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.E4.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.E4.m1.1.1.1.cmml">)</mo></mrow></msup></msub><msup id="A5.E4.m1.10.10.1.1.3.2" xref="A5.E4.m1.10.10.1.1.3.2.cmml"><mi id="A5.E4.m1.10.10.1.1.3.2.2" mathvariant="normal" xref="A5.E4.m1.10.10.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E4.m1.2.2.1.3" xref="A5.E4.m1.10.10.1.1.3.2.cmml"><mo id="A5.E4.m1.2.2.1.3.1" stretchy="false" xref="A5.E4.m1.10.10.1.1.3.2.cmml">(</mo><mi id="A5.E4.m1.2.2.1.1" xref="A5.E4.m1.2.2.1.1.cmml">i</mi><mo id="A5.E4.m1.2.2.1.3.2" stretchy="false" xref="A5.E4.m1.10.10.1.1.3.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.E4.m1.10.10.1.1.4" rspace="0.558em" xref="A5.E4.m1.10.10.1.1.4.cmml">=</mo><mrow id="A5.E4.m1.10.10.1.1.5" xref="A5.E4.m1.10.10.1.1.5.cmml"><msup id="A5.E4.m1.10.10.1.1.5.2" xref="A5.E4.m1.10.10.1.1.5.2.cmml"><mrow id="A5.E4.m1.10.10.1.1.5.2.2.2" xref="A5.E4.m1.4.4.cmml"><mo id="A5.E4.m1.10.10.1.1.5.2.2.2.1" maxsize="160%" minsize="160%" xref="A5.E4.m1.4.4.cmml">(</mo><mstyle displaystyle="false" id="A5.E4.m1.4.4" xref="A5.E4.m1.4.4.cmml"><mfrac id="A5.E4.m1.4.4a" xref="A5.E4.m1.4.4.cmml"><mrow id="A5.E4.m1.3.3.1" xref="A5.E4.m1.3.3.1.cmml"><mo id="A5.E4.m1.3.3.1.2" rspace="0em" xref="A5.E4.m1.3.3.1.2.cmml">∂</mo><msubsup id="A5.E4.m1.3.3.1.3" xref="A5.E4.m1.3.3.1.3.cmml"><mi id="A5.E4.m1.3.3.1.3.2.2" xref="A5.E4.m1.3.3.1.3.2.2.cmml">w</mi><mi id="A5.E4.m1.3.3.1.3.2.3" mathvariant="normal" xref="A5.E4.m1.3.3.1.3.2.3.cmml">g</mi><mrow id="A5.E4.m1.3.3.1.1.1.3" xref="A5.E4.m1.3.3.1.3.cmml"><mo id="A5.E4.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.E4.m1.3.3.1.3.cmml">(</mo><mi id="A5.E4.m1.3.3.1.1.1.1" xref="A5.E4.m1.3.3.1.1.1.1.cmml">i</mi><mo id="A5.E4.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.E4.m1.3.3.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="A5.E4.m1.4.4.2" xref="A5.E4.m1.4.4.2.cmml"><mo id="A5.E4.m1.4.4.2.2" rspace="0em" xref="A5.E4.m1.4.4.2.2.cmml">∂</mo><msup id="A5.E4.m1.4.4.2.3" xref="A5.E4.m1.4.4.2.3.cmml"><mi id="A5.E4.m1.4.4.2.3.2" xref="A5.E4.m1.4.4.2.3.2.cmml">𝐩</mi><mrow id="A5.E4.m1.4.4.2.1.1.3" xref="A5.E4.m1.4.4.2.3.cmml"><mo id="A5.E4.m1.4.4.2.1.1.3.1" stretchy="false" xref="A5.E4.m1.4.4.2.3.cmml">(</mo><mi id="A5.E4.m1.4.4.2.1.1.1" xref="A5.E4.m1.4.4.2.1.1.1.cmml">i</mi><mo id="A5.E4.m1.4.4.2.1.1.3.2" stretchy="false" xref="A5.E4.m1.4.4.2.3.cmml">)</mo></mrow></msup></mrow></mfrac></mstyle><mo id="A5.E4.m1.10.10.1.1.5.2.2.2.2" maxsize="160%" minsize="160%" xref="A5.E4.m1.4.4.cmml">)</mo></mrow><mo id="A5.E4.m1.10.10.1.1.5.2.3" xref="A5.E4.m1.10.10.1.1.5.2.3.cmml">⊤</mo></msup><mo id="A5.E4.m1.10.10.1.1.5.1" lspace="0.167em" xref="A5.E4.m1.10.10.1.1.5.1.cmml">⁢</mo><mrow id="A5.E4.m1.10.10.1.1.5.3" xref="A5.E4.m1.10.10.1.1.5.3.cmml"><msub id="A5.E4.m1.10.10.1.1.5.3.1" xref="A5.E4.m1.10.10.1.1.5.3.1.cmml"><mo id="A5.E4.m1.10.10.1.1.5.3.1.2" rspace="0.167em" xref="A5.E4.m1.10.10.1.1.5.3.1.2.cmml">∇</mo><msubsup id="A5.E4.m1.5.5.1" xref="A5.E4.m1.5.5.1.cmml"><mi id="A5.E4.m1.5.5.1.3.2" xref="A5.E4.m1.5.5.1.3.2.cmml">w</mi><mi id="A5.E4.m1.5.5.1.3.3" mathvariant="normal" xref="A5.E4.m1.5.5.1.3.3.cmml">g</mi><mrow id="A5.E4.m1.5.5.1.1.1.3" xref="A5.E4.m1.5.5.1.cmml"><mo id="A5.E4.m1.5.5.1.1.1.3.1" stretchy="false" xref="A5.E4.m1.5.5.1.cmml">(</mo><mi id="A5.E4.m1.5.5.1.1.1.1" xref="A5.E4.m1.5.5.1.1.1.1.cmml">i</mi><mo id="A5.E4.m1.5.5.1.1.1.3.2" stretchy="false" xref="A5.E4.m1.5.5.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E4.m1.10.10.1.1.5.3.2" xref="A5.E4.m1.10.10.1.1.5.3.2.cmml"><mi id="A5.E4.m1.10.10.1.1.5.3.2.2" mathvariant="normal" xref="A5.E4.m1.10.10.1.1.5.3.2.2.cmml">ℓ</mi><mrow id="A5.E4.m1.6.6.1.3" xref="A5.E4.m1.10.10.1.1.5.3.2.cmml"><mo id="A5.E4.m1.6.6.1.3.1" stretchy="false" xref="A5.E4.m1.10.10.1.1.5.3.2.cmml">(</mo><mi id="A5.E4.m1.6.6.1.1" xref="A5.E4.m1.6.6.1.1.cmml">i</mi><mo id="A5.E4.m1.6.6.1.3.2" stretchy="false" xref="A5.E4.m1.10.10.1.1.5.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo id="A5.E4.m1.10.10.1.1.6" rspace="0.558em" xref="A5.E4.m1.10.10.1.1.6.cmml">=</mo><mrow id="A5.E4.m1.10.10.1.1.1" xref="A5.E4.m1.10.10.1.1.1.cmml"><msub id="A5.E4.m1.10.10.1.1.1.3" xref="A5.E4.m1.10.10.1.1.1.3.cmml"><mi id="A5.E4.m1.10.10.1.1.1.3.2" xref="A5.E4.m1.10.10.1.1.1.3.2.cmml">J</mi><msub id="A5.E4.m1.10.10.1.1.1.3.3" xref="A5.E4.m1.10.10.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E4.m1.10.10.1.1.1.3.3.2" xref="A5.E4.m1.10.10.1.1.1.3.3.2.cmml">𝒯</mi><mi id="A5.E4.m1.10.10.1.1.1.3.3.3" xref="A5.E4.m1.10.10.1.1.1.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E4.m1.10.10.1.1.1.2" xref="A5.E4.m1.10.10.1.1.1.2.cmml">⁢</mo><msup id="A5.E4.m1.10.10.1.1.1.1" xref="A5.E4.m1.10.10.1.1.1.1.cmml"><mrow id="A5.E4.m1.10.10.1.1.1.1.1.1" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml"><mo id="A5.E4.m1.10.10.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml">(</mo><msup id="A5.E4.m1.10.10.1.1.1.1.1.1.1" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml"><mi id="A5.E4.m1.10.10.1.1.1.1.1.1.1.2" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E4.m1.7.7.1.3" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml"><mo id="A5.E4.m1.7.7.1.3.1" stretchy="false" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.E4.m1.7.7.1.1" xref="A5.E4.m1.7.7.1.1.cmml">i</mi><mo id="A5.E4.m1.7.7.1.3.2" stretchy="false" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E4.m1.10.10.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E4.m1.10.10.1.1.1.1.3" xref="A5.E4.m1.10.10.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A5.E4.m1.10.10.1.1.1.2a" lspace="0.167em" xref="A5.E4.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="A5.E4.m1.10.10.1.1.1.4" xref="A5.E4.m1.10.10.1.1.1.4.cmml"><msub id="A5.E4.m1.10.10.1.1.1.4.1" xref="A5.E4.m1.10.10.1.1.1.4.1.cmml"><mo id="A5.E4.m1.10.10.1.1.1.4.1.2" rspace="0.167em" xref="A5.E4.m1.10.10.1.1.1.4.1.2.cmml">∇</mo><msubsup id="A5.E4.m1.8.8.1" xref="A5.E4.m1.8.8.1.cmml"><mi id="A5.E4.m1.8.8.1.3.2" xref="A5.E4.m1.8.8.1.3.2.cmml">w</mi><mi id="A5.E4.m1.8.8.1.3.3" mathvariant="normal" xref="A5.E4.m1.8.8.1.3.3.cmml">g</mi><mrow id="A5.E4.m1.8.8.1.1.1.3" xref="A5.E4.m1.8.8.1.cmml"><mo id="A5.E4.m1.8.8.1.1.1.3.1" stretchy="false" xref="A5.E4.m1.8.8.1.cmml">(</mo><mi id="A5.E4.m1.8.8.1.1.1.1" xref="A5.E4.m1.8.8.1.1.1.1.cmml">i</mi><mo id="A5.E4.m1.8.8.1.1.1.3.2" stretchy="false" xref="A5.E4.m1.8.8.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E4.m1.10.10.1.1.1.4.2" xref="A5.E4.m1.10.10.1.1.1.4.2.cmml"><mi id="A5.E4.m1.10.10.1.1.1.4.2.2" mathvariant="normal" xref="A5.E4.m1.10.10.1.1.1.4.2.2.cmml">ℓ</mi><mrow id="A5.E4.m1.9.9.1.3" xref="A5.E4.m1.10.10.1.1.1.4.2.cmml"><mo id="A5.E4.m1.9.9.1.3.1" stretchy="false" xref="A5.E4.m1.10.10.1.1.1.4.2.cmml">(</mo><mi id="A5.E4.m1.9.9.1.1" xref="A5.E4.m1.9.9.1.1.cmml">i</mi><mo id="A5.E4.m1.9.9.1.3.2" stretchy="false" xref="A5.E4.m1.10.10.1.1.1.4.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><mo id="A5.E4.m1.10.10.1.2" xref="A5.E4.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E4.m1.10b"><apply id="A5.E4.m1.10.10.1.1.cmml" xref="A5.E4.m1.10.10.1"><and id="A5.E4.m1.10.10.1.1a.cmml" xref="A5.E4.m1.10.10.1"></and><apply id="A5.E4.m1.10.10.1.1b.cmml" xref="A5.E4.m1.10.10.1"><eq id="A5.E4.m1.10.10.1.1.4.cmml" xref="A5.E4.m1.10.10.1.1.4"></eq><apply id="A5.E4.m1.10.10.1.1.3.cmml" xref="A5.E4.m1.10.10.1.1.3"><apply id="A5.E4.m1.10.10.1.1.3.1.cmml" xref="A5.E4.m1.10.10.1.1.3.1"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.3.1.1.cmml" xref="A5.E4.m1.10.10.1.1.3.1">subscript</csymbol><ci id="A5.E4.m1.10.10.1.1.3.1.2.cmml" xref="A5.E4.m1.10.10.1.1.3.1.2">∇</ci><apply id="A5.E4.m1.1.1.1.cmml" xref="A5.E4.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E4.m1.1.1.1.2.cmml" xref="A5.E4.m1.1.1.1">superscript</csymbol><ci id="A5.E4.m1.1.1.1.3.cmml" xref="A5.E4.m1.1.1.1.3">𝐩</ci><ci id="A5.E4.m1.1.1.1.1.1.1.cmml" xref="A5.E4.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E4.m1.10.10.1.1.3.2.cmml" xref="A5.E4.m1.10.10.1.1.3.2"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.3.2.1.cmml" xref="A5.E4.m1.10.10.1.1.3.2">superscript</csymbol><ci id="A5.E4.m1.10.10.1.1.3.2.2.cmml" xref="A5.E4.m1.10.10.1.1.3.2.2">ℓ</ci><ci id="A5.E4.m1.2.2.1.1.cmml" xref="A5.E4.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.E4.m1.10.10.1.1.5.cmml" xref="A5.E4.m1.10.10.1.1.5"><times id="A5.E4.m1.10.10.1.1.5.1.cmml" xref="A5.E4.m1.10.10.1.1.5.1"></times><apply id="A5.E4.m1.10.10.1.1.5.2.cmml" xref="A5.E4.m1.10.10.1.1.5.2"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.5.2.1.cmml" xref="A5.E4.m1.10.10.1.1.5.2">superscript</csymbol><apply id="A5.E4.m1.4.4.cmml" xref="A5.E4.m1.10.10.1.1.5.2.2.2"><divide id="A5.E4.m1.4.4.3.cmml" xref="A5.E4.m1.10.10.1.1.5.2.2.2"></divide><apply id="A5.E4.m1.3.3.1.cmml" xref="A5.E4.m1.3.3.1"><partialdiff id="A5.E4.m1.3.3.1.2.cmml" xref="A5.E4.m1.3.3.1.2"></partialdiff><apply id="A5.E4.m1.3.3.1.3.cmml" xref="A5.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="A5.E4.m1.3.3.1.3.1.cmml" xref="A5.E4.m1.3.3.1.3">superscript</csymbol><apply id="A5.E4.m1.3.3.1.3.2.cmml" xref="A5.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="A5.E4.m1.3.3.1.3.2.1.cmml" xref="A5.E4.m1.3.3.1.3">subscript</csymbol><ci id="A5.E4.m1.3.3.1.3.2.2.cmml" xref="A5.E4.m1.3.3.1.3.2.2">𝑤</ci><ci id="A5.E4.m1.3.3.1.3.2.3.cmml" xref="A5.E4.m1.3.3.1.3.2.3">g</ci></apply><ci id="A5.E4.m1.3.3.1.1.1.1.cmml" xref="A5.E4.m1.3.3.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E4.m1.4.4.2.cmml" xref="A5.E4.m1.4.4.2"><partialdiff id="A5.E4.m1.4.4.2.2.cmml" xref="A5.E4.m1.4.4.2.2"></partialdiff><apply id="A5.E4.m1.4.4.2.3.cmml" xref="A5.E4.m1.4.4.2.3"><csymbol cd="ambiguous" id="A5.E4.m1.4.4.2.3.1.cmml" xref="A5.E4.m1.4.4.2.3">superscript</csymbol><ci id="A5.E4.m1.4.4.2.3.2.cmml" xref="A5.E4.m1.4.4.2.3.2">𝐩</ci><ci id="A5.E4.m1.4.4.2.1.1.1.cmml" xref="A5.E4.m1.4.4.2.1.1.1">𝑖</ci></apply></apply></apply><csymbol cd="latexml" id="A5.E4.m1.10.10.1.1.5.2.3.cmml" xref="A5.E4.m1.10.10.1.1.5.2.3">top</csymbol></apply><apply id="A5.E4.m1.10.10.1.1.5.3.cmml" xref="A5.E4.m1.10.10.1.1.5.3"><apply id="A5.E4.m1.10.10.1.1.5.3.1.cmml" xref="A5.E4.m1.10.10.1.1.5.3.1"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.5.3.1.1.cmml" xref="A5.E4.m1.10.10.1.1.5.3.1">subscript</csymbol><ci id="A5.E4.m1.10.10.1.1.5.3.1.2.cmml" xref="A5.E4.m1.10.10.1.1.5.3.1.2">∇</ci><apply id="A5.E4.m1.5.5.1.cmml" xref="A5.E4.m1.5.5.1"><csymbol cd="ambiguous" id="A5.E4.m1.5.5.1.2.cmml" xref="A5.E4.m1.5.5.1">superscript</csymbol><apply id="A5.E4.m1.5.5.1.3.cmml" xref="A5.E4.m1.5.5.1"><csymbol cd="ambiguous" id="A5.E4.m1.5.5.1.3.1.cmml" xref="A5.E4.m1.5.5.1">subscript</csymbol><ci id="A5.E4.m1.5.5.1.3.2.cmml" xref="A5.E4.m1.5.5.1.3.2">𝑤</ci><ci id="A5.E4.m1.5.5.1.3.3.cmml" xref="A5.E4.m1.5.5.1.3.3">g</ci></apply><ci id="A5.E4.m1.5.5.1.1.1.1.cmml" xref="A5.E4.m1.5.5.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E4.m1.10.10.1.1.5.3.2.cmml" xref="A5.E4.m1.10.10.1.1.5.3.2"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.5.3.2.1.cmml" xref="A5.E4.m1.10.10.1.1.5.3.2">superscript</csymbol><ci id="A5.E4.m1.10.10.1.1.5.3.2.2.cmml" xref="A5.E4.m1.10.10.1.1.5.3.2.2">ℓ</ci><ci id="A5.E4.m1.6.6.1.1.cmml" xref="A5.E4.m1.6.6.1.1">𝑖</ci></apply></apply></apply></apply><apply id="A5.E4.m1.10.10.1.1c.cmml" xref="A5.E4.m1.10.10.1"><eq id="A5.E4.m1.10.10.1.1.6.cmml" xref="A5.E4.m1.10.10.1.1.6"></eq><share href="https://arxiv.org/html/2505.19888v1#A5.E4.m1.10.10.1.1.5.cmml" id="A5.E4.m1.10.10.1.1d.cmml" xref="A5.E4.m1.10.10.1"></share><apply id="A5.E4.m1.10.10.1.1.1.cmml" xref="A5.E4.m1.10.10.1.1.1"><times id="A5.E4.m1.10.10.1.1.1.2.cmml" xref="A5.E4.m1.10.10.1.1.1.2"></times><apply id="A5.E4.m1.10.10.1.1.1.3.cmml" xref="A5.E4.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.3.1.cmml" xref="A5.E4.m1.10.10.1.1.1.3">subscript</csymbol><ci id="A5.E4.m1.10.10.1.1.1.3.2.cmml" xref="A5.E4.m1.10.10.1.1.1.3.2">𝐽</ci><apply id="A5.E4.m1.10.10.1.1.1.3.3.cmml" xref="A5.E4.m1.10.10.1.1.1.3.3"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.3.3.1.cmml" xref="A5.E4.m1.10.10.1.1.1.3.3">subscript</csymbol><ci id="A5.E4.m1.10.10.1.1.1.3.3.2.cmml" xref="A5.E4.m1.10.10.1.1.1.3.3.2">𝒯</ci><ci id="A5.E4.m1.10.10.1.1.1.3.3.3.cmml" xref="A5.E4.m1.10.10.1.1.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E4.m1.10.10.1.1.1.1.cmml" xref="A5.E4.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.1.2.cmml" xref="A5.E4.m1.10.10.1.1.1.1">superscript</csymbol><apply id="A5.E4.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A5.E4.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="A5.E4.m1.10.10.1.1.1.1.1.1">superscript</csymbol><ci id="A5.E4.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="A5.E4.m1.10.10.1.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.E4.m1.7.7.1.1.cmml" xref="A5.E4.m1.7.7.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A5.E4.m1.10.10.1.1.1.1.3.cmml" xref="A5.E4.m1.10.10.1.1.1.1.3">top</csymbol></apply><apply id="A5.E4.m1.10.10.1.1.1.4.cmml" xref="A5.E4.m1.10.10.1.1.1.4"><apply id="A5.E4.m1.10.10.1.1.1.4.1.cmml" xref="A5.E4.m1.10.10.1.1.1.4.1"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.4.1.1.cmml" xref="A5.E4.m1.10.10.1.1.1.4.1">subscript</csymbol><ci id="A5.E4.m1.10.10.1.1.1.4.1.2.cmml" xref="A5.E4.m1.10.10.1.1.1.4.1.2">∇</ci><apply id="A5.E4.m1.8.8.1.cmml" xref="A5.E4.m1.8.8.1"><csymbol cd="ambiguous" id="A5.E4.m1.8.8.1.2.cmml" xref="A5.E4.m1.8.8.1">superscript</csymbol><apply id="A5.E4.m1.8.8.1.3.cmml" xref="A5.E4.m1.8.8.1"><csymbol cd="ambiguous" id="A5.E4.m1.8.8.1.3.1.cmml" xref="A5.E4.m1.8.8.1">subscript</csymbol><ci id="A5.E4.m1.8.8.1.3.2.cmml" xref="A5.E4.m1.8.8.1.3.2">𝑤</ci><ci id="A5.E4.m1.8.8.1.3.3.cmml" xref="A5.E4.m1.8.8.1.3.3">g</ci></apply><ci id="A5.E4.m1.8.8.1.1.1.1.cmml" xref="A5.E4.m1.8.8.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E4.m1.10.10.1.1.1.4.2.cmml" xref="A5.E4.m1.10.10.1.1.1.4.2"><csymbol cd="ambiguous" id="A5.E4.m1.10.10.1.1.1.4.2.1.cmml" xref="A5.E4.m1.10.10.1.1.1.4.2">superscript</csymbol><ci id="A5.E4.m1.10.10.1.1.1.4.2.2.cmml" xref="A5.E4.m1.10.10.1.1.1.4.2.2">ℓ</ci><ci id="A5.E4.m1.9.9.1.1.cmml" xref="A5.E4.m1.9.9.1.1">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E4.m1.10c">\nabla_{\mathbf{p}^{(i)}}\,\ell^{(i)}\;=\;\Bigl{(}\tfrac{\partial w_{\mathrm{g%
}}^{(i)}}{\partial\mathbf{p}^{(i)}}\Bigr{)}^{\!\top}\,\nabla_{w_{\mathrm{g}}^{%
(i)}}\,\ell^{(i)}\;=\;J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}%
^{\top}\,\nabla_{w_{\mathrm{g}}^{(i)}}\,\ell^{(i)},</annotation><annotation encoding="application/x-llamapun" id="A5.E4.m1.10d">∇ start_POSTSUBSCRIPT bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = ( divide start_ARG ∂ italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS3.SSS1.p1.4">where <math alttext="J_{\mathcal{T}_{\phi}}\bigl{(}\mathbf{p}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="A5.SS3.SSS1.p1.2.m1.2"><semantics id="A5.SS3.SSS1.p1.2.m1.2a"><mrow id="A5.SS3.SSS1.p1.2.m1.2.2" xref="A5.SS3.SSS1.p1.2.m1.2.2.cmml"><msub id="A5.SS3.SSS1.p1.2.m1.2.2.3" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.cmml"><mi id="A5.SS3.SSS1.p1.2.m1.2.2.3.2" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.2.cmml">J</mi><msub id="A5.SS3.SSS1.p1.2.m1.2.2.3.3" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.2" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.3" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.SS3.SSS1.p1.2.m1.2.2.2" xref="A5.SS3.SSS1.p1.2.m1.2.2.2.cmml">⁢</mo><mrow id="A5.SS3.SSS1.p1.2.m1.2.2.1.1" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml"><mi id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.2" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS1.p1.2.m1.1.1.1.3" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS1.p1.2.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS1.p1.2.m1.1.1.1.1" xref="A5.SS3.SSS1.p1.2.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS1.p1.2.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS1.p1.2.m1.2b"><apply id="A5.SS3.SSS1.p1.2.m1.2.2.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2"><times id="A5.SS3.SSS1.p1.2.m1.2.2.2.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.2"></times><apply id="A5.SS3.SSS1.p1.2.m1.2.2.3.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.2.m1.2.2.3.1.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3">subscript</csymbol><ci id="A5.SS3.SSS1.p1.2.m1.2.2.3.2.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.2">𝐽</ci><apply id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.1.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3">subscript</csymbol><ci id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.2.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3.2">𝒯</ci><ci id="A5.SS3.SSS1.p1.2.m1.2.2.3.3.3.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1">superscript</csymbol><ci id="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.2.cmml" xref="A5.SS3.SSS1.p1.2.m1.2.2.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS1.p1.2.m1.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.2.m1.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS1.p1.2.m1.2c">J_{\mathcal{T}_{\phi}}\bigl{(}\mathbf{p}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS1.p1.2.m1.2d">italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> is the Jacobian of <math alttext="\mathcal{T}_{\phi}" class="ltx_Math" display="inline" id="A5.SS3.SSS1.p1.3.m2.1"><semantics id="A5.SS3.SSS1.p1.3.m2.1a"><msub id="A5.SS3.SSS1.p1.3.m2.1.1" xref="A5.SS3.SSS1.p1.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS1.p1.3.m2.1.1.2" xref="A5.SS3.SSS1.p1.3.m2.1.1.2.cmml">𝒯</mi><mi id="A5.SS3.SSS1.p1.3.m2.1.1.3" xref="A5.SS3.SSS1.p1.3.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS1.p1.3.m2.1b"><apply id="A5.SS3.SSS1.p1.3.m2.1.1.cmml" xref="A5.SS3.SSS1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.3.m2.1.1.1.cmml" xref="A5.SS3.SSS1.p1.3.m2.1.1">subscript</csymbol><ci id="A5.SS3.SSS1.p1.3.m2.1.1.2.cmml" xref="A5.SS3.SSS1.p1.3.m2.1.1.2">𝒯</ci><ci id="A5.SS3.SSS1.p1.3.m2.1.1.3.cmml" xref="A5.SS3.SSS1.p1.3.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS1.p1.3.m2.1c">\mathcal{T}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS1.p1.3.m2.1d">caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> at <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.SSS1.p1.4.m3.1"><semantics id="A5.SS3.SSS1.p1.4.m3.1a"><msup id="A5.SS3.SSS1.p1.4.m3.1.2" xref="A5.SS3.SSS1.p1.4.m3.1.2.cmml"><mi id="A5.SS3.SSS1.p1.4.m3.1.2.2" xref="A5.SS3.SSS1.p1.4.m3.1.2.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS1.p1.4.m3.1.1.1.3" xref="A5.SS3.SSS1.p1.4.m3.1.2.cmml"><mo id="A5.SS3.SSS1.p1.4.m3.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS1.p1.4.m3.1.2.cmml">(</mo><mi id="A5.SS3.SSS1.p1.4.m3.1.1.1.1" xref="A5.SS3.SSS1.p1.4.m3.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS1.p1.4.m3.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS1.p1.4.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS1.p1.4.m3.1b"><apply id="A5.SS3.SSS1.p1.4.m3.1.2.cmml" xref="A5.SS3.SSS1.p1.4.m3.1.2"><csymbol cd="ambiguous" id="A5.SS3.SSS1.p1.4.m3.1.2.1.cmml" xref="A5.SS3.SSS1.p1.4.m3.1.2">superscript</csymbol><ci id="A5.SS3.SSS1.p1.4.m3.1.2.2.cmml" xref="A5.SS3.SSS1.p1.4.m3.1.2.2">𝐩</ci><ci id="A5.SS3.SSS1.p1.4.m3.1.1.1.1.cmml" xref="A5.SS3.SSS1.p1.4.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS1.p1.4.m3.1c">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS1.p1.4.m3.1d">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.3.2 </span>Bounding the Gradient Difference in <math alttext="\mathbf{p}^{(i)}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.1.m1.1"><semantics id="A5.SS3.SSS2.1.m1.1b"><msup id="A5.SS3.SSS2.1.m1.1.2" xref="A5.SS3.SSS2.1.m1.1.2.cmml"><mi id="A5.SS3.SSS2.1.m1.1.2.2" xref="A5.SS3.SSS2.1.m1.1.2.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.1.m1.1.1.1.3" xref="A5.SS3.SSS2.1.m1.1.2.cmml"><mo id="A5.SS3.SSS2.1.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.1.m1.1.2.cmml">(</mo><mi id="A5.SS3.SSS2.1.m1.1.1.1.1" xref="A5.SS3.SSS2.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.1.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.1.m1.1c"><apply id="A5.SS3.SSS2.1.m1.1.2.cmml" xref="A5.SS3.SSS2.1.m1.1.2"><csymbol cd="ambiguous" id="A5.SS3.SSS2.1.m1.1.2.1.cmml" xref="A5.SS3.SSS2.1.m1.1.2">superscript</csymbol><ci id="A5.SS3.SSS2.1.m1.1.2.2.cmml" xref="A5.SS3.SSS2.1.m1.1.2.2">𝐩</ci><ci id="A5.SS3.SSS2.1.m1.1.1.1.1.cmml" xref="A5.SS3.SSS2.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.1.m1.1d">\mathbf{p}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.1.m1.1e">bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>-Space</h4>
<div class="ltx_para" id="A5.SS3.SSS2.p1">
<p class="ltx_p" id="A5.SS3.SSS2.p1.2">Applying Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.E4" title="In E.3.1 Gradient via Chain Rule ‣ E.3 Generalizing to Prompt Learning with 𝐩^(𝑖) ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">4</span></a>) to clients <math alttext="i" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p1.1.m1.1"><semantics id="A5.SS3.SSS2.p1.1.m1.1a"><mi id="A5.SS3.SSS2.p1.1.m1.1.1" xref="A5.SS3.SSS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p1.1.m1.1b"><ci id="A5.SS3.SSS2.p1.1.m1.1.1.cmml" xref="A5.SS3.SSS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p1.1.m1.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p1.2.m2.1"><semantics id="A5.SS3.SSS2.p1.2.m2.1a"><mi id="A5.SS3.SSS2.p1.2.m2.1.1" xref="A5.SS3.SSS2.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p1.2.m2.1b"><ci id="A5.SS3.SSS2.p1.2.m2.1.1.cmml" xref="A5.SS3.SSS2.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p1.2.m2.1d">italic_j</annotation></semantics></math>, the difference in their prompt-embedding gradients is</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A5.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A5.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Bigl{\|}\,\nabla_{\mathbf{p}^{(i)}}\ell^{(i)}-\nabla_{\mathbf{p}%
^{(j)}}\ell^{(j)}\Bigr{\|}" class="ltx_Math" display="inline" id="A5.E5X.2.1.1.m1.5"><semantics id="A5.E5X.2.1.1.m1.5a"><mrow id="A5.E5X.2.1.1.m1.5.5.1" xref="A5.E5X.2.1.1.m1.5.5.2.cmml"><mo fence="true" id="A5.E5X.2.1.1.m1.5.5.1.2" mathsize="160%" rspace="0.170em" xref="A5.E5X.2.1.1.m1.5.5.2.1.cmml">∥</mo><mrow id="A5.E5X.2.1.1.m1.5.5.1.1" xref="A5.E5X.2.1.1.m1.5.5.1.1.cmml"><mrow id="A5.E5X.2.1.1.m1.5.5.1.1.2" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.cmml"><msub id="A5.E5X.2.1.1.m1.5.5.1.1.2.1" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.1.cmml"><mo id="A5.E5X.2.1.1.m1.5.5.1.1.2.1.2" rspace="0.167em" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.1.2.cmml">∇</mo><msup id="A5.E5X.2.1.1.m1.1.1.1" xref="A5.E5X.2.1.1.m1.1.1.1.cmml"><mi id="A5.E5X.2.1.1.m1.1.1.1.3" xref="A5.E5X.2.1.1.m1.1.1.1.3.cmml">𝐩</mi><mrow id="A5.E5X.2.1.1.m1.1.1.1.1.1.3" xref="A5.E5X.2.1.1.m1.1.1.1.cmml"><mo id="A5.E5X.2.1.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.E5X.2.1.1.m1.1.1.1.cmml">(</mo><mi id="A5.E5X.2.1.1.m1.1.1.1.1.1.1" xref="A5.E5X.2.1.1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.E5X.2.1.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.E5X.2.1.1.m1.1.1.1.cmml">)</mo></mrow></msup></msub><msup id="A5.E5X.2.1.1.m1.5.5.1.1.2.2" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.cmml"><mi id="A5.E5X.2.1.1.m1.5.5.1.1.2.2.2" mathvariant="normal" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.E5X.2.1.1.m1.2.2.1.3" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.cmml"><mo id="A5.E5X.2.1.1.m1.2.2.1.3.1" stretchy="false" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.cmml">(</mo><mi id="A5.E5X.2.1.1.m1.2.2.1.1" xref="A5.E5X.2.1.1.m1.2.2.1.1.cmml">i</mi><mo id="A5.E5X.2.1.1.m1.2.2.1.3.2" stretchy="false" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.E5X.2.1.1.m1.5.5.1.1.1" xref="A5.E5X.2.1.1.m1.5.5.1.1.1.cmml">−</mo><mrow id="A5.E5X.2.1.1.m1.5.5.1.1.3" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.cmml"><msub id="A5.E5X.2.1.1.m1.5.5.1.1.3.1" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.1.cmml"><mo id="A5.E5X.2.1.1.m1.5.5.1.1.3.1.2" rspace="0.167em" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.1.2.cmml">∇</mo><msup id="A5.E5X.2.1.1.m1.3.3.1" xref="A5.E5X.2.1.1.m1.3.3.1.cmml"><mi id="A5.E5X.2.1.1.m1.3.3.1.3" xref="A5.E5X.2.1.1.m1.3.3.1.3.cmml">𝐩</mi><mrow id="A5.E5X.2.1.1.m1.3.3.1.1.1.3" xref="A5.E5X.2.1.1.m1.3.3.1.cmml"><mo id="A5.E5X.2.1.1.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.E5X.2.1.1.m1.3.3.1.cmml">(</mo><mi id="A5.E5X.2.1.1.m1.3.3.1.1.1.1" xref="A5.E5X.2.1.1.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.E5X.2.1.1.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.E5X.2.1.1.m1.3.3.1.cmml">)</mo></mrow></msup></msub><msup id="A5.E5X.2.1.1.m1.5.5.1.1.3.2" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.cmml"><mi id="A5.E5X.2.1.1.m1.5.5.1.1.3.2.2" mathvariant="normal" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E5X.2.1.1.m1.4.4.1.3" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.cmml"><mo id="A5.E5X.2.1.1.m1.4.4.1.3.1" stretchy="false" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.cmml">(</mo><mi id="A5.E5X.2.1.1.m1.4.4.1.1" xref="A5.E5X.2.1.1.m1.4.4.1.1.cmml">j</mi><mo id="A5.E5X.2.1.1.m1.4.4.1.3.2" stretchy="false" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.E5X.2.1.1.m1.5.5.1.3" lspace="0em" mathsize="160%" xref="A5.E5X.2.1.1.m1.5.5.2.1.cmml">∥</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E5X.2.1.1.m1.5b"><apply id="A5.E5X.2.1.1.m1.5.5.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1"><csymbol cd="latexml" id="A5.E5X.2.1.1.m1.5.5.2.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.2">delimited-∥∥</csymbol><apply id="A5.E5X.2.1.1.m1.5.5.1.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1"><minus id="A5.E5X.2.1.1.m1.5.5.1.1.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.1"></minus><apply id="A5.E5X.2.1.1.m1.5.5.1.1.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2"><apply id="A5.E5X.2.1.1.m1.5.5.1.1.2.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.1"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.5.5.1.1.2.1.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.1">subscript</csymbol><ci id="A5.E5X.2.1.1.m1.5.5.1.1.2.1.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.1.2">∇</ci><apply id="A5.E5X.2.1.1.m1.1.1.1.cmml" xref="A5.E5X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.1.1.1.2.cmml" xref="A5.E5X.2.1.1.m1.1.1.1">superscript</csymbol><ci id="A5.E5X.2.1.1.m1.1.1.1.3.cmml" xref="A5.E5X.2.1.1.m1.1.1.1.3">𝐩</ci><ci id="A5.E5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A5.E5X.2.1.1.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E5X.2.1.1.m1.5.5.1.1.2.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.5.5.1.1.2.2.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2">superscript</csymbol><ci id="A5.E5X.2.1.1.m1.5.5.1.1.2.2.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.2.2.2">ℓ</ci><ci id="A5.E5X.2.1.1.m1.2.2.1.1.cmml" xref="A5.E5X.2.1.1.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.E5X.2.1.1.m1.5.5.1.1.3.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3"><apply id="A5.E5X.2.1.1.m1.5.5.1.1.3.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.5.5.1.1.3.1.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.1">subscript</csymbol><ci id="A5.E5X.2.1.1.m1.5.5.1.1.3.1.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.1.2">∇</ci><apply id="A5.E5X.2.1.1.m1.3.3.1.cmml" xref="A5.E5X.2.1.1.m1.3.3.1"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.3.3.1.2.cmml" xref="A5.E5X.2.1.1.m1.3.3.1">superscript</csymbol><ci id="A5.E5X.2.1.1.m1.3.3.1.3.cmml" xref="A5.E5X.2.1.1.m1.3.3.1.3">𝐩</ci><ci id="A5.E5X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="A5.E5X.2.1.1.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E5X.2.1.1.m1.5.5.1.1.3.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="A5.E5X.2.1.1.m1.5.5.1.1.3.2.1.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2">superscript</csymbol><ci id="A5.E5X.2.1.1.m1.5.5.1.1.3.2.2.cmml" xref="A5.E5X.2.1.1.m1.5.5.1.1.3.2.2">ℓ</ci><ci id="A5.E5X.2.1.1.m1.4.4.1.1.cmml" xref="A5.E5X.2.1.1.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E5X.2.1.1.m1.5c">\displaystyle\Bigl{\|}\,\nabla_{\mathbf{p}^{(i)}}\ell^{(i)}-\nabla_{\mathbf{p}%
^{(j)}}\ell^{(j)}\Bigr{\|}</annotation><annotation encoding="application/x-llamapun" id="A5.E5X.2.1.1.m1.5d">∥ ∇ start_POSTSUBSCRIPT bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\,=\,\Bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}%
\bigr{)}^{\top}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-J_{\mathcal{T}_{\phi}%
}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}^{\top}\,\nabla_{w_{\mathrm{g}}^{(j)}}\ell^%
{(j)}\Bigr{\|}" class="ltx_Math" display="inline" id="A5.E5X.3.2.2.m1.7"><semantics id="A5.E5X.3.2.2.m1.7a"><mrow id="A5.E5X.3.2.2.m1.7.7" xref="A5.E5X.3.2.2.m1.7.7.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.3" xref="A5.E5X.3.2.2.m1.7.7.3.cmml"></mi><mo id="A5.E5X.3.2.2.m1.7.7.2" lspace="0.448em" rspace="0.170em" xref="A5.E5X.3.2.2.m1.7.7.2.cmml">=</mo><mrow id="A5.E5X.3.2.2.m1.7.7.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.2.cmml"><mo fence="true" id="A5.E5X.3.2.2.m1.7.7.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.E5X.3.2.2.m1.7.7.1.2.1.cmml">∥</mo><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.cmml"><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.cmml"><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.2.cmml">J</mi><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.2.cmml">𝒯</mi><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2.cmml">⁢</mo><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.cmml"><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E5X.3.2.2.m1.1.1.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E5X.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.1.1.1.1" xref="A5.E5X.3.2.2.m1.1.1.1.1.cmml">i</mi><mo id="A5.E5X.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2a" lspace="0.167em" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.cmml"><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.cmml"><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.2" rspace="0.167em" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.2.cmml">∇</mo><msubsup id="A5.E5X.3.2.2.m1.2.2.1" xref="A5.E5X.3.2.2.m1.2.2.1.cmml"><mi id="A5.E5X.3.2.2.m1.2.2.1.3.2" xref="A5.E5X.3.2.2.m1.2.2.1.3.2.cmml">w</mi><mi id="A5.E5X.3.2.2.m1.2.2.1.3.3" mathvariant="normal" xref="A5.E5X.3.2.2.m1.2.2.1.3.3.cmml">g</mi><mrow id="A5.E5X.3.2.2.m1.2.2.1.1.1.3" xref="A5.E5X.3.2.2.m1.2.2.1.cmml"><mo id="A5.E5X.3.2.2.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.2.2.1.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.2.2.1.1.1.1" xref="A5.E5X.3.2.2.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.E5X.3.2.2.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.2.2.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.2" mathvariant="normal" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.2.cmml">ℓ</mi><mrow id="A5.E5X.3.2.2.m1.3.3.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.cmml"><mo id="A5.E5X.3.2.2.m1.3.3.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.3.3.1.1" xref="A5.E5X.3.2.2.m1.3.3.1.1.cmml">i</mi><mo id="A5.E5X.3.2.2.m1.3.3.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.cmml">)</mo></mrow></msup></mrow></mrow><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.3.cmml">−</mo><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.cmml"><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.2.cmml">J</mi><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.2.cmml">𝒯</mi><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml">⁢</mo><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.cmml"><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml"><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml">(</mo><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E5X.3.2.2.m1.4.4.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml"><mo id="A5.E5X.3.2.2.m1.4.4.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.4.4.1.1" xref="A5.E5X.3.2.2.m1.4.4.1.1.cmml">j</mi><mo id="A5.E5X.3.2.2.m1.4.4.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.3.cmml">⊤</mo></msup><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2a" lspace="0.167em" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml">⁢</mo><mrow id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.cmml"><msub id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.cmml"><mo id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.2" rspace="0.167em" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.2.cmml">∇</mo><msubsup id="A5.E5X.3.2.2.m1.5.5.1" xref="A5.E5X.3.2.2.m1.5.5.1.cmml"><mi id="A5.E5X.3.2.2.m1.5.5.1.3.2" xref="A5.E5X.3.2.2.m1.5.5.1.3.2.cmml">w</mi><mi id="A5.E5X.3.2.2.m1.5.5.1.3.3" mathvariant="normal" xref="A5.E5X.3.2.2.m1.5.5.1.3.3.cmml">g</mi><mrow id="A5.E5X.3.2.2.m1.5.5.1.1.1.3" xref="A5.E5X.3.2.2.m1.5.5.1.cmml"><mo id="A5.E5X.3.2.2.m1.5.5.1.1.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.5.5.1.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.5.5.1.1.1.1" xref="A5.E5X.3.2.2.m1.5.5.1.1.1.1.cmml">j</mi><mo id="A5.E5X.3.2.2.m1.5.5.1.1.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.5.5.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.cmml"><mi id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.2" mathvariant="normal" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.2.cmml">ℓ</mi><mrow id="A5.E5X.3.2.2.m1.6.6.1.3" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.cmml"><mo id="A5.E5X.3.2.2.m1.6.6.1.3.1" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.cmml">(</mo><mi id="A5.E5X.3.2.2.m1.6.6.1.1" xref="A5.E5X.3.2.2.m1.6.6.1.1.cmml">j</mi><mo id="A5.E5X.3.2.2.m1.6.6.1.3.2" stretchy="false" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.cmml">)</mo></mrow></msup></mrow></mrow></mrow><mo fence="true" id="A5.E5X.3.2.2.m1.7.7.1.1.3" lspace="0em" mathsize="160%" xref="A5.E5X.3.2.2.m1.7.7.1.2.1.cmml">∥</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.E5X.3.2.2.m1.7b"><apply id="A5.E5X.3.2.2.m1.7.7.cmml" xref="A5.E5X.3.2.2.m1.7.7"><eq id="A5.E5X.3.2.2.m1.7.7.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.2"></eq><csymbol cd="latexml" id="A5.E5X.3.2.2.m1.7.7.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.3">absent</csymbol><apply id="A5.E5X.3.2.2.m1.7.7.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1"><csymbol cd="latexml" id="A5.E5X.3.2.2.m1.7.7.1.2.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.2">delimited-∥∥</csymbol><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1"><minus id="A5.E5X.3.2.2.m1.7.7.1.1.1.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.3"></minus><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1"><times id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.2"></times><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.2">𝐽</ci><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.2">𝒯</ci><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.E5X.3.2.2.m1.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.1.1.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.1.3">top</csymbol></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4"><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.1.2">∇</ci><apply id="A5.E5X.3.2.2.m1.2.2.1.cmml" xref="A5.E5X.3.2.2.m1.2.2.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.2.2.1.2.cmml" xref="A5.E5X.3.2.2.m1.2.2.1">superscript</csymbol><apply id="A5.E5X.3.2.2.m1.2.2.1.3.cmml" xref="A5.E5X.3.2.2.m1.2.2.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.2.2.1.3.1.cmml" xref="A5.E5X.3.2.2.m1.2.2.1">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.2.2.1.3.2.cmml" xref="A5.E5X.3.2.2.m1.2.2.1.3.2">𝑤</ci><ci id="A5.E5X.3.2.2.m1.2.2.1.3.3.cmml" xref="A5.E5X.3.2.2.m1.2.2.1.3.3">g</ci></apply><ci id="A5.E5X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.2.2.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2">superscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.1.4.2.2">ℓ</ci><ci id="A5.E5X.3.2.2.m1.3.3.1.1.cmml" xref="A5.E5X.3.2.2.m1.3.3.1.1">𝑖</ci></apply></apply></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2"><times id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.2"></times><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.2">𝐽</ci><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.2">𝒯</ci><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1">superscript</csymbol><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1">superscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.1.1.1.2">𝐩</ci><ci id="A5.E5X.3.2.2.m1.4.4.1.1.cmml" xref="A5.E5X.3.2.2.m1.4.4.1.1">𝑗</ci></apply><csymbol cd="latexml" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.3.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.1.3">top</csymbol></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4"><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.1.2">∇</ci><apply id="A5.E5X.3.2.2.m1.5.5.1.cmml" xref="A5.E5X.3.2.2.m1.5.5.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.5.5.1.2.cmml" xref="A5.E5X.3.2.2.m1.5.5.1">superscript</csymbol><apply id="A5.E5X.3.2.2.m1.5.5.1.3.cmml" xref="A5.E5X.3.2.2.m1.5.5.1"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.5.5.1.3.1.cmml" xref="A5.E5X.3.2.2.m1.5.5.1">subscript</csymbol><ci id="A5.E5X.3.2.2.m1.5.5.1.3.2.cmml" xref="A5.E5X.3.2.2.m1.5.5.1.3.2">𝑤</ci><ci id="A5.E5X.3.2.2.m1.5.5.1.3.3.cmml" xref="A5.E5X.3.2.2.m1.5.5.1.3.3">g</ci></apply><ci id="A5.E5X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="A5.E5X.3.2.2.m1.5.5.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2"><csymbol cd="ambiguous" id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.1.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2">superscript</csymbol><ci id="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.2.cmml" xref="A5.E5X.3.2.2.m1.7.7.1.1.1.2.4.2.2">ℓ</ci><ci id="A5.E5X.3.2.2.m1.6.6.1.1.cmml" xref="A5.E5X.3.2.2.m1.6.6.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E5X.3.2.2.m1.7c">\displaystyle\,=\,\Bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}%
\bigr{)}^{\top}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-J_{\mathcal{T}_{\phi}%
}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}^{\top}\,\nabla_{w_{\mathrm{g}}^{(j)}}\ell^%
{(j)}\Bigr{\|}</annotation><annotation encoding="application/x-llamapun" id="A5.E5X.3.2.2.m1.7d">= ∥ italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A5.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\,\leq\,\Bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i%
)}\bigr{)}^{\top}\bigl{(}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\bigr{)}\Bigr{\|}" class="ltx_Math" display="inline" id="A5.E5Xa.2.1.1.m1.6"><semantics id="A5.E5Xa.2.1.1.m1.6a"><mrow id="A5.E5Xa.2.1.1.m1.6.6" xref="A5.E5Xa.2.1.1.m1.6.6.cmml"><mi id="A5.E5Xa.2.1.1.m1.6.6.3" xref="A5.E5Xa.2.1.1.m1.6.6.3.cmml"></mi><mo id="A5.E5Xa.2.1.1.m1.6.6.2" lspace="0.448em" rspace="0.170em" xref="A5.E5Xa.2.1.1.m1.6.6.2.cmml">≤</mo><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.2.cmml"><mo fence="true" id="A5.E5Xa.2.1.1.m1.6.6.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.E5Xa.2.1.1.m1.6.6.1.2.1.cmml">∥</mo><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.cmml"><msub id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.cmml"><mi id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.2.cmml">J</mi><msub id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.2.cmml">𝒯</mi><mi id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3.cmml">⁢</mo><msup id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.cmml"><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msup id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E5Xa.2.1.1.m1.1.1.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.E5Xa.2.1.1.m1.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.E5Xa.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3a" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3.cmml">⁢</mo><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.2" maxsize="120%" minsize="120%" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.cmml">(</mo><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.cmml"><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.cmml"><msub id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.2" rspace="0.167em" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.2.cmml">∇</mo><msubsup id="A5.E5Xa.2.1.1.m1.2.2.1" xref="A5.E5Xa.2.1.1.m1.2.2.1.cmml"><mi id="A5.E5Xa.2.1.1.m1.2.2.1.3.2" xref="A5.E5Xa.2.1.1.m1.2.2.1.3.2.cmml">w</mi><mi id="A5.E5Xa.2.1.1.m1.2.2.1.3.3" mathvariant="normal" xref="A5.E5Xa.2.1.1.m1.2.2.1.3.3.cmml">g</mi><mrow id="A5.E5Xa.2.1.1.m1.2.2.1.1.1.3" xref="A5.E5Xa.2.1.1.m1.2.2.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.2.2.1.1.1.3.1" stretchy="false" xref="A5.E5Xa.2.1.1.m1.2.2.1.cmml">(</mo><mi id="A5.E5Xa.2.1.1.m1.2.2.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.2.2.1.1.1.1.cmml">i</mi><mo id="A5.E5Xa.2.1.1.m1.2.2.1.1.1.3.2" stretchy="false" xref="A5.E5Xa.2.1.1.m1.2.2.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.cmml"><mi id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.2" mathvariant="normal" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.E5Xa.2.1.1.m1.3.3.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.cmml"><mo id="A5.E5Xa.2.1.1.m1.3.3.1.3.1" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.cmml">(</mo><mi id="A5.E5Xa.2.1.1.m1.3.3.1.1" xref="A5.E5Xa.2.1.1.m1.3.3.1.1.cmml">i</mi><mo id="A5.E5Xa.2.1.1.m1.3.3.1.3.2" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.1.cmml">−</mo><mrow id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.cmml"><msub id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.2" rspace="0.167em" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.E5Xa.2.1.1.m1.4.4.1" xref="A5.E5Xa.2.1.1.m1.4.4.1.cmml"><mi id="A5.E5Xa.2.1.1.m1.4.4.1.3.2" xref="A5.E5Xa.2.1.1.m1.4.4.1.3.2.cmml">w</mi><mi id="A5.E5Xa.2.1.1.m1.4.4.1.3.3" mathvariant="normal" xref="A5.E5Xa.2.1.1.m1.4.4.1.3.3.cmml">g</mi><mrow id="A5.E5Xa.2.1.1.m1.4.4.1.1.1.3" xref="A5.E5Xa.2.1.1.m1.4.4.1.cmml"><mo id="A5.E5Xa.2.1.1.m1.4.4.1.1.1.3.1" stretchy="false" xref="A5.E5Xa.2.1.1.m1.4.4.1.cmml">(</mo><mi id="A5.E5Xa.2.1.1.m1.4.4.1.1.1.1" xref="A5.E5Xa.2.1.1.m1.4.4.1.1.1.1.cmml">j</mi><mo id="A5.E5Xa.2.1.1.m1.4.4.1.1.1.3.2" stretchy="false" xref="A5.E5Xa.2.1.1.m1.4.4.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.cmml"><mi id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.2" mathvariant="normal" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E5Xa.2.1.1.m1.5.5.1.3" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.cmml"><mo id="A5.E5Xa.2.1.1.m1.5.5.1.3.1" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.cmml">(</mo><mi id="A5.E5Xa.2.1.1.m1.5.5.1.1" xref="A5.E5Xa.2.1.1.m1.5.5.1.1.cmml">j</mi><mo id="A5.E5Xa.2.1.1.m1.5.5.1.3.2" stretchy="false" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.3" maxsize="120%" minsize="120%" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo fence="true" id="A5.E5Xa.2.1.1.m1.6.6.1.1.3" lspace="0em" mathsize="160%" xref="A5.E5Xa.2.1.1.m1.6.6.1.2.1.cmml">∥</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.E5Xa.2.1.1.m1.6b"><apply id="A5.E5Xa.2.1.1.m1.6.6.cmml" xref="A5.E5Xa.2.1.1.m1.6.6"><leq id="A5.E5Xa.2.1.1.m1.6.6.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.2"></leq><csymbol cd="latexml" id="A5.E5Xa.2.1.1.m1.6.6.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.3">absent</csymbol><apply id="A5.E5Xa.2.1.1.m1.6.6.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1"><csymbol cd="latexml" id="A5.E5Xa.2.1.1.m1.6.6.1.2.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.2">delimited-∥∥</csymbol><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1"><times id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.3"></times><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.2">𝐽</ci><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.2">𝒯</ci><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.4.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1">superscript</csymbol><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1">superscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.1.1.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.1.3">top</csymbol></apply><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1"><minus id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.1"></minus><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2"><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.1.2">∇</ci><apply id="A5.E5Xa.2.1.1.m1.2.2.1.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.2.2.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1">superscript</csymbol><apply id="A5.E5Xa.2.1.1.m1.2.2.1.3.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.2.2.1.3.1.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.2.2.1.3.2.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1.3.2">𝑤</ci><ci id="A5.E5Xa.2.1.1.m1.2.2.1.3.3.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1.3.3">g</ci></apply><ci id="A5.E5Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.2.2.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2">superscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.2.2.2">ℓ</ci><ci id="A5.E5Xa.2.1.1.m1.3.3.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.3.3.1.1">𝑖</ci></apply></apply><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3"><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.1.2">∇</ci><apply id="A5.E5Xa.2.1.1.m1.4.4.1.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.4.4.1.2.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1">superscript</csymbol><apply id="A5.E5Xa.2.1.1.m1.4.4.1.3.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.4.4.1.3.1.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1">subscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.4.4.1.3.2.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1.3.2">𝑤</ci><ci id="A5.E5Xa.2.1.1.m1.4.4.1.3.3.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1.3.3">g</ci></apply><ci id="A5.E5Xa.2.1.1.m1.4.4.1.1.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.4.4.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2"><csymbol cd="ambiguous" id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.1.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2">superscript</csymbol><ci id="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.2.cmml" xref="A5.E5Xa.2.1.1.m1.6.6.1.1.1.2.1.1.3.2.2">ℓ</ci><ci id="A5.E5Xa.2.1.1.m1.5.5.1.1.cmml" xref="A5.E5Xa.2.1.1.m1.5.5.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E5Xa.2.1.1.m1.6c">\displaystyle\,\leq\,\Bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i%
)}\bigr{)}^{\top}\bigl{(}\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{%
\mathrm{g}}^{(j)}}\ell^{(j)}\bigr{)}\Bigr{\|}</annotation><annotation encoding="application/x-llamapun" id="A5.E5Xa.2.1.1.m1.6d">≤ ∥ italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ( ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A5.E5Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+\Bigl{\|}\,\bigl{(}J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{%
p}^{(i)}\bigr{)}^{\top}-J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{%
)}^{\top}\bigr{)}\nabla_{w_{\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}." class="ltx_Math" display="inline" id="A5.E5Xb.2.1.1.m1.5"><semantics id="A5.E5Xb.2.1.1.m1.5a"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.cmml"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1a" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.cmml">+</mo><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.2.cmml"><mo fence="true" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.2" lspace="0em" mathsize="160%" rspace="0.170em" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.2.1.cmml">∥</mo><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.cmml"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">J</mi><msub id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝒯</mi><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E5Xb.2.1.1.m1.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.E5Xb.2.1.1.m1.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="A5.E5Xb.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><msub id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.cmml">J</mi><msub id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.2.cmml">𝒯</mi><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml"><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><msup id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.E5Xb.2.1.1.m1.2.2.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.2.2.1.3.1" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mi id="A5.E5Xb.2.1.1.m1.2.2.1.1" xref="A5.E5Xb.2.1.1.m1.2.2.1.1.cmml">j</mi><mo id="A5.E5Xb.2.1.1.m1.2.2.1.3.2" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.3.cmml">⊤</mo></msup></mrow></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.2" lspace="0.167em" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.cmml"><msub id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.2" rspace="0.167em" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.E5Xb.2.1.1.m1.3.3.1" xref="A5.E5Xb.2.1.1.m1.3.3.1.cmml"><mi id="A5.E5Xb.2.1.1.m1.3.3.1.3.2" xref="A5.E5Xb.2.1.1.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.E5Xb.2.1.1.m1.3.3.1.3.3" mathvariant="normal" xref="A5.E5Xb.2.1.1.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.E5Xb.2.1.1.m1.3.3.1.1.1.3" xref="A5.E5Xb.2.1.1.m1.3.3.1.cmml"><mo id="A5.E5Xb.2.1.1.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.E5Xb.2.1.1.m1.3.3.1.cmml">(</mo><mi id="A5.E5Xb.2.1.1.m1.3.3.1.1.1.1" xref="A5.E5Xb.2.1.1.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.E5Xb.2.1.1.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.E5Xb.2.1.1.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.cmml"><mi id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.2" mathvariant="normal" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.E5Xb.2.1.1.m1.4.4.1.3" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.cmml"><mo id="A5.E5Xb.2.1.1.m1.4.4.1.3.1" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.cmml">(</mo><mi id="A5.E5Xb.2.1.1.m1.4.4.1.1" xref="A5.E5Xb.2.1.1.m1.4.4.1.1.cmml">j</mi><mo id="A5.E5Xb.2.1.1.m1.4.4.1.3.2" stretchy="false" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.2.1.cmml">∥</mo></mrow></mrow><mo id="A5.E5Xb.2.1.1.m1.5.5.1.2" lspace="0em" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E5Xb.2.1.1.m1.5b"><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1"><plus id="A5.E5Xb.2.1.1.m1.5.5.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1"></plus><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.2.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1"><times id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.2"></times><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1"><minus id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3"></minus><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2"></times><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">𝐽</ci><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2">𝒯</ci><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.E5Xb.2.1.1.m1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.1.1.1.1">𝑖</ci></apply><csymbol cd="latexml" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply></apply><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2"><times id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2"></times><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.2">𝐽</ci><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.2">𝒯</ci><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1">superscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.2">𝐩</ci><ci id="A5.E5Xb.2.1.1.m1.2.2.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.2.2.1.1">𝑗</ci></apply><csymbol cd="latexml" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.3">top</csymbol></apply></apply></apply><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3"><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.1.2">∇</ci><apply id="A5.E5Xb.2.1.1.m1.3.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.3.3.1.2.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1">superscript</csymbol><apply id="A5.E5Xb.2.1.1.m1.3.3.1.3.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.3.3.1.3.1.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1">subscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.3.3.1.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1.3.2">𝑤</ci><ci id="A5.E5Xb.2.1.1.m1.3.3.1.3.3.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1.3.3">g</ci></apply><ci id="A5.E5Xb.2.1.1.m1.3.3.1.1.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2">superscript</csymbol><ci id="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="A5.E5Xb.2.1.1.m1.5.5.1.1.1.1.1.3.2.2">ℓ</ci><ci id="A5.E5Xb.2.1.1.m1.4.4.1.1.cmml" xref="A5.E5Xb.2.1.1.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E5Xb.2.1.1.m1.5c">\displaystyle\quad+\Bigl{\|}\,\bigl{(}J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{%
p}^{(i)}\bigr{)}^{\top}-J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{%
)}^{\top}\bigr{)}\nabla_{w_{\mathrm{g}}^{(j)}}\ell^{(j)}\Bigr{\|}.</annotation><annotation encoding="application/x-llamapun" id="A5.E5Xb.2.1.1.m1.5d">+ ∥ ( italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT - italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="A5.SS3.SSS2.p2">
<p class="ltx_p" id="A5.SS3.SSS2.p2.1">The first term involves
<math alttext="\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{\mathrm{g}}^{(j)}}\ell^{(j)}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.1.m1.4"><semantics id="A5.SS3.SSS2.p2.1.m1.4a"><mrow id="A5.SS3.SSS2.p2.1.m1.4.5" xref="A5.SS3.SSS2.p2.1.m1.4.5.cmml"><mrow id="A5.SS3.SSS2.p2.1.m1.4.5.2" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.cmml"><msub id="A5.SS3.SSS2.p2.1.m1.4.5.2.1" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.1.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.4.5.2.1.2" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.1.2.cmml">∇</mo><msubsup id="A5.SS3.SSS2.p2.1.m1.1.1.1" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.2" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.3" mathvariant="normal" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.3" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.1" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.SS3.SSS2.p2.1.m1.4.5.2.2" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.cmml"><mi id="A5.SS3.SSS2.p2.1.m1.4.5.2.2.2" mathvariant="normal" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.2.cmml">ℓ</mi><mrow id="A5.SS3.SSS2.p2.1.m1.2.2.1.3" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.2.2.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.cmml">(</mo><mi id="A5.SS3.SSS2.p2.1.m1.2.2.1.1" xref="A5.SS3.SSS2.p2.1.m1.2.2.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.p2.1.m1.2.2.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.SS3.SSS2.p2.1.m1.4.5.1" xref="A5.SS3.SSS2.p2.1.m1.4.5.1.cmml">−</mo><mrow id="A5.SS3.SSS2.p2.1.m1.4.5.3" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.cmml"><msub id="A5.SS3.SSS2.p2.1.m1.4.5.3.1" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.1.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.4.5.3.1.2" rspace="0.167em" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.1.2.cmml">∇</mo><msubsup id="A5.SS3.SSS2.p2.1.m1.3.3.1" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.cmml"><mi id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.2" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.3" mathvariant="normal" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.3" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.1" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.SS3.SSS2.p2.1.m1.4.5.3.2" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.cmml"><mi id="A5.SS3.SSS2.p2.1.m1.4.5.3.2.2" mathvariant="normal" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.2.cmml">ℓ</mi><mrow id="A5.SS3.SSS2.p2.1.m1.4.4.1.3" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.cmml"><mo id="A5.SS3.SSS2.p2.1.m1.4.4.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.cmml">(</mo><mi id="A5.SS3.SSS2.p2.1.m1.4.4.1.1" xref="A5.SS3.SSS2.p2.1.m1.4.4.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.1.m1.4.4.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.1.m1.4b"><apply id="A5.SS3.SSS2.p2.1.m1.4.5.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5"><minus id="A5.SS3.SSS2.p2.1.m1.4.5.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.1"></minus><apply id="A5.SS3.SSS2.p2.1.m1.4.5.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2"><apply id="A5.SS3.SSS2.p2.1.m1.4.5.2.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.4.5.2.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.4.5.2.1.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.1.2">∇</ci><apply id="A5.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1">superscript</csymbol><apply id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.3.2">𝑤</ci><ci id="A5.SS3.SSS2.p2.1.m1.1.1.1.3.3.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.3.3">g</ci></apply><ci id="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.SS3.SSS2.p2.1.m1.4.5.2.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.4.5.2.2.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2">superscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.4.5.2.2.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.2.2.2">ℓ</ci><ci id="A5.SS3.SSS2.p2.1.m1.2.2.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.SS3.SSS2.p2.1.m1.4.5.3.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3"><apply id="A5.SS3.SSS2.p2.1.m1.4.5.3.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.4.5.3.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.4.5.3.1.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.1.2">∇</ci><apply id="A5.SS3.SSS2.p2.1.m1.3.3.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.3.3.1.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1">superscript</csymbol><apply id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.3.2">𝑤</ci><ci id="A5.SS3.SSS2.p2.1.m1.3.3.1.3.3.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.3.3">g</ci></apply><ci id="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.SS3.SSS2.p2.1.m1.4.5.3.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.1.m1.4.5.3.2.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2">superscript</csymbol><ci id="A5.SS3.SSS2.p2.1.m1.4.5.3.2.2.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.5.3.2.2">ℓ</ci><ci id="A5.SS3.SSS2.p2.1.m1.4.4.1.1.cmml" xref="A5.SS3.SSS2.p2.1.m1.4.4.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.1.m1.4c">\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{\mathrm{g}}^{(j)}}\ell^{(j)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.1.m1.4d">∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>,
which from Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.19888v1#A5.E3" title="In E.2 Bounding the Gradient Difference ‣ Appendix E Theoretical Analysis ‣ Generalized and Personalized Federated Learning with Foundation Models via Orthogonal Transformations"><span class="ltx_text ltx_ref_tag">3</span></a>) is bounded by</p>
<table class="ltx_equation ltx_eqn_table" id="A5.Ex20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{\mathrm{g}}^{(j)%
}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\bigl{[}\kappa\bigl{(}w_{\mathrm{l}}^{(i)}%
\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\bigr{]}." class="ltx_Math" display="block" id="A5.Ex20.m1.7"><semantics id="A5.Ex20.m1.7a"><mrow id="A5.Ex20.m1.7.7.1" xref="A5.Ex20.m1.7.7.1.1.cmml"><mrow id="A5.Ex20.m1.7.7.1.1" xref="A5.Ex20.m1.7.7.1.1.cmml"><mrow id="A5.Ex20.m1.7.7.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.1.2.cmml"><mo fence="true" id="A5.Ex20.m1.7.7.1.1.1.1.2" mathsize="160%" rspace="0.170em" xref="A5.Ex20.m1.7.7.1.1.1.2.1.cmml">∥</mo><mrow id="A5.Ex20.m1.7.7.1.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.1.1.1.cmml"><mrow id="A5.Ex20.m1.7.7.1.1.1.1.1.2" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.cmml"><msub id="A5.Ex20.m1.7.7.1.1.1.1.1.2.1" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.cmml"><mo id="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.2" rspace="0.167em" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="A5.Ex20.m1.1.1.1" xref="A5.Ex20.m1.1.1.1.cmml"><mi id="A5.Ex20.m1.1.1.1.3.2" xref="A5.Ex20.m1.1.1.1.3.2.cmml">w</mi><mi id="A5.Ex20.m1.1.1.1.3.3" mathvariant="normal" xref="A5.Ex20.m1.1.1.1.3.3.cmml">g</mi><mrow id="A5.Ex20.m1.1.1.1.1.1.3" xref="A5.Ex20.m1.1.1.1.cmml"><mo id="A5.Ex20.m1.1.1.1.1.1.3.1" stretchy="false" xref="A5.Ex20.m1.1.1.1.cmml">(</mo><mi id="A5.Ex20.m1.1.1.1.1.1.1" xref="A5.Ex20.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A5.Ex20.m1.1.1.1.1.1.3.2" stretchy="false" xref="A5.Ex20.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex20.m1.7.7.1.1.1.1.1.2.2" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.cmml"><mi id="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.2" mathvariant="normal" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.2.cmml">ℓ</mi><mrow id="A5.Ex20.m1.2.2.1.3" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.cmml"><mo id="A5.Ex20.m1.2.2.1.3.1" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.cmml">(</mo><mi id="A5.Ex20.m1.2.2.1.1" xref="A5.Ex20.m1.2.2.1.1.cmml">i</mi><mo id="A5.Ex20.m1.2.2.1.3.2" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.Ex20.m1.7.7.1.1.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.1.1.1.1.cmml">−</mo><mrow id="A5.Ex20.m1.7.7.1.1.1.1.1.3" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.cmml"><msub id="A5.Ex20.m1.7.7.1.1.1.1.1.3.1" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.2" rspace="0.167em" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="A5.Ex20.m1.3.3.1" xref="A5.Ex20.m1.3.3.1.cmml"><mi id="A5.Ex20.m1.3.3.1.3.2" xref="A5.Ex20.m1.3.3.1.3.2.cmml">w</mi><mi id="A5.Ex20.m1.3.3.1.3.3" mathvariant="normal" xref="A5.Ex20.m1.3.3.1.3.3.cmml">g</mi><mrow id="A5.Ex20.m1.3.3.1.1.1.3" xref="A5.Ex20.m1.3.3.1.cmml"><mo id="A5.Ex20.m1.3.3.1.1.1.3.1" stretchy="false" xref="A5.Ex20.m1.3.3.1.cmml">(</mo><mi id="A5.Ex20.m1.3.3.1.1.1.1" xref="A5.Ex20.m1.3.3.1.1.1.1.cmml">j</mi><mo id="A5.Ex20.m1.3.3.1.1.1.3.2" stretchy="false" xref="A5.Ex20.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.Ex20.m1.7.7.1.1.1.1.1.3.2" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.cmml"><mi id="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.2" mathvariant="normal" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="A5.Ex20.m1.4.4.1.3" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.cmml"><mo id="A5.Ex20.m1.4.4.1.3.1" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.cmml">(</mo><mi id="A5.Ex20.m1.4.4.1.1" xref="A5.Ex20.m1.4.4.1.1.cmml">j</mi><mo id="A5.Ex20.m1.4.4.1.3.2" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.cmml">)</mo></mrow></msup></mrow></mrow><mo fence="true" id="A5.Ex20.m1.7.7.1.1.1.1.3" lspace="0em" mathsize="160%" xref="A5.Ex20.m1.7.7.1.1.1.2.1.cmml">∥</mo></mrow><mo id="A5.Ex20.m1.7.7.1.1.3" xref="A5.Ex20.m1.7.7.1.1.3.cmml">≤</mo><mrow id="A5.Ex20.m1.7.7.1.1.2" xref="A5.Ex20.m1.7.7.1.1.2.cmml"><mn id="A5.Ex20.m1.7.7.1.1.2.3" xref="A5.Ex20.m1.7.7.1.1.2.3.cmml"> 2</mn><mo id="A5.Ex20.m1.7.7.1.1.2.2" xref="A5.Ex20.m1.7.7.1.1.2.2.cmml">⁢</mo><mi id="A5.Ex20.m1.7.7.1.1.2.4" xref="A5.Ex20.m1.7.7.1.1.2.4.cmml">τ</mi><mo id="A5.Ex20.m1.7.7.1.1.2.2a" lspace="0.170em" xref="A5.Ex20.m1.7.7.1.1.2.2.cmml">⁢</mo><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.2.cmml"><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.2.1.cmml">[</mo><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.cmml"><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.cmml"><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.3" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.3.cmml">κ</mi><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.2" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml">l</mi><mrow id="A5.Ex20.m1.5.5.1.3" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="A5.Ex20.m1.5.5.1.3.1" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="A5.Ex20.m1.5.5.1.1" xref="A5.Ex20.m1.5.5.1.1.cmml">i</mi><mo id="A5.Ex20.m1.5.5.1.3.2" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.3" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.3.cmml">+</mo><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.cmml"><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.3" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.3.cmml">κ</mi><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.2" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><msubsup id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml">w</mi><mi id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3" mathvariant="normal" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml">l</mi><mrow id="A5.Ex20.m1.6.6.1.3" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml"><mo id="A5.Ex20.m1.6.6.1.3.1" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">(</mo><mi id="A5.Ex20.m1.6.6.1.1" xref="A5.Ex20.m1.6.6.1.1.cmml">j</mi><mo id="A5.Ex20.m1.6.6.1.3.2" stretchy="false" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A5.Ex20.m1.7.7.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.Ex20.m1.7.7.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A5.Ex20.m1.7.7.1.2" lspace="0em" xref="A5.Ex20.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex20.m1.7b"><apply id="A5.Ex20.m1.7.7.1.1.cmml" xref="A5.Ex20.m1.7.7.1"><leq id="A5.Ex20.m1.7.7.1.1.3.cmml" xref="A5.Ex20.m1.7.7.1.1.3"></leq><apply id="A5.Ex20.m1.7.7.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="A5.Ex20.m1.7.7.1.1.1.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.2">delimited-∥∥</csymbol><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1"><minus id="A5.Ex20.m1.7.7.1.1.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.1"></minus><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2"><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.1">subscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.1.2">∇</ci><apply id="A5.Ex20.m1.1.1.1.cmml" xref="A5.Ex20.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.1.1.1.2.cmml" xref="A5.Ex20.m1.1.1.1">superscript</csymbol><apply id="A5.Ex20.m1.1.1.1.3.cmml" xref="A5.Ex20.m1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.1.1.1.3.1.cmml" xref="A5.Ex20.m1.1.1.1">subscript</csymbol><ci id="A5.Ex20.m1.1.1.1.3.2.cmml" xref="A5.Ex20.m1.1.1.1.3.2">𝑤</ci><ci id="A5.Ex20.m1.1.1.1.3.3.cmml" xref="A5.Ex20.m1.1.1.1.3.3">g</ci></apply><ci id="A5.Ex20.m1.1.1.1.1.1.1.cmml" xref="A5.Ex20.m1.1.1.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2">superscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.2.2.2">ℓ</ci><ci id="A5.Ex20.m1.2.2.1.1.cmml" xref="A5.Ex20.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.3.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3"><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.1.2">∇</ci><apply id="A5.Ex20.m1.3.3.1.cmml" xref="A5.Ex20.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.3.3.1.2.cmml" xref="A5.Ex20.m1.3.3.1">superscript</csymbol><apply id="A5.Ex20.m1.3.3.1.3.cmml" xref="A5.Ex20.m1.3.3.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.3.3.1.3.1.cmml" xref="A5.Ex20.m1.3.3.1">subscript</csymbol><ci id="A5.Ex20.m1.3.3.1.3.2.cmml" xref="A5.Ex20.m1.3.3.1.3.2">𝑤</ci><ci id="A5.Ex20.m1.3.3.1.3.3.cmml" xref="A5.Ex20.m1.3.3.1.3.3">g</ci></apply><ci id="A5.Ex20.m1.3.3.1.1.1.1.cmml" xref="A5.Ex20.m1.3.3.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2">superscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.1.1.1.3.2.2">ℓ</ci><ci id="A5.Ex20.m1.4.4.1.1.cmml" xref="A5.Ex20.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply><apply id="A5.Ex20.m1.7.7.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2"><times id="A5.Ex20.m1.7.7.1.1.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.2"></times><cn id="A5.Ex20.m1.7.7.1.1.2.3.cmml" type="integer" xref="A5.Ex20.m1.7.7.1.1.2.3">2</cn><ci id="A5.Ex20.m1.7.7.1.1.2.4.cmml" xref="A5.Ex20.m1.7.7.1.1.2.4">𝜏</ci><apply id="A5.Ex20.m1.7.7.1.1.2.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1"><csymbol cd="latexml" id="A5.Ex20.m1.7.7.1.1.2.1.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1"><plus id="A5.Ex20.m1.7.7.1.1.2.1.1.1.3.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.3"></plus><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1"><times id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.2"></times><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.3.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.3">𝜅</ci><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.1.1.1.1.2.3">l</ci></apply><ci id="A5.Ex20.m1.5.5.1.1.cmml" xref="A5.Ex20.m1.5.5.1.1">𝑖</ci></apply></apply><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2"><times id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.2"></times><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.3.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.3">𝜅</ci><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1">superscript</csymbol><apply id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.1.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1">subscript</csymbol><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.2">𝑤</ci><ci id="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3.cmml" xref="A5.Ex20.m1.7.7.1.1.2.1.1.1.2.1.1.1.2.3">l</ci></apply><ci id="A5.Ex20.m1.6.6.1.1.cmml" xref="A5.Ex20.m1.6.6.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex20.m1.7c">\Bigl{\|}\,\nabla_{w_{\mathrm{g}}^{(i)}}\ell^{(i)}-\nabla_{w_{\mathrm{g}}^{(j)%
}}\ell^{(j)}\Bigr{\|}\;\leq\;2\tau\,\bigl{[}\kappa\bigl{(}w_{\mathrm{l}}^{(i)}%
\bigr{)}+\kappa\bigl{(}w_{\mathrm{l}}^{(j)}\bigr{)}\bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="A5.Ex20.m1.7d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ ≤ 2 italic_τ [ italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) + italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS3.SSS2.p2.7">The second term depends on how different
<math alttext="J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.2.m1.2"><semantics id="A5.SS3.SSS2.p2.2.m1.2a"><mrow id="A5.SS3.SSS2.p2.2.m1.2.2" xref="A5.SS3.SSS2.p2.2.m1.2.2.cmml"><msub id="A5.SS3.SSS2.p2.2.m1.2.2.3" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.cmml"><mi id="A5.SS3.SSS2.p2.2.m1.2.2.3.2" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.2.cmml">J</mi><msub id="A5.SS3.SSS2.p2.2.m1.2.2.3.3" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.2" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.3" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.SS3.SSS2.p2.2.m1.2.2.2" xref="A5.SS3.SSS2.p2.2.m1.2.2.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.2.m1.2.2.1.1" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.2" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.2.m1.1.1.1.3" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.2.m1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.2.m1.1.1.1.1" xref="A5.SS3.SSS2.p2.2.m1.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.p2.2.m1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.2.m1.2b"><apply id="A5.SS3.SSS2.p2.2.m1.2.2.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2"><times id="A5.SS3.SSS2.p2.2.m1.2.2.2.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.2"></times><apply id="A5.SS3.SSS2.p2.2.m1.2.2.3.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.2.m1.2.2.3.1.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.2.m1.2.2.3.2.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.2">𝐽</ci><apply id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.1.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.2.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3.2">𝒯</ci><ci id="A5.SS3.SSS2.p2.2.m1.2.2.3.3.3.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1">superscript</csymbol><ci id="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.2.m1.2.2.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.2.m1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.2.m1.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.2.m1.2c">J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.2.m1.2d">italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> is from
<math alttext="J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.3.m2.2"><semantics id="A5.SS3.SSS2.p2.3.m2.2a"><mrow id="A5.SS3.SSS2.p2.3.m2.2.2" xref="A5.SS3.SSS2.p2.3.m2.2.2.cmml"><msub id="A5.SS3.SSS2.p2.3.m2.2.2.3" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.cmml"><mi id="A5.SS3.SSS2.p2.3.m2.2.2.3.2" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.2.cmml">J</mi><msub id="A5.SS3.SSS2.p2.3.m2.2.2.3.3" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.2" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.3" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.SS3.SSS2.p2.3.m2.2.2.2" xref="A5.SS3.SSS2.p2.3.m2.2.2.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.3.m2.2.2.1.1" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.2" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.3.m2.1.1.1.3" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.3.m2.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.3.m2.1.1.1.1" xref="A5.SS3.SSS2.p2.3.m2.1.1.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.3.m2.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.3.m2.2b"><apply id="A5.SS3.SSS2.p2.3.m2.2.2.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2"><times id="A5.SS3.SSS2.p2.3.m2.2.2.2.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.2"></times><apply id="A5.SS3.SSS2.p2.3.m2.2.2.3.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.3.m2.2.2.3.1.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.3.m2.2.2.3.2.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.2">𝐽</ci><apply id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.1.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.2.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3.2">𝒯</ci><ci id="A5.SS3.SSS2.p2.3.m2.2.2.3.3.3.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1">superscript</csymbol><ci id="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.3.m2.2.2.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.3.m2.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.3.m2.1.1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.3.m2.2c">J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.3.m2.2d">italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math>.
Under local Lipschitz assumptions on <math alttext="\mathcal{T}_{\phi}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.4.m3.1"><semantics id="A5.SS3.SSS2.p2.4.m3.1a"><msub id="A5.SS3.SSS2.p2.4.m3.1.1" xref="A5.SS3.SSS2.p2.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS2.p2.4.m3.1.1.2" xref="A5.SS3.SSS2.p2.4.m3.1.1.2.cmml">𝒯</mi><mi id="A5.SS3.SSS2.p2.4.m3.1.1.3" xref="A5.SS3.SSS2.p2.4.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.4.m3.1b"><apply id="A5.SS3.SSS2.p2.4.m3.1.1.cmml" xref="A5.SS3.SSS2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.4.m3.1.1.1.cmml" xref="A5.SS3.SSS2.p2.4.m3.1.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.4.m3.1.1.2.cmml" xref="A5.SS3.SSS2.p2.4.m3.1.1.2">𝒯</ci><ci id="A5.SS3.SSS2.p2.4.m3.1.1.3.cmml" xref="A5.SS3.SSS2.p2.4.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.4.m3.1c">\mathcal{T}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.4.m3.1d">caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>,
<math alttext="\bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}-J_{%
\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}\bigr{\|}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.5.m4.3"><semantics id="A5.SS3.SSS2.p2.5.m4.3a"><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.2.cmml"><mo fence="true" id="A5.SS3.SSS2.p2.5.m4.3.3.1.2" mathsize="120%" rspace="0.170em" xref="A5.SS3.SSS2.p2.5.m4.3.3.2.1.cmml">∥</mo><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.cmml"><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.cmml"><msub id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.cmml"><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.2.cmml">J</mi><msub id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.5.m4.1.1.1.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.5.m4.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.5.m4.1.1.1.1" xref="A5.SS3.SSS2.p2.5.m4.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.p2.5.m4.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.3.cmml">−</mo><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.cmml"><msub id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.cmml"><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.2.cmml">J</mi><msub id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.2.cmml">𝒯</mi><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.3.cmml">ϕ</mi></msub></msub><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml">(</mo><msup id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.2" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.5.m4.2.2.1.3" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.5.m4.2.2.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.5.m4.2.2.1.1" xref="A5.SS3.SSS2.p2.5.m4.2.2.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.5.m4.2.2.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo fence="true" id="A5.SS3.SSS2.p2.5.m4.3.3.1.3" lspace="0em" mathsize="120%" xref="A5.SS3.SSS2.p2.5.m4.3.3.2.1.cmml">∥</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.5.m4.3b"><apply id="A5.SS3.SSS2.p2.5.m4.3.3.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1"><csymbol cd="latexml" id="A5.SS3.SSS2.p2.5.m4.3.3.2.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.2">delimited-∥∥</csymbol><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1"><minus id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.3"></minus><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1"><times id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.2"></times><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.2">𝐽</ci><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.2">𝒯</ci><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1">superscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.1.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.5.m4.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.1.1.1.1">𝑖</ci></apply></apply><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2"><times id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.2"></times><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.2">𝐽</ci><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3">subscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.2">𝒯</ci><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.3.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1">superscript</csymbol><ci id="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.5.m4.3.3.1.1.2.1.1.1.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.5.m4.2.2.1.1.cmml" xref="A5.SS3.SSS2.p2.5.m4.2.2.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.5.m4.3c">\bigl{\|}\,J_{\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(i)}\bigr{)}-J_{%
\mathcal{T}_{\phi}}\!\bigl{(}\mathbf{p}^{(j)}\bigr{)}\bigr{\|}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.5.m4.3d">∥ italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) - italic_J start_POSTSUBSCRIPT caligraphic_T start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) ∥</annotation></semantics></math>
can be bounded by some <math alttext="L^{\prime}\,\|\mathbf{p}^{(i)}-\mathbf{p}^{(j)}\|" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.6.m5.3"><semantics id="A5.SS3.SSS2.p2.6.m5.3a"><mrow id="A5.SS3.SSS2.p2.6.m5.3.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.cmml"><msup id="A5.SS3.SSS2.p2.6.m5.3.3.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.3.cmml"><mi id="A5.SS3.SSS2.p2.6.m5.3.3.3.2" xref="A5.SS3.SSS2.p2.6.m5.3.3.3.2.cmml">L</mi><mo id="A5.SS3.SSS2.p2.6.m5.3.3.3.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.3.3.cmml">′</mo></msup><mo id="A5.SS3.SSS2.p2.6.m5.3.3.2" lspace="0.170em" xref="A5.SS3.SSS2.p2.6.m5.3.3.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.6.m5.3.3.1.1" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.2.cmml"><mo id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.2" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.2.1.cmml">‖</mo><mrow id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.cmml"><msup id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.cmml"><mi id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.2" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.6.m5.1.1.1.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.cmml"><mo id="A5.SS3.SSS2.p2.6.m5.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.cmml">(</mo><mi id="A5.SS3.SSS2.p2.6.m5.1.1.1.1" xref="A5.SS3.SSS2.p2.6.m5.1.1.1.1.cmml">i</mi><mo id="A5.SS3.SSS2.p2.6.m5.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.cmml">)</mo></mrow></msup><mo id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.1" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.1.cmml">−</mo><msup id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.cmml"><mi id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.2" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.2.cmml">𝐩</mi><mrow id="A5.SS3.SSS2.p2.6.m5.2.2.1.3" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.cmml"><mo id="A5.SS3.SSS2.p2.6.m5.2.2.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.cmml">(</mo><mi id="A5.SS3.SSS2.p2.6.m5.2.2.1.1" xref="A5.SS3.SSS2.p2.6.m5.2.2.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.6.m5.2.2.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.3" stretchy="false" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.6.m5.3b"><apply id="A5.SS3.SSS2.p2.6.m5.3.3.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3"><times id="A5.SS3.SSS2.p2.6.m5.3.3.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.2"></times><apply id="A5.SS3.SSS2.p2.6.m5.3.3.3.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.6.m5.3.3.3.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.3">superscript</csymbol><ci id="A5.SS3.SSS2.p2.6.m5.3.3.3.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.3.2">𝐿</ci><ci id="A5.SS3.SSS2.p2.6.m5.3.3.3.3.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.3.3">′</ci></apply><apply id="A5.SS3.SSS2.p2.6.m5.3.3.1.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1"><csymbol cd="latexml" id="A5.SS3.SSS2.p2.6.m5.3.3.1.2.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.2">norm</csymbol><apply id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1"><minus id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.1"></minus><apply id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2">superscript</csymbol><ci id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.2.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.6.m5.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.1.1.1.1">𝑖</ci></apply><apply id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3">superscript</csymbol><ci id="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.2.cmml" xref="A5.SS3.SSS2.p2.6.m5.3.3.1.1.1.3.2">𝐩</ci><ci id="A5.SS3.SSS2.p2.6.m5.2.2.1.1.cmml" xref="A5.SS3.SSS2.p2.6.m5.2.2.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.6.m5.3c">L^{\prime}\,\|\mathbf{p}^{(i)}-\mathbf{p}^{(j)}\|</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.6.m5.3d">italic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ bold_p start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - bold_p start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥</annotation></semantics></math>, and
<math alttext="\|\nabla_{w_{\mathrm{g}}^{(j)}}\,\ell^{(j)}\|\leq 2\,\tau\,\kappa\bigl{(}w_{%
\mathrm{l}}^{(j)}\bigr{)}" class="ltx_Math" display="inline" id="A5.SS3.SSS2.p2.7.m6.5"><semantics id="A5.SS3.SSS2.p2.7.m6.5a"><mrow id="A5.SS3.SSS2.p2.7.m6.5.5" xref="A5.SS3.SSS2.p2.7.m6.5.5.cmml"><mrow id="A5.SS3.SSS2.p2.7.m6.4.4.1.1" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.2.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.2" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.2.1.cmml">‖</mo><mrow id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.cmml"><msub id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.2" rspace="0.167em" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.2.cmml">∇</mo><msubsup id="A5.SS3.SSS2.p2.7.m6.1.1.1" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.2" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.3.2.cmml">w</mi><mi id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.3" mathvariant="normal" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.3.3.cmml">g</mi><mrow id="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.3" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.1" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.cmml">)</mo></mrow></msubsup></msub><msup id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.cmml"><mi id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.2" mathvariant="normal" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.2.cmml">ℓ</mi><mrow id="A5.SS3.SSS2.p2.7.m6.2.2.1.3" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.2.2.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.cmml">(</mo><mi id="A5.SS3.SSS2.p2.7.m6.2.2.1.1" xref="A5.SS3.SSS2.p2.7.m6.2.2.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.7.m6.2.2.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.cmml">)</mo></mrow></msup></mrow><mo id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.3" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.2.1.cmml">‖</mo></mrow><mo id="A5.SS3.SSS2.p2.7.m6.5.5.3" xref="A5.SS3.SSS2.p2.7.m6.5.5.3.cmml">≤</mo><mrow id="A5.SS3.SSS2.p2.7.m6.5.5.2" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.cmml"><mn id="A5.SS3.SSS2.p2.7.m6.5.5.2.3" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.3.cmml">2</mn><mo id="A5.SS3.SSS2.p2.7.m6.5.5.2.2" lspace="0.170em" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.2.cmml">⁢</mo><mi id="A5.SS3.SSS2.p2.7.m6.5.5.2.4" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.4.cmml">τ</mi><mo id="A5.SS3.SSS2.p2.7.m6.5.5.2.2a" lspace="0.170em" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.2.cmml">⁢</mo><mi id="A5.SS3.SSS2.p2.7.m6.5.5.2.5" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.5.cmml">κ</mi><mo id="A5.SS3.SSS2.p2.7.m6.5.5.2.2b" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.2.cmml">⁢</mo><mrow id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.2" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml">(</mo><msubsup id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml"><mi id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.2" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.2.cmml">w</mi><mi id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.3" mathvariant="normal" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.3.cmml">l</mi><mrow id="A5.SS3.SSS2.p2.7.m6.3.3.1.3" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml"><mo id="A5.SS3.SSS2.p2.7.m6.3.3.1.3.1" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml">(</mo><mi id="A5.SS3.SSS2.p2.7.m6.3.3.1.1" xref="A5.SS3.SSS2.p2.7.m6.3.3.1.1.cmml">j</mi><mo id="A5.SS3.SSS2.p2.7.m6.3.3.1.3.2" stretchy="false" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.3" maxsize="120%" minsize="120%" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.SSS2.p2.7.m6.5b"><apply id="A5.SS3.SSS2.p2.7.m6.5.5.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5"><leq id="A5.SS3.SSS2.p2.7.m6.5.5.3.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.3"></leq><apply id="A5.SS3.SSS2.p2.7.m6.4.4.1.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1"><csymbol cd="latexml" id="A5.SS3.SSS2.p2.7.m6.4.4.1.2.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.2">norm</csymbol><apply id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1"><apply id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.1.2">∇</ci><apply id="A5.SS3.SSS2.p2.7.m6.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1">superscript</csymbol><apply id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.3.2">𝑤</ci><ci id="A5.SS3.SSS2.p2.7.m6.1.1.1.3.3.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.3.3">g</ci></apply><ci id="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.1.1.1.1.1.1">𝑗</ci></apply></apply><apply id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2">superscript</csymbol><ci id="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.4.4.1.1.1.2.2">ℓ</ci><ci id="A5.SS3.SSS2.p2.7.m6.2.2.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="A5.SS3.SSS2.p2.7.m6.5.5.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2"><times id="A5.SS3.SSS2.p2.7.m6.5.5.2.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.2"></times><cn id="A5.SS3.SSS2.p2.7.m6.5.5.2.3.cmml" type="integer" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.3">2</cn><ci id="A5.SS3.SSS2.p2.7.m6.5.5.2.4.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.4">𝜏</ci><ci id="A5.SS3.SSS2.p2.7.m6.5.5.2.5.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.5">𝜅</ci><apply id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1">superscript</csymbol><apply id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1"><csymbol cd="ambiguous" id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1">subscript</csymbol><ci id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.2.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.2">𝑤</ci><ci id="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.3.cmml" xref="A5.SS3.SSS2.p2.7.m6.5.5.2.1.1.1.2.3">l</ci></apply><ci id="A5.SS3.SSS2.p2.7.m6.3.3.1.1.cmml" xref="A5.SS3.SSS2.p2.7.m6.3.3.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.SSS2.p2.7.m6.5c">\|\nabla_{w_{\mathrm{g}}^{(j)}}\,\ell^{(j)}\|\leq 2\,\tau\,\kappa\bigl{(}w_{%
\mathrm{l}}^{(j)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A5.SS3.SSS2.p2.7.m6.5d">∥ ∇ start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT roman_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_ℓ start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∥ ≤ 2 italic_τ italic_κ ( italic_w start_POSTSUBSCRIPT roman_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A5.SS3.SSS2.p3">
<p class="ltx_p" id="A5.SS3.SSS2.p3.1">Hence, a final inequality takes the schematic form:</p>
