<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Deep Active Inference Agents for Delayed and Long-Horizon Environments</title>
<!--Generated on Mon May 26 11:15:56 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.19867v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S1" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.SS1" title="In 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Formalism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.SS2" title="In 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Planning Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S3" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Deep Active Inference Agent</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S3.SS1" title="In 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S3.SS2" title="In 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Policy Optimization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S3.SS2.SSS1" title="In 3.2 Policy Optimization ‣ 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Training &amp; Planning</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.SS1" title="In 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Application</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.SS2" title="In 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.SS2.SSS1" title="In 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Effect of Depth</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S5" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Application</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.SS1" title="In Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Energy-Efficiency Control</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.SS2" title="In Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>System Description</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.SS2.SSS1" title="In A.2 System Description ‣ Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Modeling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.SS3" title="In Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Preference Mapping</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A2" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Agent</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A2.SS1" title="In Appendix B Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A2.SS1.SSS1" title="In B.1 Setup ‣ Appendix B Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1.1 </span>Observation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A2.SS1.SSS2" title="In B.1 Setup ‣ Appendix B Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1.2 </span>Reconstruction Loss</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A3" title="In Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A3.SS1" title="In Appendix C Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Code</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A3.SS2" title="In Appendix C Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Training and Evaluation Procedure</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Deep Active Inference Agents for Delayed and Long-Horizon Environments
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yavar Taheri Yeganeh 
<br class="ltx_break"/>Politecnico di Milano 
<br class="ltx_break"/>Mohsen Jafari 
<br class="ltx_break"/>Rutgers University 
<br class="ltx_break"/>Andrea Matta 
<br class="ltx_break"/>Politecnico di Milano 
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Email: yavar.taheri@polimi.it or yavaryeganeh@gmail.com</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">With the recent success of <em class="ltx_emph ltx_font_italic" id="id1.id1.1">world-model</em> agents—which extend the core idea of model-based reinforcement learning by learning a differentiable model for sample-efficient control across diverse tasks—<em class="ltx_emph ltx_font_italic" id="id1.id1.2">active inference</em> (AIF) offers a complementary, neuroscience-grounded paradigm that unifies perception, learning, and action within a single probabilistic framework powered by a generative model. Despite this promise, practical AIF agents still rely on accurate <em class="ltx_emph ltx_font_italic" id="id1.id1.3">immediate</em> predictions and exhaustive planning, a limitation that is exacerbated in <em class="ltx_emph ltx_font_italic" id="id1.id1.4">delayed</em> environments requiring planning over <em class="ltx_emph ltx_font_italic" id="id1.id1.5">long horizons</em>—tens to hundreds of steps. Moreover, most existing agents are evaluated on robotic or vision benchmarks which, while natural for biological agents, fall short of real-world industrial complexity. We address these limitations with a generative–policy architecture featuring (i) a <em class="ltx_emph ltx_font_italic" id="id1.id1.6">multi-step latent transition</em> that lets the generative model predict an entire horizon in a single look-ahead, (ii) an integrated policy network that enables the transition and receives gradients of the expected free energy, (iii) an alternating optimization scheme that updates model and policy from a replay buffer, and (iv) a single gradient step that plans over long horizons, eliminating exhaustive planning from the control loop. We evaluate our agent in an environment that mimics a realistic industrial scenario with delayed and long-horizon settings. The empirical results confirm the effectiveness of the proposed approach, demonstrating the coupled world-model with the AIF formalism yields an end-to-end probabilistic controller capable of effective decision making in delayed, long-horizon settings without handcrafted rewards or expensive planning.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">There has been significant progress in data-driven decision-making algorithms, particularly in reinforcement learning (RL), where agents learn policies through interaction with the environment and receive feedback  <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib1" title="">sutton2018reinforcement </a></cite>. Deep learning, in parallel, offers a powerful framework for extracting representations and patterns, while also enabling probabilistic modeling <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib2" title="">lecun2015deep </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib3" title="">bishop2024learning </a></cite>, driving advancements in computer vision, natural language processing, biomedical applications, finance, and robotics. Deep RL merges these ideas—for example, by using neural function approximation in Deep Q-Networks (DQN), which achieved human-level performance on Atari games <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib4" title="">mnih2015human </a></cite>. Model-based RL (MBRL) goes further by explicitly incorporating a model—either learned or provided—of the environment to guide learning and planning <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib5" title="">moerland2023model </a></cite>. Similarly, the concept of world models centers on learning generative models of the environment to exploit representations and predictions of future outcomes, especially for decision-making <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a></cite>. This resonates with cognitive theories of the biological brain, which emphasize the role of internal generative models <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib7" title="">friston2021world </a></cite>. At a broader theoretical level, active inference (AIF), an emerging field in neuroscience, unifies perception, action, and learning in biological agents through the use of internal generative models <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib8" title="">friston2017active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a></cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">AIF is grounded in the free energy principle (FEP), which formulates neural inference and learning under uncertainty as minimization of <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">surprise</em> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib10" title="">friston2010free </a></cite>. It provides a coherent mathematical framework that calibrates a probabilistic model governed by Bayesian inference, enabling both learning and goal-directed action directly from raw sensory inputs (i.e., <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">observations</em>) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a></cite>. This can support the development of model-driven, adaptive agents that are trained end-to-end while offering uncertainty quantification and some interpretability <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. Similar to world models and model-based RL, AIF is powered by an internal model of the environment, which can help to capture dynamics and boost sample efficiency. Despite the potential of the AIF framework, its practical agents typically rely on accurate immediate predictions and extensive planning <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. Such reliance can hinder performance, particularly in <em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">delayed</em> environments, where the consequences of actions are not immediately observable—commonly framed in RL as <em class="ltx_emph ltx_font_italic" id="S1.p2.1.4">sparse rewards</em>, which exacerbates the credit-assignment problem <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib1" title="">sutton2018reinforcement </a></cite>. Likewise, <em class="ltx_emph ltx_font_italic" id="S1.p2.1.5">long-horizon</em> tasks demand effective planning over extended temporal horizons, posing an additional challenge. These difficulties appear across diverse optimization tasks—such as manufacturing systems <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite>, robotics <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>, and protein design <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib15" title="">angermueller2019model </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib16" title="">wang2024fine </a></cite>—where the consequences become apparent only after many steps or upon completion of the entire process.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We explore how the potential of the AIF framework can be harnessed to build agents that remain effective in environments that are delayed and demanding long-horizon planning. Recent advances in deep generative modeling <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib17" title="">tomczak2024deep </a></cite> have unlocked breakthroughs across diverse domains—such as AlphaFold’s high-accuracy protein-structure predictions <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib18" title="">abramson2024accurate </a></cite>. Because the generative model is the core of AIF, our objective is to extend its capacity and fidelity as the world model by predicting deep into the future. Concretely, we propose a generative model with an integrated policy network, trained end-to-end under the AIF formalism, allowing the model to produce long-horizon roll-outs and supply gradient signals to the policy during optimization. The summary of our contributions is as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce an AIF-consistent generative–policy architecture that enables long-horizon predictions while providing differentiable signals to the policy.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We derive a joint training algorithm that alternately updates the generative model and the policy network, and we show how the learned model can be leveraged during planning via gradient updates to the policy.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We empirically demonstrate the concept’s effectiveness in an industrial environment, highlighting its relevance to delayed and long-horizon scenarios.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The remainder of the paper is organized as follows: Section 2 reviews the formalism and planning strategies. Section 3 presents our proposed concept and agent architecture, while Section 4 details the experimental results. Finally, Section 5 concludes with implications and outlines future directions.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Agents based on the world models concept extend the core idea of MBRL, learning a differentiable predictive model to facilitate policy optimization and planning via <em class="ltx_emph ltx_font_italic" id="S2.p1.1.1">imaginations</em> in the model <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib19" title="">ha2018world </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a></cite>. They create latent representations that capture spatial and temporal aspects to model dynamics and predict the future <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib19" title="">ha2018world </a></cite>.
The architecture governing this dynamics—generative model—and how it is leveraged for policy and planning is foundational in this concept. Many designs resemble variational autoencoder <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib20" title="">kingma2013auto </a></cite> and are often augmented with Recurrent State-Space Models (RSSMs) to provide memory and help with credit assignment <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib21" title="">hafner2019learning </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>. At the same time, RL methods such as actor–critic <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib1" title="">sutton2018reinforcement </a></cite> are integrated with the model to optimize the policy <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>, yielding sample-efficient agents that rely on imagination rather than extensive environment interaction.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">AIF offers a complementary, neuroscience-grounded perspective that subsumes predictive coding that postulates that the brain minimizes prediction errors—relative to an internal generative model of the world—under uncertainty <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib22" title="">millidge2022predictive </a></cite>. It casts the brain as a hierarchy that performs variational Bayesian inference continuously to suppress prediction error <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a></cite>. It was originally advanced to explain how organisms actively control and navigate their environments by iteratively updating beliefs and inferring actions from sensory observations <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a></cite>. AIF emphasizes the dependency of observations on actions <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib22" title="">millidge2022predictive </a></cite>; accordingly, it posits that actions are chosen, while calibrating the model, to align with preferences and reduce uncertainty, thereby unifying perception, action, and learning <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib22" title="">millidge2022predictive </a></cite>. The free-energy principle provides the mathematical bedrock for this framework <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib23" title="">friston2010action </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib24" title="">millidge2021applications </a></cite>, and a growing body of empirical work supports its biological plausibility <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib25" title="">isomura2023experimental </a></cite>. AIF-based agents have been deployed in robotics, autonomous driving, and clinical decision support <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib26" title="">pezzato2023active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib27" title="">schneider2022active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib28" title="">huang2024navigating </a></cite>, demonstrating robust performance in uncertain, dynamic settings. In this work, we adopt the AIF formulation of Fountas et al. (2020) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>, which was extended in <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib29" title="">da2022active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite> and has been shown to result in effective agents across different environments—such as visual and industrial tasks.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Formalism</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">Within AIF, agents employ an integrated probabilistic framework consisting of an internal generative model <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib30" title="">da2023reward </a></cite> with inference mechanisms that allow them to represent and act upon the world. The framework assumes a Partially Observable Markov Decision Process <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib31" title="">kaelbling1998planning </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib30" title="">da2023reward </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib32" title="">paul2023efficient </a></cite>, where an agent’s interaction with its environment is formalized in terms of three random variables—observation, latent state, and action—denoted <math alttext="(o_{t},s_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.3"><semantics id="S2.SS1.p1.1.m1.3a"><mrow id="S2.SS1.p1.1.m1.3.3.3" xref="S2.SS1.p1.1.m1.3.3.4.cmml"><mo id="S2.SS1.p1.1.m1.3.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.3.3.4.cmml">(</mo><msub id="S2.SS1.p1.1.m1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS1.p1.1.m1.1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p1.1.m1.3.3.3.5" xref="S2.SS1.p1.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.2.2.2.2" xref="S2.SS1.p1.1.m1.2.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.2.2.2.2.2" xref="S2.SS1.p1.1.m1.2.2.2.2.2.cmml">s</mi><mi id="S2.SS1.p1.1.m1.2.2.2.2.3" xref="S2.SS1.p1.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS1.p1.1.m1.3.3.3.6" xref="S2.SS1.p1.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.3.3.3.3" xref="S2.SS1.p1.1.m1.3.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.3.3.3.3.2" xref="S2.SS1.p1.1.m1.3.3.3.3.2.cmml">a</mi><mi id="S2.SS1.p1.1.m1.3.3.3.3.3" xref="S2.SS1.p1.1.m1.3.3.3.3.3.cmml">t</mi></msub><mo id="S2.SS1.p1.1.m1.3.3.3.7" stretchy="false" xref="S2.SS1.p1.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.3b"><vector id="S2.SS1.p1.1.m1.3.3.4.cmml" xref="S2.SS1.p1.1.m1.3.3.3"><apply id="S2.SS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.2">𝑜</ci><ci id="S2.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS1.p1.1.m1.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2.2.2.2">𝑠</ci><ci id="S2.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S2.SS1.p1.1.m1.2.2.2.2.3">𝑡</ci></apply><apply id="S2.SS1.p1.1.m1.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.3.3.3.3.2">𝑎</ci><ci id="S2.SS1.p1.1.m1.3.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.3.3.3.3.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.3c">(o_{t},s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.3d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> at time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_t</annotation></semantics></math>. In contrast to RL, this formalism does not rely on explicit reward feedback from the environment; instead, the agent learns solely from the sequence of observations it receives. The agent’s generative model, parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_θ</annotation></semantics></math>, is defined over trajectories as <math alttext="P_{\theta}(o_{1:t},s_{1:t},a_{1:t-1})" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.3"><semantics id="S2.SS1.p1.4.m4.3a"><mrow id="S2.SS1.p1.4.m4.3.3" xref="S2.SS1.p1.4.m4.3.3.cmml"><msub id="S2.SS1.p1.4.m4.3.3.5" xref="S2.SS1.p1.4.m4.3.3.5.cmml"><mi id="S2.SS1.p1.4.m4.3.3.5.2" xref="S2.SS1.p1.4.m4.3.3.5.2.cmml">P</mi><mi id="S2.SS1.p1.4.m4.3.3.5.3" xref="S2.SS1.p1.4.m4.3.3.5.3.cmml">θ</mi></msub><mo id="S2.SS1.p1.4.m4.3.3.4" xref="S2.SS1.p1.4.m4.3.3.4.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m4.3.3.3.3" xref="S2.SS1.p1.4.m4.3.3.3.4.cmml"><mo id="S2.SS1.p1.4.m4.3.3.3.3.4" stretchy="false" xref="S2.SS1.p1.4.m4.3.3.3.4.cmml">(</mo><msub id="S2.SS1.p1.4.m4.1.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml">o</mi><mrow id="S2.SS1.p1.4.m4.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml"><mn id="S2.SS1.p1.4.m4.1.1.1.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.p1.4.m4.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.3.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p1.4.m4.3.3.3.3.5" xref="S2.SS1.p1.4.m4.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.2.2.2.2.2" xref="S2.SS1.p1.4.m4.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.4.m4.2.2.2.2.2.2" xref="S2.SS1.p1.4.m4.2.2.2.2.2.2.cmml">s</mi><mrow id="S2.SS1.p1.4.m4.2.2.2.2.2.3" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.cmml"><mn id="S2.SS1.p1.4.m4.2.2.2.2.2.3.2" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.2.cmml">1</mn><mo id="S2.SS1.p1.4.m4.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.SS1.p1.4.m4.2.2.2.2.2.3.3" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p1.4.m4.3.3.3.3.6" xref="S2.SS1.p1.4.m4.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.3.3.3.3.3" xref="S2.SS1.p1.4.m4.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.3.3.3.3.3.2" xref="S2.SS1.p1.4.m4.3.3.3.3.3.2.cmml">a</mi><mrow id="S2.SS1.p1.4.m4.3.3.3.3.3.3" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.cmml"><mn id="S2.SS1.p1.4.m4.3.3.3.3.3.3.2" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.2.cmml">1</mn><mo id="S2.SS1.p1.4.m4.3.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.1.cmml">:</mo><mrow id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.2" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.2.cmml">t</mi><mo id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.1" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.1.cmml">−</mo><mn id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.3" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.SS1.p1.4.m4.3.3.3.3.7" stretchy="false" xref="S2.SS1.p1.4.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.3b"><apply id="S2.SS1.p1.4.m4.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3"><times id="S2.SS1.p1.4.m4.3.3.4.cmml" xref="S2.SS1.p1.4.m4.3.3.4"></times><apply id="S2.SS1.p1.4.m4.3.3.5.cmml" xref="S2.SS1.p1.4.m4.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.5.1.cmml" xref="S2.SS1.p1.4.m4.3.3.5">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.5.2.cmml" xref="S2.SS1.p1.4.m4.3.3.5.2">𝑃</ci><ci id="S2.SS1.p1.4.m4.3.3.5.3.cmml" xref="S2.SS1.p1.4.m4.3.3.5.3">𝜃</ci></apply><vector id="S2.SS1.p1.4.m4.3.3.3.4.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3"><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2">𝑜</ci><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3"><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.1">:</ci><cn id="S2.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2.2">𝑠</ci><apply id="S2.SS1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3"><ci id="S2.SS1.p1.4.m4.2.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.1">:</ci><cn id="S2.SS1.p1.4.m4.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.2">1</cn><ci id="S2.SS1.p1.4.m4.2.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.4.m4.2.2.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S2.SS1.p1.4.m4.3.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.2">𝑎</ci><apply id="S2.SS1.p1.4.m4.3.3.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3"><ci id="S2.SS1.p1.4.m4.3.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.1">:</ci><cn id="S2.SS1.p1.4.m4.3.3.3.3.3.3.2.cmml" type="integer" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.2">1</cn><apply id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3"><minus id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.1"></minus><ci id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.2">𝑡</ci><cn id="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.3.3.3.3.3.3.3.3">1</cn></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.3c">P_{\theta}(o_{1:t},s_{1:t},a_{1:t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.3d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> up to time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_t</annotation></semantics></math>. The agent’s behavior is driven by the imperative to minimize <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.6.1">surprise</em>, which is formulated as the negative log-evidence for the current observation, <math alttext="-\log P_{\theta}(o_{t})" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mo id="S2.SS1.p1.6.m6.1.1a" rspace="0.167em" xref="S2.SS1.p1.6.m6.1.1.cmml">−</mo><mrow id="S2.SS1.p1.6.m6.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.cmml"><mrow id="S2.SS1.p1.6.m6.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.3.1" xref="S2.SS1.p1.6.m6.1.1.1.3.1.cmml">log</mi><mo id="S2.SS1.p1.6.m6.1.1.1.3a" lspace="0.167em" xref="S2.SS1.p1.6.m6.1.1.1.3.cmml">⁡</mo><msub id="S2.SS1.p1.6.m6.1.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.1.3.2.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.3.2.2" xref="S2.SS1.p1.6.m6.1.1.1.3.2.2.cmml">P</mi><mi id="S2.SS1.p1.6.m6.1.1.1.3.2.3" xref="S2.SS1.p1.6.m6.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S2.SS1.p1.6.m6.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.6.m6.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.6.m6.1.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><minus id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1"></minus><apply id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1"><times id="S2.SS1.p1.6.m6.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.2"></times><apply id="S2.SS1.p1.6.m6.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3"><log id="S2.SS1.p1.6.m6.1.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3.1"></log><apply id="S2.SS1.p1.6.m6.1.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.3.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.3.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3.2.2">𝑃</ci><ci id="S2.SS1.p1.6.m6.1.1.1.3.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">-\log P_{\theta}(o_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">- roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. The agent approaches this imperative from two perspectives when interacting with the world, as follows <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>:</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">1) Using the current observation, the agent calibrates its generative model by optimizing the parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_θ</annotation></semantics></math> to yield more accurate predictions. Mathematically, this surprise can be expanded as follows <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib20" title="">kingma2013auto </a></cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-\log P_{\theta}(o_{t})\leq\mathbb{E}_{Q_{\phi}(s_{t},a_{t})}\left[\log Q_{%
\phi}(s_{t},a_{t})-\log P_{\theta}(o_{t},s_{t},a_{t})\right]\ ," class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1a" rspace="0.167em" xref="S2.E1.m1.3.3.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.1.1.3a" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E1.m1.3.3.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">≤</mo><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><msub id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml"><mi id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.2.cmml">Q</mi><mi id="S2.E1.m1.2.2.2.4.3" xref="S2.E1.m1.2.2.2.4.3.cmml">ϕ</mi></msub><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.3.cmml"><mo id="S2.E1.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E1.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></msub><mo id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1" xref="S2.E1.m1.3.3.1.1.2.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.2.1.1.2" xref="S2.E1.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.1.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4a" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.cmml">⁡</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.2.cmml">Q</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.3.cmml">ϕ</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.3.cmml"><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.4" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.5" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.6" xref="S2.E1.m1.3.3.1.1.2.1.1.1.6.cmml">−</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.5" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.1.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5a" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.cmml">⁡</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.2.cmml">P</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.3.cmml">θ</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.4" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.4.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml"><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.4" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml">(</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.2.cmml">o</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.5" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.2.cmml">s</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.6" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.2" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.2.cmml">a</mi><mi id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.3" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.3.cmml">t</mi></msub><mo id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.7" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.2.1.1.3" rspace="0.500em" xref="S2.E1.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><leq id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"></leq><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><minus id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3"><log id="S2.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.1"></log><apply id="S2.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"></times><apply id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2">𝔼</ci><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><times id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"></times><apply id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.4.2">𝑄</ci><ci id="S2.E1.m1.2.2.2.4.3.cmml" xref="S2.E1.m1.2.2.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2"><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2">𝑎</ci><ci id="S2.E1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.2.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1"><minus id="S2.E1.m1.3.3.1.1.2.1.1.1.6.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.6"></minus><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.3"></times><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4"><log id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.1"></log><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.2">𝑄</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.4.2.3">italic-ϕ</ci></apply></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2"><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.5.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5"><times id="S2.E1.m1.3.3.1.1.2.1.1.1.5.4.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.4"></times><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5"><log id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.1"></log><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.2">𝑃</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.5.2.3">𝜃</ci></apply></apply><vector id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.4.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3"><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.2">𝑜</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.3.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.2">𝑠</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.4.2.2.2.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.2">𝑎</ci><ci id="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1.5.3.3.3.3">𝑡</ci></apply></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">-\log P_{\theta}(o_{t})\leq\mathbb{E}_{Q_{\phi}(s_{t},a_{t})}\left[\log Q_{%
\phi}(s_{t},a_{t})-\log P_{\theta}(o_{t},s_{t},a_{t})\right]\ ,</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">- roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≤ blackboard_E start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ roman_log italic_Q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.2">which provides an upper bound, commonly known as the negative Evidence Lower Bound (ELBO) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib33" title="">blei2017variational </a></cite>. It is widely used as a loss function for training variational autoencoders <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib20" title="">kingma2013auto </a></cite>. In AIF, it corresponds to the Variational Free Energy (VFE), whose minimization reduces the surprise associated with predictions relative to actual observations <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib34" title="">sajid2022bayesian </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib32" title="">paul2023efficient </a></cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.3">2) Looking into the future, where the agent needs to plan actions, an estimate of the surprise of future predictions can be obtained. Considering a sequence of actions—or policy—denoted as <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mi id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_π</annotation></semantics></math>, for <math alttext="\tau\geq t" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mrow id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">τ</mi><mo id="S2.SS1.p3.2.m2.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.cmml">≥</mo><mi id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><geq id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"></geq><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝜏</ci><ci id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">\tau\geq t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_τ ≥ italic_t</annotation></semantics></math>, this corresponds to <math alttext="-\log P(o_{\tau}|\theta,\pi)" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.3"><semantics id="S2.SS1.p3.3.m3.3a"><mrow id="S2.SS1.p3.3.m3.3.3" xref="S2.SS1.p3.3.m3.3.3.cmml"><mo id="S2.SS1.p3.3.m3.3.3a" rspace="0.167em" xref="S2.SS1.p3.3.m3.3.3.cmml">−</mo><mrow id="S2.SS1.p3.3.m3.3.3.1" xref="S2.SS1.p3.3.m3.3.3.1.cmml"><mrow id="S2.SS1.p3.3.m3.3.3.1.3" xref="S2.SS1.p3.3.m3.3.3.1.3.cmml"><mi id="S2.SS1.p3.3.m3.3.3.1.3.1" xref="S2.SS1.p3.3.m3.3.3.1.3.1.cmml">log</mi><mo id="S2.SS1.p3.3.m3.3.3.1.3a" lspace="0.167em" xref="S2.SS1.p3.3.m3.3.3.1.3.cmml">⁡</mo><mi id="S2.SS1.p3.3.m3.3.3.1.3.2" xref="S2.SS1.p3.3.m3.3.3.1.3.2.cmml">P</mi></mrow><mo id="S2.SS1.p3.3.m3.3.3.1.2" xref="S2.SS1.p3.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.3.m3.3.3.1.1.1" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.cmml"><mo id="S2.SS1.p3.3.m3.3.3.1.1.1.2" stretchy="false" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.3.m3.3.3.1.1.1.1" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.cmml"><msub id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.cmml"><mi id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.2" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.2.cmml">o</mi><mi id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.3" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.SS1.p3.3.m3.3.3.1.1.1.1.1" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.2" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">θ</mi><mo id="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.2.1" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S2.SS1.p3.3.m3.2.2" xref="S2.SS1.p3.3.m3.2.2.cmml">π</mi></mrow></mrow><mo id="S2.SS1.p3.3.m3.3.3.1.1.1.3" stretchy="false" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.3b"><apply id="S2.SS1.p3.3.m3.3.3.cmml" xref="S2.SS1.p3.3.m3.3.3"><minus id="S2.SS1.p3.3.m3.3.3.2.cmml" xref="S2.SS1.p3.3.m3.3.3"></minus><apply id="S2.SS1.p3.3.m3.3.3.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1"><times id="S2.SS1.p3.3.m3.3.3.1.2.cmml" xref="S2.SS1.p3.3.m3.3.3.1.2"></times><apply id="S2.SS1.p3.3.m3.3.3.1.3.cmml" xref="S2.SS1.p3.3.m3.3.3.1.3"><log id="S2.SS1.p3.3.m3.3.3.1.3.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1.3.1"></log><ci id="S2.SS1.p3.3.m3.3.3.1.3.2.cmml" xref="S2.SS1.p3.3.m3.3.3.1.3.2">𝑃</ci></apply><apply id="S2.SS1.p3.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.2">𝑜</ci><ci id="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.2.3">𝜏</ci></apply><list id="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1.1.1.1.3.2"><ci id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝜃</ci><ci id="S2.SS1.p3.3.m3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2">𝜋</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.3c">-\log P(o_{\tau}|\theta,\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.3d">- roman_log italic_P ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_θ , italic_π )</annotation></semantics></math>, which can be estimated analogously to VFE <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib35" title="">schwartenbeck2019computational </a></cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="G(\pi,\tau)=\mathbb{E}_{{P}(o_{\tau}|s_{\tau},\theta)}\mathbb{E}_{{Q}_{\phi}(s%
_{\tau},\theta|\pi)}\left[\log Q_{\phi}(s_{\tau},\theta|\pi)-\log{P}(o_{\tau},%
s_{\tau},\theta|\pi)\right]\ ." class="ltx_Math" display="block" id="S2.E2.m1.7"><semantics id="S2.E2.m1.7a"><mrow id="S2.E2.m1.7.7.1" xref="S2.E2.m1.7.7.1.1.cmml"><mrow id="S2.E2.m1.7.7.1.1" xref="S2.E2.m1.7.7.1.1.cmml"><mrow id="S2.E2.m1.7.7.1.1.3" xref="S2.E2.m1.7.7.1.1.3.cmml"><mi id="S2.E2.m1.7.7.1.1.3.2" xref="S2.E2.m1.7.7.1.1.3.2.cmml">G</mi><mo id="S2.E2.m1.7.7.1.1.3.1" xref="S2.E2.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.3.3.2" xref="S2.E2.m1.7.7.1.1.3.3.1.cmml"><mo id="S2.E2.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">π</mi><mo id="S2.E2.m1.7.7.1.1.3.3.2.2" xref="S2.E2.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml">τ</mi><mo id="S2.E2.m1.7.7.1.1.3.3.2.3" stretchy="false" xref="S2.E2.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.1.1.2" xref="S2.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.7.7.1.1.1" xref="S2.E2.m1.7.7.1.1.1.cmml"><msub id="S2.E2.m1.7.7.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.3.cmml"><mi id="S2.E2.m1.7.7.1.1.1.3.2" xref="S2.E2.m1.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml">P</mi><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mo id="S2.E2.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E2.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml">o</mi><mi id="S2.E2.m1.2.2.2.2.1.1.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml">|</mo><mrow id="S2.E2.m1.2.2.2.2.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml"><msub id="S2.E2.m1.2.2.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E2.m1.2.2.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml">,</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">θ</mi></mrow></mrow><mo id="S2.E2.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E2.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E2.m1.7.7.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.2.cmml">⁢</mo><msub id="S2.E2.m1.7.7.1.1.1.4" xref="S2.E2.m1.7.7.1.1.1.4.cmml"><mi id="S2.E2.m1.7.7.1.1.1.4.2" xref="S2.E2.m1.7.7.1.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E2.m1.4.4.2" xref="S2.E2.m1.4.4.2.cmml"><msub id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.4.cmml"><mi id="S2.E2.m1.4.4.2.4.2" xref="S2.E2.m1.4.4.2.4.2.cmml">Q</mi><mi id="S2.E2.m1.4.4.2.4.3" xref="S2.E2.m1.4.4.2.4.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.4.4.2.3" xref="S2.E2.m1.4.4.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.2.2.2" xref="S2.E2.m1.4.4.2.2.3.cmml"><mo id="S2.E2.m1.4.4.2.2.2.3" stretchy="false" xref="S2.E2.m1.4.4.2.2.3.cmml">(</mo><msub id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.3.3.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E2.m1.4.4.2.2.2.4" xref="S2.E2.m1.4.4.2.2.3.cmml">,</mo><mrow id="S2.E2.m1.4.4.2.2.2.2" xref="S2.E2.m1.4.4.2.2.2.2.cmml"><mi id="S2.E2.m1.4.4.2.2.2.2.2" xref="S2.E2.m1.4.4.2.2.2.2.2.cmml">θ</mi><mo fence="false" id="S2.E2.m1.4.4.2.2.2.2.1" xref="S2.E2.m1.4.4.2.2.2.2.1.cmml">|</mo><mi id="S2.E2.m1.4.4.2.2.2.2.3" xref="S2.E2.m1.4.4.2.2.2.2.3.cmml">π</mi></mrow><mo id="S2.E2.m1.4.4.2.2.2.5" stretchy="false" xref="S2.E2.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></msub><mo id="S2.E2.m1.7.7.1.1.1.2a" xref="S2.E2.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.2.cmml"><mo id="S2.E2.m1.7.7.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.cmml"><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.1.cmml">log</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4a" lspace="0.167em" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.cmml">⁡</mo><msub id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.2.cmml">Q</mi><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.3.cmml">ϕ</mi></msub></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.4" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mo fence="false" id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.1.cmml">|</mo><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml">π</mi></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.6" xref="S2.E2.m1.7.7.1.1.1.1.1.1.6.cmml">−</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.5" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.cmml"><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.1.cmml">log</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5a" lspace="0.167em" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.cmml">⁡</mo><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.2.cmml">P</mi></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.4" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.4.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml"><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.4" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml">(</mo><msub id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.2.cmml">o</mi><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.5" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml">,</mo><msub id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.2.cmml">s</mi><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.3.cmml">τ</mi></msub><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.6" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml">,</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.2" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.2.cmml">θ</mi><mo fence="false" id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.1.cmml">|</mo><mi id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.3" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.3.cmml">π</mi></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.7" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.7.7.1.1.1.1.1.3" rspace="0.222em" xref="S2.E2.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E2.m1.7.7.1.2" xref="S2.E2.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.7b"><apply id="S2.E2.m1.7.7.1.1.cmml" xref="S2.E2.m1.7.7.1"><eq id="S2.E2.m1.7.7.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.2"></eq><apply id="S2.E2.m1.7.7.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.3"><times id="S2.E2.m1.7.7.1.1.3.1.cmml" xref="S2.E2.m1.7.7.1.1.3.1"></times><ci id="S2.E2.m1.7.7.1.1.3.2.cmml" xref="S2.E2.m1.7.7.1.1.3.2">𝐺</ci><interval closure="open" id="S2.E2.m1.7.7.1.1.3.3.1.cmml" xref="S2.E2.m1.7.7.1.1.3.3.2"><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝜋</ci><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">𝜏</ci></interval></apply><apply id="S2.E2.m1.7.7.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1"><times id="S2.E2.m1.7.7.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.2"></times><apply id="S2.E2.m1.7.7.1.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.3.2.cmml" xref="S2.E2.m1.7.7.1.1.1.3.2">𝔼</ci><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><times id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></times><ci id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4">𝑃</ci><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">conditional</csymbol><apply id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.2">𝑜</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3">𝜏</ci></apply><list id="S2.E2.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1"><apply id="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝜃</ci></list></apply></apply></apply><apply id="S2.E2.m1.7.7.1.1.1.4.cmml" xref="S2.E2.m1.7.7.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.4.1.cmml" xref="S2.E2.m1.7.7.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.4.2.cmml" xref="S2.E2.m1.7.7.1.1.1.4.2">𝔼</ci><apply id="S2.E2.m1.4.4.2.cmml" xref="S2.E2.m1.4.4.2"><times id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2.3"></times><apply id="S2.E2.m1.4.4.2.4.cmml" xref="S2.E2.m1.4.4.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.2.4.1.cmml" xref="S2.E2.m1.4.4.2.4">subscript</csymbol><ci id="S2.E2.m1.4.4.2.4.2.cmml" xref="S2.E2.m1.4.4.2.4.2">𝑄</ci><ci id="S2.E2.m1.4.4.2.4.3.cmml" xref="S2.E2.m1.4.4.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E2.m1.4.4.2.2.3.cmml" xref="S2.E2.m1.4.4.2.2.2"><apply id="S2.E2.m1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.3.3.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.3">𝜏</ci></apply><apply id="S2.E2.m1.4.4.2.2.2.2.cmml" xref="S2.E2.m1.4.4.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.4.4.2.2.2.2.1.cmml" xref="S2.E2.m1.4.4.2.2.2.2.1">conditional</csymbol><ci id="S2.E2.m1.4.4.2.2.2.2.2.cmml" xref="S2.E2.m1.4.4.2.2.2.2.2">𝜃</ci><ci id="S2.E2.m1.4.4.2.2.2.2.3.cmml" xref="S2.E2.m1.4.4.2.2.2.2.3">𝜋</ci></apply></interval></apply></apply><apply id="S2.E2.m1.7.7.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1"><minus id="S2.E2.m1.7.7.1.1.1.1.1.1.6.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.6"></minus><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2"><times id="S2.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.3"></times><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4"><log id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.1"></log><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.2">𝑄</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.4.2.3">italic-ϕ</ci></apply></apply><interval closure="open" id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2"><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.1">conditional</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.2">𝜃</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.3">𝜋</ci></apply></interval></apply><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.5.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5"><times id="S2.E2.m1.7.7.1.1.1.1.1.1.5.4.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.4"></times><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5"><log id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.1"></log><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.5.2">𝑃</ci></apply><vector id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.4.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3"><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.2">𝑜</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.3.1.1.1.3">𝜏</ci></apply><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.2">𝑠</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.4.2.2.2.3">𝜏</ci></apply><apply id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3"><csymbol cd="latexml" id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.1">conditional</csymbol><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.2">𝜃</ci><ci id="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.3.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1.5.3.3.3.3">𝜋</ci></apply></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.7c">G(\pi,\tau)=\mathbb{E}_{{P}(o_{\tau}|s_{\tau},\theta)}\mathbb{E}_{{Q}_{\phi}(s%
_{\tau},\theta|\pi)}\left[\log Q_{\phi}(s_{\tau},\theta|\pi)-\log{P}(o_{\tau},%
s_{\tau},\theta|\pi)\right]\ .</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.7d">italic_G ( italic_π , italic_τ ) = blackboard_E start_POSTSUBSCRIPT italic_P ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ ) end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ | italic_π ) end_POSTSUBSCRIPT [ roman_log italic_Q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ | italic_π ) - roman_log italic_P ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ | italic_π ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p3.4">This is known as the Expected Free Energy (EFE) in the framework, which quantifies the relative quality of policies—lower values correspond to better policies.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">The EFE in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E2" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">2</span></a> can be derived as a decomposition of distinct terms for time <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">italic_τ</annotation></semantics></math>, as follows <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib35" title="">schwartenbeck2019computational </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_eqn_row" id="A3.EGx1"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle G(\pi,\tau)" class="ltx_Math" display="inline" id="S2.E3.1.m1.2"><semantics id="S2.E3.1.m1.2a"><mrow id="S2.E3.1.m1.2.3" xref="S2.E3.1.m1.2.3.cmml"><mi id="S2.E3.1.m1.2.3.2" xref="S2.E3.1.m1.2.3.2.cmml">G</mi><mo id="S2.E3.1.m1.2.3.1" xref="S2.E3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.E3.1.m1.2.3.3.2" xref="S2.E3.1.m1.2.3.3.1.cmml"><mo id="S2.E3.1.m1.2.3.3.2.1" stretchy="false" xref="S2.E3.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.E3.1.m1.1.1" xref="S2.E3.1.m1.1.1.cmml">π</mi><mo id="S2.E3.1.m1.2.3.3.2.2" xref="S2.E3.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.E3.1.m1.2.2" xref="S2.E3.1.m1.2.2.cmml">τ</mi><mo id="S2.E3.1.m1.2.3.3.2.3" stretchy="false" xref="S2.E3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.1.m1.2b"><apply id="S2.E3.1.m1.2.3.cmml" xref="S2.E3.1.m1.2.3"><times id="S2.E3.1.m1.2.3.1.cmml" xref="S2.E3.1.m1.2.3.1"></times><ci id="S2.E3.1.m1.2.3.2.cmml" xref="S2.E3.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S2.E3.1.m1.2.3.3.1.cmml" xref="S2.E3.1.m1.2.3.3.2"><ci id="S2.E3.1.m1.1.1.cmml" xref="S2.E3.1.m1.1.1">𝜋</ci><ci id="S2.E3.1.m1.2.2.cmml" xref="S2.E3.1.m1.2.2">𝜏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.1.m1.2c">\displaystyle G(\pi,\tau)</annotation><annotation encoding="application/x-llamapun" id="S2.E3.1.m1.2d">italic_G ( italic_π , italic_τ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\mathbb{E}_{\tilde{Q}}\left[\log P(o_{\tau}|\pi)\right]" class="ltx_Math" display="inline" id="S2.E3.1.m2.1"><semantics id="S2.E3.1.m2.1a"><mrow id="S2.E3.1.m2.1.1" xref="S2.E3.1.m2.1.1.cmml"><mi id="S2.E3.1.m2.1.1.3" xref="S2.E3.1.m2.1.1.3.cmml"></mi><mo id="S2.E3.1.m2.1.1.2" xref="S2.E3.1.m2.1.1.2.cmml">=</mo><mrow id="S2.E3.1.m2.1.1.1" xref="S2.E3.1.m2.1.1.1.cmml"><mo id="S2.E3.1.m2.1.1.1a" xref="S2.E3.1.m2.1.1.1.cmml">−</mo><mrow id="S2.E3.1.m2.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.cmml"><msub id="S2.E3.1.m2.1.1.1.1.3" xref="S2.E3.1.m2.1.1.1.1.3.cmml"><mi id="S2.E3.1.m2.1.1.1.1.3.2" xref="S2.E3.1.m2.1.1.1.1.3.2.cmml">𝔼</mi><mover accent="true" id="S2.E3.1.m2.1.1.1.1.3.3" xref="S2.E3.1.m2.1.1.1.1.3.3.cmml"><mi id="S2.E3.1.m2.1.1.1.1.3.3.2" xref="S2.E3.1.m2.1.1.1.1.3.3.2.cmml">Q</mi><mo id="S2.E3.1.m2.1.1.1.1.3.3.1" xref="S2.E3.1.m2.1.1.1.1.3.3.1.cmml">~</mo></mover></msub><mo id="S2.E3.1.m2.1.1.1.1.2" xref="S2.E3.1.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.1.m2.1.1.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.1.2.cmml"><mo id="S2.E3.1.m2.1.1.1.1.1.1.2" xref="S2.E3.1.m2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.1.m2.1.1.1.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.1.m2.1.1.1.1.1.1.1.3" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.1.m2.1.1.1.1.1.1.1.3.1" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.1.m2.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E3.1.m2.1.1.1.1.1.1.1.3.2" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S2.E3.1.m2.1.1.1.1.1.1.1.2" xref="S2.E3.1.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.1.m2.1.1.1.1.1.1.3" xref="S2.E3.1.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.1.m2.1b"><apply id="S2.E3.1.m2.1.1.cmml" xref="S2.E3.1.m2.1.1"><eq id="S2.E3.1.m2.1.1.2.cmml" xref="S2.E3.1.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.E3.1.m2.1.1.3.cmml" xref="S2.E3.1.m2.1.1.3">absent</csymbol><apply id="S2.E3.1.m2.1.1.1.cmml" xref="S2.E3.1.m2.1.1.1"><minus id="S2.E3.1.m2.1.1.1.2.cmml" xref="S2.E3.1.m2.1.1.1"></minus><apply id="S2.E3.1.m2.1.1.1.1.cmml" xref="S2.E3.1.m2.1.1.1.1"><times id="S2.E3.1.m2.1.1.1.1.2.cmml" xref="S2.E3.1.m2.1.1.1.1.2"></times><apply id="S2.E3.1.m2.1.1.1.1.3.cmml" xref="S2.E3.1.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.1.m2.1.1.1.1.3.1.cmml" xref="S2.E3.1.m2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.1.m2.1.1.1.1.3.2.cmml" xref="S2.E3.1.m2.1.1.1.1.3.2">𝔼</ci><apply id="S2.E3.1.m2.1.1.1.1.3.3.cmml" xref="S2.E3.1.m2.1.1.1.1.3.3"><ci id="S2.E3.1.m2.1.1.1.1.3.3.1.cmml" xref="S2.E3.1.m2.1.1.1.1.3.3.1">~</ci><ci id="S2.E3.1.m2.1.1.1.1.3.3.2.cmml" xref="S2.E3.1.m2.1.1.1.1.3.3.2">𝑄</ci></apply></apply><apply id="S2.E3.1.m2.1.1.1.1.1.2.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.1.m2.1.1.1.1.1.2.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.1.m2.1.1.1.1.1.1.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1"><times id="S2.E3.1.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.1.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3"><log id="S2.E3.1.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.1"></log><ci id="S2.E3.1.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.1.m2.1.1.1.1.1.1.1.1.1.1.3">𝜋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.1.m2.1c">\displaystyle=-\mathbb{E}_{\tilde{Q}}\left[\log P(o_{\tau}|\pi)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E3.1.m2.1d">= - blackboard_E start_POSTSUBSCRIPT over~ start_ARG italic_Q end_ARG end_POSTSUBSCRIPT [ roman_log italic_P ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_π ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+\mathbb{E}_{\tilde{Q}}\left[\log Q(s_{\tau}|\pi)-\log P(s_{%
\tau}|o_{\tau},\pi)\right]" class="ltx_Math" display="inline" id="S2.E3.2.m1.2"><semantics id="S2.E3.2.m1.2a"><mrow id="S2.E3.2.m1.2.2" xref="S2.E3.2.m1.2.2.cmml"><mo id="S2.E3.2.m1.2.2a" xref="S2.E3.2.m1.2.2.cmml">+</mo><mrow id="S2.E3.2.m1.2.2.1" xref="S2.E3.2.m1.2.2.1.cmml"><msub id="S2.E3.2.m1.2.2.1.3" xref="S2.E3.2.m1.2.2.1.3.cmml"><mi id="S2.E3.2.m1.2.2.1.3.2" xref="S2.E3.2.m1.2.2.1.3.2.cmml">𝔼</mi><mover accent="true" id="S2.E3.2.m1.2.2.1.3.3" xref="S2.E3.2.m1.2.2.1.3.3.cmml"><mi id="S2.E3.2.m1.2.2.1.3.3.2" xref="S2.E3.2.m1.2.2.1.3.3.2.cmml">Q</mi><mo id="S2.E3.2.m1.2.2.1.3.3.1" xref="S2.E3.2.m1.2.2.1.3.3.1.cmml">~</mo></mover></msub><mo id="S2.E3.2.m1.2.2.1.2" xref="S2.E3.2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.2.m1.2.2.1.1.1" xref="S2.E3.2.m1.2.2.1.1.2.cmml"><mo id="S2.E3.2.m1.2.2.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E3.2.m1.2.2.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.1.cmml"><mrow id="S2.E3.2.m1.2.2.1.1.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E3.2.m1.2.2.1.1.1.1.1.3.1" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.2.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E3.2.m1.2.2.1.1.1.1.1.3.2" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.2.cmml">Q</mi></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.1.1.3.cmml">−</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.cmml"><mrow id="S2.E3.2.m1.2.2.1.1.1.1.2.3" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.3.1" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.1.cmml">log</mi><mo id="S2.E3.2.m1.2.2.1.1.1.1.2.3a" lspace="0.167em" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.cmml">⁡</mo><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.3.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.2.cmml">P</mi></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.1.2.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.cmml"><msub id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.2.cmml">s</mi><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.3" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.2.cmml">|</mo><mrow id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml"><msub id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.2" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml">,</mo><mi id="S2.E3.2.m1.1.1" xref="S2.E3.2.m1.1.1.cmml">π</mi></mrow></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.2.m1.2.2.1.1.1.3" xref="S2.E3.2.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.2.m1.2b"><apply id="S2.E3.2.m1.2.2.cmml" xref="S2.E3.2.m1.2.2"><plus id="S2.E3.2.m1.2.2.2.cmml" xref="S2.E3.2.m1.2.2"></plus><apply id="S2.E3.2.m1.2.2.1.cmml" xref="S2.E3.2.m1.2.2.1"><times id="S2.E3.2.m1.2.2.1.2.cmml" xref="S2.E3.2.m1.2.2.1.2"></times><apply id="S2.E3.2.m1.2.2.1.3.cmml" xref="S2.E3.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.2.m1.2.2.1.3.1.cmml" xref="S2.E3.2.m1.2.2.1.3">subscript</csymbol><ci id="S2.E3.2.m1.2.2.1.3.2.cmml" xref="S2.E3.2.m1.2.2.1.3.2">𝔼</ci><apply id="S2.E3.2.m1.2.2.1.3.3.cmml" xref="S2.E3.2.m1.2.2.1.3.3"><ci id="S2.E3.2.m1.2.2.1.3.3.1.cmml" xref="S2.E3.2.m1.2.2.1.3.3.1">~</ci><ci id="S2.E3.2.m1.2.2.1.3.3.2.cmml" xref="S2.E3.2.m1.2.2.1.3.3.2">𝑄</ci></apply></apply><apply id="S2.E3.2.m1.2.2.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.2.m1.2.2.1.1.2.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.2.m1.2.2.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1"><minus id="S2.E3.2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.3"></minus><apply id="S2.E3.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1"><times id="S2.E3.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.E3.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3"><log id="S2.E3.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.1"></log><ci id="S2.E3.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.3.2">𝑄</ci></apply><apply id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝜋</ci></apply></apply><apply id="S2.E3.2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2"><times id="S2.E3.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.2"></times><apply id="S2.E3.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3"><log id="S2.E3.2.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.1"></log><ci id="S2.E3.2.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.3.2">𝑃</ci></apply><apply id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.2">conditional</csymbol><apply id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.2">𝑠</ci><ci id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.3.3">𝜏</ci></apply><list id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1"><apply id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.2.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E3.2.m1.1.1.cmml" xref="S2.E3.2.m1.1.1">𝜋</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.2.m1.2c">\displaystyle\quad+\mathbb{E}_{\tilde{Q}}\left[\log Q(s_{\tau}|\pi)-\log P(s_{%
\tau}|o_{\tau},\pi)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E3.2.m1.2d">+ blackboard_E start_POSTSUBSCRIPT over~ start_ARG italic_Q end_ARG end_POSTSUBSCRIPT [ roman_log italic_Q ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_π ) - roman_log italic_P ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_π ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3b)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3.3">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+\mathbb{E}_{\tilde{Q}}\left[\log Q(\theta|s_{\tau},\pi)-%
\log P(\theta|s_{\tau},o_{\tau},\pi)\right]\ ," class="ltx_Math" display="inline" id="S2.E3.3.m1.3"><semantics id="S2.E3.3.m1.3a"><mrow id="S2.E3.3.m1.3.3.1" xref="S2.E3.3.m1.3.3.1.1.cmml"><mrow id="S2.E3.3.m1.3.3.1.1" xref="S2.E3.3.m1.3.3.1.1.cmml"><mo id="S2.E3.3.m1.3.3.1.1a" xref="S2.E3.3.m1.3.3.1.1.cmml">+</mo><mrow id="S2.E3.3.m1.3.3.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.cmml"><msub id="S2.E3.3.m1.3.3.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.3.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.3.2" xref="S2.E3.3.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mover accent="true" id="S2.E3.3.m1.3.3.1.1.1.3.3" xref="S2.E3.3.m1.3.3.1.1.1.3.3.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.3.3.2" xref="S2.E3.3.m1.3.3.1.1.1.3.3.2.cmml">Q</mi><mo id="S2.E3.3.m1.3.3.1.1.1.3.3.1" xref="S2.E3.3.m1.3.3.1.1.1.3.3.1.cmml">~</mo></mover></msub><mo id="S2.E3.3.m1.3.3.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">Q</mi></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">θ</mi><mo fence="false" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E3.3.m1.1.1" xref="S2.E3.3.m1.1.1.cmml">π</mi></mrow></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.cmml"><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">P</mi></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.4" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.4.cmml">θ</mi><mo fence="false" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml">|</mo><mrow id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml"><msub id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml"><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.2" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml">o</mi><mi id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.3" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml">τ</mi></msub><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.4" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><mi id="S2.E3.3.m1.2.2" xref="S2.E3.3.m1.2.2.cmml">π</mi></mrow></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.3.m1.3.3.1.1.1.1.1.3" rspace="0.500em" xref="S2.E3.3.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E3.3.m1.3.3.1.2" xref="S2.E3.3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.3.m1.3b"><apply id="S2.E3.3.m1.3.3.1.1.cmml" xref="S2.E3.3.m1.3.3.1"><plus id="S2.E3.3.m1.3.3.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1"></plus><apply id="S2.E3.3.m1.3.3.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1"><times id="S2.E3.3.m1.3.3.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.2"></times><apply id="S2.E3.3.m1.3.3.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.3.m1.3.3.1.1.1.3.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.3.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S2.E3.3.m1.3.3.1.1.1.3.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3.3"><ci id="S2.E3.3.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3.3.1">~</ci><ci id="S2.E3.3.m1.3.3.1.1.1.3.3.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.3.3.2">𝑄</ci></apply></apply><apply id="S2.E3.3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.3.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1"><minus id="S2.E3.3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.3"></minus><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3"><log id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.1"></log><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.3.2">𝑄</ci></apply><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝜃</ci><list id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E3.3.m1.1.1.cmml" xref="S2.E3.3.m1.1.1">𝜋</ci></list></apply></apply><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2"><times id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.2"></times><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3"><log id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.1"></log><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.3.2">𝑃</ci></apply><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">conditional</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.4.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.4">𝜃</ci><list id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2"><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.2">𝑜</ci><ci id="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="S2.E3.3.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.2.3">𝜏</ci></apply><ci id="S2.E3.3.m1.2.2.cmml" xref="S2.E3.3.m1.2.2">𝜋</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.3.m1.3c">\displaystyle\quad+\mathbb{E}_{\tilde{Q}}\left[\log Q(\theta|s_{\tau},\pi)-%
\log P(\theta|s_{\tau},o_{\tau},\pi)\right]\ ,</annotation><annotation encoding="application/x-llamapun" id="S2.E3.3.m1.3d">+ blackboard_E start_POSTSUBSCRIPT over~ start_ARG italic_Q end_ARG end_POSTSUBSCRIPT [ roman_log italic_Q ( italic_θ | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_π ) - roman_log italic_P ( italic_θ | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_π ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3c)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.p4.2">where <math alttext="\tilde{Q}=Q(o_{\tau},s_{\tau},\theta|\pi)" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m1.3"><semantics id="S2.SS1.p4.2.m1.3a"><mrow id="S2.SS1.p4.2.m1.3.3" xref="S2.SS1.p4.2.m1.3.3.cmml"><mover accent="true" id="S2.SS1.p4.2.m1.3.3.5" xref="S2.SS1.p4.2.m1.3.3.5.cmml"><mi id="S2.SS1.p4.2.m1.3.3.5.2" xref="S2.SS1.p4.2.m1.3.3.5.2.cmml">Q</mi><mo id="S2.SS1.p4.2.m1.3.3.5.1" xref="S2.SS1.p4.2.m1.3.3.5.1.cmml">~</mo></mover><mo id="S2.SS1.p4.2.m1.3.3.4" xref="S2.SS1.p4.2.m1.3.3.4.cmml">=</mo><mrow id="S2.SS1.p4.2.m1.3.3.3" xref="S2.SS1.p4.2.m1.3.3.3.cmml"><mi id="S2.SS1.p4.2.m1.3.3.3.5" xref="S2.SS1.p4.2.m1.3.3.3.5.cmml">Q</mi><mo id="S2.SS1.p4.2.m1.3.3.3.4" xref="S2.SS1.p4.2.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.SS1.p4.2.m1.3.3.3.3.3" xref="S2.SS1.p4.2.m1.3.3.3.3.4.cmml"><mo id="S2.SS1.p4.2.m1.3.3.3.3.3.4" stretchy="false" xref="S2.SS1.p4.2.m1.3.3.3.3.4.cmml">(</mo><msub id="S2.SS1.p4.2.m1.1.1.1.1.1.1" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.2.m1.1.1.1.1.1.1.2" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS1.p4.2.m1.1.1.1.1.1.1.3" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.SS1.p4.2.m1.3.3.3.3.3.5" xref="S2.SS1.p4.2.m1.3.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p4.2.m1.2.2.2.2.2.2" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2.cmml"><mi id="S2.SS1.p4.2.m1.2.2.2.2.2.2.2" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2.2.cmml">s</mi><mi id="S2.SS1.p4.2.m1.2.2.2.2.2.2.3" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2.3.cmml">τ</mi></msub><mo id="S2.SS1.p4.2.m1.3.3.3.3.3.6" xref="S2.SS1.p4.2.m1.3.3.3.3.4.cmml">,</mo><mrow id="S2.SS1.p4.2.m1.3.3.3.3.3.3" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.cmml"><mi id="S2.SS1.p4.2.m1.3.3.3.3.3.3.2" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.2.cmml">θ</mi><mo fence="false" id="S2.SS1.p4.2.m1.3.3.3.3.3.3.1" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.1.cmml">|</mo><mi id="S2.SS1.p4.2.m1.3.3.3.3.3.3.3" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.3.cmml">π</mi></mrow><mo id="S2.SS1.p4.2.m1.3.3.3.3.3.7" stretchy="false" xref="S2.SS1.p4.2.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m1.3b"><apply id="S2.SS1.p4.2.m1.3.3.cmml" xref="S2.SS1.p4.2.m1.3.3"><eq id="S2.SS1.p4.2.m1.3.3.4.cmml" xref="S2.SS1.p4.2.m1.3.3.4"></eq><apply id="S2.SS1.p4.2.m1.3.3.5.cmml" xref="S2.SS1.p4.2.m1.3.3.5"><ci id="S2.SS1.p4.2.m1.3.3.5.1.cmml" xref="S2.SS1.p4.2.m1.3.3.5.1">~</ci><ci id="S2.SS1.p4.2.m1.3.3.5.2.cmml" xref="S2.SS1.p4.2.m1.3.3.5.2">𝑄</ci></apply><apply id="S2.SS1.p4.2.m1.3.3.3.cmml" xref="S2.SS1.p4.2.m1.3.3.3"><times id="S2.SS1.p4.2.m1.3.3.3.4.cmml" xref="S2.SS1.p4.2.m1.3.3.3.4"></times><ci id="S2.SS1.p4.2.m1.3.3.3.5.cmml" xref="S2.SS1.p4.2.m1.3.3.3.5">𝑄</ci><vector id="S2.SS1.p4.2.m1.3.3.3.3.4.cmml" xref="S2.SS1.p4.2.m1.3.3.3.3.3"><apply id="S2.SS1.p4.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.SS1.p4.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.2.m1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="S2.SS1.p4.2.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p4.2.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2.2">𝑠</ci><ci id="S2.SS1.p4.2.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS1.p4.2.m1.2.2.2.2.2.2.3">𝜏</ci></apply><apply id="S2.SS1.p4.2.m1.3.3.3.3.3.3.cmml" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3"><csymbol cd="latexml" id="S2.SS1.p4.2.m1.3.3.3.3.3.3.1.cmml" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.1">conditional</csymbol><ci id="S2.SS1.p4.2.m1.3.3.3.3.3.3.2.cmml" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.2">𝜃</ci><ci id="S2.SS1.p4.2.m1.3.3.3.3.3.3.3.cmml" xref="S2.SS1.p4.2.m1.3.3.3.3.3.3.3">𝜋</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m1.3c">\tilde{Q}=Q(o_{\tau},s_{\tau},\theta|\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m1.3d">over~ start_ARG italic_Q end_ARG = italic_Q ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ | italic_π )</annotation></semantics></math> . Fountas et al.  (2020) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> rearranged this formulation with further use of sampling leading to a tractable estimate for the EFE that is both interpretable and easy to calculate <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E4">
<tbody>
<tr class="ltx_eqn_row" id="A3.EGx2"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle G(\pi,\tau)" class="ltx_Math" display="inline" id="S2.E4.1.m1.2"><semantics id="S2.E4.1.m1.2a"><mrow id="S2.E4.1.m1.2.3" xref="S2.E4.1.m1.2.3.cmml"><mi id="S2.E4.1.m1.2.3.2" xref="S2.E4.1.m1.2.3.2.cmml">G</mi><mo id="S2.E4.1.m1.2.3.1" xref="S2.E4.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.E4.1.m1.2.3.3.2" xref="S2.E4.1.m1.2.3.3.1.cmml"><mo id="S2.E4.1.m1.2.3.3.2.1" stretchy="false" xref="S2.E4.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.E4.1.m1.1.1" xref="S2.E4.1.m1.1.1.cmml">π</mi><mo id="S2.E4.1.m1.2.3.3.2.2" xref="S2.E4.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.E4.1.m1.2.2" xref="S2.E4.1.m1.2.2.cmml">τ</mi><mo id="S2.E4.1.m1.2.3.3.2.3" stretchy="false" xref="S2.E4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.1.m1.2b"><apply id="S2.E4.1.m1.2.3.cmml" xref="S2.E4.1.m1.2.3"><times id="S2.E4.1.m1.2.3.1.cmml" xref="S2.E4.1.m1.2.3.1"></times><ci id="S2.E4.1.m1.2.3.2.cmml" xref="S2.E4.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S2.E4.1.m1.2.3.3.1.cmml" xref="S2.E4.1.m1.2.3.3.2"><ci id="S2.E4.1.m1.1.1.cmml" xref="S2.E4.1.m1.1.1">𝜋</ci><ci id="S2.E4.1.m1.2.2.cmml" xref="S2.E4.1.m1.2.2">𝜏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.1.m1.2c">\displaystyle G(\pi,\tau)</annotation><annotation encoding="application/x-llamapun" id="S2.E4.1.m1.2d">italic_G ( italic_π , italic_τ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\mathbb{E}_{Q(\theta|\pi)Q(s_{\tau}|\theta,\pi)Q(o_{\tau}|s_{%
\tau},\theta,\pi)}\left[\log\textstyle P(o_{\tau}|\pi)\right]" class="ltx_Math" display="inline" id="S2.E4.1.m2.8"><semantics id="S2.E4.1.m2.8a"><mrow id="S2.E4.1.m2.8.8" xref="S2.E4.1.m2.8.8.cmml"><mi id="S2.E4.1.m2.8.8.3" xref="S2.E4.1.m2.8.8.3.cmml"></mi><mo id="S2.E4.1.m2.8.8.2" xref="S2.E4.1.m2.8.8.2.cmml">=</mo><mrow id="S2.E4.1.m2.8.8.1" xref="S2.E4.1.m2.8.8.1.cmml"><mo id="S2.E4.1.m2.8.8.1a" xref="S2.E4.1.m2.8.8.1.cmml">−</mo><mrow id="S2.E4.1.m2.8.8.1.1" xref="S2.E4.1.m2.8.8.1.1.cmml"><msub id="S2.E4.1.m2.8.8.1.1.3" xref="S2.E4.1.m2.8.8.1.1.3.cmml"><mi id="S2.E4.1.m2.8.8.1.1.3.2" xref="S2.E4.1.m2.8.8.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.1.m2.7.7.7" xref="S2.E4.1.m2.7.7.7.cmml"><mi id="S2.E4.1.m2.7.7.7.9" xref="S2.E4.1.m2.7.7.7.9.cmml">Q</mi><mo id="S2.E4.1.m2.7.7.7.8" xref="S2.E4.1.m2.7.7.7.8.cmml">⁢</mo><mrow id="S2.E4.1.m2.5.5.5.5.1" xref="S2.E4.1.m2.5.5.5.5.1.1.cmml"><mo id="S2.E4.1.m2.5.5.5.5.1.2" stretchy="false" xref="S2.E4.1.m2.5.5.5.5.1.1.cmml">(</mo><mrow id="S2.E4.1.m2.5.5.5.5.1.1" xref="S2.E4.1.m2.5.5.5.5.1.1.cmml"><mi id="S2.E4.1.m2.5.5.5.5.1.1.2" xref="S2.E4.1.m2.5.5.5.5.1.1.2.cmml">θ</mi><mo fence="false" id="S2.E4.1.m2.5.5.5.5.1.1.1" xref="S2.E4.1.m2.5.5.5.5.1.1.1.cmml">|</mo><mi id="S2.E4.1.m2.5.5.5.5.1.1.3" xref="S2.E4.1.m2.5.5.5.5.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.1.m2.5.5.5.5.1.3" stretchy="false" xref="S2.E4.1.m2.5.5.5.5.1.1.cmml">)</mo></mrow><mo id="S2.E4.1.m2.7.7.7.8a" xref="S2.E4.1.m2.7.7.7.8.cmml">⁢</mo><mi id="S2.E4.1.m2.7.7.7.10" xref="S2.E4.1.m2.7.7.7.10.cmml">Q</mi><mo id="S2.E4.1.m2.7.7.7.8b" xref="S2.E4.1.m2.7.7.7.8.cmml">⁢</mo><mrow id="S2.E4.1.m2.6.6.6.6.1" xref="S2.E4.1.m2.6.6.6.6.1.1.cmml"><mo id="S2.E4.1.m2.6.6.6.6.1.2" stretchy="false" xref="S2.E4.1.m2.6.6.6.6.1.1.cmml">(</mo><mrow id="S2.E4.1.m2.6.6.6.6.1.1" xref="S2.E4.1.m2.6.6.6.6.1.1.cmml"><msub id="S2.E4.1.m2.6.6.6.6.1.1.2" xref="S2.E4.1.m2.6.6.6.6.1.1.2.cmml"><mi id="S2.E4.1.m2.6.6.6.6.1.1.2.2" xref="S2.E4.1.m2.6.6.6.6.1.1.2.2.cmml">s</mi><mi id="S2.E4.1.m2.6.6.6.6.1.1.2.3" xref="S2.E4.1.m2.6.6.6.6.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.1.m2.6.6.6.6.1.1.1" xref="S2.E4.1.m2.6.6.6.6.1.1.1.cmml">|</mo><mrow id="S2.E4.1.m2.6.6.6.6.1.1.3.2" xref="S2.E4.1.m2.6.6.6.6.1.1.3.1.cmml"><mi id="S2.E4.1.m2.1.1.1.1" xref="S2.E4.1.m2.1.1.1.1.cmml">θ</mi><mo id="S2.E4.1.m2.6.6.6.6.1.1.3.2.1" xref="S2.E4.1.m2.6.6.6.6.1.1.3.1.cmml">,</mo><mi id="S2.E4.1.m2.2.2.2.2" xref="S2.E4.1.m2.2.2.2.2.cmml">π</mi></mrow></mrow><mo id="S2.E4.1.m2.6.6.6.6.1.3" stretchy="false" xref="S2.E4.1.m2.6.6.6.6.1.1.cmml">)</mo></mrow><mo id="S2.E4.1.m2.7.7.7.8c" xref="S2.E4.1.m2.7.7.7.8.cmml">⁢</mo><mi id="S2.E4.1.m2.7.7.7.11" xref="S2.E4.1.m2.7.7.7.11.cmml">Q</mi><mo id="S2.E4.1.m2.7.7.7.8d" xref="S2.E4.1.m2.7.7.7.8.cmml">⁢</mo><mrow id="S2.E4.1.m2.7.7.7.7.1" xref="S2.E4.1.m2.7.7.7.7.1.1.cmml"><mo id="S2.E4.1.m2.7.7.7.7.1.2" stretchy="false" xref="S2.E4.1.m2.7.7.7.7.1.1.cmml">(</mo><mrow id="S2.E4.1.m2.7.7.7.7.1.1" xref="S2.E4.1.m2.7.7.7.7.1.1.cmml"><msub id="S2.E4.1.m2.7.7.7.7.1.1.3" xref="S2.E4.1.m2.7.7.7.7.1.1.3.cmml"><mi id="S2.E4.1.m2.7.7.7.7.1.1.3.2" xref="S2.E4.1.m2.7.7.7.7.1.1.3.2.cmml">o</mi><mi id="S2.E4.1.m2.7.7.7.7.1.1.3.3" xref="S2.E4.1.m2.7.7.7.7.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.1.m2.7.7.7.7.1.1.2" xref="S2.E4.1.m2.7.7.7.7.1.1.2.cmml">|</mo><mrow id="S2.E4.1.m2.7.7.7.7.1.1.1.1" xref="S2.E4.1.m2.7.7.7.7.1.1.1.2.cmml"><msub id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.cmml"><mi id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.2" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.3" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E4.1.m2.7.7.7.7.1.1.1.1.2" xref="S2.E4.1.m2.7.7.7.7.1.1.1.2.cmml">,</mo><mi id="S2.E4.1.m2.3.3.3.3" xref="S2.E4.1.m2.3.3.3.3.cmml">θ</mi><mo id="S2.E4.1.m2.7.7.7.7.1.1.1.1.3" xref="S2.E4.1.m2.7.7.7.7.1.1.1.2.cmml">,</mo><mi id="S2.E4.1.m2.4.4.4.4" xref="S2.E4.1.m2.4.4.4.4.cmml">π</mi></mrow></mrow><mo id="S2.E4.1.m2.7.7.7.7.1.3" stretchy="false" xref="S2.E4.1.m2.7.7.7.7.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.1.m2.8.8.1.1.2" xref="S2.E4.1.m2.8.8.1.1.2.cmml">⁢</mo><mrow id="S2.E4.1.m2.8.8.1.1.1.1" xref="S2.E4.1.m2.8.8.1.1.1.2.cmml"><mo id="S2.E4.1.m2.8.8.1.1.1.1.2" xref="S2.E4.1.m2.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S2.E4.1.m2.8.8.1.1.1.1.1" xref="S2.E4.1.m2.8.8.1.1.1.1.1.cmml"><mrow id="S2.E4.1.m2.8.8.1.1.1.1.1.3" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.cmml"><mi id="S2.E4.1.m2.8.8.1.1.1.1.1.3.1" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E4.1.m2.8.8.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E4.1.m2.8.8.1.1.1.1.1.3.2" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S2.E4.1.m2.8.8.1.1.1.1.1.2" xref="S2.E4.1.m2.8.8.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.1" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.3" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.1.m2.8.8.1.1.1.1.3" xref="S2.E4.1.m2.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.1.m2.8b"><apply id="S2.E4.1.m2.8.8.cmml" xref="S2.E4.1.m2.8.8"><eq id="S2.E4.1.m2.8.8.2.cmml" xref="S2.E4.1.m2.8.8.2"></eq><csymbol cd="latexml" id="S2.E4.1.m2.8.8.3.cmml" xref="S2.E4.1.m2.8.8.3">absent</csymbol><apply id="S2.E4.1.m2.8.8.1.cmml" xref="S2.E4.1.m2.8.8.1"><minus id="S2.E4.1.m2.8.8.1.2.cmml" xref="S2.E4.1.m2.8.8.1"></minus><apply id="S2.E4.1.m2.8.8.1.1.cmml" xref="S2.E4.1.m2.8.8.1.1"><times id="S2.E4.1.m2.8.8.1.1.2.cmml" xref="S2.E4.1.m2.8.8.1.1.2"></times><apply id="S2.E4.1.m2.8.8.1.1.3.cmml" xref="S2.E4.1.m2.8.8.1.1.3"><csymbol cd="ambiguous" id="S2.E4.1.m2.8.8.1.1.3.1.cmml" xref="S2.E4.1.m2.8.8.1.1.3">subscript</csymbol><ci id="S2.E4.1.m2.8.8.1.1.3.2.cmml" xref="S2.E4.1.m2.8.8.1.1.3.2">𝔼</ci><apply id="S2.E4.1.m2.7.7.7.cmml" xref="S2.E4.1.m2.7.7.7"><times id="S2.E4.1.m2.7.7.7.8.cmml" xref="S2.E4.1.m2.7.7.7.8"></times><ci id="S2.E4.1.m2.7.7.7.9.cmml" xref="S2.E4.1.m2.7.7.7.9">𝑄</ci><apply id="S2.E4.1.m2.5.5.5.5.1.1.cmml" xref="S2.E4.1.m2.5.5.5.5.1"><csymbol cd="latexml" id="S2.E4.1.m2.5.5.5.5.1.1.1.cmml" xref="S2.E4.1.m2.5.5.5.5.1.1.1">conditional</csymbol><ci id="S2.E4.1.m2.5.5.5.5.1.1.2.cmml" xref="S2.E4.1.m2.5.5.5.5.1.1.2">𝜃</ci><ci id="S2.E4.1.m2.5.5.5.5.1.1.3.cmml" xref="S2.E4.1.m2.5.5.5.5.1.1.3">𝜋</ci></apply><ci id="S2.E4.1.m2.7.7.7.10.cmml" xref="S2.E4.1.m2.7.7.7.10">𝑄</ci><apply id="S2.E4.1.m2.6.6.6.6.1.1.cmml" xref="S2.E4.1.m2.6.6.6.6.1"><csymbol cd="latexml" id="S2.E4.1.m2.6.6.6.6.1.1.1.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.1">conditional</csymbol><apply id="S2.E4.1.m2.6.6.6.6.1.1.2.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.2"><csymbol cd="ambiguous" id="S2.E4.1.m2.6.6.6.6.1.1.2.1.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.2">subscript</csymbol><ci id="S2.E4.1.m2.6.6.6.6.1.1.2.2.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.2.2">𝑠</ci><ci id="S2.E4.1.m2.6.6.6.6.1.1.2.3.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.2.3">𝜏</ci></apply><list id="S2.E4.1.m2.6.6.6.6.1.1.3.1.cmml" xref="S2.E4.1.m2.6.6.6.6.1.1.3.2"><ci id="S2.E4.1.m2.1.1.1.1.cmml" xref="S2.E4.1.m2.1.1.1.1">𝜃</ci><ci id="S2.E4.1.m2.2.2.2.2.cmml" xref="S2.E4.1.m2.2.2.2.2">𝜋</ci></list></apply><ci id="S2.E4.1.m2.7.7.7.11.cmml" xref="S2.E4.1.m2.7.7.7.11">𝑄</ci><apply id="S2.E4.1.m2.7.7.7.7.1.1.cmml" xref="S2.E4.1.m2.7.7.7.7.1"><csymbol cd="latexml" id="S2.E4.1.m2.7.7.7.7.1.1.2.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.2">conditional</csymbol><apply id="S2.E4.1.m2.7.7.7.7.1.1.3.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.3"><csymbol cd="ambiguous" id="S2.E4.1.m2.7.7.7.7.1.1.3.1.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.3">subscript</csymbol><ci id="S2.E4.1.m2.7.7.7.7.1.1.3.2.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.3.2">𝑜</ci><ci id="S2.E4.1.m2.7.7.7.7.1.1.3.3.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.3.3">𝜏</ci></apply><list id="S2.E4.1.m2.7.7.7.7.1.1.1.2.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1"><apply id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.1.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.2.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.2">𝑠</ci><ci id="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.3.cmml" xref="S2.E4.1.m2.7.7.7.7.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E4.1.m2.3.3.3.3.cmml" xref="S2.E4.1.m2.3.3.3.3">𝜃</ci><ci id="S2.E4.1.m2.4.4.4.4.cmml" xref="S2.E4.1.m2.4.4.4.4">𝜋</ci></list></apply></apply></apply><apply id="S2.E4.1.m2.8.8.1.1.1.2.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1"><csymbol cd="latexml" id="S2.E4.1.m2.8.8.1.1.1.2.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.1.m2.8.8.1.1.1.1.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1"><times id="S2.E4.1.m2.8.8.1.1.1.1.1.2.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.2"></times><apply id="S2.E4.1.m2.8.8.1.1.1.1.1.3.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3"><log id="S2.E4.1.m2.8.8.1.1.1.1.1.3.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.1"></log><ci id="S2.E4.1.m2.8.8.1.1.1.1.1.3.2.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><ci id="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.1.m2.8.8.1.1.1.1.1.1.1.1.3">𝜋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.1.m2.8c">\displaystyle=-\mathbb{E}_{Q(\theta|\pi)Q(s_{\tau}|\theta,\pi)Q(o_{\tau}|s_{%
\tau},\theta,\pi)}\left[\log\textstyle P(o_{\tau}|\pi)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E4.1.m2.8d">= - blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_θ | italic_π ) italic_Q ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_θ , italic_π ) italic_Q ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ , italic_π ) end_POSTSUBSCRIPT [ roman_log italic_P ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_π ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+\mathbb{E}_{Q(\theta|\pi)}\left[\,\mathbb{E}_{Q(o_{\tau}|%
\theta,\pi)}H(s_{\tau}|o_{\tau},\pi)-H(s_{\tau}|\pi)\right]" class="ltx_Math" display="inline" id="S2.E4.2.m1.6"><semantics id="S2.E4.2.m1.6a"><mrow id="S2.E4.2.m1.6.6" xref="S2.E4.2.m1.6.6.cmml"><mo id="S2.E4.2.m1.6.6a" xref="S2.E4.2.m1.6.6.cmml">+</mo><mrow id="S2.E4.2.m1.6.6.1" xref="S2.E4.2.m1.6.6.1.cmml"><msub id="S2.E4.2.m1.6.6.1.3" xref="S2.E4.2.m1.6.6.1.3.cmml"><mi id="S2.E4.2.m1.6.6.1.3.2" xref="S2.E4.2.m1.6.6.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.2.m1.1.1.1" xref="S2.E4.2.m1.1.1.1.cmml"><mi id="S2.E4.2.m1.1.1.1.3" xref="S2.E4.2.m1.1.1.1.3.cmml">Q</mi><mo id="S2.E4.2.m1.1.1.1.2" xref="S2.E4.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.2.m1.1.1.1.1.1" xref="S2.E4.2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E4.2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.2.m1.1.1.1.1.1.1" xref="S2.E4.2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E4.2.m1.1.1.1.1.1.1.2" xref="S2.E4.2.m1.1.1.1.1.1.1.2.cmml">θ</mi><mo fence="false" id="S2.E4.2.m1.1.1.1.1.1.1.1" xref="S2.E4.2.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E4.2.m1.1.1.1.1.1.1.3" xref="S2.E4.2.m1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.2.m1.6.6.1.2" xref="S2.E4.2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S2.E4.2.m1.6.6.1.1.1" xref="S2.E4.2.m1.6.6.1.1.2.cmml"><mo id="S2.E4.2.m1.6.6.1.1.1.2" rspace="0.170em" xref="S2.E4.2.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.cmml"><mrow id="S2.E4.2.m1.6.6.1.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.1.cmml"><msub id="S2.E4.2.m1.6.6.1.1.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.3.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.2.m1.4.4.3" xref="S2.E4.2.m1.4.4.3.cmml"><mi id="S2.E4.2.m1.4.4.3.5" xref="S2.E4.2.m1.4.4.3.5.cmml">Q</mi><mo id="S2.E4.2.m1.4.4.3.4" xref="S2.E4.2.m1.4.4.3.4.cmml">⁢</mo><mrow id="S2.E4.2.m1.4.4.3.3.1" xref="S2.E4.2.m1.4.4.3.3.1.1.cmml"><mo id="S2.E4.2.m1.4.4.3.3.1.2" stretchy="false" xref="S2.E4.2.m1.4.4.3.3.1.1.cmml">(</mo><mrow id="S2.E4.2.m1.4.4.3.3.1.1" xref="S2.E4.2.m1.4.4.3.3.1.1.cmml"><msub id="S2.E4.2.m1.4.4.3.3.1.1.2" xref="S2.E4.2.m1.4.4.3.3.1.1.2.cmml"><mi id="S2.E4.2.m1.4.4.3.3.1.1.2.2" xref="S2.E4.2.m1.4.4.3.3.1.1.2.2.cmml">o</mi><mi id="S2.E4.2.m1.4.4.3.3.1.1.2.3" xref="S2.E4.2.m1.4.4.3.3.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.2.m1.4.4.3.3.1.1.1" xref="S2.E4.2.m1.4.4.3.3.1.1.1.cmml">|</mo><mrow id="S2.E4.2.m1.4.4.3.3.1.1.3.2" xref="S2.E4.2.m1.4.4.3.3.1.1.3.1.cmml"><mi id="S2.E4.2.m1.2.2.1.1" xref="S2.E4.2.m1.2.2.1.1.cmml">θ</mi><mo id="S2.E4.2.m1.4.4.3.3.1.1.3.2.1" xref="S2.E4.2.m1.4.4.3.3.1.1.3.1.cmml">,</mo><mi id="S2.E4.2.m1.3.3.2.2" xref="S2.E4.2.m1.3.3.2.2.cmml">π</mi></mrow></mrow><mo id="S2.E4.2.m1.4.4.3.3.1.3" stretchy="false" xref="S2.E4.2.m1.4.4.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.2.m1.6.6.1.1.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.4" xref="S2.E4.2.m1.6.6.1.1.1.1.1.4.cmml">H</mi><mo id="S2.E4.2.m1.6.6.1.1.1.1.1.2a" xref="S2.E4.2.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.2.m1.5.5" xref="S2.E4.2.m1.5.5.cmml">π</mi></mrow></mrow><mo id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.2.m1.6.6.1.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.1.1.3.cmml">−</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.2.cmml"><mi id="S2.E4.2.m1.6.6.1.1.1.1.2.3" xref="S2.E4.2.m1.6.6.1.1.1.1.2.3.cmml">H</mi><mo id="S2.E4.2.m1.6.6.1.1.1.1.2.2" xref="S2.E4.2.m1.6.6.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.cmml"><msub id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.cmml"><mi id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.2" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.2.cmml">s</mi><mi id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.3" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.1" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.2.m1.6.6.1.1.1.3" xref="S2.E4.2.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.2.m1.6b"><apply id="S2.E4.2.m1.6.6.cmml" xref="S2.E4.2.m1.6.6"><plus id="S2.E4.2.m1.6.6.2.cmml" xref="S2.E4.2.m1.6.6"></plus><apply id="S2.E4.2.m1.6.6.1.cmml" xref="S2.E4.2.m1.6.6.1"><times id="S2.E4.2.m1.6.6.1.2.cmml" xref="S2.E4.2.m1.6.6.1.2"></times><apply id="S2.E4.2.m1.6.6.1.3.cmml" xref="S2.E4.2.m1.6.6.1.3"><csymbol cd="ambiguous" id="S2.E4.2.m1.6.6.1.3.1.cmml" xref="S2.E4.2.m1.6.6.1.3">subscript</csymbol><ci id="S2.E4.2.m1.6.6.1.3.2.cmml" xref="S2.E4.2.m1.6.6.1.3.2">𝔼</ci><apply id="S2.E4.2.m1.1.1.1.cmml" xref="S2.E4.2.m1.1.1.1"><times id="S2.E4.2.m1.1.1.1.2.cmml" xref="S2.E4.2.m1.1.1.1.2"></times><ci id="S2.E4.2.m1.1.1.1.3.cmml" xref="S2.E4.2.m1.1.1.1.3">𝑄</ci><apply id="S2.E4.2.m1.1.1.1.1.1.1.cmml" xref="S2.E4.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E4.2.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E4.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E4.2.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E4.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E4.2.m1.1.1.1.1.1.1.3">𝜋</ci></apply></apply></apply><apply id="S2.E4.2.m1.6.6.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1"><csymbol cd="latexml" id="S2.E4.2.m1.6.6.1.1.2.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.2.m1.6.6.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1"><minus id="S2.E4.2.m1.6.6.1.1.1.1.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.3"></minus><apply id="S2.E4.2.m1.6.6.1.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1"><times id="S2.E4.2.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.2"></times><apply id="S2.E4.2.m1.6.6.1.1.1.1.1.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.2.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E4.2.m1.4.4.3.cmml" xref="S2.E4.2.m1.4.4.3"><times id="S2.E4.2.m1.4.4.3.4.cmml" xref="S2.E4.2.m1.4.4.3.4"></times><ci id="S2.E4.2.m1.4.4.3.5.cmml" xref="S2.E4.2.m1.4.4.3.5">𝑄</ci><apply id="S2.E4.2.m1.4.4.3.3.1.1.cmml" xref="S2.E4.2.m1.4.4.3.3.1"><csymbol cd="latexml" id="S2.E4.2.m1.4.4.3.3.1.1.1.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.1">conditional</csymbol><apply id="S2.E4.2.m1.4.4.3.3.1.1.2.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E4.2.m1.4.4.3.3.1.1.2.1.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.2">subscript</csymbol><ci id="S2.E4.2.m1.4.4.3.3.1.1.2.2.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.2.2">𝑜</ci><ci id="S2.E4.2.m1.4.4.3.3.1.1.2.3.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.2.3">𝜏</ci></apply><list id="S2.E4.2.m1.4.4.3.3.1.1.3.1.cmml" xref="S2.E4.2.m1.4.4.3.3.1.1.3.2"><ci id="S2.E4.2.m1.2.2.1.1.cmml" xref="S2.E4.2.m1.2.2.1.1">𝜃</ci><ci id="S2.E4.2.m1.3.3.2.2.cmml" xref="S2.E4.2.m1.3.3.2.2">𝜋</ci></list></apply></apply></apply><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.4.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.4">𝐻</ci><apply id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.3.3">𝜏</ci></apply><list id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E4.2.m1.5.5.cmml" xref="S2.E4.2.m1.5.5">𝜋</ci></list></apply></apply><apply id="S2.E4.2.m1.6.6.1.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2"><times id="S2.E4.2.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.2"></times><ci id="S2.E4.2.m1.6.6.1.1.1.1.2.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.3">𝐻</ci><apply id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.2">𝑠</ci><ci id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.2.3">𝜏</ci></apply><ci id="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E4.2.m1.6.6.1.1.1.1.2.1.1.1.3">𝜋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.2.m1.6c">\displaystyle\quad+\mathbb{E}_{Q(\theta|\pi)}\left[\,\mathbb{E}_{Q(o_{\tau}|%
\theta,\pi)}H(s_{\tau}|o_{\tau},\pi)-H(s_{\tau}|\pi)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E4.2.m1.6d">+ blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_θ | italic_π ) end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_θ , italic_π ) end_POSTSUBSCRIPT italic_H ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_π ) - italic_H ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_π ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4b)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4.3">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+\mathbb{E}_{Q(\theta|\pi)Q(s_{\tau}|\theta,\pi)}H(o_{\tau}|%
s_{\tau},\theta,\pi)-\mathbb{E}_{Q(s_{\tau}|\pi)}H(o_{\tau}|s_{\tau},\pi)\ ." class="ltx_Math" display="inline" id="S2.E4.3.m1.9"><semantics id="S2.E4.3.m1.9a"><mrow id="S2.E4.3.m1.9.9.1" xref="S2.E4.3.m1.9.9.1.1.cmml"><mrow id="S2.E4.3.m1.9.9.1.1" xref="S2.E4.3.m1.9.9.1.1.cmml"><mrow id="S2.E4.3.m1.9.9.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.cmml"><mo id="S2.E4.3.m1.9.9.1.1.1a" xref="S2.E4.3.m1.9.9.1.1.1.cmml">+</mo><mrow id="S2.E4.3.m1.9.9.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.1.cmml"><msub id="S2.E4.3.m1.9.9.1.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.1.1.3.cmml"><mi id="S2.E4.3.m1.9.9.1.1.1.1.3.2" xref="S2.E4.3.m1.9.9.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.3.m1.4.4.4" xref="S2.E4.3.m1.4.4.4.cmml"><mi id="S2.E4.3.m1.4.4.4.6" xref="S2.E4.3.m1.4.4.4.6.cmml">Q</mi><mo id="S2.E4.3.m1.4.4.4.5" xref="S2.E4.3.m1.4.4.4.5.cmml">⁢</mo><mrow id="S2.E4.3.m1.3.3.3.3.1" xref="S2.E4.3.m1.3.3.3.3.1.1.cmml"><mo id="S2.E4.3.m1.3.3.3.3.1.2" stretchy="false" xref="S2.E4.3.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E4.3.m1.3.3.3.3.1.1" xref="S2.E4.3.m1.3.3.3.3.1.1.cmml"><mi id="S2.E4.3.m1.3.3.3.3.1.1.2" xref="S2.E4.3.m1.3.3.3.3.1.1.2.cmml">θ</mi><mo fence="false" id="S2.E4.3.m1.3.3.3.3.1.1.1" xref="S2.E4.3.m1.3.3.3.3.1.1.1.cmml">|</mo><mi id="S2.E4.3.m1.3.3.3.3.1.1.3" xref="S2.E4.3.m1.3.3.3.3.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.3.m1.3.3.3.3.1.3" stretchy="false" xref="S2.E4.3.m1.3.3.3.3.1.1.cmml">)</mo></mrow><mo id="S2.E4.3.m1.4.4.4.5a" xref="S2.E4.3.m1.4.4.4.5.cmml">⁢</mo><mi id="S2.E4.3.m1.4.4.4.7" xref="S2.E4.3.m1.4.4.4.7.cmml">Q</mi><mo id="S2.E4.3.m1.4.4.4.5b" xref="S2.E4.3.m1.4.4.4.5.cmml">⁢</mo><mrow id="S2.E4.3.m1.4.4.4.4.1" xref="S2.E4.3.m1.4.4.4.4.1.1.cmml"><mo id="S2.E4.3.m1.4.4.4.4.1.2" stretchy="false" xref="S2.E4.3.m1.4.4.4.4.1.1.cmml">(</mo><mrow id="S2.E4.3.m1.4.4.4.4.1.1" xref="S2.E4.3.m1.4.4.4.4.1.1.cmml"><msub id="S2.E4.3.m1.4.4.4.4.1.1.2" xref="S2.E4.3.m1.4.4.4.4.1.1.2.cmml"><mi id="S2.E4.3.m1.4.4.4.4.1.1.2.2" xref="S2.E4.3.m1.4.4.4.4.1.1.2.2.cmml">s</mi><mi id="S2.E4.3.m1.4.4.4.4.1.1.2.3" xref="S2.E4.3.m1.4.4.4.4.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.3.m1.4.4.4.4.1.1.1" xref="S2.E4.3.m1.4.4.4.4.1.1.1.cmml">|</mo><mrow id="S2.E4.3.m1.4.4.4.4.1.1.3.2" xref="S2.E4.3.m1.4.4.4.4.1.1.3.1.cmml"><mi id="S2.E4.3.m1.1.1.1.1" xref="S2.E4.3.m1.1.1.1.1.cmml">θ</mi><mo id="S2.E4.3.m1.4.4.4.4.1.1.3.2.1" xref="S2.E4.3.m1.4.4.4.4.1.1.3.1.cmml">,</mo><mi id="S2.E4.3.m1.2.2.2.2" xref="S2.E4.3.m1.2.2.2.2.cmml">π</mi></mrow></mrow><mo id="S2.E4.3.m1.4.4.4.4.1.3" stretchy="false" xref="S2.E4.3.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.3.m1.9.9.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.3.m1.9.9.1.1.1.1.4" xref="S2.E4.3.m1.9.9.1.1.1.1.4.cmml">H</mi><mo id="S2.E4.3.m1.9.9.1.1.1.1.2a" xref="S2.E4.3.m1.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.3.m1.9.9.1.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.3.m1.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.2.cmml">o</mi><mi id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.3" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.3.m1.6.6" xref="S2.E4.3.m1.6.6.cmml">θ</mi><mo id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.3.m1.7.7" xref="S2.E4.3.m1.7.7.cmml">π</mi></mrow></mrow><mo id="S2.E4.3.m1.9.9.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.3.m1.9.9.1.1.3" xref="S2.E4.3.m1.9.9.1.1.3.cmml">−</mo><mrow id="S2.E4.3.m1.9.9.1.1.2" xref="S2.E4.3.m1.9.9.1.1.2.cmml"><msub id="S2.E4.3.m1.9.9.1.1.2.3" xref="S2.E4.3.m1.9.9.1.1.2.3.cmml"><mi id="S2.E4.3.m1.9.9.1.1.2.3.2" xref="S2.E4.3.m1.9.9.1.1.2.3.2.cmml">𝔼</mi><mrow id="S2.E4.3.m1.5.5.1" xref="S2.E4.3.m1.5.5.1.cmml"><mi id="S2.E4.3.m1.5.5.1.3" xref="S2.E4.3.m1.5.5.1.3.cmml">Q</mi><mo id="S2.E4.3.m1.5.5.1.2" xref="S2.E4.3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E4.3.m1.5.5.1.1.1" xref="S2.E4.3.m1.5.5.1.1.1.1.cmml"><mo id="S2.E4.3.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E4.3.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.E4.3.m1.5.5.1.1.1.1" xref="S2.E4.3.m1.5.5.1.1.1.1.cmml"><msub id="S2.E4.3.m1.5.5.1.1.1.1.2" xref="S2.E4.3.m1.5.5.1.1.1.1.2.cmml"><mi id="S2.E4.3.m1.5.5.1.1.1.1.2.2" xref="S2.E4.3.m1.5.5.1.1.1.1.2.2.cmml">s</mi><mi id="S2.E4.3.m1.5.5.1.1.1.1.2.3" xref="S2.E4.3.m1.5.5.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.3.m1.5.5.1.1.1.1.1" xref="S2.E4.3.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S2.E4.3.m1.5.5.1.1.1.1.3" xref="S2.E4.3.m1.5.5.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.E4.3.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E4.3.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.3.m1.9.9.1.1.2.2" xref="S2.E4.3.m1.9.9.1.1.2.2.cmml">⁢</mo><mi id="S2.E4.3.m1.9.9.1.1.2.4" xref="S2.E4.3.m1.9.9.1.1.2.4.cmml">H</mi><mo id="S2.E4.3.m1.9.9.1.1.2.2a" xref="S2.E4.3.m1.9.9.1.1.2.2.cmml">⁢</mo><mrow id="S2.E4.3.m1.9.9.1.1.2.1.1" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.cmml"><mo id="S2.E4.3.m1.9.9.1.1.2.1.1.2" stretchy="false" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E4.3.m1.9.9.1.1.2.1.1.1" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.cmml"><msub id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.cmml"><mi id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.2" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.2.cmml">o</mi><mi id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.3" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.3.cmml">τ</mi></msub><mo fence="false" id="S2.E4.3.m1.9.9.1.1.2.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.2.cmml">|</mo><mrow id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.2.cmml"><msub id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.3" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.2" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.3.m1.8.8" xref="S2.E4.3.m1.8.8.cmml">π</mi></mrow></mrow><mo id="S2.E4.3.m1.9.9.1.1.2.1.1.3" rspace="0.222em" stretchy="false" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.3.m1.9.9.1.2" xref="S2.E4.3.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.3.m1.9b"><apply id="S2.E4.3.m1.9.9.1.1.cmml" xref="S2.E4.3.m1.9.9.1"><minus id="S2.E4.3.m1.9.9.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.3"></minus><apply id="S2.E4.3.m1.9.9.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1"><plus id="S2.E4.3.m1.9.9.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1"></plus><apply id="S2.E4.3.m1.9.9.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1"><times id="S2.E4.3.m1.9.9.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.2"></times><apply id="S2.E4.3.m1.9.9.1.1.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.1.1.3.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.3.2">𝔼</ci><apply id="S2.E4.3.m1.4.4.4.cmml" xref="S2.E4.3.m1.4.4.4"><times id="S2.E4.3.m1.4.4.4.5.cmml" xref="S2.E4.3.m1.4.4.4.5"></times><ci id="S2.E4.3.m1.4.4.4.6.cmml" xref="S2.E4.3.m1.4.4.4.6">𝑄</ci><apply id="S2.E4.3.m1.3.3.3.3.1.1.cmml" xref="S2.E4.3.m1.3.3.3.3.1"><csymbol cd="latexml" id="S2.E4.3.m1.3.3.3.3.1.1.1.cmml" xref="S2.E4.3.m1.3.3.3.3.1.1.1">conditional</csymbol><ci id="S2.E4.3.m1.3.3.3.3.1.1.2.cmml" xref="S2.E4.3.m1.3.3.3.3.1.1.2">𝜃</ci><ci id="S2.E4.3.m1.3.3.3.3.1.1.3.cmml" xref="S2.E4.3.m1.3.3.3.3.1.1.3">𝜋</ci></apply><ci id="S2.E4.3.m1.4.4.4.7.cmml" xref="S2.E4.3.m1.4.4.4.7">𝑄</ci><apply id="S2.E4.3.m1.4.4.4.4.1.1.cmml" xref="S2.E4.3.m1.4.4.4.4.1"><csymbol cd="latexml" id="S2.E4.3.m1.4.4.4.4.1.1.1.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.1">conditional</csymbol><apply id="S2.E4.3.m1.4.4.4.4.1.1.2.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E4.3.m1.4.4.4.4.1.1.2.1.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.2">subscript</csymbol><ci id="S2.E4.3.m1.4.4.4.4.1.1.2.2.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.2.2">𝑠</ci><ci id="S2.E4.3.m1.4.4.4.4.1.1.2.3.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.2.3">𝜏</ci></apply><list id="S2.E4.3.m1.4.4.4.4.1.1.3.1.cmml" xref="S2.E4.3.m1.4.4.4.4.1.1.3.2"><ci id="S2.E4.3.m1.1.1.1.1.cmml" xref="S2.E4.3.m1.1.1.1.1">𝜃</ci><ci id="S2.E4.3.m1.2.2.2.2.cmml" xref="S2.E4.3.m1.2.2.2.2">𝜋</ci></list></apply></apply></apply><ci id="S2.E4.3.m1.9.9.1.1.1.1.4.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.4">𝐻</ci><apply id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.3.3">𝜏</ci></apply><list id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1"><apply id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E4.3.m1.6.6.cmml" xref="S2.E4.3.m1.6.6">𝜃</ci><ci id="S2.E4.3.m1.7.7.cmml" xref="S2.E4.3.m1.7.7">𝜋</ci></list></apply></apply></apply><apply id="S2.E4.3.m1.9.9.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2"><times id="S2.E4.3.m1.9.9.1.1.2.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.2"></times><apply id="S2.E4.3.m1.9.9.1.1.2.3.cmml" xref="S2.E4.3.m1.9.9.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.2.3.1.cmml" xref="S2.E4.3.m1.9.9.1.1.2.3">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.2.3.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.3.2">𝔼</ci><apply id="S2.E4.3.m1.5.5.1.cmml" xref="S2.E4.3.m1.5.5.1"><times id="S2.E4.3.m1.5.5.1.2.cmml" xref="S2.E4.3.m1.5.5.1.2"></times><ci id="S2.E4.3.m1.5.5.1.3.cmml" xref="S2.E4.3.m1.5.5.1.3">𝑄</ci><apply id="S2.E4.3.m1.5.5.1.1.1.1.cmml" xref="S2.E4.3.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E4.3.m1.5.5.1.1.1.1.1.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="S2.E4.3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.3.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.3.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.2.2">𝑠</ci><ci id="S2.E4.3.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.2.3">𝜏</ci></apply><ci id="S2.E4.3.m1.5.5.1.1.1.1.3.cmml" xref="S2.E4.3.m1.5.5.1.1.1.1.3">𝜋</ci></apply></apply></apply><ci id="S2.E4.3.m1.9.9.1.1.2.4.cmml" xref="S2.E4.3.m1.9.9.1.1.2.4">𝐻</ci><apply id="S2.E4.3.m1.9.9.1.1.2.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1"><csymbol cd="latexml" id="S2.E4.3.m1.9.9.1.1.2.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.2">conditional</csymbol><apply id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.1.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.2">𝑜</ci><ci id="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.3.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.3.3">𝜏</ci></apply><list id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1"><apply id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.3.m1.9.9.1.1.2.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S2.E4.3.m1.8.8.cmml" xref="S2.E4.3.m1.8.8">𝜋</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.3.m1.9c">\displaystyle\quad+\mathbb{E}_{Q(\theta|\pi)Q(s_{\tau}|\theta,\pi)}H(o_{\tau}|%
s_{\tau},\theta,\pi)-\mathbb{E}_{Q(s_{\tau}|\pi)}H(o_{\tau}|s_{\tau},\pi)\ .</annotation><annotation encoding="application/x-llamapun" id="S2.E4.3.m1.9d">+ blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_θ | italic_π ) italic_Q ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_θ , italic_π ) end_POSTSUBSCRIPT italic_H ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_θ , italic_π ) - blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_π ) end_POSTSUBSCRIPT italic_H ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , italic_π ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4c)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.2">Conceptually, the contribution of each term in the EFE can be interpreted as follows <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>: Extrinsic value (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4.1" title="In 4 ‣ 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4a</span></a>) — the expected <span class="ltx_text ltx_font_italic" id="S2.SS1.p5.2.1">surprise</span>, which measures the mismatch between the outcomes predicted under policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">italic_π</annotation></semantics></math> and the agent’s prior preferences over outcomes. This term is analogous to reward in RL, as it quantifies the misalignment between predicted and preferred outcomes. However, rather than maximizing cumulative reward, the agent minimizes surprise relative to preferred observations. State epistemic uncertainty (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4.2" title="In 4 ‣ 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4b</span></a>) — mutual information between the agent’s beliefs about states before and after obtaining new observations. This term incentivizes exploration of regions in the environment that reduce uncertainty about latent states <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. Parameter epistemic uncertainty (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4.3" title="In 4 ‣ 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4c</span></a>) — the expected information gain about model parameters given new observations. This term also corresponds to active learning or curiosity <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>, and reflects the role of model parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><mi id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><ci id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">italic_θ</annotation></semantics></math> in generating predictions. The last two terms capture distinct forms of epistemic uncertainty, providing an intrinsic drive for the agent to explore and refine its generative model. They play a role analogous to intrinsic rewards in RL that balance the exploration–exploitation trade-off. Similar information-seeking or curiosity signals underpin many successful RL algorithms—ranging from curiosity-driven bonuses <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib36" title="">pathak2017curiosity </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib37" title="">burda2018exploration </a></cite> to the entropy-regularized objective optimized by Soft Actor-Critic <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib38" title="">haarnoja2018soft </a></cite>—and have been shown to yield strong, sample-efficient agents.</p>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="467" id="S2.F1.1.g1" src="x1.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="467" id="S2.F1.2.g1" src="x2.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.4.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.5.2" style="font-size:90%;">Two perspectives of the AIF framework: general steps (left) and core elements (right).</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1">In summary (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.F1" title="Figure 1 ‣ 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a>), the framework is realized through a mathematical formalism that unfolds as follows: An observation is ingested and propagated through the generative model, yielding a perceptual update—beliefs about current and future states. These beliefs enable computation of the EFE (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4</span></a>), which is used during planning to select actions. After the next observation arrives, the VFE (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E1" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a>) is evaluated and used to calibrate—learn—the model by matching the new observation to the prior prediction. Each iteration optimizes the model with the VFE from the previous loop, and the updated model then guides subsequent inference for planning and action.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Planning Strategy</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Agents based on MBRL typically leverage their world model to <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.1">imagine</em> future trajectories before acting, trading extra computation for large gains in sample-efficiency and performance. Monte Carlo Tree Search (MCTS) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib39" title="">coulom2006efficient </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib40" title="">silver2017mastering </a></cite> is a notable search algorithm, which selectively explores promising trajectories in a restricted manner. Its effectiveness was highlighted in <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.2">AlphaGo Zero</em> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib40" title="">silver2017mastering </a></cite> and later by <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.3">MuZero</em>, which folds a learned latent dynamics model directly into the search loop <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib41" title="">schrittwieser2020mastering </a></cite>. In the AIF concept, the agent’s planning before taking actions is to minimize the EFE; mathematically, it corresponds to the negative accumulated EFE <math alttext="G" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_G</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(\pi)\stackrel{{\scriptstyle}}{{=}}{\sigma}(-G(\pi))\ {=}\ \sigma\left(-\sum_%
{\tau&gt;t}{G}(\pi,\tau)\right)\ ," class="ltx_Math" display="block" id="S2.E5.m1.5"><semantics id="S2.E5.m1.5a"><mrow id="S2.E5.m1.5.5.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1.4" xref="S2.E5.m1.5.5.1.1.4.cmml"><mi id="S2.E5.m1.5.5.1.1.4.2" xref="S2.E5.m1.5.5.1.1.4.2.cmml">P</mi><mo id="S2.E5.m1.5.5.1.1.4.1" xref="S2.E5.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.4.3.2" xref="S2.E5.m1.5.5.1.1.4.cmml"><mo id="S2.E5.m1.5.5.1.1.4.3.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.4.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">π</mi><mo id="S2.E5.m1.5.5.1.1.4.3.2.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.4.cmml">)</mo></mrow></mrow><mover id="S2.E5.m1.5.5.1.1.5" xref="S2.E5.m1.5.5.1.1.5.cmml"><mo id="S2.E5.m1.5.5.1.1.5.2" xref="S2.E5.m1.5.5.1.1.5.2.cmml">=</mo><mi id="S2.E5.m1.5.5.1.1.5.3" xref="S2.E5.m1.5.5.1.1.5.3.cmml"></mi></mover><mrow id="S2.E5.m1.5.5.1.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml"><mi id="S2.E5.m1.5.5.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.3.cmml">σ</mi><mo id="S2.E5.m1.5.5.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.5.5.1.1.1.1.1.1a" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml">G</mi><mo id="S2.E5.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S2.E5.m1.5.5.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">π</mi><mo id="S2.E5.m1.5.5.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.1.1.1.3" rspace="0.500em" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.6" rspace="0.778em" xref="S2.E5.m1.5.5.1.1.6.cmml">=</mo><mrow id="S2.E5.m1.5.5.1.1.2" xref="S2.E5.m1.5.5.1.1.2.cmml"><mi id="S2.E5.m1.5.5.1.1.2.3" xref="S2.E5.m1.5.5.1.1.2.3.cmml">σ</mi><mo id="S2.E5.m1.5.5.1.1.2.2" xref="S2.E5.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2.1.1.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2.1.1.1a" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml">−</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.cmml"><munder id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.2" movablelimits="false" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.2.cmml">∑</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.cmml"><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.2.cmml">τ</mi><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.1.cmml">&gt;</mo><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.3" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.3.cmml">t</mi></mrow></munder><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml"><mi id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">G</mi><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.1" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.1.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">π</mi><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.2.2" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml">τ</mi><mo id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.2.3" stretchy="false" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.2.1.1.3" rspace="0.500em" xref="S2.E5.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.5.5.1.2" xref="S2.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.5b"><apply id="S2.E5.m1.5.5.1.1.cmml" xref="S2.E5.m1.5.5.1"><and id="S2.E5.m1.5.5.1.1a.cmml" xref="S2.E5.m1.5.5.1"></and><apply id="S2.E5.m1.5.5.1.1b.cmml" xref="S2.E5.m1.5.5.1"><apply id="S2.E5.m1.5.5.1.1.5.cmml" xref="S2.E5.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.5.1.cmml" xref="S2.E5.m1.5.5.1.1.5">superscript</csymbol><eq id="S2.E5.m1.5.5.1.1.5.2.cmml" xref="S2.E5.m1.5.5.1.1.5.2"></eq><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.5.3.cmml" xref="S2.E5.m1.5.5.1.1.5.3">absent</csymbol></apply><apply id="S2.E5.m1.5.5.1.1.4.cmml" xref="S2.E5.m1.5.5.1.1.4"><times id="S2.E5.m1.5.5.1.1.4.1.cmml" xref="S2.E5.m1.5.5.1.1.4.1"></times><ci id="S2.E5.m1.5.5.1.1.4.2.cmml" xref="S2.E5.m1.5.5.1.1.4.2">𝑃</ci><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝜋</ci></apply><apply id="S2.E5.m1.5.5.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1"><times id="S2.E5.m1.5.5.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.2"></times><ci id="S2.E5.m1.5.5.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.3">𝜎</ci><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1"><minus id="S2.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1"></minus><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2"><times id="S2.E5.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.1"></times><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.2">𝐺</ci><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝜋</ci></apply></apply></apply></apply><apply id="S2.E5.m1.5.5.1.1c.cmml" xref="S2.E5.m1.5.5.1"><eq id="S2.E5.m1.5.5.1.1.6.cmml" xref="S2.E5.m1.5.5.1.1.6"></eq><share href="https://arxiv.org/html/2505.19867v1#S2.E5.m1.5.5.1.1.1.cmml" id="S2.E5.m1.5.5.1.1d.cmml" xref="S2.E5.m1.5.5.1"></share><apply id="S2.E5.m1.5.5.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2"><times id="S2.E5.m1.5.5.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.2.2"></times><ci id="S2.E5.m1.5.5.1.1.2.3.cmml" xref="S2.E5.m1.5.5.1.1.2.3">𝜎</ci><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1"><minus id="S2.E5.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1"></minus><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2"><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1">subscript</csymbol><sum id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.2"></sum><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3"><gt id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.1"></gt><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.2">𝜏</ci><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.1.3.3">𝑡</ci></apply></apply><apply id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2"><times id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.1"></times><ci id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.2.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.2">𝐺</ci><interval closure="open" id="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1.1.1.2.2.3.2"><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝜋</ci><ci id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4">𝜏</ci></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.5c">P(\pi)\stackrel{{\scriptstyle}}{{=}}{\sigma}(-G(\pi))\ {=}\ \sigma\left(-\sum_%
{\tau&gt;t}{G}(\pi,\tau)\right)\ ,</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.5d">italic_P ( italic_π ) start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG end_ARG end_RELOP italic_σ ( - italic_G ( italic_π ) ) = italic_σ ( - ∑ start_POSTSUBSCRIPT italic_τ &gt; italic_t end_POSTSUBSCRIPT italic_G ( italic_π , italic_τ ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.8">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m1.1"><semantics id="S2.SS2.p1.2.m1.1a"><mrow id="S2.SS2.p1.2.m1.1.2" xref="S2.SS2.p1.2.m1.1.2.cmml"><mi id="S2.SS2.p1.2.m1.1.2.2" xref="S2.SS2.p1.2.m1.1.2.2.cmml">σ</mi><mo id="S2.SS2.p1.2.m1.1.2.1" xref="S2.SS2.p1.2.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.2.m1.1.2.3.2" xref="S2.SS2.p1.2.m1.1.2.cmml"><mo id="S2.SS2.p1.2.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.2.m1.1.2.cmml">(</mo><mo id="S2.SS2.p1.2.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.2.m1.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.2.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m1.1b"><apply id="S2.SS2.p1.2.m1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.2"><times id="S2.SS2.p1.2.m1.1.2.1.cmml" xref="S2.SS2.p1.2.m1.1.2.1"></times><ci id="S2.SS2.p1.2.m1.1.2.2.cmml" xref="S2.SS2.p1.2.m1.1.2.2">𝜎</ci><ci id="S2.SS2.p1.2.m1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> represents the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.8.1">Softmax</em> function. The agent simulates possible trajectories via roll-outs from its generative model, under policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m2.1"><semantics id="S2.SS2.p1.3.m2.1a"><mi id="S2.SS2.p1.3.m2.1.1" xref="S2.SS2.p1.3.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m2.1b"><ci id="S2.SS2.p1.3.m2.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m2.1d">italic_π</annotation></semantics></math>, to evaluate the EFE. However, calculating this for any possible <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m3.1"><semantics id="S2.SS2.p1.4.m3.1a"><mi id="S2.SS2.p1.4.m3.1.1" xref="S2.SS2.p1.4.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m3.1b"><ci id="S2.SS2.p1.4.m3.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m3.1d">italic_π</annotation></semantics></math> is infeasible as the policy space grows exponentially with the depth of planning. Fountas et al. (2020) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> an auxiliary module along with the MCTS to alleviate this obstacle. They proposed a recognition module <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib42" title="">piche2018probabilistic </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib43" title="">marino2018iterative </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib44" title="">tschantz2020control </a></cite>, parameterized with <math alttext="{\phi}_{a}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m4.1"><semantics id="S2.SS2.p1.5.m4.1a"><msub id="S2.SS2.p1.5.m4.1.1" xref="S2.SS2.p1.5.m4.1.1.cmml"><mi id="S2.SS2.p1.5.m4.1.1.2" xref="S2.SS2.p1.5.m4.1.1.2.cmml">ϕ</mi><mi id="S2.SS2.p1.5.m4.1.1.3" xref="S2.SS2.p1.5.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m4.1b"><apply id="S2.SS2.p1.5.m4.1.1.cmml" xref="S2.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m4.1.1.1.cmml" xref="S2.SS2.p1.5.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m4.1.1.2.cmml" xref="S2.SS2.p1.5.m4.1.1.2">italic-ϕ</ci><ci id="S2.SS2.p1.5.m4.1.1.3.cmml" xref="S2.SS2.p1.5.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m4.1c">{\phi}_{a}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m4.1d">italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> as follows: <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.8.2">Habit</em>, <math alttext="Q_{\phi_{a}}(a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m5.1"><semantics id="S2.SS2.p1.6.m5.1a"><mrow id="S2.SS2.p1.6.m5.1.1" xref="S2.SS2.p1.6.m5.1.1.cmml"><msub id="S2.SS2.p1.6.m5.1.1.3" xref="S2.SS2.p1.6.m5.1.1.3.cmml"><mi id="S2.SS2.p1.6.m5.1.1.3.2" xref="S2.SS2.p1.6.m5.1.1.3.2.cmml">Q</mi><msub id="S2.SS2.p1.6.m5.1.1.3.3" xref="S2.SS2.p1.6.m5.1.1.3.3.cmml"><mi id="S2.SS2.p1.6.m5.1.1.3.3.2" xref="S2.SS2.p1.6.m5.1.1.3.3.2.cmml">ϕ</mi><mi id="S2.SS2.p1.6.m5.1.1.3.3.3" xref="S2.SS2.p1.6.m5.1.1.3.3.3.cmml">a</mi></msub></msub><mo id="S2.SS2.p1.6.m5.1.1.2" xref="S2.SS2.p1.6.m5.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.1.1.1.1" xref="S2.SS2.p1.6.m5.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.6.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.6.m5.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.6.m5.1.1.1.1.1" xref="S2.SS2.p1.6.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m5.1.1.1.1.1.2" xref="S2.SS2.p1.6.m5.1.1.1.1.1.2.cmml">a</mi><mi id="S2.SS2.p1.6.m5.1.1.1.1.1.3" xref="S2.SS2.p1.6.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.6.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.6.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m5.1b"><apply id="S2.SS2.p1.6.m5.1.1.cmml" xref="S2.SS2.p1.6.m5.1.1"><times id="S2.SS2.p1.6.m5.1.1.2.cmml" xref="S2.SS2.p1.6.m5.1.1.2"></times><apply id="S2.SS2.p1.6.m5.1.1.3.cmml" xref="S2.SS2.p1.6.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m5.1.1.3.1.cmml" xref="S2.SS2.p1.6.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.6.m5.1.1.3.2.cmml" xref="S2.SS2.p1.6.m5.1.1.3.2">𝑄</ci><apply id="S2.SS2.p1.6.m5.1.1.3.3.cmml" xref="S2.SS2.p1.6.m5.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m5.1.1.3.3.1.cmml" xref="S2.SS2.p1.6.m5.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.6.m5.1.1.3.3.2.cmml" xref="S2.SS2.p1.6.m5.1.1.3.3.2">italic-ϕ</ci><ci id="S2.SS2.p1.6.m5.1.1.3.3.3.cmml" xref="S2.SS2.p1.6.m5.1.1.3.3.3">𝑎</ci></apply></apply><apply id="S2.SS2.p1.6.m5.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m5.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.6.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m5.1c">Q_{\phi_{a}}(a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m5.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, which approximates the posterior distribution over actions using the prior <math alttext="{P}({a}_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m6.1"><semantics id="S2.SS2.p1.7.m6.1a"><mrow id="S2.SS2.p1.7.m6.1.1" xref="S2.SS2.p1.7.m6.1.1.cmml"><mi id="S2.SS2.p1.7.m6.1.1.3" xref="S2.SS2.p1.7.m6.1.1.3.cmml">P</mi><mo id="S2.SS2.p1.7.m6.1.1.2" xref="S2.SS2.p1.7.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.7.m6.1.1.1.1" xref="S2.SS2.p1.7.m6.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.7.m6.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.7.m6.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.7.m6.1.1.1.1.1" xref="S2.SS2.p1.7.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.7.m6.1.1.1.1.1.2" xref="S2.SS2.p1.7.m6.1.1.1.1.1.2.cmml">a</mi><mi id="S2.SS2.p1.7.m6.1.1.1.1.1.3" xref="S2.SS2.p1.7.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.7.m6.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m6.1b"><apply id="S2.SS2.p1.7.m6.1.1.cmml" xref="S2.SS2.p1.7.m6.1.1"><times id="S2.SS2.p1.7.m6.1.1.2.cmml" xref="S2.SS2.p1.7.m6.1.1.2"></times><ci id="S2.SS2.p1.7.m6.1.1.3.cmml" xref="S2.SS2.p1.7.m6.1.1.3">𝑃</ci><apply id="S2.SS2.p1.7.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m6.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.7.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m6.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m6.1c">{P}({a}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m6.1d">italic_P ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> that is returned from the MCTS <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. This is similar to the fast and habitual decision-making in biological agents <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib45" title="">van2012information </a></cite>. They used this module for fast expansions of the search tree during planning, followed by calculating the EFE of the leaf nodes and backpropagating over the trajectory. Iteratively, it results in a weighted tree with memory updates for the visited nodes. They also used the Kullback–Leibler divergence between the planner’s policy and the habit provides as precision to modulate the latent state <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. Another approach to enhance the planning is using a <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.8.3">hybrid horizon</em> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite>, in which the short-sighted EFE terms—based on immediate next-step predictions—are augmented with an additional term during planning to account for longer horizons. Taheri Yeganeh et al. (2024) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite> employed a Q-value network, <math alttext="Q_{\phi_{a}}(a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m7.1"><semantics id="S2.SS2.p1.8.m7.1a"><mrow id="S2.SS2.p1.8.m7.1.1" xref="S2.SS2.p1.8.m7.1.1.cmml"><msub id="S2.SS2.p1.8.m7.1.1.3" xref="S2.SS2.p1.8.m7.1.1.3.cmml"><mi id="S2.SS2.p1.8.m7.1.1.3.2" xref="S2.SS2.p1.8.m7.1.1.3.2.cmml">Q</mi><msub id="S2.SS2.p1.8.m7.1.1.3.3" xref="S2.SS2.p1.8.m7.1.1.3.3.cmml"><mi id="S2.SS2.p1.8.m7.1.1.3.3.2" xref="S2.SS2.p1.8.m7.1.1.3.3.2.cmml">ϕ</mi><mi id="S2.SS2.p1.8.m7.1.1.3.3.3" xref="S2.SS2.p1.8.m7.1.1.3.3.3.cmml">a</mi></msub></msub><mo id="S2.SS2.p1.8.m7.1.1.2" xref="S2.SS2.p1.8.m7.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.8.m7.1.1.1.1" xref="S2.SS2.p1.8.m7.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.8.m7.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.8.m7.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.8.m7.1.1.1.1.1" xref="S2.SS2.p1.8.m7.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.8.m7.1.1.1.1.1.2" xref="S2.SS2.p1.8.m7.1.1.1.1.1.2.cmml">a</mi><mi id="S2.SS2.p1.8.m7.1.1.1.1.1.3" xref="S2.SS2.p1.8.m7.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.8.m7.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.8.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m7.1b"><apply id="S2.SS2.p1.8.m7.1.1.cmml" xref="S2.SS2.p1.8.m7.1.1"><times id="S2.SS2.p1.8.m7.1.1.2.cmml" xref="S2.SS2.p1.8.m7.1.1.2"></times><apply id="S2.SS2.p1.8.m7.1.1.3.cmml" xref="S2.SS2.p1.8.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m7.1.1.3.1.cmml" xref="S2.SS2.p1.8.m7.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.8.m7.1.1.3.2.cmml" xref="S2.SS2.p1.8.m7.1.1.3.2">𝑄</ci><apply id="S2.SS2.p1.8.m7.1.1.3.3.cmml" xref="S2.SS2.p1.8.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m7.1.1.3.3.1.cmml" xref="S2.SS2.p1.8.m7.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.8.m7.1.1.3.3.2.cmml" xref="S2.SS2.p1.8.m7.1.1.3.3.2">italic-ϕ</ci><ci id="S2.SS2.p1.8.m7.1.1.3.3.3.cmml" xref="S2.SS2.p1.8.m7.1.1.3.3.3">𝑎</ci></apply></apply><apply id="S2.SS2.p1.8.m7.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m7.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.8.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m7.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.8.m7.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.8.m7.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.8.m7.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m7.1c">Q_{\phi_{a}}(a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m7.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, to represent the amortized inference of actions, trained in a model-free manner using extrinsic values. These terms were then combined in the planner as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(a_{t})=\gamma\cdot Q_{\phi_{a}}(a_{t})+(1-\gamma)\cdot{\sigma}\left(-G(\pi)%
\right)\ ," class="ltx_Math" display="block" id="S2.E6.m1.2"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.3.cmml">P</mi><mo id="S2.E6.m1.2.2.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E6.m1.2.2.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml">a</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E6.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.5" xref="S2.E6.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E6.m1.2.2.1.1.4" xref="S2.E6.m1.2.2.1.1.4.cmml"><mrow id="S2.E6.m1.2.2.1.1.2.1" xref="S2.E6.m1.2.2.1.1.2.1.cmml"><mrow id="S2.E6.m1.2.2.1.1.2.1.3" xref="S2.E6.m1.2.2.1.1.2.1.3.cmml"><mi id="S2.E6.m1.2.2.1.1.2.1.3.2" xref="S2.E6.m1.2.2.1.1.2.1.3.2.cmml">γ</mi><mo id="S2.E6.m1.2.2.1.1.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E6.m1.2.2.1.1.2.1.3.1.cmml">⋅</mo><msub id="S2.E6.m1.2.2.1.1.2.1.3.3" xref="S2.E6.m1.2.2.1.1.2.1.3.3.cmml"><mi id="S2.E6.m1.2.2.1.1.2.1.3.3.2" xref="S2.E6.m1.2.2.1.1.2.1.3.3.2.cmml">Q</mi><msub id="S2.E6.m1.2.2.1.1.2.1.3.3.3" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3.cmml"><mi id="S2.E6.m1.2.2.1.1.2.1.3.3.3.2" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3.2.cmml">ϕ</mi><mi id="S2.E6.m1.2.2.1.1.2.1.3.3.3.3" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3.3.cmml">a</mi></msub></msub></mrow><mo id="S2.E6.m1.2.2.1.1.2.1.2" xref="S2.E6.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.2.1.1.1" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.2.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S2.E6.m1.2.2.1.1.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml">a</mi><mi id="S2.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E6.m1.2.2.1.1.2.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.4.4" xref="S2.E6.m1.2.2.1.1.4.4.cmml">+</mo><mrow id="S2.E6.m1.2.2.1.1.4.3" xref="S2.E6.m1.2.2.1.1.4.3.cmml"><mrow id="S2.E6.m1.2.2.1.1.3.2.1" xref="S2.E6.m1.2.2.1.1.3.2.1.cmml"><mrow id="S2.E6.m1.2.2.1.1.3.2.1.1.1" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.3.2.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml"><mn id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.2.cmml">1</mn><mo id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.1.cmml">−</mo><mi id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S2.E6.m1.2.2.1.1.3.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.2.2.1.1.3.2.1.2" rspace="0.222em" xref="S2.E6.m1.2.2.1.1.3.2.1.2.cmml">⋅</mo><mi id="S2.E6.m1.2.2.1.1.3.2.1.3" xref="S2.E6.m1.2.2.1.1.3.2.1.3.cmml">σ</mi></mrow><mo id="S2.E6.m1.2.2.1.1.4.3.3" xref="S2.E6.m1.2.2.1.1.4.3.3.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.4.3.2.1" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.2" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.1.1.4.3.2.1.1" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.1a" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml">−</mo><mrow id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.cmml"><mi id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.2" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.2.cmml">G</mi><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.1" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.1.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.3.2" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.cmml"><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.3.2.1" stretchy="false" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">π</mi><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.3.2.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.2.2.1.1.4.3.2.1.3" rspace="0.500em" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.1.1.cmml" xref="S2.E6.m1.2.2.1"><eq id="S2.E6.m1.2.2.1.1.5.cmml" xref="S2.E6.m1.2.2.1.1.5"></eq><apply id="S2.E6.m1.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><times id="S2.E6.m1.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.2"></times><ci id="S2.E6.m1.2.2.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.3">𝑃</ci><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E6.m1.2.2.1.1.4.cmml" xref="S2.E6.m1.2.2.1.1.4"><plus id="S2.E6.m1.2.2.1.1.4.4.cmml" xref="S2.E6.m1.2.2.1.1.4.4"></plus><apply id="S2.E6.m1.2.2.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1"><times id="S2.E6.m1.2.2.1.1.2.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.2"></times><apply id="S2.E6.m1.2.2.1.1.2.1.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3"><ci id="S2.E6.m1.2.2.1.1.2.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.1">⋅</ci><ci id="S2.E6.m1.2.2.1.1.2.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.2">𝛾</ci><apply id="S2.E6.m1.2.2.1.1.2.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.2.1.3.3.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.2.1.3.3.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3.2">𝑄</ci><apply id="S2.E6.m1.2.2.1.1.2.1.3.3.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.2.1.3.3.3.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.2.1.3.3.3.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3.2">italic-ϕ</ci><ci id="S2.E6.m1.2.2.1.1.2.1.3.3.3.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.3.3.3.3">𝑎</ci></apply></apply></apply><apply id="S2.E6.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.2">𝑎</ci><ci id="S2.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.2.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E6.m1.2.2.1.1.4.3.cmml" xref="S2.E6.m1.2.2.1.1.4.3"><times id="S2.E6.m1.2.2.1.1.4.3.3.cmml" xref="S2.E6.m1.2.2.1.1.4.3.3"></times><apply id="S2.E6.m1.2.2.1.1.3.2.1.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1"><ci id="S2.E6.m1.2.2.1.1.3.2.1.2.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1.2">⋅</ci><apply id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1"><minus id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.1"></minus><cn id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.2.cmml" type="integer" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.2">1</cn><ci id="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1.1.1.1.3">𝛾</ci></apply><ci id="S2.E6.m1.2.2.1.1.3.2.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3.2.1.3">𝜎</ci></apply><apply id="S2.E6.m1.2.2.1.1.4.3.2.1.1.cmml" xref="S2.E6.m1.2.2.1.1.4.3.2.1"><minus id="S2.E6.m1.2.2.1.1.4.3.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.4.3.2.1"></minus><apply id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2"><times id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.1"></times><ci id="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.4.3.2.1.1.2.2">𝐺</ci><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝜋</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">P(a_{t})=\gamma\cdot Q_{\phi_{a}}(a_{t})+(1-\gamma)\cdot{\sigma}\left(-G(\pi)%
\right)\ ,</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.2d">italic_P ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_γ ⋅ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + ( 1 - italic_γ ) ⋅ italic_σ ( - italic_G ( italic_π ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.9">balancing long<span class="ltx_text" id="S2.SS2.p1.9.1">-</span>horizon extrinsic value against short<span class="ltx_text" id="S2.SS2.p1.9.2">-</span>horizon epistemic drive.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Modern world<span class="ltx_text" id="S2.SS2.p2.1.1">-</span>model agents increasingly shift the look<span class="ltx_text" id="S2.SS2.p2.1.2">-</span>ahead into latent space; PlaNet <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib21" title="">hafner2019learning </a></cite> uses cross<span class="ltx_text" id="S2.SS2.p2.1.3">-</span>entropy method roll<span class="ltx_text" id="S2.SS2.p2.1.4">-</span>outs inside a RSSM trained with <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.1.5">latent overshooting</em>, while the Dreamer family <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a></cite> propagates analytic value gradients through hundreds of imagined trajectories, without a tree search. EfficientZero <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib46" title="">ye2021mastering </a></cite> blends AlphaZero<span class="ltx_text" id="S2.SS2.p2.1.6">-</span>style MCTS with latent<span class="ltx_text" id="S2.SS2.p2.1.7">-</span>space imagination, surpassing human Atari performance with only 100k frames. These approaches typically couple multi<span class="ltx_text" id="S2.SS2.p2.1.8">-</span>step model roll<span class="ltx_text" id="S2.SS2.p2.1.9">-</span>outs with an actor (policy) and often a critic (value) network that are queried during imagination. In each simulated step, the policy proposes the next action and the critic supplies a bootstrapped value, enabling efficient multi<span class="ltx_text" id="S2.SS2.p2.1.10">-</span>step look<span class="ltx_text" id="S2.SS2.p2.1.11">-</span>ahead without enumerating the full action tree. Instead of sequentially sampling actions and states, Taheri Yeganeh et al . <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite> trained multi<span class="ltx_text" id="S2.SS2.p2.1.12">-</span>step latent transitions, conditioned on repeated actions; during planning, a single transition predicts the outcome while keeping an action for a fixed number of time<span class="ltx_text" id="S2.SS2.p2.1.13">-</span>steps. This way, the impact of actions over a long horizon is captured using repeated-action simulations. While it can be combined with MCTS, this approximation helped distinguish different actions based on the EFE in highly stochastic control tasks with a single look-ahead <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite>. It is limited to discrete actions, cannot go beyond repeated actions, and still requires planning via EFE computation before every action.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Deep Active Inference Agent</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">From habit-integrated MCTS to hybrid-horizon and gradient-based latent imagination, state-of-the-art agents increasingly integrate policy learning with planning to capture the long-term effects essential for scalable and sample-efficient control. A prominent approach is latent imagination, notably used by Dreamer agents <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib21" title="">hafner2019learning </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a></cite>, which perform sequential rollouts in latent space using a RSSM. Besides its computational burden, this method risks accumulating errors as networks are repeatedly inferred and sampled. These models embed the policy network in the latent space by sampling actions along each latent-state trajectory, so policy optimization depends on a large number of samplings in the model’s imaginations.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">A simpler strategy assumes a generative model that <em class="ltx_emph ltx_font_italic" id="S3.p2.1.1">knows</em> the exact form of the policy function—in other words, the network parameters themselves. We can train such a model to generate a prediction deep into the horizon with a single look-ahead, once provided with the policy parameters governing interaction with the environment over that horizon. Thus, the EFE can be computed directly over the horizon, and gradients can be backpropagated to minimize the EFE, thereby guiding the agent toward its intrinsic and extrinsic objectives. Given that the policy is optimized through the gradient steps of the EFE, this approach naturally scales to both discrete and continuous action spaces rather than choosing discrete actions, as in earlier AIF-agent implementations<cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>. Here, we adopt this AIF-consistent generative-policy modeling, without incorporating further mechanisms typically employed to further enhance world models or AIF agents.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Architecture</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.15">The agent comprises, at a minimum, a <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.1">policy network</span> that directly interacts with the environment and a <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.2">generative model</span> that is trained to optimize that policy. Conditioned on the policy, the generative model constitutes the core of AIF and can be instantiated with various architectures. In this work we adopt a generic—yet commonly used—autoencoder assembly <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> to instantiate the formalism of Sec. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.SS1" title="2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">2.1</span></a>, which requires the tightly coupled modules illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S3.F2" title="Figure 2 ‣ 3.1 Architecture ‣ 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">2</span></a>. Leveraging amortization <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib20" title="">kingma2013auto </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib43" title="">marino2018iterative </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib47" title="">gershman2014amortized </a></cite> to scale inference <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>, the generative model is parameterized by two sets: <math alttext="\theta=\{\theta_{s},\theta_{o}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml"><mi id="S3.SS1.p1.1.m1.2.2.4" xref="S3.SS1.p1.1.m1.2.2.4.cmml">θ</mi><mo id="S3.SS1.p1.1.m1.2.2.3" xref="S3.SS1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml"><mo id="S3.SS1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p1.1.m1.2.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.SS1.p1.1.m1.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml">o</mi></msub><mo id="S3.SS1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2"><eq id="S3.SS1.p1.1.m1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.3"></eq><ci id="S3.SS1.p1.1.m1.2.2.4.cmml" xref="S3.SS1.p1.1.m1.2.2.4">𝜃</ci><set id="S3.SS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3">𝑜</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">\theta=\{\theta_{s},\theta_{o}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">italic_θ = { italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT }</annotation></semantics></math> for prior generation and <math alttext="\phi=\{\phi_{s}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">ϕ</mi><mo id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><eq id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"></eq><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">italic-ϕ</ci><set id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">𝑠</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\phi=\{\phi_{s}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_ϕ = { italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math> for recognition. Accordingly, the <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.3">Encoder</span> <math alttext="Q_{\phi_{s}}(s_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">Q</mi><msub id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml">ϕ</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><times id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"></times><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑄</ci><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">italic-ϕ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">Q_{\phi_{s}}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> performs amortized inference by mapping the currently sampled observation <math alttext="\tilde{o}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">o</mi><mo id="S3.SS1.p1.4.m4.1.1.2.1" xref="S3.SS1.p1.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><ci id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2.1">~</ci><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝑜</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\tilde{o}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to a posterior distribution over the latent state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑠</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib48" title="">margossian2023amortized </a></cite>. The key difference here is that, rather than sampling actions inside the latent dynamics, we incorporate a policy function—or <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.4">Actor</span>—<math alttext="Q_{\phi_{a}}(a_{t}\!\mid\!\tilde{o}_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">Q</mi><msub id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.2.cmml">ϕ</mi><mi id="S3.SS1.p1.6.m6.1.1.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.cmml">a</mi></msub></msub><mo id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1.1.1.1" rspace="0.108em" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.SS1.p1.6.m6.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.2.cmml">o</mi><mo id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS1.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><times id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"></times><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑄</ci><apply id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2">italic-ϕ</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3">𝑎</ci></apply></apply><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2"><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.1">~</ci><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.2.2">𝑜</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">Q_{\phi_{a}}(a_{t}\!\mid\!\tilde{o}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, which itself infers a distribution over actions with parameters <math alttext="\phi_{a}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\phi_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>. We therefore introduce an explicit representation for the function itself with the mapping <math alttext="\Pi:\mathcal{Q}_{\phi_{a}}\rightarrow\hat{\pi}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" mathvariant="normal" xref="S3.SS1.p1.8.m8.1.1.2.cmml">Π</mi><mo id="S3.SS1.p1.8.m8.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.8.m8.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><msub id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3.2.2" xref="S3.SS1.p1.8.m8.1.1.3.2.2.cmml">𝒬</mi><msub id="S3.SS1.p1.8.m8.1.1.3.2.3" xref="S3.SS1.p1.8.m8.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.3.2.cmml">ϕ</mi><mi id="S3.SS1.p1.8.m8.1.1.3.2.3.3" xref="S3.SS1.p1.8.m8.1.1.3.2.3.3.cmml">a</mi></msub></msub><mo id="S3.SS1.p1.8.m8.1.1.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.3.1.cmml">→</mo><mover accent="true" id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.3.2" xref="S3.SS1.p1.8.m8.1.1.3.3.2.cmml">π</mi><mo id="S3.SS1.p1.8.m8.1.1.3.3.1" xref="S3.SS1.p1.8.m8.1.1.3.3.1.cmml">^</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><ci id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">:</ci><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">Π</ci><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><ci id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.1">→</ci><apply id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.2">𝒬</ci><apply id="S3.SS1.p1.8.m8.1.1.3.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.3.2">italic-ϕ</ci><ci id="S3.SS1.p1.8.m8.1.1.3.2.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2.3.3">𝑎</ci></apply></apply><apply id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3"><ci id="S3.SS1.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.1">^</ci><ci id="S3.SS1.p1.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.2">𝜋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\Pi:\mathcal{Q}_{\phi_{a}}\rightarrow\hat{\pi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">roman_Π : caligraphic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT → over^ start_ARG italic_π end_ARG</annotation></semantics></math>, resulting in <math alttext="\hat{\pi}(\phi_{a})" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mover accent="true" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">π</mi><mo id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p1.9.m9.1.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS1.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><times id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"></times><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><ci id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">^</ci><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">𝜋</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\hat{\pi}(\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">over^ start_ARG italic_π end_ARG ( italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>.
This approach is common in neural implicit representations <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib49" title="">dupont2022data </a></cite>; recent work has moreover demonstrated that neural functions with diverse computational graphs can be embedded efficiently <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib50" title="">kofinas2024graph </a></cite>. Conditioned on the actor, the <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.5">Transition</span>, <math alttext="P_{\theta_{s}}(s_{t+1}\!\mid\!\tilde{s}_{t},\hat{\pi})" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.2"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml"><msub id="S3.SS1.p1.10.m10.2.2.3" xref="S3.SS1.p1.10.m10.2.2.3.cmml"><mi id="S3.SS1.p1.10.m10.2.2.3.2" xref="S3.SS1.p1.10.m10.2.2.3.2.cmml">P</mi><msub id="S3.SS1.p1.10.m10.2.2.3.3" xref="S3.SS1.p1.10.m10.2.2.3.3.cmml"><mi id="S3.SS1.p1.10.m10.2.2.3.3.2" xref="S3.SS1.p1.10.m10.2.2.3.3.2.cmml">θ</mi><mi id="S3.SS1.p1.10.m10.2.2.3.3.3" xref="S3.SS1.p1.10.m10.2.2.3.3.3.cmml">s</mi></msub></msub><mo id="S3.SS1.p1.10.m10.2.2.2" xref="S3.SS1.p1.10.m10.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p1.10.m10.2.2.1.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.cmml"><mo id="S3.SS1.p1.10.m10.2.2.1.1.2" stretchy="false" xref="S3.SS1.p1.10.m10.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.10.m10.2.2.1.1.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.cmml"><msub id="S3.SS1.p1.10.m10.2.2.1.1.1.3" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.2.2.1.1.1.3.2" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.2.cmml">s</mi><mrow id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.2" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.3" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.10.m10.2.2.1.1.1.2" rspace="0.108em" xref="S3.SS1.p1.10.m10.2.2.1.1.1.2.cmml">∣</mo><mrow id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.2.cmml"><msub id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">π</mi><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">^</mo></mover></mrow></mrow><mo id="S3.SS1.p1.10.m10.2.2.1.1.3" stretchy="false" xref="S3.SS1.p1.10.m10.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><apply id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2"><times id="S3.SS1.p1.10.m10.2.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2.2"></times><apply id="S3.SS1.p1.10.m10.2.2.3.cmml" xref="S3.SS1.p1.10.m10.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.2.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.2.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.2.3.2">𝑃</ci><apply id="S3.SS1.p1.10.m10.2.2.3.3.cmml" xref="S3.SS1.p1.10.m10.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.2.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.2.3.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.2.2.3.3.2.cmml" xref="S3.SS1.p1.10.m10.2.2.3.3.2">𝜃</ci><ci id="S3.SS1.p1.10.m10.2.2.3.3.3.cmml" xref="S3.SS1.p1.10.m10.2.2.3.3.3">𝑠</ci></apply></apply><apply id="S3.SS1.p1.10.m10.2.2.1.1.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.2">conditional</csymbol><apply id="S3.SS1.p1.10.m10.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.2.2.1.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.2.2.1.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.2">𝑠</ci><apply id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3"><plus id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.1"></plus><ci id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p1.10.m10.2.2.1.1.1.3.3.3">1</cn></apply></apply><list id="S3.SS1.p1.10.m10.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1"><apply id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2"><ci id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.1">~</ci><ci id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><ci id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1">^</ci><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝜋</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">P_{\theta_{s}}(s_{t+1}\!\mid\!\tilde{s}_{t},\hat{\pi})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.2d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG )</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.15.6">overshoots</span> the latent dynamics up to a planning horizon <math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_H</annotation></semantics></math>, producing a distribution for <math alttext="s_{t+H}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">s</mi><mrow id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.12.m12.1.1.3.1" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">+</mo><mi id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑠</ci><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><plus id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3.1"></plus><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">s_{t+H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_s start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT</annotation></semantics></math> given the sampled latent state at time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_t</annotation></semantics></math>, while the actor–denoted by <math alttext="\phi_{a}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\phi_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>–is assumed fixed throughout the horizon. Finally, the <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.15.7">Decoder</span> <math alttext="P_{\theta_{o}}(o_{t+H}\!\mid\!\tilde{s}_{t+H})" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><msub id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml"><mi id="S3.SS1.p1.15.m15.1.1.3.2" xref="S3.SS1.p1.15.m15.1.1.3.2.cmml">P</mi><msub id="S3.SS1.p1.15.m15.1.1.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3.cmml"><mi id="S3.SS1.p1.15.m15.1.1.3.3.2" xref="S3.SS1.p1.15.m15.1.1.3.3.2.cmml">θ</mi><mi id="S3.SS1.p1.15.m15.1.1.3.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3.3.cmml">o</mi></msub></msub><mo id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.15.m15.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.15.m15.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.15.m15.1.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.2.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml">o</mi><mrow id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo id="S3.SS1.p1.15.m15.1.1.1.1.1.1" rspace="0.108em" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.SS1.p1.15.m15.1.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="S3.SS1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><times id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2"></times><apply id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2">𝑃</ci><apply id="S3.SS1.p1.15.m15.1.1.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.3.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3.2">𝜃</ci><ci id="S3.SS1.p1.15.m15.1.1.3.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3.3">𝑜</ci></apply></apply><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.2">𝑜</ci><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3"><plus id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.1"></plus><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2"><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.1">~</ci><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.2.2">𝑠</ci></apply><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3"><plus id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">P_{\theta_{o}}(o_{t+H}\!\mid\!\tilde{s}_{t+H})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ∣ over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> converts the predicted latent state back into a distribution over future observations.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="S3.F2.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">The Deep AIF agent architecture illustrates its interaction with the environment. The actor independently selects actions, while the generative model is used to optimize the policy.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Each of the three modules in the generative model is realized by a neural network that outputs the parameters of a diagonal multivariate Gaussian, thereby approximating a pre-selected likelihood family. They can be trained end-to-end by minimizing the VFE (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E1" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a>), whereas the actor is optimized—using predictions from the calibrated model—by minimizing the EFE (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4</span></a>). In this way, the agent unifies the two free-energy paradigms derived in the formalism. Aside from the actor and transition, which account for latent dynamics with a single look-ahead, the architecture resembles a variational autoencoder (VAE) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib20" title="">kingma2013auto </a></cite>; nevertheless, other generative mechanisms, such as diffusion or memory-based RSSM models, can be extended to support the same objective.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Policy Optimization</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">We propose a concise yet effective formulation for embedding the actor within the generative model so that it serves as a planner that minimizes the EFE via gradient descent. Conditioned on a fixed policy <math alttext="\hat{\pi}(\phi_{a})" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">π</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"></times><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><ci id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1">^</ci><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝜋</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\hat{\pi}(\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">over^ start_ARG italic_π end_ARG ( italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>, the model generates the prediction distribution <math alttext="P_{\theta}(o_{t+H}|\phi_{a})" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.cmml">o</mi><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml">a</mi></msub></mrow><mo id="S3.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑃</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.2">𝑜</ci><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3"><plus id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.1"></plus><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">P_{\theta}(o_{t+H}|\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT | italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>, from which we compute the EFE, denoted as the function <math alttext="G_{\theta}(\tilde{o},\phi_{a})" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.2"><semantics id="S3.SS2.p1.3.m3.2a"><mrow id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml"><msub id="S3.SS2.p1.3.m3.2.2.3" xref="S3.SS2.p1.3.m3.2.2.3.cmml"><mi id="S3.SS2.p1.3.m3.2.2.3.2" xref="S3.SS2.p1.3.m3.2.2.3.2.cmml">G</mi><mi id="S3.SS2.p1.3.m3.2.2.3.3" xref="S3.SS2.p1.3.m3.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p1.3.m3.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p1.3.m3.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.1.2.cmml"><mo id="S3.SS2.p1.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.3.m3.2.2.1.2.cmml">(</mo><mover accent="true" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">o</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">~</mo></mover><mo id="S3.SS2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.2.cmml">,</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS2.p1.3.m3.2.2.1.1.4" stretchy="false" xref="S3.SS2.p1.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><apply id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2"><times id="S3.SS2.p1.3.m3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2"></times><apply id="S3.SS2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.3.2.cmml" xref="S3.SS2.p1.3.m3.2.2.3.2">𝐺</ci><ci id="S3.SS2.p1.3.m3.2.2.3.3.cmml" xref="S3.SS2.p1.3.m3.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p1.3.m3.2.2.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><ci id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1">~</ci><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑜</ci></apply><apply id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.3">𝑎</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">G_{\theta}(\tilde{o},\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.2d">italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG , italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>. Policy optimization then proceeds by updating the actor parameters according to the gradient <math alttext="\nabla_{\phi_{a}}G_{\theta}(\tilde{o},\phi_{a})" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.2"><semantics id="S3.SS2.p1.4.m4.2a"><mrow id="S3.SS2.p1.4.m4.2.2" xref="S3.SS2.p1.4.m4.2.2.cmml"><mrow id="S3.SS2.p1.4.m4.2.2.3" xref="S3.SS2.p1.4.m4.2.2.3.cmml"><msub id="S3.SS2.p1.4.m4.2.2.3.1" xref="S3.SS2.p1.4.m4.2.2.3.1.cmml"><mo id="S3.SS2.p1.4.m4.2.2.3.1.2" xref="S3.SS2.p1.4.m4.2.2.3.1.2.cmml">∇</mo><msub id="S3.SS2.p1.4.m4.2.2.3.1.3" xref="S3.SS2.p1.4.m4.2.2.3.1.3.cmml"><mi id="S3.SS2.p1.4.m4.2.2.3.1.3.2" xref="S3.SS2.p1.4.m4.2.2.3.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p1.4.m4.2.2.3.1.3.3" xref="S3.SS2.p1.4.m4.2.2.3.1.3.3.cmml">a</mi></msub></msub><msub id="S3.SS2.p1.4.m4.2.2.3.2" xref="S3.SS2.p1.4.m4.2.2.3.2.cmml"><mi id="S3.SS2.p1.4.m4.2.2.3.2.2" xref="S3.SS2.p1.4.m4.2.2.3.2.2.cmml">G</mi><mi id="S3.SS2.p1.4.m4.2.2.3.2.3" xref="S3.SS2.p1.4.m4.2.2.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.SS2.p1.4.m4.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p1.4.m4.2.2.1.1" xref="S3.SS2.p1.4.m4.2.2.1.2.cmml"><mo id="S3.SS2.p1.4.m4.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.4.m4.2.2.1.2.cmml">(</mo><mover accent="true" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">o</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">~</mo></mover><mo id="S3.SS2.p1.4.m4.2.2.1.1.3" xref="S3.SS2.p1.4.m4.2.2.1.2.cmml">,</mo><msub id="S3.SS2.p1.4.m4.2.2.1.1.1" xref="S3.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.2" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.3" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS2.p1.4.m4.2.2.1.1.4" stretchy="false" xref="S3.SS2.p1.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.2b"><apply id="S3.SS2.p1.4.m4.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2"><times id="S3.SS2.p1.4.m4.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2"></times><apply id="S3.SS2.p1.4.m4.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.3"><apply id="S3.SS2.p1.4.m4.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.3.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.3.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1.2">∇</ci><apply id="S3.SS2.p1.4.m4.2.2.3.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.3.1.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.3.1.3.2.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p1.4.m4.2.2.3.1.3.3.cmml" xref="S3.SS2.p1.4.m4.2.2.3.1.3.3">𝑎</ci></apply></apply><apply id="S3.SS2.p1.4.m4.2.2.3.2.cmml" xref="S3.SS2.p1.4.m4.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.3.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.3.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.3.2.2">𝐺</ci><ci id="S3.SS2.p1.4.m4.2.2.3.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.3.2.3">𝜃</ci></apply></apply><interval closure="open" id="S3.SS2.p1.4.m4.2.2.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><ci id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1">~</ci><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑜</ci></apply><apply id="S3.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3">𝑎</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.2c">\nabla_{\phi_{a}}G_{\theta}(\tilde{o},\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.2d">∇ start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( over~ start_ARG italic_o end_ARG , italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>. Most world-model agents introduce stochasticity by sampling actions during imagination, which promotes exploration—typically aided by auxiliary terms during the policy gradient. This results in a Monte Carlo estimation of the policy across imagined trajectories, which is then differentiated based on the return <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a></cite>. In contrast, our approach assumes the exact form of the policy is integrated into the dynamics, and exploration is driven by the AIF formalism based on the generative model.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">To effectively estimate the different components of the EFE in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4</span></a>, Fountas et al. (2020) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> employed multiple levels of Monte Carlo sampling. While their original formulation incorporated sampled actions over multi-step horizons, the same structure and sampling scheme remain beneficial when using an integrated actor with deep temporal overshooting. Similarly, we adopt ancestral sampling to generate the prediction <math alttext="P_{\theta}(o_{t+H}\mid\phi_{a})" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml">o</mi><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml">a</mi></msub></mrow><mo id="S3.SS2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><times id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></times><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑃</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2">𝑜</ci><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3"><plus id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">P_{\theta}(o_{t+H}\mid\phi_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ∣ italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math> and leverage
dropout <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib51" title="">gal2016dropout </a></cite> in the networks. It’s coupled with further sampling from the latent distributions to compute the entropies necessary for calculating the EFE terms. Crucially, under the AIF framework, agents need a prior preference over predictions to guide behavior—this is formalized through the extrinsic value (i.e., Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E4.1" title="In 4 ‣ 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4a</span></a>). Accordingly, we define an analytical mapping that transforms the prediction distribution into a continuous preference spectrum, <math alttext="\Psi:{P}_{\theta}(o_{\tau})\rightarrow[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.3"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3" xref="S3.SS2.p2.2.m2.3.3.cmml"><mi id="S3.SS2.p2.2.m2.3.3.3" mathvariant="normal" xref="S3.SS2.p2.2.m2.3.3.3.cmml">Ψ</mi><mo id="S3.SS2.p2.2.m2.3.3.2" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.2.m2.3.3.2.cmml">:</mo><mrow id="S3.SS2.p2.2.m2.3.3.1" xref="S3.SS2.p2.2.m2.3.3.1.cmml"><mrow id="S3.SS2.p2.2.m2.3.3.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.cmml"><msub id="S3.SS2.p2.2.m2.3.3.1.1.3" xref="S3.SS2.p2.2.m2.3.3.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.3.3.1.1.3.2" xref="S3.SS2.p2.2.m2.3.3.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p2.2.m2.3.3.1.1.3.3" xref="S3.SS2.p2.2.m2.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.2.m2.3.3.1.1.2" xref="S3.SS2.p2.2.m2.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.3.3.1.1.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.2.m2.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.2.cmml">o</mi><mi id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="S3.SS2.p2.2.m2.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.3.3.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.1.2.cmml">→</mo><mrow id="S3.SS2.p2.2.m2.3.3.1.3.2" xref="S3.SS2.p2.2.m2.3.3.1.3.1.cmml"><mo id="S3.SS2.p2.2.m2.3.3.1.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.1.3.1.cmml">[</mo><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p2.2.m2.3.3.1.3.2.2" xref="S3.SS2.p2.2.m2.3.3.1.3.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p2.2.m2.3.3.1.3.2.3" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.1.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><apply id="S3.SS2.p2.2.m2.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3"><ci id="S3.SS2.p2.2.m2.3.3.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2">:</ci><ci id="S3.SS2.p2.2.m2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.3">Ψ</ci><apply id="S3.SS2.p2.2.m2.3.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1"><ci id="S3.SS2.p2.2.m2.3.3.1.2.cmml" xref="S3.SS2.p2.2.m2.3.3.1.2">→</ci><apply id="S3.SS2.p2.2.m2.3.3.1.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1"><times id="S3.SS2.p2.2.m2.3.3.1.1.2.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.2"></times><apply id="S3.SS2.p2.2.m2.3.3.1.1.3.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.3.2">𝑃</ci><ci id="S3.SS2.p2.2.m2.3.3.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.2">𝑜</ci><ci id="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.1.3">𝜏</ci></apply></apply><interval closure="closed" id="S3.SS2.p2.2.m2.3.3.1.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.3.2"><cn id="S3.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1">0</cn><cn id="S3.SS2.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">\Psi:{P}_{\theta}(o_{\tau})\rightarrow[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.3d">roman_Ψ : italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ) → [ 0 , 1 ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Unlike RL, which relies on the return of accumulated rewards, this formulation allows the agent to express more general and nuanced forms of preference. In practice, designing a suitable reward function for RL agents remains a difficult task, often resulting in sparse or hand-crafted signals that can be costly to design and compute. The flexibility in preference, however, introduces challenges—particularly when agents have complex preference space and must act with short-sighted EFE approximations. Our approach, by optimizing planning through deep temporal prediction, mitigates this issue and enables longer-term evaluation of the extrinsic value.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Training &amp; Planning</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.6">During training, the generative model gradually learns how different actor parameters <math alttext="\phi_{a}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\phi_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> affect the dynamics, and during policy optimization, this learned dynamics is then used to differentiate the actor toward lower EFE or surprise. Critical for effective policy learning is the accuracy of the world model, which forms the foundation of AIF <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib23" title="">friston2010action </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> and predictive coding <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib22" title="">millidge2022predictive </a></cite>. To improve model training, we introduce experience replay <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib4" title="">mnih2015human </a></cite> using an experience memory/buffer <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">caligraphic_M</annotation></semantics></math>, from which we sample batches of experiences, while ensuring that each batch includes the most recent one. We compute the VFE in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S2.E1" title="In 2.1 Formalism ‣ 2 Background ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a> for these experiences to train the model with <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_β</annotation></semantics></math>-regularization. With the updated model, we differentiate the EFE over a batch of observations—including previous and current ones—within imagined trajectories of length <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_H</annotation></semantics></math>, training the actor similarly to world-model methods <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib19" title="">ha2018world </a></cite>. This results in a joint training algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#alg1" title="Algorithm 1 ‣ 3.2.1 Training &amp; Planning ‣ 3.2 Policy Optimization ‣ 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a> that alternates between updating the generative model and the policy, using the model to guide planning via policy gradients. This approach, policy learning—rather than explicit action planning—relaxes the bounded-sight constraint of EFE, as the policy is iteratively trained across diverse scenarios within the planning horizon, and its effective <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.6.1">sight</em> extends beyond the nominal horizon <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_H</annotation></semantics></math>. Recent work on AIF-based agents has also emphasized the advantages of integrating a policy network with the EFE objective <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>. After training concludes and the agent’s model is fixed, the agent can still leverage its model for planning. Specifically, EFE-based gradient updates can be applied at the observation level once every <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mi id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_H</annotation></semantics></math> steps, effectively fine-tuning the policy for the immediate horizon.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Deep AIF Agent Training (per epoch)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_top ltx_listing" id="alg1.3" style="width:260.2pt;">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>Initialize <math alttext="\theta=\{\theta_{s},\theta_{o}\},\ \phi=\{\phi_{s},\phi_{a}\}" class="ltx_Math" display="inline" id="alg1.l1.m1.2"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.2" xref="alg1.l1.m1.2.2.3.cmml"><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.4" xref="alg1.l1.m1.1.1.1.1.4.cmml">θ</mi><mo id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.cmml">=</mo><mrow id="alg1.l1.m1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.2.3.cmml"><mo id="alg1.l1.m1.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">{</mo><msub id="alg1.l1.m1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l1.m1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l1.m1.1.1.1.1.2.2.4" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l1.m1.1.1.1.1.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l1.m1.1.1.1.1.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="alg1.l1.m1.1.1.1.1.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml">o</mi></msub><mo id="alg1.l1.m1.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="alg1.l1.m1.2.2.2.3" rspace="0.667em" xref="alg1.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.4.cmml">ϕ</mi><mo id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">=</mo><mrow id="alg1.l1.m1.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.3.cmml"><mo id="alg1.l1.m1.2.2.2.2.2.2.3" stretchy="false" xref="alg1.l1.m1.2.2.2.2.2.3.cmml">{</mo><msub id="alg1.l1.m1.2.2.2.2.1.1.1" xref="alg1.l1.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l1.m1.2.2.2.2.1.1.1.2" xref="alg1.l1.m1.2.2.2.2.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l1.m1.2.2.2.2.1.1.1.3" xref="alg1.l1.m1.2.2.2.2.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l1.m1.2.2.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l1.m1.2.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.2.3.cmml">a</mi></msub><mo id="alg1.l1.m1.2.2.2.2.2.2.5" stretchy="false" xref="alg1.l1.m1.2.2.2.2.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.3a.cmml" xref="alg1.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><eq id="alg1.l1.m1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.3"></eq><ci id="alg1.l1.m1.1.1.1.1.4.cmml" xref="alg1.l1.m1.1.1.1.1.4">𝜃</ci><set id="alg1.l1.m1.1.1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2"><apply id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l1.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.3">𝑜</ci></apply></set></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><eq id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.3"></eq><ci id="alg1.l1.m1.2.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.2.4">italic-ϕ</ci><set id="alg1.l1.m1.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2"><apply id="alg1.l1.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.2.2.1.1.1.2">italic-ϕ</ci><ci id="alg1.l1.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l1.m1.2.2.2.2.1.1.1.3">𝑠</ci></apply><apply id="alg1.l1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l1.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.3">𝑎</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\theta=\{\theta_{s},\theta_{o}\},\ \phi=\{\phi_{s},\phi_{a}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.2d">italic_θ = { italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT } , italic_ϕ = { italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT }</annotation></semantics></math>,  <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">caligraphic_M</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>Randomly initialize <math alttext="E" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_E</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l2.2">\For</span><math alttext="n=1,2,...,N" class="ltx_Math" display="inline" id="alg1.l2.m2.4"><semantics id="alg1.l2.m2.4a"><mrow id="alg1.l2.m2.4.5" xref="alg1.l2.m2.4.5.cmml"><mi id="alg1.l2.m2.4.5.2" xref="alg1.l2.m2.4.5.2.cmml">n</mi><mo id="alg1.l2.m2.4.5.1" xref="alg1.l2.m2.4.5.1.cmml">=</mo><mrow id="alg1.l2.m2.4.5.3.2" xref="alg1.l2.m2.4.5.3.1.cmml"><mn id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">1</mn><mo id="alg1.l2.m2.4.5.3.2.1" xref="alg1.l2.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">2</mn><mo id="alg1.l2.m2.4.5.3.2.2" xref="alg1.l2.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m2.3.3" mathvariant="normal" xref="alg1.l2.m2.3.3.cmml">…</mi><mo id="alg1.l2.m2.4.5.3.2.3" xref="alg1.l2.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m2.4.4" xref="alg1.l2.m2.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.4b"><apply id="alg1.l2.m2.4.5.cmml" xref="alg1.l2.m2.4.5"><eq id="alg1.l2.m2.4.5.1.cmml" xref="alg1.l2.m2.4.5.1"></eq><ci id="alg1.l2.m2.4.5.2.cmml" xref="alg1.l2.m2.4.5.2">𝑛</ci><list id="alg1.l2.m2.4.5.3.1.cmml" xref="alg1.l2.m2.4.5.3.2"><cn id="alg1.l2.m2.1.1.cmml" type="integer" xref="alg1.l2.m2.1.1">1</cn><cn id="alg1.l2.m2.2.2.cmml" type="integer" xref="alg1.l2.m2.2.2">2</cn><ci id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3">…</ci><ci id="alg1.l2.m2.4.4.cmml" xref="alg1.l2.m2.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.4c">n=1,2,...,N</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.4d">italic_n = 1 , 2 , … , italic_N</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.2.1.1" style="font-size:80%;">3:</span></span> <span class="ltx_text ltx_font_smallcaps" id="alg1.l3.1" style="color:#000099;">  <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" mathcolor="#000099" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> Environment Interaction</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><math alttext="\hat{\pi}_{t}\leftarrow\Pi(\mathcal{Q}_{\phi_{a}})" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mover accent="true" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml"><mi id="alg1.l4.m1.1.1.3.2.2" xref="alg1.l4.m1.1.1.3.2.2.cmml">π</mi><mo id="alg1.l4.m1.1.1.3.2.1" xref="alg1.l4.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">t</mi></msub><mo id="alg1.l4.m1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.2.cmml">←</mo><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.3" mathvariant="normal" xref="alg1.l4.m1.1.1.1.3.cmml">Π</mi><mo id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.cmml">𝒬</mi><msub id="alg1.l4.m1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml">a</mi></msub></msub><mo id="alg1.l4.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">←</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2"><ci id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.2.1">^</ci><ci id="alg1.l4.m1.1.1.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.2.2">𝜋</ci></apply><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><times id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2"></times><ci id="alg1.l4.m1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.3">Π</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2">𝒬</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\hat{\pi}_{t}\leftarrow\Pi(\mathcal{Q}_{\phi_{a}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← roman_Π ( caligraphic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l4.2">\For</span><math alttext="\tau=t+1,t+2,...,t+H" class="ltx_Math" display="inline" id="alg1.l4.m2.4"><semantics id="alg1.l4.m2.4a"><mrow id="alg1.l4.m2.4.4" xref="alg1.l4.m2.4.4.cmml"><mi id="alg1.l4.m2.4.4.5" xref="alg1.l4.m2.4.4.5.cmml">τ</mi><mo id="alg1.l4.m2.4.4.4" xref="alg1.l4.m2.4.4.4.cmml">=</mo><mrow id="alg1.l4.m2.4.4.3.3" xref="alg1.l4.m2.4.4.3.4.cmml"><mrow id="alg1.l4.m2.2.2.1.1.1" xref="alg1.l4.m2.2.2.1.1.1.cmml"><mi id="alg1.l4.m2.2.2.1.1.1.2" xref="alg1.l4.m2.2.2.1.1.1.2.cmml">t</mi><mo id="alg1.l4.m2.2.2.1.1.1.1" xref="alg1.l4.m2.2.2.1.1.1.1.cmml">+</mo><mn id="alg1.l4.m2.2.2.1.1.1.3" xref="alg1.l4.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l4.m2.4.4.3.3.4" xref="alg1.l4.m2.4.4.3.4.cmml">,</mo><mrow id="alg1.l4.m2.3.3.2.2.2" xref="alg1.l4.m2.3.3.2.2.2.cmml"><mi id="alg1.l4.m2.3.3.2.2.2.2" xref="alg1.l4.m2.3.3.2.2.2.2.cmml">t</mi><mo id="alg1.l4.m2.3.3.2.2.2.1" xref="alg1.l4.m2.3.3.2.2.2.1.cmml">+</mo><mn id="alg1.l4.m2.3.3.2.2.2.3" xref="alg1.l4.m2.3.3.2.2.2.3.cmml">2</mn></mrow><mo id="alg1.l4.m2.4.4.3.3.5" xref="alg1.l4.m2.4.4.3.4.cmml">,</mo><mi id="alg1.l4.m2.1.1" mathvariant="normal" xref="alg1.l4.m2.1.1.cmml">…</mi><mo id="alg1.l4.m2.4.4.3.3.6" xref="alg1.l4.m2.4.4.3.4.cmml">,</mo><mrow id="alg1.l4.m2.4.4.3.3.3" xref="alg1.l4.m2.4.4.3.3.3.cmml"><mi id="alg1.l4.m2.4.4.3.3.3.2" xref="alg1.l4.m2.4.4.3.3.3.2.cmml">t</mi><mo id="alg1.l4.m2.4.4.3.3.3.1" xref="alg1.l4.m2.4.4.3.3.3.1.cmml">+</mo><mi id="alg1.l4.m2.4.4.3.3.3.3" xref="alg1.l4.m2.4.4.3.3.3.3.cmml">H</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.4b"><apply id="alg1.l4.m2.4.4.cmml" xref="alg1.l4.m2.4.4"><eq id="alg1.l4.m2.4.4.4.cmml" xref="alg1.l4.m2.4.4.4"></eq><ci id="alg1.l4.m2.4.4.5.cmml" xref="alg1.l4.m2.4.4.5">𝜏</ci><list id="alg1.l4.m2.4.4.3.4.cmml" xref="alg1.l4.m2.4.4.3.3"><apply id="alg1.l4.m2.2.2.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1.1"><plus id="alg1.l4.m2.2.2.1.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1.1.1"></plus><ci id="alg1.l4.m2.2.2.1.1.1.2.cmml" xref="alg1.l4.m2.2.2.1.1.1.2">𝑡</ci><cn id="alg1.l4.m2.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l4.m2.2.2.1.1.1.3">1</cn></apply><apply id="alg1.l4.m2.3.3.2.2.2.cmml" xref="alg1.l4.m2.3.3.2.2.2"><plus id="alg1.l4.m2.3.3.2.2.2.1.cmml" xref="alg1.l4.m2.3.3.2.2.2.1"></plus><ci id="alg1.l4.m2.3.3.2.2.2.2.cmml" xref="alg1.l4.m2.3.3.2.2.2.2">𝑡</ci><cn id="alg1.l4.m2.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l4.m2.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">…</ci><apply id="alg1.l4.m2.4.4.3.3.3.cmml" xref="alg1.l4.m2.4.4.3.3.3"><plus id="alg1.l4.m2.4.4.3.3.3.1.cmml" xref="alg1.l4.m2.4.4.3.3.3.1"></plus><ci id="alg1.l4.m2.4.4.3.3.3.2.cmml" xref="alg1.l4.m2.4.4.3.3.3.2">𝑡</ci><ci id="alg1.l4.m2.4.4.3.3.3.3.cmml" xref="alg1.l4.m2.4.4.3.3.3.3">𝐻</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.4c">\tau=t+1,t+2,...,t+H</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.4d">italic_τ = italic_t + 1 , italic_t + 2 , … , italic_t + italic_H</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>Sample a new observation <math alttext="\tilde{o}_{\tau}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mover accent="true" id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">o</mi><mo id="alg1.l5.m1.1.1.2.1" xref="alg1.l5.m1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><ci id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2.1">~</ci><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑜</ci></apply><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\tilde{o}_{\tau}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="E" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>Apply <math alttext="\tilde{a}_{\tau}\sim Q_{\phi_{a}}(a_{\tau}|\tilde{o}_{\tau})" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mover accent="true" id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml"><mi id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">a</mi><mo id="alg1.l6.m1.1.1.3.2.1" xref="alg1.l6.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">τ</mi></msub><mo id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2.cmml">Q</mi><msub id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.3.2" xref="alg1.l6.m1.1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l6.m1.1.1.1.3.3.3" xref="alg1.l6.m1.1.1.1.3.3.3.cmml">a</mi></msub></msub><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l6.m1.1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.2.cmml">o</mi><mo id="alg1.l6.m1.1.1.1.1.1.1.3.2.1" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo id="alg1.l6.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">similar-to</csymbol><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2"><ci id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3.2.1">~</ci><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝑎</ci></apply><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝜏</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2">𝑄</ci><apply id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l6.m1.1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3.3">𝑎</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2"><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.2">𝑜</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\tilde{a}_{\tau}\sim Q_{\phi_{a}}(a_{\tau}|\tilde{o}_{\tau})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">over~ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ∼ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT | over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT )</annotation></semantics></math> to <math alttext="E" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>Sample a new observation <math alttext="\tilde{o}_{\tau+1}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mover accent="true" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">o</mi><mo id="alg1.l7.m1.1.1.2.1" xref="alg1.l7.m1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">τ</mi><mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><ci id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2.1">~</ci><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑜</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><plus id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></plus><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝜏</ci><cn id="alg1.l7.m1.1.1.3.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\tilde{o}_{\tau+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ + 1 end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="E" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_E</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l7.2">\EndFor</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><math alttext="\mathcal{M}\leftarrow\mathcal{M}\cup\{(\tilde{o}_{t},\hat{\pi}_{t},\tilde{o}_{%
t+H})\}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">ℳ</mi><mo id="alg1.l8.m1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.2.cmml">←</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml">ℳ</mi><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">∪</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.2.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.1.3.4" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l8.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.3.5" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml">π</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.3.6" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="alg1.l8.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.2.cmml">o</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mrow id="alg1.l8.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.1" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.3.7" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">←</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">ℳ</ci><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><union id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></union><ci id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3">ℳ</ci><set id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1"><vector id="alg1.l8.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3"><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2"><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.2.2">𝑜</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2"><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2">𝜋</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2"><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.1">~</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.2">𝑜</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3"><plus id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.3">𝐻</ci></apply></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathcal{M}\leftarrow\mathcal{M}\cup\{(\tilde{o}_{t},\hat{\pi}_{t},\tilde{o}_{%
t+H})\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">caligraphic_M ← caligraphic_M ∪ { ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mo id="alg1.l9.m1.1.1" mathcolor="#000099" xref="alg1.l9.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">▷</annotation></semantics></math><span class="ltx_text" id="alg1.l9.2" style="color:#000099;"> <span class="ltx_text ltx_font_smallcaps" id="alg1.l9.2.1" style="color:#000099;">Model learning</span></span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><math alttext="\{(\tilde{o}_{t^{\prime}},\hat{\pi}_{t^{\prime}},\tilde{o}_{t^{\prime}+H})\}^{%
B_{1}}\sim\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msup id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.1.3.4" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l10.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><msup id="alg1.l10.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="alg1.l10.m1.1.1.1.1.1.1.3.5" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l10.m1.1.1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="alg1.l10.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2.2.cmml">π</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.2.2.2.1" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><msup id="alg1.l10.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3.3.cmml">′</mo></msup></msub><mo id="alg1.l10.m1.1.1.1.1.1.1.3.6" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l10.m1.1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="alg1.l10.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2.2.cmml">o</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.3.3.2.1" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mrow id="alg1.l10.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.cmml"><msup id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.3.cmml">′</mo></msup><mo id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.1" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l10.m1.1.1.1.1.1.1.3.7" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.l10.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.1.1.1.1.2.cmml">}</mo></mrow><msub id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.3.2.cmml">B</mi><mn id="alg1.l10.m1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.3.3.cmml">1</mn></msub></msup><mo id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="latexml" id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">similar-to</csymbol><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1">superscript</csymbol><set id="alg1.l10.m1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><vector id="alg1.l10.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3"><apply id="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2"><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.2">𝑜</ci></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2"><ci id="alg1.l10.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.2.2">𝜋</ci></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.3.3">′</ci></apply></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2"><ci id="alg1.l10.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2.1">~</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.2.2">𝑜</ci></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3"><plus id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.1"></plus><apply id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2">superscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.2.3">′</ci></apply><ci id="alg1.l10.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3.3.3.3">𝐻</ci></apply></apply></vector></set><apply id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.3.2">𝐵</ci><cn id="alg1.l10.m1.1.1.1.3.3.cmml" type="integer" xref="alg1.l10.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\{(\tilde{o}_{t^{\prime}},\hat{\pi}_{t^{\prime}},\tilde{o}_{t^{\prime}+H})\}^{%
B_{1}}\sim\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">{ ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT ) } start_POSTSUPERSCRIPT italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∼ caligraphic_M</annotation></semantics></math> <span class="ltx_ERROR undefined" id="alg1.l10.2">\For</span><math alttext="t^{\prime}=1,2,...,B_{1}" class="ltx_Math" display="inline" id="alg1.l10.m2.4"><semantics id="alg1.l10.m2.4a"><mrow id="alg1.l10.m2.4.4" xref="alg1.l10.m2.4.4.cmml"><msup id="alg1.l10.m2.4.4.3" xref="alg1.l10.m2.4.4.3.cmml"><mi id="alg1.l10.m2.4.4.3.2" xref="alg1.l10.m2.4.4.3.2.cmml">t</mi><mo id="alg1.l10.m2.4.4.3.3" xref="alg1.l10.m2.4.4.3.3.cmml">′</mo></msup><mo id="alg1.l10.m2.4.4.2" xref="alg1.l10.m2.4.4.2.cmml">=</mo><mrow id="alg1.l10.m2.4.4.1.1" xref="alg1.l10.m2.4.4.1.2.cmml"><mn id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">1</mn><mo id="alg1.l10.m2.4.4.1.1.2" xref="alg1.l10.m2.4.4.1.2.cmml">,</mo><mn id="alg1.l10.m2.2.2" xref="alg1.l10.m2.2.2.cmml">2</mn><mo id="alg1.l10.m2.4.4.1.1.3" xref="alg1.l10.m2.4.4.1.2.cmml">,</mo><mi id="alg1.l10.m2.3.3" mathvariant="normal" xref="alg1.l10.m2.3.3.cmml">…</mi><mo id="alg1.l10.m2.4.4.1.1.4" xref="alg1.l10.m2.4.4.1.2.cmml">,</mo><msub id="alg1.l10.m2.4.4.1.1.1" xref="alg1.l10.m2.4.4.1.1.1.cmml"><mi id="alg1.l10.m2.4.4.1.1.1.2" xref="alg1.l10.m2.4.4.1.1.1.2.cmml">B</mi><mn id="alg1.l10.m2.4.4.1.1.1.3" xref="alg1.l10.m2.4.4.1.1.1.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.4b"><apply id="alg1.l10.m2.4.4.cmml" xref="alg1.l10.m2.4.4"><eq id="alg1.l10.m2.4.4.2.cmml" xref="alg1.l10.m2.4.4.2"></eq><apply id="alg1.l10.m2.4.4.3.cmml" xref="alg1.l10.m2.4.4.3"><csymbol cd="ambiguous" id="alg1.l10.m2.4.4.3.1.cmml" xref="alg1.l10.m2.4.4.3">superscript</csymbol><ci id="alg1.l10.m2.4.4.3.2.cmml" xref="alg1.l10.m2.4.4.3.2">𝑡</ci><ci id="alg1.l10.m2.4.4.3.3.cmml" xref="alg1.l10.m2.4.4.3.3">′</ci></apply><list id="alg1.l10.m2.4.4.1.2.cmml" xref="alg1.l10.m2.4.4.1.1"><cn id="alg1.l10.m2.1.1.cmml" type="integer" xref="alg1.l10.m2.1.1">1</cn><cn id="alg1.l10.m2.2.2.cmml" type="integer" xref="alg1.l10.m2.2.2">2</cn><ci id="alg1.l10.m2.3.3.cmml" xref="alg1.l10.m2.3.3">…</ci><apply id="alg1.l10.m2.4.4.1.1.1.cmml" xref="alg1.l10.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.4.4.1.1.1.1.cmml" xref="alg1.l10.m2.4.4.1.1.1">subscript</csymbol><ci id="alg1.l10.m2.4.4.1.1.1.2.cmml" xref="alg1.l10.m2.4.4.1.1.1.2">𝐵</ci><cn id="alg1.l10.m2.4.4.1.1.1.3.cmml" type="integer" xref="alg1.l10.m2.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.4c">t^{\prime}=1,2,...,B_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.4d">italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = 1 , 2 , … , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l11.2">run</span> <math alttext="\text{Model}(\tilde{o}_{t^{\prime}},\hat{\pi}_{t^{\prime}},\tilde{o}_{t^{%
\prime}+H})" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml"><mtext id="alg1.l11.m1.3.3.5" xref="alg1.l11.m1.3.3.5a.cmml">Model</mtext><mo id="alg1.l11.m1.3.3.4" xref="alg1.l11.m1.3.3.4.cmml">⁢</mo><mrow id="alg1.l11.m1.3.3.3.3" xref="alg1.l11.m1.3.3.3.4.cmml"><mo id="alg1.l11.m1.3.3.3.3.4" stretchy="false" xref="alg1.l11.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l11.m1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.2.2.cmml">o</mi><mo id="alg1.l11.m1.1.1.1.1.1.2.1" xref="alg1.l11.m1.1.1.1.1.1.2.1.cmml">~</mo></mover><msup id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="alg1.l11.m1.3.3.3.3.5" xref="alg1.l11.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l11.m1.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.cmml">π</mi><mo id="alg1.l11.m1.2.2.2.2.2.2.1" xref="alg1.l11.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><msup id="alg1.l11.m1.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.3.2" xref="alg1.l11.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.2.2.2.2.2.3.3" xref="alg1.l11.m1.2.2.2.2.2.3.3.cmml">′</mo></msup></msub><mo id="alg1.l11.m1.3.3.3.3.6" xref="alg1.l11.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l11.m1.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.cmml"><mover accent="true" id="alg1.l11.m1.3.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.2.cmml"><mi id="alg1.l11.m1.3.3.3.3.3.2.2" xref="alg1.l11.m1.3.3.3.3.3.2.2.cmml">o</mi><mo id="alg1.l11.m1.3.3.3.3.3.2.1" xref="alg1.l11.m1.3.3.3.3.3.2.1.cmml">~</mo></mover><mrow id="alg1.l11.m1.3.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.3.cmml"><msup id="alg1.l11.m1.3.3.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.3.2.cmml"><mi id="alg1.l11.m1.3.3.3.3.3.3.2.2" xref="alg1.l11.m1.3.3.3.3.3.3.2.2.cmml">t</mi><mo id="alg1.l11.m1.3.3.3.3.3.3.2.3" xref="alg1.l11.m1.3.3.3.3.3.3.2.3.cmml">′</mo></msup><mo id="alg1.l11.m1.3.3.3.3.3.3.1" xref="alg1.l11.m1.3.3.3.3.3.3.1.cmml">+</mo><mi id="alg1.l11.m1.3.3.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l11.m1.3.3.3.3.7" stretchy="false" xref="alg1.l11.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3"><times id="alg1.l11.m1.3.3.4.cmml" xref="alg1.l11.m1.3.3.4"></times><ci id="alg1.l11.m1.3.3.5a.cmml" xref="alg1.l11.m1.3.3.5"><mtext id="alg1.l11.m1.3.3.5.cmml" xref="alg1.l11.m1.3.3.5">Model</mtext></ci><vector id="alg1.l11.m1.3.3.3.4.cmml" xref="alg1.l11.m1.3.3.3.3"><apply id="alg1.l11.m1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l11.m1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.2"><ci id="alg1.l11.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l11.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.2.2">𝑜</ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l11.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="alg1.l11.m1.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l11.m1.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2"><ci id="alg1.l11.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.1">^</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2">𝜋</ci></apply><apply id="alg1.l11.m1.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.3">superscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l11.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.3.3">′</ci></apply></apply><apply id="alg1.l11.m1.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.3">subscript</csymbol><apply id="alg1.l11.m1.3.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.2"><ci id="alg1.l11.m1.3.3.3.3.3.2.1.cmml" xref="alg1.l11.m1.3.3.3.3.3.2.1">~</ci><ci id="alg1.l11.m1.3.3.3.3.3.2.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.2.2">𝑜</ci></apply><apply id="alg1.l11.m1.3.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3"><plus id="alg1.l11.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.1"></plus><apply id="alg1.l11.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.3.3.2.1.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.2">superscript</csymbol><ci id="alg1.l11.m1.3.3.3.3.3.3.2.2.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.2.2">𝑡</ci><ci id="alg1.l11.m1.3.3.3.3.3.3.2.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.2.3">′</ci></apply><ci id="alg1.l11.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3.3.3">𝐻</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">\text{Model}(\tilde{o}_{t^{\prime}},\hat{\pi}_{t^{\prime}},\tilde{o}_{t^{%
\prime}+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">Model ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><math alttext="\mathcal{L}_{s}\leftarrow\mathcal{L}_{s}+D_{\mathrm{KL}}\left[{Q}_{\phi_{s}}({%
s}_{t^{\prime}+H})\left|\right|\mathcal{N}(\mu,\sigma^{2})\right]" class="ltx_math_unparsed" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1b"><msub id="alg1.l12.m1.1.2"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.2.2">ℒ</mi><mi id="alg1.l12.m1.1.2.3">s</mi></msub><mo id="alg1.l12.m1.1.3" stretchy="false">←</mo><msub id="alg1.l12.m1.1.4"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.4.2">ℒ</mi><mi id="alg1.l12.m1.1.4.3">s</mi></msub><mo id="alg1.l12.m1.1.5">+</mo><msub id="alg1.l12.m1.1.6"><mi id="alg1.l12.m1.1.6.2">D</mi><mi id="alg1.l12.m1.1.6.3">KL</mi></msub><mrow id="alg1.l12.m1.1.7"><mo id="alg1.l12.m1.1.7.1">[</mo><msub id="alg1.l12.m1.1.7.2"><mi id="alg1.l12.m1.1.7.2.2">Q</mi><msub id="alg1.l12.m1.1.7.2.3"><mi id="alg1.l12.m1.1.7.2.3.2">ϕ</mi><mi id="alg1.l12.m1.1.7.2.3.3">s</mi></msub></msub><mrow id="alg1.l12.m1.1.7.3"><mo id="alg1.l12.m1.1.7.3.1" stretchy="false">(</mo><msub id="alg1.l12.m1.1.7.3.2"><mi id="alg1.l12.m1.1.7.3.2.2">s</mi><mrow id="alg1.l12.m1.1.7.3.2.3"><msup id="alg1.l12.m1.1.7.3.2.3.2"><mi id="alg1.l12.m1.1.7.3.2.3.2.2">t</mi><mo id="alg1.l12.m1.1.7.3.2.3.2.3">′</mo></msup><mo id="alg1.l12.m1.1.7.3.2.3.1">+</mo><mi id="alg1.l12.m1.1.7.3.2.3.3">H</mi></mrow></msub><mo id="alg1.l12.m1.1.7.3.3" stretchy="false">)</mo></mrow><mo fence="false" id="alg1.l12.m1.1.7.4" rspace="0.167em">|</mo><mo fence="false" id="alg1.l12.m1.1.7.5" rspace="0.167em">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.7.6">𝒩</mi><mrow id="alg1.l12.m1.1.7.7"><mo id="alg1.l12.m1.1.7.7.1" stretchy="false">(</mo><mi id="alg1.l12.m1.1.1">μ</mi><mo id="alg1.l12.m1.1.7.7.2">,</mo><msup id="alg1.l12.m1.1.7.7.3"><mi id="alg1.l12.m1.1.7.7.3.2">σ</mi><mn id="alg1.l12.m1.1.7.7.3.3">2</mn></msup><mo id="alg1.l12.m1.1.7.7.4" stretchy="false">)</mo></mrow><mo id="alg1.l12.m1.1.7.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathcal{L}_{s}\leftarrow\mathcal{L}_{s}+D_{\mathrm{KL}}\left[{Q}_{\phi_{s}}({%
s}_{t^{\prime}+H})\left|\right|\mathcal{N}(\mu,\sigma^{2})\right]</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← caligraphic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT ) | | caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span><math alttext="\mathcal{L}_{o}\leftarrow\mathcal{L}_{o}-\mathop{{}\mathbb{E}}_{Q(s_{t^{\prime%
}+H})}\left[\log{P}_{\theta_{o}}({o}_{t^{\prime}+H}|\tilde{s}_{t^{\prime}+H})\right]" class="ltx_Math" display="inline" id="alg1.l13.m1.2"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><msub id="alg1.l13.m1.2.2.3" xref="alg1.l13.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.3.2" xref="alg1.l13.m1.2.2.3.2.cmml">ℒ</mi><mi id="alg1.l13.m1.2.2.3.3" xref="alg1.l13.m1.2.2.3.3.cmml">o</mi></msub><mo id="alg1.l13.m1.2.2.2" stretchy="false" xref="alg1.l13.m1.2.2.2.cmml">←</mo><mrow id="alg1.l13.m1.2.2.1" xref="alg1.l13.m1.2.2.1.cmml"><msub id="alg1.l13.m1.2.2.1.3" xref="alg1.l13.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.1.3.2" xref="alg1.l13.m1.2.2.1.3.2.cmml">ℒ</mi><mi id="alg1.l13.m1.2.2.1.3.3" xref="alg1.l13.m1.2.2.1.3.3.cmml">o</mi></msub><mo id="alg1.l13.m1.2.2.1.2" xref="alg1.l13.m1.2.2.1.2.cmml">−</mo><mrow id="alg1.l13.m1.2.2.1.1" xref="alg1.l13.m1.2.2.1.1.cmml"><msub id="alg1.l13.m1.2.2.1.1.2" xref="alg1.l13.m1.2.2.1.1.2.cmml"><mo id="alg1.l13.m1.2.2.1.1.2.2" lspace="0em" rspace="0em" xref="alg1.l13.m1.2.2.1.1.2.2.cmml">𝔼</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3.cmml">Q</mi><mo id="alg1.l13.m1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="alg1.l13.m1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.cmml"><msup id="alg1.l13.m1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.3.2.2" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.3.2.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msup><mo id="alg1.l13.m1.1.1.1.1.1.1.3.1" xref="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="alg1.l13.m1.1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l13.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mrow id="alg1.l13.m1.2.2.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.2.cmml"><mo id="alg1.l13.m1.2.2.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.cmml"><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.3.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="alg1.l13.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="alg1.l13.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.2.cmml">P</mi><msub id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.3.cmml">o</mi></msub></msub></mrow><mo id="alg1.l13.m1.2.2.1.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><msup id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3.cmml">′</mo></msup><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><msup id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml">′</mo></msup><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m1.2.2.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><ci id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2">←</ci><apply id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.3.1.cmml" xref="alg1.l13.m1.2.2.3">subscript</csymbol><ci id="alg1.l13.m1.2.2.3.2.cmml" xref="alg1.l13.m1.2.2.3.2">ℒ</ci><ci id="alg1.l13.m1.2.2.3.3.cmml" xref="alg1.l13.m1.2.2.3.3">𝑜</ci></apply><apply id="alg1.l13.m1.2.2.1.cmml" xref="alg1.l13.m1.2.2.1"><minus id="alg1.l13.m1.2.2.1.2.cmml" xref="alg1.l13.m1.2.2.1.2"></minus><apply id="alg1.l13.m1.2.2.1.3.cmml" xref="alg1.l13.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.3.1.cmml" xref="alg1.l13.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.3.2.cmml" xref="alg1.l13.m1.2.2.1.3.2">ℒ</ci><ci id="alg1.l13.m1.2.2.1.3.3.cmml" xref="alg1.l13.m1.2.2.1.3.3">𝑜</ci></apply><apply id="alg1.l13.m1.2.2.1.1.cmml" xref="alg1.l13.m1.2.2.1.1"><apply id="alg1.l13.m1.2.2.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.2.2">𝔼</ci><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><times id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></times><ci id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3">𝑄</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3"><plus id="alg1.l13.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.1"></plus><apply id="alg1.l13.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="alg1.l13.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></apply><apply id="alg1.l13.m1.2.2.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l13.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l13.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1"><times id="alg1.l13.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.2"></times><apply id="alg1.l13.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3"><log id="alg1.l13.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.1"></log><apply id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.2">𝑃</ci><apply id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.3.2.3.3">𝑜</ci></apply></apply></apply><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑜</ci><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3"><plus id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></plus><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">superscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2">𝑡</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3">′</ci></apply><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3"><plus id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.1"></plus><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.2">𝑡</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.3">′</ci></apply><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\mathcal{L}_{o}\leftarrow\mathcal{L}_{o}-\mathop{{}\mathbb{E}}_{Q(s_{t^{\prime%
}+H})}\left[\log{P}_{\theta_{o}}({o}_{t^{\prime}+H}|\tilde{s}_{t^{\prime}+H})\right]</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ← caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT - blackboard_E start_POSTSUBSCRIPT italic_Q ( italic_s start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ roman_log italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><math alttext="\mathcal{L}_{o}\leftarrow\mathcal{L}_{o}+\beta*D_{\mathrm{KL}}\left[{Q}_{\phi_%
{s}}({s}_{t^{\prime}+H})\left|\right|\mathcal{N}(\tilde{\mu},\tilde{\sigma}^{2%
})\right]" class="ltx_math_unparsed" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1b"><msub id="alg1.l14.m1.1.2"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.1.2.2">ℒ</mi><mi id="alg1.l14.m1.1.2.3">o</mi></msub><mo id="alg1.l14.m1.1.3" stretchy="false">←</mo><msub id="alg1.l14.m1.1.4"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.1.4.2">ℒ</mi><mi id="alg1.l14.m1.1.4.3">o</mi></msub><mo id="alg1.l14.m1.1.5">+</mo><mi id="alg1.l14.m1.1.6">β</mi><mo id="alg1.l14.m1.1.7" lspace="0.222em" rspace="0.222em">∗</mo><msub id="alg1.l14.m1.1.8"><mi id="alg1.l14.m1.1.8.2">D</mi><mi id="alg1.l14.m1.1.8.3">KL</mi></msub><mrow id="alg1.l14.m1.1.9"><mo id="alg1.l14.m1.1.9.1">[</mo><msub id="alg1.l14.m1.1.9.2"><mi id="alg1.l14.m1.1.9.2.2">Q</mi><msub id="alg1.l14.m1.1.9.2.3"><mi id="alg1.l14.m1.1.9.2.3.2">ϕ</mi><mi id="alg1.l14.m1.1.9.2.3.3">s</mi></msub></msub><mrow id="alg1.l14.m1.1.9.3"><mo id="alg1.l14.m1.1.9.3.1" stretchy="false">(</mo><msub id="alg1.l14.m1.1.9.3.2"><mi id="alg1.l14.m1.1.9.3.2.2">s</mi><mrow id="alg1.l14.m1.1.9.3.2.3"><msup id="alg1.l14.m1.1.9.3.2.3.2"><mi id="alg1.l14.m1.1.9.3.2.3.2.2">t</mi><mo id="alg1.l14.m1.1.9.3.2.3.2.3">′</mo></msup><mo id="alg1.l14.m1.1.9.3.2.3.1">+</mo><mi id="alg1.l14.m1.1.9.3.2.3.3">H</mi></mrow></msub><mo id="alg1.l14.m1.1.9.3.3" stretchy="false">)</mo></mrow><mo fence="false" id="alg1.l14.m1.1.9.4" rspace="0.167em">|</mo><mo fence="false" id="alg1.l14.m1.1.9.5" rspace="0.167em">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.1.9.6">𝒩</mi><mrow id="alg1.l14.m1.1.9.7"><mo id="alg1.l14.m1.1.9.7.1" stretchy="false">(</mo><mover accent="true" id="alg1.l14.m1.1.1"><mi id="alg1.l14.m1.1.1.2">μ</mi><mo id="alg1.l14.m1.1.1.1">~</mo></mover><mo id="alg1.l14.m1.1.9.7.2">,</mo><msup id="alg1.l14.m1.1.9.7.3"><mover accent="true" id="alg1.l14.m1.1.9.7.3.2"><mi id="alg1.l14.m1.1.9.7.3.2.2">σ</mi><mo id="alg1.l14.m1.1.9.7.3.2.1">~</mo></mover><mn id="alg1.l14.m1.1.9.7.3.3">2</mn></msup><mo id="alg1.l14.m1.1.9.7.4" stretchy="false">)</mo></mrow><mo id="alg1.l14.m1.1.9.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\mathcal{L}_{o}\leftarrow\mathcal{L}_{o}+\beta*D_{\mathrm{KL}}\left[{Q}_{\phi_%
{s}}({s}_{t^{\prime}+H})\left|\right|\mathcal{N}(\tilde{\mu},\tilde{\sigma}^{2%
})\right]</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ← caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT + italic_β ∗ italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + italic_H end_POSTSUBSCRIPT ) | | caligraphic_N ( over~ start_ARG italic_μ end_ARG , over~ start_ARG italic_σ end_ARG start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l14.2">\EndFor</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><math alttext="\theta_{s}\leftarrow\theta_{s}-\xi\nabla_{\theta_{s}}\mathbb{E}\bigl{[}%
\mathcal{L}_{s}(\theta_{s})\bigr{]}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l15.m1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><msub id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.3.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.3.cmml">ξ</mi><mo id="alg1.l15.m1.1.1.1.1.2" lspace="0.167em" xref="alg1.l15.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.4" xref="alg1.l15.m1.1.1.1.1.4.cmml"><msub id="alg1.l15.m1.1.1.1.1.4.1" xref="alg1.l15.m1.1.1.1.1.4.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l15.m1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="alg1.l15.m1.1.1.1.1.4.1.3" xref="alg1.l15.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.4.1.3.2" xref="alg1.l15.m1.1.1.1.1.4.1.3.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.1.4.1.3.3" xref="alg1.l15.m1.1.1.1.1.4.1.3.3.cmml">s</mi></msub></msub><mi id="alg1.l15.m1.1.1.1.1.4.2" xref="alg1.l15.m1.1.1.1.1.4.2.cmml">𝔼</mi></mrow><mo id="alg1.l15.m1.1.1.1.1.2a" xref="alg1.l15.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l15.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l15.m1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l15.m1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l15.m1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l15.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝜃</ci><ci id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><minus id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></minus><apply id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.2"></times><ci id="alg1.l15.m1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.3">𝜉</ci><apply id="alg1.l15.m1.1.1.1.1.4.cmml" xref="alg1.l15.m1.1.1.1.1.4"><apply id="alg1.l15.m1.1.1.1.1.4.1.cmml" xref="alg1.l15.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l15.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.4.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.4.1.3.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.4.1.3.3">𝑠</ci></apply></apply><ci id="alg1.l15.m1.1.1.1.1.4.2.cmml" xref="alg1.l15.m1.1.1.1.1.4.2">𝔼</ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l15.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\theta_{s}\leftarrow\theta_{s}-\xi\nabla_{\theta_{s}}\mathbb{E}\bigl{[}%
\mathcal{L}_{s}(\theta_{s})\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - italic_ξ ∇ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ caligraphic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span><math alttext="\phi_{s}\leftarrow\phi_{s}-\gamma\nabla_{\phi_{s}}\mathbb{E}\bigl{[}\mathcal{L%
}_{s}(\phi_{o})\bigr{]}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l16.m1.1.1.2" stretchy="false" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l16.m1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.3.cmml">γ</mi><mo id="alg1.l16.m1.1.1.1.1.2" lspace="0.167em" xref="alg1.l16.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.1.1.1.1.4" xref="alg1.l16.m1.1.1.1.1.4.cmml"><msub id="alg1.l16.m1.1.1.1.1.4.1" xref="alg1.l16.m1.1.1.1.1.4.1.cmml"><mo id="alg1.l16.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l16.m1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="alg1.l16.m1.1.1.1.1.4.1.3" xref="alg1.l16.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.4.1.3.2" xref="alg1.l16.m1.1.1.1.1.4.1.3.2.cmml">ϕ</mi><mi id="alg1.l16.m1.1.1.1.1.4.1.3.3" xref="alg1.l16.m1.1.1.1.1.4.1.3.3.cmml">s</mi></msub></msub><mi id="alg1.l16.m1.1.1.1.1.4.2" xref="alg1.l16.m1.1.1.1.1.4.2.cmml">𝔼</mi></mrow><mo id="alg1.l16.m1.1.1.1.1.2a" xref="alg1.l16.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l16.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l16.m1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l16.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><minus id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></minus><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l16.m1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.2"></times><ci id="alg1.l16.m1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.3">𝛾</ci><apply id="alg1.l16.m1.1.1.1.1.4.cmml" xref="alg1.l16.m1.1.1.1.1.4"><apply id="alg1.l16.m1.1.1.1.1.4.1.cmml" xref="alg1.l16.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l16.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.4.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.4.1.3.2">italic-ϕ</ci><ci id="alg1.l16.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.4.1.3.3">𝑠</ci></apply></apply><ci id="alg1.l16.m1.1.1.1.1.4.2.cmml" xref="alg1.l16.m1.1.1.1.1.4.2">𝔼</ci></apply><apply id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l16.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\phi_{s}\leftarrow\phi_{s}-\gamma\nabla_{\phi_{s}}\mathbb{E}\bigl{[}\mathcal{L%
}_{s}(\phi_{o})\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - italic_γ ∇ start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ caligraphic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_ϕ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span><math alttext="\theta_{o}\leftarrow\theta_{o}-\eta\nabla_{\theta_{o}}\mathbb{E}\bigl{[}%
\mathcal{L}_{o}(\theta_{o})\bigr{]}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msub id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">θ</mi><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">o</mi></msub><mo id="alg1.l17.m1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.2.cmml">←</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><msub id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml">θ</mi><mi id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml">o</mi></msub><mo id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.3.cmml">η</mi><mo id="alg1.l17.m1.1.1.1.1.2" lspace="0.167em" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.4" xref="alg1.l17.m1.1.1.1.1.4.cmml"><msub id="alg1.l17.m1.1.1.1.1.4.1" xref="alg1.l17.m1.1.1.1.1.4.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l17.m1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="alg1.l17.m1.1.1.1.1.4.1.3" xref="alg1.l17.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.4.1.3.2" xref="alg1.l17.m1.1.1.1.1.4.1.3.2.cmml">θ</mi><mi id="alg1.l17.m1.1.1.1.1.4.1.3.3" xref="alg1.l17.m1.1.1.1.1.4.1.3.3.cmml">o</mi></msub></msub><mi id="alg1.l17.m1.1.1.1.1.4.2" xref="alg1.l17.m1.1.1.1.1.4.2.cmml">𝔼</mi></mrow><mo id="alg1.l17.m1.1.1.1.1.2a" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l17.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.3.cmml">o</mi></msub><mo id="alg1.l17.m1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l17.m1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l17.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">←</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝜃</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑜</ci></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><minus id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></minus><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2">𝜃</ci><ci id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3">𝑜</ci></apply><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"></times><ci id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3">𝜂</ci><apply id="alg1.l17.m1.1.1.1.1.4.cmml" xref="alg1.l17.m1.1.1.1.1.4"><apply id="alg1.l17.m1.1.1.1.1.4.1.cmml" xref="alg1.l17.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l17.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.4.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.4.1.3.2">𝜃</ci><ci id="alg1.l17.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.4.1.3.3">𝑜</ci></apply></apply><ci id="alg1.l17.m1.1.1.1.1.4.2.cmml" xref="alg1.l17.m1.1.1.1.1.4.2">𝔼</ci></apply><apply id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l17.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.3">𝑜</ci></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\theta_{o}\leftarrow\theta_{o}-\eta\nabla_{\theta_{o}}\mathbb{E}\bigl{[}%
\mathcal{L}_{o}(\theta_{o})\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ← italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT - italic_η ∇ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mo id="alg1.l18.m1.1.1" mathcolor="#000099" xref="alg1.l18.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">▷</annotation></semantics></math><span class="ltx_text ltx_font_smallcaps" id="alg1.l18.2" style="color:#000099;"> Policy Optimization</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span><math alttext="\{\tilde{o}_{\tau}\}^{B_{2}}\sim\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><msup id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml"><mrow id="alg1.l19.m1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.2.cmml"><mo id="alg1.l19.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l19.m1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l19.m1.1.1.1.1.1.1.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml">o</mi><mo id="alg1.l19.m1.1.1.1.1.1.1.2.1" xref="alg1.l19.m1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l19.m1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="alg1.l19.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l19.m1.1.1.1.1.2.cmml">}</mo></mrow><msub id="alg1.l19.m1.1.1.1.3" xref="alg1.l19.m1.1.1.1.3.cmml"><mi id="alg1.l19.m1.1.1.1.3.2" xref="alg1.l19.m1.1.1.1.3.2.cmml">B</mi><mn id="alg1.l19.m1.1.1.1.3.3" xref="alg1.l19.m1.1.1.1.3.3.cmml">2</mn></msub></msup><mo id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="latexml" id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">similar-to</csymbol><apply id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1">superscript</csymbol><set id="alg1.l19.m1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1"><apply id="alg1.l19.m1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l19.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2"><ci id="alg1.l19.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.2">𝑜</ci></apply><ci id="alg1.l19.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.3">𝜏</ci></apply></set><apply id="alg1.l19.m1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.1.3.2">𝐵</ci><cn id="alg1.l19.m1.1.1.1.3.3.cmml" type="integer" xref="alg1.l19.m1.1.1.1.3.3">2</cn></apply></apply><ci id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\{\tilde{o}_{\tau}\}^{B_{2}}\sim\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">{ over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∼ caligraphic_M</annotation></semantics></math> <span class="ltx_ERROR undefined" id="alg1.l19.2">\For</span><math alttext="\tau=1,2,...,B_{2}" class="ltx_Math" display="inline" id="alg1.l19.m2.4"><semantics id="alg1.l19.m2.4a"><mrow id="alg1.l19.m2.4.4" xref="alg1.l19.m2.4.4.cmml"><mi id="alg1.l19.m2.4.4.3" xref="alg1.l19.m2.4.4.3.cmml">τ</mi><mo id="alg1.l19.m2.4.4.2" xref="alg1.l19.m2.4.4.2.cmml">=</mo><mrow id="alg1.l19.m2.4.4.1.1" xref="alg1.l19.m2.4.4.1.2.cmml"><mn id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml">1</mn><mo id="alg1.l19.m2.4.4.1.1.2" xref="alg1.l19.m2.4.4.1.2.cmml">,</mo><mn id="alg1.l19.m2.2.2" xref="alg1.l19.m2.2.2.cmml">2</mn><mo id="alg1.l19.m2.4.4.1.1.3" xref="alg1.l19.m2.4.4.1.2.cmml">,</mo><mi id="alg1.l19.m2.3.3" mathvariant="normal" xref="alg1.l19.m2.3.3.cmml">…</mi><mo id="alg1.l19.m2.4.4.1.1.4" xref="alg1.l19.m2.4.4.1.2.cmml">,</mo><msub id="alg1.l19.m2.4.4.1.1.1" xref="alg1.l19.m2.4.4.1.1.1.cmml"><mi id="alg1.l19.m2.4.4.1.1.1.2" xref="alg1.l19.m2.4.4.1.1.1.2.cmml">B</mi><mn id="alg1.l19.m2.4.4.1.1.1.3" xref="alg1.l19.m2.4.4.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.4b"><apply id="alg1.l19.m2.4.4.cmml" xref="alg1.l19.m2.4.4"><eq id="alg1.l19.m2.4.4.2.cmml" xref="alg1.l19.m2.4.4.2"></eq><ci id="alg1.l19.m2.4.4.3.cmml" xref="alg1.l19.m2.4.4.3">𝜏</ci><list id="alg1.l19.m2.4.4.1.2.cmml" xref="alg1.l19.m2.4.4.1.1"><cn id="alg1.l19.m2.1.1.cmml" type="integer" xref="alg1.l19.m2.1.1">1</cn><cn id="alg1.l19.m2.2.2.cmml" type="integer" xref="alg1.l19.m2.2.2">2</cn><ci id="alg1.l19.m2.3.3.cmml" xref="alg1.l19.m2.3.3">…</ci><apply id="alg1.l19.m2.4.4.1.1.1.cmml" xref="alg1.l19.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.4.4.1.1.1.1.cmml" xref="alg1.l19.m2.4.4.1.1.1">subscript</csymbol><ci id="alg1.l19.m2.4.4.1.1.1.2.cmml" xref="alg1.l19.m2.4.4.1.1.1.2">𝐵</ci><cn id="alg1.l19.m2.4.4.1.1.1.3.cmml" type="integer" xref="alg1.l19.m2.4.4.1.1.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.4c">\tau=1,2,...,B_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.4d">italic_τ = 1 , 2 , … , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>Compute <math alttext="Q_{\phi_{s}}(s_{\tau})" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><msub id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"><mi id="alg1.l20.m1.1.1.3.2" xref="alg1.l20.m1.1.1.3.2.cmml">Q</mi><msub id="alg1.l20.m1.1.1.3.3" xref="alg1.l20.m1.1.1.3.3.cmml"><mi id="alg1.l20.m1.1.1.3.3.2" xref="alg1.l20.m1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l20.m1.1.1.3.3.3" xref="alg1.l20.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l20.m1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.cmml"><mo id="alg1.l20.m1.1.1.1.1.2" stretchy="false" xref="alg1.l20.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l20.m1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.cmml"><mi id="alg1.l20.m1.1.1.1.1.1.2" xref="alg1.l20.m1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l20.m1.1.1.1.1.1.3" xref="alg1.l20.m1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="alg1.l20.m1.1.1.1.1.3" stretchy="false" xref="alg1.l20.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><times id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2"></times><apply id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.1.cmml" xref="alg1.l20.m1.1.1.3">subscript</csymbol><ci id="alg1.l20.m1.1.1.3.2.cmml" xref="alg1.l20.m1.1.1.3.2">𝑄</ci><apply id="alg1.l20.m1.1.1.3.3.cmml" xref="alg1.l20.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.3.1.cmml" xref="alg1.l20.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l20.m1.1.1.3.3.2.cmml" xref="alg1.l20.m1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l20.m1.1.1.3.3.3.cmml" xref="alg1.l20.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l20.m1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m1.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l20.m1.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">Q_{\phi_{s}}(s_{\tau})</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\tilde{o}_{\tau}" class="ltx_Math" display="inline" id="alg1.l20.m2.1"><semantics id="alg1.l20.m2.1a"><msub id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml"><mover accent="true" id="alg1.l20.m2.1.1.2" xref="alg1.l20.m2.1.1.2.cmml"><mi id="alg1.l20.m2.1.1.2.2" xref="alg1.l20.m2.1.1.2.2.cmml">o</mi><mo id="alg1.l20.m2.1.1.2.1" xref="alg1.l20.m2.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l20.m2.1.1.3" xref="alg1.l20.m2.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><apply id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.cmml" xref="alg1.l20.m2.1.1">subscript</csymbol><apply id="alg1.l20.m2.1.1.2.cmml" xref="alg1.l20.m2.1.1.2"><ci id="alg1.l20.m2.1.1.2.1.cmml" xref="alg1.l20.m2.1.1.2.1">~</ci><ci id="alg1.l20.m2.1.1.2.2.cmml" xref="alg1.l20.m2.1.1.2.2">𝑜</ci></apply><ci id="alg1.l20.m2.1.1.3.cmml" xref="alg1.l20.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">\tilde{o}_{\tau}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m2.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>Sample <math alttext="\tilde{s}_{\tau}\sim Q_{\phi_{s}}(s_{\tau})" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msub id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mover accent="true" id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml"><mi id="alg1.l21.m1.1.1.3.2.2" xref="alg1.l21.m1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l21.m1.1.1.3.2.1" xref="alg1.l21.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml">τ</mi></msub><mo id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml"><msub id="alg1.l21.m1.1.1.1.3" xref="alg1.l21.m1.1.1.1.3.cmml"><mi id="alg1.l21.m1.1.1.1.3.2" xref="alg1.l21.m1.1.1.1.3.2.cmml">Q</mi><msub id="alg1.l21.m1.1.1.1.3.3" xref="alg1.l21.m1.1.1.1.3.3.cmml"><mi id="alg1.l21.m1.1.1.1.3.3.2" xref="alg1.l21.m1.1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l21.m1.1.1.1.3.3.3" xref="alg1.l21.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l21.m1.1.1.1.2" xref="alg1.l21.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l21.m1.1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l21.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l21.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l21.m1.1.1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l21.m1.1.1.1.1.1.1.2" xref="alg1.l21.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l21.m1.1.1.1.1.1.1.3" xref="alg1.l21.m1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="alg1.l21.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="latexml" id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">similar-to</csymbol><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3">subscript</csymbol><apply id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2"><ci id="alg1.l21.m1.1.1.3.2.1.cmml" xref="alg1.l21.m1.1.1.3.2.1">~</ci><ci id="alg1.l21.m1.1.1.3.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2">𝑠</ci></apply><ci id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3">𝜏</ci></apply><apply id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"><times id="alg1.l21.m1.1.1.1.2.cmml" xref="alg1.l21.m1.1.1.1.2"></times><apply id="alg1.l21.m1.1.1.1.3.cmml" xref="alg1.l21.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l21.m1.1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.1.3.2">𝑄</ci><apply id="alg1.l21.m1.1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.3.3.1.cmml" xref="alg1.l21.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l21.m1.1.1.1.3.3.2.cmml" xref="alg1.l21.m1.1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l21.m1.1.1.1.3.3.3.cmml" xref="alg1.l21.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l21.m1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l21.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\tilde{s}_{\tau}\sim Q_{\phi_{s}}(s_{\tau})</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ∼ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT )</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l21.2">\For</span><math alttext="s=1,2,...,S_{1}" class="ltx_Math" display="inline" id="alg1.l21.m2.4"><semantics id="alg1.l21.m2.4a"><mrow id="alg1.l21.m2.4.4" xref="alg1.l21.m2.4.4.cmml"><mi id="alg1.l21.m2.4.4.3" xref="alg1.l21.m2.4.4.3.cmml">s</mi><mo id="alg1.l21.m2.4.4.2" xref="alg1.l21.m2.4.4.2.cmml">=</mo><mrow id="alg1.l21.m2.4.4.1.1" xref="alg1.l21.m2.4.4.1.2.cmml"><mn id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml">1</mn><mo id="alg1.l21.m2.4.4.1.1.2" xref="alg1.l21.m2.4.4.1.2.cmml">,</mo><mn id="alg1.l21.m2.2.2" xref="alg1.l21.m2.2.2.cmml">2</mn><mo id="alg1.l21.m2.4.4.1.1.3" xref="alg1.l21.m2.4.4.1.2.cmml">,</mo><mi id="alg1.l21.m2.3.3" mathvariant="normal" xref="alg1.l21.m2.3.3.cmml">…</mi><mo id="alg1.l21.m2.4.4.1.1.4" xref="alg1.l21.m2.4.4.1.2.cmml">,</mo><msub id="alg1.l21.m2.4.4.1.1.1" xref="alg1.l21.m2.4.4.1.1.1.cmml"><mi id="alg1.l21.m2.4.4.1.1.1.2" xref="alg1.l21.m2.4.4.1.1.1.2.cmml">S</mi><mn id="alg1.l21.m2.4.4.1.1.1.3" xref="alg1.l21.m2.4.4.1.1.1.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.4b"><apply id="alg1.l21.m2.4.4.cmml" xref="alg1.l21.m2.4.4"><eq id="alg1.l21.m2.4.4.2.cmml" xref="alg1.l21.m2.4.4.2"></eq><ci id="alg1.l21.m2.4.4.3.cmml" xref="alg1.l21.m2.4.4.3">𝑠</ci><list id="alg1.l21.m2.4.4.1.2.cmml" xref="alg1.l21.m2.4.4.1.1"><cn id="alg1.l21.m2.1.1.cmml" type="integer" xref="alg1.l21.m2.1.1">1</cn><cn id="alg1.l21.m2.2.2.cmml" type="integer" xref="alg1.l21.m2.2.2">2</cn><ci id="alg1.l21.m2.3.3.cmml" xref="alg1.l21.m2.3.3">…</ci><apply id="alg1.l21.m2.4.4.1.1.1.cmml" xref="alg1.l21.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m2.4.4.1.1.1.1.cmml" xref="alg1.l21.m2.4.4.1.1.1">subscript</csymbol><ci id="alg1.l21.m2.4.4.1.1.1.2.cmml" xref="alg1.l21.m2.4.4.1.1.1.2">𝑆</ci><cn id="alg1.l21.m2.4.4.1.1.1.3.cmml" type="integer" xref="alg1.l21.m2.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.4c">s=1,2,...,S_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.4d">italic_s = 1 , 2 , … , italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>Compute <math alttext="\mu,\sigma\leftarrow{P}_{\theta_{s}}({s}_{\tau+H}|\tilde{s}_{\tau},\hat{\pi}_{%
t})" class="ltx_Math" display="inline" id="alg1.l22.m1.3"><semantics id="alg1.l22.m1.3a"><mrow id="alg1.l22.m1.3.3" xref="alg1.l22.m1.3.3.cmml"><mrow id="alg1.l22.m1.3.3.3.2" xref="alg1.l22.m1.3.3.3.1.cmml"><mi id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">μ</mi><mo id="alg1.l22.m1.3.3.3.2.1" xref="alg1.l22.m1.3.3.3.1.cmml">,</mo><mi id="alg1.l22.m1.2.2" xref="alg1.l22.m1.2.2.cmml">σ</mi></mrow><mo id="alg1.l22.m1.3.3.2" stretchy="false" xref="alg1.l22.m1.3.3.2.cmml">←</mo><mrow id="alg1.l22.m1.3.3.1" xref="alg1.l22.m1.3.3.1.cmml"><msub id="alg1.l22.m1.3.3.1.3" xref="alg1.l22.m1.3.3.1.3.cmml"><mi id="alg1.l22.m1.3.3.1.3.2" xref="alg1.l22.m1.3.3.1.3.2.cmml">P</mi><msub id="alg1.l22.m1.3.3.1.3.3" xref="alg1.l22.m1.3.3.1.3.3.cmml"><mi id="alg1.l22.m1.3.3.1.3.3.2" xref="alg1.l22.m1.3.3.1.3.3.2.cmml">θ</mi><mi id="alg1.l22.m1.3.3.1.3.3.3" xref="alg1.l22.m1.3.3.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l22.m1.3.3.1.2" xref="alg1.l22.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l22.m1.3.3.1.1.1" xref="alg1.l22.m1.3.3.1.1.1.1.cmml"><mo id="alg1.l22.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l22.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg1.l22.m1.3.3.1.1.1.1" xref="alg1.l22.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l22.m1.3.3.1.1.1.1.4" xref="alg1.l22.m1.3.3.1.1.1.1.4.cmml"><mi id="alg1.l22.m1.3.3.1.1.1.1.4.2" xref="alg1.l22.m1.3.3.1.1.1.1.4.2.cmml">s</mi><mrow id="alg1.l22.m1.3.3.1.1.1.1.4.3" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.cmml"><mi id="alg1.l22.m1.3.3.1.1.1.1.4.3.2" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.2.cmml">τ</mi><mo id="alg1.l22.m1.3.3.1.1.1.1.4.3.1" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.1.cmml">+</mo><mi id="alg1.l22.m1.3.3.1.1.1.1.4.3.3" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l22.m1.3.3.1.1.1.1.3" xref="alg1.l22.m1.3.3.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l22.m1.3.3.1.1.1.1.2.2" xref="alg1.l22.m1.3.3.1.1.1.1.2.3.cmml"><msub id="alg1.l22.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.2" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.1" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="alg1.l22.m1.3.3.1.1.1.1.2.2.3" xref="alg1.l22.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l22.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.cmml"><mover accent="true" id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.2" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">π</mi><mo id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.1" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="alg1.l22.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.l22.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.3b"><apply id="alg1.l22.m1.3.3.cmml" xref="alg1.l22.m1.3.3"><ci id="alg1.l22.m1.3.3.2.cmml" xref="alg1.l22.m1.3.3.2">←</ci><list id="alg1.l22.m1.3.3.3.1.cmml" xref="alg1.l22.m1.3.3.3.2"><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">𝜇</ci><ci id="alg1.l22.m1.2.2.cmml" xref="alg1.l22.m1.2.2">𝜎</ci></list><apply id="alg1.l22.m1.3.3.1.cmml" xref="alg1.l22.m1.3.3.1"><times id="alg1.l22.m1.3.3.1.2.cmml" xref="alg1.l22.m1.3.3.1.2"></times><apply id="alg1.l22.m1.3.3.1.3.cmml" xref="alg1.l22.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.1.3.1.cmml" xref="alg1.l22.m1.3.3.1.3">subscript</csymbol><ci id="alg1.l22.m1.3.3.1.3.2.cmml" xref="alg1.l22.m1.3.3.1.3.2">𝑃</ci><apply id="alg1.l22.m1.3.3.1.3.3.cmml" xref="alg1.l22.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.1.3.3.1.cmml" xref="alg1.l22.m1.3.3.1.3.3">subscript</csymbol><ci id="alg1.l22.m1.3.3.1.3.3.2.cmml" xref="alg1.l22.m1.3.3.1.3.3.2">𝜃</ci><ci id="alg1.l22.m1.3.3.1.3.3.3.cmml" xref="alg1.l22.m1.3.3.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l22.m1.3.3.1.1.1.1.cmml" xref="alg1.l22.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg1.l22.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.3">conditional</csymbol><apply id="alg1.l22.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.1.1.1.1.4.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="alg1.l22.m1.3.3.1.1.1.1.4.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4.2">𝑠</ci><apply id="alg1.l22.m1.3.3.1.1.1.1.4.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4.3"><plus id="alg1.l22.m1.3.3.1.1.1.1.4.3.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.1"></plus><ci id="alg1.l22.m1.3.3.1.1.1.1.4.3.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.2">𝜏</ci><ci id="alg1.l22.m1.3.3.1.1.1.1.4.3.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.4.3.3">𝐻</ci></apply></apply><list id="alg1.l22.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2"><apply id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2"><ci id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="alg1.l22.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><apply id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2"><ci id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.1">^</ci><ci id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.2.2">𝜋</ci></apply><ci id="alg1.l22.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="alg1.l22.m1.3.3.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.3c">\mu,\sigma\leftarrow{P}_{\theta_{s}}({s}_{\tau+H}|\tilde{s}_{\tau},\hat{\pi}_{%
t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.3d">italic_μ , italic_σ ← italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>Sample <math alttext="\tilde{s}_{\tau+H}\sim\mathcal{N}({\mu},{\sigma}^{2})" class="ltx_Math" display="inline" id="alg1.l23.m1.2"><semantics id="alg1.l23.m1.2a"><mrow id="alg1.l23.m1.2.2" xref="alg1.l23.m1.2.2.cmml"><msub id="alg1.l23.m1.2.2.3" xref="alg1.l23.m1.2.2.3.cmml"><mover accent="true" id="alg1.l23.m1.2.2.3.2" xref="alg1.l23.m1.2.2.3.2.cmml"><mi id="alg1.l23.m1.2.2.3.2.2" xref="alg1.l23.m1.2.2.3.2.2.cmml">s</mi><mo id="alg1.l23.m1.2.2.3.2.1" xref="alg1.l23.m1.2.2.3.2.1.cmml">~</mo></mover><mrow id="alg1.l23.m1.2.2.3.3" xref="alg1.l23.m1.2.2.3.3.cmml"><mi id="alg1.l23.m1.2.2.3.3.2" xref="alg1.l23.m1.2.2.3.3.2.cmml">τ</mi><mo id="alg1.l23.m1.2.2.3.3.1" xref="alg1.l23.m1.2.2.3.3.1.cmml">+</mo><mi id="alg1.l23.m1.2.2.3.3.3" xref="alg1.l23.m1.2.2.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l23.m1.2.2.2" xref="alg1.l23.m1.2.2.2.cmml">∼</mo><mrow id="alg1.l23.m1.2.2.1" xref="alg1.l23.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l23.m1.2.2.1.3" xref="alg1.l23.m1.2.2.1.3.cmml">𝒩</mi><mo id="alg1.l23.m1.2.2.1.2" xref="alg1.l23.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l23.m1.2.2.1.1.1" xref="alg1.l23.m1.2.2.1.1.2.cmml"><mo id="alg1.l23.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l23.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">μ</mi><mo id="alg1.l23.m1.2.2.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.2.cmml">,</mo><msup id="alg1.l23.m1.2.2.1.1.1.1" xref="alg1.l23.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l23.m1.2.2.1.1.1.1.2" xref="alg1.l23.m1.2.2.1.1.1.1.2.cmml">σ</mi><mn id="alg1.l23.m1.2.2.1.1.1.1.3" xref="alg1.l23.m1.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="alg1.l23.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l23.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.2b"><apply id="alg1.l23.m1.2.2.cmml" xref="alg1.l23.m1.2.2"><csymbol cd="latexml" id="alg1.l23.m1.2.2.2.cmml" xref="alg1.l23.m1.2.2.2">similar-to</csymbol><apply id="alg1.l23.m1.2.2.3.cmml" xref="alg1.l23.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.3.1.cmml" xref="alg1.l23.m1.2.2.3">subscript</csymbol><apply id="alg1.l23.m1.2.2.3.2.cmml" xref="alg1.l23.m1.2.2.3.2"><ci id="alg1.l23.m1.2.2.3.2.1.cmml" xref="alg1.l23.m1.2.2.3.2.1">~</ci><ci id="alg1.l23.m1.2.2.3.2.2.cmml" xref="alg1.l23.m1.2.2.3.2.2">𝑠</ci></apply><apply id="alg1.l23.m1.2.2.3.3.cmml" xref="alg1.l23.m1.2.2.3.3"><plus id="alg1.l23.m1.2.2.3.3.1.cmml" xref="alg1.l23.m1.2.2.3.3.1"></plus><ci id="alg1.l23.m1.2.2.3.3.2.cmml" xref="alg1.l23.m1.2.2.3.3.2">𝜏</ci><ci id="alg1.l23.m1.2.2.3.3.3.cmml" xref="alg1.l23.m1.2.2.3.3.3">𝐻</ci></apply></apply><apply id="alg1.l23.m1.2.2.1.cmml" xref="alg1.l23.m1.2.2.1"><times id="alg1.l23.m1.2.2.1.2.cmml" xref="alg1.l23.m1.2.2.1.2"></times><ci id="alg1.l23.m1.2.2.1.3.cmml" xref="alg1.l23.m1.2.2.1.3">𝒩</ci><interval closure="open" id="alg1.l23.m1.2.2.1.1.2.cmml" xref="alg1.l23.m1.2.2.1.1.1"><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">𝜇</ci><apply id="alg1.l23.m1.2.2.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l23.m1.2.2.1.1.1.1.2">𝜎</ci><cn id="alg1.l23.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l23.m1.2.2.1.1.1.1.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.2c">\tilde{s}_{\tau+H}\sim\mathcal{N}({\mu},{\sigma}^{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.2d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT ∼ caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>Compute <math alttext="{P}_{\theta_{o}}({o}_{\tau+H}|\tilde{s}_{\tau+H})" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><mrow id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><msub id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml"><mi id="alg1.l24.m1.1.1.3.2" xref="alg1.l24.m1.1.1.3.2.cmml">P</mi><msub id="alg1.l24.m1.1.1.3.3" xref="alg1.l24.m1.1.1.3.3.cmml"><mi id="alg1.l24.m1.1.1.3.3.2" xref="alg1.l24.m1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l24.m1.1.1.3.3.3" xref="alg1.l24.m1.1.1.3.3.3.cmml">o</mi></msub></msub><mo id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l24.m1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.cmml"><mo id="alg1.l24.m1.1.1.1.1.2" stretchy="false" xref="alg1.l24.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.cmml"><msub id="alg1.l24.m1.1.1.1.1.1.2" xref="alg1.l24.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l24.m1.1.1.1.1.1.2.2" xref="alg1.l24.m1.1.1.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l24.m1.1.1.1.1.1.2.3" xref="alg1.l24.m1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l24.m1.1.1.1.1.1.2.3.2" xref="alg1.l24.m1.1.1.1.1.1.2.3.2.cmml">τ</mi><mo id="alg1.l24.m1.1.1.1.1.1.2.3.1" xref="alg1.l24.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l24.m1.1.1.1.1.1.2.3.3" xref="alg1.l24.m1.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l24.m1.1.1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l24.m1.1.1.1.1.1.3" xref="alg1.l24.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l24.m1.1.1.1.1.1.3.2" xref="alg1.l24.m1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l24.m1.1.1.1.1.1.3.2.2" xref="alg1.l24.m1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l24.m1.1.1.1.1.1.3.2.1" xref="alg1.l24.m1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l24.m1.1.1.1.1.1.3.3" xref="alg1.l24.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l24.m1.1.1.1.1.1.3.3.2" xref="alg1.l24.m1.1.1.1.1.1.3.3.2.cmml">τ</mi><mo id="alg1.l24.m1.1.1.1.1.1.3.3.1" xref="alg1.l24.m1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l24.m1.1.1.1.1.1.3.3.3" xref="alg1.l24.m1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l24.m1.1.1.1.1.3" stretchy="false" xref="alg1.l24.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><times id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2"></times><apply id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.1.cmml" xref="alg1.l24.m1.1.1.3">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.2.cmml" xref="alg1.l24.m1.1.1.3.2">𝑃</ci><apply id="alg1.l24.m1.1.1.3.3.cmml" xref="alg1.l24.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.3.1.cmml" xref="alg1.l24.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.3.2.cmml" xref="alg1.l24.m1.1.1.3.3.2">𝜃</ci><ci id="alg1.l24.m1.1.1.3.3.3.cmml" xref="alg1.l24.m1.1.1.3.3.3">𝑜</ci></apply></apply><apply id="alg1.l24.m1.1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l24.m1.1.1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l24.m1.1.1.1.1.1.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l24.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.2.2">𝑜</ci><apply id="alg1.l24.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.2.3"><plus id="alg1.l24.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.2.3.1"></plus><ci id="alg1.l24.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.2.3.2">𝜏</ci><ci id="alg1.l24.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l24.m1.1.1.1.1.1.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l24.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.2"><ci id="alg1.l24.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l24.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l24.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.3"><plus id="alg1.l24.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l24.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.3.2">𝜏</ci><ci id="alg1.l24.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">{P}_{\theta_{o}}({o}_{\tau+H}|\tilde{s}_{\tau+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span>Compute <math alttext="{Q}_{\phi_{s}}(\tilde{s}_{\tau+H})" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><msub id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml"><mi id="alg1.l25.m1.1.1.3.2" xref="alg1.l25.m1.1.1.3.2.cmml">Q</mi><msub id="alg1.l25.m1.1.1.3.3" xref="alg1.l25.m1.1.1.3.3.cmml"><mi id="alg1.l25.m1.1.1.3.3.2" xref="alg1.l25.m1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l25.m1.1.1.3.3.3" xref="alg1.l25.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l25.m1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.cmml"><mo id="alg1.l25.m1.1.1.1.1.2" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l25.m1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l25.m1.1.1.1.1.1.2" xref="alg1.l25.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.1.1.1.2.2" xref="alg1.l25.m1.1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l25.m1.1.1.1.1.1.2.1" xref="alg1.l25.m1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l25.m1.1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l25.m1.1.1.1.1.1.3.2" xref="alg1.l25.m1.1.1.1.1.1.3.2.cmml">τ</mi><mo id="alg1.l25.m1.1.1.1.1.1.3.1" xref="alg1.l25.m1.1.1.1.1.1.3.1.cmml">+</mo><mi id="alg1.l25.m1.1.1.1.1.1.3.3" xref="alg1.l25.m1.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l25.m1.1.1.1.1.3" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><times id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"></times><apply id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.3">subscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.3.2">𝑄</ci><apply id="alg1.l25.m1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.3.1.cmml" xref="alg1.l25.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l25.m1.1.1.3.3.2.cmml" xref="alg1.l25.m1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l25.m1.1.1.3.3.3.cmml" xref="alg1.l25.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l25.m1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l25.m1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.2"><ci id="alg1.l25.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l25.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.2.2">𝑠</ci></apply><apply id="alg1.l25.m1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.3"><plus id="alg1.l25.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l25.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.3.2">𝜏</ci><ci id="alg1.l25.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">{Q}_{\phi_{s}}(\tilde{s}_{\tau+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\tilde{o}_{\tau+H}" class="ltx_Math" display="inline" id="alg1.l25.m2.1"><semantics id="alg1.l25.m2.1a"><msub id="alg1.l25.m2.1.1" xref="alg1.l25.m2.1.1.cmml"><mover accent="true" id="alg1.l25.m2.1.1.2" xref="alg1.l25.m2.1.1.2.cmml"><mi id="alg1.l25.m2.1.1.2.2" xref="alg1.l25.m2.1.1.2.2.cmml">o</mi><mo id="alg1.l25.m2.1.1.2.1" xref="alg1.l25.m2.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l25.m2.1.1.3" xref="alg1.l25.m2.1.1.3.cmml"><mi id="alg1.l25.m2.1.1.3.2" xref="alg1.l25.m2.1.1.3.2.cmml">τ</mi><mo id="alg1.l25.m2.1.1.3.1" xref="alg1.l25.m2.1.1.3.1.cmml">+</mo><mi id="alg1.l25.m2.1.1.3.3" xref="alg1.l25.m2.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l25.m2.1b"><apply id="alg1.l25.m2.1.1.cmml" xref="alg1.l25.m2.1.1"><csymbol cd="ambiguous" id="alg1.l25.m2.1.1.1.cmml" xref="alg1.l25.m2.1.1">subscript</csymbol><apply id="alg1.l25.m2.1.1.2.cmml" xref="alg1.l25.m2.1.1.2"><ci id="alg1.l25.m2.1.1.2.1.cmml" xref="alg1.l25.m2.1.1.2.1">~</ci><ci id="alg1.l25.m2.1.1.2.2.cmml" xref="alg1.l25.m2.1.1.2.2">𝑜</ci></apply><apply id="alg1.l25.m2.1.1.3.cmml" xref="alg1.l25.m2.1.1.3"><plus id="alg1.l25.m2.1.1.3.1.cmml" xref="alg1.l25.m2.1.1.3.1"></plus><ci id="alg1.l25.m2.1.1.3.2.cmml" xref="alg1.l25.m2.1.1.3.2">𝜏</ci><ci id="alg1.l25.m2.1.1.3.3.cmml" xref="alg1.l25.m2.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m2.1c">\tilde{o}_{\tau+H}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m2.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l26.1.1.1" style="font-size:80%;">26:</span></span>Compute <math alttext="{\mu}^{\prime},{\sigma}^{\prime}\leftarrow{Q}_{\phi_{s}}(\tilde{s}_{\tau+H})" class="ltx_Math" display="inline" id="alg1.l26.m1.3"><semantics id="alg1.l26.m1.3a"><mrow id="alg1.l26.m1.3.3" xref="alg1.l26.m1.3.3.cmml"><mrow id="alg1.l26.m1.2.2.2.2" xref="alg1.l26.m1.2.2.2.3.cmml"><msup id="alg1.l26.m1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.cmml"><mi id="alg1.l26.m1.1.1.1.1.1.2" xref="alg1.l26.m1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l26.m1.1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l26.m1.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l26.m1.2.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.2.cmml"><mi id="alg1.l26.m1.2.2.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l26.m1.2.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.2.2.3.cmml">′</mo></msup></mrow><mo id="alg1.l26.m1.3.3.4" stretchy="false" xref="alg1.l26.m1.3.3.4.cmml">←</mo><mrow id="alg1.l26.m1.3.3.3" xref="alg1.l26.m1.3.3.3.cmml"><msub id="alg1.l26.m1.3.3.3.3" xref="alg1.l26.m1.3.3.3.3.cmml"><mi id="alg1.l26.m1.3.3.3.3.2" xref="alg1.l26.m1.3.3.3.3.2.cmml">Q</mi><msub id="alg1.l26.m1.3.3.3.3.3" xref="alg1.l26.m1.3.3.3.3.3.cmml"><mi id="alg1.l26.m1.3.3.3.3.3.2" xref="alg1.l26.m1.3.3.3.3.3.2.cmml">ϕ</mi><mi id="alg1.l26.m1.3.3.3.3.3.3" xref="alg1.l26.m1.3.3.3.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l26.m1.3.3.3.2" xref="alg1.l26.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l26.m1.3.3.3.1.1" xref="alg1.l26.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l26.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l26.m1.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l26.m1.3.3.3.1.1.1" xref="alg1.l26.m1.3.3.3.1.1.1.cmml"><mover accent="true" id="alg1.l26.m1.3.3.3.1.1.1.2" xref="alg1.l26.m1.3.3.3.1.1.1.2.cmml"><mi id="alg1.l26.m1.3.3.3.1.1.1.2.2" xref="alg1.l26.m1.3.3.3.1.1.1.2.2.cmml">s</mi><mo id="alg1.l26.m1.3.3.3.1.1.1.2.1" xref="alg1.l26.m1.3.3.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l26.m1.3.3.3.1.1.1.3" xref="alg1.l26.m1.3.3.3.1.1.1.3.cmml"><mi id="alg1.l26.m1.3.3.3.1.1.1.3.2" xref="alg1.l26.m1.3.3.3.1.1.1.3.2.cmml">τ</mi><mo id="alg1.l26.m1.3.3.3.1.1.1.3.1" xref="alg1.l26.m1.3.3.3.1.1.1.3.1.cmml">+</mo><mi id="alg1.l26.m1.3.3.3.1.1.1.3.3" xref="alg1.l26.m1.3.3.3.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l26.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l26.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.3b"><apply id="alg1.l26.m1.3.3.cmml" xref="alg1.l26.m1.3.3"><ci id="alg1.l26.m1.3.3.4.cmml" xref="alg1.l26.m1.3.3.4">←</ci><list id="alg1.l26.m1.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2"><apply id="alg1.l26.m1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l26.m1.1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l26.m1.1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l26.m1.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.2.2.2.1.cmml" xref="alg1.l26.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l26.m1.2.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l26.m1.2.2.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2.2.3">′</ci></apply></list><apply id="alg1.l26.m1.3.3.3.cmml" xref="alg1.l26.m1.3.3.3"><times id="alg1.l26.m1.3.3.3.2.cmml" xref="alg1.l26.m1.3.3.3.2"></times><apply id="alg1.l26.m1.3.3.3.3.cmml" xref="alg1.l26.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l26.m1.3.3.3.3.1.cmml" xref="alg1.l26.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l26.m1.3.3.3.3.2.cmml" xref="alg1.l26.m1.3.3.3.3.2">𝑄</ci><apply id="alg1.l26.m1.3.3.3.3.3.cmml" xref="alg1.l26.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l26.m1.3.3.3.3.3.1.cmml" xref="alg1.l26.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l26.m1.3.3.3.3.3.2.cmml" xref="alg1.l26.m1.3.3.3.3.3.2">italic-ϕ</ci><ci id="alg1.l26.m1.3.3.3.3.3.3.cmml" xref="alg1.l26.m1.3.3.3.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l26.m1.3.3.3.1.1.1.cmml" xref="alg1.l26.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l26.m1.3.3.3.1.1">subscript</csymbol><apply id="alg1.l26.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.2"><ci id="alg1.l26.m1.3.3.3.1.1.1.2.1.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.2.1">~</ci><ci id="alg1.l26.m1.3.3.3.1.1.1.2.2.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.2.2">𝑠</ci></apply><apply id="alg1.l26.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.3"><plus id="alg1.l26.m1.3.3.3.1.1.1.3.1.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.3.1"></plus><ci id="alg1.l26.m1.3.3.3.1.1.1.3.2.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.3.2">𝜏</ci><ci id="alg1.l26.m1.3.3.3.1.1.1.3.3.cmml" xref="alg1.l26.m1.3.3.3.1.1.1.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.3c">{\mu}^{\prime},{\sigma}^{\prime}\leftarrow{Q}_{\phi_{s}}(\tilde{s}_{\tau+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.3d">italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">27:</span></span><math alttext="G\leftarrow G-\log\,\Psi\,[{P}_{\theta_{o}}({o}_{\tau+H}|\tilde{s}_{\tau+H})]" class="ltx_Math" display="inline" id="alg1.l27.m1.1"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml">G</mi><mo id="alg1.l27.m1.1.1.2" stretchy="false" xref="alg1.l27.m1.1.1.2.cmml">←</mo><mrow id="alg1.l27.m1.1.1.1" xref="alg1.l27.m1.1.1.1.cmml"><mi id="alg1.l27.m1.1.1.1.3" xref="alg1.l27.m1.1.1.1.3.cmml">G</mi><mo id="alg1.l27.m1.1.1.1.2" xref="alg1.l27.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l27.m1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.cmml"><mrow id="alg1.l27.m1.1.1.1.1.3" xref="alg1.l27.m1.1.1.1.1.3.cmml"><mi id="alg1.l27.m1.1.1.1.1.3.1" xref="alg1.l27.m1.1.1.1.1.3.1.cmml">log</mi><mo id="alg1.l27.m1.1.1.1.1.3a" lspace="0.337em" xref="alg1.l27.m1.1.1.1.1.3.cmml">⁡</mo><mi id="alg1.l27.m1.1.1.1.1.3.2" mathvariant="normal" xref="alg1.l27.m1.1.1.1.1.3.2.cmml">Ψ</mi></mrow><mo id="alg1.l27.m1.1.1.1.1.2" lspace="0.170em" xref="alg1.l27.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l27.m1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l27.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l27.m1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l27.m1.1.1.1.1.1.1.1.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.2.cmml">P</mi><msub id="alg1.l27.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3.3.cmml">o</mi></msub></msub><mo id="alg1.l27.m1.1.1.1.1.1.1.1.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l27.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">τ</mi><mo id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">τ</mi><mo id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l27.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">←</ci><ci id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">𝐺</ci><apply id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1"><minus id="alg1.l27.m1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.2"></minus><ci id="alg1.l27.m1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.3">𝐺</ci><apply id="alg1.l27.m1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1"><times id="alg1.l27.m1.1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.1.2"></times><apply id="alg1.l27.m1.1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.1.3"><log id="alg1.l27.m1.1.1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.3.1"></log><ci id="alg1.l27.m1.1.1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.3.2">Ψ</ci></apply><apply id="alg1.l27.m1.1.1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l27.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l27.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1"><times id="alg1.l27.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l27.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l27.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.2">𝑃</ci><apply id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3.2">𝜃</ci><ci id="alg1.l27.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.3.3">𝑜</ci></apply></apply><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑜</ci><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3"><plus id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝜏</ci><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3"><plus id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝜏</ci><ci id="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">G\leftarrow G-\log\,\Psi\,[{P}_{\theta_{o}}({o}_{\tau+H}|\tilde{s}_{\tau+H})]</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m1.1d">italic_G ← italic_G - roman_log roman_Ψ [ italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">28:</span></span><math alttext="G\leftarrow G+[H({\mu}^{\prime},{\sigma}^{\prime})-H(\mu,\sigma)]" class="ltx_Math" display="inline" id="alg1.l28.m1.3"><semantics id="alg1.l28.m1.3a"><mrow id="alg1.l28.m1.3.3" xref="alg1.l28.m1.3.3.cmml"><mi id="alg1.l28.m1.3.3.3" xref="alg1.l28.m1.3.3.3.cmml">G</mi><mo id="alg1.l28.m1.3.3.2" stretchy="false" xref="alg1.l28.m1.3.3.2.cmml">←</mo><mrow id="alg1.l28.m1.3.3.1" xref="alg1.l28.m1.3.3.1.cmml"><mi id="alg1.l28.m1.3.3.1.3" xref="alg1.l28.m1.3.3.1.3.cmml">G</mi><mo id="alg1.l28.m1.3.3.1.2" xref="alg1.l28.m1.3.3.1.2.cmml">+</mo><mrow id="alg1.l28.m1.3.3.1.1.1" xref="alg1.l28.m1.3.3.1.1.2.cmml"><mo id="alg1.l28.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l28.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="alg1.l28.m1.3.3.1.1.1.1" xref="alg1.l28.m1.3.3.1.1.1.1.cmml"><mrow id="alg1.l28.m1.3.3.1.1.1.1.2" xref="alg1.l28.m1.3.3.1.1.1.1.2.cmml"><mi id="alg1.l28.m1.3.3.1.1.1.1.2.4" xref="alg1.l28.m1.3.3.1.1.1.1.2.4.cmml">H</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.2.3" xref="alg1.l28.m1.3.3.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg1.l28.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.3.cmml"><mo id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.3" stretchy="false" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.2" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.3" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.4" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.3.cmml">,</mo><msup id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.2" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.3" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">′</mo></msup><mo id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.5" stretchy="false" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l28.m1.3.3.1.1.1.1.3" xref="alg1.l28.m1.3.3.1.1.1.1.3.cmml">−</mo><mrow id="alg1.l28.m1.3.3.1.1.1.1.4" xref="alg1.l28.m1.3.3.1.1.1.1.4.cmml"><mi id="alg1.l28.m1.3.3.1.1.1.1.4.2" xref="alg1.l28.m1.3.3.1.1.1.1.4.2.cmml">H</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.4.1" xref="alg1.l28.m1.3.3.1.1.1.1.4.1.cmml">⁢</mo><mrow id="alg1.l28.m1.3.3.1.1.1.1.4.3.2" xref="alg1.l28.m1.3.3.1.1.1.1.4.3.1.cmml"><mo id="alg1.l28.m1.3.3.1.1.1.1.4.3.2.1" stretchy="false" xref="alg1.l28.m1.3.3.1.1.1.1.4.3.1.cmml">(</mo><mi id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">μ</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.4.3.2.2" xref="alg1.l28.m1.3.3.1.1.1.1.4.3.1.cmml">,</mo><mi id="alg1.l28.m1.2.2" xref="alg1.l28.m1.2.2.cmml">σ</mi><mo id="alg1.l28.m1.3.3.1.1.1.1.4.3.2.3" stretchy="false" xref="alg1.l28.m1.3.3.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l28.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.l28.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.3b"><apply id="alg1.l28.m1.3.3.cmml" xref="alg1.l28.m1.3.3"><ci id="alg1.l28.m1.3.3.2.cmml" xref="alg1.l28.m1.3.3.2">←</ci><ci id="alg1.l28.m1.3.3.3.cmml" xref="alg1.l28.m1.3.3.3">𝐺</ci><apply id="alg1.l28.m1.3.3.1.cmml" xref="alg1.l28.m1.3.3.1"><plus id="alg1.l28.m1.3.3.1.2.cmml" xref="alg1.l28.m1.3.3.1.2"></plus><ci id="alg1.l28.m1.3.3.1.3.cmml" xref="alg1.l28.m1.3.3.1.3">𝐺</ci><apply id="alg1.l28.m1.3.3.1.1.2.cmml" xref="alg1.l28.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg1.l28.m1.3.3.1.1.2.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l28.m1.3.3.1.1.1.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1"><minus id="alg1.l28.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.3"></minus><apply id="alg1.l28.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2"><times id="alg1.l28.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.3"></times><ci id="alg1.l28.m1.3.3.1.1.1.1.2.4.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.4">𝐻</ci><interval closure="open" id="alg1.l28.m1.3.3.1.1.1.1.2.2.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2"><apply id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.2.2.2.2.3">′</ci></apply></interval></apply><apply id="alg1.l28.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.4"><times id="alg1.l28.m1.3.3.1.1.1.1.4.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.4.1"></times><ci id="alg1.l28.m1.3.3.1.1.1.1.4.2.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.4.2">𝐻</ci><interval closure="open" id="alg1.l28.m1.3.3.1.1.1.1.4.3.1.cmml" xref="alg1.l28.m1.3.3.1.1.1.1.4.3.2"><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">𝜇</ci><ci id="alg1.l28.m1.2.2.cmml" xref="alg1.l28.m1.2.2">𝜎</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.3c">G\leftarrow G+[H({\mu}^{\prime},{\sigma}^{\prime})-H(\mu,\sigma)]</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m1.3d">italic_G ← italic_G + [ italic_H ( italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) - italic_H ( italic_μ , italic_σ ) ]</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l28.2">\For</span><math alttext="s=1,2,...,S_{2}" class="ltx_Math" display="inline" id="alg1.l28.m2.4"><semantics id="alg1.l28.m2.4a"><mrow id="alg1.l28.m2.4.4" xref="alg1.l28.m2.4.4.cmml"><mi id="alg1.l28.m2.4.4.3" xref="alg1.l28.m2.4.4.3.cmml">s</mi><mo id="alg1.l28.m2.4.4.2" xref="alg1.l28.m2.4.4.2.cmml">=</mo><mrow id="alg1.l28.m2.4.4.1.1" xref="alg1.l28.m2.4.4.1.2.cmml"><mn id="alg1.l28.m2.1.1" xref="alg1.l28.m2.1.1.cmml">1</mn><mo id="alg1.l28.m2.4.4.1.1.2" xref="alg1.l28.m2.4.4.1.2.cmml">,</mo><mn id="alg1.l28.m2.2.2" xref="alg1.l28.m2.2.2.cmml">2</mn><mo id="alg1.l28.m2.4.4.1.1.3" xref="alg1.l28.m2.4.4.1.2.cmml">,</mo><mi id="alg1.l28.m2.3.3" mathvariant="normal" xref="alg1.l28.m2.3.3.cmml">…</mi><mo id="alg1.l28.m2.4.4.1.1.4" xref="alg1.l28.m2.4.4.1.2.cmml">,</mo><msub id="alg1.l28.m2.4.4.1.1.1" xref="alg1.l28.m2.4.4.1.1.1.cmml"><mi id="alg1.l28.m2.4.4.1.1.1.2" xref="alg1.l28.m2.4.4.1.1.1.2.cmml">S</mi><mn id="alg1.l28.m2.4.4.1.1.1.3" xref="alg1.l28.m2.4.4.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m2.4b"><apply id="alg1.l28.m2.4.4.cmml" xref="alg1.l28.m2.4.4"><eq id="alg1.l28.m2.4.4.2.cmml" xref="alg1.l28.m2.4.4.2"></eq><ci id="alg1.l28.m2.4.4.3.cmml" xref="alg1.l28.m2.4.4.3">𝑠</ci><list id="alg1.l28.m2.4.4.1.2.cmml" xref="alg1.l28.m2.4.4.1.1"><cn id="alg1.l28.m2.1.1.cmml" type="integer" xref="alg1.l28.m2.1.1">1</cn><cn id="alg1.l28.m2.2.2.cmml" type="integer" xref="alg1.l28.m2.2.2">2</cn><ci id="alg1.l28.m2.3.3.cmml" xref="alg1.l28.m2.3.3">…</ci><apply id="alg1.l28.m2.4.4.1.1.1.cmml" xref="alg1.l28.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m2.4.4.1.1.1.1.cmml" xref="alg1.l28.m2.4.4.1.1.1">subscript</csymbol><ci id="alg1.l28.m2.4.4.1.1.1.2.cmml" xref="alg1.l28.m2.4.4.1.1.1.2">𝑆</ci><cn id="alg1.l28.m2.4.4.1.1.1.3.cmml" type="integer" xref="alg1.l28.m2.4.4.1.1.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m2.4c">s=1,2,...,S_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m2.4d">italic_s = 1 , 2 , … , italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l29.2.1.1" style="font-size:80%;">29:</span></span>Sample <math alttext="\tilde{s}_{\tau+H}\sim{P}_{\theta_{s}}({s}_{\tau+H}|\tilde{s}_{\tau},\hat{\pi}%
_{\tau})" class="ltx_Math" display="inline" id="alg1.l29.m1.1"><semantics id="alg1.l29.m1.1a"><mrow id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml"><msub id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml"><mover accent="true" id="alg1.l29.m1.1.1.3.2" xref="alg1.l29.m1.1.1.3.2.cmml"><mi id="alg1.l29.m1.1.1.3.2.2" xref="alg1.l29.m1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l29.m1.1.1.3.2.1" xref="alg1.l29.m1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l29.m1.1.1.3.3" xref="alg1.l29.m1.1.1.3.3.cmml"><mi id="alg1.l29.m1.1.1.3.3.2" xref="alg1.l29.m1.1.1.3.3.2.cmml">τ</mi><mo id="alg1.l29.m1.1.1.3.3.1" xref="alg1.l29.m1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l29.m1.1.1.3.3.3" xref="alg1.l29.m1.1.1.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l29.m1.1.1.1" xref="alg1.l29.m1.1.1.1.cmml"><msub id="alg1.l29.m1.1.1.1.3" xref="alg1.l29.m1.1.1.1.3.cmml"><mi id="alg1.l29.m1.1.1.1.3.2" xref="alg1.l29.m1.1.1.1.3.2.cmml">P</mi><msub id="alg1.l29.m1.1.1.1.3.3" xref="alg1.l29.m1.1.1.1.3.3.cmml"><mi id="alg1.l29.m1.1.1.1.3.3.2" xref="alg1.l29.m1.1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l29.m1.1.1.1.3.3.3" xref="alg1.l29.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l29.m1.1.1.1.2" xref="alg1.l29.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l29.m1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l29.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l29.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l29.m1.1.1.1.1.1.1.4" xref="alg1.l29.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.4.2" xref="alg1.l29.m1.1.1.1.1.1.1.4.2.cmml">s</mi><mrow id="alg1.l29.m1.1.1.1.1.1.1.4.3" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.2.cmml">τ</mi><mo id="alg1.l29.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.1.cmml">+</mo><mi id="alg1.l29.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l29.m1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l29.m1.1.1.1.1.1.1.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l29.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.1" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="alg1.l29.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l29.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l29.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">π</mi><mo id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.1" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.3.cmml">τ</mi></msub></mrow></mrow><mo id="alg1.l29.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l29.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b"><apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1"><csymbol cd="latexml" id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2">similar-to</csymbol><apply id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.3">subscript</csymbol><apply id="alg1.l29.m1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.3.2"><ci id="alg1.l29.m1.1.1.3.2.1.cmml" xref="alg1.l29.m1.1.1.3.2.1">~</ci><ci id="alg1.l29.m1.1.1.3.2.2.cmml" xref="alg1.l29.m1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l29.m1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.3.3"><plus id="alg1.l29.m1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.3.3.1"></plus><ci id="alg1.l29.m1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.3.3.2">𝜏</ci><ci id="alg1.l29.m1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.3.3.3">𝐻</ci></apply></apply><apply id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1"><times id="alg1.l29.m1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.2"></times><apply id="alg1.l29.m1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.1.3.2">𝑃</ci><apply id="alg1.l29.m1.1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.1.3.3.2">𝜃</ci><ci id="alg1.l29.m1.1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l29.m1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l29.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l29.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4.2">𝑠</ci><apply id="alg1.l29.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4.3"><plus id="alg1.l29.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.1"></plus><ci id="alg1.l29.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.2">𝜏</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.4.3.3">𝐻</ci></apply></apply><list id="alg1.l29.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2"><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2"><ci id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.2.2">𝜋</ci></apply><ci id="alg1.l29.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.1.1.2.2.2.3">𝜏</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.1c">\tilde{s}_{\tau+H}\sim{P}_{\theta_{s}}({s}_{\tau+H}|\tilde{s}_{\tau},\hat{\pi}%
_{\tau})</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.m1.1d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT ∼ italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l29.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l29.1.m1.1"><semantics id="alg1.l29.1.m1.1a"><mo id="alg1.l29.1.m1.1.1" xref="alg1.l29.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l29.1.m1.1b"><ci id="alg1.l29.1.m1.1.1.cmml" xref="alg1.l29.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.1.m1.1d">▷</annotation></semantics></math> Recomputed with dropout.
</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l30.1.1.1" style="font-size:80%;">30:</span></span>Compute <math alttext="\mu^{\prime\prime},\ \sigma^{\prime\prime}\leftarrow{P}_{\theta_{o}}({o}_{\tau%
+H}|\tilde{s}_{\tau+H})" class="ltx_Math" display="inline" id="alg1.l30.m1.3"><semantics id="alg1.l30.m1.3a"><mrow id="alg1.l30.m1.3.3" xref="alg1.l30.m1.3.3.cmml"><mrow id="alg1.l30.m1.2.2.2.2" xref="alg1.l30.m1.2.2.2.3.cmml"><msup id="alg1.l30.m1.1.1.1.1.1" xref="alg1.l30.m1.1.1.1.1.1.cmml"><mi id="alg1.l30.m1.1.1.1.1.1.2" xref="alg1.l30.m1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l30.m1.1.1.1.1.1.3" xref="alg1.l30.m1.1.1.1.1.1.3.cmml">′′</mo></msup><mo id="alg1.l30.m1.2.2.2.2.3" rspace="0.667em" xref="alg1.l30.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l30.m1.2.2.2.2.2" xref="alg1.l30.m1.2.2.2.2.2.cmml"><mi id="alg1.l30.m1.2.2.2.2.2.2" xref="alg1.l30.m1.2.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l30.m1.2.2.2.2.2.3" xref="alg1.l30.m1.2.2.2.2.2.3.cmml">′′</mo></msup></mrow><mo id="alg1.l30.m1.3.3.4" stretchy="false" xref="alg1.l30.m1.3.3.4.cmml">←</mo><mrow id="alg1.l30.m1.3.3.3" xref="alg1.l30.m1.3.3.3.cmml"><msub id="alg1.l30.m1.3.3.3.3" xref="alg1.l30.m1.3.3.3.3.cmml"><mi id="alg1.l30.m1.3.3.3.3.2" xref="alg1.l30.m1.3.3.3.3.2.cmml">P</mi><msub id="alg1.l30.m1.3.3.3.3.3" xref="alg1.l30.m1.3.3.3.3.3.cmml"><mi id="alg1.l30.m1.3.3.3.3.3.2" xref="alg1.l30.m1.3.3.3.3.3.2.cmml">θ</mi><mi id="alg1.l30.m1.3.3.3.3.3.3" xref="alg1.l30.m1.3.3.3.3.3.3.cmml">o</mi></msub></msub><mo id="alg1.l30.m1.3.3.3.2" xref="alg1.l30.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l30.m1.3.3.3.1.1" xref="alg1.l30.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l30.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l30.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l30.m1.3.3.3.1.1.1" xref="alg1.l30.m1.3.3.3.1.1.1.cmml"><msub id="alg1.l30.m1.3.3.3.1.1.1.2" xref="alg1.l30.m1.3.3.3.1.1.1.2.cmml"><mi id="alg1.l30.m1.3.3.3.1.1.1.2.2" xref="alg1.l30.m1.3.3.3.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l30.m1.3.3.3.1.1.1.2.3" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.cmml"><mi id="alg1.l30.m1.3.3.3.1.1.1.2.3.2" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.2.cmml">τ</mi><mo id="alg1.l30.m1.3.3.3.1.1.1.2.3.1" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l30.m1.3.3.3.1.1.1.2.3.3" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l30.m1.3.3.3.1.1.1.1" xref="alg1.l30.m1.3.3.3.1.1.1.1.cmml">|</mo><msub id="alg1.l30.m1.3.3.3.1.1.1.3" xref="alg1.l30.m1.3.3.3.1.1.1.3.cmml"><mover accent="true" id="alg1.l30.m1.3.3.3.1.1.1.3.2" xref="alg1.l30.m1.3.3.3.1.1.1.3.2.cmml"><mi id="alg1.l30.m1.3.3.3.1.1.1.3.2.2" xref="alg1.l30.m1.3.3.3.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l30.m1.3.3.3.1.1.1.3.2.1" xref="alg1.l30.m1.3.3.3.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l30.m1.3.3.3.1.1.1.3.3" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.cmml"><mi id="alg1.l30.m1.3.3.3.1.1.1.3.3.2" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.2.cmml">τ</mi><mo id="alg1.l30.m1.3.3.3.1.1.1.3.3.1" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l30.m1.3.3.3.1.1.1.3.3.3" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l30.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l30.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.3b"><apply id="alg1.l30.m1.3.3.cmml" xref="alg1.l30.m1.3.3"><ci id="alg1.l30.m1.3.3.4.cmml" xref="alg1.l30.m1.3.3.4">←</ci><list id="alg1.l30.m1.2.2.2.3.cmml" xref="alg1.l30.m1.2.2.2.2"><apply id="alg1.l30.m1.1.1.1.1.1.cmml" xref="alg1.l30.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l30.m1.1.1.1.1.1.1.cmml" xref="alg1.l30.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l30.m1.1.1.1.1.1.2.cmml" xref="alg1.l30.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l30.m1.1.1.1.1.1.3.cmml" xref="alg1.l30.m1.1.1.1.1.1.3">′′</ci></apply><apply id="alg1.l30.m1.2.2.2.2.2.cmml" xref="alg1.l30.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l30.m1.2.2.2.2.2.1.cmml" xref="alg1.l30.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l30.m1.2.2.2.2.2.2.cmml" xref="alg1.l30.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l30.m1.2.2.2.2.2.3.cmml" xref="alg1.l30.m1.2.2.2.2.2.3">′′</ci></apply></list><apply id="alg1.l30.m1.3.3.3.cmml" xref="alg1.l30.m1.3.3.3"><times id="alg1.l30.m1.3.3.3.2.cmml" xref="alg1.l30.m1.3.3.3.2"></times><apply id="alg1.l30.m1.3.3.3.3.cmml" xref="alg1.l30.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l30.m1.3.3.3.3.1.cmml" xref="alg1.l30.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l30.m1.3.3.3.3.2.cmml" xref="alg1.l30.m1.3.3.3.3.2">𝑃</ci><apply id="alg1.l30.m1.3.3.3.3.3.cmml" xref="alg1.l30.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l30.m1.3.3.3.3.3.1.cmml" xref="alg1.l30.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l30.m1.3.3.3.3.3.2.cmml" xref="alg1.l30.m1.3.3.3.3.3.2">𝜃</ci><ci id="alg1.l30.m1.3.3.3.3.3.3.cmml" xref="alg1.l30.m1.3.3.3.3.3.3">𝑜</ci></apply></apply><apply id="alg1.l30.m1.3.3.3.1.1.1.cmml" xref="alg1.l30.m1.3.3.3.1.1"><csymbol cd="latexml" id="alg1.l30.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.1">conditional</csymbol><apply id="alg1.l30.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l30.m1.3.3.3.1.1.1.2.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="alg1.l30.m1.3.3.3.1.1.1.2.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2.2">𝑜</ci><apply id="alg1.l30.m1.3.3.3.1.1.1.2.3.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2.3"><plus id="alg1.l30.m1.3.3.3.1.1.1.2.3.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.1"></plus><ci id="alg1.l30.m1.3.3.3.1.1.1.2.3.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.2">𝜏</ci><ci id="alg1.l30.m1.3.3.3.1.1.1.2.3.3.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l30.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l30.m1.3.3.3.1.1.1.3.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3">subscript</csymbol><apply id="alg1.l30.m1.3.3.3.1.1.1.3.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.2"><ci id="alg1.l30.m1.3.3.3.1.1.1.3.2.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.2.1">~</ci><ci id="alg1.l30.m1.3.3.3.1.1.1.3.2.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l30.m1.3.3.3.1.1.1.3.3.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.3"><plus id="alg1.l30.m1.3.3.3.1.1.1.3.3.1.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.1"></plus><ci id="alg1.l30.m1.3.3.3.1.1.1.3.3.2.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.2">𝜏</ci><ci id="alg1.l30.m1.3.3.3.1.1.1.3.3.3.cmml" xref="alg1.l30.m1.3.3.3.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.3c">\mu^{\prime\prime},\ \sigma^{\prime\prime}\leftarrow{P}_{\theta_{o}}({o}_{\tau%
+H}|\tilde{s}_{\tau+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l30.m1.3d">italic_μ start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ← italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l31.1.1.1" style="font-size:80%;">31:</span></span>Sample <math alttext="\tilde{s}_{\tau+H}\sim\mathcal{N}(\mu,\sigma^{2})" class="ltx_Math" display="inline" id="alg1.l31.m1.2"><semantics id="alg1.l31.m1.2a"><mrow id="alg1.l31.m1.2.2" xref="alg1.l31.m1.2.2.cmml"><msub id="alg1.l31.m1.2.2.3" xref="alg1.l31.m1.2.2.3.cmml"><mover accent="true" id="alg1.l31.m1.2.2.3.2" xref="alg1.l31.m1.2.2.3.2.cmml"><mi id="alg1.l31.m1.2.2.3.2.2" xref="alg1.l31.m1.2.2.3.2.2.cmml">s</mi><mo id="alg1.l31.m1.2.2.3.2.1" xref="alg1.l31.m1.2.2.3.2.1.cmml">~</mo></mover><mrow id="alg1.l31.m1.2.2.3.3" xref="alg1.l31.m1.2.2.3.3.cmml"><mi id="alg1.l31.m1.2.2.3.3.2" xref="alg1.l31.m1.2.2.3.3.2.cmml">τ</mi><mo id="alg1.l31.m1.2.2.3.3.1" xref="alg1.l31.m1.2.2.3.3.1.cmml">+</mo><mi id="alg1.l31.m1.2.2.3.3.3" xref="alg1.l31.m1.2.2.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l31.m1.2.2.2" xref="alg1.l31.m1.2.2.2.cmml">∼</mo><mrow id="alg1.l31.m1.2.2.1" xref="alg1.l31.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l31.m1.2.2.1.3" xref="alg1.l31.m1.2.2.1.3.cmml">𝒩</mi><mo id="alg1.l31.m1.2.2.1.2" xref="alg1.l31.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l31.m1.2.2.1.1.1" xref="alg1.l31.m1.2.2.1.1.2.cmml"><mo id="alg1.l31.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l31.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml">μ</mi><mo id="alg1.l31.m1.2.2.1.1.1.3" xref="alg1.l31.m1.2.2.1.1.2.cmml">,</mo><msup id="alg1.l31.m1.2.2.1.1.1.1" xref="alg1.l31.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l31.m1.2.2.1.1.1.1.2" xref="alg1.l31.m1.2.2.1.1.1.1.2.cmml">σ</mi><mn id="alg1.l31.m1.2.2.1.1.1.1.3" xref="alg1.l31.m1.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="alg1.l31.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l31.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.2b"><apply id="alg1.l31.m1.2.2.cmml" xref="alg1.l31.m1.2.2"><csymbol cd="latexml" id="alg1.l31.m1.2.2.2.cmml" xref="alg1.l31.m1.2.2.2">similar-to</csymbol><apply id="alg1.l31.m1.2.2.3.cmml" xref="alg1.l31.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l31.m1.2.2.3.1.cmml" xref="alg1.l31.m1.2.2.3">subscript</csymbol><apply id="alg1.l31.m1.2.2.3.2.cmml" xref="alg1.l31.m1.2.2.3.2"><ci id="alg1.l31.m1.2.2.3.2.1.cmml" xref="alg1.l31.m1.2.2.3.2.1">~</ci><ci id="alg1.l31.m1.2.2.3.2.2.cmml" xref="alg1.l31.m1.2.2.3.2.2">𝑠</ci></apply><apply id="alg1.l31.m1.2.2.3.3.cmml" xref="alg1.l31.m1.2.2.3.3"><plus id="alg1.l31.m1.2.2.3.3.1.cmml" xref="alg1.l31.m1.2.2.3.3.1"></plus><ci id="alg1.l31.m1.2.2.3.3.2.cmml" xref="alg1.l31.m1.2.2.3.3.2">𝜏</ci><ci id="alg1.l31.m1.2.2.3.3.3.cmml" xref="alg1.l31.m1.2.2.3.3.3">𝐻</ci></apply></apply><apply id="alg1.l31.m1.2.2.1.cmml" xref="alg1.l31.m1.2.2.1"><times id="alg1.l31.m1.2.2.1.2.cmml" xref="alg1.l31.m1.2.2.1.2"></times><ci id="alg1.l31.m1.2.2.1.3.cmml" xref="alg1.l31.m1.2.2.1.3">𝒩</ci><interval closure="open" id="alg1.l31.m1.2.2.1.1.2.cmml" xref="alg1.l31.m1.2.2.1.1.1"><ci id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1">𝜇</ci><apply id="alg1.l31.m1.2.2.1.1.1.1.cmml" xref="alg1.l31.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l31.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l31.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l31.m1.2.2.1.1.1.1.2">𝜎</ci><cn id="alg1.l31.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l31.m1.2.2.1.1.1.1.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.2c">\tilde{s}_{\tau+H}\sim\mathcal{N}(\mu,\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m1.2d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT ∼ caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l32.1.1.1" style="font-size:80%;">32:</span></span>Compute <math alttext="\mu^{\prime\prime\prime},\ \sigma^{\prime\prime\prime}\leftarrow{P}_{\theta_{o%
}}({o}_{\tau+H}|\tilde{s}_{\tau+H})" class="ltx_Math" display="inline" id="alg1.l32.m1.3"><semantics id="alg1.l32.m1.3a"><mrow id="alg1.l32.m1.3.3" xref="alg1.l32.m1.3.3.cmml"><mrow id="alg1.l32.m1.2.2.2.2" xref="alg1.l32.m1.2.2.2.3.cmml"><msup id="alg1.l32.m1.1.1.1.1.1" xref="alg1.l32.m1.1.1.1.1.1.cmml"><mi id="alg1.l32.m1.1.1.1.1.1.2" xref="alg1.l32.m1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l32.m1.1.1.1.1.1.3" xref="alg1.l32.m1.1.1.1.1.1.3.cmml">′′′</mo></msup><mo id="alg1.l32.m1.2.2.2.2.3" rspace="0.667em" xref="alg1.l32.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l32.m1.2.2.2.2.2" xref="alg1.l32.m1.2.2.2.2.2.cmml"><mi id="alg1.l32.m1.2.2.2.2.2.2" xref="alg1.l32.m1.2.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l32.m1.2.2.2.2.2.3" xref="alg1.l32.m1.2.2.2.2.2.3.cmml">′′′</mo></msup></mrow><mo id="alg1.l32.m1.3.3.4" stretchy="false" xref="alg1.l32.m1.3.3.4.cmml">←</mo><mrow id="alg1.l32.m1.3.3.3" xref="alg1.l32.m1.3.3.3.cmml"><msub id="alg1.l32.m1.3.3.3.3" xref="alg1.l32.m1.3.3.3.3.cmml"><mi id="alg1.l32.m1.3.3.3.3.2" xref="alg1.l32.m1.3.3.3.3.2.cmml">P</mi><msub id="alg1.l32.m1.3.3.3.3.3" xref="alg1.l32.m1.3.3.3.3.3.cmml"><mi id="alg1.l32.m1.3.3.3.3.3.2" xref="alg1.l32.m1.3.3.3.3.3.2.cmml">θ</mi><mi id="alg1.l32.m1.3.3.3.3.3.3" xref="alg1.l32.m1.3.3.3.3.3.3.cmml">o</mi></msub></msub><mo id="alg1.l32.m1.3.3.3.2" xref="alg1.l32.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l32.m1.3.3.3.1.1" xref="alg1.l32.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l32.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l32.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l32.m1.3.3.3.1.1.1" xref="alg1.l32.m1.3.3.3.1.1.1.cmml"><msub id="alg1.l32.m1.3.3.3.1.1.1.2" xref="alg1.l32.m1.3.3.3.1.1.1.2.cmml"><mi id="alg1.l32.m1.3.3.3.1.1.1.2.2" xref="alg1.l32.m1.3.3.3.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l32.m1.3.3.3.1.1.1.2.3" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.cmml"><mi id="alg1.l32.m1.3.3.3.1.1.1.2.3.2" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.2.cmml">τ</mi><mo id="alg1.l32.m1.3.3.3.1.1.1.2.3.1" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l32.m1.3.3.3.1.1.1.2.3.3" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l32.m1.3.3.3.1.1.1.1" xref="alg1.l32.m1.3.3.3.1.1.1.1.cmml">|</mo><msub id="alg1.l32.m1.3.3.3.1.1.1.3" xref="alg1.l32.m1.3.3.3.1.1.1.3.cmml"><mover accent="true" id="alg1.l32.m1.3.3.3.1.1.1.3.2" xref="alg1.l32.m1.3.3.3.1.1.1.3.2.cmml"><mi id="alg1.l32.m1.3.3.3.1.1.1.3.2.2" xref="alg1.l32.m1.3.3.3.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l32.m1.3.3.3.1.1.1.3.2.1" xref="alg1.l32.m1.3.3.3.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l32.m1.3.3.3.1.1.1.3.3" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.cmml"><mi id="alg1.l32.m1.3.3.3.1.1.1.3.3.2" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.2.cmml">τ</mi><mo id="alg1.l32.m1.3.3.3.1.1.1.3.3.1" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l32.m1.3.3.3.1.1.1.3.3.3" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l32.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l32.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.3b"><apply id="alg1.l32.m1.3.3.cmml" xref="alg1.l32.m1.3.3"><ci id="alg1.l32.m1.3.3.4.cmml" xref="alg1.l32.m1.3.3.4">←</ci><list id="alg1.l32.m1.2.2.2.3.cmml" xref="alg1.l32.m1.2.2.2.2"><apply id="alg1.l32.m1.1.1.1.1.1.cmml" xref="alg1.l32.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l32.m1.1.1.1.1.1.1.cmml" xref="alg1.l32.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l32.m1.1.1.1.1.1.2.cmml" xref="alg1.l32.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l32.m1.1.1.1.1.1.3.cmml" xref="alg1.l32.m1.1.1.1.1.1.3">′′′</ci></apply><apply id="alg1.l32.m1.2.2.2.2.2.cmml" xref="alg1.l32.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l32.m1.2.2.2.2.2.1.cmml" xref="alg1.l32.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l32.m1.2.2.2.2.2.2.cmml" xref="alg1.l32.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l32.m1.2.2.2.2.2.3.cmml" xref="alg1.l32.m1.2.2.2.2.2.3">′′′</ci></apply></list><apply id="alg1.l32.m1.3.3.3.cmml" xref="alg1.l32.m1.3.3.3"><times id="alg1.l32.m1.3.3.3.2.cmml" xref="alg1.l32.m1.3.3.3.2"></times><apply id="alg1.l32.m1.3.3.3.3.cmml" xref="alg1.l32.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l32.m1.3.3.3.3.1.cmml" xref="alg1.l32.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l32.m1.3.3.3.3.2.cmml" xref="alg1.l32.m1.3.3.3.3.2">𝑃</ci><apply id="alg1.l32.m1.3.3.3.3.3.cmml" xref="alg1.l32.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l32.m1.3.3.3.3.3.1.cmml" xref="alg1.l32.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l32.m1.3.3.3.3.3.2.cmml" xref="alg1.l32.m1.3.3.3.3.3.2">𝜃</ci><ci id="alg1.l32.m1.3.3.3.3.3.3.cmml" xref="alg1.l32.m1.3.3.3.3.3.3">𝑜</ci></apply></apply><apply id="alg1.l32.m1.3.3.3.1.1.1.cmml" xref="alg1.l32.m1.3.3.3.1.1"><csymbol cd="latexml" id="alg1.l32.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.1">conditional</csymbol><apply id="alg1.l32.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l32.m1.3.3.3.1.1.1.2.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="alg1.l32.m1.3.3.3.1.1.1.2.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2.2">𝑜</ci><apply id="alg1.l32.m1.3.3.3.1.1.1.2.3.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2.3"><plus id="alg1.l32.m1.3.3.3.1.1.1.2.3.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.1"></plus><ci id="alg1.l32.m1.3.3.3.1.1.1.2.3.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.2">𝜏</ci><ci id="alg1.l32.m1.3.3.3.1.1.1.2.3.3.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l32.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l32.m1.3.3.3.1.1.1.3.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3">subscript</csymbol><apply id="alg1.l32.m1.3.3.3.1.1.1.3.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.2"><ci id="alg1.l32.m1.3.3.3.1.1.1.3.2.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.2.1">~</ci><ci id="alg1.l32.m1.3.3.3.1.1.1.3.2.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l32.m1.3.3.3.1.1.1.3.3.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.3"><plus id="alg1.l32.m1.3.3.3.1.1.1.3.3.1.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.1"></plus><ci id="alg1.l32.m1.3.3.3.1.1.1.3.3.2.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.2">𝜏</ci><ci id="alg1.l32.m1.3.3.3.1.1.1.3.3.3.cmml" xref="alg1.l32.m1.3.3.3.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.3c">\mu^{\prime\prime\prime},\ \sigma^{\prime\prime\prime}\leftarrow{P}_{\theta_{o%
}}({o}_{\tau+H}|\tilde{s}_{\tau+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m1.3d">italic_μ start_POSTSUPERSCRIPT ′ ′ ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ ′ ′ end_POSTSUPERSCRIPT ← italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_τ + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l33.1.1.1" style="font-size:80%;">33:</span></span><math alttext="G\leftarrow G+[H(\mu^{\prime\prime},\ \sigma^{\prime\prime})-H(\mu^{\prime%
\prime\prime},\ \sigma^{\prime\prime\prime})]" class="ltx_Math" display="inline" id="alg1.l33.m1.1"><semantics id="alg1.l33.m1.1a"><mrow id="alg1.l33.m1.1.1" xref="alg1.l33.m1.1.1.cmml"><mi id="alg1.l33.m1.1.1.3" xref="alg1.l33.m1.1.1.3.cmml">G</mi><mo id="alg1.l33.m1.1.1.2" stretchy="false" xref="alg1.l33.m1.1.1.2.cmml">←</mo><mrow id="alg1.l33.m1.1.1.1" xref="alg1.l33.m1.1.1.1.cmml"><mi id="alg1.l33.m1.1.1.1.3" xref="alg1.l33.m1.1.1.1.3.cmml">G</mi><mo id="alg1.l33.m1.1.1.1.2" xref="alg1.l33.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l33.m1.1.1.1.1.1" xref="alg1.l33.m1.1.1.1.1.2.cmml"><mo id="alg1.l33.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l33.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l33.m1.1.1.1.1.1.1" xref="alg1.l33.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l33.m1.1.1.1.1.1.1.2" xref="alg1.l33.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.2.4" xref="alg1.l33.m1.1.1.1.1.1.1.2.4.cmml">H</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.2.3" xref="alg1.l33.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg1.l33.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">′′</mo></msup><mo id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.4" rspace="0.667em" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.3" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">′′</mo></msup><mo id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l33.m1.1.1.1.1.1.1.5" xref="alg1.l33.m1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="alg1.l33.m1.1.1.1.1.1.1.4" xref="alg1.l33.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.4.4" xref="alg1.l33.m1.1.1.1.1.1.1.4.4.cmml">H</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.4.3" xref="alg1.l33.m1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="alg1.l33.m1.1.1.1.1.1.1.4.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.3.cmml"><mo id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.3" stretchy="false" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msup id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.2" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.2.cmml">μ</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.3" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.3.cmml">′′′</mo></msup><mo id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.4" rspace="0.667em" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msup id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.2" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.2.cmml">σ</mi><mo id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.3" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.3.cmml">′′′</mo></msup><mo id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.5" stretchy="false" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l33.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l33.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l33.m1.1b"><apply id="alg1.l33.m1.1.1.cmml" xref="alg1.l33.m1.1.1"><ci id="alg1.l33.m1.1.1.2.cmml" xref="alg1.l33.m1.1.1.2">←</ci><ci id="alg1.l33.m1.1.1.3.cmml" xref="alg1.l33.m1.1.1.3">𝐺</ci><apply id="alg1.l33.m1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1"><plus id="alg1.l33.m1.1.1.1.2.cmml" xref="alg1.l33.m1.1.1.1.2"></plus><ci id="alg1.l33.m1.1.1.1.3.cmml" xref="alg1.l33.m1.1.1.1.3">𝐺</ci><apply id="alg1.l33.m1.1.1.1.1.2.cmml" xref="alg1.l33.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l33.m1.1.1.1.1.2.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l33.m1.1.1.1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1"><minus id="alg1.l33.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.5"></minus><apply id="alg1.l33.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2"><times id="alg1.l33.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.3"></times><ci id="alg1.l33.m1.1.1.1.1.1.1.2.4.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.4">𝐻</ci><interval closure="open" id="alg1.l33.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2"><apply id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.1.1.1.1.3">′′</ci></apply><apply id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.2.2.2.2.3">′′</ci></apply></interval></apply><apply id="alg1.l33.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4"><times id="alg1.l33.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.3"></times><ci id="alg1.l33.m1.1.1.1.1.1.1.4.4.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.4">𝐻</ci><interval closure="open" id="alg1.l33.m1.1.1.1.1.1.1.4.2.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2"><apply id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1">superscript</csymbol><ci id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.2">𝜇</ci><ci id="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.3.1.1.1.3">′′′</ci></apply><apply id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2">superscript</csymbol><ci id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.2">𝜎</ci><ci id="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="alg1.l33.m1.1.1.1.1.1.1.4.2.2.2.3">′′′</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l33.m1.1c">G\leftarrow G+[H(\mu^{\prime\prime},\ \sigma^{\prime\prime})-H(\mu^{\prime%
\prime\prime},\ \sigma^{\prime\prime\prime})]</annotation><annotation encoding="application/x-llamapun" id="alg1.l33.m1.1d">italic_G ← italic_G + [ italic_H ( italic_μ start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) - italic_H ( italic_μ start_POSTSUPERSCRIPT ′ ′ ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ ′ ′ end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l33.2">\EndFor</span><span class="ltx_ERROR undefined" id="alg1.l33.3">\EndFor</span><span class="ltx_ERROR undefined" id="alg1.l33.4">\EndFor</span>
</div>
<div class="ltx_listingline" id="alg1.l34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l34.1.1.1" style="font-size:80%;">34:</span></span><math alttext="\phi_{a}\leftarrow\phi_{a}-\alpha\nabla_{\phi_{a}}\mathbb{E}\bigl{[}{G}(\phi_{%
a})\bigr{]}" class="ltx_Math" display="inline" id="alg1.l34.m1.1"><semantics id="alg1.l34.m1.1a"><mrow id="alg1.l34.m1.1.1" xref="alg1.l34.m1.1.1.cmml"><msub id="alg1.l34.m1.1.1.3" xref="alg1.l34.m1.1.1.3.cmml"><mi id="alg1.l34.m1.1.1.3.2" xref="alg1.l34.m1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l34.m1.1.1.3.3" xref="alg1.l34.m1.1.1.3.3.cmml">a</mi></msub><mo id="alg1.l34.m1.1.1.2" stretchy="false" xref="alg1.l34.m1.1.1.2.cmml">←</mo><mrow id="alg1.l34.m1.1.1.1" xref="alg1.l34.m1.1.1.1.cmml"><msub id="alg1.l34.m1.1.1.1.3" xref="alg1.l34.m1.1.1.1.3.cmml"><mi id="alg1.l34.m1.1.1.1.3.2" xref="alg1.l34.m1.1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l34.m1.1.1.1.3.3" xref="alg1.l34.m1.1.1.1.3.3.cmml">a</mi></msub><mo id="alg1.l34.m1.1.1.1.2" xref="alg1.l34.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l34.m1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.cmml"><mi id="alg1.l34.m1.1.1.1.1.3" xref="alg1.l34.m1.1.1.1.1.3.cmml">α</mi><mo id="alg1.l34.m1.1.1.1.1.2" lspace="0.167em" xref="alg1.l34.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l34.m1.1.1.1.1.4" xref="alg1.l34.m1.1.1.1.1.4.cmml"><msub id="alg1.l34.m1.1.1.1.1.4.1" xref="alg1.l34.m1.1.1.1.1.4.1.cmml"><mo id="alg1.l34.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l34.m1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="alg1.l34.m1.1.1.1.1.4.1.3" xref="alg1.l34.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l34.m1.1.1.1.1.4.1.3.2" xref="alg1.l34.m1.1.1.1.1.4.1.3.2.cmml">ϕ</mi><mi id="alg1.l34.m1.1.1.1.1.4.1.3.3" xref="alg1.l34.m1.1.1.1.1.4.1.3.3.cmml">a</mi></msub></msub><mi id="alg1.l34.m1.1.1.1.1.4.2" xref="alg1.l34.m1.1.1.1.1.4.2.cmml">𝔼</mi></mrow><mo id="alg1.l34.m1.1.1.1.1.2a" xref="alg1.l34.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l34.m1.1.1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l34.m1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="alg1.l34.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l34.m1.1.1.1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l34.m1.1.1.1.1.1.1.1.3" xref="alg1.l34.m1.1.1.1.1.1.1.1.3.cmml">G</mi><mo id="alg1.l34.m1.1.1.1.1.1.1.1.2" xref="alg1.l34.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l34.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l34.m1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="alg1.l34.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l34.m1.1b"><apply id="alg1.l34.m1.1.1.cmml" xref="alg1.l34.m1.1.1"><ci id="alg1.l34.m1.1.1.2.cmml" xref="alg1.l34.m1.1.1.2">←</ci><apply id="alg1.l34.m1.1.1.3.cmml" xref="alg1.l34.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.3.1.cmml" xref="alg1.l34.m1.1.1.3">subscript</csymbol><ci id="alg1.l34.m1.1.1.3.2.cmml" xref="alg1.l34.m1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l34.m1.1.1.3.3.cmml" xref="alg1.l34.m1.1.1.3.3">𝑎</ci></apply><apply id="alg1.l34.m1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1"><minus id="alg1.l34.m1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.2"></minus><apply id="alg1.l34.m1.1.1.1.3.cmml" xref="alg1.l34.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.1.3.1.cmml" xref="alg1.l34.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l34.m1.1.1.1.3.2.cmml" xref="alg1.l34.m1.1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l34.m1.1.1.1.3.3.cmml" xref="alg1.l34.m1.1.1.1.3.3">𝑎</ci></apply><apply id="alg1.l34.m1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1"><times id="alg1.l34.m1.1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.2"></times><ci id="alg1.l34.m1.1.1.1.1.3.cmml" xref="alg1.l34.m1.1.1.1.1.3">𝛼</ci><apply id="alg1.l34.m1.1.1.1.1.4.cmml" xref="alg1.l34.m1.1.1.1.1.4"><apply id="alg1.l34.m1.1.1.1.1.4.1.cmml" xref="alg1.l34.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l34.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l34.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l34.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l34.m1.1.1.1.1.4.1.3">subscript</csymbol><ci id="alg1.l34.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l34.m1.1.1.1.1.4.1.3.2">italic-ϕ</ci><ci id="alg1.l34.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l34.m1.1.1.1.1.4.1.3.3">𝑎</ci></apply></apply><ci id="alg1.l34.m1.1.1.1.1.4.2.cmml" xref="alg1.l34.m1.1.1.1.1.4.2">𝔼</ci></apply><apply id="alg1.l34.m1.1.1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l34.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l34.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1"><times id="alg1.l34.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.2"></times><ci id="alg1.l34.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.3">𝐺</ci><apply id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l34.m1.1c">\phi_{a}\leftarrow\phi_{a}-\alpha\nabla_{\phi_{a}}\mathbb{E}\bigl{[}{G}(\phi_{%
a})\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l34.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT - italic_α ∇ start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ italic_G ( italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) ]</annotation></semantics></math>
<span class="ltx_ERROR undefined" id="alg1.l34.2">\EndFor</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_top ltx_listing" id="alg1.4" style="width:169.1pt;">
<div class="ltx_listingline" id="alg1.l1a">
<span class="ltx_text ltx_font_bold" id="alg1.l1a.1">Agent components:</span>
</div>
<div class="ltx_listingline" id="alg1.l2a"> Model:

</div>
<div class="ltx_listingline" id="alg1.l3a">  Encoder <math alttext="Q_{\phi_{s}}" class="ltx_Math" display="inline" id="alg1.l3a.m1.1"><semantics id="alg1.l3a.m1.1a"><msub id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml"><mi id="alg1.l3a.m1.1.1.2" xref="alg1.l3a.m1.1.1.2.cmml">Q</mi><msub id="alg1.l3a.m1.1.1.3" xref="alg1.l3a.m1.1.1.3.cmml"><mi id="alg1.l3a.m1.1.1.3.2" xref="alg1.l3a.m1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l3a.m1.1.1.3.3" xref="alg1.l3a.m1.1.1.3.3.cmml">s</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.1b"><apply id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.1.cmml" xref="alg1.l3a.m1.1.1">subscript</csymbol><ci id="alg1.l3a.m1.1.1.2.cmml" xref="alg1.l3a.m1.1.1.2">𝑄</ci><apply id="alg1.l3a.m1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3a.m1.1.1.3.1.cmml" xref="alg1.l3a.m1.1.1.3">subscript</csymbol><ci id="alg1.l3a.m1.1.1.3.2.cmml" xref="alg1.l3a.m1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l3a.m1.1.1.3.3.cmml" xref="alg1.l3a.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.1c">Q_{\phi_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3a.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l4a">  Transition <math alttext="P_{\theta_{s}}" class="ltx_Math" display="inline" id="alg1.l4a.m1.1"><semantics id="alg1.l4a.m1.1a"><msub id="alg1.l4a.m1.1.1" xref="alg1.l4a.m1.1.1.cmml"><mi id="alg1.l4a.m1.1.1.2" xref="alg1.l4a.m1.1.1.2.cmml">P</mi><msub id="alg1.l4a.m1.1.1.3" xref="alg1.l4a.m1.1.1.3.cmml"><mi id="alg1.l4a.m1.1.1.3.2" xref="alg1.l4a.m1.1.1.3.2.cmml">θ</mi><mi id="alg1.l4a.m1.1.1.3.3" xref="alg1.l4a.m1.1.1.3.3.cmml">s</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.1b"><apply id="alg1.l4a.m1.1.1.cmml" xref="alg1.l4a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.cmml" xref="alg1.l4a.m1.1.1">subscript</csymbol><ci id="alg1.l4a.m1.1.1.2.cmml" xref="alg1.l4a.m1.1.1.2">𝑃</ci><apply id="alg1.l4a.m1.1.1.3.cmml" xref="alg1.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.3.1.cmml" xref="alg1.l4a.m1.1.1.3">subscript</csymbol><ci id="alg1.l4a.m1.1.1.3.2.cmml" xref="alg1.l4a.m1.1.1.3.2">𝜃</ci><ci id="alg1.l4a.m1.1.1.3.3.cmml" xref="alg1.l4a.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.1c">P_{\theta_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4a.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l5a">  Decoder <math alttext="P_{\theta_{o}}" class="ltx_Math" display="inline" id="alg1.l5a.m1.1"><semantics id="alg1.l5a.m1.1a"><msub id="alg1.l5a.m1.1.1" xref="alg1.l5a.m1.1.1.cmml"><mi id="alg1.l5a.m1.1.1.2" xref="alg1.l5a.m1.1.1.2.cmml">P</mi><msub id="alg1.l5a.m1.1.1.3" xref="alg1.l5a.m1.1.1.3.cmml"><mi id="alg1.l5a.m1.1.1.3.2" xref="alg1.l5a.m1.1.1.3.2.cmml">θ</mi><mi id="alg1.l5a.m1.1.1.3.3" xref="alg1.l5a.m1.1.1.3.3.cmml">o</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l5a.m1.1b"><apply id="alg1.l5a.m1.1.1.cmml" xref="alg1.l5a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5a.m1.1.1.1.cmml" xref="alg1.l5a.m1.1.1">subscript</csymbol><ci id="alg1.l5a.m1.1.1.2.cmml" xref="alg1.l5a.m1.1.1.2">𝑃</ci><apply id="alg1.l5a.m1.1.1.3.cmml" xref="alg1.l5a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5a.m1.1.1.3.1.cmml" xref="alg1.l5a.m1.1.1.3">subscript</csymbol><ci id="alg1.l5a.m1.1.1.3.2.cmml" xref="alg1.l5a.m1.1.1.3.2">𝜃</ci><ci id="alg1.l5a.m1.1.1.3.3.cmml" xref="alg1.l5a.m1.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5a.m1.1c">P_{\theta_{o}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5a.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l6a"> Actor <math alttext="Q_{\phi_{a}}" class="ltx_Math" display="inline" id="alg1.l6a.m1.1"><semantics id="alg1.l6a.m1.1a"><msub id="alg1.l6a.m1.1.1" xref="alg1.l6a.m1.1.1.cmml"><mi id="alg1.l6a.m1.1.1.2" xref="alg1.l6a.m1.1.1.2.cmml">Q</mi><msub id="alg1.l6a.m1.1.1.3" xref="alg1.l6a.m1.1.1.3.cmml"><mi id="alg1.l6a.m1.1.1.3.2" xref="alg1.l6a.m1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l6a.m1.1.1.3.3" xref="alg1.l6a.m1.1.1.3.3.cmml">a</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l6a.m1.1b"><apply id="alg1.l6a.m1.1.1.cmml" xref="alg1.l6a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6a.m1.1.1.1.cmml" xref="alg1.l6a.m1.1.1">subscript</csymbol><ci id="alg1.l6a.m1.1.1.2.cmml" xref="alg1.l6a.m1.1.1.2">𝑄</ci><apply id="alg1.l6a.m1.1.1.3.cmml" xref="alg1.l6a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6a.m1.1.1.3.1.cmml" xref="alg1.l6a.m1.1.1.3">subscript</csymbol><ci id="alg1.l6a.m1.1.1.3.2.cmml" xref="alg1.l6a.m1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l6a.m1.1.1.3.3.cmml" xref="alg1.l6a.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6a.m1.1c">Q_{\phi_{a}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6a.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l7a"> Actor mapping <math alttext="\Pi" class="ltx_Math" display="inline" id="alg1.l7a.m1.1"><semantics id="alg1.l7a.m1.1a"><mi id="alg1.l7a.m1.1.1" mathvariant="normal" xref="alg1.l7a.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.1b"><ci id="alg1.l7a.m1.1.1.cmml" xref="alg1.l7a.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="alg1.l7a.m1.1d">roman_Π</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l8a"> Preference mapping <math alttext="\Psi" class="ltx_Math" display="inline" id="alg1.l8a.m1.1"><semantics id="alg1.l8a.m1.1a"><mi id="alg1.l8a.m1.1.1" mathvariant="normal" xref="alg1.l8a.m1.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.1b"><ci id="alg1.l8a.m1.1.1.cmml" xref="alg1.l8a.m1.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="alg1.l8a.m1.1d">roman_Ψ</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l9a">
</div>
<div class="ltx_listingline" id="alg1.l10a">
<span class="ltx_text ltx_font_bold" id="alg1.l10a.1">Other components:</span>
</div>
<div class="ltx_listingline" id="alg1.l11a"> Environment <math alttext="E" class="ltx_Math" display="inline" id="alg1.l11a.m1.1"><semantics id="alg1.l11a.m1.1a"><mi id="alg1.l11a.m1.1.1" xref="alg1.l11a.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l11a.m1.1b"><ci id="alg1.l11a.m1.1.1.cmml" xref="alg1.l11a.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11a.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l11a.m1.1d">italic_E</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l12a"> Experience Memory <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l12a.m1.1"><semantics id="alg1.l12a.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l12a.m1.1.1" xref="alg1.l12a.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l12a.m1.1b"><ci id="alg1.l12a.m1.1.1.cmml" xref="alg1.l12a.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12a.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12a.m1.1d">caligraphic_M</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l13a">
</div>
<div class="ltx_listingline" id="alg1.l14a">
<span class="ltx_text ltx_font_bold" id="alg1.l14a.1">Hyperparameters:</span>
</div>
<div class="ltx_listingline" id="alg1.l15a"> Iterations <math alttext="N" class="ltx_Math" display="inline" id="alg1.l15a.m1.1"><semantics id="alg1.l15a.m1.1a"><mi id="alg1.l15a.m1.1.1" xref="alg1.l15a.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l15a.m1.1b"><ci id="alg1.l15a.m1.1.1.cmml" xref="alg1.l15a.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15a.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l15a.m1.1d">italic_N</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l16a"> Beta <math alttext="\beta" class="ltx_Math" display="inline" id="alg1.l16a.m1.1"><semantics id="alg1.l16a.m1.1a"><mi id="alg1.l16a.m1.1.1" xref="alg1.l16a.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l16a.m1.1b"><ci id="alg1.l16a.m1.1.1.cmml" xref="alg1.l16a.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16a.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.l16a.m1.1d">italic_β</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l17a"> Horizon <math alttext="H" class="ltx_Math" display="inline" id="alg1.l17a.m1.1"><semantics id="alg1.l17a.m1.1a"><mi id="alg1.l17a.m1.1.1" xref="alg1.l17a.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l17a.m1.1b"><ci id="alg1.l17a.m1.1.1.cmml" xref="alg1.l17a.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17a.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg1.l17a.m1.1d">italic_H</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l18a"> Batch size <math alttext="B_{1}\ ,B_{2}" class="ltx_Math" display="inline" id="alg1.l18a.m1.2"><semantics id="alg1.l18a.m1.2a"><mrow id="alg1.l18a.m1.2.2.2" xref="alg1.l18a.m1.2.2.3.cmml"><msub id="alg1.l18a.m1.1.1.1.1" xref="alg1.l18a.m1.1.1.1.1.cmml"><mi id="alg1.l18a.m1.1.1.1.1.2" xref="alg1.l18a.m1.1.1.1.1.2.cmml">B</mi><mn id="alg1.l18a.m1.1.1.1.1.3" xref="alg1.l18a.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l18a.m1.2.2.2.3" lspace="0.500em" xref="alg1.l18a.m1.2.2.3.cmml">,</mo><msub id="alg1.l18a.m1.2.2.2.2" xref="alg1.l18a.m1.2.2.2.2.cmml"><mi id="alg1.l18a.m1.2.2.2.2.2" xref="alg1.l18a.m1.2.2.2.2.2.cmml">B</mi><mn id="alg1.l18a.m1.2.2.2.2.3" xref="alg1.l18a.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18a.m1.2b"><list id="alg1.l18a.m1.2.2.3.cmml" xref="alg1.l18a.m1.2.2.2"><apply id="alg1.l18a.m1.1.1.1.1.cmml" xref="alg1.l18a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18a.m1.1.1.1.1.1.cmml" xref="alg1.l18a.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l18a.m1.1.1.1.1.2.cmml" xref="alg1.l18a.m1.1.1.1.1.2">𝐵</ci><cn id="alg1.l18a.m1.1.1.1.1.3.cmml" type="integer" xref="alg1.l18a.m1.1.1.1.1.3">1</cn></apply><apply id="alg1.l18a.m1.2.2.2.2.cmml" xref="alg1.l18a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18a.m1.2.2.2.2.1.cmml" xref="alg1.l18a.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l18a.m1.2.2.2.2.2.cmml" xref="alg1.l18a.m1.2.2.2.2.2">𝐵</ci><cn id="alg1.l18a.m1.2.2.2.2.3.cmml" type="integer" xref="alg1.l18a.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18a.m1.2c">B_{1}\ ,B_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18a.m1.2d">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l19a"> Sample size <math alttext="S_{1}\ ,S_{2}" class="ltx_Math" display="inline" id="alg1.l19a.m1.2"><semantics id="alg1.l19a.m1.2a"><mrow id="alg1.l19a.m1.2.2.2" xref="alg1.l19a.m1.2.2.3.cmml"><msub id="alg1.l19a.m1.1.1.1.1" xref="alg1.l19a.m1.1.1.1.1.cmml"><mi id="alg1.l19a.m1.1.1.1.1.2" xref="alg1.l19a.m1.1.1.1.1.2.cmml">S</mi><mn id="alg1.l19a.m1.1.1.1.1.3" xref="alg1.l19a.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l19a.m1.2.2.2.3" lspace="0.500em" xref="alg1.l19a.m1.2.2.3.cmml">,</mo><msub id="alg1.l19a.m1.2.2.2.2" xref="alg1.l19a.m1.2.2.2.2.cmml"><mi id="alg1.l19a.m1.2.2.2.2.2" xref="alg1.l19a.m1.2.2.2.2.2.cmml">S</mi><mn id="alg1.l19a.m1.2.2.2.2.3" xref="alg1.l19a.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19a.m1.2b"><list id="alg1.l19a.m1.2.2.3.cmml" xref="alg1.l19a.m1.2.2.2"><apply id="alg1.l19a.m1.1.1.1.1.cmml" xref="alg1.l19a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19a.m1.1.1.1.1.1.cmml" xref="alg1.l19a.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l19a.m1.1.1.1.1.2.cmml" xref="alg1.l19a.m1.1.1.1.1.2">𝑆</ci><cn id="alg1.l19a.m1.1.1.1.1.3.cmml" type="integer" xref="alg1.l19a.m1.1.1.1.1.3">1</cn></apply><apply id="alg1.l19a.m1.2.2.2.2.cmml" xref="alg1.l19a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19a.m1.2.2.2.2.1.cmml" xref="alg1.l19a.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l19a.m1.2.2.2.2.2.cmml" xref="alg1.l19a.m1.2.2.2.2.2">𝑆</ci><cn id="alg1.l19a.m1.2.2.2.2.3.cmml" type="integer" xref="alg1.l19a.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19a.m1.2c">S_{1}\ ,S_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19a.m1.2d">italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l20a"> Learning rate <math alttext="\xi\ ,\gamma\ ,\eta\ ,\alpha" class="ltx_Math" display="inline" id="alg1.l20a.m1.4"><semantics id="alg1.l20a.m1.4a"><mrow id="alg1.l20a.m1.4.5.2" xref="alg1.l20a.m1.4.5.1.cmml"><mi id="alg1.l20a.m1.1.1" xref="alg1.l20a.m1.1.1.cmml">ξ</mi><mo id="alg1.l20a.m1.4.5.2.1" lspace="0.500em" xref="alg1.l20a.m1.4.5.1.cmml">,</mo><mi id="alg1.l20a.m1.2.2" xref="alg1.l20a.m1.2.2.cmml">γ</mi><mo id="alg1.l20a.m1.4.5.2.2" lspace="0.500em" xref="alg1.l20a.m1.4.5.1.cmml">,</mo><mi id="alg1.l20a.m1.3.3" xref="alg1.l20a.m1.3.3.cmml">η</mi><mo id="alg1.l20a.m1.4.5.2.3" lspace="0.500em" xref="alg1.l20a.m1.4.5.1.cmml">,</mo><mi id="alg1.l20a.m1.4.4" xref="alg1.l20a.m1.4.4.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20a.m1.4b"><list id="alg1.l20a.m1.4.5.1.cmml" xref="alg1.l20a.m1.4.5.2"><ci id="alg1.l20a.m1.1.1.cmml" xref="alg1.l20a.m1.1.1">𝜉</ci><ci id="alg1.l20a.m1.2.2.cmml" xref="alg1.l20a.m1.2.2">𝛾</ci><ci id="alg1.l20a.m1.3.3.cmml" xref="alg1.l20a.m1.3.3">𝜂</ci><ci id="alg1.l20a.m1.4.4.cmml" xref="alg1.l20a.m1.4.4">𝛼</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20a.m1.4c">\xi\ ,\gamma\ ,\eta\ ,\alpha</annotation><annotation encoding="application/x-llamapun" id="alg1.l20a.m1.4d">italic_ξ , italic_γ , italic_η , italic_α</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l21a">
</div>
<div class="ltx_listingline" id="alg1.l22a">
<span class="ltx_text ltx_font_bold" id="alg1.l22a.1">Run</span> <math alttext="\text{Model}(\tilde{o}_{i},\hat{\pi},\tilde{o}_{i+H})" class="ltx_Math" display="inline" id="alg1.l22a.m1.3"><semantics id="alg1.l22a.m1.3a"><mrow id="alg1.l22a.m1.3.3" xref="alg1.l22a.m1.3.3.cmml"><mtext id="alg1.l22a.m1.3.3.4" xref="alg1.l22a.m1.3.3.4a.cmml">Model</mtext><mo id="alg1.l22a.m1.3.3.3" xref="alg1.l22a.m1.3.3.3.cmml">⁢</mo><mrow id="alg1.l22a.m1.3.3.2.2" xref="alg1.l22a.m1.3.3.2.3.cmml"><mo id="alg1.l22a.m1.3.3.2.2.3" stretchy="false" xref="alg1.l22a.m1.3.3.2.3.cmml">(</mo><msub id="alg1.l22a.m1.2.2.1.1.1" xref="alg1.l22a.m1.2.2.1.1.1.cmml"><mover accent="true" id="alg1.l22a.m1.2.2.1.1.1.2" xref="alg1.l22a.m1.2.2.1.1.1.2.cmml"><mi id="alg1.l22a.m1.2.2.1.1.1.2.2" xref="alg1.l22a.m1.2.2.1.1.1.2.2.cmml">o</mi><mo id="alg1.l22a.m1.2.2.1.1.1.2.1" xref="alg1.l22a.m1.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l22a.m1.2.2.1.1.1.3" xref="alg1.l22a.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l22a.m1.3.3.2.2.4" xref="alg1.l22a.m1.3.3.2.3.cmml">,</mo><mover accent="true" id="alg1.l22a.m1.1.1" xref="alg1.l22a.m1.1.1.cmml"><mi id="alg1.l22a.m1.1.1.2" xref="alg1.l22a.m1.1.1.2.cmml">π</mi><mo id="alg1.l22a.m1.1.1.1" xref="alg1.l22a.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l22a.m1.3.3.2.2.5" xref="alg1.l22a.m1.3.3.2.3.cmml">,</mo><msub id="alg1.l22a.m1.3.3.2.2.2" xref="alg1.l22a.m1.3.3.2.2.2.cmml"><mover accent="true" id="alg1.l22a.m1.3.3.2.2.2.2" xref="alg1.l22a.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l22a.m1.3.3.2.2.2.2.2" xref="alg1.l22a.m1.3.3.2.2.2.2.2.cmml">o</mi><mo id="alg1.l22a.m1.3.3.2.2.2.2.1" xref="alg1.l22a.m1.3.3.2.2.2.2.1.cmml">~</mo></mover><mrow id="alg1.l22a.m1.3.3.2.2.2.3" xref="alg1.l22a.m1.3.3.2.2.2.3.cmml"><mi id="alg1.l22a.m1.3.3.2.2.2.3.2" xref="alg1.l22a.m1.3.3.2.2.2.3.2.cmml">i</mi><mo id="alg1.l22a.m1.3.3.2.2.2.3.1" xref="alg1.l22a.m1.3.3.2.2.2.3.1.cmml">+</mo><mi id="alg1.l22a.m1.3.3.2.2.2.3.3" xref="alg1.l22a.m1.3.3.2.2.2.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l22a.m1.3.3.2.2.6" stretchy="false" xref="alg1.l22a.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22a.m1.3b"><apply id="alg1.l22a.m1.3.3.cmml" xref="alg1.l22a.m1.3.3"><times id="alg1.l22a.m1.3.3.3.cmml" xref="alg1.l22a.m1.3.3.3"></times><ci id="alg1.l22a.m1.3.3.4a.cmml" xref="alg1.l22a.m1.3.3.4"><mtext id="alg1.l22a.m1.3.3.4.cmml" xref="alg1.l22a.m1.3.3.4">Model</mtext></ci><vector id="alg1.l22a.m1.3.3.2.3.cmml" xref="alg1.l22a.m1.3.3.2.2"><apply id="alg1.l22a.m1.2.2.1.1.1.cmml" xref="alg1.l22a.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l22a.m1.2.2.1.1.1.1.cmml" xref="alg1.l22a.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.l22a.m1.2.2.1.1.1.2.cmml" xref="alg1.l22a.m1.2.2.1.1.1.2"><ci id="alg1.l22a.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l22a.m1.2.2.1.1.1.2.1">~</ci><ci id="alg1.l22a.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l22a.m1.2.2.1.1.1.2.2">𝑜</ci></apply><ci id="alg1.l22a.m1.2.2.1.1.1.3.cmml" xref="alg1.l22a.m1.2.2.1.1.1.3">𝑖</ci></apply><apply id="alg1.l22a.m1.1.1.cmml" xref="alg1.l22a.m1.1.1"><ci id="alg1.l22a.m1.1.1.1.cmml" xref="alg1.l22a.m1.1.1.1">^</ci><ci id="alg1.l22a.m1.1.1.2.cmml" xref="alg1.l22a.m1.1.1.2">𝜋</ci></apply><apply id="alg1.l22a.m1.3.3.2.2.2.cmml" xref="alg1.l22a.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l22a.m1.3.3.2.2.2.1.cmml" xref="alg1.l22a.m1.3.3.2.2.2">subscript</csymbol><apply id="alg1.l22a.m1.3.3.2.2.2.2.cmml" xref="alg1.l22a.m1.3.3.2.2.2.2"><ci id="alg1.l22a.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l22a.m1.3.3.2.2.2.2.1">~</ci><ci id="alg1.l22a.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l22a.m1.3.3.2.2.2.2.2">𝑜</ci></apply><apply id="alg1.l22a.m1.3.3.2.2.2.3.cmml" xref="alg1.l22a.m1.3.3.2.2.2.3"><plus id="alg1.l22a.m1.3.3.2.2.2.3.1.cmml" xref="alg1.l22a.m1.3.3.2.2.2.3.1"></plus><ci id="alg1.l22a.m1.3.3.2.2.2.3.2.cmml" xref="alg1.l22a.m1.3.3.2.2.2.3.2">𝑖</ci><ci id="alg1.l22a.m1.3.3.2.2.2.3.3.cmml" xref="alg1.l22a.m1.3.3.2.2.2.3.3">𝐻</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22a.m1.3c">\text{Model}(\tilde{o}_{i},\hat{\pi},\tilde{o}_{i+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l22a.m1.3d">Model ( over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG , over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>:

</div>
<div class="ltx_listingline" id="alg1.l23a"> Compute <math alttext="Q_{\phi_{s}}(s_{i})" class="ltx_Math" display="inline" id="alg1.l23a.m1.1"><semantics id="alg1.l23a.m1.1a"><mrow id="alg1.l23a.m1.1.1" xref="alg1.l23a.m1.1.1.cmml"><msub id="alg1.l23a.m1.1.1.3" xref="alg1.l23a.m1.1.1.3.cmml"><mi id="alg1.l23a.m1.1.1.3.2" xref="alg1.l23a.m1.1.1.3.2.cmml">Q</mi><msub id="alg1.l23a.m1.1.1.3.3" xref="alg1.l23a.m1.1.1.3.3.cmml"><mi id="alg1.l23a.m1.1.1.3.3.2" xref="alg1.l23a.m1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l23a.m1.1.1.3.3.3" xref="alg1.l23a.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l23a.m1.1.1.2" xref="alg1.l23a.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l23a.m1.1.1.1.1" xref="alg1.l23a.m1.1.1.1.1.1.cmml"><mo id="alg1.l23a.m1.1.1.1.1.2" stretchy="false" xref="alg1.l23a.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l23a.m1.1.1.1.1.1" xref="alg1.l23a.m1.1.1.1.1.1.cmml"><mi id="alg1.l23a.m1.1.1.1.1.1.2" xref="alg1.l23a.m1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l23a.m1.1.1.1.1.1.3" xref="alg1.l23a.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l23a.m1.1.1.1.1.3" stretchy="false" xref="alg1.l23a.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23a.m1.1b"><apply id="alg1.l23a.m1.1.1.cmml" xref="alg1.l23a.m1.1.1"><times id="alg1.l23a.m1.1.1.2.cmml" xref="alg1.l23a.m1.1.1.2"></times><apply id="alg1.l23a.m1.1.1.3.cmml" xref="alg1.l23a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l23a.m1.1.1.3.1.cmml" xref="alg1.l23a.m1.1.1.3">subscript</csymbol><ci id="alg1.l23a.m1.1.1.3.2.cmml" xref="alg1.l23a.m1.1.1.3.2">𝑄</ci><apply id="alg1.l23a.m1.1.1.3.3.cmml" xref="alg1.l23a.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l23a.m1.1.1.3.3.1.cmml" xref="alg1.l23a.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l23a.m1.1.1.3.3.2.cmml" xref="alg1.l23a.m1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l23a.m1.1.1.3.3.3.cmml" xref="alg1.l23a.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l23a.m1.1.1.1.1.1.cmml" xref="alg1.l23a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23a.m1.1.1.1.1.1.1.cmml" xref="alg1.l23a.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l23a.m1.1.1.1.1.1.2.cmml" xref="alg1.l23a.m1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l23a.m1.1.1.1.1.1.3.cmml" xref="alg1.l23a.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23a.m1.1c">Q_{\phi_{s}}(s_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l23a.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\tilde{o}_{i}" class="ltx_Math" display="inline" id="alg1.l23a.m2.1"><semantics id="alg1.l23a.m2.1a"><msub id="alg1.l23a.m2.1.1" xref="alg1.l23a.m2.1.1.cmml"><mover accent="true" id="alg1.l23a.m2.1.1.2" xref="alg1.l23a.m2.1.1.2.cmml"><mi id="alg1.l23a.m2.1.1.2.2" xref="alg1.l23a.m2.1.1.2.2.cmml">o</mi><mo id="alg1.l23a.m2.1.1.2.1" xref="alg1.l23a.m2.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l23a.m2.1.1.3" xref="alg1.l23a.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l23a.m2.1b"><apply id="alg1.l23a.m2.1.1.cmml" xref="alg1.l23a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l23a.m2.1.1.1.cmml" xref="alg1.l23a.m2.1.1">subscript</csymbol><apply id="alg1.l23a.m2.1.1.2.cmml" xref="alg1.l23a.m2.1.1.2"><ci id="alg1.l23a.m2.1.1.2.1.cmml" xref="alg1.l23a.m2.1.1.2.1">~</ci><ci id="alg1.l23a.m2.1.1.2.2.cmml" xref="alg1.l23a.m2.1.1.2.2">𝑜</ci></apply><ci id="alg1.l23a.m2.1.1.3.cmml" xref="alg1.l23a.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23a.m2.1c">\tilde{o}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23a.m2.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l24a"> Sample <math alttext="\tilde{s}_{i}\sim Q_{\phi_{s}}(s_{i})" class="ltx_Math" display="inline" id="alg1.l24a.m1.1"><semantics id="alg1.l24a.m1.1a"><mrow id="alg1.l24a.m1.1.1" xref="alg1.l24a.m1.1.1.cmml"><msub id="alg1.l24a.m1.1.1.3" xref="alg1.l24a.m1.1.1.3.cmml"><mover accent="true" id="alg1.l24a.m1.1.1.3.2" xref="alg1.l24a.m1.1.1.3.2.cmml"><mi id="alg1.l24a.m1.1.1.3.2.2" xref="alg1.l24a.m1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l24a.m1.1.1.3.2.1" xref="alg1.l24a.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="alg1.l24a.m1.1.1.3.3" xref="alg1.l24a.m1.1.1.3.3.cmml">i</mi></msub><mo id="alg1.l24a.m1.1.1.2" xref="alg1.l24a.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l24a.m1.1.1.1" xref="alg1.l24a.m1.1.1.1.cmml"><msub id="alg1.l24a.m1.1.1.1.3" xref="alg1.l24a.m1.1.1.1.3.cmml"><mi id="alg1.l24a.m1.1.1.1.3.2" xref="alg1.l24a.m1.1.1.1.3.2.cmml">Q</mi><msub id="alg1.l24a.m1.1.1.1.3.3" xref="alg1.l24a.m1.1.1.1.3.3.cmml"><mi id="alg1.l24a.m1.1.1.1.3.3.2" xref="alg1.l24a.m1.1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l24a.m1.1.1.1.3.3.3" xref="alg1.l24a.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l24a.m1.1.1.1.2" xref="alg1.l24a.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l24a.m1.1.1.1.1.1" xref="alg1.l24a.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l24a.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l24a.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l24a.m1.1.1.1.1.1.1" xref="alg1.l24a.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l24a.m1.1.1.1.1.1.1.2" xref="alg1.l24a.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l24a.m1.1.1.1.1.1.1.3" xref="alg1.l24a.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l24a.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l24a.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24a.m1.1b"><apply id="alg1.l24a.m1.1.1.cmml" xref="alg1.l24a.m1.1.1"><csymbol cd="latexml" id="alg1.l24a.m1.1.1.2.cmml" xref="alg1.l24a.m1.1.1.2">similar-to</csymbol><apply id="alg1.l24a.m1.1.1.3.cmml" xref="alg1.l24a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24a.m1.1.1.3.1.cmml" xref="alg1.l24a.m1.1.1.3">subscript</csymbol><apply id="alg1.l24a.m1.1.1.3.2.cmml" xref="alg1.l24a.m1.1.1.3.2"><ci id="alg1.l24a.m1.1.1.3.2.1.cmml" xref="alg1.l24a.m1.1.1.3.2.1">~</ci><ci id="alg1.l24a.m1.1.1.3.2.2.cmml" xref="alg1.l24a.m1.1.1.3.2.2">𝑠</ci></apply><ci id="alg1.l24a.m1.1.1.3.3.cmml" xref="alg1.l24a.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l24a.m1.1.1.1.cmml" xref="alg1.l24a.m1.1.1.1"><times id="alg1.l24a.m1.1.1.1.2.cmml" xref="alg1.l24a.m1.1.1.1.2"></times><apply id="alg1.l24a.m1.1.1.1.3.cmml" xref="alg1.l24a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24a.m1.1.1.1.3.1.cmml" xref="alg1.l24a.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l24a.m1.1.1.1.3.2.cmml" xref="alg1.l24a.m1.1.1.1.3.2">𝑄</ci><apply id="alg1.l24a.m1.1.1.1.3.3.cmml" xref="alg1.l24a.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l24a.m1.1.1.1.3.3.1.cmml" xref="alg1.l24a.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l24a.m1.1.1.1.3.3.2.cmml" xref="alg1.l24a.m1.1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l24a.m1.1.1.1.3.3.3.cmml" xref="alg1.l24a.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l24a.m1.1.1.1.1.1.1.cmml" xref="alg1.l24a.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24a.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l24a.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l24a.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l24a.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l24a.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l24a.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24a.m1.1c">\tilde{s}_{i}\sim Q_{\phi_{s}}(s_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l24a.m1.1d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l25a"> Compute <math alttext="\mu,\sigma\leftarrow{P}_{\theta_{s}}({s}_{i+H}|\tilde{s}_{i},\hat{\pi})" class="ltx_Math" display="inline" id="alg1.l25a.m1.4"><semantics id="alg1.l25a.m1.4a"><mrow id="alg1.l25a.m1.4.4" xref="alg1.l25a.m1.4.4.cmml"><mrow id="alg1.l25a.m1.4.4.3.2" xref="alg1.l25a.m1.4.4.3.1.cmml"><mi id="alg1.l25a.m1.2.2" xref="alg1.l25a.m1.2.2.cmml">μ</mi><mo id="alg1.l25a.m1.4.4.3.2.1" xref="alg1.l25a.m1.4.4.3.1.cmml">,</mo><mi id="alg1.l25a.m1.3.3" xref="alg1.l25a.m1.3.3.cmml">σ</mi></mrow><mo id="alg1.l25a.m1.4.4.2" stretchy="false" xref="alg1.l25a.m1.4.4.2.cmml">←</mo><mrow id="alg1.l25a.m1.4.4.1" xref="alg1.l25a.m1.4.4.1.cmml"><msub id="alg1.l25a.m1.4.4.1.3" xref="alg1.l25a.m1.4.4.1.3.cmml"><mi id="alg1.l25a.m1.4.4.1.3.2" xref="alg1.l25a.m1.4.4.1.3.2.cmml">P</mi><msub id="alg1.l25a.m1.4.4.1.3.3" xref="alg1.l25a.m1.4.4.1.3.3.cmml"><mi id="alg1.l25a.m1.4.4.1.3.3.2" xref="alg1.l25a.m1.4.4.1.3.3.2.cmml">θ</mi><mi id="alg1.l25a.m1.4.4.1.3.3.3" xref="alg1.l25a.m1.4.4.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l25a.m1.4.4.1.2" xref="alg1.l25a.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l25a.m1.4.4.1.1.1" xref="alg1.l25a.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l25a.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l25a.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="alg1.l25a.m1.4.4.1.1.1.1" xref="alg1.l25a.m1.4.4.1.1.1.1.cmml"><msub id="alg1.l25a.m1.4.4.1.1.1.1.3" xref="alg1.l25a.m1.4.4.1.1.1.1.3.cmml"><mi id="alg1.l25a.m1.4.4.1.1.1.1.3.2" xref="alg1.l25a.m1.4.4.1.1.1.1.3.2.cmml">s</mi><mrow id="alg1.l25a.m1.4.4.1.1.1.1.3.3" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.cmml"><mi id="alg1.l25a.m1.4.4.1.1.1.1.3.3.2" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l25a.m1.4.4.1.1.1.1.3.3.1" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l25a.m1.4.4.1.1.1.1.3.3.3" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l25a.m1.4.4.1.1.1.1.2" xref="alg1.l25a.m1.4.4.1.1.1.1.2.cmml">|</mo><mrow id="alg1.l25a.m1.4.4.1.1.1.1.1.1" xref="alg1.l25a.m1.4.4.1.1.1.1.1.2.cmml"><msub id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.2" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.1" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.3" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l25a.m1.4.4.1.1.1.1.1.1.2" xref="alg1.l25a.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="alg1.l25a.m1.1.1" xref="alg1.l25a.m1.1.1.cmml"><mi id="alg1.l25a.m1.1.1.2" xref="alg1.l25a.m1.1.1.2.cmml">π</mi><mo id="alg1.l25a.m1.1.1.1" xref="alg1.l25a.m1.1.1.1.cmml">^</mo></mover></mrow></mrow><mo id="alg1.l25a.m1.4.4.1.1.1.3" stretchy="false" xref="alg1.l25a.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25a.m1.4b"><apply id="alg1.l25a.m1.4.4.cmml" xref="alg1.l25a.m1.4.4"><ci id="alg1.l25a.m1.4.4.2.cmml" xref="alg1.l25a.m1.4.4.2">←</ci><list id="alg1.l25a.m1.4.4.3.1.cmml" xref="alg1.l25a.m1.4.4.3.2"><ci id="alg1.l25a.m1.2.2.cmml" xref="alg1.l25a.m1.2.2">𝜇</ci><ci id="alg1.l25a.m1.3.3.cmml" xref="alg1.l25a.m1.3.3">𝜎</ci></list><apply id="alg1.l25a.m1.4.4.1.cmml" xref="alg1.l25a.m1.4.4.1"><times id="alg1.l25a.m1.4.4.1.2.cmml" xref="alg1.l25a.m1.4.4.1.2"></times><apply id="alg1.l25a.m1.4.4.1.3.cmml" xref="alg1.l25a.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l25a.m1.4.4.1.3.1.cmml" xref="alg1.l25a.m1.4.4.1.3">subscript</csymbol><ci id="alg1.l25a.m1.4.4.1.3.2.cmml" xref="alg1.l25a.m1.4.4.1.3.2">𝑃</ci><apply id="alg1.l25a.m1.4.4.1.3.3.cmml" xref="alg1.l25a.m1.4.4.1.3.3"><csymbol cd="ambiguous" id="alg1.l25a.m1.4.4.1.3.3.1.cmml" xref="alg1.l25a.m1.4.4.1.3.3">subscript</csymbol><ci id="alg1.l25a.m1.4.4.1.3.3.2.cmml" xref="alg1.l25a.m1.4.4.1.3.3.2">𝜃</ci><ci id="alg1.l25a.m1.4.4.1.3.3.3.cmml" xref="alg1.l25a.m1.4.4.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l25a.m1.4.4.1.1.1.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1"><csymbol cd="latexml" id="alg1.l25a.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.2">conditional</csymbol><apply id="alg1.l25a.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25a.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="alg1.l25a.m1.4.4.1.1.1.1.3.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3.2">𝑠</ci><apply id="alg1.l25a.m1.4.4.1.1.1.1.3.3.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3"><plus id="alg1.l25a.m1.4.4.1.1.1.1.3.3.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.1"></plus><ci id="alg1.l25a.m1.4.4.1.1.1.1.3.3.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.2">𝑖</ci><ci id="alg1.l25a.m1.4.4.1.1.1.1.3.3.3.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.3.3.3">𝐻</ci></apply></apply><list id="alg1.l25a.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1"><apply id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2"><ci id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l25a.m1.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l25a.m1.1.1.cmml" xref="alg1.l25a.m1.1.1"><ci id="alg1.l25a.m1.1.1.1.cmml" xref="alg1.l25a.m1.1.1.1">^</ci><ci id="alg1.l25a.m1.1.1.2.cmml" xref="alg1.l25a.m1.1.1.2">𝜋</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25a.m1.4c">\mu,\sigma\leftarrow{P}_{\theta_{s}}({s}_{i+H}|\tilde{s}_{i},\hat{\pi})</annotation><annotation encoding="application/x-llamapun" id="alg1.l25a.m1.4d">italic_μ , italic_σ ← italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over^ start_ARG italic_π end_ARG )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26a"> Compute <math alttext="{Q}_{\phi_{s}}(\tilde{s}_{i+H})" class="ltx_Math" display="inline" id="alg1.l26a.m1.1"><semantics id="alg1.l26a.m1.1a"><mrow id="alg1.l26a.m1.1.1" xref="alg1.l26a.m1.1.1.cmml"><msub id="alg1.l26a.m1.1.1.3" xref="alg1.l26a.m1.1.1.3.cmml"><mi id="alg1.l26a.m1.1.1.3.2" xref="alg1.l26a.m1.1.1.3.2.cmml">Q</mi><msub id="alg1.l26a.m1.1.1.3.3" xref="alg1.l26a.m1.1.1.3.3.cmml"><mi id="alg1.l26a.m1.1.1.3.3.2" xref="alg1.l26a.m1.1.1.3.3.2.cmml">ϕ</mi><mi id="alg1.l26a.m1.1.1.3.3.3" xref="alg1.l26a.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l26a.m1.1.1.2" xref="alg1.l26a.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l26a.m1.1.1.1.1" xref="alg1.l26a.m1.1.1.1.1.1.cmml"><mo id="alg1.l26a.m1.1.1.1.1.2" stretchy="false" xref="alg1.l26a.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l26a.m1.1.1.1.1.1" xref="alg1.l26a.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l26a.m1.1.1.1.1.1.2" xref="alg1.l26a.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l26a.m1.1.1.1.1.1.2.2" xref="alg1.l26a.m1.1.1.1.1.1.2.2.cmml">s</mi><mo id="alg1.l26a.m1.1.1.1.1.1.2.1" xref="alg1.l26a.m1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l26a.m1.1.1.1.1.1.3" xref="alg1.l26a.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l26a.m1.1.1.1.1.1.3.2" xref="alg1.l26a.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l26a.m1.1.1.1.1.1.3.1" xref="alg1.l26a.m1.1.1.1.1.1.3.1.cmml">+</mo><mi id="alg1.l26a.m1.1.1.1.1.1.3.3" xref="alg1.l26a.m1.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l26a.m1.1.1.1.1.3" stretchy="false" xref="alg1.l26a.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26a.m1.1b"><apply id="alg1.l26a.m1.1.1.cmml" xref="alg1.l26a.m1.1.1"><times id="alg1.l26a.m1.1.1.2.cmml" xref="alg1.l26a.m1.1.1.2"></times><apply id="alg1.l26a.m1.1.1.3.cmml" xref="alg1.l26a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26a.m1.1.1.3.1.cmml" xref="alg1.l26a.m1.1.1.3">subscript</csymbol><ci id="alg1.l26a.m1.1.1.3.2.cmml" xref="alg1.l26a.m1.1.1.3.2">𝑄</ci><apply id="alg1.l26a.m1.1.1.3.3.cmml" xref="alg1.l26a.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l26a.m1.1.1.3.3.1.cmml" xref="alg1.l26a.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l26a.m1.1.1.3.3.2.cmml" xref="alg1.l26a.m1.1.1.3.3.2">italic-ϕ</ci><ci id="alg1.l26a.m1.1.1.3.3.3.cmml" xref="alg1.l26a.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l26a.m1.1.1.1.1.1.cmml" xref="alg1.l26a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l26a.m1.1.1.1.1.1.1.cmml" xref="alg1.l26a.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l26a.m1.1.1.1.1.1.2.cmml" xref="alg1.l26a.m1.1.1.1.1.1.2"><ci id="alg1.l26a.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l26a.m1.1.1.1.1.1.2.1">~</ci><ci id="alg1.l26a.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l26a.m1.1.1.1.1.1.2.2">𝑠</ci></apply><apply id="alg1.l26a.m1.1.1.1.1.1.3.cmml" xref="alg1.l26a.m1.1.1.1.1.1.3"><plus id="alg1.l26a.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l26a.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l26a.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l26a.m1.1.1.1.1.1.3.2">𝑖</ci><ci id="alg1.l26a.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l26a.m1.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26a.m1.1c">{Q}_{\phi_{s}}(\tilde{s}_{i+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l26a.m1.1d">italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\tilde{o}_{i+H}" class="ltx_Math" display="inline" id="alg1.l26a.m2.1"><semantics id="alg1.l26a.m2.1a"><msub id="alg1.l26a.m2.1.1" xref="alg1.l26a.m2.1.1.cmml"><mover accent="true" id="alg1.l26a.m2.1.1.2" xref="alg1.l26a.m2.1.1.2.cmml"><mi id="alg1.l26a.m2.1.1.2.2" xref="alg1.l26a.m2.1.1.2.2.cmml">o</mi><mo id="alg1.l26a.m2.1.1.2.1" xref="alg1.l26a.m2.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l26a.m2.1.1.3" xref="alg1.l26a.m2.1.1.3.cmml"><mi id="alg1.l26a.m2.1.1.3.2" xref="alg1.l26a.m2.1.1.3.2.cmml">i</mi><mo id="alg1.l26a.m2.1.1.3.1" xref="alg1.l26a.m2.1.1.3.1.cmml">+</mo><mi id="alg1.l26a.m2.1.1.3.3" xref="alg1.l26a.m2.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l26a.m2.1b"><apply id="alg1.l26a.m2.1.1.cmml" xref="alg1.l26a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l26a.m2.1.1.1.cmml" xref="alg1.l26a.m2.1.1">subscript</csymbol><apply id="alg1.l26a.m2.1.1.2.cmml" xref="alg1.l26a.m2.1.1.2"><ci id="alg1.l26a.m2.1.1.2.1.cmml" xref="alg1.l26a.m2.1.1.2.1">~</ci><ci id="alg1.l26a.m2.1.1.2.2.cmml" xref="alg1.l26a.m2.1.1.2.2">𝑜</ci></apply><apply id="alg1.l26a.m2.1.1.3.cmml" xref="alg1.l26a.m2.1.1.3"><plus id="alg1.l26a.m2.1.1.3.1.cmml" xref="alg1.l26a.m2.1.1.3.1"></plus><ci id="alg1.l26a.m2.1.1.3.2.cmml" xref="alg1.l26a.m2.1.1.3.2">𝑖</ci><ci id="alg1.l26a.m2.1.1.3.3.cmml" xref="alg1.l26a.m2.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26a.m2.1c">\tilde{o}_{i+H}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26a.m2.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l27a"> Compute <math alttext="{\mu}^{\prime},{\sigma}^{\prime}\leftarrow{Q}_{\phi_{s}}(\tilde{s}_{i+H})" class="ltx_Math" display="inline" id="alg1.l27a.m1.3"><semantics id="alg1.l27a.m1.3a"><mrow id="alg1.l27a.m1.3.3" xref="alg1.l27a.m1.3.3.cmml"><mrow id="alg1.l27a.m1.2.2.2.2" xref="alg1.l27a.m1.2.2.2.3.cmml"><msup id="alg1.l27a.m1.1.1.1.1.1" xref="alg1.l27a.m1.1.1.1.1.1.cmml"><mi id="alg1.l27a.m1.1.1.1.1.1.2" xref="alg1.l27a.m1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l27a.m1.1.1.1.1.1.3" xref="alg1.l27a.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l27a.m1.2.2.2.2.3" xref="alg1.l27a.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l27a.m1.2.2.2.2.2" xref="alg1.l27a.m1.2.2.2.2.2.cmml"><mi id="alg1.l27a.m1.2.2.2.2.2.2" xref="alg1.l27a.m1.2.2.2.2.2.2.cmml">σ</mi><mo id="alg1.l27a.m1.2.2.2.2.2.3" xref="alg1.l27a.m1.2.2.2.2.2.3.cmml">′</mo></msup></mrow><mo id="alg1.l27a.m1.3.3.4" stretchy="false" xref="alg1.l27a.m1.3.3.4.cmml">←</mo><mrow id="alg1.l27a.m1.3.3.3" xref="alg1.l27a.m1.3.3.3.cmml"><msub id="alg1.l27a.m1.3.3.3.3" xref="alg1.l27a.m1.3.3.3.3.cmml"><mi id="alg1.l27a.m1.3.3.3.3.2" xref="alg1.l27a.m1.3.3.3.3.2.cmml">Q</mi><msub id="alg1.l27a.m1.3.3.3.3.3" xref="alg1.l27a.m1.3.3.3.3.3.cmml"><mi id="alg1.l27a.m1.3.3.3.3.3.2" xref="alg1.l27a.m1.3.3.3.3.3.2.cmml">ϕ</mi><mi id="alg1.l27a.m1.3.3.3.3.3.3" xref="alg1.l27a.m1.3.3.3.3.3.3.cmml">s</mi></msub></msub><mo id="alg1.l27a.m1.3.3.3.2" xref="alg1.l27a.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l27a.m1.3.3.3.1.1" xref="alg1.l27a.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l27a.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l27a.m1.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l27a.m1.3.3.3.1.1.1" xref="alg1.l27a.m1.3.3.3.1.1.1.cmml"><mover accent="true" id="alg1.l27a.m1.3.3.3.1.1.1.2" xref="alg1.l27a.m1.3.3.3.1.1.1.2.cmml"><mi id="alg1.l27a.m1.3.3.3.1.1.1.2.2" xref="alg1.l27a.m1.3.3.3.1.1.1.2.2.cmml">s</mi><mo id="alg1.l27a.m1.3.3.3.1.1.1.2.1" xref="alg1.l27a.m1.3.3.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l27a.m1.3.3.3.1.1.1.3" xref="alg1.l27a.m1.3.3.3.1.1.1.3.cmml"><mi id="alg1.l27a.m1.3.3.3.1.1.1.3.2" xref="alg1.l27a.m1.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="alg1.l27a.m1.3.3.3.1.1.1.3.1" xref="alg1.l27a.m1.3.3.3.1.1.1.3.1.cmml">+</mo><mi id="alg1.l27a.m1.3.3.3.1.1.1.3.3" xref="alg1.l27a.m1.3.3.3.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l27a.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l27a.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27a.m1.3b"><apply id="alg1.l27a.m1.3.3.cmml" xref="alg1.l27a.m1.3.3"><ci id="alg1.l27a.m1.3.3.4.cmml" xref="alg1.l27a.m1.3.3.4">←</ci><list id="alg1.l27a.m1.2.2.2.3.cmml" xref="alg1.l27a.m1.2.2.2.2"><apply id="alg1.l27a.m1.1.1.1.1.1.cmml" xref="alg1.l27a.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l27a.m1.1.1.1.1.1.1.cmml" xref="alg1.l27a.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l27a.m1.1.1.1.1.1.2.cmml" xref="alg1.l27a.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l27a.m1.1.1.1.1.1.3.cmml" xref="alg1.l27a.m1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l27a.m1.2.2.2.2.2.cmml" xref="alg1.l27a.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l27a.m1.2.2.2.2.2.1.cmml" xref="alg1.l27a.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l27a.m1.2.2.2.2.2.2.cmml" xref="alg1.l27a.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l27a.m1.2.2.2.2.2.3.cmml" xref="alg1.l27a.m1.2.2.2.2.2.3">′</ci></apply></list><apply id="alg1.l27a.m1.3.3.3.cmml" xref="alg1.l27a.m1.3.3.3"><times id="alg1.l27a.m1.3.3.3.2.cmml" xref="alg1.l27a.m1.3.3.3.2"></times><apply id="alg1.l27a.m1.3.3.3.3.cmml" xref="alg1.l27a.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l27a.m1.3.3.3.3.1.cmml" xref="alg1.l27a.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l27a.m1.3.3.3.3.2.cmml" xref="alg1.l27a.m1.3.3.3.3.2">𝑄</ci><apply id="alg1.l27a.m1.3.3.3.3.3.cmml" xref="alg1.l27a.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l27a.m1.3.3.3.3.3.1.cmml" xref="alg1.l27a.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l27a.m1.3.3.3.3.3.2.cmml" xref="alg1.l27a.m1.3.3.3.3.3.2">italic-ϕ</ci><ci id="alg1.l27a.m1.3.3.3.3.3.3.cmml" xref="alg1.l27a.m1.3.3.3.3.3.3">𝑠</ci></apply></apply><apply id="alg1.l27a.m1.3.3.3.1.1.1.cmml" xref="alg1.l27a.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l27a.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l27a.m1.3.3.3.1.1">subscript</csymbol><apply id="alg1.l27a.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.2"><ci id="alg1.l27a.m1.3.3.3.1.1.1.2.1.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.2.1">~</ci><ci id="alg1.l27a.m1.3.3.3.1.1.1.2.2.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.2.2">𝑠</ci></apply><apply id="alg1.l27a.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.3"><plus id="alg1.l27a.m1.3.3.3.1.1.1.3.1.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.3.1"></plus><ci id="alg1.l27a.m1.3.3.3.1.1.1.3.2.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.3.2">𝑖</ci><ci id="alg1.l27a.m1.3.3.3.1.1.1.3.3.cmml" xref="alg1.l27a.m1.3.3.3.1.1.1.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27a.m1.3c">{\mu}^{\prime},{\sigma}^{\prime}\leftarrow{Q}_{\phi_{s}}(\tilde{s}_{i+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l27a.m1.3d">italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_Q start_POSTSUBSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l28a"> Sample <math alttext="\tilde{s}_{i+H}\sim\mathcal{N}({\mu},{\sigma}^{2})" class="ltx_Math" display="inline" id="alg1.l28a.m1.2"><semantics id="alg1.l28a.m1.2a"><mrow id="alg1.l28a.m1.2.2" xref="alg1.l28a.m1.2.2.cmml"><msub id="alg1.l28a.m1.2.2.3" xref="alg1.l28a.m1.2.2.3.cmml"><mover accent="true" id="alg1.l28a.m1.2.2.3.2" xref="alg1.l28a.m1.2.2.3.2.cmml"><mi id="alg1.l28a.m1.2.2.3.2.2" xref="alg1.l28a.m1.2.2.3.2.2.cmml">s</mi><mo id="alg1.l28a.m1.2.2.3.2.1" xref="alg1.l28a.m1.2.2.3.2.1.cmml">~</mo></mover><mrow id="alg1.l28a.m1.2.2.3.3" xref="alg1.l28a.m1.2.2.3.3.cmml"><mi id="alg1.l28a.m1.2.2.3.3.2" xref="alg1.l28a.m1.2.2.3.3.2.cmml">i</mi><mo id="alg1.l28a.m1.2.2.3.3.1" xref="alg1.l28a.m1.2.2.3.3.1.cmml">+</mo><mi id="alg1.l28a.m1.2.2.3.3.3" xref="alg1.l28a.m1.2.2.3.3.3.cmml">H</mi></mrow></msub><mo id="alg1.l28a.m1.2.2.2" xref="alg1.l28a.m1.2.2.2.cmml">∼</mo><mrow id="alg1.l28a.m1.2.2.1" xref="alg1.l28a.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28a.m1.2.2.1.3" xref="alg1.l28a.m1.2.2.1.3.cmml">𝒩</mi><mo id="alg1.l28a.m1.2.2.1.2" xref="alg1.l28a.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l28a.m1.2.2.1.1.1" xref="alg1.l28a.m1.2.2.1.1.2.cmml"><mo id="alg1.l28a.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l28a.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l28a.m1.1.1" xref="alg1.l28a.m1.1.1.cmml">μ</mi><mo id="alg1.l28a.m1.2.2.1.1.1.3" xref="alg1.l28a.m1.2.2.1.1.2.cmml">,</mo><msup id="alg1.l28a.m1.2.2.1.1.1.1" xref="alg1.l28a.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l28a.m1.2.2.1.1.1.1.2" xref="alg1.l28a.m1.2.2.1.1.1.1.2.cmml">σ</mi><mn id="alg1.l28a.m1.2.2.1.1.1.1.3" xref="alg1.l28a.m1.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="alg1.l28a.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l28a.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28a.m1.2b"><apply id="alg1.l28a.m1.2.2.cmml" xref="alg1.l28a.m1.2.2"><csymbol cd="latexml" id="alg1.l28a.m1.2.2.2.cmml" xref="alg1.l28a.m1.2.2.2">similar-to</csymbol><apply id="alg1.l28a.m1.2.2.3.cmml" xref="alg1.l28a.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l28a.m1.2.2.3.1.cmml" xref="alg1.l28a.m1.2.2.3">subscript</csymbol><apply id="alg1.l28a.m1.2.2.3.2.cmml" xref="alg1.l28a.m1.2.2.3.2"><ci id="alg1.l28a.m1.2.2.3.2.1.cmml" xref="alg1.l28a.m1.2.2.3.2.1">~</ci><ci id="alg1.l28a.m1.2.2.3.2.2.cmml" xref="alg1.l28a.m1.2.2.3.2.2">𝑠</ci></apply><apply id="alg1.l28a.m1.2.2.3.3.cmml" xref="alg1.l28a.m1.2.2.3.3"><plus id="alg1.l28a.m1.2.2.3.3.1.cmml" xref="alg1.l28a.m1.2.2.3.3.1"></plus><ci id="alg1.l28a.m1.2.2.3.3.2.cmml" xref="alg1.l28a.m1.2.2.3.3.2">𝑖</ci><ci id="alg1.l28a.m1.2.2.3.3.3.cmml" xref="alg1.l28a.m1.2.2.3.3.3">𝐻</ci></apply></apply><apply id="alg1.l28a.m1.2.2.1.cmml" xref="alg1.l28a.m1.2.2.1"><times id="alg1.l28a.m1.2.2.1.2.cmml" xref="alg1.l28a.m1.2.2.1.2"></times><ci id="alg1.l28a.m1.2.2.1.3.cmml" xref="alg1.l28a.m1.2.2.1.3">𝒩</ci><interval closure="open" id="alg1.l28a.m1.2.2.1.1.2.cmml" xref="alg1.l28a.m1.2.2.1.1.1"><ci id="alg1.l28a.m1.1.1.cmml" xref="alg1.l28a.m1.1.1">𝜇</ci><apply id="alg1.l28a.m1.2.2.1.1.1.1.cmml" xref="alg1.l28a.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28a.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l28a.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l28a.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l28a.m1.2.2.1.1.1.1.2">𝜎</ci><cn id="alg1.l28a.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l28a.m1.2.2.1.1.1.1.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28a.m1.2c">\tilde{s}_{i+H}\sim\mathcal{N}({\mu},{\sigma}^{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l28a.m1.2d">over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT ∼ caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l29a"> Compute <math alttext="{P}_{\theta_{o}}({o}_{i+H}|\tilde{s}_{i+H})" class="ltx_Math" display="inline" id="alg1.l29a.m1.1"><semantics id="alg1.l29a.m1.1a"><mrow id="alg1.l29a.m1.1.1" xref="alg1.l29a.m1.1.1.cmml"><msub id="alg1.l29a.m1.1.1.3" xref="alg1.l29a.m1.1.1.3.cmml"><mi id="alg1.l29a.m1.1.1.3.2" xref="alg1.l29a.m1.1.1.3.2.cmml">P</mi><msub id="alg1.l29a.m1.1.1.3.3" xref="alg1.l29a.m1.1.1.3.3.cmml"><mi id="alg1.l29a.m1.1.1.3.3.2" xref="alg1.l29a.m1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l29a.m1.1.1.3.3.3" xref="alg1.l29a.m1.1.1.3.3.3.cmml">o</mi></msub></msub><mo id="alg1.l29a.m1.1.1.2" xref="alg1.l29a.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l29a.m1.1.1.1.1" xref="alg1.l29a.m1.1.1.1.1.1.cmml"><mo id="alg1.l29a.m1.1.1.1.1.2" stretchy="false" xref="alg1.l29a.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l29a.m1.1.1.1.1.1" xref="alg1.l29a.m1.1.1.1.1.1.cmml"><msub id="alg1.l29a.m1.1.1.1.1.1.2" xref="alg1.l29a.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l29a.m1.1.1.1.1.1.2.2" xref="alg1.l29a.m1.1.1.1.1.1.2.2.cmml">o</mi><mrow id="alg1.l29a.m1.1.1.1.1.1.2.3" xref="alg1.l29a.m1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l29a.m1.1.1.1.1.1.2.3.2" xref="alg1.l29a.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="alg1.l29a.m1.1.1.1.1.1.2.3.1" xref="alg1.l29a.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="alg1.l29a.m1.1.1.1.1.1.2.3.3" xref="alg1.l29a.m1.1.1.1.1.1.2.3.3.cmml">H</mi></mrow></msub><mo fence="false" id="alg1.l29a.m1.1.1.1.1.1.1" xref="alg1.l29a.m1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l29a.m1.1.1.1.1.1.3" xref="alg1.l29a.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l29a.m1.1.1.1.1.1.3.2" xref="alg1.l29a.m1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l29a.m1.1.1.1.1.1.3.2.2" xref="alg1.l29a.m1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="alg1.l29a.m1.1.1.1.1.1.3.2.1" xref="alg1.l29a.m1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l29a.m1.1.1.1.1.1.3.3" xref="alg1.l29a.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l29a.m1.1.1.1.1.1.3.3.2" xref="alg1.l29a.m1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l29a.m1.1.1.1.1.1.3.3.1" xref="alg1.l29a.m1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="alg1.l29a.m1.1.1.1.1.1.3.3.3" xref="alg1.l29a.m1.1.1.1.1.1.3.3.3.cmml">H</mi></mrow></msub></mrow><mo id="alg1.l29a.m1.1.1.1.1.3" stretchy="false" xref="alg1.l29a.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29a.m1.1b"><apply id="alg1.l29a.m1.1.1.cmml" xref="alg1.l29a.m1.1.1"><times id="alg1.l29a.m1.1.1.2.cmml" xref="alg1.l29a.m1.1.1.2"></times><apply id="alg1.l29a.m1.1.1.3.cmml" xref="alg1.l29a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29a.m1.1.1.3.1.cmml" xref="alg1.l29a.m1.1.1.3">subscript</csymbol><ci id="alg1.l29a.m1.1.1.3.2.cmml" xref="alg1.l29a.m1.1.1.3.2">𝑃</ci><apply id="alg1.l29a.m1.1.1.3.3.cmml" xref="alg1.l29a.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29a.m1.1.1.3.3.1.cmml" xref="alg1.l29a.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l29a.m1.1.1.3.3.2.cmml" xref="alg1.l29a.m1.1.1.3.3.2">𝜃</ci><ci id="alg1.l29a.m1.1.1.3.3.3.cmml" xref="alg1.l29a.m1.1.1.3.3.3">𝑜</ci></apply></apply><apply id="alg1.l29a.m1.1.1.1.1.1.cmml" xref="alg1.l29a.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l29a.m1.1.1.1.1.1.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l29a.m1.1.1.1.1.1.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29a.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l29a.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2.2">𝑜</ci><apply id="alg1.l29a.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2.3"><plus id="alg1.l29a.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2.3.1"></plus><ci id="alg1.l29a.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="alg1.l29a.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l29a.m1.1.1.1.1.1.2.3.3">𝐻</ci></apply></apply><apply id="alg1.l29a.m1.1.1.1.1.1.3.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29a.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l29a.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.2"><ci id="alg1.l29a.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l29a.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.2.2">𝑠</ci></apply><apply id="alg1.l29a.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.3"><plus id="alg1.l29a.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l29a.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="alg1.l29a.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l29a.m1.1.1.1.1.1.3.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29a.m1.1c">{P}_{\theta_{o}}({o}_{i+H}|\tilde{s}_{i+H})</annotation><annotation encoding="application/x-llamapun" id="alg1.l29a.m1.1d">italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT | over~ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
</div>
</div>
</div>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Most existing AIF agents have shown effectiveness across a range of tasks typically performed by biological agents, such as humans and animals. These tasks often involve image-based observations <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>. For example, Fountas et al. (2020) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite> evaluated their agent on Dynamic dSprites <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib52" title="">higgins2016beta </a></cite> and Animal-AI <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib53" title="">crosby2019animal </a></cite>, which biological agents can perform with relative ease. AIF has also been successfully applied in robotics <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib54" title="">lanillos2021active </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib29" title="">da2022active </a></cite>, including object manipulation <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib27" title="">schneider2022active </a></cite>, aligning with behaviors humans naturally perform. This effectiveness is largely attributed to AIF’s grounding in theories of decision-making in biological brains <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib9" title="">parr2022active </a></cite>. However, applying AIF to more complex domains—such as industrial system control—poses significant challenges. Even humans may struggle to design effective policies in these settings. Such environments often exhibit high stochasticity, where short observation trajectories are dominated by noise, making it difficult to optimize free energy for learning and action selection. This issue is less pronounced in world model agents, which often use memory-based (e.g., recurrent) architectures <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a></cite>. Moreover, realistic environments frequently combine discrete and continuous observation modalities, complicating generative and sampling predictions. Delayed feedback and long-horizon requirements further challenge planning under the AIF framework. Additionally, many real-world tasks require rapid, frequent decisions and sustained performance in non-episodic, stochastic settings. To assess our approach, we employ a high-fidelity simulation environment validated to reflect realistic industrial control scenarios <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">LOFFREDO202391 </a></cite>, which incorporates all the above challenges <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Application</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">As energy efficiency becomes increasingly critical in manufacturing <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib56" title="">loffredo2024energy </a></cite>, RL offers a model-free alternative to traditional control, though it may struggle with rapid adaptations in non-stationary environments <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">loffredo2023reinforcement </a></cite>. We focus on simulating workstations in an automotive manufacturing system composed of parallel, identical machines (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1" title="Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">A</span></a> for details). Governed by Poisson processes for arrivals, processing, failures, and repairs <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">LOFFREDO202391 </a></cite>, the system evolves as a discrete-time Markov chain <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib58" title="">ross2014introduction </a></cite>. Control actions—switching machines on or off—aim to improve energy efficiency without compromising throughput. The problem is continual with no terminal state, and decisions rely on both discrete and continuous observations. Due to stochastic delays, the system connects continuous-time dynamics to discrete-time decisions, making performance only observable over long horizons. Accordingly, we employ a window-based preference metric <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">taheri2024active </a></cite> that evaluates KPIs over the past eight hours. The production rate is defined as <math alttext="T=\frac{N(t)-N(t-t_{s})}{t_{s}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.2"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.3" xref="S4.SS1.p1.1.m1.2.3.cmml"><mi id="S4.SS1.p1.1.m1.2.3.2" xref="S4.SS1.p1.1.m1.2.3.2.cmml">T</mi><mo id="S4.SS1.p1.1.m1.2.3.1" xref="S4.SS1.p1.1.m1.2.3.1.cmml">=</mo><mfrac id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml"><mrow id="S4.SS1.p1.1.m1.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.cmml"><mrow id="S4.SS1.p1.1.m1.2.2.2.4" xref="S4.SS1.p1.1.m1.2.2.2.4.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.4.2" xref="S4.SS1.p1.1.m1.2.2.2.4.2.cmml">N</mi><mo id="S4.SS1.p1.1.m1.2.2.2.4.1" xref="S4.SS1.p1.1.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.2.2.2.4.3.2" xref="S4.SS1.p1.1.m1.2.2.2.4.cmml"><mo id="S4.SS1.p1.1.m1.2.2.2.4.3.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.4.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">t</mi><mo id="S4.SS1.p1.1.m1.2.2.2.4.3.2.2" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.4.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.1.m1.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.3.cmml">−</mo><mrow id="S4.SS1.p1.1.m1.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.3.cmml">N</mi><mo id="S4.SS1.p1.1.m1.2.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.2.2.2.2.1.1" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.cmml"><mo id="S4.SS1.p1.1.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.2" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.2.cmml">t</mi><mo id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.1" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.2" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.3" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S4.SS1.p1.1.m1.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><msub id="S4.SS1.p1.1.m1.2.2.4" xref="S4.SS1.p1.1.m1.2.2.4.cmml"><mi id="S4.SS1.p1.1.m1.2.2.4.2" xref="S4.SS1.p1.1.m1.2.2.4.2.cmml">t</mi><mi id="S4.SS1.p1.1.m1.2.2.4.3" xref="S4.SS1.p1.1.m1.2.2.4.3.cmml">s</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><apply id="S4.SS1.p1.1.m1.2.3.cmml" xref="S4.SS1.p1.1.m1.2.3"><eq id="S4.SS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.1"></eq><ci id="S4.SS1.p1.1.m1.2.3.2.cmml" xref="S4.SS1.p1.1.m1.2.3.2">𝑇</ci><apply id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2"><divide id="S4.SS1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2"></divide><apply id="S4.SS1.p1.1.m1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2"><minus id="S4.SS1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.3"></minus><apply id="S4.SS1.p1.1.m1.2.2.2.4.cmml" xref="S4.SS1.p1.1.m1.2.2.2.4"><times id="S4.SS1.p1.1.m1.2.2.2.4.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.4.1"></times><ci id="S4.SS1.p1.1.m1.2.2.2.4.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.4.2">𝑁</ci><ci id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">𝑡</ci></apply><apply id="S4.SS1.p1.1.m1.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><times id="S4.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2"></times><ci id="S4.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3">𝑁</ci><apply id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1"><minus id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.1"></minus><ci id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.2">𝑡</ci><apply id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.2">𝑡</ci><ci id="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply><apply id="S4.SS1.p1.1.m1.2.2.4.cmml" xref="S4.SS1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.4.1.cmml" xref="S4.SS1.p1.1.m1.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.4.2.cmml" xref="S4.SS1.p1.1.m1.2.2.4.2">𝑡</ci><ci id="S4.SS1.p1.1.m1.2.2.4.3.cmml" xref="S4.SS1.p1.1.m1.2.2.4.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">T=\frac{N(t)-N(t-t_{s})}{t_{s}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.2d">italic_T = divide start_ARG italic_N ( italic_t ) - italic_N ( italic_t - italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_ARG start_ARG italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, where <math alttext="N(t)" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml">N</mi><mo id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.1.2.3.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">t</mi><mo id="S4.SS1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><times id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></times><ci id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2">𝑁</ci><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">N(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_N ( italic_t )</annotation></semantics></math> is the number of parts produced, and the energy consumption rate as <math alttext="E=\frac{C(t)-C(t-t_{s})}{t_{s}}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.2"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3" xref="S4.SS1.p1.3.m3.2.3.cmml"><mi id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.2.cmml">E</mi><mo id="S4.SS1.p1.3.m3.2.3.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">=</mo><mfrac id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml"><mrow id="S4.SS1.p1.3.m3.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.cmml"><mrow id="S4.SS1.p1.3.m3.2.2.2.4" xref="S4.SS1.p1.3.m3.2.2.2.4.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.4.2" xref="S4.SS1.p1.3.m3.2.2.2.4.2.cmml">C</mi><mo id="S4.SS1.p1.3.m3.2.2.2.4.1" xref="S4.SS1.p1.3.m3.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.4.3.2" xref="S4.SS1.p1.3.m3.2.2.2.4.cmml"><mo id="S4.SS1.p1.3.m3.2.2.2.4.3.2.1" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.4.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml">t</mi><mo id="S4.SS1.p1.3.m3.2.2.2.4.3.2.2" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.4.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.3.m3.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml">−</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.2.3.cmml">C</mi><mo id="S4.SS1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.2.1.1" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.cmml"><mo id="S4.SS1.p1.3.m3.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.2" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.2.cmml">t</mi><mo id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.1" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.2" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.3" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S4.SS1.p1.3.m3.2.2.2.2.1.1.3" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><msub id="S4.SS1.p1.3.m3.2.2.4" xref="S4.SS1.p1.3.m3.2.2.4.cmml"><mi id="S4.SS1.p1.3.m3.2.2.4.2" xref="S4.SS1.p1.3.m3.2.2.4.2.cmml">t</mi><mi id="S4.SS1.p1.3.m3.2.2.4.3" xref="S4.SS1.p1.3.m3.2.2.4.3.cmml">s</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3"><eq id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.1"></eq><ci id="S4.SS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2">𝐸</ci><apply id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2"><divide id="S4.SS1.p1.3.m3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2"></divide><apply id="S4.SS1.p1.3.m3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2"><minus id="S4.SS1.p1.3.m3.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.3"></minus><apply id="S4.SS1.p1.3.m3.2.2.2.4.cmml" xref="S4.SS1.p1.3.m3.2.2.2.4"><times id="S4.SS1.p1.3.m3.2.2.2.4.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.4.1"></times><ci id="S4.SS1.p1.3.m3.2.2.2.4.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.4.2">𝐶</ci><ci id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">𝑡</ci></apply><apply id="S4.SS1.p1.3.m3.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2"><times id="S4.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2"></times><ci id="S4.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.3">𝐶</ci><apply id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1"><minus id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.1"></minus><ci id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.2">𝑡</ci><apply id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.2">𝑡</ci><ci id="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply><apply id="S4.SS1.p1.3.m3.2.2.4.cmml" xref="S4.SS1.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.4.1.cmml" xref="S4.SS1.p1.3.m3.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.4.2.cmml" xref="S4.SS1.p1.3.m3.2.2.4.2">𝑡</ci><ci id="S4.SS1.p1.3.m3.2.2.4.3.cmml" xref="S4.SS1.p1.3.m3.2.2.4.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">E=\frac{C(t)-C(t-t_{s})}{t_{s}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.2d">italic_E = divide start_ARG italic_C ( italic_t ) - italic_C ( italic_t - italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_ARG start_ARG italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, where <math alttext="C(t)" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.2.cmml">C</mi><mo id="S4.SS1.p1.4.m4.1.2.1" xref="S4.SS1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.4.m4.1.2.3.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><mo id="S4.SS1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">t</mi><mo id="S4.SS1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><times id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1"></times><ci id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2">𝐶</ci><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">C(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_C ( italic_t )</annotation></semantics></math> denotes total energy consumed, with <math alttext="t-t_{s}\approx 8\,\text{hrs}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mrow id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">t</mi><mo id="S4.SS1.p1.5.m5.1.1.2.1" xref="S4.SS1.p1.5.m5.1.1.2.1.cmml">−</mo><msub id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.3.2" xref="S4.SS1.p1.5.m5.1.1.2.3.2.cmml">t</mi><mi id="S4.SS1.p1.5.m5.1.1.2.3.3" xref="S4.SS1.p1.5.m5.1.1.2.3.3.cmml">s</mi></msub></mrow><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">≈</mo><mrow id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mn id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">8</mn><mo id="S4.SS1.p1.5.m5.1.1.3.1" lspace="0.170em" xref="S4.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mtext id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3a.cmml">hrs</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><approx id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></approx><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2"><minus id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.1"></minus><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝑡</ci><apply id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.2">𝑡</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><times id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.1"></times><cn id="S4.SS1.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3.2">8</cn><ci id="S4.SS1.p1.5.m5.1.1.3.3a.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3"><mtext id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">hrs</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">t-t_{s}\approx 8\,\text{hrs}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_t - italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ≈ 8 hrs</annotation></semantics></math>. This window may span thousands of actions, where due to stochasticity and the integral nature of performance, immediate observations are noisy and uninformative. As a result, the AIF agents based on short-horizon EFE planning are not feasible in this setting. By operating directly on raw performance signals rather than handcrafted rewards, the approach enables scalability to domains where reward signals are sparse or expensive. The agent must handle delayed feedback and plan over extended horizons to move the system towards the preferred performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To validate the performance of our agent in the aforementioned environment, we adopted a rigorous evaluation scheme (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A3" title="Appendix C Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">C</span></a> for details) based on Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#alg1" title="Algorithm 1 ‣ 3.2.1 Training &amp; Planning ‣ 3.2 Policy Optimization ‣ 3 Deep Active Inference Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a>. Unlike previous works that used interactions with a batch of environments to improve training efficiency <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">Fountas2020DeepAI </a></cite>, our agent was trained in each epoch by interacting with a single environment instance, reflecting a more challenging setting. The trained agent’s performance was then evaluated across several randomly initialized environments. From these, the best-performing instance was selected for a one-month simulation run to assess energy efficiency and production loss, in comparison to a baseline scenario where no control was applied and machines were continuously active. We also constructed a compositional preference score—analogous to a reward function—based on time-window KPIs for energy consumption and production, serving as an overall indicator of agent performance, which is part of the observation of the agent. To enforce further regularization in the latent space to match a normal distribution, we used a <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.1.1">Sigmoid</em> function in its non-saturated domain. Since we needed to encode the actor function, which is essentially a computational graph <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib50" title="">kofinas2024graph </a></cite>, we adopted a simple, non-parametric mapping <math alttext="\Pi" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS2.p1.1.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">roman_Π</annotation></semantics></math> that concatenates the input with the first hidden and output values. Given its input-output structure and the fact that the model was continuously trained with that, this mapping effectively serves as an approximation of the actor’s neural function (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A2" title="Appendix B Agent ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">B</span></a> for details).</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4">We implemented the agent in the exact production system, using parameters verified to reflect realistic conditions, following the aforementioned scheme. Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a> presents the performance of the agent with an overshooting horizon of <math alttext="H=300" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">H</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐻</ci><cn id="S4.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">H=300</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_H = 300</annotation></semantics></math>. During evaluations after each epoch (100 iterations), the agent improved the preference score of observations (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a>a), which correlates with increased energy efficiency (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a>b). Notably, the EEF of imagined trajectories (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a>c) used for policy updates decreased as the agent learned to control the system. This trend is observed in both the extrinsic and uncertainty components of the EFE. Since policy optimization relies heavily on learning a robust generative model—with the actor integrated within it—the agent gradually improved its predictive capacity and reduced reconstruction error across both continuous (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a>d, preference) and discrete (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F3" title="Figure 3 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">3</span></a>e,f, machine and buffer states) elements of the observation space. While EFE and overall performance eventually stabilized, the generative model continued to improve, indicating that full reconstruction of future observations is not strictly required for effective control. Finally, we then evaluated the trained agent over one month of simulated interaction (10 replications), applying gradient updates every <math alttext="H" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_H</annotation></semantics></math> steps during planning. Loffredo et al. (2023) <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">loffredo2023reinforcement </a></cite> tested model-free RL agents across a reward parameter <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_ϕ</annotation></semantics></math> , with DQN emerging as the top performer. Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.T1" title="Table 1 ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">1</span></a> shows that our DAIF agent outstrips this baseline, raising energy efficiency per production unit by 10.21% <math alttext="\pm" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mo id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">±</annotation></semantics></math> 0.14% while keeping throughput loss negligible.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S4.F3.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.4.2.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.2.1" style="font-size:90%;">The performance of the agent with <math alttext="H=300" class="ltx_Math" display="inline" id="S4.F3.2.1.m1.1"><semantics id="S4.F3.2.1.m1.1b"><mrow id="S4.F3.2.1.m1.1.1" xref="S4.F3.2.1.m1.1.1.cmml"><mi id="S4.F3.2.1.m1.1.1.2" xref="S4.F3.2.1.m1.1.1.2.cmml">H</mi><mo id="S4.F3.2.1.m1.1.1.1" xref="S4.F3.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F3.2.1.m1.1.1.3" xref="S4.F3.2.1.m1.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.2.1.m1.1c"><apply id="S4.F3.2.1.m1.1.1.cmml" xref="S4.F3.2.1.m1.1.1"><eq id="S4.F3.2.1.m1.1.1.1.cmml" xref="S4.F3.2.1.m1.1.1.1"></eq><ci id="S4.F3.2.1.m1.1.1.2.cmml" xref="S4.F3.2.1.m1.1.1.2">𝐻</ci><cn id="S4.F3.2.1.m1.1.1.3.cmml" type="integer" xref="S4.F3.2.1.m1.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.1.m1.1d">H=300</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.1.m1.1e">italic_H = 300</annotation></semantics></math> on the real industrial system.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.17">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1" style="font-size:90%;">Agent(<math alttext="\phi" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">italic_ϕ</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.2.1" style="font-size:90%;">Production Loss [%]</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.3.1" style="font-size:90%;">EN Saving [%]</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.3.3"><span class="ltx_text" id="S4.T1.3.3.3.1" style="font-size:90%;">DQN (0.93)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1"><math alttext="4.82\pm 0.34" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mrow id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mn id="S4.T1.2.2.1.m1.1.1.2" mathsize="90%" xref="S4.T1.2.2.1.m1.1.1.2.cmml">4.82</mn><mo id="S4.T1.2.2.1.m1.1.1.1" mathsize="90%" xref="S4.T1.2.2.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.2.2.1.m1.1.1.3" mathsize="90%" xref="S4.T1.2.2.1.m1.1.1.3.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.2.2.1.m1.1.1.2.cmml" type="float" xref="S4.T1.2.2.1.m1.1.1.2">4.82</cn><cn id="S4.T1.2.2.1.m1.1.1.3.cmml" type="float" xref="S4.T1.2.2.1.m1.1.1.3">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">4.82\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">4.82 ± 0.34</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.2"><math alttext="10.87\pm 0.76" class="ltx_Math" display="inline" id="S4.T1.3.3.2.m1.1"><semantics id="S4.T1.3.3.2.m1.1a"><mrow id="S4.T1.3.3.2.m1.1.1" xref="S4.T1.3.3.2.m1.1.1.cmml"><mn id="S4.T1.3.3.2.m1.1.1.2" mathsize="90%" xref="S4.T1.3.3.2.m1.1.1.2.cmml">10.87</mn><mo id="S4.T1.3.3.2.m1.1.1.1" mathsize="90%" xref="S4.T1.3.3.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.3.3.2.m1.1.1.3" mathsize="90%" xref="S4.T1.3.3.2.m1.1.1.3.cmml">0.76</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.2.m1.1b"><apply id="S4.T1.3.3.2.m1.1.1.cmml" xref="S4.T1.3.3.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.3.3.2.m1.1.1.1.cmml" xref="S4.T1.3.3.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.3.3.2.m1.1.1.2.cmml" type="float" xref="S4.T1.3.3.2.m1.1.1.2">10.87</cn><cn id="S4.T1.3.3.2.m1.1.1.3.cmml" type="float" xref="S4.T1.3.3.2.m1.1.1.3">0.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.2.m1.1c">10.87\pm 0.76</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.2.m1.1d">10.87 ± 0.76</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.5.5.3"><span class="ltx_text" id="S4.T1.5.5.3.1" style="font-size:90%;">DQN (0.94)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.1"><math alttext="3.34\pm 0.23" class="ltx_Math" display="inline" id="S4.T1.4.4.1.m1.1"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml"><mn id="S4.T1.4.4.1.m1.1.1.2" mathsize="90%" xref="S4.T1.4.4.1.m1.1.1.2.cmml">3.34</mn><mo id="S4.T1.4.4.1.m1.1.1.1" mathsize="90%" xref="S4.T1.4.4.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.4.4.1.m1.1.1.3" mathsize="90%" xref="S4.T1.4.4.1.m1.1.1.3.cmml">0.23</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.4.4.1.m1.1.1.2.cmml" type="float" xref="S4.T1.4.4.1.m1.1.1.2">3.34</cn><cn id="S4.T1.4.4.1.m1.1.1.3.cmml" type="float" xref="S4.T1.4.4.1.m1.1.1.3">0.23</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">3.34\pm 0.23</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.1.m1.1d">3.34 ± 0.23</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.2"><math alttext="9.92\pm 0.69" class="ltx_Math" display="inline" id="S4.T1.5.5.2.m1.1"><semantics id="S4.T1.5.5.2.m1.1a"><mrow id="S4.T1.5.5.2.m1.1.1" xref="S4.T1.5.5.2.m1.1.1.cmml"><mn id="S4.T1.5.5.2.m1.1.1.2" mathsize="90%" xref="S4.T1.5.5.2.m1.1.1.2.cmml">9.92</mn><mo id="S4.T1.5.5.2.m1.1.1.1" mathsize="90%" xref="S4.T1.5.5.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.5.5.2.m1.1.1.3" mathsize="90%" xref="S4.T1.5.5.2.m1.1.1.3.cmml">0.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.2.m1.1b"><apply id="S4.T1.5.5.2.m1.1.1.cmml" xref="S4.T1.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.5.5.2.m1.1.1.1.cmml" xref="S4.T1.5.5.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T1.5.5.2.m1.1.1.2">9.92</cn><cn id="S4.T1.5.5.2.m1.1.1.3.cmml" type="float" xref="S4.T1.5.5.2.m1.1.1.3">0.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.2.m1.1c">9.92\pm 0.69</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.2.m1.1d">9.92 ± 0.69</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.7.7.3"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.3.1" style="font-size:90%;">DAIF</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.1"><math alttext="\mathbf{2.59\pm 0.16}" class="ltx_Math" display="inline" id="S4.T1.6.6.1.m1.1"><semantics id="S4.T1.6.6.1.m1.1a"><mrow id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S4.T1.6.6.1.m1.1.1.2" mathsize="90%" mathvariant="bold" xref="S4.T1.6.6.1.m1.1.1.2.cmml">2.59</mn><mo id="S4.T1.6.6.1.m1.1.1.1" mathsize="90%" xref="S4.T1.6.6.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" id="S4.T1.6.6.1.m1.1.1.3" mathsize="90%" mathvariant="bold" xref="S4.T1.6.6.1.m1.1.1.3.cmml">0.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.6.6.1.m1.1.1.2.cmml" type="float" xref="S4.T1.6.6.1.m1.1.1.2">2.59</cn><cn id="S4.T1.6.6.1.m1.1.1.3.cmml" type="float" xref="S4.T1.6.6.1.m1.1.1.3">0.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">\mathbf{2.59\pm 0.16}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.1.m1.1d">bold_2.59 ± bold_0.16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.7.2"><math alttext="\mathbf{12.49\pm 0.04}" class="ltx_Math" display="inline" id="S4.T1.7.7.2.m1.1"><semantics id="S4.T1.7.7.2.m1.1a"><mrow id="S4.T1.7.7.2.m1.1.1" xref="S4.T1.7.7.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S4.T1.7.7.2.m1.1.1.2" mathsize="90%" mathvariant="bold" xref="S4.T1.7.7.2.m1.1.1.2.cmml">12.49</mn><mo id="S4.T1.7.7.2.m1.1.1.1" mathsize="90%" xref="S4.T1.7.7.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" id="S4.T1.7.7.2.m1.1.1.3" mathsize="90%" mathvariant="bold" xref="S4.T1.7.7.2.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.2.m1.1b"><apply id="S4.T1.7.7.2.m1.1.1.cmml" xref="S4.T1.7.7.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.7.7.2.m1.1.1.1.cmml" xref="S4.T1.7.7.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.7.7.2.m1.1.1.2.cmml" type="float" xref="S4.T1.7.7.2.m1.1.1.2">12.49</cn><cn id="S4.T1.7.7.2.m1.1.1.3.cmml" type="float" xref="S4.T1.7.7.2.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.2.m1.1c">\mathbf{12.49\pm 0.04}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.2.m1.1d">bold_12.49 ± bold_0.04</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.9.9.3"><span class="ltx_text" id="S4.T1.9.9.3.1" style="font-size:90%;">DQN (0.95)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.1"><math alttext="1.27\pm 0.05" class="ltx_Math" display="inline" id="S4.T1.8.8.1.m1.1"><semantics id="S4.T1.8.8.1.m1.1a"><mrow id="S4.T1.8.8.1.m1.1.1" xref="S4.T1.8.8.1.m1.1.1.cmml"><mn id="S4.T1.8.8.1.m1.1.1.2" mathsize="90%" xref="S4.T1.8.8.1.m1.1.1.2.cmml">1.27</mn><mo id="S4.T1.8.8.1.m1.1.1.1" mathsize="90%" xref="S4.T1.8.8.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.8.8.1.m1.1.1.3" mathsize="90%" xref="S4.T1.8.8.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.1.m1.1b"><apply id="S4.T1.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.8.8.1.m1.1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.8.8.1.m1.1.1.2.cmml" type="float" xref="S4.T1.8.8.1.m1.1.1.2">1.27</cn><cn id="S4.T1.8.8.1.m1.1.1.3.cmml" type="float" xref="S4.T1.8.8.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.1.m1.1c">1.27\pm 0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.1.m1.1d">1.27 ± 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.9.9.2"><math alttext="7.00\pm 0.07" class="ltx_Math" display="inline" id="S4.T1.9.9.2.m1.1"><semantics id="S4.T1.9.9.2.m1.1a"><mrow id="S4.T1.9.9.2.m1.1.1" xref="S4.T1.9.9.2.m1.1.1.cmml"><mn id="S4.T1.9.9.2.m1.1.1.2" mathsize="90%" xref="S4.T1.9.9.2.m1.1.1.2.cmml">7.00</mn><mo id="S4.T1.9.9.2.m1.1.1.1" mathsize="90%" xref="S4.T1.9.9.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.9.9.2.m1.1.1.3" mathsize="90%" xref="S4.T1.9.9.2.m1.1.1.3.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.2.m1.1b"><apply id="S4.T1.9.9.2.m1.1.1.cmml" xref="S4.T1.9.9.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.9.9.2.m1.1.1.1.cmml" xref="S4.T1.9.9.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.9.9.2.m1.1.1.2.cmml" type="float" xref="S4.T1.9.9.2.m1.1.1.2">7.00</cn><cn id="S4.T1.9.9.2.m1.1.1.3.cmml" type="float" xref="S4.T1.9.9.2.m1.1.1.3">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.2.m1.1c">7.00\pm 0.07</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.2.m1.1d">7.00 ± 0.07</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.11.11.3"><span class="ltx_text" id="S4.T1.11.11.3.1" style="font-size:90%;">DQN (0.96)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.10.10.1"><math alttext="1.27\pm 0.09" class="ltx_Math" display="inline" id="S4.T1.10.10.1.m1.1"><semantics id="S4.T1.10.10.1.m1.1a"><mrow id="S4.T1.10.10.1.m1.1.1" xref="S4.T1.10.10.1.m1.1.1.cmml"><mn id="S4.T1.10.10.1.m1.1.1.2" mathsize="90%" xref="S4.T1.10.10.1.m1.1.1.2.cmml">1.27</mn><mo id="S4.T1.10.10.1.m1.1.1.1" mathsize="90%" xref="S4.T1.10.10.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.10.10.1.m1.1.1.3" mathsize="90%" xref="S4.T1.10.10.1.m1.1.1.3.cmml">0.09</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.1.m1.1b"><apply id="S4.T1.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.10.10.1.m1.1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.10.10.1.m1.1.1.2.cmml" type="float" xref="S4.T1.10.10.1.m1.1.1.2">1.27</cn><cn id="S4.T1.10.10.1.m1.1.1.3.cmml" type="float" xref="S4.T1.10.10.1.m1.1.1.3">0.09</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.1.m1.1c">1.27\pm 0.09</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.10.1.m1.1d">1.27 ± 0.09</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.11.11.2"><math alttext="7.62\pm 0.12" class="ltx_Math" display="inline" id="S4.T1.11.11.2.m1.1"><semantics id="S4.T1.11.11.2.m1.1a"><mrow id="S4.T1.11.11.2.m1.1.1" xref="S4.T1.11.11.2.m1.1.1.cmml"><mn id="S4.T1.11.11.2.m1.1.1.2" mathsize="90%" xref="S4.T1.11.11.2.m1.1.1.2.cmml">7.62</mn><mo id="S4.T1.11.11.2.m1.1.1.1" mathsize="90%" xref="S4.T1.11.11.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.11.11.2.m1.1.1.3" mathsize="90%" xref="S4.T1.11.11.2.m1.1.1.3.cmml">0.12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.2.m1.1b"><apply id="S4.T1.11.11.2.m1.1.1.cmml" xref="S4.T1.11.11.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.11.11.2.m1.1.1.1.cmml" xref="S4.T1.11.11.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.11.11.2.m1.1.1.2.cmml" type="float" xref="S4.T1.11.11.2.m1.1.1.2">7.62</cn><cn id="S4.T1.11.11.2.m1.1.1.3.cmml" type="float" xref="S4.T1.11.11.2.m1.1.1.3">0.12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.2.m1.1c">7.62\pm 0.12</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.11.2.m1.1d">7.62 ± 0.12</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.13.13.3"><span class="ltx_text" id="S4.T1.13.13.3.1" style="font-size:90%;">DQN (0.97)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.12.12.1"><math alttext="1.20\pm 0.05" class="ltx_Math" display="inline" id="S4.T1.12.12.1.m1.1"><semantics id="S4.T1.12.12.1.m1.1a"><mrow id="S4.T1.12.12.1.m1.1.1" xref="S4.T1.12.12.1.m1.1.1.cmml"><mn id="S4.T1.12.12.1.m1.1.1.2" mathsize="90%" xref="S4.T1.12.12.1.m1.1.1.2.cmml">1.20</mn><mo id="S4.T1.12.12.1.m1.1.1.1" mathsize="90%" xref="S4.T1.12.12.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.12.12.1.m1.1.1.3" mathsize="90%" xref="S4.T1.12.12.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.1.m1.1b"><apply id="S4.T1.12.12.1.m1.1.1.cmml" xref="S4.T1.12.12.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.12.12.1.m1.1.1.1.cmml" xref="S4.T1.12.12.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.12.12.1.m1.1.1.2.cmml" type="float" xref="S4.T1.12.12.1.m1.1.1.2">1.20</cn><cn id="S4.T1.12.12.1.m1.1.1.3.cmml" type="float" xref="S4.T1.12.12.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.1.m1.1c">1.20\pm 0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.12.1.m1.1d">1.20 ± 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.13.13.2"><math alttext="7.72\pm 0.10" class="ltx_Math" display="inline" id="S4.T1.13.13.2.m1.1"><semantics id="S4.T1.13.13.2.m1.1a"><mrow id="S4.T1.13.13.2.m1.1.1" xref="S4.T1.13.13.2.m1.1.1.cmml"><mn id="S4.T1.13.13.2.m1.1.1.2" mathsize="90%" xref="S4.T1.13.13.2.m1.1.1.2.cmml">7.72</mn><mo id="S4.T1.13.13.2.m1.1.1.1" mathsize="90%" xref="S4.T1.13.13.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.13.13.2.m1.1.1.3" mathsize="90%" xref="S4.T1.13.13.2.m1.1.1.3.cmml">0.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.2.m1.1b"><apply id="S4.T1.13.13.2.m1.1.1.cmml" xref="S4.T1.13.13.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.13.13.2.m1.1.1.1.cmml" xref="S4.T1.13.13.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.13.13.2.m1.1.1.2.cmml" type="float" xref="S4.T1.13.13.2.m1.1.1.2">7.72</cn><cn id="S4.T1.13.13.2.m1.1.1.3.cmml" type="float" xref="S4.T1.13.13.2.m1.1.1.3">0.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.2.m1.1c">7.72\pm 0.10</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.13.2.m1.1d">7.72 ± 0.10</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.3"><span class="ltx_text" id="S4.T1.15.15.3.1" style="font-size:90%;">DQN (0.98)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.14.14.1"><math alttext="0.54\pm 0.04" class="ltx_Math" display="inline" id="S4.T1.14.14.1.m1.1"><semantics id="S4.T1.14.14.1.m1.1a"><mrow id="S4.T1.14.14.1.m1.1.1" xref="S4.T1.14.14.1.m1.1.1.cmml"><mn id="S4.T1.14.14.1.m1.1.1.2" mathsize="90%" xref="S4.T1.14.14.1.m1.1.1.2.cmml">0.54</mn><mo id="S4.T1.14.14.1.m1.1.1.1" mathsize="90%" xref="S4.T1.14.14.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.14.14.1.m1.1.1.3" mathsize="90%" xref="S4.T1.14.14.1.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.1.m1.1b"><apply id="S4.T1.14.14.1.m1.1.1.cmml" xref="S4.T1.14.14.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.14.14.1.m1.1.1.1.cmml" xref="S4.T1.14.14.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.14.14.1.m1.1.1.2.cmml" type="float" xref="S4.T1.14.14.1.m1.1.1.2">0.54</cn><cn id="S4.T1.14.14.1.m1.1.1.3.cmml" type="float" xref="S4.T1.14.14.1.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.1.m1.1c">0.54\pm 0.04</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.14.1.m1.1d">0.54 ± 0.04</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.2"><math alttext="2.72\pm 0.19" class="ltx_Math" display="inline" id="S4.T1.15.15.2.m1.1"><semantics id="S4.T1.15.15.2.m1.1a"><mrow id="S4.T1.15.15.2.m1.1.1" xref="S4.T1.15.15.2.m1.1.1.cmml"><mn id="S4.T1.15.15.2.m1.1.1.2" mathsize="90%" xref="S4.T1.15.15.2.m1.1.1.2.cmml">2.72</mn><mo id="S4.T1.15.15.2.m1.1.1.1" mathsize="90%" xref="S4.T1.15.15.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.15.15.2.m1.1.1.3" mathsize="90%" xref="S4.T1.15.15.2.m1.1.1.3.cmml">0.19</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.2.m1.1b"><apply id="S4.T1.15.15.2.m1.1.1.cmml" xref="S4.T1.15.15.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.15.15.2.m1.1.1.1.cmml" xref="S4.T1.15.15.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.15.15.2.m1.1.1.2.cmml" type="float" xref="S4.T1.15.15.2.m1.1.1.2">2.72</cn><cn id="S4.T1.15.15.2.m1.1.1.3.cmml" type="float" xref="S4.T1.15.15.2.m1.1.1.3">0.19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.2.m1.1c">2.72\pm 0.19</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.15.2.m1.1d">2.72 ± 0.19</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.17.17.3"><span class="ltx_text" id="S4.T1.17.17.3.1" style="font-size:90%;">DQN (0.99)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.16.16.1"><math alttext="0.40\pm 0.03" class="ltx_Math" display="inline" id="S4.T1.16.16.1.m1.1"><semantics id="S4.T1.16.16.1.m1.1a"><mrow id="S4.T1.16.16.1.m1.1.1" xref="S4.T1.16.16.1.m1.1.1.cmml"><mn id="S4.T1.16.16.1.m1.1.1.2" mathsize="90%" xref="S4.T1.16.16.1.m1.1.1.2.cmml">0.40</mn><mo id="S4.T1.16.16.1.m1.1.1.1" mathsize="90%" xref="S4.T1.16.16.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.16.16.1.m1.1.1.3" mathsize="90%" xref="S4.T1.16.16.1.m1.1.1.3.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.1.m1.1b"><apply id="S4.T1.16.16.1.m1.1.1.cmml" xref="S4.T1.16.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.16.16.1.m1.1.1.1.cmml" xref="S4.T1.16.16.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.16.16.1.m1.1.1.2.cmml" type="float" xref="S4.T1.16.16.1.m1.1.1.2">0.40</cn><cn id="S4.T1.16.16.1.m1.1.1.3.cmml" type="float" xref="S4.T1.16.16.1.m1.1.1.3">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.1.m1.1c">0.40\pm 0.03</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.16.1.m1.1d">0.40 ± 0.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.17.17.2"><math alttext="2.46\pm 0.01" class="ltx_Math" display="inline" id="S4.T1.17.17.2.m1.1"><semantics id="S4.T1.17.17.2.m1.1a"><mrow id="S4.T1.17.17.2.m1.1.1" xref="S4.T1.17.17.2.m1.1.1.cmml"><mn id="S4.T1.17.17.2.m1.1.1.2" mathsize="90%" xref="S4.T1.17.17.2.m1.1.1.2.cmml">2.46</mn><mo id="S4.T1.17.17.2.m1.1.1.1" mathsize="90%" xref="S4.T1.17.17.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.17.17.2.m1.1.1.3" mathsize="90%" xref="S4.T1.17.17.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.2.m1.1b"><apply id="S4.T1.17.17.2.m1.1.1.cmml" xref="S4.T1.17.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.17.17.2.m1.1.1.1.cmml" xref="S4.T1.17.17.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.17.17.2.m1.1.1.2.cmml" type="float" xref="S4.T1.17.17.2.m1.1.1.2">2.46</cn><cn id="S4.T1.17.17.2.m1.1.1.3.cmml" type="float" xref="S4.T1.17.17.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.2.m1.1c">2.46\pm 0.01</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.17.2.m1.1d">2.46 ± 0.01</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Production loss versus energy-saving (EN) across reward parameters <math alttext="\phi" class="ltx_Math" display="inline" id="S4.T1.19.m1.1"><semantics id="S4.T1.19.m1.1b"><mi id="S4.T1.19.m1.1.1" xref="S4.T1.19.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.19.m1.1c"><ci id="S4.T1.19.m1.1.1.cmml" xref="S4.T1.19.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.m1.1d">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.m1.1e">italic_ϕ</annotation></semantics></math> of DQN agents <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">loffredo2023reinforcement </a></cite> and for the DAIF agent.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Effect of Depth</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.2">The agent manages to improve the performance even when the overshooting horizon can be longer (e.g., <math alttext="H=1000" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mrow id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.2.cmml">H</mi><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.1.m1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"><eq id="S4.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.2">𝐻</ci><cn id="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">H=1000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">italic_H = 1000</annotation></semantics></math> steps). We conducted experiments with different overshooting horizons <math alttext="H" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.1"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mi id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">italic_H</annotation></semantics></math> to evaluate the performance of the agent. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#S4.F4" title="Figure 4 ‣ 4.2.1 Effect of Depth ‣ 4.2 Results ‣ 4 Experiments ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">4</span></a>, we report the preference scores from the best epoch during the validation phase. We also extracted the percentage improvement in energy-efficient consumption. The results demonstrate that even with longer overshooting horizons, the agent is still able to learn robust policies.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="296" id="S4.F4.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.4.2.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.2.1" style="font-size:90%;">Performance of the agents versus overshooting horizon <math alttext="H" class="ltx_Math" display="inline" id="S4.F4.2.1.m1.1"><semantics id="S4.F4.2.1.m1.1b"><mi id="S4.F4.2.1.m1.1.1" xref="S4.F4.2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.1.m1.1c"><ci id="S4.F4.2.1.m1.1.1.cmml" xref="S4.F4.2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.1.m1.1d">H</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.1.m1.1e">italic_H</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We introduced <em class="ltx_emph ltx_font_italic" id="S5.p1.1.1">Deep Active Inference</em> (DAIF) Agents that integrate a multi-step latent transition and an explicit, differentiable policy inside a single generative model. By overshooting the dynamics to a long horizon and back-propagating expected-free-energy gradients into the policy, the agent plans without an exhaustive tree search, scales naturally to continuous actions, and preserves the epistemic–exploitative balance that drives active inference. We evaluated DAIF on a high-fidelity industrial control problem whose feature complexity has rarely been tackled in previous works based on active inference. Empirically, DAIF closed the loop between model learning and control in highly stochastic, delayed, long-horizon environment. With a single gradient update every <math alttext="H" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_H</annotation></semantics></math> steps, the trained agent planned, and achieved strong performance—surpassing model-free RL baseline—while its world model continued to refine predictive accuracy even after the policy stabilized.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.3"><span class="ltx_text ltx_font_bold" id="S5.p2.3.1">Limitations and future work:</span>
While predicting an <math alttext="H" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_H</annotation></semantics></math>-step transition removes the expensive <em class="ltx_emph ltx_font_italic" id="S5.p2.3.2">per-step</em> planning loop, the agent still has to gather <em class="ltx_emph ltx_font_italic" id="S5.p2.3.3">experience</em> after <math alttext="H" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">italic_H</annotation></semantics></math> interactions and store it in the replay memory for training, so its sample-efficiency can still be improved. To update the world model after each new environment interaction—obtained under different actor/moving parameters—we need an operator that aggregates the <em class="ltx_emph ltx_font_italic" id="S5.p2.3.4">sequence</em> of actor representations. Recurrent models are a natural choice for this, but their sequential unrolling adds latency and can hinder gradient flow. A lighter alternative is to treat the <math alttext="H" class="ltx_Math" display="inline" id="S5.p2.3.m3.1"><semantics id="S5.p2.3.m3.1a"><mi id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><ci id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S5.p2.3.m3.1d">italic_H</annotation></semantics></math> embeddings as an (almost) unordered set and use a set function <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib59" title="">zaheer2017deep </a></cite>; when the temporal structure with simple positional embeddings (e.g. sinusoidal <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib60" title="">vaswani2017attention </a></cite>) can be concatenated before the set pooling. This allows us to break the horizon into segments—down to a single step—while still enabling EFE gradient backpropagation via aggregation of the current policy representation. Finally, (neural) operator-learning techniques could enable resolution-invariant aggregation across function spaces <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib61" title="">li2020fourier </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib62" title="">lu2021learning </a></cite>. Additional extensions include replacing the VAE world model with diffusion- or flow-matching-based generators <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib28" title="">huang2024navigating </a></cite>, adopting actor–critic optimization (as in Dreamer and related world-model agents <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib13" title="">hafner2020dreamer </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib6" title="">hafner2025mastering </a>; <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib14" title="">nguyen2024r </a></cite>), and introducing regularization schemes to stabilize EFE gradient updates and reduce their variance. Rapid adaptation in non-stationary settings—where model-free agents often struggle—remains an especially promising direction.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Overall, this work bridges neuroscience-inspired active inference and contemporary world-model RL, demonstrating that a compact, end-to-end probabilistic agent can deliver efficient control in domains where hand-crafted rewards and step-wise planning are impractical.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The work presented in this paper was supported by HiCONNECTS, which has received funding from the Key Digital Technologies Joint Undertaking under grant agreement No. 101097296.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Richard S Sutton and Andrew G Barto.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Reinforcement learning: An introduction</span>.

</span>
<span class="ltx_bibblock">MIT press, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yann LeCun, Yoshua Bengio, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Deep learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Nature</span>, 521(7553):436–444, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Christopher M. Bishop and Hugh Bishop.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Deep Learning: Foundations and Concepts</span>.

</span>
<span class="ltx_bibblock">Springer International Publishing, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A Rusu, Joel Veness,
Marc G Bellemare, Alex Graves, Martin Riedmiller, Andreas K Fidjeland, Georg
Ostrovski, et al.

</span>
<span class="ltx_bibblock">Human-level control through deep reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">nature</span>, 518(7540):529–533, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Thomas M. Moerland, Joost Broekens, Aske Plaat, and Catholijn M. Jonker.

</span>
<span class="ltx_bibblock">Model-based reinforcement learning: A survey.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Foundations and Trends® in Machine Learning</span>, 16(1):1–118,
2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.

</span>
<span class="ltx_bibblock">Mastering diverse control tasks through world models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Nature</span>, 640:647–653, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Karl Friston, Rosalyn J. Moran, Yukie Nagai, Tadahiro Taniguchi, Hiroaki Gomi,
and Joshua B. Tenenbaum.

</span>
<span class="ltx_bibblock">World model learning and inference.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Neural Networks</span>, 144:573–590, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Karl Friston, Thomas FitzGerald, Francesco Rigoli, Philipp Schwartenbeck, and
Giovanni Pezzulo.

</span>
<span class="ltx_bibblock">Active inference: a process theory.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Neural computation</span>, 29(1):1–49, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Thomas Parr, Giovanni Pezzulo, and Karl J Friston.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Active inference: the free energy principle in mind, brain, and
behavior</span>.

</span>
<span class="ltx_bibblock">MIT Press, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Karl Friston.

</span>
<span class="ltx_bibblock">The free-energy principle: a unified brain theory?

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Nature reviews neuroscience</span>, 11(2):127–138, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Yavar Taheri Yeganeh, Mohsen Jafari, and Andrea Matta.

</span>
<span class="ltx_bibblock">Active inference meeting energy-efficient control of parallel and
identical machines.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">International Conference on Machine Learning, Optimization,
and Data Science</span>, pages 479–493. Springer, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Z. Fountas, Noor Sajid, Pedro A. M. Mediano, and Karl J. Friston.

</span>
<span class="ltx_bibblock">Deep active inference agents using monte-carlo methods.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">ArXiv</span>, abs/2006.04176, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Jimmy Ba, and Mohammad Norouzi.

</span>
<span class="ltx_bibblock">Dream to control: Learning behaviors by latent imagination.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Viet Dung Nguyen, Zhizhuo Yang, Christopher L Buckley, and Alexander Ororbia.

</span>
<span class="ltx_bibblock">R-aif: Solving sparse-reward robotic tasks from pixels with active
inference and world models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2409.14216</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Christof Angermueller, David Dohan, David Belanger, Ramya Deshpande, Kevin
Murphy, and Lucy Colwell.

</span>
<span class="ltx_bibblock">Model-based reinforcement learning for biological sequence design.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">International conference on learning representations</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Chenyu Wang, Masatoshi Uehara, Yichun He, Amy Wang, Tommaso Biancalani,
Avantika Lal, Tommi Jaakkola, Sergey Levine, Hanchen Wang, and Aviv Regev.

</span>
<span class="ltx_bibblock">Fine-tuning discrete diffusion models via reward optimization with
applications to dna and protein design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2410.13643</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jakub M Tomczak.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Deep Generative Modeling</span>.

</span>
<span class="ltx_bibblock">Springer Cham, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Josh Abramson, Jonas Adler, Jack Dunger, Richard Evans, Tim Green, Alexander
Pritzel, Olaf Ronneberger, Lindsay Willmore, Andrew J. Ballard, Joshua
Bambrick, Sebastian W. Bodenstein, David A. Evans, Chia Chun Hung, Michael
O’Neill, David Reiman, Kathryn Tunyasuvunakool, Zachary Wu, Akvilė
Žemgulytė, Eirini Arvaniti, Charles Beattie, Ottavia Bertolli, Alex
Bridgland, Alexey Cherepanov, Miles Congreve, Alexander I. Cowen-Rivers,
Andrew Cowie, Michael Figurnov, Fabian B. Fuchs, Hannah Gladman, Rishub Jain,
Yousuf A. Khan, Caroline M.R. Low, Kuba Perlin, Anna Potapenko, Pascal Savy,
Sukhdeep Singh, Adrian Stecula, Ashok Thillaisundaram, Catherine Tong, Sergei
Yakneen, Ellen D. Zhong, Michal Zielinski, Augustin Žídek, Victor Bapst,
Pushmeet Kohli, Max Jaderberg, Demis Hassabis, and John M. Jumper.

</span>
<span class="ltx_bibblock">Accurate structure prediction of biomolecular interactions with
alphafold 3.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Nature</span>, 630(8016):493–500, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
David Ha and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">World models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:1803.10122</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Max Welling.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1312.6114</span>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha,
Honglak Lee, and James Davidson.

</span>
<span class="ltx_bibblock">Learning latent dynamics for planning from pixels.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">International conference on machine learning</span>, pages
2555–2565. PMLR, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Beren Millidge, Tommaso Salvatori, Yuhang Song, Rafal Bogacz, and Thomas
Lukasiewicz.

</span>
<span class="ltx_bibblock">Predictive coding: towards a future of deep learning beyond
backpropagation?

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2202.09467</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Karl Friston, Francesco Rigoli, Dimitri Ognibene, Christoph Mathys, Thomas
Fitzgerald, and Giovanni Pezzulo.

</span>
<span class="ltx_bibblock">Action and behavior: A free-energy formulation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Biological Cybernetics</span>, 102(3):227–260, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Beren Millidge.

</span>
<span class="ltx_bibblock">Applications of the free energy principle to machine learning and
neuroscience.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2107.00140</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Takuya Isomura, Kiyoshi Kotani, Yasuhiko Jimbo, and Karl J Friston.

</span>
<span class="ltx_bibblock">Experimental validation of the free-energy principle with in vitro
neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Nature Communications</span>, 14(1):4547, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Corrado Pezzato, Carlos Hernández Corbato, Stefan Bonhof, and Martijn
Wisse.

</span>
<span class="ltx_bibblock">Active inference and behavior trees for reactive action planning and
execution in robotics.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">IEEE Transactions on Robotics</span>, 39(2):1050–1069, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Tim Schneider, Boris Belousov, Georgia Chalvatzaki, Diego Romeres, Devesh K
Jha, and Jan Peters.

</span>
<span class="ltx_bibblock">Active exploration for robotic manipulation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">2022 IEEE/RSJ International Conference on Intelligent Robots
and Systems (IROS)</span>, pages 9355–9362. IEEE, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yufei Huang, Yulin Li, Andrea Matta, and Mohsen Jafari.

</span>
<span class="ltx_bibblock">Navigating autonomous vehicle on unmarked roads with diffusion-based
motion prediction and active inference.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2406.00211</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Lancelot Da Costa, Pablo Lanillos, Noor Sajid, Karl Friston, and Shujhat Khan.

</span>
<span class="ltx_bibblock">How active inference could help revolutionise robotics.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Entropy</span>, 24(3):361, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Lancelot Da Costa, Noor Sajid, Thomas Parr, Karl Friston, and Ryan Smith.

</span>
<span class="ltx_bibblock">Reward maximization through discrete active inference.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Neural Computation</span>, 35(5):807–852, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Leslie Pack Kaelbling, Michael L Littman, and Anthony R Cassandra.

</span>
<span class="ltx_bibblock">Planning and acting in partially observable stochastic domains.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Artificial intelligence</span>, 101(1-2):99–134, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Aswin Paul, Noor Sajid, Lancelot Da Costa, and Adeel Razi.

</span>
<span class="ltx_bibblock">On efficient computation in active inference.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2307.00504</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
David M Blei, Alp Kucukelbir, and Jon D McAuliffe.

</span>
<span class="ltx_bibblock">Variational inference: A review for statisticians.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Journal of the American statistical Association</span>,
112(518):859–877, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Noor Sajid, Francesco Faccio, Lancelot Da Costa, Thomas Parr, Jürgen
Schmidhuber, and Karl Friston.

</span>
<span class="ltx_bibblock">Bayesian brains and the rényi divergence.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Neural Computation</span>, 34(4):829–855, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Philipp Schwartenbeck, Johannes Passecker, Tobias U Hauser, Thomas HB
FitzGerald, Martin Kronbichler, and Karl J Friston.

</span>
<span class="ltx_bibblock">Computational mechanisms of curiosity and goal-directed exploration.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">elife</span>, 8:e41703, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Deepak Pathak, Pulkit Agrawal, Alexei A Efros, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Curiosity-driven exploration by self-supervised prediction.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">International conference on machine learning</span>, pages
2778–2787. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Exploration by random network distillation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:1810.12894</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep reinforcement
learning with a stochastic actor.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">International conference on machine learning</span>, pages
1861–1870. Pmlr, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Rémi Coulom.

</span>
<span class="ltx_bibblock">Efficient selectivity and backup operators in monte-carlo tree
search.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">International conference on computers and games</span>, pages
72–83. Springer, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
David Silver, Julian Schrittwieser, Karen Simonyan, Ioannis Antonoglou, Aja
Huang, Arthur Guez, Thomas Hubert, Lucas Baker, Matthew Lai, Adrian Bolton,
et al.

</span>
<span class="ltx_bibblock">Mastering the game of go without human knowledge.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">nature</span>, 550(7676):354–359, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Julian Schrittwieser, Ioannis Antonoglou, Thomas Hubert, Karen Simonyan,
Laurent Sifre, Simon Schmitt, Arthur Guez, Edward Lockhart, Demis Hassabis,
Thore Graepel, et al.

</span>
<span class="ltx_bibblock">Mastering atari, go, chess and shogi by planning with a learned
model.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Nature</span>, 588(7839):604–609, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Alexandre Piché, Valentin Thomas, Cyril Ibrahim, Yoshua Bengio, and Chris
Pal.

</span>
<span class="ltx_bibblock">Probabilistic planning with sequential monte carlo methods.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">International Conference on Learning Representations</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Joe Marino, Yisong Yue, and Stephan Mandt.

</span>
<span class="ltx_bibblock">Iterative amortized inference.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">International Conference on Machine Learning</span>, pages
3403–3412. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Alexander Tschantz, Beren Millidge, Anil K Seth, and Christopher L Buckley.

</span>
<span class="ltx_bibblock">Control as hybrid inference.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2007.05838</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Matthijs Van Der Meer, Zeb Kurth-Nelson, and A David Redish.

</span>
<span class="ltx_bibblock">Information processing in decision-making systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">The Neuroscientist</span>, 18(4):342–359, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Weirui Ye, Shaohuai Liu, Thanard Kurutach, Pieter Abbeel, and Yang Gao.

</span>
<span class="ltx_bibblock">Mastering atari games with limited data.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Advances in neural information processing systems</span>,
34:25476–25488, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Samuel Gershman and Noah Goodman.

</span>
<span class="ltx_bibblock">Amortized inference in probabilistic reasoning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">Proceedings of the annual meeting of the cognitive science
society</span>, volume 36, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Charles C Margossian and David M Blei.

</span>
<span class="ltx_bibblock">Amortized variational inference: When and why?

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2307.11018</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Emilien Dupont, Hyunjik Kim, SM Eslami, Danilo Rezende, and Dan Rosenbaum.

</span>
<span class="ltx_bibblock">From data to functa: Your data point is a function and you can treat
it like one.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:2201.12204</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Miltiadis Kofinas, Boris Knyazev, Yan Zhang, Yunlu Chen, Gertjan J Burghouts,
Efstratios Gavves, Cees GM Snoek, and David W Zhang.

</span>
<span class="ltx_bibblock">Graph neural networks for learning equivariant representations of
neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2403.12143</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Yarin Gal and Zoubin Ghahramani.

</span>
<span class="ltx_bibblock">Dropout as a bayesian approximation: Representing model uncertainty
in deep learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">international conference on machine learning</span>, pages
1050–1059. PMLR, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Irina Higgins, Loic Matthey, Arka Pal, Christopher Burgess, Xavier Glorot,
Matthew Botvinick, Shakir Mohamed, and Alexander Lerchner.

</span>
<span class="ltx_bibblock">beta-vae: Learning basic visual concepts with a constrained
variational framework.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">International conference on learning representations</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Matthew Crosby, Benjamin Beyret, and Marta Halina.

</span>
<span class="ltx_bibblock">The animal-ai olympics.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">Nature Machine Intelligence</span>, 1(5):257–257, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Pablo Lanillos, Cristian Meo, Corrado Pezzato, Ajith Anil Meera, Mohamed
Baioumy, Wataru Ohata, Alexander Tschantz, Beren Millidge, Martijn Wisse,
Christopher L Buckley, et al.

</span>
<span class="ltx_bibblock">Active inference in robotics and artificial agents: Survey and
challenges.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">arXiv preprint arXiv:2112.01871</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Alberto Loffredo, Marvin Carl May, Louis Schäfer, Andrea Matta, and Gisela
Lanza.

</span>
<span class="ltx_bibblock">Reinforcement learning for energy-efficient control of parallel and
identical machines.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">CIRP Journal of Manufacturing Science and Technology</span>,
44:91–103, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Alberto Loffredo, Nicla Frigerio, Ettore Lanzarone, and Andrea Matta.

</span>
<span class="ltx_bibblock">Energy-efficient control in multi-stage production lines with
parallel machine workstations and production constraints.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">IISE Transactions</span>, 56(1):69–83, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Alberto Loffredo, Marvin Carl May, Andrea Matta, and Gisela Lanza.

</span>
<span class="ltx_bibblock">Reinforcement learning for sustainability enhancement of production
lines.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">Journal of Intelligent Manufacturing</span>, pages 1–17, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Sheldon M Ross.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">Introduction to probability models</span>.

</span>
<span class="ltx_bibblock">Academic press, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Manzil Zaheer, Satwik Kottur, Siamak Ravanbakhsh, Barnabas Poczos, Russ R
Salakhutdinov, and Alexander J Smola.

</span>
<span class="ltx_bibblock">Deep sets.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib59.1.1">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib60.1.1">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Zongyi Li, Nikola Kovachki, Kamyar Azizzadenesheli, Burigede Liu, Kaushik
Bhattacharya, Andrew Stuart, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">Fourier neural operator for parametric partial differential
equations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib61.1.1">arXiv preprint arXiv:2010.08895</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Lu Lu, Pengzhan Jin, Giovanni Pang, Zhiping Zhang, and George Karniadakis.

</span>
<span class="ltx_bibblock">Learning nonlinear operators via deeponet based on the universal
approximation theorem of operators.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib62.1.1">Nature Machine Intelligence</span>, 3(3):218–229, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Paolo Renna and Sergio Materi.

</span>
<span class="ltx_bibblock">A literature review of energy efficiency and sustainability in
manufacturing systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">Applied Sciences</span>, 11(16):7366, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
John Frank Charles Kingman.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">Poisson processes</span>, volume 3.

</span>
<span class="ltx_bibblock">Clarendon Press, 1992.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Application</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Energy-Efficiency Control</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Energy-Efficiency Control (EEC) is attracting growing attention in both academia and industrial research within manufacturing systems. Acting at the component, machine, and production-system levels, EEC can deliver substantial energy savings. Fundamentally, it adjusts an asset’s power-consumption state to its operating context: equipment remains fully powered when its function is required and shifts to a low-power state when idle. Implementing this strategy is complicated by stochastic demand patterns and by the penalties incurred during state transitions—namely the production time lost while the asset adds no value and the energy consumed by the transition itself. A comprehensive, up-to-date survey of the field is provided in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib63" title="">63</a>]</cite>. Motivated by these, we focus on a system that replicates the key characteristics of an actual automotive manufacturing line.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>System Description</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.2">Following the benchmark set by Loffredo <span class="ltx_text ltx_font_italic" id="A1.SS2.p1.2.1">et al.</span> (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>]</cite>—and readily extensible to a multi-stage production line <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib56" title="">56</a>]</cite>—we study a stand-alone workstation comprising a finite-capacity upstream buffer <math alttext="B" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_B</annotation></semantics></math> that feeds <math alttext="c" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><mi id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">italic_c</annotation></semantics></math> identical, parallel machines (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.F5" title="Figure 5 ‣ A.2 System Description ‣ Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">5</span></a>). Parts arrive stochastically and each machine may reside in one of five states: <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.2.2">busy</em>, <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.2.3">idle</em>, <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.2.4">standby</em>, <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.2.5">startup</em>, or <em class="ltx_emph ltx_font_italic" id="A1.SS2.p1.2.6">failed</em>. The corresponding power rates satisfy:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{b}&gt;w_{su}&gt;w_{id}&gt;w_{sb}\approx w_{f}\approx 0." class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><msub id="A1.Ex1.m1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.2.cmml"><mi id="A1.Ex1.m1.1.1.1.1.2.2" xref="A1.Ex1.m1.1.1.1.1.2.2.cmml">w</mi><mi id="A1.Ex1.m1.1.1.1.1.2.3" xref="A1.Ex1.m1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.3.cmml">&gt;</mo><msub id="A1.Ex1.m1.1.1.1.1.4" xref="A1.Ex1.m1.1.1.1.1.4.cmml"><mi id="A1.Ex1.m1.1.1.1.1.4.2" xref="A1.Ex1.m1.1.1.1.1.4.2.cmml">w</mi><mrow id="A1.Ex1.m1.1.1.1.1.4.3" xref="A1.Ex1.m1.1.1.1.1.4.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.4.3.2" xref="A1.Ex1.m1.1.1.1.1.4.3.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.4.3.1" xref="A1.Ex1.m1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.4.3.3" xref="A1.Ex1.m1.1.1.1.1.4.3.3.cmml">u</mi></mrow></msub><mo id="A1.Ex1.m1.1.1.1.1.5" xref="A1.Ex1.m1.1.1.1.1.5.cmml">&gt;</mo><msub id="A1.Ex1.m1.1.1.1.1.6" xref="A1.Ex1.m1.1.1.1.1.6.cmml"><mi id="A1.Ex1.m1.1.1.1.1.6.2" xref="A1.Ex1.m1.1.1.1.1.6.2.cmml">w</mi><mrow id="A1.Ex1.m1.1.1.1.1.6.3" xref="A1.Ex1.m1.1.1.1.1.6.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.6.3.2" xref="A1.Ex1.m1.1.1.1.1.6.3.2.cmml">i</mi><mo id="A1.Ex1.m1.1.1.1.1.6.3.1" xref="A1.Ex1.m1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.6.3.3" xref="A1.Ex1.m1.1.1.1.1.6.3.3.cmml">d</mi></mrow></msub><mo id="A1.Ex1.m1.1.1.1.1.7" xref="A1.Ex1.m1.1.1.1.1.7.cmml">&gt;</mo><msub id="A1.Ex1.m1.1.1.1.1.8" xref="A1.Ex1.m1.1.1.1.1.8.cmml"><mi id="A1.Ex1.m1.1.1.1.1.8.2" xref="A1.Ex1.m1.1.1.1.1.8.2.cmml">w</mi><mrow id="A1.Ex1.m1.1.1.1.1.8.3" xref="A1.Ex1.m1.1.1.1.1.8.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.8.3.2" xref="A1.Ex1.m1.1.1.1.1.8.3.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.8.3.1" xref="A1.Ex1.m1.1.1.1.1.8.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.8.3.3" xref="A1.Ex1.m1.1.1.1.1.8.3.3.cmml">b</mi></mrow></msub><mo id="A1.Ex1.m1.1.1.1.1.9" xref="A1.Ex1.m1.1.1.1.1.9.cmml">≈</mo><msub id="A1.Ex1.m1.1.1.1.1.10" xref="A1.Ex1.m1.1.1.1.1.10.cmml"><mi id="A1.Ex1.m1.1.1.1.1.10.2" xref="A1.Ex1.m1.1.1.1.1.10.2.cmml">w</mi><mi id="A1.Ex1.m1.1.1.1.1.10.3" xref="A1.Ex1.m1.1.1.1.1.10.3.cmml">f</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.11" xref="A1.Ex1.m1.1.1.1.1.11.cmml">≈</mo><mn id="A1.Ex1.m1.1.1.1.1.12" xref="A1.Ex1.m1.1.1.1.1.12.cmml">0</mn></mrow><mo id="A1.Ex1.m1.1.1.1.2" lspace="0em" xref="A1.Ex1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1"><and id="A1.Ex1.m1.1.1.1.1a.cmml" xref="A1.Ex1.m1.1.1.1"></and><apply id="A1.Ex1.m1.1.1.1.1b.cmml" xref="A1.Ex1.m1.1.1.1"><gt id="A1.Ex1.m1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3"></gt><apply id="A1.Ex1.m1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.2.2">𝑤</ci><ci id="A1.Ex1.m1.1.1.1.1.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.4.cmml" xref="A1.Ex1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.4.1.cmml" xref="A1.Ex1.m1.1.1.1.1.4">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.4.2.cmml" xref="A1.Ex1.m1.1.1.1.1.4.2">𝑤</ci><apply id="A1.Ex1.m1.1.1.1.1.4.3.cmml" xref="A1.Ex1.m1.1.1.1.1.4.3"><times id="A1.Ex1.m1.1.1.1.1.4.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.4.3.1"></times><ci id="A1.Ex1.m1.1.1.1.1.4.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.4.3.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.4.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.4.3.3">𝑢</ci></apply></apply></apply><apply id="A1.Ex1.m1.1.1.1.1c.cmml" xref="A1.Ex1.m1.1.1.1"><gt id="A1.Ex1.m1.1.1.1.1.5.cmml" xref="A1.Ex1.m1.1.1.1.1.5"></gt><share href="https://arxiv.org/html/2505.19867v1#A1.Ex1.m1.1.1.1.1.4.cmml" id="A1.Ex1.m1.1.1.1.1d.cmml" xref="A1.Ex1.m1.1.1.1"></share><apply id="A1.Ex1.m1.1.1.1.1.6.cmml" xref="A1.Ex1.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.6.1.cmml" xref="A1.Ex1.m1.1.1.1.1.6">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.6.2.cmml" xref="A1.Ex1.m1.1.1.1.1.6.2">𝑤</ci><apply id="A1.Ex1.m1.1.1.1.1.6.3.cmml" xref="A1.Ex1.m1.1.1.1.1.6.3"><times id="A1.Ex1.m1.1.1.1.1.6.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.6.3.1"></times><ci id="A1.Ex1.m1.1.1.1.1.6.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.6.3.2">𝑖</ci><ci id="A1.Ex1.m1.1.1.1.1.6.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="A1.Ex1.m1.1.1.1.1e.cmml" xref="A1.Ex1.m1.1.1.1"><gt id="A1.Ex1.m1.1.1.1.1.7.cmml" xref="A1.Ex1.m1.1.1.1.1.7"></gt><share href="https://arxiv.org/html/2505.19867v1#A1.Ex1.m1.1.1.1.1.6.cmml" id="A1.Ex1.m1.1.1.1.1f.cmml" xref="A1.Ex1.m1.1.1.1"></share><apply id="A1.Ex1.m1.1.1.1.1.8.cmml" xref="A1.Ex1.m1.1.1.1.1.8"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.8.1.cmml" xref="A1.Ex1.m1.1.1.1.1.8">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.8.2.cmml" xref="A1.Ex1.m1.1.1.1.1.8.2">𝑤</ci><apply id="A1.Ex1.m1.1.1.1.1.8.3.cmml" xref="A1.Ex1.m1.1.1.1.1.8.3"><times id="A1.Ex1.m1.1.1.1.1.8.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.8.3.1"></times><ci id="A1.Ex1.m1.1.1.1.1.8.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.8.3.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.8.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.8.3.3">𝑏</ci></apply></apply></apply><apply id="A1.Ex1.m1.1.1.1.1g.cmml" xref="A1.Ex1.m1.1.1.1"><approx id="A1.Ex1.m1.1.1.1.1.9.cmml" xref="A1.Ex1.m1.1.1.1.1.9"></approx><share href="https://arxiv.org/html/2505.19867v1#A1.Ex1.m1.1.1.1.1.8.cmml" id="A1.Ex1.m1.1.1.1.1h.cmml" xref="A1.Ex1.m1.1.1.1"></share><apply id="A1.Ex1.m1.1.1.1.1.10.cmml" xref="A1.Ex1.m1.1.1.1.1.10"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.10.1.cmml" xref="A1.Ex1.m1.1.1.1.1.10">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.10.2.cmml" xref="A1.Ex1.m1.1.1.1.1.10.2">𝑤</ci><ci id="A1.Ex1.m1.1.1.1.1.10.3.cmml" xref="A1.Ex1.m1.1.1.1.1.10.3">𝑓</ci></apply></apply><apply id="A1.Ex1.m1.1.1.1.1i.cmml" xref="A1.Ex1.m1.1.1.1"><approx id="A1.Ex1.m1.1.1.1.1.11.cmml" xref="A1.Ex1.m1.1.1.1.1.11"></approx><share href="https://arxiv.org/html/2505.19867v1#A1.Ex1.m1.1.1.1.1.10.cmml" id="A1.Ex1.m1.1.1.1.1j.cmml" xref="A1.Ex1.m1.1.1.1"></share><cn id="A1.Ex1.m1.1.1.1.1.12.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.12">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">w_{b}&gt;w_{su}&gt;w_{id}&gt;w_{sb}\approx w_{f}\approx 0.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">italic_w start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT &gt; italic_w start_POSTSUBSCRIPT italic_s italic_u end_POSTSUBSCRIPT &gt; italic_w start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT &gt; italic_w start_POSTSUBSCRIPT italic_s italic_b end_POSTSUBSCRIPT ≈ italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ≈ 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="130" id="A1.F5.g1" src="extracted/6479228/figs/workstation.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="A1.F5.3.2" style="font-size:90%;">Layout of parallel, identical machines in the workstation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>]</cite>.</span></figcaption>
</figure>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.7">All system processes are modeled as Poisson processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib64" title="">64</a>]</cite>; this pertains to the arrival rate (<math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_λ</annotation></semantics></math>) to buffer <math alttext="B" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><mi id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><ci id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">italic_B</annotation></semantics></math> with capacity <math alttext="K" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><mi id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><ci id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">italic_K</annotation></semantics></math>, machine processing times (<math alttext="\mu" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m4.1"><semantics id="A1.SS2.p2.4.m4.1a"><mi id="A1.SS2.p2.4.m4.1.1" xref="A1.SS2.p2.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.1b"><ci id="A1.SS2.p2.4.m4.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m4.1d">italic_μ</annotation></semantics></math>), startup times (<math alttext="\delta" class="ltx_Math" display="inline" id="A1.SS2.p2.5.m5.1"><semantics id="A1.SS2.p2.5.m5.1a"><mi id="A1.SS2.p2.5.m5.1.1" xref="A1.SS2.p2.5.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m5.1b"><ci id="A1.SS2.p2.5.m5.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m5.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.5.m5.1d">italic_δ</annotation></semantics></math>), time between failures (<math alttext="\psi" class="ltx_Math" display="inline" id="A1.SS2.p2.6.m6.1"><semantics id="A1.SS2.p2.6.m6.1a"><mi id="A1.SS2.p2.6.m6.1.1" xref="A1.SS2.p2.6.m6.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m6.1b"><ci id="A1.SS2.p2.6.m6.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m6.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.6.m6.1d">italic_ψ</annotation></semantics></math>), and time to repair (<math alttext="\xi" class="ltx_Math" display="inline" id="A1.SS2.p2.7.m7.1"><semantics id="A1.SS2.p2.7.m7.1a"><mi id="A1.SS2.p2.7.m7.1.1" xref="A1.SS2.p2.7.m7.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m7.1b"><ci id="A1.SS2.p2.7.m7.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m7.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.7.m7.1d">italic_ξ</annotation></semantics></math>), all with expected values, independent and stationary. Table <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A1.T2" title="Table 2 ‣ A.2 System Description ‣ Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the parameters used to replicate the real industrial case study reported in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>]</cite>.</p>
</div>
<figure class="ltx_table" id="A1.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T2.14.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="A1.T2.15.2" style="font-size:90%;">Parameters for replicating the industrial system <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>]</cite>.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T2.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T2.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T2.6.6.7"><span class="ltx_text ltx_font_bold" id="A1.T2.6.6.7.1">Parameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.1.1.1"><math alttext="c" class="ltx_Math" display="inline" id="A1.T2.1.1.1.m1.1"><semantics id="A1.T2.1.1.1.m1.1a"><mi id="A1.T2.1.1.1.m1.1.1" xref="A1.T2.1.1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.m1.1b"><ci id="A1.T2.1.1.1.m1.1.1.cmml" xref="A1.T2.1.1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.T2.1.1.1.m1.1d">italic_c</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.2.2.2"><math alttext="K" class="ltx_Math" display="inline" id="A1.T2.2.2.2.m1.1"><semantics id="A1.T2.2.2.2.m1.1a"><mi id="A1.T2.2.2.2.m1.1.1" xref="A1.T2.2.2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.m1.1b"><ci id="A1.T2.2.2.2.m1.1.1.cmml" xref="A1.T2.2.2.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.T2.2.2.2.m1.1d">italic_K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.3.3.3"><math alttext="\mu" class="ltx_Math" display="inline" id="A1.T2.3.3.3.m1.1"><semantics id="A1.T2.3.3.3.m1.1a"><mi id="A1.T2.3.3.3.m1.1.1" xref="A1.T2.3.3.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A1.T2.3.3.3.m1.1b"><ci id="A1.T2.3.3.3.m1.1.1.cmml" xref="A1.T2.3.3.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.3.3.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="A1.T2.3.3.3.m1.1d">italic_μ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.4.4.4"><math alttext="\delta" class="ltx_Math" display="inline" id="A1.T2.4.4.4.m1.1"><semantics id="A1.T2.4.4.4.m1.1a"><mi id="A1.T2.4.4.4.m1.1.1" xref="A1.T2.4.4.4.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A1.T2.4.4.4.m1.1b"><ci id="A1.T2.4.4.4.m1.1.1.cmml" xref="A1.T2.4.4.4.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.4.4.4.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="A1.T2.4.4.4.m1.1d">italic_δ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.5.5.5"><math alttext="\psi" class="ltx_Math" display="inline" id="A1.T2.5.5.5.m1.1"><semantics id="A1.T2.5.5.5.m1.1a"><mi id="A1.T2.5.5.5.m1.1.1" xref="A1.T2.5.5.5.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="A1.T2.5.5.5.m1.1b"><ci id="A1.T2.5.5.5.m1.1.1.cmml" xref="A1.T2.5.5.5.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.5.5.5.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="A1.T2.5.5.5.m1.1d">italic_ψ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T2.6.6.6"><math alttext="\xi" class="ltx_Math" display="inline" id="A1.T2.6.6.6.m1.1"><semantics id="A1.T2.6.6.6.m1.1a"><mi id="A1.T2.6.6.6.m1.1.1" xref="A1.T2.6.6.6.m1.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="A1.T2.6.6.6.m1.1b"><ci id="A1.T2.6.6.6.m1.1.1.cmml" xref="A1.T2.6.6.6.m1.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.6.6.m1.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="A1.T2.6.6.6.m1.1d">italic_ξ</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T2.12.13.1.1"><span class="ltx_text ltx_font_bold" id="A1.T2.12.13.1.1.1">Value</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.2">6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.3">10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.4">0.012</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.5">0.033</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.6">0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.13.1.7">0.033</td>
</tr>
<tr class="ltx_tr" id="A1.T2.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T2.12.12.7"><span class="ltx_text ltx_font_bold" id="A1.T2.12.12.7.1">Parameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.7.7.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="A1.T2.7.7.1.m1.1"><semantics id="A1.T2.7.7.1.m1.1a"><mi id="A1.T2.7.7.1.m1.1.1" xref="A1.T2.7.7.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.T2.7.7.1.m1.1b"><ci id="A1.T2.7.7.1.m1.1.1.cmml" xref="A1.T2.7.7.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.7.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.T2.7.7.1.m1.1d">italic_λ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.8.8.2"><math alttext="w_{b}" class="ltx_Math" display="inline" id="A1.T2.8.8.2.m1.1"><semantics id="A1.T2.8.8.2.m1.1a"><msub id="A1.T2.8.8.2.m1.1.1" xref="A1.T2.8.8.2.m1.1.1.cmml"><mi id="A1.T2.8.8.2.m1.1.1.2" xref="A1.T2.8.8.2.m1.1.1.2.cmml">w</mi><mi id="A1.T2.8.8.2.m1.1.1.3" xref="A1.T2.8.8.2.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T2.8.8.2.m1.1b"><apply id="A1.T2.8.8.2.m1.1.1.cmml" xref="A1.T2.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.8.8.2.m1.1.1.1.cmml" xref="A1.T2.8.8.2.m1.1.1">subscript</csymbol><ci id="A1.T2.8.8.2.m1.1.1.2.cmml" xref="A1.T2.8.8.2.m1.1.1.2">𝑤</ci><ci id="A1.T2.8.8.2.m1.1.1.3.cmml" xref="A1.T2.8.8.2.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.8.2.m1.1c">w_{b}</annotation><annotation encoding="application/x-llamapun" id="A1.T2.8.8.2.m1.1d">italic_w start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.9.9.3"><math alttext="w_{id}" class="ltx_Math" display="inline" id="A1.T2.9.9.3.m1.1"><semantics id="A1.T2.9.9.3.m1.1a"><msub id="A1.T2.9.9.3.m1.1.1" xref="A1.T2.9.9.3.m1.1.1.cmml"><mi id="A1.T2.9.9.3.m1.1.1.2" xref="A1.T2.9.9.3.m1.1.1.2.cmml">w</mi><mrow id="A1.T2.9.9.3.m1.1.1.3" xref="A1.T2.9.9.3.m1.1.1.3.cmml"><mi id="A1.T2.9.9.3.m1.1.1.3.2" xref="A1.T2.9.9.3.m1.1.1.3.2.cmml">i</mi><mo id="A1.T2.9.9.3.m1.1.1.3.1" xref="A1.T2.9.9.3.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.T2.9.9.3.m1.1.1.3.3" xref="A1.T2.9.9.3.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.T2.9.9.3.m1.1b"><apply id="A1.T2.9.9.3.m1.1.1.cmml" xref="A1.T2.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.9.9.3.m1.1.1.1.cmml" xref="A1.T2.9.9.3.m1.1.1">subscript</csymbol><ci id="A1.T2.9.9.3.m1.1.1.2.cmml" xref="A1.T2.9.9.3.m1.1.1.2">𝑤</ci><apply id="A1.T2.9.9.3.m1.1.1.3.cmml" xref="A1.T2.9.9.3.m1.1.1.3"><times id="A1.T2.9.9.3.m1.1.1.3.1.cmml" xref="A1.T2.9.9.3.m1.1.1.3.1"></times><ci id="A1.T2.9.9.3.m1.1.1.3.2.cmml" xref="A1.T2.9.9.3.m1.1.1.3.2">𝑖</ci><ci id="A1.T2.9.9.3.m1.1.1.3.3.cmml" xref="A1.T2.9.9.3.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.9.3.m1.1c">w_{id}</annotation><annotation encoding="application/x-llamapun" id="A1.T2.9.9.3.m1.1d">italic_w start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.10.10.4"><math alttext="w_{su}" class="ltx_Math" display="inline" id="A1.T2.10.10.4.m1.1"><semantics id="A1.T2.10.10.4.m1.1a"><msub id="A1.T2.10.10.4.m1.1.1" xref="A1.T2.10.10.4.m1.1.1.cmml"><mi id="A1.T2.10.10.4.m1.1.1.2" xref="A1.T2.10.10.4.m1.1.1.2.cmml">w</mi><mrow id="A1.T2.10.10.4.m1.1.1.3" xref="A1.T2.10.10.4.m1.1.1.3.cmml"><mi id="A1.T2.10.10.4.m1.1.1.3.2" xref="A1.T2.10.10.4.m1.1.1.3.2.cmml">s</mi><mo id="A1.T2.10.10.4.m1.1.1.3.1" xref="A1.T2.10.10.4.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.T2.10.10.4.m1.1.1.3.3" xref="A1.T2.10.10.4.m1.1.1.3.3.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.T2.10.10.4.m1.1b"><apply id="A1.T2.10.10.4.m1.1.1.cmml" xref="A1.T2.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.10.10.4.m1.1.1.1.cmml" xref="A1.T2.10.10.4.m1.1.1">subscript</csymbol><ci id="A1.T2.10.10.4.m1.1.1.2.cmml" xref="A1.T2.10.10.4.m1.1.1.2">𝑤</ci><apply id="A1.T2.10.10.4.m1.1.1.3.cmml" xref="A1.T2.10.10.4.m1.1.1.3"><times id="A1.T2.10.10.4.m1.1.1.3.1.cmml" xref="A1.T2.10.10.4.m1.1.1.3.1"></times><ci id="A1.T2.10.10.4.m1.1.1.3.2.cmml" xref="A1.T2.10.10.4.m1.1.1.3.2">𝑠</ci><ci id="A1.T2.10.10.4.m1.1.1.3.3.cmml" xref="A1.T2.10.10.4.m1.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.10.4.m1.1c">w_{su}</annotation><annotation encoding="application/x-llamapun" id="A1.T2.10.10.4.m1.1d">italic_w start_POSTSUBSCRIPT italic_s italic_u end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.11.11.5"><math alttext="w_{sb}" class="ltx_Math" display="inline" id="A1.T2.11.11.5.m1.1"><semantics id="A1.T2.11.11.5.m1.1a"><msub id="A1.T2.11.11.5.m1.1.1" xref="A1.T2.11.11.5.m1.1.1.cmml"><mi id="A1.T2.11.11.5.m1.1.1.2" xref="A1.T2.11.11.5.m1.1.1.2.cmml">w</mi><mrow id="A1.T2.11.11.5.m1.1.1.3" xref="A1.T2.11.11.5.m1.1.1.3.cmml"><mi id="A1.T2.11.11.5.m1.1.1.3.2" xref="A1.T2.11.11.5.m1.1.1.3.2.cmml">s</mi><mo id="A1.T2.11.11.5.m1.1.1.3.1" xref="A1.T2.11.11.5.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.T2.11.11.5.m1.1.1.3.3" xref="A1.T2.11.11.5.m1.1.1.3.3.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.T2.11.11.5.m1.1b"><apply id="A1.T2.11.11.5.m1.1.1.cmml" xref="A1.T2.11.11.5.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.11.11.5.m1.1.1.1.cmml" xref="A1.T2.11.11.5.m1.1.1">subscript</csymbol><ci id="A1.T2.11.11.5.m1.1.1.2.cmml" xref="A1.T2.11.11.5.m1.1.1.2">𝑤</ci><apply id="A1.T2.11.11.5.m1.1.1.3.cmml" xref="A1.T2.11.11.5.m1.1.1.3"><times id="A1.T2.11.11.5.m1.1.1.3.1.cmml" xref="A1.T2.11.11.5.m1.1.1.3.1"></times><ci id="A1.T2.11.11.5.m1.1.1.3.2.cmml" xref="A1.T2.11.11.5.m1.1.1.3.2">𝑠</ci><ci id="A1.T2.11.11.5.m1.1.1.3.3.cmml" xref="A1.T2.11.11.5.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.11.11.5.m1.1c">w_{sb}</annotation><annotation encoding="application/x-llamapun" id="A1.T2.11.11.5.m1.1d">italic_w start_POSTSUBSCRIPT italic_s italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.12.12.6"><math alttext="w_{f}" class="ltx_Math" display="inline" id="A1.T2.12.12.6.m1.1"><semantics id="A1.T2.12.12.6.m1.1a"><msub id="A1.T2.12.12.6.m1.1.1" xref="A1.T2.12.12.6.m1.1.1.cmml"><mi id="A1.T2.12.12.6.m1.1.1.2" xref="A1.T2.12.12.6.m1.1.1.2.cmml">w</mi><mi id="A1.T2.12.12.6.m1.1.1.3" xref="A1.T2.12.12.6.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T2.12.12.6.m1.1b"><apply id="A1.T2.12.12.6.m1.1.1.cmml" xref="A1.T2.12.12.6.m1.1.1"><csymbol cd="ambiguous" id="A1.T2.12.12.6.m1.1.1.1.cmml" xref="A1.T2.12.12.6.m1.1.1">subscript</csymbol><ci id="A1.T2.12.12.6.m1.1.1.2.cmml" xref="A1.T2.12.12.6.m1.1.1.2">𝑤</ci><ci id="A1.T2.12.12.6.m1.1.1.3.cmml" xref="A1.T2.12.12.6.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.12.12.6.m1.1c">w_{f}</annotation><annotation encoding="application/x-llamapun" id="A1.T2.12.12.6.m1.1d">italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A1.T2.12.14.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.1"><span class="ltx_text ltx_font_bold" id="A1.T2.12.14.2.1.1">Value</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.2">0.050</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.3">15 kW</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.4">9.30 kW</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.5">10 kW</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.6">0 kW</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T2.12.14.2.7">0 kW</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1">Each machine processes a single part type under a first-come-first-served policy. Machines cannot be powered down while processing or during startup. If a machine is ready to work but the buffer <math alttext="B" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">italic_B</annotation></semantics></math> is empty, it becomes <em class="ltx_emph ltx_font_italic" id="A1.SS2.p3.1.1">starved</em> and enters the idle state. The central challenge of EEC in this system is to dynamically determine how many machines should remain active versus how many should be transitioned to low-power states. This decision must be made adaptively in response to the unfolding stochastic conditions, striking an optimal balance between reducing energy usage and maintaining high production rate (i.e., throughput).</p>
</div>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Modeling</h4>
<div class="ltx_para" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.1">As machine state transitions and part arrivals are modeled as Poisson processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>]</cite>, we adopt the <em class="ltx_emph ltx_font_italic" id="A1.SS2.SSS1.p1.1.1">event-driven</em> scheme of Loffredo <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS1.p1.1.2">et al.</span> (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">57</a>]</cite>, where control decisions are triggered immediately after each state change in the system rather than at fixed sampling intervals—an approach proven effective for managing active machines. In this way, the system itself requests decisions from the agent in a stochastic manner.</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS1.p2">
<p class="ltx_p" id="A1.SS2.SSS1.p2.4">This control task admits two different formulations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">11</a>]</cite>: (i) continuous-time stochastic control or (ii) a discrete-time Markov chain (DTMC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib58" title="">58</a>]</cite>. A continuous-time model must provide the raw inter-event interval <math alttext="\Delta t" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p2.1.m1.1"><semantics id="A1.SS2.SSS1.p2.1.m1.1a"><mrow id="A1.SS2.SSS1.p2.1.m1.1.1" xref="A1.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p2.1.m1.1.1.2" mathvariant="normal" xref="A1.SS2.SSS1.p2.1.m1.1.1.2.cmml">Δ</mi><mo id="A1.SS2.SSS1.p2.1.m1.1.1.1" xref="A1.SS2.SSS1.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A1.SS2.SSS1.p2.1.m1.1.1.3" xref="A1.SS2.SSS1.p2.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p2.1.m1.1b"><apply id="A1.SS2.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.1.1"><times id="A1.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.1.1.1"></times><ci id="A1.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p2.1.m1.1.1.2">Δ</ci><ci id="A1.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p2.1.m1.1c">\Delta t</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p2.1.m1.1d">roman_Δ italic_t</annotation></semantics></math> to the agent for every machine and subsequent observation, whereas the DTMC abstraction lets the agent infer transition probabilities directly from observed events. Because <math alttext="\Delta t" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p2.2.m2.1"><semantics id="A1.SS2.SSS1.p2.2.m2.1a"><mrow id="A1.SS2.SSS1.p2.2.m2.1.1" xref="A1.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p2.2.m2.1.1.2" mathvariant="normal" xref="A1.SS2.SSS1.p2.2.m2.1.1.2.cmml">Δ</mi><mo id="A1.SS2.SSS1.p2.2.m2.1.1.1" xref="A1.SS2.SSS1.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="A1.SS2.SSS1.p2.2.m2.1.1.3" xref="A1.SS2.SSS1.p2.2.m2.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p2.2.m2.1b"><apply id="A1.SS2.SSS1.p2.2.m2.1.1.cmml" xref="A1.SS2.SSS1.p2.2.m2.1.1"><times id="A1.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="A1.SS2.SSS1.p2.2.m2.1.1.1"></times><ci id="A1.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p2.2.m2.1.1.2">Δ</ci><ci id="A1.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p2.2.m2.1c">\Delta t</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p2.2.m2.1d">roman_Δ italic_t</annotation></semantics></math> varies from event to event, a continuous-time formulation would have to align the predictor <math alttext="P_{\theta}\!\left(o_{t+H}\right)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p2.3.m3.1"><semantics id="A1.SS2.SSS1.p2.3.m3.1a"><mrow id="A1.SS2.SSS1.p2.3.m3.1.1" xref="A1.SS2.SSS1.p2.3.m3.1.1.cmml"><msub id="A1.SS2.SSS1.p2.3.m3.1.1.3" xref="A1.SS2.SSS1.p2.3.m3.1.1.3.cmml"><mi id="A1.SS2.SSS1.p2.3.m3.1.1.3.2" xref="A1.SS2.SSS1.p2.3.m3.1.1.3.2.cmml">P</mi><mi id="A1.SS2.SSS1.p2.3.m3.1.1.3.3" xref="A1.SS2.SSS1.p2.3.m3.1.1.3.3.cmml">θ</mi></msub><mo id="A1.SS2.SSS1.p2.3.m3.1.1.2" xref="A1.SS2.SSS1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p2.3.m3.1.1.1.1" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.2" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.2" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml">o</mi><mrow id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2.cmml">t</mi><mo id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.1" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.1.cmml">+</mo><mi id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.cmml">H</mi></mrow></msub><mo id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.3" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p2.3.m3.1b"><apply id="A1.SS2.SSS1.p2.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1"><times id="A1.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.2"></times><apply id="A1.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p2.3.m3.1.1.3.1.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p2.3.m3.1.1.3.2.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.3.2">𝑃</ci><ci id="A1.SS2.SSS1.p2.3.m3.1.1.3.3.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.3.3">𝜃</ci></apply><apply id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.2">𝑜</ci><apply id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3"><plus id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.1"></plus><ci id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.2">𝑡</ci><ci id="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p2.3.m3.1.1.1.1.1.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p2.3.m3.1c">P_{\theta}\!\left(o_{t+H}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p2.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT )</annotation></semantics></math> with the reference observation <math alttext="\tilde{o}_{t+H}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p2.4.m4.1"><semantics id="A1.SS2.SSS1.p2.4.m4.1a"><msub id="A1.SS2.SSS1.p2.4.m4.1.1" xref="A1.SS2.SSS1.p2.4.m4.1.1.cmml"><mover accent="true" id="A1.SS2.SSS1.p2.4.m4.1.1.2" xref="A1.SS2.SSS1.p2.4.m4.1.1.2.cmml"><mi id="A1.SS2.SSS1.p2.4.m4.1.1.2.2" xref="A1.SS2.SSS1.p2.4.m4.1.1.2.2.cmml">o</mi><mo id="A1.SS2.SSS1.p2.4.m4.1.1.2.1" xref="A1.SS2.SSS1.p2.4.m4.1.1.2.1.cmml">~</mo></mover><mrow id="A1.SS2.SSS1.p2.4.m4.1.1.3" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.cmml"><mi id="A1.SS2.SSS1.p2.4.m4.1.1.3.2" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.2.cmml">t</mi><mo id="A1.SS2.SSS1.p2.4.m4.1.1.3.1" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.1.cmml">+</mo><mi id="A1.SS2.SSS1.p2.4.m4.1.1.3.3" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.3.cmml">H</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p2.4.m4.1b"><apply id="A1.SS2.SSS1.p2.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><apply id="A1.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.2"><ci id="A1.SS2.SSS1.p2.4.m4.1.1.2.1.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.2.1">~</ci><ci id="A1.SS2.SSS1.p2.4.m4.1.1.2.2.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.2.2">𝑜</ci></apply><apply id="A1.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.3"><plus id="A1.SS2.SSS1.p2.4.m4.1.1.3.1.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.1"></plus><ci id="A1.SS2.SSS1.p2.4.m4.1.1.3.2.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.2">𝑡</ci><ci id="A1.SS2.SSS1.p2.4.m4.1.1.3.3.cmml" xref="A1.SS2.SSS1.p2.4.m4.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p2.4.m4.1c">\tilde{o}_{t+H}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p2.4.m4.1d">over~ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t + italic_H end_POSTSUBSCRIPT</annotation></semantics></math>, which—although beneficial for planning—complicates the network architecture owing to state occupancy durations. Therefore, to keep the model simpler, we adopt the discrete-time, <em class="ltx_emph ltx_font_italic" id="A1.SS2.SSS1.p2.4.1">event-driven</em> formulation.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Preference Mapping</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">In AIF, the agent acts to reach its preferred observation, akin to a setpoint in control theory <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib22" title="">22</a>]</cite>. This implies that the agent possesses an internal preference mapping <math alttext="\Psi" class="ltx_Math" display="inline" id="A1.SS3.p1.1.m1.1"><semantics id="A1.SS3.p1.1.m1.1a"><mi id="A1.SS3.p1.1.m1.1.1" mathvariant="normal" xref="A1.SS3.p1.1.m1.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><ci id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.1d">roman_Ψ</annotation></semantics></math>, which quantifies how close its predicted observation is to a desired target. While conceptually related to reward functions in RL, this preference reflects a control-based objective rather than cumulative rewards in the Markov Decision Process framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.2">Building on the EEC framework introduced by Loffredo <span class="ltx_text ltx_font_italic" id="A1.SS3.p2.2.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">57</a>]</cite>, a generic preference or reward function for the multi-objective optimization of the system under study can include terms for production, energy consumption, and a weighted combination thereof <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">11</a>]</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E7">
<tbody>
<tr class="ltx_eqn_row" id="A3.EGx3"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E7.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{\text{production}}" class="ltx_Math" display="inline" id="A1.E7.1.m1.1"><semantics id="A1.E7.1.m1.1a"><msub id="A1.E7.1.m1.1.1" xref="A1.E7.1.m1.1.1.cmml"><mi id="A1.E7.1.m1.1.1.2" xref="A1.E7.1.m1.1.1.2.cmml">R</mi><mtext id="A1.E7.1.m1.1.1.3" xref="A1.E7.1.m1.1.1.3a.cmml">production</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.E7.1.m1.1b"><apply id="A1.E7.1.m1.1.1.cmml" xref="A1.E7.1.m1.1.1"><csymbol cd="ambiguous" id="A1.E7.1.m1.1.1.1.cmml" xref="A1.E7.1.m1.1.1">subscript</csymbol><ci id="A1.E7.1.m1.1.1.2.cmml" xref="A1.E7.1.m1.1.1.2">𝑅</ci><ci id="A1.E7.1.m1.1.1.3a.cmml" xref="A1.E7.1.m1.1.1.3"><mtext id="A1.E7.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.E7.1.m1.1.1.3">production</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.1.m1.1c">\displaystyle R_{\text{production}}</annotation><annotation encoding="application/x-llamapun" id="A1.E7.1.m1.1d">italic_R start_POSTSUBSCRIPT production end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{T_{\text{current}}}{T_{\text{max}}},\quad R_{\text{energy}%
}=1-\frac{E_{\text{avg}}}{E_{\text{max}}}," class="ltx_Math" display="inline" id="A1.E7.1.m2.1"><semantics id="A1.E7.1.m2.1a"><mrow id="A1.E7.1.m2.1.1.1"><mrow id="A1.E7.1.m2.1.1.1.1.2" xref="A1.E7.1.m2.1.1.1.1.3.cmml"><mrow id="A1.E7.1.m2.1.1.1.1.1.1" xref="A1.E7.1.m2.1.1.1.1.1.1.cmml"><mi id="A1.E7.1.m2.1.1.1.1.1.1.2" xref="A1.E7.1.m2.1.1.1.1.1.1.2.cmml"></mi><mo id="A1.E7.1.m2.1.1.1.1.1.1.1" xref="A1.E7.1.m2.1.1.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E7.1.m2.1.1.1.1.1.1.3" xref="A1.E7.1.m2.1.1.1.1.1.1.3.cmml"><mfrac id="A1.E7.1.m2.1.1.1.1.1.1.3a" xref="A1.E7.1.m2.1.1.1.1.1.1.3.cmml"><msub id="A1.E7.1.m2.1.1.1.1.1.1.3.2" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E7.1.m2.1.1.1.1.1.1.3.2.2" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.2.cmml">T</mi><mtext id="A1.E7.1.m2.1.1.1.1.1.1.3.2.3" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.3a.cmml">current</mtext></msub><msub id="A1.E7.1.m2.1.1.1.1.1.1.3.3" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E7.1.m2.1.1.1.1.1.1.3.3.2" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.2.cmml">T</mi><mtext id="A1.E7.1.m2.1.1.1.1.1.1.3.3.3" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.3a.cmml">max</mtext></msub></mfrac></mstyle></mrow><mo id="A1.E7.1.m2.1.1.1.1.2.3" rspace="1.167em" xref="A1.E7.1.m2.1.1.1.1.3a.cmml">,</mo><mrow id="A1.E7.1.m2.1.1.1.1.2.2" xref="A1.E7.1.m2.1.1.1.1.2.2.cmml"><msub id="A1.E7.1.m2.1.1.1.1.2.2.2" xref="A1.E7.1.m2.1.1.1.1.2.2.2.cmml"><mi id="A1.E7.1.m2.1.1.1.1.2.2.2.2" xref="A1.E7.1.m2.1.1.1.1.2.2.2.2.cmml">R</mi><mtext id="A1.E7.1.m2.1.1.1.1.2.2.2.3" xref="A1.E7.1.m2.1.1.1.1.2.2.2.3a.cmml">energy</mtext></msub><mo id="A1.E7.1.m2.1.1.1.1.2.2.1" xref="A1.E7.1.m2.1.1.1.1.2.2.1.cmml">=</mo><mrow id="A1.E7.1.m2.1.1.1.1.2.2.3" xref="A1.E7.1.m2.1.1.1.1.2.2.3.cmml"><mn id="A1.E7.1.m2.1.1.1.1.2.2.3.2" xref="A1.E7.1.m2.1.1.1.1.2.2.3.2.cmml">1</mn><mo id="A1.E7.1.m2.1.1.1.1.2.2.3.1" xref="A1.E7.1.m2.1.1.1.1.2.2.3.1.cmml">−</mo><mstyle displaystyle="true" id="A1.E7.1.m2.1.1.1.1.2.2.3.3" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.cmml"><mfrac id="A1.E7.1.m2.1.1.1.1.2.2.3.3a" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.cmml"><msub id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.cmml"><mi id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.2" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.2.cmml">E</mi><mtext id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3a.cmml">avg</mtext></msub><msub id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.cmml"><mi id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.2" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.2.cmml">E</mi><mtext id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3a.cmml">max</mtext></msub></mfrac></mstyle></mrow></mrow></mrow><mo id="A1.E7.1.m2.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.1.m2.1b"><apply id="A1.E7.1.m2.1.1.1.1.3.cmml" xref="A1.E7.1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E7.1.m2.1.1.1.1.1.1.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1"><eq id="A1.E7.1.m2.1.1.1.1.1.1.1.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.1"></eq><csymbol cd="latexml" id="A1.E7.1.m2.1.1.1.1.1.1.2.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.2">absent</csymbol><apply id="A1.E7.1.m2.1.1.1.1.1.1.3.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3"><divide id="A1.E7.1.m2.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3"></divide><apply id="A1.E7.1.m2.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E7.1.m2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.2">𝑇</ci><ci id="A1.E7.1.m2.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.3"><mtext id="A1.E7.1.m2.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E7.1.m2.1.1.1.1.1.1.3.2.3">current</mtext></ci></apply><apply id="A1.E7.1.m2.1.1.1.1.1.1.3.3.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E7.1.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.2">𝑇</ci><ci id="A1.E7.1.m2.1.1.1.1.1.1.3.3.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.3"><mtext id="A1.E7.1.m2.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="A1.E7.1.m2.1.1.1.1.1.1.3.3.3">max</mtext></ci></apply></apply></apply><apply id="A1.E7.1.m2.1.1.1.1.2.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2"><eq id="A1.E7.1.m2.1.1.1.1.2.2.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.1"></eq><apply id="A1.E7.1.m2.1.1.1.1.2.2.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.2.2.2.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E7.1.m2.1.1.1.1.2.2.2.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.2.2">𝑅</ci><ci id="A1.E7.1.m2.1.1.1.1.2.2.2.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.2.3"><mtext id="A1.E7.1.m2.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="A1.E7.1.m2.1.1.1.1.2.2.2.3">energy</mtext></ci></apply><apply id="A1.E7.1.m2.1.1.1.1.2.2.3.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3"><minus id="A1.E7.1.m2.1.1.1.1.2.2.3.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.1"></minus><cn id="A1.E7.1.m2.1.1.1.1.2.2.3.2.cmml" type="integer" xref="A1.E7.1.m2.1.1.1.1.2.2.3.2">1</cn><apply id="A1.E7.1.m2.1.1.1.1.2.2.3.3.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3"><divide id="A1.E7.1.m2.1.1.1.1.2.2.3.3.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3"></divide><apply id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2">subscript</csymbol><ci id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.2">𝐸</ci><ci id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3"><mtext id="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3.cmml" mathsize="70%" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.2.3">avg</mtext></ci></apply><apply id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.1.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3">subscript</csymbol><ci id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.2.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.2">𝐸</ci><ci id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3a.cmml" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3"><mtext id="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3.cmml" mathsize="70%" xref="A1.E7.1.m2.1.1.1.1.2.2.3.3.3.3">max</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.1.m2.1c">\displaystyle=\frac{T_{\text{current}}}{T_{\text{max}}},\quad R_{\text{energy}%
}=1-\frac{E_{\text{avg}}}{E_{\text{max}}},</annotation><annotation encoding="application/x-llamapun" id="A1.E7.1.m2.1d">= divide start_ARG italic_T start_POSTSUBSCRIPT current end_POSTSUBSCRIPT end_ARG start_ARG italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG , italic_R start_POSTSUBSCRIPT energy end_POSTSUBSCRIPT = 1 - divide start_ARG italic_E start_POSTSUBSCRIPT avg end_POSTSUBSCRIPT end_ARG start_ARG italic_E start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E7.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R" class="ltx_Math" display="inline" id="A1.E7.2.m1.1"><semantics id="A1.E7.2.m1.1a"><mi id="A1.E7.2.m1.1.1" xref="A1.E7.2.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A1.E7.2.m1.1b"><ci id="A1.E7.2.m1.1.1.cmml" xref="A1.E7.2.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.2.m1.1c">\displaystyle R</annotation><annotation encoding="application/x-llamapun" id="A1.E7.2.m1.1d">italic_R</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\phi\cdot R_{\text{production}}+\left(1-\phi\right)\cdot R_{%
\text{energy}}," class="ltx_Math" display="inline" id="A1.E7.2.m2.1"><semantics id="A1.E7.2.m2.1a"><mrow id="A1.E7.2.m2.1.1.1" xref="A1.E7.2.m2.1.1.1.1.cmml"><mrow id="A1.E7.2.m2.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.cmml"><mi id="A1.E7.2.m2.1.1.1.1.3" xref="A1.E7.2.m2.1.1.1.1.3.cmml"></mi><mo id="A1.E7.2.m2.1.1.1.1.2" xref="A1.E7.2.m2.1.1.1.1.2.cmml">=</mo><mrow id="A1.E7.2.m2.1.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.1.cmml"><mrow id="A1.E7.2.m2.1.1.1.1.1.3" xref="A1.E7.2.m2.1.1.1.1.1.3.cmml"><mi id="A1.E7.2.m2.1.1.1.1.1.3.2" xref="A1.E7.2.m2.1.1.1.1.1.3.2.cmml">ϕ</mi><mo id="A1.E7.2.m2.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E7.2.m2.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="A1.E7.2.m2.1.1.1.1.1.3.3" xref="A1.E7.2.m2.1.1.1.1.1.3.3.cmml"><mi id="A1.E7.2.m2.1.1.1.1.1.3.3.2" xref="A1.E7.2.m2.1.1.1.1.1.3.3.2.cmml">R</mi><mtext id="A1.E7.2.m2.1.1.1.1.1.3.3.3" xref="A1.E7.2.m2.1.1.1.1.1.3.3.3a.cmml">production</mtext></msub></mrow><mo id="A1.E7.2.m2.1.1.1.1.1.2" xref="A1.E7.2.m2.1.1.1.1.1.2.cmml">+</mo><mrow id="A1.E7.2.m2.1.1.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.1.1.cmml"><mrow id="A1.E7.2.m2.1.1.1.1.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E7.2.m2.1.1.1.1.1.1.1.1.2" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="A1.E7.2.m2.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E7.2.m2.1.1.1.1.1.1.2" rspace="0.222em" xref="A1.E7.2.m2.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="A1.E7.2.m2.1.1.1.1.1.1.3" xref="A1.E7.2.m2.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.2.m2.1.1.1.1.1.1.3.2" xref="A1.E7.2.m2.1.1.1.1.1.1.3.2.cmml">R</mi><mtext id="A1.E7.2.m2.1.1.1.1.1.1.3.3" xref="A1.E7.2.m2.1.1.1.1.1.1.3.3a.cmml">energy</mtext></msub></mrow></mrow></mrow><mo id="A1.E7.2.m2.1.1.1.2" xref="A1.E7.2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.2.m2.1b"><apply id="A1.E7.2.m2.1.1.1.1.cmml" xref="A1.E7.2.m2.1.1.1"><eq id="A1.E7.2.m2.1.1.1.1.2.cmml" xref="A1.E7.2.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="A1.E7.2.m2.1.1.1.1.3.cmml" xref="A1.E7.2.m2.1.1.1.1.3">absent</csymbol><apply id="A1.E7.2.m2.1.1.1.1.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1"><plus id="A1.E7.2.m2.1.1.1.1.1.2.cmml" xref="A1.E7.2.m2.1.1.1.1.1.2"></plus><apply id="A1.E7.2.m2.1.1.1.1.1.3.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3"><ci id="A1.E7.2.m2.1.1.1.1.1.3.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.1">⋅</ci><ci id="A1.E7.2.m2.1.1.1.1.1.3.2.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.2">italic-ϕ</ci><apply id="A1.E7.2.m2.1.1.1.1.1.3.3.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E7.2.m2.1.1.1.1.1.3.3.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E7.2.m2.1.1.1.1.1.3.3.2.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.3.2">𝑅</ci><ci id="A1.E7.2.m2.1.1.1.1.1.3.3.3a.cmml" xref="A1.E7.2.m2.1.1.1.1.1.3.3.3"><mtext id="A1.E7.2.m2.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="A1.E7.2.m2.1.1.1.1.1.3.3.3">production</mtext></ci></apply></apply><apply id="A1.E7.2.m2.1.1.1.1.1.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1"><ci id="A1.E7.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.2">⋅</ci><apply id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1"><minus id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci></apply><apply id="A1.E7.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.2.m2.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.2.m2.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.3.2">𝑅</ci><ci id="A1.E7.2.m2.1.1.1.1.1.1.3.3a.cmml" xref="A1.E7.2.m2.1.1.1.1.1.1.3.3"><mtext id="A1.E7.2.m2.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.E7.2.m2.1.1.1.1.1.1.3.3">energy</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.2.m2.1c">\displaystyle=\phi\cdot R_{\text{production}}+\left(1-\phi\right)\cdot R_{%
\text{energy}},</annotation><annotation encoding="application/x-llamapun" id="A1.E7.2.m2.1d">= italic_ϕ ⋅ italic_R start_POSTSUBSCRIPT production end_POSTSUBSCRIPT + ( 1 - italic_ϕ ) ⋅ italic_R start_POSTSUBSCRIPT energy end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7b)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.SS3.p2.1">where <math alttext="\phi\in[0,1]" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.2"><semantics id="A1.SS3.p2.1.m1.2a"><mrow id="A1.SS3.p2.1.m1.2.3" xref="A1.SS3.p2.1.m1.2.3.cmml"><mi id="A1.SS3.p2.1.m1.2.3.2" xref="A1.SS3.p2.1.m1.2.3.2.cmml">ϕ</mi><mo id="A1.SS3.p2.1.m1.2.3.1" xref="A1.SS3.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="A1.SS3.p2.1.m1.2.3.3.2" xref="A1.SS3.p2.1.m1.2.3.3.1.cmml"><mo id="A1.SS3.p2.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS3.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1.cmml">0</mn><mo id="A1.SS3.p2.1.m1.2.3.3.2.2" xref="A1.SS3.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="A1.SS3.p2.1.m1.2.2" xref="A1.SS3.p2.1.m1.2.2.cmml">1</mn><mo id="A1.SS3.p2.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS3.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.2b"><apply id="A1.SS3.p2.1.m1.2.3.cmml" xref="A1.SS3.p2.1.m1.2.3"><in id="A1.SS3.p2.1.m1.2.3.1.cmml" xref="A1.SS3.p2.1.m1.2.3.1"></in><ci id="A1.SS3.p2.1.m1.2.3.2.cmml" xref="A1.SS3.p2.1.m1.2.3.2">italic-ϕ</ci><interval closure="closed" id="A1.SS3.p2.1.m1.2.3.3.1.cmml" xref="A1.SS3.p2.1.m1.2.3.3.2"><cn id="A1.SS3.p2.1.m1.1.1.cmml" type="integer" xref="A1.SS3.p2.1.m1.1.1">0</cn><cn id="A1.SS3.p2.1.m1.2.2.cmml" type="integer" xref="A1.SS3.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.2c">\phi\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.2d">italic_ϕ ∈ [ 0 , 1 ]</annotation></semantics></math> is a weighting coefficient balancing the importance of production and energy efficiency.</p>
</div>
<div class="ltx_para" id="A1.SS3.p3">
<p class="ltx_p" id="A1.SS3.p3.2">Loffredo <span class="ltx_text ltx_font_italic" id="A1.SS3.p3.2.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">57</a>]</cite> computed the production term as the average throughput from the start of the interaction, and the energy term as the difference between consecutive time steps, followed by exponential transformations. In contrast, we employ a window-based approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib11" title="">11</a>]</cite>, which better captures the stochastic performance of the system and aligns with the concept of a <em class="ltx_emph ltx_font_italic" id="A1.SS3.p3.2.2">delayed</em> and <em class="ltx_emph ltx_font_italic" id="A1.SS3.p3.2.3">long-horizon</em> control problem. Specifically, we evaluate average system performance over a fixed time span <math alttext="t_{s}" class="ltx_Math" display="inline" id="A1.SS3.p3.1.m1.1"><semantics id="A1.SS3.p3.1.m1.1a"><msub id="A1.SS3.p3.1.m1.1.1" xref="A1.SS3.p3.1.m1.1.1.cmml"><mi id="A1.SS3.p3.1.m1.1.1.2" xref="A1.SS3.p3.1.m1.1.1.2.cmml">t</mi><mi id="A1.SS3.p3.1.m1.1.1.3" xref="A1.SS3.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.1.m1.1b"><apply id="A1.SS3.p3.1.m1.1.1.cmml" xref="A1.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.1.1.1.cmml" xref="A1.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.p3.1.m1.1.1.2.cmml" xref="A1.SS3.p3.1.m1.1.1.2">𝑡</ci><ci id="A1.SS3.p3.1.m1.1.1.3.cmml" xref="A1.SS3.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.1.m1.1c">t_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.1.m1.1d">italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Eight hours or one shift in our implementation.</span></span></span>, leading up to the current observation at time <math alttext="t" class="ltx_Math" display="inline" id="A1.SS3.p3.2.m2.1"><semantics id="A1.SS3.p3.2.m2.1a"><mi id="A1.SS3.p3.2.m2.1.1" xref="A1.SS3.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.2.m2.1b"><ci id="A1.SS3.p3.2.m2.1.1.cmml" xref="A1.SS3.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.2.m2.1d">italic_t</annotation></semantics></math>. Accordingly:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx4">
<tbody id="A1.Ex1a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle T_{\text{current}}" class="ltx_Math" display="inline" id="A1.Ex1a.m1.1"><semantics id="A1.Ex1a.m1.1a"><msub id="A1.Ex1a.m1.1.1" xref="A1.Ex1a.m1.1.1.cmml"><mi id="A1.Ex1a.m1.1.1.2" xref="A1.Ex1a.m1.1.1.2.cmml">T</mi><mtext id="A1.Ex1a.m1.1.1.3" xref="A1.Ex1a.m1.1.1.3a.cmml">current</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.Ex1a.m1.1b"><apply id="A1.Ex1a.m1.1.1.cmml" xref="A1.Ex1a.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex1a.m1.1.1.1.cmml" xref="A1.Ex1a.m1.1.1">subscript</csymbol><ci id="A1.Ex1a.m1.1.1.2.cmml" xref="A1.Ex1a.m1.1.1.2">𝑇</ci><ci id="A1.Ex1a.m1.1.1.3a.cmml" xref="A1.Ex1a.m1.1.1.3"><mtext id="A1.Ex1a.m1.1.1.3.cmml" mathsize="70%" xref="A1.Ex1a.m1.1.1.3">current</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1a.m1.1c">\displaystyle T_{\text{current}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1a.m1.1d">italic_T start_POSTSUBSCRIPT current end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{NP(t)-NP(t-t_{s})}{t_{s}}," class="ltx_Math" display="inline" id="A1.Ex1a.m2.3"><semantics id="A1.Ex1a.m2.3a"><mrow id="A1.Ex1a.m2.3.3.1" xref="A1.Ex1a.m2.3.3.1.1.cmml"><mrow id="A1.Ex1a.m2.3.3.1.1" xref="A1.Ex1a.m2.3.3.1.1.cmml"><mi id="A1.Ex1a.m2.3.3.1.1.2" xref="A1.Ex1a.m2.3.3.1.1.2.cmml"></mi><mo id="A1.Ex1a.m2.3.3.1.1.1" xref="A1.Ex1a.m2.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex1a.m2.2.2" xref="A1.Ex1a.m2.2.2.cmml"><mfrac id="A1.Ex1a.m2.2.2a" xref="A1.Ex1a.m2.2.2.cmml"><mrow id="A1.Ex1a.m2.2.2.2" xref="A1.Ex1a.m2.2.2.2.cmml"><mrow id="A1.Ex1a.m2.2.2.2.4" xref="A1.Ex1a.m2.2.2.2.4.cmml"><mi id="A1.Ex1a.m2.2.2.2.4.2" xref="A1.Ex1a.m2.2.2.2.4.2.cmml">N</mi><mo id="A1.Ex1a.m2.2.2.2.4.1" xref="A1.Ex1a.m2.2.2.2.4.1.cmml">⁢</mo><mi id="A1.Ex1a.m2.2.2.2.4.3" xref="A1.Ex1a.m2.2.2.2.4.3.cmml">P</mi><mo id="A1.Ex1a.m2.2.2.2.4.1a" xref="A1.Ex1a.m2.2.2.2.4.1.cmml">⁢</mo><mrow id="A1.Ex1a.m2.2.2.2.4.4.2" xref="A1.Ex1a.m2.2.2.2.4.cmml"><mo id="A1.Ex1a.m2.2.2.2.4.4.2.1" stretchy="false" xref="A1.Ex1a.m2.2.2.2.4.cmml">(</mo><mi id="A1.Ex1a.m2.1.1.1.1" xref="A1.Ex1a.m2.1.1.1.1.cmml">t</mi><mo id="A1.Ex1a.m2.2.2.2.4.4.2.2" stretchy="false" xref="A1.Ex1a.m2.2.2.2.4.cmml">)</mo></mrow></mrow><mo id="A1.Ex1a.m2.2.2.2.3" xref="A1.Ex1a.m2.2.2.2.3.cmml">−</mo><mrow id="A1.Ex1a.m2.2.2.2.2" xref="A1.Ex1a.m2.2.2.2.2.cmml"><mi id="A1.Ex1a.m2.2.2.2.2.3" xref="A1.Ex1a.m2.2.2.2.2.3.cmml">N</mi><mo id="A1.Ex1a.m2.2.2.2.2.2" xref="A1.Ex1a.m2.2.2.2.2.2.cmml">⁢</mo><mi id="A1.Ex1a.m2.2.2.2.2.4" xref="A1.Ex1a.m2.2.2.2.2.4.cmml">P</mi><mo id="A1.Ex1a.m2.2.2.2.2.2a" xref="A1.Ex1a.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex1a.m2.2.2.2.2.1.1" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.cmml"><mo id="A1.Ex1a.m2.2.2.2.2.1.1.2" stretchy="false" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex1a.m2.2.2.2.2.1.1.1" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.cmml"><mi id="A1.Ex1a.m2.2.2.2.2.1.1.1.2" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.2.cmml">t</mi><mo id="A1.Ex1a.m2.2.2.2.2.1.1.1.1" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="A1.Ex1a.m2.2.2.2.2.1.1.1.3" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3.cmml"><mi id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.2" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.3" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="A1.Ex1a.m2.2.2.2.2.1.1.3" stretchy="false" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><msub id="A1.Ex1a.m2.2.2.4" xref="A1.Ex1a.m2.2.2.4.cmml"><mi id="A1.Ex1a.m2.2.2.4.2" xref="A1.Ex1a.m2.2.2.4.2.cmml">t</mi><mi id="A1.Ex1a.m2.2.2.4.3" xref="A1.Ex1a.m2.2.2.4.3.cmml">s</mi></msub></mfrac></mstyle></mrow><mo id="A1.Ex1a.m2.3.3.1.2" xref="A1.Ex1a.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1a.m2.3b"><apply id="A1.Ex1a.m2.3.3.1.1.cmml" xref="A1.Ex1a.m2.3.3.1"><eq id="A1.Ex1a.m2.3.3.1.1.1.cmml" xref="A1.Ex1a.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="A1.Ex1a.m2.3.3.1.1.2.cmml" xref="A1.Ex1a.m2.3.3.1.1.2">absent</csymbol><apply id="A1.Ex1a.m2.2.2.cmml" xref="A1.Ex1a.m2.2.2"><divide id="A1.Ex1a.m2.2.2.3.cmml" xref="A1.Ex1a.m2.2.2"></divide><apply id="A1.Ex1a.m2.2.2.2.cmml" xref="A1.Ex1a.m2.2.2.2"><minus id="A1.Ex1a.m2.2.2.2.3.cmml" xref="A1.Ex1a.m2.2.2.2.3"></minus><apply id="A1.Ex1a.m2.2.2.2.4.cmml" xref="A1.Ex1a.m2.2.2.2.4"><times id="A1.Ex1a.m2.2.2.2.4.1.cmml" xref="A1.Ex1a.m2.2.2.2.4.1"></times><ci id="A1.Ex1a.m2.2.2.2.4.2.cmml" xref="A1.Ex1a.m2.2.2.2.4.2">𝑁</ci><ci id="A1.Ex1a.m2.2.2.2.4.3.cmml" xref="A1.Ex1a.m2.2.2.2.4.3">𝑃</ci><ci id="A1.Ex1a.m2.1.1.1.1.cmml" xref="A1.Ex1a.m2.1.1.1.1">𝑡</ci></apply><apply id="A1.Ex1a.m2.2.2.2.2.cmml" xref="A1.Ex1a.m2.2.2.2.2"><times id="A1.Ex1a.m2.2.2.2.2.2.cmml" xref="A1.Ex1a.m2.2.2.2.2.2"></times><ci id="A1.Ex1a.m2.2.2.2.2.3.cmml" xref="A1.Ex1a.m2.2.2.2.2.3">𝑁</ci><ci id="A1.Ex1a.m2.2.2.2.2.4.cmml" xref="A1.Ex1a.m2.2.2.2.2.4">𝑃</ci><apply id="A1.Ex1a.m2.2.2.2.2.1.1.1.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1"><minus id="A1.Ex1a.m2.2.2.2.2.1.1.1.1.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.1"></minus><ci id="A1.Ex1a.m2.2.2.2.2.1.1.1.2.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.2">𝑡</ci><apply id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.1.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.2.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3.2">𝑡</ci><ci id="A1.Ex1a.m2.2.2.2.2.1.1.1.3.3.cmml" xref="A1.Ex1a.m2.2.2.2.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply><apply id="A1.Ex1a.m2.2.2.4.cmml" xref="A1.Ex1a.m2.2.2.4"><csymbol cd="ambiguous" id="A1.Ex1a.m2.2.2.4.1.cmml" xref="A1.Ex1a.m2.2.2.4">subscript</csymbol><ci id="A1.Ex1a.m2.2.2.4.2.cmml" xref="A1.Ex1a.m2.2.2.4.2">𝑡</ci><ci id="A1.Ex1a.m2.2.2.4.3.cmml" xref="A1.Ex1a.m2.2.2.4.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1a.m2.3c">\displaystyle=\frac{NP(t)-NP(t-t_{s})}{t_{s}},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1a.m2.3d">= divide start_ARG italic_N italic_P ( italic_t ) - italic_N italic_P ( italic_t - italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_ARG start_ARG italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle E_{\text{avg}}" class="ltx_Math" display="inline" id="A1.Ex2.m1.1"><semantics id="A1.Ex2.m1.1a"><msub id="A1.Ex2.m1.1.1" xref="A1.Ex2.m1.1.1.cmml"><mi id="A1.Ex2.m1.1.1.2" xref="A1.Ex2.m1.1.1.2.cmml">E</mi><mtext id="A1.Ex2.m1.1.1.3" xref="A1.Ex2.m1.1.1.3a.cmml">avg</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.1b"><apply id="A1.Ex2.m1.1.1.cmml" xref="A1.Ex2.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex2.m1.1.1.1.cmml" xref="A1.Ex2.m1.1.1">subscript</csymbol><ci id="A1.Ex2.m1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.2">𝐸</ci><ci id="A1.Ex2.m1.1.1.3a.cmml" xref="A1.Ex2.m1.1.1.3"><mtext id="A1.Ex2.m1.1.1.3.cmml" mathsize="70%" xref="A1.Ex2.m1.1.1.3">avg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.1c">\displaystyle E_{\text{avg}}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m1.1d">italic_E start_POSTSUBSCRIPT avg end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{C(t)-C(t-t_{s})}{t_{s}}," class="ltx_Math" display="inline" id="A1.Ex2.m2.3"><semantics id="A1.Ex2.m2.3a"><mrow id="A1.Ex2.m2.3.3.1" xref="A1.Ex2.m2.3.3.1.1.cmml"><mrow id="A1.Ex2.m2.3.3.1.1" xref="A1.Ex2.m2.3.3.1.1.cmml"><mi id="A1.Ex2.m2.3.3.1.1.2" xref="A1.Ex2.m2.3.3.1.1.2.cmml"></mi><mo id="A1.Ex2.m2.3.3.1.1.1" xref="A1.Ex2.m2.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex2.m2.2.2" xref="A1.Ex2.m2.2.2.cmml"><mfrac id="A1.Ex2.m2.2.2a" xref="A1.Ex2.m2.2.2.cmml"><mrow id="A1.Ex2.m2.2.2.2" xref="A1.Ex2.m2.2.2.2.cmml"><mrow id="A1.Ex2.m2.2.2.2.4" xref="A1.Ex2.m2.2.2.2.4.cmml"><mi id="A1.Ex2.m2.2.2.2.4.2" xref="A1.Ex2.m2.2.2.2.4.2.cmml">C</mi><mo id="A1.Ex2.m2.2.2.2.4.1" xref="A1.Ex2.m2.2.2.2.4.1.cmml">⁢</mo><mrow id="A1.Ex2.m2.2.2.2.4.3.2" xref="A1.Ex2.m2.2.2.2.4.cmml"><mo id="A1.Ex2.m2.2.2.2.4.3.2.1" stretchy="false" xref="A1.Ex2.m2.2.2.2.4.cmml">(</mo><mi id="A1.Ex2.m2.1.1.1.1" xref="A1.Ex2.m2.1.1.1.1.cmml">t</mi><mo id="A1.Ex2.m2.2.2.2.4.3.2.2" stretchy="false" xref="A1.Ex2.m2.2.2.2.4.cmml">)</mo></mrow></mrow><mo id="A1.Ex2.m2.2.2.2.3" xref="A1.Ex2.m2.2.2.2.3.cmml">−</mo><mrow id="A1.Ex2.m2.2.2.2.2" xref="A1.Ex2.m2.2.2.2.2.cmml"><mi id="A1.Ex2.m2.2.2.2.2.3" xref="A1.Ex2.m2.2.2.2.2.3.cmml">C</mi><mo id="A1.Ex2.m2.2.2.2.2.2" xref="A1.Ex2.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex2.m2.2.2.2.2.1.1" xref="A1.Ex2.m2.2.2.2.2.1.1.1.cmml"><mo id="A1.Ex2.m2.2.2.2.2.1.1.2" stretchy="false" xref="A1.Ex2.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m2.2.2.2.2.1.1.1" xref="A1.Ex2.m2.2.2.2.2.1.1.1.cmml"><mi id="A1.Ex2.m2.2.2.2.2.1.1.1.2" xref="A1.Ex2.m2.2.2.2.2.1.1.1.2.cmml">t</mi><mo id="A1.Ex2.m2.2.2.2.2.1.1.1.1" xref="A1.Ex2.m2.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="A1.Ex2.m2.2.2.2.2.1.1.1.3" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3.cmml"><mi id="A1.Ex2.m2.2.2.2.2.1.1.1.3.2" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="A1.Ex2.m2.2.2.2.2.1.1.1.3.3" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="A1.Ex2.m2.2.2.2.2.1.1.3" stretchy="false" xref="A1.Ex2.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><msub id="A1.Ex2.m2.2.2.4" xref="A1.Ex2.m2.2.2.4.cmml"><mi id="A1.Ex2.m2.2.2.4.2" xref="A1.Ex2.m2.2.2.4.2.cmml">t</mi><mi id="A1.Ex2.m2.2.2.4.3" xref="A1.Ex2.m2.2.2.4.3.cmml">s</mi></msub></mfrac></mstyle></mrow><mo id="A1.Ex2.m2.3.3.1.2" xref="A1.Ex2.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m2.3b"><apply id="A1.Ex2.m2.3.3.1.1.cmml" xref="A1.Ex2.m2.3.3.1"><eq id="A1.Ex2.m2.3.3.1.1.1.cmml" xref="A1.Ex2.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="A1.Ex2.m2.3.3.1.1.2.cmml" xref="A1.Ex2.m2.3.3.1.1.2">absent</csymbol><apply id="A1.Ex2.m2.2.2.cmml" xref="A1.Ex2.m2.2.2"><divide id="A1.Ex2.m2.2.2.3.cmml" xref="A1.Ex2.m2.2.2"></divide><apply id="A1.Ex2.m2.2.2.2.cmml" xref="A1.Ex2.m2.2.2.2"><minus id="A1.Ex2.m2.2.2.2.3.cmml" xref="A1.Ex2.m2.2.2.2.3"></minus><apply id="A1.Ex2.m2.2.2.2.4.cmml" xref="A1.Ex2.m2.2.2.2.4"><times id="A1.Ex2.m2.2.2.2.4.1.cmml" xref="A1.Ex2.m2.2.2.2.4.1"></times><ci id="A1.Ex2.m2.2.2.2.4.2.cmml" xref="A1.Ex2.m2.2.2.2.4.2">𝐶</ci><ci id="A1.Ex2.m2.1.1.1.1.cmml" xref="A1.Ex2.m2.1.1.1.1">𝑡</ci></apply><apply id="A1.Ex2.m2.2.2.2.2.cmml" xref="A1.Ex2.m2.2.2.2.2"><times id="A1.Ex2.m2.2.2.2.2.2.cmml" xref="A1.Ex2.m2.2.2.2.2.2"></times><ci id="A1.Ex2.m2.2.2.2.2.3.cmml" xref="A1.Ex2.m2.2.2.2.2.3">𝐶</ci><apply id="A1.Ex2.m2.2.2.2.2.1.1.1.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1"><minus id="A1.Ex2.m2.2.2.2.2.1.1.1.1.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.1"></minus><ci id="A1.Ex2.m2.2.2.2.2.1.1.1.2.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.2">𝑡</ci><apply id="A1.Ex2.m2.2.2.2.2.1.1.1.3.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex2.m2.2.2.2.2.1.1.1.3.1.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex2.m2.2.2.2.2.1.1.1.3.2.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3.2">𝑡</ci><ci id="A1.Ex2.m2.2.2.2.2.1.1.1.3.3.cmml" xref="A1.Ex2.m2.2.2.2.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply><apply id="A1.Ex2.m2.2.2.4.cmml" xref="A1.Ex2.m2.2.2.4"><csymbol cd="ambiguous" id="A1.Ex2.m2.2.2.4.1.cmml" xref="A1.Ex2.m2.2.2.4">subscript</csymbol><ci id="A1.Ex2.m2.2.2.4.2.cmml" xref="A1.Ex2.m2.2.2.4.2">𝑡</ci><ci id="A1.Ex2.m2.2.2.4.3.cmml" xref="A1.Ex2.m2.2.2.4.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m2.3c">\displaystyle=\frac{C(t)-C(t-t_{s})}{t_{s}},</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m2.3d">= divide start_ARG italic_C ( italic_t ) - italic_C ( italic_t - italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_ARG start_ARG italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS3.p3.7">where <math alttext="NP(t)" class="ltx_Math" display="inline" id="A1.SS3.p3.3.m1.1"><semantics id="A1.SS3.p3.3.m1.1a"><mrow id="A1.SS3.p3.3.m1.1.2" xref="A1.SS3.p3.3.m1.1.2.cmml"><mi id="A1.SS3.p3.3.m1.1.2.2" xref="A1.SS3.p3.3.m1.1.2.2.cmml">N</mi><mo id="A1.SS3.p3.3.m1.1.2.1" xref="A1.SS3.p3.3.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS3.p3.3.m1.1.2.3" xref="A1.SS3.p3.3.m1.1.2.3.cmml">P</mi><mo id="A1.SS3.p3.3.m1.1.2.1a" xref="A1.SS3.p3.3.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS3.p3.3.m1.1.2.4.2" xref="A1.SS3.p3.3.m1.1.2.cmml"><mo id="A1.SS3.p3.3.m1.1.2.4.2.1" stretchy="false" xref="A1.SS3.p3.3.m1.1.2.cmml">(</mo><mi id="A1.SS3.p3.3.m1.1.1" xref="A1.SS3.p3.3.m1.1.1.cmml">t</mi><mo id="A1.SS3.p3.3.m1.1.2.4.2.2" stretchy="false" xref="A1.SS3.p3.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.3.m1.1b"><apply id="A1.SS3.p3.3.m1.1.2.cmml" xref="A1.SS3.p3.3.m1.1.2"><times id="A1.SS3.p3.3.m1.1.2.1.cmml" xref="A1.SS3.p3.3.m1.1.2.1"></times><ci id="A1.SS3.p3.3.m1.1.2.2.cmml" xref="A1.SS3.p3.3.m1.1.2.2">𝑁</ci><ci id="A1.SS3.p3.3.m1.1.2.3.cmml" xref="A1.SS3.p3.3.m1.1.2.3">𝑃</ci><ci id="A1.SS3.p3.3.m1.1.1.cmml" xref="A1.SS3.p3.3.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.3.m1.1c">NP(t)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.3.m1.1d">italic_N italic_P ( italic_t )</annotation></semantics></math> is the number of parts produced and <math alttext="C(t)" class="ltx_Math" display="inline" id="A1.SS3.p3.4.m2.1"><semantics id="A1.SS3.p3.4.m2.1a"><mrow id="A1.SS3.p3.4.m2.1.2" xref="A1.SS3.p3.4.m2.1.2.cmml"><mi id="A1.SS3.p3.4.m2.1.2.2" xref="A1.SS3.p3.4.m2.1.2.2.cmml">C</mi><mo id="A1.SS3.p3.4.m2.1.2.1" xref="A1.SS3.p3.4.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS3.p3.4.m2.1.2.3.2" xref="A1.SS3.p3.4.m2.1.2.cmml"><mo id="A1.SS3.p3.4.m2.1.2.3.2.1" stretchy="false" xref="A1.SS3.p3.4.m2.1.2.cmml">(</mo><mi id="A1.SS3.p3.4.m2.1.1" xref="A1.SS3.p3.4.m2.1.1.cmml">t</mi><mo id="A1.SS3.p3.4.m2.1.2.3.2.2" stretchy="false" xref="A1.SS3.p3.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.4.m2.1b"><apply id="A1.SS3.p3.4.m2.1.2.cmml" xref="A1.SS3.p3.4.m2.1.2"><times id="A1.SS3.p3.4.m2.1.2.1.cmml" xref="A1.SS3.p3.4.m2.1.2.1"></times><ci id="A1.SS3.p3.4.m2.1.2.2.cmml" xref="A1.SS3.p3.4.m2.1.2.2">𝐶</ci><ci id="A1.SS3.p3.4.m2.1.1.cmml" xref="A1.SS3.p3.4.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.4.m2.1c">C(t)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.4.m2.1d">italic_C ( italic_t )</annotation></semantics></math> is the total energy consumed up to time <math alttext="t" class="ltx_Math" display="inline" id="A1.SS3.p3.5.m3.1"><semantics id="A1.SS3.p3.5.m3.1a"><mi id="A1.SS3.p3.5.m3.1.1" xref="A1.SS3.p3.5.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.5.m3.1b"><ci id="A1.SS3.p3.5.m3.1.1.cmml" xref="A1.SS3.p3.5.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.5.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.5.m3.1d">italic_t</annotation></semantics></math>. <math alttext="T_{\text{max}}" class="ltx_Math" display="inline" id="A1.SS3.p3.6.m4.1"><semantics id="A1.SS3.p3.6.m4.1a"><msub id="A1.SS3.p3.6.m4.1.1" xref="A1.SS3.p3.6.m4.1.1.cmml"><mi id="A1.SS3.p3.6.m4.1.1.2" xref="A1.SS3.p3.6.m4.1.1.2.cmml">T</mi><mtext id="A1.SS3.p3.6.m4.1.1.3" xref="A1.SS3.p3.6.m4.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.6.m4.1b"><apply id="A1.SS3.p3.6.m4.1.1.cmml" xref="A1.SS3.p3.6.m4.1.1"><csymbol cd="ambiguous" id="A1.SS3.p3.6.m4.1.1.1.cmml" xref="A1.SS3.p3.6.m4.1.1">subscript</csymbol><ci id="A1.SS3.p3.6.m4.1.1.2.cmml" xref="A1.SS3.p3.6.m4.1.1.2">𝑇</ci><ci id="A1.SS3.p3.6.m4.1.1.3a.cmml" xref="A1.SS3.p3.6.m4.1.1.3"><mtext id="A1.SS3.p3.6.m4.1.1.3.cmml" mathsize="70%" xref="A1.SS3.p3.6.m4.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.6.m4.1c">T_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.6.m4.1d">italic_T start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the maximum achievable throughput under the <em class="ltx_emph ltx_font_italic" id="A1.SS3.p3.7.1">ALL ON</em> policy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib57" title="">57</a>]</cite>, and <math alttext="E_{\text{max}}" class="ltx_Math" display="inline" id="A1.SS3.p3.7.m5.1"><semantics id="A1.SS3.p3.7.m5.1a"><msub id="A1.SS3.p3.7.m5.1.1" xref="A1.SS3.p3.7.m5.1.1.cmml"><mi id="A1.SS3.p3.7.m5.1.1.2" xref="A1.SS3.p3.7.m5.1.1.2.cmml">E</mi><mtext id="A1.SS3.p3.7.m5.1.1.3" xref="A1.SS3.p3.7.m5.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.7.m5.1b"><apply id="A1.SS3.p3.7.m5.1.1.cmml" xref="A1.SS3.p3.7.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.p3.7.m5.1.1.1.cmml" xref="A1.SS3.p3.7.m5.1.1">subscript</csymbol><ci id="A1.SS3.p3.7.m5.1.1.2.cmml" xref="A1.SS3.p3.7.m5.1.1.2">𝐸</ci><ci id="A1.SS3.p3.7.m5.1.1.3a.cmml" xref="A1.SS3.p3.7.m5.1.1.3"><mtext id="A1.SS3.p3.7.m5.1.1.3.cmml" mathsize="70%" xref="A1.SS3.p3.7.m5.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.7.m5.1c">E_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.7.m5.1d">italic_E start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math> denotes the theoretical peak energy consumption when all machines operate in the busy state.</p>
</div>
<div class="ltx_para" id="A1.SS3.p4">
<p class="ltx_p" id="A1.SS3.p4.1">To encourage EEC, <math alttext="\phi" class="ltx_Math" display="inline" id="A1.SS3.p4.1.m1.1"><semantics id="A1.SS3.p4.1.m1.1a"><mi id="A1.SS3.p4.1.m1.1.1" xref="A1.SS3.p4.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p4.1.m1.1b"><ci id="A1.SS3.p4.1.m1.1.1.cmml" xref="A1.SS3.p4.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p4.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p4.1.m1.1d">italic_ϕ</annotation></semantics></math> is typically set close to 1 to avoid excessive production loss. However, this linear formulation may overestimate performance in cases where energy savings are negligible—i.e., the composite term remains high due to production alone, even when control is not applied. To address this, we adjust the preference function by applying a sigmoid transformation to the energy term:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R=R_{\text{production}}\cdot\sigma(c_{r}R_{\text{energy}})," class="ltx_Math" display="block" id="A1.E8.m1.1"><semantics id="A1.E8.m1.1a"><mrow id="A1.E8.m1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml"><mrow id="A1.E8.m1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml"><mi id="A1.E8.m1.1.1.1.1.3" xref="A1.E8.m1.1.1.1.1.3.cmml">R</mi><mo id="A1.E8.m1.1.1.1.1.2" xref="A1.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E8.m1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.cmml"><mrow id="A1.E8.m1.1.1.1.1.1.3" xref="A1.E8.m1.1.1.1.1.1.3.cmml"><msub id="A1.E8.m1.1.1.1.1.1.3.2" xref="A1.E8.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.E8.m1.1.1.1.1.1.3.2.2" xref="A1.E8.m1.1.1.1.1.1.3.2.2.cmml">R</mi><mtext id="A1.E8.m1.1.1.1.1.1.3.2.3" xref="A1.E8.m1.1.1.1.1.1.3.2.3a.cmml">production</mtext></msub><mo id="A1.E8.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E8.m1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="A1.E8.m1.1.1.1.1.1.3.3" xref="A1.E8.m1.1.1.1.1.1.3.3.cmml">σ</mi></mrow><mo id="A1.E8.m1.1.1.1.1.1.2" xref="A1.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.1.1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E8.m1.1.1.1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E8.m1.1.1.1.1.1.1.1.1.2" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E8.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="A1.E8.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml">r</mi></msub><mo id="A1.E8.m1.1.1.1.1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.E8.m1.1.1.1.1.1.1.1.1.3" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E8.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml">R</mi><mtext id="A1.E8.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.3a.cmml">energy</mtext></msub></mrow><mo id="A1.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E8.m1.1.1.1.2" xref="A1.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.1b"><apply id="A1.E8.m1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1"><eq id="A1.E8.m1.1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.1.2"></eq><ci id="A1.E8.m1.1.1.1.1.3.cmml" xref="A1.E8.m1.1.1.1.1.3">𝑅</ci><apply id="A1.E8.m1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1"><times id="A1.E8.m1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.1.1.2"></times><apply id="A1.E8.m1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.1.1.1.1.1.3"><ci id="A1.E8.m1.1.1.1.1.1.3.1.cmml" xref="A1.E8.m1.1.1.1.1.1.3.1">⋅</ci><apply id="A1.E8.m1.1.1.1.1.1.3.2.cmml" xref="A1.E8.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.E8.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E8.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.E8.m1.1.1.1.1.1.3.2.2">𝑅</ci><ci id="A1.E8.m1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E8.m1.1.1.1.1.1.3.2.3"><mtext id="A1.E8.m1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E8.m1.1.1.1.1.1.3.2.3">production</mtext></ci></apply><ci id="A1.E8.m1.1.1.1.1.1.3.3.cmml" xref="A1.E8.m1.1.1.1.1.1.3.3">𝜎</ci></apply><apply id="A1.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1"><times id="A1.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="A1.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.2.3">𝑟</ci></apply><apply id="A1.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="A1.E8.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.3"><mtext id="A1.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.E8.m1.1.1.1.1.1.1.1.1.3.3">energy</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.1c">R=R_{\text{production}}\cdot\sigma(c_{r}R_{\text{energy}}),</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.1d">italic_R = italic_R start_POSTSUBSCRIPT production end_POSTSUBSCRIPT ⋅ italic_σ ( italic_c start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT energy end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS3.p4.3">where <math alttext="\sigma(x)=\frac{1}{1+e^{-x}}" class="ltx_Math" display="inline" id="A1.SS3.p4.2.m1.1"><semantics id="A1.SS3.p4.2.m1.1a"><mrow id="A1.SS3.p4.2.m1.1.2" xref="A1.SS3.p4.2.m1.1.2.cmml"><mrow id="A1.SS3.p4.2.m1.1.2.2" xref="A1.SS3.p4.2.m1.1.2.2.cmml"><mi id="A1.SS3.p4.2.m1.1.2.2.2" xref="A1.SS3.p4.2.m1.1.2.2.2.cmml">σ</mi><mo id="A1.SS3.p4.2.m1.1.2.2.1" xref="A1.SS3.p4.2.m1.1.2.2.1.cmml">⁢</mo><mrow id="A1.SS3.p4.2.m1.1.2.2.3.2" xref="A1.SS3.p4.2.m1.1.2.2.cmml"><mo id="A1.SS3.p4.2.m1.1.2.2.3.2.1" stretchy="false" xref="A1.SS3.p4.2.m1.1.2.2.cmml">(</mo><mi id="A1.SS3.p4.2.m1.1.1" xref="A1.SS3.p4.2.m1.1.1.cmml">x</mi><mo id="A1.SS3.p4.2.m1.1.2.2.3.2.2" stretchy="false" xref="A1.SS3.p4.2.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS3.p4.2.m1.1.2.1" xref="A1.SS3.p4.2.m1.1.2.1.cmml">=</mo><mfrac id="A1.SS3.p4.2.m1.1.2.3" xref="A1.SS3.p4.2.m1.1.2.3.cmml"><mn id="A1.SS3.p4.2.m1.1.2.3.2" xref="A1.SS3.p4.2.m1.1.2.3.2.cmml">1</mn><mrow id="A1.SS3.p4.2.m1.1.2.3.3" xref="A1.SS3.p4.2.m1.1.2.3.3.cmml"><mn id="A1.SS3.p4.2.m1.1.2.3.3.2" xref="A1.SS3.p4.2.m1.1.2.3.3.2.cmml">1</mn><mo id="A1.SS3.p4.2.m1.1.2.3.3.1" xref="A1.SS3.p4.2.m1.1.2.3.3.1.cmml">+</mo><msup id="A1.SS3.p4.2.m1.1.2.3.3.3" xref="A1.SS3.p4.2.m1.1.2.3.3.3.cmml"><mi id="A1.SS3.p4.2.m1.1.2.3.3.3.2" xref="A1.SS3.p4.2.m1.1.2.3.3.3.2.cmml">e</mi><mrow id="A1.SS3.p4.2.m1.1.2.3.3.3.3" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3.cmml"><mo id="A1.SS3.p4.2.m1.1.2.3.3.3.3a" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3.cmml">−</mo><mi id="A1.SS3.p4.2.m1.1.2.3.3.3.3.2" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3.2.cmml">x</mi></mrow></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p4.2.m1.1b"><apply id="A1.SS3.p4.2.m1.1.2.cmml" xref="A1.SS3.p4.2.m1.1.2"><eq id="A1.SS3.p4.2.m1.1.2.1.cmml" xref="A1.SS3.p4.2.m1.1.2.1"></eq><apply id="A1.SS3.p4.2.m1.1.2.2.cmml" xref="A1.SS3.p4.2.m1.1.2.2"><times id="A1.SS3.p4.2.m1.1.2.2.1.cmml" xref="A1.SS3.p4.2.m1.1.2.2.1"></times><ci id="A1.SS3.p4.2.m1.1.2.2.2.cmml" xref="A1.SS3.p4.2.m1.1.2.2.2">𝜎</ci><ci id="A1.SS3.p4.2.m1.1.1.cmml" xref="A1.SS3.p4.2.m1.1.1">𝑥</ci></apply><apply id="A1.SS3.p4.2.m1.1.2.3.cmml" xref="A1.SS3.p4.2.m1.1.2.3"><divide id="A1.SS3.p4.2.m1.1.2.3.1.cmml" xref="A1.SS3.p4.2.m1.1.2.3"></divide><cn id="A1.SS3.p4.2.m1.1.2.3.2.cmml" type="integer" xref="A1.SS3.p4.2.m1.1.2.3.2">1</cn><apply id="A1.SS3.p4.2.m1.1.2.3.3.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3"><plus id="A1.SS3.p4.2.m1.1.2.3.3.1.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.1"></plus><cn id="A1.SS3.p4.2.m1.1.2.3.3.2.cmml" type="integer" xref="A1.SS3.p4.2.m1.1.2.3.3.2">1</cn><apply id="A1.SS3.p4.2.m1.1.2.3.3.3.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="A1.SS3.p4.2.m1.1.2.3.3.3.1.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3">superscript</csymbol><ci id="A1.SS3.p4.2.m1.1.2.3.3.3.2.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3.2">𝑒</ci><apply id="A1.SS3.p4.2.m1.1.2.3.3.3.3.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3"><minus id="A1.SS3.p4.2.m1.1.2.3.3.3.3.1.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3"></minus><ci id="A1.SS3.p4.2.m1.1.2.3.3.3.3.2.cmml" xref="A1.SS3.p4.2.m1.1.2.3.3.3.3.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p4.2.m1.1c">\sigma(x)=\frac{1}{1+e^{-x}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p4.2.m1.1d">italic_σ ( italic_x ) = divide start_ARG 1 end_ARG start_ARG 1 + italic_e start_POSTSUPERSCRIPT - italic_x end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is the sigmoid function, and <math alttext="c_{r}" class="ltx_Math" display="inline" id="A1.SS3.p4.3.m2.1"><semantics id="A1.SS3.p4.3.m2.1a"><msub id="A1.SS3.p4.3.m2.1.1" xref="A1.SS3.p4.3.m2.1.1.cmml"><mi id="A1.SS3.p4.3.m2.1.1.2" xref="A1.SS3.p4.3.m2.1.1.2.cmml">c</mi><mi id="A1.SS3.p4.3.m2.1.1.3" xref="A1.SS3.p4.3.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p4.3.m2.1b"><apply id="A1.SS3.p4.3.m2.1.1.cmml" xref="A1.SS3.p4.3.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.p4.3.m2.1.1.1.cmml" xref="A1.SS3.p4.3.m2.1.1">subscript</csymbol><ci id="A1.SS3.p4.3.m2.1.1.2.cmml" xref="A1.SS3.p4.3.m2.1.1.2">𝑐</ci><ci id="A1.SS3.p4.3.m2.1.1.3.cmml" xref="A1.SS3.p4.3.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p4.3.m2.1c">c_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p4.3.m2.1d">italic_c start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> is a scalar hyperparameter controlling the sensitivity to energy savings. This formulation ensures that energy savings sharply amplify the preference, thereby enforcing a balanced focus on both productivity and energy saving. Notably, in the absence of any control actions (i.e., under the <em class="ltx_emph ltx_font_italic" id="A1.SS3.p4.3.1">ALL ON</em> policy), the energy term saturates near zero, and the composite term is naturally lower than that of the linear formulation in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#A3.EGx3" title="In A.3 Preference Mapping ‣ Appendix A Application ‣ Deep Active Inference Agents for Delayed and Long-Horizon Environments"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Agent</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Setup</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">For the representation of the actor function, we adopted a simple approximating mapping <math alttext="\Pi" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mi id="A2.SS1.p1.1.m1.1.1" mathvariant="normal" xref="A2.SS1.p1.1.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">roman_Π</annotation></semantics></math>, which concatenates the input with both the first hidden layer and the output values. In this way, the policy parameters are introduced within the generative model and optimized via gradient descent on the EFE, while the rest of the agent parameters are kept fixed. We adhere to the Monte Carlo sampling methodology for calculating the EFE as outlined by Fountas <span class="ltx_text ltx_font_italic" id="A2.SS1.p1.1.1">et al.</span> (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">12</a>]</cite>. We also achieved similar control performance by computing all EFE terms using single-loop forward passes of the generative model repeated multiple times, which was faster and less computationally demanding than the multi-loop scheme presented in the algorithm.</p>
</div>
<div class="ltx_para" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">Bernoulli and Gaussian distributions are employed to model the prediction and state distributions, respectively. We also regularize the state space by applying non-linear activation functions to both the encoder and transition networks. The outputs of these networks define the means and variances of Gaussian-distributed latent states. Specifically, we use the <em class="ltx_emph ltx_font_italic" id="A2.SS1.p2.1.1">tangent hyperbolic</em> (<span class="ltx_text ltx_font_typewriter" id="A2.SS1.p2.1.2">tanh</span>) function for the means, and the <em class="ltx_emph ltx_font_italic" id="A2.SS1.p2.1.3">sigmoid</em> function, scaled by a factor <math alttext="\lambda_{s}\in[1,2]" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.2"><semantics id="A2.SS1.p2.1.m1.2a"><mrow id="A2.SS1.p2.1.m1.2.3" xref="A2.SS1.p2.1.m1.2.3.cmml"><msub id="A2.SS1.p2.1.m1.2.3.2" xref="A2.SS1.p2.1.m1.2.3.2.cmml"><mi id="A2.SS1.p2.1.m1.2.3.2.2" xref="A2.SS1.p2.1.m1.2.3.2.2.cmml">λ</mi><mi id="A2.SS1.p2.1.m1.2.3.2.3" xref="A2.SS1.p2.1.m1.2.3.2.3.cmml">s</mi></msub><mo id="A2.SS1.p2.1.m1.2.3.1" xref="A2.SS1.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="A2.SS1.p2.1.m1.2.3.3.2" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml"><mo id="A2.SS1.p2.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml">1</mn><mo id="A2.SS1.p2.1.m1.2.3.3.2.2" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="A2.SS1.p2.1.m1.2.2" xref="A2.SS1.p2.1.m1.2.2.cmml">2</mn><mo id="A2.SS1.p2.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS1.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.2b"><apply id="A2.SS1.p2.1.m1.2.3.cmml" xref="A2.SS1.p2.1.m1.2.3"><in id="A2.SS1.p2.1.m1.2.3.1.cmml" xref="A2.SS1.p2.1.m1.2.3.1"></in><apply id="A2.SS1.p2.1.m1.2.3.2.cmml" xref="A2.SS1.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.2.3.2.1.cmml" xref="A2.SS1.p2.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS1.p2.1.m1.2.3.2.2.cmml" xref="A2.SS1.p2.1.m1.2.3.2.2">𝜆</ci><ci id="A2.SS1.p2.1.m1.2.3.2.3.cmml" xref="A2.SS1.p2.1.m1.2.3.2.3">𝑠</ci></apply><interval closure="closed" id="A2.SS1.p2.1.m1.2.3.3.1.cmml" xref="A2.SS1.p2.1.m1.2.3.3.2"><cn id="A2.SS1.p2.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p2.1.m1.1.1">1</cn><cn id="A2.SS1.p2.1.m1.2.2.cmml" type="integer" xref="A2.SS1.p2.1.m1.2.2">2</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.2c">\lambda_{s}\in[1,2]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.2d">italic_λ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ [ 1 , 2 ]</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We set <math alttext="\lambda_{s}=1.5" class="ltx_Math" display="inline" id="footnote2.m1.1"><semantics id="footnote2.m1.1b"><mrow id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><msub id="footnote2.m1.1.1.2" xref="footnote2.m1.1.1.2.cmml"><mi id="footnote2.m1.1.1.2.2" xref="footnote2.m1.1.1.2.2.cmml">λ</mi><mi id="footnote2.m1.1.1.2.3" xref="footnote2.m1.1.1.2.3.cmml">s</mi></msub><mo id="footnote2.m1.1.1.1" xref="footnote2.m1.1.1.1.cmml">=</mo><mn id="footnote2.m1.1.1.3" xref="footnote2.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><eq id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1.1"></eq><apply id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1.2"><csymbol cd="ambiguous" id="footnote2.m1.1.1.2.1.cmml" xref="footnote2.m1.1.1.2">subscript</csymbol><ci id="footnote2.m1.1.1.2.2.cmml" xref="footnote2.m1.1.1.2.2">𝜆</ci><ci id="footnote2.m1.1.1.2.3.cmml" xref="footnote2.m1.1.1.2.3">𝑠</ci></apply><cn id="footnote2.m1.1.1.3.cmml" type="float" xref="footnote2.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">\lambda_{s}=1.5</annotation><annotation encoding="application/x-llamapun" id="footnote2.m1.1e">italic_λ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1.5</annotation></semantics></math> to ensure the variance output remains within the non-saturated domain of the sigmoid function, thereby preserving informative gradient flow during training.</span></span></span>, for the variances. This combination enforces additional regularization and contributes to the stability of the latent state space, ensuring values remain bounded and well-suited to a normal distribution.</p>
</div>
<section class="ltx_subsubsection" id="A2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.1.1 </span>Observation</h4>
<div class="ltx_para" id="A2.SS1.SSS1.p1">
<p class="ltx_p" id="A2.SS1.SSS1.p1.9">Given that the problem under study includes <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.1">discrete</em> and <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.2">continuous</em> elements (as we also include <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.3">preference scores</em> in the system states), it has a composite format; at each decision step <math alttext="t" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.1.m1.1"><semantics id="A2.SS1.SSS1.p1.1.m1.1a"><mi id="A2.SS1.SSS1.p1.1.m1.1.1" xref="A2.SS1.SSS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.1.m1.1b"><ci id="A2.SS1.SSS1.p1.1.m1.1.1.cmml" xref="A2.SS1.SSS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.1.m1.1d">italic_t</annotation></semantics></math> the agent observes
<math alttext="o^{(t)}=\bigl{[}\;o^{(t)}_{b},\;o^{(t)}_{m},\;o^{(t)}_{r}\bigr{]}," class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.2.m2.5"><semantics id="A2.SS1.SSS1.p1.2.m2.5a"><mrow id="A2.SS1.SSS1.p1.2.m2.5.5.1" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.cmml"><mrow id="A2.SS1.SSS1.p1.2.m2.5.5.1.1" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.cmml"><msup id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.cmml"><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.2.cmml">o</mi><mrow id="A2.SS1.SSS1.p1.2.m2.1.1.1.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.cmml"><mo id="A2.SS1.SSS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.cmml">(</mo><mi id="A2.SS1.SSS1.p1.2.m2.1.1.1.1" xref="A2.SS1.SSS1.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.cmml">)</mo></mrow></msup><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.4" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.4.cmml">=</mo><mrow id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml"><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.4" maxsize="120%" minsize="120%" rspace="0.280em" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml">[</mo><msubsup id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.cmml"><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.3.cmml">b</mi><mrow id="A2.SS1.SSS1.p1.2.m2.2.2.1.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.cmml"><mo id="A2.SS1.SSS1.p1.2.m2.2.2.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.cmml">(</mo><mi id="A2.SS1.SSS1.p1.2.m2.2.2.1.1" xref="A2.SS1.SSS1.p1.2.m2.2.2.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.2.m2.2.2.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.5" rspace="0.447em" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml">,</mo><msubsup id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.cmml"><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.3.cmml">m</mi><mrow id="A2.SS1.SSS1.p1.2.m2.3.3.1.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.cmml"><mo id="A2.SS1.SSS1.p1.2.m2.3.3.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.cmml">(</mo><mi id="A2.SS1.SSS1.p1.2.m2.3.3.1.1" xref="A2.SS1.SSS1.p1.2.m2.3.3.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.2.m2.3.3.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.6" rspace="0.447em" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml">,</mo><msubsup id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.cmml"><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.3.cmml">r</mi><mrow id="A2.SS1.SSS1.p1.2.m2.4.4.1.3" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.cmml"><mo id="A2.SS1.SSS1.p1.2.m2.4.4.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.cmml">(</mo><mi id="A2.SS1.SSS1.p1.2.m2.4.4.1.1" xref="A2.SS1.SSS1.p1.2.m2.4.4.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.2.m2.4.4.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.cmml">)</mo></mrow></msubsup><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.7" maxsize="120%" minsize="120%" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="A2.SS1.SSS1.p1.2.m2.5.5.1.2" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.2.m2.5b"><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1"><eq id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.4.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.4"></eq><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5">superscript</csymbol><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.5.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.2.m2.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.1.1.1.1">𝑡</ci></apply><list id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.4.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3"><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1">subscript</csymbol><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1">superscript</csymbol><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.2.m2.2.2.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.2.2.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.3.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.1.1.1.3">𝑏</ci></apply><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2">subscript</csymbol><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2">superscript</csymbol><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.2.m2.3.3.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.3.3.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.3.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.2.2.2.3">𝑚</ci></apply><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3">subscript</csymbol><apply id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3">superscript</csymbol><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.2.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.2.m2.4.4.1.1.cmml" xref="A2.SS1.SSS1.p1.2.m2.4.4.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.3.cmml" xref="A2.SS1.SSS1.p1.2.m2.5.5.1.1.3.3.3.3">𝑟</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.2.m2.5c">o^{(t)}=\bigl{[}\;o^{(t)}_{b},\;o^{(t)}_{m},\;o^{(t)}_{r}\bigr{]},</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.2.m2.5d">italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = [ italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ] ,</annotation></semantics></math>
where <math alttext="o^{(t)}_{b}" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.3.m3.1"><semantics id="A2.SS1.SSS1.p1.3.m3.1a"><msubsup id="A2.SS1.SSS1.p1.3.m3.1.2" xref="A2.SS1.SSS1.p1.3.m3.1.2.cmml"><mi id="A2.SS1.SSS1.p1.3.m3.1.2.2.2" xref="A2.SS1.SSS1.p1.3.m3.1.2.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.3.m3.1.2.3" xref="A2.SS1.SSS1.p1.3.m3.1.2.3.cmml">b</mi><mrow id="A2.SS1.SSS1.p1.3.m3.1.1.1.3" xref="A2.SS1.SSS1.p1.3.m3.1.2.cmml"><mo id="A2.SS1.SSS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.3.m3.1.2.cmml">(</mo><mi id="A2.SS1.SSS1.p1.3.m3.1.1.1.1" xref="A2.SS1.SSS1.p1.3.m3.1.1.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.3.m3.1b"><apply id="A2.SS1.SSS1.p1.3.m3.1.2.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.3.m3.1.2.1.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2">subscript</csymbol><apply id="A2.SS1.SSS1.p1.3.m3.1.2.2.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.3.m3.1.2.2.1.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2">superscript</csymbol><ci id="A2.SS1.SSS1.p1.3.m3.1.2.2.2.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.3.m3.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.1.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.3.m3.1.2.3.cmml" xref="A2.SS1.SSS1.p1.3.m3.1.2.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.3.m3.1c">o^{(t)}_{b}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.3.m3.1d">italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>: <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.4">discrete</em> is one–hot buffer-occupancy indicator, <math alttext="o^{(t)}_{m}" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.4.m4.1"><semantics id="A2.SS1.SSS1.p1.4.m4.1a"><msubsup id="A2.SS1.SSS1.p1.4.m4.1.2" xref="A2.SS1.SSS1.p1.4.m4.1.2.cmml"><mi id="A2.SS1.SSS1.p1.4.m4.1.2.2.2" xref="A2.SS1.SSS1.p1.4.m4.1.2.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.4.m4.1.2.3" xref="A2.SS1.SSS1.p1.4.m4.1.2.3.cmml">m</mi><mrow id="A2.SS1.SSS1.p1.4.m4.1.1.1.3" xref="A2.SS1.SSS1.p1.4.m4.1.2.cmml"><mo id="A2.SS1.SSS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.4.m4.1.2.cmml">(</mo><mi id="A2.SS1.SSS1.p1.4.m4.1.1.1.1" xref="A2.SS1.SSS1.p1.4.m4.1.1.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.4.m4.1b"><apply id="A2.SS1.SSS1.p1.4.m4.1.2.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.4.m4.1.2.1.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2">subscript</csymbol><apply id="A2.SS1.SSS1.p1.4.m4.1.2.2.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.4.m4.1.2.2.1.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2">superscript</csymbol><ci id="A2.SS1.SSS1.p1.4.m4.1.2.2.2.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.4.m4.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.1.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.4.m4.1.2.3.cmml" xref="A2.SS1.SSS1.p1.4.m4.1.2.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.4.m4.1c">o^{(t)}_{m}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.4.m4.1d">italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>: <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.5">discrete</em> is one–hot machine-state indicators, and <math alttext="o^{(t)}_{r}" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.5.m5.1"><semantics id="A2.SS1.SSS1.p1.5.m5.1a"><msubsup id="A2.SS1.SSS1.p1.5.m5.1.2" xref="A2.SS1.SSS1.p1.5.m5.1.2.cmml"><mi id="A2.SS1.SSS1.p1.5.m5.1.2.2.2" xref="A2.SS1.SSS1.p1.5.m5.1.2.2.2.cmml">o</mi><mi id="A2.SS1.SSS1.p1.5.m5.1.2.3" xref="A2.SS1.SSS1.p1.5.m5.1.2.3.cmml">r</mi><mrow id="A2.SS1.SSS1.p1.5.m5.1.1.1.3" xref="A2.SS1.SSS1.p1.5.m5.1.2.cmml"><mo id="A2.SS1.SSS1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.5.m5.1.2.cmml">(</mo><mi id="A2.SS1.SSS1.p1.5.m5.1.1.1.1" xref="A2.SS1.SSS1.p1.5.m5.1.1.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.5.m5.1b"><apply id="A2.SS1.SSS1.p1.5.m5.1.2.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.5.m5.1.2.1.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2">subscript</csymbol><apply id="A2.SS1.SSS1.p1.5.m5.1.2.2.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.5.m5.1.2.2.1.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2">superscript</csymbol><ci id="A2.SS1.SSS1.p1.5.m5.1.2.2.2.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2.2.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.5.m5.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.1.1.1">𝑡</ci></apply><ci id="A2.SS1.SSS1.p1.5.m5.1.2.3.cmml" xref="A2.SS1.SSS1.p1.5.m5.1.2.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.5.m5.1c">o^{(t)}_{r}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.5.m5.1d">italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>: <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p1.9.6">continuous</em> real-valued preference scores, includes production, energy, composite terms. Similarly, the generative model outputs the corresponding prediction
<math alttext="P(o^{(t)})=[P_{b},\;P_{m},\;P_{r}]" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.6.m6.5"><semantics id="A2.SS1.SSS1.p1.6.m6.5a"><mrow id="A2.SS1.SSS1.p1.6.m6.5.5" xref="A2.SS1.SSS1.p1.6.m6.5.5.cmml"><mrow id="A2.SS1.SSS1.p1.6.m6.2.2.1" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.cmml"><mi id="A2.SS1.SSS1.p1.6.m6.2.2.1.3" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.3.cmml">P</mi><mo id="A2.SS1.SSS1.p1.6.m6.2.2.1.2" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.2.cmml">⁢</mo><mrow id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml"><mo id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.2" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml">(</mo><msup id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml"><mi id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.2" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.2.cmml">o</mi><mrow id="A2.SS1.SSS1.p1.6.m6.1.1.1.3" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml"><mo id="A2.SS1.SSS1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml">(</mo><mi id="A2.SS1.SSS1.p1.6.m6.1.1.1.1" xref="A2.SS1.SSS1.p1.6.m6.1.1.1.1.cmml">t</mi><mo id="A2.SS1.SSS1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.3" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.SS1.SSS1.p1.6.m6.5.5.5" xref="A2.SS1.SSS1.p1.6.m6.5.5.5.cmml">=</mo><mrow id="A2.SS1.SSS1.p1.6.m6.5.5.4.3" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml"><mo id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.4" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml">[</mo><msub id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.cmml"><mi id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.2" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.2.cmml">P</mi><mi id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.3" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.3.cmml">b</mi></msub><mo id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.5" rspace="0.447em" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml">,</mo><msub id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.cmml"><mi id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.2" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.2.cmml">P</mi><mi id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.3" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.3.cmml">m</mi></msub><mo id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.6" rspace="0.447em" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml">,</mo><msub id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.cmml"><mi id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.2" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.2.cmml">P</mi><mi id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.3" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.3.cmml">r</mi></msub><mo id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.7" stretchy="false" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.6.m6.5b"><apply id="A2.SS1.SSS1.p1.6.m6.5.5.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5"><eq id="A2.SS1.SSS1.p1.6.m6.5.5.5.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.5"></eq><apply id="A2.SS1.SSS1.p1.6.m6.2.2.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1"><times id="A2.SS1.SSS1.p1.6.m6.2.2.1.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.2"></times><ci id="A2.SS1.SSS1.p1.6.m6.2.2.1.3.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.3">𝑃</ci><apply id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1">superscript</csymbol><ci id="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.2">𝑜</ci><ci id="A2.SS1.SSS1.p1.6.m6.1.1.1.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.1.1.1.1">𝑡</ci></apply></apply><list id="A2.SS1.SSS1.p1.6.m6.5.5.4.4.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3"><apply id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1">subscript</csymbol><ci id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.2">𝑃</ci><ci id="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.3.cmml" xref="A2.SS1.SSS1.p1.6.m6.3.3.2.1.1.3">𝑏</ci></apply><apply id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2">subscript</csymbol><ci id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.2">𝑃</ci><ci id="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.3.cmml" xref="A2.SS1.SSS1.p1.6.m6.4.4.3.2.2.3">𝑚</ci></apply><apply id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.1.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3">subscript</csymbol><ci id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.2.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.2">𝑃</ci><ci id="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.3.cmml" xref="A2.SS1.SSS1.p1.6.m6.5.5.4.3.3.3">𝑟</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.6.m6.5c">P(o^{(t)})=[P_{b},\;P_{m},\;P_{r}]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.6.m6.5d">italic_P ( italic_o start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) = [ italic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ]</annotation></semantics></math>,
with all components generated with Bernoulli parameters. As the preference elements contain a continuous component, during EFE computation we need the entropy of the predicted observation distribution. To keep the procedure analytically tractable and consistent with the binary part of the observation, we approximate these continuous preference outputs with Bernoulli-like parameters; i.e. we treat each scalar reward prediction <math alttext="P_{r}\in[0,1]" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.7.m7.2"><semantics id="A2.SS1.SSS1.p1.7.m7.2a"><mrow id="A2.SS1.SSS1.p1.7.m7.2.3" xref="A2.SS1.SSS1.p1.7.m7.2.3.cmml"><msub id="A2.SS1.SSS1.p1.7.m7.2.3.2" xref="A2.SS1.SSS1.p1.7.m7.2.3.2.cmml"><mi id="A2.SS1.SSS1.p1.7.m7.2.3.2.2" xref="A2.SS1.SSS1.p1.7.m7.2.3.2.2.cmml">P</mi><mi id="A2.SS1.SSS1.p1.7.m7.2.3.2.3" xref="A2.SS1.SSS1.p1.7.m7.2.3.2.3.cmml">r</mi></msub><mo id="A2.SS1.SSS1.p1.7.m7.2.3.1" xref="A2.SS1.SSS1.p1.7.m7.2.3.1.cmml">∈</mo><mrow id="A2.SS1.SSS1.p1.7.m7.2.3.3.2" xref="A2.SS1.SSS1.p1.7.m7.2.3.3.1.cmml"><mo id="A2.SS1.SSS1.p1.7.m7.2.3.3.2.1" stretchy="false" xref="A2.SS1.SSS1.p1.7.m7.2.3.3.1.cmml">[</mo><mn id="A2.SS1.SSS1.p1.7.m7.1.1" xref="A2.SS1.SSS1.p1.7.m7.1.1.cmml">0</mn><mo id="A2.SS1.SSS1.p1.7.m7.2.3.3.2.2" xref="A2.SS1.SSS1.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="A2.SS1.SSS1.p1.7.m7.2.2" xref="A2.SS1.SSS1.p1.7.m7.2.2.cmml">1</mn><mo id="A2.SS1.SSS1.p1.7.m7.2.3.3.2.3" stretchy="false" xref="A2.SS1.SSS1.p1.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.7.m7.2b"><apply id="A2.SS1.SSS1.p1.7.m7.2.3.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3"><in id="A2.SS1.SSS1.p1.7.m7.2.3.1.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.1"></in><apply id="A2.SS1.SSS1.p1.7.m7.2.3.2.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.7.m7.2.3.2.1.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.2">subscript</csymbol><ci id="A2.SS1.SSS1.p1.7.m7.2.3.2.2.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.2.2">𝑃</ci><ci id="A2.SS1.SSS1.p1.7.m7.2.3.2.3.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.2.3">𝑟</ci></apply><interval closure="closed" id="A2.SS1.SSS1.p1.7.m7.2.3.3.1.cmml" xref="A2.SS1.SSS1.p1.7.m7.2.3.3.2"><cn id="A2.SS1.SSS1.p1.7.m7.1.1.cmml" type="integer" xref="A2.SS1.SSS1.p1.7.m7.1.1">0</cn><cn id="A2.SS1.SSS1.p1.7.m7.2.2.cmml" type="integer" xref="A2.SS1.SSS1.p1.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.7.m7.2c">P_{r}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.7.m7.2d">italic_P start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> as if it were the mean of a Bernoulli variable when evaluating the entropy term. In practice, this is an approximation <math alttext="P_{r}" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.8.m8.1"><semantics id="A2.SS1.SSS1.p1.8.m8.1a"><msub id="A2.SS1.SSS1.p1.8.m8.1.1" xref="A2.SS1.SSS1.p1.8.m8.1.1.cmml"><mi id="A2.SS1.SSS1.p1.8.m8.1.1.2" xref="A2.SS1.SSS1.p1.8.m8.1.1.2.cmml">P</mi><mi id="A2.SS1.SSS1.p1.8.m8.1.1.3" xref="A2.SS1.SSS1.p1.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.8.m8.1b"><apply id="A2.SS1.SSS1.p1.8.m8.1.1.cmml" xref="A2.SS1.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.SSS1.p1.8.m8.1.1.1.cmml" xref="A2.SS1.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="A2.SS1.SSS1.p1.8.m8.1.1.2.cmml" xref="A2.SS1.SSS1.p1.8.m8.1.1.2">𝑃</ci><ci id="A2.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="A2.SS1.SSS1.p1.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.8.m8.1c">P_{r}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.8.m8.1d">italic_P start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> already lies in <math alttext="[0,1]" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p1.9.m9.2"><semantics id="A2.SS1.SSS1.p1.9.m9.2a"><mrow id="A2.SS1.SSS1.p1.9.m9.2.3.2" xref="A2.SS1.SSS1.p1.9.m9.2.3.1.cmml"><mo id="A2.SS1.SSS1.p1.9.m9.2.3.2.1" stretchy="false" xref="A2.SS1.SSS1.p1.9.m9.2.3.1.cmml">[</mo><mn id="A2.SS1.SSS1.p1.9.m9.1.1" xref="A2.SS1.SSS1.p1.9.m9.1.1.cmml">0</mn><mo id="A2.SS1.SSS1.p1.9.m9.2.3.2.2" xref="A2.SS1.SSS1.p1.9.m9.2.3.1.cmml">,</mo><mn id="A2.SS1.SSS1.p1.9.m9.2.2" xref="A2.SS1.SSS1.p1.9.m9.2.2.cmml">1</mn><mo id="A2.SS1.SSS1.p1.9.m9.2.3.2.3" stretchy="false" xref="A2.SS1.SSS1.p1.9.m9.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p1.9.m9.2b"><interval closure="closed" id="A2.SS1.SSS1.p1.9.m9.2.3.1.cmml" xref="A2.SS1.SSS1.p1.9.m9.2.3.2"><cn id="A2.SS1.SSS1.p1.9.m9.1.1.cmml" type="integer" xref="A2.SS1.SSS1.p1.9.m9.1.1">0</cn><cn id="A2.SS1.SSS1.p1.9.m9.2.2.cmml" type="integer" xref="A2.SS1.SSS1.p1.9.m9.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p1.9.m9.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p1.9.m9.2d">[ 0 , 1 ]</annotation></semantics></math>—yet allows us to reuse the same closed-form binary-entropy expression for both discrete and continuous preference channels to ease the computation.</p>
</div>
<div class="ltx_para" id="A2.SS1.SSS1.p2">
<p class="ltx_p" id="A2.SS1.SSS1.p2.1">When we calculate the third term of the EFE, we need to feed the prediction to the encoder. We sample<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>For ease of calculation, we take the <math alttext="\max" class="ltx_Math" display="inline" id="footnote3.m1.1"><semantics id="footnote3.m1.1b"><mi id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><max id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.1d">\max</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.1e">roman_max</annotation></semantics></math> for the states.</span></span></span> the one-hot parts first and then apply them to the encoder. This differs from earlier AIF implementations such as Fountas <span class="ltx_text ltx_font_italic" id="A2.SS1.SSS1.p2.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.19867v1#bib.bib12" title="">12</a>]</cite>, which feed <em class="ltx_emph ltx_font_italic" id="A2.SS1.SSS1.p2.1.2">mean pixel intensities</em> (i.e. predicted Bernoulli parameters in <math alttext="[0,1]" class="ltx_Math" display="inline" id="A2.SS1.SSS1.p2.1.m1.2"><semantics id="A2.SS1.SSS1.p2.1.m1.2a"><mrow id="A2.SS1.SSS1.p2.1.m1.2.3.2" xref="A2.SS1.SSS1.p2.1.m1.2.3.1.cmml"><mo id="A2.SS1.SSS1.p2.1.m1.2.3.2.1" stretchy="false" xref="A2.SS1.SSS1.p2.1.m1.2.3.1.cmml">[</mo><mn id="A2.SS1.SSS1.p2.1.m1.1.1" xref="A2.SS1.SSS1.p2.1.m1.1.1.cmml">0</mn><mo id="A2.SS1.SSS1.p2.1.m1.2.3.2.2" xref="A2.SS1.SSS1.p2.1.m1.2.3.1.cmml">,</mo><mn id="A2.SS1.SSS1.p2.1.m1.2.2" xref="A2.SS1.SSS1.p2.1.m1.2.2.cmml">1</mn><mo id="A2.SS1.SSS1.p2.1.m1.2.3.2.3" stretchy="false" xref="A2.SS1.SSS1.p2.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS1.p2.1.m1.2b"><interval closure="closed" id="A2.SS1.SSS1.p2.1.m1.2.3.1.cmml" xref="A2.SS1.SSS1.p2.1.m1.2.3.2"><cn id="A2.SS1.SSS1.p2.1.m1.1.1.cmml" type="integer" xref="A2.SS1.SSS1.p2.1.m1.1.1">0</cn><cn id="A2.SS1.SSS1.p2.1.m1.2.2.cmml" type="integer" xref="A2.SS1.SSS1.p2.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS1.p2.1.m1.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS1.p2.1.m1.2d">[ 0 , 1 ]</annotation></semantics></math>) straight back into the encoder.
That works for images, but in our setting (one-hot vectors) it would
(i) ignore the semantics of one-hot codes and (ii) treat each feature independently, discarding correlations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.1.2 </span>Reconstruction Loss</h4>
<div class="ltx_para" id="A2.SS1.SSS2.p1">
<p class="ltx_p" id="A2.SS1.SSS2.p1.1">Based on the format of the observation and the respective prediction, we need to distinguish the reconstruction loss. Accordingly, for a mini-batch of size <math alttext="N" class="ltx_Math" display="inline" id="A2.SS1.SSS2.p1.1.m1.1"><semantics id="A2.SS1.SSS2.p1.1.m1.1a"><mi id="A2.SS1.SSS2.p1.1.m1.1.1" xref="A2.SS1.SSS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS2.p1.1.m1.1b"><ci id="A2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="A2.SS1.SSS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS2.p1.1.m1.1d">italic_N</annotation></semantics></math> we compute
</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A2.E9">
<tbody>
<tr class="ltx_eqn_row" id="A3.EGx5"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E9.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{BCE}_{b}" class="ltx_Math" display="inline" id="A2.E9.1.m1.1"><semantics id="A2.E9.1.m1.1a"><msub id="A2.E9.1.m1.1.1" xref="A2.E9.1.m1.1.1.cmml"><mtext id="A2.E9.1.m1.1.1.2" xref="A2.E9.1.m1.1.1.2a.cmml">BCE</mtext><mi id="A2.E9.1.m1.1.1.3" xref="A2.E9.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A2.E9.1.m1.1b"><apply id="A2.E9.1.m1.1.1.cmml" xref="A2.E9.1.m1.1.1"><csymbol cd="ambiguous" id="A2.E9.1.m1.1.1.1.cmml" xref="A2.E9.1.m1.1.1">subscript</csymbol><ci id="A2.E9.1.m1.1.1.2a.cmml" xref="A2.E9.1.m1.1.1.2"><mtext id="A2.E9.1.m1.1.1.2.cmml" xref="A2.E9.1.m1.1.1.2">BCE</mtext></ci><ci id="A2.E9.1.m1.1.1.3.cmml" xref="A2.E9.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.1.m1.1c">\displaystyle\text{BCE}_{b}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.1.m1.1d">BCE start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{BCE}\ \!\bigl{(}P_{b}^{(i)},\,o_{%
b}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="A2.E9.1.m2.4"><semantics id="A2.E9.1.m2.4a"><mrow id="A2.E9.1.m2.4.4" xref="A2.E9.1.m2.4.4.cmml"><mi id="A2.E9.1.m2.4.4.4" xref="A2.E9.1.m2.4.4.4.cmml"></mi><mo id="A2.E9.1.m2.4.4.3" xref="A2.E9.1.m2.4.4.3.cmml">=</mo><mrow id="A2.E9.1.m2.4.4.2" xref="A2.E9.1.m2.4.4.2.cmml"><mstyle displaystyle="true" id="A2.E9.1.m2.4.4.2.4" xref="A2.E9.1.m2.4.4.2.4.cmml"><mfrac id="A2.E9.1.m2.4.4.2.4a" xref="A2.E9.1.m2.4.4.2.4.cmml"><mn id="A2.E9.1.m2.4.4.2.4.2" xref="A2.E9.1.m2.4.4.2.4.2.cmml">1</mn><mi id="A2.E9.1.m2.4.4.2.4.3" xref="A2.E9.1.m2.4.4.2.4.3.cmml">N</mi></mfrac></mstyle><mo id="A2.E9.1.m2.4.4.2.3" xref="A2.E9.1.m2.4.4.2.3.cmml">⁢</mo><mrow id="A2.E9.1.m2.4.4.2.2" xref="A2.E9.1.m2.4.4.2.2.cmml"><mstyle displaystyle="true" id="A2.E9.1.m2.4.4.2.2.3" xref="A2.E9.1.m2.4.4.2.2.3.cmml"><munderover id="A2.E9.1.m2.4.4.2.2.3a" xref="A2.E9.1.m2.4.4.2.2.3.cmml"><mo id="A2.E9.1.m2.4.4.2.2.3.2.2" movablelimits="false" xref="A2.E9.1.m2.4.4.2.2.3.2.2.cmml">∑</mo><mrow id="A2.E9.1.m2.4.4.2.2.3.2.3" xref="A2.E9.1.m2.4.4.2.2.3.2.3.cmml"><mi id="A2.E9.1.m2.4.4.2.2.3.2.3.2" xref="A2.E9.1.m2.4.4.2.2.3.2.3.2.cmml">i</mi><mo id="A2.E9.1.m2.4.4.2.2.3.2.3.1" xref="A2.E9.1.m2.4.4.2.2.3.2.3.1.cmml">=</mo><mn id="A2.E9.1.m2.4.4.2.2.3.2.3.3" xref="A2.E9.1.m2.4.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="A2.E9.1.m2.4.4.2.2.3.3" xref="A2.E9.1.m2.4.4.2.2.3.3.cmml">N</mi></munderover></mstyle><mrow id="A2.E9.1.m2.4.4.2.2.2" xref="A2.E9.1.m2.4.4.2.2.2.cmml"><mtext id="A2.E9.1.m2.4.4.2.2.2.4" xref="A2.E9.1.m2.4.4.2.2.2.4a.cmml">BCE</mtext><mo id="A2.E9.1.m2.4.4.2.2.2.3" lspace="0.330em" xref="A2.E9.1.m2.4.4.2.2.2.3.cmml">⁢</mo><mrow id="A2.E9.1.m2.4.4.2.2.2.2.2" xref="A2.E9.1.m2.4.4.2.2.2.2.3.cmml"><mo id="A2.E9.1.m2.4.4.2.2.2.2.2.3" maxsize="120%" minsize="120%" xref="A2.E9.1.m2.4.4.2.2.2.2.3.cmml">(</mo><msubsup id="A2.E9.1.m2.3.3.1.1.1.1.1.1" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.cmml"><mi id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.2" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.3" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.3.cmml">b</mi><mrow id="A2.E9.1.m2.1.1.1.3" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A2.E9.1.m2.1.1.1.3.1" stretchy="false" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A2.E9.1.m2.1.1.1.1" xref="A2.E9.1.m2.1.1.1.1.cmml">i</mi><mo id="A2.E9.1.m2.1.1.1.3.2" stretchy="false" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A2.E9.1.m2.4.4.2.2.2.2.2.4" rspace="0.337em" xref="A2.E9.1.m2.4.4.2.2.2.2.3.cmml">,</mo><msubsup id="A2.E9.1.m2.4.4.2.2.2.2.2.2" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.cmml"><mi id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.2" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.2.cmml">o</mi><mi id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.3" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.3.cmml">b</mi><mrow id="A2.E9.1.m2.2.2.1.3" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.cmml"><mo id="A2.E9.1.m2.2.2.1.3.1" stretchy="false" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.cmml">(</mo><mi id="A2.E9.1.m2.2.2.1.1" xref="A2.E9.1.m2.2.2.1.1.cmml">i</mi><mo id="A2.E9.1.m2.2.2.1.3.2" stretchy="false" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A2.E9.1.m2.4.4.2.2.2.2.2.5" maxsize="120%" minsize="120%" xref="A2.E9.1.m2.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9.1.m2.4b"><apply id="A2.E9.1.m2.4.4.cmml" xref="A2.E9.1.m2.4.4"><eq id="A2.E9.1.m2.4.4.3.cmml" xref="A2.E9.1.m2.4.4.3"></eq><csymbol cd="latexml" id="A2.E9.1.m2.4.4.4.cmml" xref="A2.E9.1.m2.4.4.4">absent</csymbol><apply id="A2.E9.1.m2.4.4.2.cmml" xref="A2.E9.1.m2.4.4.2"><times id="A2.E9.1.m2.4.4.2.3.cmml" xref="A2.E9.1.m2.4.4.2.3"></times><apply id="A2.E9.1.m2.4.4.2.4.cmml" xref="A2.E9.1.m2.4.4.2.4"><divide id="A2.E9.1.m2.4.4.2.4.1.cmml" xref="A2.E9.1.m2.4.4.2.4"></divide><cn id="A2.E9.1.m2.4.4.2.4.2.cmml" type="integer" xref="A2.E9.1.m2.4.4.2.4.2">1</cn><ci id="A2.E9.1.m2.4.4.2.4.3.cmml" xref="A2.E9.1.m2.4.4.2.4.3">𝑁</ci></apply><apply id="A2.E9.1.m2.4.4.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2"><apply id="A2.E9.1.m2.4.4.2.2.3.cmml" xref="A2.E9.1.m2.4.4.2.2.3"><csymbol cd="ambiguous" id="A2.E9.1.m2.4.4.2.2.3.1.cmml" xref="A2.E9.1.m2.4.4.2.2.3">superscript</csymbol><apply id="A2.E9.1.m2.4.4.2.2.3.2.cmml" xref="A2.E9.1.m2.4.4.2.2.3"><csymbol cd="ambiguous" id="A2.E9.1.m2.4.4.2.2.3.2.1.cmml" xref="A2.E9.1.m2.4.4.2.2.3">subscript</csymbol><sum id="A2.E9.1.m2.4.4.2.2.3.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2.3.2.2"></sum><apply id="A2.E9.1.m2.4.4.2.2.3.2.3.cmml" xref="A2.E9.1.m2.4.4.2.2.3.2.3"><eq id="A2.E9.1.m2.4.4.2.2.3.2.3.1.cmml" xref="A2.E9.1.m2.4.4.2.2.3.2.3.1"></eq><ci id="A2.E9.1.m2.4.4.2.2.3.2.3.2.cmml" xref="A2.E9.1.m2.4.4.2.2.3.2.3.2">𝑖</ci><cn id="A2.E9.1.m2.4.4.2.2.3.2.3.3.cmml" type="integer" xref="A2.E9.1.m2.4.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="A2.E9.1.m2.4.4.2.2.3.3.cmml" xref="A2.E9.1.m2.4.4.2.2.3.3">𝑁</ci></apply><apply id="A2.E9.1.m2.4.4.2.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2.2"><times id="A2.E9.1.m2.4.4.2.2.2.3.cmml" xref="A2.E9.1.m2.4.4.2.2.2.3"></times><ci id="A2.E9.1.m2.4.4.2.2.2.4a.cmml" xref="A2.E9.1.m2.4.4.2.2.2.4"><mtext id="A2.E9.1.m2.4.4.2.2.2.4.cmml" xref="A2.E9.1.m2.4.4.2.2.2.4">BCE</mtext></ci><interval closure="open" id="A2.E9.1.m2.4.4.2.2.2.2.3.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2"><apply id="A2.E9.1.m2.3.3.1.1.1.1.1.1.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.1.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.2">𝑃</ci><ci id="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="A2.E9.1.m2.3.3.1.1.1.1.1.1.2.3">𝑏</ci></apply><ci id="A2.E9.1.m2.1.1.1.1.cmml" xref="A2.E9.1.m2.1.1.1.1">𝑖</ci></apply><apply id="A2.E9.1.m2.4.4.2.2.2.2.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9.1.m2.4.4.2.2.2.2.2.2.1.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2">superscript</csymbol><apply id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.1.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.2.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.2">𝑜</ci><ci id="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.3.cmml" xref="A2.E9.1.m2.4.4.2.2.2.2.2.2.2.3">𝑏</ci></apply><ci id="A2.E9.1.m2.2.2.1.1.cmml" xref="A2.E9.1.m2.2.2.1.1">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.1.m2.4c">\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{BCE}\ \!\bigl{(}P_{b}^{(i)},\,o_{%
b}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.1.m2.4d">= divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT BCE ( italic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9a)</span></td>
</tr>
<tr class="ltx_eqn_row" id="A3.EGx6"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E9.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{BCE}_{m}" class="ltx_Math" display="inline" id="A2.E9.2.m1.1"><semantics id="A2.E9.2.m1.1a"><msub id="A2.E9.2.m1.1.1" xref="A2.E9.2.m1.1.1.cmml"><mtext id="A2.E9.2.m1.1.1.2" xref="A2.E9.2.m1.1.1.2a.cmml">BCE</mtext><mi id="A2.E9.2.m1.1.1.3" xref="A2.E9.2.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A2.E9.2.m1.1b"><apply id="A2.E9.2.m1.1.1.cmml" xref="A2.E9.2.m1.1.1"><csymbol cd="ambiguous" id="A2.E9.2.m1.1.1.1.cmml" xref="A2.E9.2.m1.1.1">subscript</csymbol><ci id="A2.E9.2.m1.1.1.2a.cmml" xref="A2.E9.2.m1.1.1.2"><mtext id="A2.E9.2.m1.1.1.2.cmml" xref="A2.E9.2.m1.1.1.2">BCE</mtext></ci><ci id="A2.E9.2.m1.1.1.3.cmml" xref="A2.E9.2.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.2.m1.1c">\displaystyle\text{BCE}_{m}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.2.m1.1d">BCE start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{BCE}\ \!\bigl{(}P_{m}^{(i)},\,o_{%
m}^{(i)}\bigr{)}" class="ltx_Math" display="inline" id="A2.E9.2.m2.4"><semantics id="A2.E9.2.m2.4a"><mrow id="A2.E9.2.m2.4.4" xref="A2.E9.2.m2.4.4.cmml"><mi id="A2.E9.2.m2.4.4.4" xref="A2.E9.2.m2.4.4.4.cmml"></mi><mo id="A2.E9.2.m2.4.4.3" xref="A2.E9.2.m2.4.4.3.cmml">=</mo><mrow id="A2.E9.2.m2.4.4.2" xref="A2.E9.2.m2.4.4.2.cmml"><mstyle displaystyle="true" id="A2.E9.2.m2.4.4.2.4" xref="A2.E9.2.m2.4.4.2.4.cmml"><mfrac id="A2.E9.2.m2.4.4.2.4a" xref="A2.E9.2.m2.4.4.2.4.cmml"><mn id="A2.E9.2.m2.4.4.2.4.2" xref="A2.E9.2.m2.4.4.2.4.2.cmml">1</mn><mi id="A2.E9.2.m2.4.4.2.4.3" xref="A2.E9.2.m2.4.4.2.4.3.cmml">N</mi></mfrac></mstyle><mo id="A2.E9.2.m2.4.4.2.3" xref="A2.E9.2.m2.4.4.2.3.cmml">⁢</mo><mrow id="A2.E9.2.m2.4.4.2.2" xref="A2.E9.2.m2.4.4.2.2.cmml"><mstyle displaystyle="true" id="A2.E9.2.m2.4.4.2.2.3" xref="A2.E9.2.m2.4.4.2.2.3.cmml"><munderover id="A2.E9.2.m2.4.4.2.2.3a" xref="A2.E9.2.m2.4.4.2.2.3.cmml"><mo id="A2.E9.2.m2.4.4.2.2.3.2.2" movablelimits="false" xref="A2.E9.2.m2.4.4.2.2.3.2.2.cmml">∑</mo><mrow id="A2.E9.2.m2.4.4.2.2.3.2.3" xref="A2.E9.2.m2.4.4.2.2.3.2.3.cmml"><mi id="A2.E9.2.m2.4.4.2.2.3.2.3.2" xref="A2.E9.2.m2.4.4.2.2.3.2.3.2.cmml">i</mi><mo id="A2.E9.2.m2.4.4.2.2.3.2.3.1" xref="A2.E9.2.m2.4.4.2.2.3.2.3.1.cmml">=</mo><mn id="A2.E9.2.m2.4.4.2.2.3.2.3.3" xref="A2.E9.2.m2.4.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="A2.E9.2.m2.4.4.2.2.3.3" xref="A2.E9.2.m2.4.4.2.2.3.3.cmml">N</mi></munderover></mstyle><mrow id="A2.E9.2.m2.4.4.2.2.2" xref="A2.E9.2.m2.4.4.2.2.2.cmml"><mtext id="A2.E9.2.m2.4.4.2.2.2.4" xref="A2.E9.2.m2.4.4.2.2.2.4a.cmml">BCE</mtext><mo id="A2.E9.2.m2.4.4.2.2.2.3" lspace="0.330em" xref="A2.E9.2.m2.4.4.2.2.2.3.cmml">⁢</mo><mrow id="A2.E9.2.m2.4.4.2.2.2.2.2" xref="A2.E9.2.m2.4.4.2.2.2.2.3.cmml"><mo id="A2.E9.2.m2.4.4.2.2.2.2.2.3" maxsize="120%" minsize="120%" xref="A2.E9.2.m2.4.4.2.2.2.2.3.cmml">(</mo><msubsup id="A2.E9.2.m2.3.3.1.1.1.1.1.1" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.cmml"><mi id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.2" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.3" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.3.cmml">m</mi><mrow id="A2.E9.2.m2.1.1.1.3" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A2.E9.2.m2.1.1.1.3.1" stretchy="false" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A2.E9.2.m2.1.1.1.1" xref="A2.E9.2.m2.1.1.1.1.cmml">i</mi><mo id="A2.E9.2.m2.1.1.1.3.2" stretchy="false" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A2.E9.2.m2.4.4.2.2.2.2.2.4" rspace="0.337em" xref="A2.E9.2.m2.4.4.2.2.2.2.3.cmml">,</mo><msubsup id="A2.E9.2.m2.4.4.2.2.2.2.2.2" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.cmml"><mi id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.2" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.2.cmml">o</mi><mi id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.3" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.3.cmml">m</mi><mrow id="A2.E9.2.m2.2.2.1.3" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.cmml"><mo id="A2.E9.2.m2.2.2.1.3.1" stretchy="false" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.cmml">(</mo><mi id="A2.E9.2.m2.2.2.1.1" xref="A2.E9.2.m2.2.2.1.1.cmml">i</mi><mo id="A2.E9.2.m2.2.2.1.3.2" stretchy="false" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A2.E9.2.m2.4.4.2.2.2.2.2.5" maxsize="120%" minsize="120%" xref="A2.E9.2.m2.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9.2.m2.4b"><apply id="A2.E9.2.m2.4.4.cmml" xref="A2.E9.2.m2.4.4"><eq id="A2.E9.2.m2.4.4.3.cmml" xref="A2.E9.2.m2.4.4.3"></eq><csymbol cd="latexml" id="A2.E9.2.m2.4.4.4.cmml" xref="A2.E9.2.m2.4.4.4">absent</csymbol><apply id="A2.E9.2.m2.4.4.2.cmml" xref="A2.E9.2.m2.4.4.2"><times id="A2.E9.2.m2.4.4.2.3.cmml" xref="A2.E9.2.m2.4.4.2.3"></times><apply id="A2.E9.2.m2.4.4.2.4.cmml" xref="A2.E9.2.m2.4.4.2.4"><divide id="A2.E9.2.m2.4.4.2.4.1.cmml" xref="A2.E9.2.m2.4.4.2.4"></divide><cn id="A2.E9.2.m2.4.4.2.4.2.cmml" type="integer" xref="A2.E9.2.m2.4.4.2.4.2">1</cn><ci id="A2.E9.2.m2.4.4.2.4.3.cmml" xref="A2.E9.2.m2.4.4.2.4.3">𝑁</ci></apply><apply id="A2.E9.2.m2.4.4.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2"><apply id="A2.E9.2.m2.4.4.2.2.3.cmml" xref="A2.E9.2.m2.4.4.2.2.3"><csymbol cd="ambiguous" id="A2.E9.2.m2.4.4.2.2.3.1.cmml" xref="A2.E9.2.m2.4.4.2.2.3">superscript</csymbol><apply id="A2.E9.2.m2.4.4.2.2.3.2.cmml" xref="A2.E9.2.m2.4.4.2.2.3"><csymbol cd="ambiguous" id="A2.E9.2.m2.4.4.2.2.3.2.1.cmml" xref="A2.E9.2.m2.4.4.2.2.3">subscript</csymbol><sum id="A2.E9.2.m2.4.4.2.2.3.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2.3.2.2"></sum><apply id="A2.E9.2.m2.4.4.2.2.3.2.3.cmml" xref="A2.E9.2.m2.4.4.2.2.3.2.3"><eq id="A2.E9.2.m2.4.4.2.2.3.2.3.1.cmml" xref="A2.E9.2.m2.4.4.2.2.3.2.3.1"></eq><ci id="A2.E9.2.m2.4.4.2.2.3.2.3.2.cmml" xref="A2.E9.2.m2.4.4.2.2.3.2.3.2">𝑖</ci><cn id="A2.E9.2.m2.4.4.2.2.3.2.3.3.cmml" type="integer" xref="A2.E9.2.m2.4.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="A2.E9.2.m2.4.4.2.2.3.3.cmml" xref="A2.E9.2.m2.4.4.2.2.3.3">𝑁</ci></apply><apply id="A2.E9.2.m2.4.4.2.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2.2"><times id="A2.E9.2.m2.4.4.2.2.2.3.cmml" xref="A2.E9.2.m2.4.4.2.2.2.3"></times><ci id="A2.E9.2.m2.4.4.2.2.2.4a.cmml" xref="A2.E9.2.m2.4.4.2.2.2.4"><mtext id="A2.E9.2.m2.4.4.2.2.2.4.cmml" xref="A2.E9.2.m2.4.4.2.2.2.4">BCE</mtext></ci><interval closure="open" id="A2.E9.2.m2.4.4.2.2.2.2.3.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2"><apply id="A2.E9.2.m2.3.3.1.1.1.1.1.1.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.2">𝑃</ci><ci id="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="A2.E9.2.m2.3.3.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="A2.E9.2.m2.1.1.1.1.cmml" xref="A2.E9.2.m2.1.1.1.1">𝑖</ci></apply><apply id="A2.E9.2.m2.4.4.2.2.2.2.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9.2.m2.4.4.2.2.2.2.2.2.1.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2">superscript</csymbol><apply id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.1.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.2.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.2">𝑜</ci><ci id="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.3.cmml" xref="A2.E9.2.m2.4.4.2.2.2.2.2.2.2.3">𝑚</ci></apply><ci id="A2.E9.2.m2.2.2.1.1.cmml" xref="A2.E9.2.m2.2.2.1.1">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.2.m2.4c">\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{BCE}\ \!\bigl{(}P_{m}^{(i)},\,o_{%
m}^{(i)}\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.2.m2.4d">= divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT BCE ( italic_P start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9b)</span></td>
</tr>
<tr class="ltx_eqn_row" id="A3.EGx7"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E9.3">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{MAE}_{r}^{(i)}" class="ltx_Math" display="inline" id="A2.E9.3.m1.1"><semantics id="A2.E9.3.m1.1a"><msubsup id="A2.E9.3.m1.1.2" xref="A2.E9.3.m1.1.2.cmml"><mtext id="A2.E9.3.m1.1.2.2.2" xref="A2.E9.3.m1.1.2.2.2a.cmml">MAE</mtext><mi id="A2.E9.3.m1.1.2.2.3" xref="A2.E9.3.m1.1.2.2.3.cmml">r</mi><mrow id="A2.E9.3.m1.1.1.1.3" xref="A2.E9.3.m1.1.2.cmml"><mo id="A2.E9.3.m1.1.1.1.3.1" stretchy="false" xref="A2.E9.3.m1.1.2.cmml">(</mo><mi id="A2.E9.3.m1.1.1.1.1" xref="A2.E9.3.m1.1.1.1.1.cmml">i</mi><mo id="A2.E9.3.m1.1.1.1.3.2" stretchy="false" xref="A2.E9.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.E9.3.m1.1b"><apply id="A2.E9.3.m1.1.2.cmml" xref="A2.E9.3.m1.1.2"><csymbol cd="ambiguous" id="A2.E9.3.m1.1.2.1.cmml" xref="A2.E9.3.m1.1.2">superscript</csymbol><apply id="A2.E9.3.m1.1.2.2.cmml" xref="A2.E9.3.m1.1.2"><csymbol cd="ambiguous" id="A2.E9.3.m1.1.2.2.1.cmml" xref="A2.E9.3.m1.1.2">subscript</csymbol><ci id="A2.E9.3.m1.1.2.2.2a.cmml" xref="A2.E9.3.m1.1.2.2.2"><mtext id="A2.E9.3.m1.1.2.2.2.cmml" xref="A2.E9.3.m1.1.2.2.2">MAE</mtext></ci><ci id="A2.E9.3.m1.1.2.2.3.cmml" xref="A2.E9.3.m1.1.2.2.3">𝑟</ci></apply><ci id="A2.E9.3.m1.1.1.1.1.cmml" xref="A2.E9.3.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.3.m1.1c">\displaystyle\text{MAE}_{r}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.3.m1.1d">MAE start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bigl{|}P_{r}^{(i)}-o_{r}^{(i)}\bigr{|}" class="ltx_Math" display="inline" id="A2.E9.3.m2.3"><semantics id="A2.E9.3.m2.3a"><mrow id="A2.E9.3.m2.3.3" xref="A2.E9.3.m2.3.3.cmml"><mi id="A2.E9.3.m2.3.3.3" xref="A2.E9.3.m2.3.3.3.cmml"></mi><mo id="A2.E9.3.m2.3.3.2" xref="A2.E9.3.m2.3.3.2.cmml">=</mo><mrow id="A2.E9.3.m2.3.3.1.1" xref="A2.E9.3.m2.3.3.1.2.cmml"><mo id="A2.E9.3.m2.3.3.1.1.2" maxsize="120%" minsize="120%" xref="A2.E9.3.m2.3.3.1.2.1.cmml">|</mo><mrow id="A2.E9.3.m2.3.3.1.1.1" xref="A2.E9.3.m2.3.3.1.1.1.cmml"><msubsup id="A2.E9.3.m2.3.3.1.1.1.2" xref="A2.E9.3.m2.3.3.1.1.1.2.cmml"><mi id="A2.E9.3.m2.3.3.1.1.1.2.2.2" xref="A2.E9.3.m2.3.3.1.1.1.2.2.2.cmml">P</mi><mi id="A2.E9.3.m2.3.3.1.1.1.2.2.3" xref="A2.E9.3.m2.3.3.1.1.1.2.2.3.cmml">r</mi><mrow id="A2.E9.3.m2.1.1.1.3" xref="A2.E9.3.m2.3.3.1.1.1.2.cmml"><mo id="A2.E9.3.m2.1.1.1.3.1" stretchy="false" xref="A2.E9.3.m2.3.3.1.1.1.2.cmml">(</mo><mi id="A2.E9.3.m2.1.1.1.1" xref="A2.E9.3.m2.1.1.1.1.cmml">i</mi><mo id="A2.E9.3.m2.1.1.1.3.2" stretchy="false" xref="A2.E9.3.m2.3.3.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="A2.E9.3.m2.3.3.1.1.1.1" xref="A2.E9.3.m2.3.3.1.1.1.1.cmml">−</mo><msubsup id="A2.E9.3.m2.3.3.1.1.1.3" xref="A2.E9.3.m2.3.3.1.1.1.3.cmml"><mi id="A2.E9.3.m2.3.3.1.1.1.3.2.2" xref="A2.E9.3.m2.3.3.1.1.1.3.2.2.cmml">o</mi><mi id="A2.E9.3.m2.3.3.1.1.1.3.2.3" xref="A2.E9.3.m2.3.3.1.1.1.3.2.3.cmml">r</mi><mrow id="A2.E9.3.m2.2.2.1.3" xref="A2.E9.3.m2.3.3.1.1.1.3.cmml"><mo id="A2.E9.3.m2.2.2.1.3.1" stretchy="false" xref="A2.E9.3.m2.3.3.1.1.1.3.cmml">(</mo><mi id="A2.E9.3.m2.2.2.1.1" xref="A2.E9.3.m2.2.2.1.1.cmml">i</mi><mo id="A2.E9.3.m2.2.2.1.3.2" stretchy="false" xref="A2.E9.3.m2.3.3.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A2.E9.3.m2.3.3.1.1.3" maxsize="120%" minsize="120%" xref="A2.E9.3.m2.3.3.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9.3.m2.3b"><apply id="A2.E9.3.m2.3.3.cmml" xref="A2.E9.3.m2.3.3"><eq id="A2.E9.3.m2.3.3.2.cmml" xref="A2.E9.3.m2.3.3.2"></eq><csymbol cd="latexml" id="A2.E9.3.m2.3.3.3.cmml" xref="A2.E9.3.m2.3.3.3">absent</csymbol><apply id="A2.E9.3.m2.3.3.1.2.cmml" xref="A2.E9.3.m2.3.3.1.1"><abs id="A2.E9.3.m2.3.3.1.2.1.cmml" xref="A2.E9.3.m2.3.3.1.1.2"></abs><apply id="A2.E9.3.m2.3.3.1.1.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1"><minus id="A2.E9.3.m2.3.3.1.1.1.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1.1"></minus><apply id="A2.E9.3.m2.3.3.1.1.1.2.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A2.E9.3.m2.3.3.1.1.1.2.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2">superscript</csymbol><apply id="A2.E9.3.m2.3.3.1.1.1.2.2.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A2.E9.3.m2.3.3.1.1.1.2.2.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2">subscript</csymbol><ci id="A2.E9.3.m2.3.3.1.1.1.2.2.2.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2.2.2">𝑃</ci><ci id="A2.E9.3.m2.3.3.1.1.1.2.2.3.cmml" xref="A2.E9.3.m2.3.3.1.1.1.2.2.3">𝑟</ci></apply><ci id="A2.E9.3.m2.1.1.1.1.cmml" xref="A2.E9.3.m2.1.1.1.1">𝑖</ci></apply><apply id="A2.E9.3.m2.3.3.1.1.1.3.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E9.3.m2.3.3.1.1.1.3.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3">superscript</csymbol><apply id="A2.E9.3.m2.3.3.1.1.1.3.2.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E9.3.m2.3.3.1.1.1.3.2.1.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3">subscript</csymbol><ci id="A2.E9.3.m2.3.3.1.1.1.3.2.2.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3.2.2">𝑜</ci><ci id="A2.E9.3.m2.3.3.1.1.1.3.2.3.cmml" xref="A2.E9.3.m2.3.3.1.1.1.3.2.3">𝑟</ci></apply><ci id="A2.E9.3.m2.2.2.1.1.cmml" xref="A2.E9.3.m2.2.2.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.3.m2.3c">\displaystyle=\bigl{|}P_{r}^{(i)}-o_{r}^{(i)}\bigr{|}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.3.m2.3d">= | italic_P start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - italic_o start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9c)</span></td>
</tr>
<tr class="ltx_eqn_row" id="A3.EGx8"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A2.E9.4">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{MSE}_{r}" class="ltx_Math" display="inline" id="A2.E9.4.m1.1"><semantics id="A2.E9.4.m1.1a"><msub id="A2.E9.4.m1.1.1" xref="A2.E9.4.m1.1.1.cmml"><mtext id="A2.E9.4.m1.1.1.2" xref="A2.E9.4.m1.1.1.2a.cmml">MSE</mtext><mi id="A2.E9.4.m1.1.1.3" xref="A2.E9.4.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.E9.4.m1.1b"><apply id="A2.E9.4.m1.1.1.cmml" xref="A2.E9.4.m1.1.1"><csymbol cd="ambiguous" id="A2.E9.4.m1.1.1.1.cmml" xref="A2.E9.4.m1.1.1">subscript</csymbol><ci id="A2.E9.4.m1.1.1.2a.cmml" xref="A2.E9.4.m1.1.1.2"><mtext id="A2.E9.4.m1.1.1.2.cmml" xref="A2.E9.4.m1.1.1.2">MSE</mtext></ci><ci id="A2.E9.4.m1.1.1.3.cmml" xref="A2.E9.4.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.4.m1.1c">\displaystyle\text{MSE}_{r}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.4.m1.1d">MSE start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\Bigl{[}-\log\ \!\bigl{(}1-\text{MAE}_{%
r}^{(i)}+\varepsilon\bigr{)}\Bigr{]}" class="ltx_Math" display="inline" id="A2.E9.4.m2.3"><semantics id="A2.E9.4.m2.3a"><mrow id="A2.E9.4.m2.3.3" xref="A2.E9.4.m2.3.3.cmml"><mi id="A2.E9.4.m2.3.3.3" xref="A2.E9.4.m2.3.3.3.cmml"></mi><mo id="A2.E9.4.m2.3.3.2" xref="A2.E9.4.m2.3.3.2.cmml">=</mo><mrow id="A2.E9.4.m2.3.3.1" xref="A2.E9.4.m2.3.3.1.cmml"><mstyle displaystyle="true" id="A2.E9.4.m2.3.3.1.3" xref="A2.E9.4.m2.3.3.1.3.cmml"><mfrac id="A2.E9.4.m2.3.3.1.3a" xref="A2.E9.4.m2.3.3.1.3.cmml"><mn id="A2.E9.4.m2.3.3.1.3.2" xref="A2.E9.4.m2.3.3.1.3.2.cmml">1</mn><mi id="A2.E9.4.m2.3.3.1.3.3" xref="A2.E9.4.m2.3.3.1.3.3.cmml">N</mi></mfrac></mstyle><mo id="A2.E9.4.m2.3.3.1.2" xref="A2.E9.4.m2.3.3.1.2.cmml">⁢</mo><mrow id="A2.E9.4.m2.3.3.1.1" xref="A2.E9.4.m2.3.3.1.1.cmml"><mstyle displaystyle="true" id="A2.E9.4.m2.3.3.1.1.2" xref="A2.E9.4.m2.3.3.1.1.2.cmml"><munderover id="A2.E9.4.m2.3.3.1.1.2a" xref="A2.E9.4.m2.3.3.1.1.2.cmml"><mo id="A2.E9.4.m2.3.3.1.1.2.2.2" movablelimits="false" xref="A2.E9.4.m2.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="A2.E9.4.m2.3.3.1.1.2.2.3" xref="A2.E9.4.m2.3.3.1.1.2.2.3.cmml"><mi id="A2.E9.4.m2.3.3.1.1.2.2.3.2" xref="A2.E9.4.m2.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="A2.E9.4.m2.3.3.1.1.2.2.3.1" xref="A2.E9.4.m2.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="A2.E9.4.m2.3.3.1.1.2.2.3.3" xref="A2.E9.4.m2.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A2.E9.4.m2.3.3.1.1.2.3" xref="A2.E9.4.m2.3.3.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="A2.E9.4.m2.3.3.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.2.cmml"><mo id="A2.E9.4.m2.3.3.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A2.E9.4.m2.3.3.1.1.1.2.1.cmml">[</mo><mrow id="A2.E9.4.m2.3.3.1.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.cmml"><mo id="A2.E9.4.m2.3.3.1.1.1.1.1a" rspace="0.167em" xref="A2.E9.4.m2.3.3.1.1.1.1.1.cmml">−</mo><mrow id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="A2.E9.4.m2.2.2" xref="A2.E9.4.m2.2.2.cmml">log</mi><mo id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1a" lspace="0.330em" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml"><mo id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">1</mn><mo id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">−</mo><msubsup id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mtext id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml">MAE</mtext><mi id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">r</mi><mrow id="A2.E9.4.m2.1.1.1.3" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="A2.E9.4.m2.1.1.1.3.1" stretchy="false" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="A2.E9.4.m2.1.1.1.1" xref="A2.E9.4.m2.1.1.1.1.cmml">i</mi><mo id="A2.E9.4.m2.1.1.1.3.2" stretchy="false" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">ε</mi></mrow><mo id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E9.4.m2.3.3.1.1.1.1.3" maxsize="160%" minsize="160%" xref="A2.E9.4.m2.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E9.4.m2.3b"><apply id="A2.E9.4.m2.3.3.cmml" xref="A2.E9.4.m2.3.3"><eq id="A2.E9.4.m2.3.3.2.cmml" xref="A2.E9.4.m2.3.3.2"></eq><csymbol cd="latexml" id="A2.E9.4.m2.3.3.3.cmml" xref="A2.E9.4.m2.3.3.3">absent</csymbol><apply id="A2.E9.4.m2.3.3.1.cmml" xref="A2.E9.4.m2.3.3.1"><times id="A2.E9.4.m2.3.3.1.2.cmml" xref="A2.E9.4.m2.3.3.1.2"></times><apply id="A2.E9.4.m2.3.3.1.3.cmml" xref="A2.E9.4.m2.3.3.1.3"><divide id="A2.E9.4.m2.3.3.1.3.1.cmml" xref="A2.E9.4.m2.3.3.1.3"></divide><cn id="A2.E9.4.m2.3.3.1.3.2.cmml" type="integer" xref="A2.E9.4.m2.3.3.1.3.2">1</cn><ci id="A2.E9.4.m2.3.3.1.3.3.cmml" xref="A2.E9.4.m2.3.3.1.3.3">𝑁</ci></apply><apply id="A2.E9.4.m2.3.3.1.1.cmml" xref="A2.E9.4.m2.3.3.1.1"><apply id="A2.E9.4.m2.3.3.1.1.2.cmml" xref="A2.E9.4.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E9.4.m2.3.3.1.1.2.1.cmml" xref="A2.E9.4.m2.3.3.1.1.2">superscript</csymbol><apply id="A2.E9.4.m2.3.3.1.1.2.2.cmml" xref="A2.E9.4.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E9.4.m2.3.3.1.1.2.2.1.cmml" xref="A2.E9.4.m2.3.3.1.1.2">subscript</csymbol><sum id="A2.E9.4.m2.3.3.1.1.2.2.2.cmml" xref="A2.E9.4.m2.3.3.1.1.2.2.2"></sum><apply id="A2.E9.4.m2.3.3.1.1.2.2.3.cmml" xref="A2.E9.4.m2.3.3.1.1.2.2.3"><eq id="A2.E9.4.m2.3.3.1.1.2.2.3.1.cmml" xref="A2.E9.4.m2.3.3.1.1.2.2.3.1"></eq><ci id="A2.E9.4.m2.3.3.1.1.2.2.3.2.cmml" xref="A2.E9.4.m2.3.3.1.1.2.2.3.2">𝑖</ci><cn id="A2.E9.4.m2.3.3.1.1.2.2.3.3.cmml" type="integer" xref="A2.E9.4.m2.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="A2.E9.4.m2.3.3.1.1.2.3.cmml" xref="A2.E9.4.m2.3.3.1.1.2.3">𝑁</ci></apply><apply id="A2.E9.4.m2.3.3.1.1.1.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A2.E9.4.m2.3.3.1.1.1.2.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1"><minus id="A2.E9.4.m2.3.3.1.1.1.1.1.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1"></minus><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1"><log id="A2.E9.4.m2.2.2.cmml" xref="A2.E9.4.m2.2.2"></log><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1"><plus id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2"><minus id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.1"></minus><cn id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.2">1</cn><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2"><mtext id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.2">MAE</mtext></ci><ci id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑟</ci></apply><ci id="A2.E9.4.m2.1.1.1.1.cmml" xref="A2.E9.4.m2.1.1.1.1">𝑖</ci></apply></apply><ci id="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E9.4.m2.3.3.1.1.1.1.1.1.1.1.1.3">𝜀</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E9.4.m2.3c">\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\Bigl{[}-\log\ \!\bigl{(}1-\text{MAE}_{%
r}^{(i)}+\varepsilon\bigr{)}\Bigr{]}</annotation><annotation encoding="application/x-llamapun" id="A2.E9.4.m2.3d">= divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ - roman_log ( 1 - MAE start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT + italic_ε ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9d)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="A2.SS1.SSS2.p2">
<p class="ltx_p" id="A2.SS1.SSS2.p2.1">This combines binary cross-entropy (BCE) with an exponential-like term for the continuous elements. Given that preference is generally more important than the other elements, and that buffer level is more important than the machine state, we weight these elements. Finally, it is combined with the usual <math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS1.SSS2.p2.1.m1.1"><semantics id="A2.SS1.SSS2.p2.1.m1.1a"><mi id="A2.SS1.SSS2.p2.1.m1.1.1" xref="A2.SS1.SSS2.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.SSS2.p2.1.m1.1b"><ci id="A2.SS1.SSS2.p2.1.m1.1.1.cmml" xref="A2.SS1.SSS2.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.SSS2.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.SSS2.p2.1.m1.1d">italic_β</annotation></semantics></math>-VAE regularization term and passed to the optimizer as:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{o}=\underbrace{\frac{2}{7}\,\text{BCE}_{b}+\frac{1}{7}\,\text{BCE%
}_{m}+\frac{4}{7}\,\text{MSE}_{r}}_{\text{reconstruction}}\;+\;\underbrace{%
\beta\,*D_{\mathrm{KL}}\!\bigl{(}q(s)\,\|\,\mathcal{N}(\mathbf{0},\mathbf{I})%
\bigr{)}}_{\text{$\beta$ regularization}}." class="ltx_Math" display="block" id="A2.E10.m1.6"><semantics id="A2.E10.m1.6a"><mrow id="A2.E10.m1.6.6.1" xref="A2.E10.m1.6.6.1.1.cmml"><mrow id="A2.E10.m1.6.6.1.1" xref="A2.E10.m1.6.6.1.1.cmml"><msub id="A2.E10.m1.6.6.1.1.2" xref="A2.E10.m1.6.6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.E10.m1.6.6.1.1.2.2" xref="A2.E10.m1.6.6.1.1.2.2.cmml">ℒ</mi><mi id="A2.E10.m1.6.6.1.1.2.3" xref="A2.E10.m1.6.6.1.1.2.3.cmml">o</mi></msub><mo id="A2.E10.m1.6.6.1.1.1" xref="A2.E10.m1.6.6.1.1.1.cmml">=</mo><mrow id="A2.E10.m1.6.6.1.1.3" xref="A2.E10.m1.6.6.1.1.3.cmml"><munder id="A2.E10.m1.6.6.1.1.3.2" xref="A2.E10.m1.6.6.1.1.3.2.cmml"><munder accentunder="true" id="A2.E10.m1.6.6.1.1.3.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.cmml"><mrow id="A2.E10.m1.6.6.1.1.3.2.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.cmml"><mrow id="A2.E10.m1.6.6.1.1.3.2.2.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.cmml"><mfrac id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.cmml"><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.2.cmml">2</mn><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.3.cmml">7</mn></mfrac><mo id="A2.E10.m1.6.6.1.1.3.2.2.2.2.1" lspace="0.170em" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.1.cmml">⁢</mo><msub id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.cmml"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2a.cmml">BCE</mtext><mi id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.3.cmml">b</mi></msub></mrow><mo id="A2.E10.m1.6.6.1.1.3.2.2.2.1" xref="A2.E10.m1.6.6.1.1.3.2.2.2.1.cmml">+</mo><mrow id="A2.E10.m1.6.6.1.1.3.2.2.2.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.cmml"><mfrac id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.cmml"><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.2.cmml">1</mn><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.3.cmml">7</mn></mfrac><mo id="A2.E10.m1.6.6.1.1.3.2.2.2.3.1" lspace="0.170em" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.1.cmml">⁢</mo><msub id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.cmml"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2a.cmml">BCE</mtext><mi id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.3.cmml">m</mi></msub></mrow><mo id="A2.E10.m1.6.6.1.1.3.2.2.2.1a" xref="A2.E10.m1.6.6.1.1.3.2.2.2.1.cmml">+</mo><mrow id="A2.E10.m1.6.6.1.1.3.2.2.2.4" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.cmml"><mfrac id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.cmml"><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.2.cmml">4</mn><mn id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.3.cmml">7</mn></mfrac><mo id="A2.E10.m1.6.6.1.1.3.2.2.2.4.1" lspace="0.170em" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.1.cmml">⁢</mo><msub id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.cmml"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2a.cmml">MSE</mtext><mi id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.3" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.3.cmml">r</mi></msub></mrow></mrow><mo id="A2.E10.m1.6.6.1.1.3.2.2.1" xref="A2.E10.m1.6.6.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="A2.E10.m1.6.6.1.1.3.2.3" xref="A2.E10.m1.6.6.1.1.3.2.3a.cmml">reconstruction</mtext></munder><mo id="A2.E10.m1.6.6.1.1.3.1" rspace="0.502em" xref="A2.E10.m1.6.6.1.1.3.1.cmml">+</mo><munder id="A2.E10.m1.6.6.1.1.3.3" xref="A2.E10.m1.6.6.1.1.3.3.cmml"><munder accentunder="true" id="A2.E10.m1.5.5" xref="A2.E10.m1.5.5.cmml"><mrow id="A2.E10.m1.5.5.4" xref="A2.E10.m1.5.5.4.cmml"><mrow id="A2.E10.m1.5.5.4.6" xref="A2.E10.m1.5.5.4.6.cmml"><mi id="A2.E10.m1.5.5.4.6.2" xref="A2.E10.m1.5.5.4.6.2.cmml">β</mi><mo id="A2.E10.m1.5.5.4.6.1" lspace="0.392em" rspace="0.222em" xref="A2.E10.m1.5.5.4.6.1.cmml">∗</mo><msub id="A2.E10.m1.5.5.4.6.3" xref="A2.E10.m1.5.5.4.6.3.cmml"><mi id="A2.E10.m1.5.5.4.6.3.2" xref="A2.E10.m1.5.5.4.6.3.2.cmml">D</mi><mi id="A2.E10.m1.5.5.4.6.3.3" xref="A2.E10.m1.5.5.4.6.3.3.cmml">KL</mi></msub></mrow><mo id="A2.E10.m1.5.5.4.5" xref="A2.E10.m1.5.5.4.5.cmml">⁢</mo><mrow id="A2.E10.m1.5.5.4.4.1" xref="A2.E10.m1.5.5.4.4.1.1.cmml"><mo id="A2.E10.m1.5.5.4.4.1.2" maxsize="120%" minsize="120%" xref="A2.E10.m1.5.5.4.4.1.1.cmml">(</mo><mrow id="A2.E10.m1.5.5.4.4.1.1" xref="A2.E10.m1.5.5.4.4.1.1.cmml"><mrow id="A2.E10.m1.5.5.4.4.1.1.2" xref="A2.E10.m1.5.5.4.4.1.1.2.cmml"><mi id="A2.E10.m1.5.5.4.4.1.1.2.2" xref="A2.E10.m1.5.5.4.4.1.1.2.2.cmml">q</mi><mo id="A2.E10.m1.5.5.4.4.1.1.2.1" xref="A2.E10.m1.5.5.4.4.1.1.2.1.cmml">⁢</mo><mrow id="A2.E10.m1.5.5.4.4.1.1.2.3.2" xref="A2.E10.m1.5.5.4.4.1.1.2.cmml"><mo id="A2.E10.m1.5.5.4.4.1.1.2.3.2.1" stretchy="false" xref="A2.E10.m1.5.5.4.4.1.1.2.cmml">(</mo><mi id="A2.E10.m1.2.2.1.1" xref="A2.E10.m1.2.2.1.1.cmml">s</mi><mo id="A2.E10.m1.5.5.4.4.1.1.2.3.2.2" rspace="0.170em" stretchy="false" xref="A2.E10.m1.5.5.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E10.m1.5.5.4.4.1.1.1" rspace="0.448em" xref="A2.E10.m1.5.5.4.4.1.1.1.cmml">∥</mo><mrow id="A2.E10.m1.5.5.4.4.1.1.3" xref="A2.E10.m1.5.5.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.E10.m1.5.5.4.4.1.1.3.2" xref="A2.E10.m1.5.5.4.4.1.1.3.2.cmml">𝒩</mi><mo id="A2.E10.m1.5.5.4.4.1.1.3.1" xref="A2.E10.m1.5.5.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A2.E10.m1.5.5.4.4.1.1.3.3.2" xref="A2.E10.m1.5.5.4.4.1.1.3.3.1.cmml"><mo id="A2.E10.m1.5.5.4.4.1.1.3.3.2.1" stretchy="false" xref="A2.E10.m1.5.5.4.4.1.1.3.3.1.cmml">(</mo><mn id="A2.E10.m1.3.3.2.2" xref="A2.E10.m1.3.3.2.2.cmml">𝟎</mn><mo id="A2.E10.m1.5.5.4.4.1.1.3.3.2.2" xref="A2.E10.m1.5.5.4.4.1.1.3.3.1.cmml">,</mo><mi id="A2.E10.m1.4.4.3.3" xref="A2.E10.m1.4.4.3.3.cmml">𝐈</mi><mo id="A2.E10.m1.5.5.4.4.1.1.3.3.2.3" stretchy="false" xref="A2.E10.m1.5.5.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E10.m1.5.5.4.4.1.3" maxsize="120%" minsize="120%" xref="A2.E10.m1.5.5.4.4.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E10.m1.5.5.5" xref="A2.E10.m1.5.5.5.cmml">⏟</mo></munder><mrow id="A2.E10.m1.1.1.1" xref="A2.E10.m1.1.1.1b.cmml"><mi id="A2.E10.m1.1.1.1.1.1.m1.1.1" xref="A2.E10.m1.1.1.1.1.1.m1.1.1.cmml">β</mi><mtext id="A2.E10.m1.1.1.1a" xref="A2.E10.m1.1.1.1b.cmml"> regularization</mtext></mrow></munder></mrow></mrow><mo id="A2.E10.m1.6.6.1.2" lspace="0em" xref="A2.E10.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E10.m1.6b"><apply id="A2.E10.m1.6.6.1.1.cmml" xref="A2.E10.m1.6.6.1"><eq id="A2.E10.m1.6.6.1.1.1.cmml" xref="A2.E10.m1.6.6.1.1.1"></eq><apply id="A2.E10.m1.6.6.1.1.2.cmml" xref="A2.E10.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.2.1.cmml" xref="A2.E10.m1.6.6.1.1.2">subscript</csymbol><ci id="A2.E10.m1.6.6.1.1.2.2.cmml" xref="A2.E10.m1.6.6.1.1.2.2">ℒ</ci><ci id="A2.E10.m1.6.6.1.1.2.3.cmml" xref="A2.E10.m1.6.6.1.1.2.3">𝑜</ci></apply><apply id="A2.E10.m1.6.6.1.1.3.cmml" xref="A2.E10.m1.6.6.1.1.3"><plus id="A2.E10.m1.6.6.1.1.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.1"></plus><apply id="A2.E10.m1.6.6.1.1.3.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.3.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2">subscript</csymbol><apply id="A2.E10.m1.6.6.1.1.3.2.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2"><ci id="A2.E10.m1.6.6.1.1.3.2.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.1">⏟</ci><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2"><plus id="A2.E10.m1.6.6.1.1.3.2.2.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.1"></plus><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2"><times id="A2.E10.m1.6.6.1.1.3.2.2.2.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.1"></times><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2"><divide id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2"></divide><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.2.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.2">2</cn><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.3.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.2.3">7</cn></apply><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3">subscript</csymbol><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2a.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.2">BCE</mtext></ci><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.2.3.3">𝑏</ci></apply></apply><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3"><times id="A2.E10.m1.6.6.1.1.3.2.2.2.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.1"></times><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2"><divide id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2"></divide><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.2.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.2">1</cn><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.3.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.2.3">7</cn></apply><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3">subscript</csymbol><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2a.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.2">BCE</mtext></ci><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.3.3.3">𝑚</ci></apply></apply><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.4.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4"><times id="A2.E10.m1.6.6.1.1.3.2.2.2.4.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.1"></times><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2"><divide id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2"></divide><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.2.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.2">4</cn><cn id="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.3.cmml" type="integer" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.2.3">7</cn></apply><apply id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3">subscript</csymbol><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2a.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2"><mtext id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.2">MSE</mtext></ci><ci id="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.3.cmml" xref="A2.E10.m1.6.6.1.1.3.2.2.2.4.3.3">𝑟</ci></apply></apply></apply></apply><ci id="A2.E10.m1.6.6.1.1.3.2.3a.cmml" xref="A2.E10.m1.6.6.1.1.3.2.3"><mtext id="A2.E10.m1.6.6.1.1.3.2.3.cmml" mathsize="70%" xref="A2.E10.m1.6.6.1.1.3.2.3">reconstruction</mtext></ci></apply><apply id="A2.E10.m1.6.6.1.1.3.3.cmml" xref="A2.E10.m1.6.6.1.1.3.3"><csymbol cd="ambiguous" id="A2.E10.m1.6.6.1.1.3.3.1.cmml" xref="A2.E10.m1.6.6.1.1.3.3">subscript</csymbol><apply id="A2.E10.m1.5.5.cmml" xref="A2.E10.m1.5.5"><ci id="A2.E10.m1.5.5.5.cmml" xref="A2.E10.m1.5.5.5">⏟</ci><apply id="A2.E10.m1.5.5.4.cmml" xref="A2.E10.m1.5.5.4"><times id="A2.E10.m1.5.5.4.5.cmml" xref="A2.E10.m1.5.5.4.5"></times><apply id="A2.E10.m1.5.5.4.6.cmml" xref="A2.E10.m1.5.5.4.6"><times id="A2.E10.m1.5.5.4.6.1.cmml" xref="A2.E10.m1.5.5.4.6.1"></times><ci id="A2.E10.m1.5.5.4.6.2.cmml" xref="A2.E10.m1.5.5.4.6.2">𝛽</ci><apply id="A2.E10.m1.5.5.4.6.3.cmml" xref="A2.E10.m1.5.5.4.6.3"><csymbol cd="ambiguous" id="A2.E10.m1.5.5.4.6.3.1.cmml" xref="A2.E10.m1.5.5.4.6.3">subscript</csymbol><ci id="A2.E10.m1.5.5.4.6.3.2.cmml" xref="A2.E10.m1.5.5.4.6.3.2">𝐷</ci><ci id="A2.E10.m1.5.5.4.6.3.3.cmml" xref="A2.E10.m1.5.5.4.6.3.3">KL</ci></apply></apply><apply id="A2.E10.m1.5.5.4.4.1.1.cmml" xref="A2.E10.m1.5.5.4.4.1"><csymbol cd="latexml" id="A2.E10.m1.5.5.4.4.1.1.1.cmml" xref="A2.E10.m1.5.5.4.4.1.1.1">conditional</csymbol><apply id="A2.E10.m1.5.5.4.4.1.1.2.cmml" xref="A2.E10.m1.5.5.4.4.1.1.2"><times id="A2.E10.m1.5.5.4.4.1.1.2.1.cmml" xref="A2.E10.m1.5.5.4.4.1.1.2.1"></times><ci id="A2.E10.m1.5.5.4.4.1.1.2.2.cmml" xref="A2.E10.m1.5.5.4.4.1.1.2.2">𝑞</ci><ci id="A2.E10.m1.2.2.1.1.cmml" xref="A2.E10.m1.2.2.1.1">𝑠</ci></apply><apply id="A2.E10.m1.5.5.4.4.1.1.3.cmml" xref="A2.E10.m1.5.5.4.4.1.1.3"><times id="A2.E10.m1.5.5.4.4.1.1.3.1.cmml" xref="A2.E10.m1.5.5.4.4.1.1.3.1"></times><ci id="A2.E10.m1.5.5.4.4.1.1.3.2.cmml" xref="A2.E10.m1.5.5.4.4.1.1.3.2">𝒩</ci><interval closure="open" id="A2.E10.m1.5.5.4.4.1.1.3.3.1.cmml" xref="A2.E10.m1.5.5.4.4.1.1.3.3.2"><cn id="A2.E10.m1.3.3.2.2.cmml" type="integer" xref="A2.E10.m1.3.3.2.2">0</cn><ci id="A2.E10.m1.4.4.3.3.cmml" xref="A2.E10.m1.4.4.3.3">𝐈</ci></interval></apply></apply></apply></apply><ci id="A2.E10.m1.1.1.1b.cmml" xref="A2.E10.m1.1.1.1"><mrow id="A2.E10.m1.1.1.1.cmml" xref="A2.E10.m1.1.1.1"><mi id="A2.E10.m1.1.1.1.1.1.m1.1.1.cmml" mathsize="70%" xref="A2.E10.m1.1.1.1.1.1.m1.1.1">β</mi><mtext id="A2.E10.m1.1.1.1a.cmml" mathsize="70%" xref="A2.E10.m1.1.1.1"> regularization</mtext></mrow></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E10.m1.6c">\mathcal{L}_{o}=\underbrace{\frac{2}{7}\,\text{BCE}_{b}+\frac{1}{7}\,\text{BCE%
}_{m}+\frac{4}{7}\,\text{MSE}_{r}}_{\text{reconstruction}}\;+\;\underbrace{%
\beta\,*D_{\mathrm{KL}}\!\bigl{(}q(s)\,\|\,\mathcal{N}(\mathbf{0},\mathbf{I})%
\bigr{)}}_{\text{$\beta$ regularization}}.</annotation><annotation encoding="application/x-llamapun" id="A2.E10.m1.6d">caligraphic_L start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT = under⏟ start_ARG divide start_ARG 2 end_ARG start_ARG 7 end_ARG BCE start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT + divide start_ARG 1 end_ARG start_ARG 7 end_ARG BCE start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT + divide start_ARG 4 end_ARG start_ARG 7 end_ARG MSE start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT reconstruction end_POSTSUBSCRIPT + under⏟ start_ARG italic_β ∗ italic_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( italic_q ( italic_s ) ∥ caligraphic_N ( bold_0 , bold_I ) ) end_ARG start_POSTSUBSCRIPT italic_β regularization end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experiments</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Code</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">The code and data are available at <a class="ltx_ref ltx_href" href="https://github.com/YavarYeganeh/Deep_AIF" title="">https://github.com/YavarYeganeh/Deep_AIF</a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Training and Evaluation Procedure</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.2">During each training epoch, an environment is initialized with the parameters of the industrial system, including stochastic processes. The system first undergoes a one-day warm-up period in simulation time using the <em class="ltx_emph ltx_font_italic" id="A3.SS2.p1.2.1">ALL ON</em> policy. The resulting profile from this warm-up is discarded. This is followed by another one-day simulation using a <em class="ltx_emph ltx_font_italic" id="A3.SS2.p1.2.2">random</em> policy to bring the system to a fully random and uncontrolled state. Then, the agent, equipped with experience replay, interacts with the system. During each epoch, the model is trained for several iterations, with updates both for the model and actor occurring every <math alttext="H" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.1"><semantics id="A3.SS2.p1.1.m1.1a"><mi id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><ci id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.1.m1.1d">italic_H</annotation></semantics></math> steps, following sampling from the experience memory. After each epoch, the agent’s performance is validated on three independent and randomly instantiated environments that undergo the same warm-up and random initialization steps. These validation episodes span one day of simulation, during which no model learning or experience gathering occurs, except for gradient fine-tuning of the actor every <math alttext="H" class="ltx_Math" display="inline" id="A3.SS2.p1.2.m2.1"><semantics id="A3.SS2.p1.2.m2.1a"><mi id="A3.SS2.p1.2.m2.1.1" xref="A3.SS2.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.2.m2.1b"><ci id="A3.SS2.p1.2.m2.1.1.cmml" xref="A3.SS2.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.2.m2.1d">italic_H</annotation></semantics></math> steps. The performance is then averaged, and the standard deviation is computed. While all previous performance metrics are based on the preference score, the best-performing agent during validation is retrieved and tested for 30 days of simulation on 10 independent and randomly instantiated environments. These environments follow the same initialization protocol, except for a 10-day warm-up to ensure consistency. Final performance of relative energy efficiency is averaged over the 10 environments, along with the computation of standard deviations.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon May 26 11:15:56 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
