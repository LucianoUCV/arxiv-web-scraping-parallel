<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks</title>
<!--Generated on Mon May 26 14:24:22 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.20048v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S1" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S2" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries and Notation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S2.SS0.SSS0.Px1" title="In 2 Preliminaries and Notation ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Time Series Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S2.SS0.SSS0.Px2" title="In 2 Preliminaries and Notation ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Forecasting Task</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S2.SS0.SSS0.Px3" title="In 2 Preliminaries and Notation ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Common Operations and Notation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_typewriter">PatchTST</span> Variants: Architecture and Computational Complexity</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS1" title="In 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_typewriter">PatchTST</span> Minimal: A Lightweight Transformer Backbone</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS1.SSS0.Px1" title="In 3.1 PatchTST Minimal: A Lightweight Transformer Backbone ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS2" title="In 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><span class="ltx_text ltx_font_typewriter">PatchTST</span> Standard: Learning Data-Driven Positional Embeddings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS2.SSS0.Px1" title="In 3.2 PatchTST Standard: Learning Data-Driven Positional Embeddings ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS3" title="In 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span><span class="ltx_text ltx_font_typewriter">PatchTST</span> Full: A Flexible Encoder-Decoder Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS3.SSS0.Px1" title="In 3.3 PatchTST Full: A Flexible Encoder-Decoder Architecture ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS3.SSS0.Px2" title="In 3.3 PatchTST Full: A Flexible Encoder-Decoder Architecture ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS3.SSS0.Px3" title="In 3.3 PatchTST Full: A Flexible Encoder-Decoder Architecture ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Output</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS3.SSS0.Px4" title="In 3.3 PatchTST Full: A Flexible Encoder-Decoder Architecture ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.SS4" title="In 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Comparative Summary</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_typewriter">Informer</span>  Variants: Architecture and Computational Complexity</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS1" title="In 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_typewriter">Informer</span> Minimal: Baseline with Full Self-Attention</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS1.SSS0.Px1" title="In 4.1 Informer Minimal: Baseline with Full Self-Attention ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS2" title="In 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_typewriter">Informer</span> Standard: ProbSparse Attention for Scalable Forecasting</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS2.SSS0.Px1" title="In 4.2 Informer Standard: ProbSparse Attention for Scalable Forecasting ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Query Selection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS2.SSS0.Px2" title="In 4.2 Informer Standard: ProbSparse Attention for Scalable Forecasting ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS2.SSS0.Px3" title="In 4.2 Informer Standard: ProbSparse Attention for Scalable Forecasting ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS3" title="In 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_typewriter">Informer</span> Full: Sequence-to-Sequence Architecture with Dual Attention</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS3.SSS0.Px1" title="In 4.3 Informer Full: Sequence-to-Sequence Architecture with Dual Attention ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS3.SSS0.Px2" title="In 4.3 Informer Full: Sequence-to-Sequence Architecture with Dual Attention ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS3.SSS0.Px3" title="In 4.3 Informer Full: Sequence-to-Sequence Architecture with Dual Attention ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Output</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS3.SSS0.Px4" title="In 4.3 Informer Full: Sequence-to-Sequence Architecture with Dual Attention ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.SS4" title="In 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Comparative Summary</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span><span class="ltx_text ltx_font_typewriter">Autoformer</span> Variants: Architecture and Computational Complexity</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS1" title="In 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span><span class="ltx_text ltx_font_typewriter">Autoformer</span> Minimal: Lightweight Forecasting with Minimal Overhead</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS1.SSS0.Px1" title="In 5.1 Autoformer Minimal: Lightweight Forecasting with Minimal Overhead ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS2" title="In 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span><span class="ltx_text ltx_font_typewriter">Autoformer</span> Standard: Improved Stability with Enhanced Decomposition Awareness</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS2.SSS0.Px1" title="In 5.2 Autoformer Standard: Improved Stability with Enhanced Decomposition Awareness ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS3" title="In 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span><span class="ltx_text ltx_font_typewriter">Autoformer</span> Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS3.SSS0.Px1" title="In 5.3 Autoformer Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS3.SSS0.Px2" title="In 5.3 Autoformer Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS3.SSS0.Px3" title="In 5.3 Autoformer Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Output</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS3.SSS0.Px4" title="In 5.3 Autoformer Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Computational Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.SS4" title="In 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Comparative Summary</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Numerical Simulations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS1" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Noise Injection Strategy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS2" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Hardware Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS3" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Training setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS3.SSS0.Px1" title="In 6.3 Training setup ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Code availability statement</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS4" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Evaluation of <span class="ltx_text ltx_font_typewriter">PatchTST</span> Variants under Clean and Noisy Conditions</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS4.SSS0.Px1" title="In 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Minimal Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS4.SSS0.Px2" title="In 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Standard Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS4.SSS0.Px3" title="In 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Full Variant Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS4.SSS0.Px4" title="In 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Sensitivity to Patch and Horizon Lengths</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS5" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Evaluation of <span class="ltx_text ltx_font_typewriter">Informer</span> Variants under Clean and Noisy Conditions</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS5.SSS0.Px1" title="In 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Minimal Variant Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS5.SSS0.Px2" title="In 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Standard Variant Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS5.SSS0.Px3" title="In 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Full Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS5.SSS0.Px4" title="In 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Sensitivity to Patch and Horizon Lengths</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS6" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>Evaluation of <span class="ltx_text ltx_font_typewriter">Autoformer</span> Variants under Clean and Noisy Conditions</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS6.SSS0.Px1" title="In 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Minimal Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS6.SSS0.Px2" title="In 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Standard Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS6.SSS0.Px3" title="In 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Full Variant</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS6.SSS0.Px4" title="In 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Sensitivity to Patch and Horizon Lengths</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS7" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.7 </span>Cross-Family Model Comparison for Clean Signals</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS7.SSS0.Px1" title="In 6.7 Cross-Family Model Comparison for Clean Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">Autoformer</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS7.SSS0.Px2" title="In 6.7 Cross-Family Model Comparison for Clean Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">PatchTST</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS7.SSS0.Px3" title="In 6.7 Cross-Family Model Comparison for Clean Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">Informer</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS7.SSS0.Px4" title="In 6.7 Cross-Family Model Comparison for Clean Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Patch and Horizon Sensitivity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS8" title="In 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.8 </span>Cross-Family Model Comparison for Noisy Signals</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS8.SSS0.Px1" title="In 6.8 Cross-Family Model Comparison for Noisy Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">Autoformer</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS8.SSS0.Px2" title="In 6.8 Cross-Family Model Comparison for Noisy Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">PatchTST</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS8.SSS0.Px3" title="In 6.8 Cross-Family Model Comparison for Noisy Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_typewriter">Informer</span> Family</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.SS8.SSS0.Px4" title="In 6.8 Cross-Family Model Comparison for Noisy Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Patch and Horizon Sensitivity</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Outlook: Toward Koopman-Enhanced Transformer Architectures</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS1" title="In 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Future Directions for Transformer-based Forecasting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS2" title="In 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Deep Koopformer: Stability-Constrained Transformer-Koopman Framework</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS2.SSS1" title="In 7.2 Deep Koopformer: Stability-Constrained Transformer-Koopman Framework ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.1 </span>Input-to-Output Transformation in Deep Koopformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS2.SSS2" title="In 7.2 Deep Koopformer: Stability-Constrained Transformer-Koopman Framework ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.2 </span>Spectral Stability via Koopman Parametrization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS2.SSS3" title="In 7.2 Deep Koopformer: Stability-Constrained Transformer-Koopman Framework ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.3 </span>Energy Stability via Lyapunov Loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS2.SSS4" title="In 7.2 Deep Koopformer: Stability-Constrained Transformer-Koopman Framework ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.4 </span>Orthogonality and Numerical Stability</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS3" title="In 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span>Koopman-Enhanced Transformer Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS4" title="In 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4 </span>Application to Noisy Dynamical Systems</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS4.SSS0.Px1" title="In 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Van der Pol oscillator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.SS4.SSS0.Px2" title="In 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title">Lorenz System</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S8" title="In Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ali Forootani
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> <span class="ltx_ERROR undefined" id="id1.1.id1">\IEEEmembership</span>Senior, IEEE
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Mohammad Khosravi
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> <span class="ltx_ERROR undefined" id="id2.1.id1">\IEEEmembership</span>Member, IEEE
</span><span class="ltx_author_notes">Ali Forootani is with Helmholtz Center for Environmental Research-UFZ, Permoserstraße 15, 04318 Leipzig, Germany, <span class="ltx_text ltx_font_typewriter" id="id3.2.id1">Email: aliforootani@ieee.org/ali.forootani@ufz.de</span>.
Mohammad Khosravi is with Delft Center for Systems and Control, Mekelweg 2, Delft, 2628 CD, The Netherlands, <span class="ltx_text ltx_font_typewriter" id="id4.3.id1">Email: mohammad.khosravi@tudelft.nl</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">Time series forecasting plays a critical role in domains such as energy, finance, and healthcare, where accurate predictions inform decision-making under uncertainty. Although Transformer-based models have demonstrated success in sequential modeling, their adoption for time series remains limited by challenges such as noise sensitivity, long-range dependencies, and a lack of inductive bias for temporal structure. In this work, we present a unified and principled framework for benchmarking three prominent Transformer forecasting architectures—<span class="ltx_text ltx_font_typewriter" id="id5.id1.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="id5.id1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="id5.id1.3">PatchTST</span>—each evaluated through three architectural variants: <span class="ltx_text ltx_font_italic" id="id5.id1.4">Minimal</span>, <span class="ltx_text ltx_font_italic" id="id5.id1.5">Standard</span>, and <span class="ltx_text ltx_font_italic" id="id5.id1.6">Full</span>, representing increasing levels of complexity and modeling capacity.</p>
<p class="ltx_p" id="id6.id2">We conduct over 1500 controlled experiments on a suite of ten synthetic signals, spanning five patch lengths and five forecast horizons under both clean and noisy conditions. Our analysis reveals consistent patterns across model families.</p>
<p class="ltx_p" id="id7.id3">To advance this landscape further, we introduce the Koopman-enhanced Transformer framework, <span class="ltx_text ltx_font_italic" id="id7.id3.1">Deep Koopformer</span>, which integrates operator-theoretic latent state modeling to improve stability and interpretability. We demonstrate its efficacy on nonlinear and chaotic dynamical systems. Our results highlight Koopman based Transformer as a promising hybrid approach for robust, interpretable, and theoretically grounded time series forecasting in noisy and complex real-world conditions.</p>
</div>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">{IEEEkeywords}</span>
<p class="ltx_p" id="p1.2">Time Series Forecasting, Transformer Models, <span class="ltx_text ltx_font_typewriter" id="p1.2.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="p1.2.2">Informer</span>, <span class="ltx_text ltx_font_typewriter" id="p1.2.3">PatchTST</span>, Koopman Operator.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<span class="ltx_ERROR undefined" id="S1.p1.1">\IEEEPARstart</span>
<p class="ltx_p" id="S1.p1.2">Time series forecasting is a fundamental task in various domains including energy systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib2" title="">2</a>]</cite>, finance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib3" title="">3</a>]</cite>, supply chain management <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib4" title="">4</a>]</cite>, healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib5" title="">5</a>]</cite>, meteorology <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib6" title="">6</a>]</cite>, and more. Accurate forecasting enables proactive decision-making, risk mitigation, and optimized planning. With the increasing availability of high-resolution temporal data, designing robust and scalable forecasting models has become more critical than ever. Traditional statistical methods such as Autoregressive Integrated Moving Average (<span class="ltx_text ltx_font_typewriter" id="S1.p1.2.1">ARIMA</span>), Exponential Smoothing, and Seasonal Decomposition have long served as the backbone of time series analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib7" title="">7</a>]</cite>. However, their capacity to model complex patterns, multivariate dependencies, and non-linear dynamics is inherently limited, particularly in large-scale or non-stationary datasets.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In recent years, machine learning (<span class="ltx_text ltx_font_typewriter" id="S1.p2.1.1">ML</span>) and deep learning (<span class="ltx_text ltx_font_typewriter" id="S1.p2.1.2">DL</span>) models have emerged as powerful alternatives to classical methods due to their data-driven learning capacity and flexibility. Recurrent Neural Networks (<span class="ltx_text ltx_font_typewriter" id="S1.p2.1.3">RNN</span>s), Long Short-Term Memory (<span class="ltx_text ltx_font_typewriter" id="S1.p2.1.4">LSTM</span>) networks, and Temporal Convolutional Networks (<span class="ltx_text ltx_font_typewriter" id="S1.p2.1.5">TCN</span>s) have been successfully applied to time series forecasting tasks, demonstrating superior performance in capturing temporal dependencies and non-linear patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib8" title="">8</a>]</cite>. Nevertheless, these models often suffer from challenges such as vanishing gradients, sequential bottlenecks, and limited scalability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Among recent advancements in <span class="ltx_text ltx_font_typewriter" id="S1.p3.1.1">DL</span>, Transformer models have revolutionized sequence modeling, particularly in Natural Language Processing (<span class="ltx_text ltx_font_typewriter" id="S1.p3.1.2">NLP</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib12" title="">12</a>]</cite>. Introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib13" title="">13</a>]</cite>, the Transformer architecture replaces recurrence with self-attention mechanisms, enabling parallel computation and long-range dependency modeling. Its success has quickly spread to other domains such as Computer Vision (<span class="ltx_text ltx_font_typewriter" id="S1.p3.1.3">CV</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib14" title="">14</a>]</cite>, speech processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib15" title="">15</a>]</cite>, and more recently, time series forecasting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib16" title="">16</a>]</cite>. Transformers provide an appealing framework for time series modeling due to their flexibility in handling variable-length inputs, modeling contextual dependencies, and learning rich representations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib17" title="">17</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">However, applying Transformers directly to time series forecasting is not straightforward. Time series data differ from text or images in several key aspects. First, time series are continuous and regularly sampled, whereas text and vision data have discrete semantic tokens (e.g., words, pixels). Second, time series often exhibit strong autocorrelation, trends, and seasonalities—features that need to be explicitly modeled. Third, computational efficiency is a major concern, especially for long-term forecasting where the input sequence can be significantly large. The standard Transformer has quadratic complexity <math alttext="\mathcal{O}(N^{2})" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">𝒪</mi><mo id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.p4.1.m1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S1.p4.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S1.p4.1.m1.1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.1.1.1.2" xref="S1.p4.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S1.p4.1.m1.1.1.1.1.1.3" xref="S1.p4.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><times id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2"></times><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">𝒪</ci><apply id="S1.p4.1.m1.1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1">superscript</csymbol><ci id="S1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.1.1.1.2">𝑁</ci><cn id="S1.p4.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S1.p4.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathcal{O}(N^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> with respect to the sequence length <math alttext="N" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_N</annotation></semantics></math>, making it computationally expensive for high-resolution temporal data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib18" title="">18</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To overcome these challenges, a variety of Transformer-based architectures have been proposed for time series forecasting. <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.1">Informer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib19" title="">19</a>]</cite> introduces <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.2">ProbSparse</span> attention to select important queries and reduce redundancy in self-attention computation. <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.3">Autoformer</span>  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib20" title="">20</a>]</cite> incorporates a decomposition block to handle trends and seasonality explicitly, while <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.4">FEDformer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib21" title="">21</a>]</cite> integrates Fourier-based decomposition to reduce complexity. <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.5">Pyraformer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib22" title="">22</a>]</cite> utilizes a pyramidal attention mechanism to capture hierarchical temporal features. Despite their differences, these models share a common goal: reducing computational cost while preserving or enhancing predictive accuracy.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Nevertheless, a recent study by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib23" title="">23</a>]</cite> challenges the assumption that complex Transformer models are necessary for high-accuracy time series forecasting. The authors propose a simple linear model, <span class="ltx_text ltx_font_typewriter" id="S1.p6.1.1">DLinear</span>, which surprisingly outperforms many sophisticated models on standard benchmarks. This raises fundamental questions about the design of deep models for time series and whether architectural complexity always translates to improved performance. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib24" title="">24</a>]</cite>, the authors introduced <span class="ltx_text ltx_font_typewriter" id="S1.p6.1.2">PatchTST</span> to enhance the model’s ability to capture local and semantic dependencies through patching, and to simplify the design by leveraging <em class="ltx_emph ltx_font_italic" id="S1.p6.1.3">channel-independent</em> learning.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Unlike traditional Transformer variants that treat each time step as a token, <span class="ltx_text ltx_font_typewriter" id="S1.p7.1.1">PatchTST</span> argues that aggregating multiple time steps into local patches better reflects the temporal structure of time series data. This approach is inspired by techniques in Vision Transformers (<span class="ltx_text ltx_font_typewriter" id="S1.p7.1.2">ViT</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib25" title="">25</a>]</cite> and speech models such as Wav2Vec 2.0 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib26" title="">26</a>]</cite>, where patches or segments are used to encode meaningful context.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">Furthermore, in multivariate time series, the common practice is to mix channels—i.e., combine features from all variables into a single token. While this enables joint learning, it may obscure individual patterns and increase overfitting risks. In <span class="ltx_text ltx_font_typewriter" id="S1.p8.1.1">PatchTST</span> a <em class="ltx_emph ltx_font_italic" id="S1.p8.1.2">channel-independent</em> formulation has been adapted, where each channel (i.e., time series variable) is treated separately during embedding and encoding. This strategy is shown to work well in Convolutional Neural Network (<span class="ltx_text ltx_font_typewriter" id="S1.p8.1.3">CNN</span>) and linear models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib23" title="">23</a>]</cite>, and has been extended in <span class="ltx_text ltx_font_typewriter" id="S1.p8.1.4">PatchTST</span>  for Transformer-based models.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">Even though Transformer-based architectures have revolutionized sequential modeling in natural language processing and computer vision, yet their adoption in time series forecasting remains underdeveloped. Unlike textual data, time series are often governed by latent temporal dynamics, periodic structures, and long-range dependencies that challenge standard attention mechanisms. Moreover, existing Transformer variants such as <span class="ltx_text ltx_font_typewriter" id="S1.p9.1.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S1.p9.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S1.p9.1.3">PatchTST</span> have been proposed independently, each introducing unique architectural innovations—but without a unified framework for comparison. This lack of standardization hinders practical model selection, reproducibility, and theoretical understanding. To address this gap, we conduct a systematic study of these models, introduce consistent architectural variants, and evaluate them under controlled experimental settings. Our goal is to clarify the design trade-offs, computational properties, and forecasting behaviors of Transformer models, ultimately guiding practitioners toward more informed and effective forecasting solutions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">(<span class="ltx_text ltx_font_bold" id="S1.p10.1.1">i</span>) <span class="ltx_text ltx_font_italic" id="S1.p10.1.2">Architectural Variant Framework.</span> We design and evaluate three principled variant classes—<span class="ltx_text ltx_font_italic" id="S1.p10.1.3">Minimal</span>, <span class="ltx_text ltx_font_italic" id="S1.p10.1.4">Standard</span>, and <span class="ltx_text ltx_font_italic" id="S1.p10.1.5">Full</span>—for each of the <span class="ltx_text ltx_font_typewriter" id="S1.p10.1.6">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S1.p10.1.7">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S1.p10.1.8">PatchTST</span> families. These variants represent increasing architectural complexity, ranging from lightweight encoder-only models to full encoder-decoder configurations with autoregressive decoding. This design space allows us to isolate the impact of architectural choices on performance, scalability, and robustness.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p11">
<p class="ltx_p" id="S1.p11.1">(<span class="ltx_text ltx_font_bold" id="S1.p11.1.1">ii</span>) <span class="ltx_text ltx_font_italic" id="S1.p11.1.2">Unified Forecasting and Complexity Formulation.</span> All variants are analyzed within a shared theoretical framework, encompassing patch-based input encoding, trend-seasonal decomposition (<span class="ltx_text ltx_font_typewriter" id="S1.p11.1.3">Autoformer</span>), ProbSparse attention (<span class="ltx_text ltx_font_typewriter" id="S1.p11.1.4">Informer</span>), and temporal patch tokenization (<span class="ltx_text ltx_font_typewriter" id="S1.p11.1.5">PatchTST</span>). We provide consistent mathematical formulations, computational complexity comparisons, and layer-by-layer forward pass descriptions that contextualize how each model processes temporal inputs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p12">
<p class="ltx_p" id="S1.p12.1">(<span class="ltx_text ltx_font_bold" id="S1.p12.1.1">iii</span>) <span class="ltx_text ltx_font_italic" id="S1.p12.1.2">Comprehensive Empirical Benchmarking under Noise.</span> We conduct 1500 controlled experiments (750 clean + 750 noisy) across 10 synthetic signals, 5 patch lengths, and 5 forecast horizons for each model family. Our analysis reveals clear and consistent trends: <span class="ltx_text ltx_font_typewriter" id="S1.p12.1.3">PatchTST</span> Standard achieves the best overall performance under clean and noisy conditions; <span class="ltx_text ltx_font_typewriter" id="S1.p12.1.4">Autoformer</span> Minimal and <span class="ltx_text ltx_font_typewriter" id="S1.p12.1.5">Autoformer</span> Standard excel on smooth and trend-dominated signals, especially in noisy regimes; while <span class="ltx_text ltx_font_typewriter" id="S1.p12.1.6">Informer</span> variants exhibit higher error and instability under noise and long-horizon forecasting. Aggregated heatmaps and per-signal tables highlight the trade-offs between robustness, sensitivity, and generalization across the architectural spectrum.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p13">
<p class="ltx_p" id="S1.p13.1">(<span class="ltx_text ltx_font_bold" id="S1.p13.1.1">iv</span>) <span class="ltx_text ltx_font_italic" id="S1.p13.1.2">Koopman-Enhanced Transformer Architecture.</span> We introduce a novel extension of Transformer-based forecasting models that integrates Koopman operator theory to model linear latent state evolution. This modular operator-theoretic approach improves forecast stability, enables interpretable latent dynamics, and bridges deep sequence modeling with dynamical systems analysis. Through experiments on nonlinear and chaotic systems, including noisy Van der Pol and Lorenz systems, we demonstrate Koopman enhanced Transformer’s capacity to effectively forecast nonlinear oscillations and chaotic trajectories under stochastic perturbations.</p>
</div>
<div class="ltx_para" id="S1.p14">
<p class="ltx_p" id="S1.p14.1">This paper is organized as follows: In the Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S2" title="2 Preliminaries and Notation ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">2</span></a>, we review preliminaries and notations that we use in this article. In Sections <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3" title="3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4" title="4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5" title="5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">5</span></a> we propose three different variants for transformer based time series forecasting, i.e. <span class="ltx_text ltx_font_typewriter" id="S1.p14.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S1.p14.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S1.p14.1.3">Autoformer</span> , respectively. In Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6" title="6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">6</span></a> we evaluate the performance of these architectures on 10 clean and noisy synthetic signals. The koopman enhanced transformer architectures will be discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7" title="7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">7</span></a>. Finally, the conclusion will be discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S8" title="8 Conclusion ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries and Notation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We begin by formalizing the forecasting setup and introducing common notation and operations used throughout this work.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Time Series Data</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.4">Let <math alttext="x=[x_{1},x_{2},\dots,x_{T}]\in\mathbb{R}^{T}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.4"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.4a"><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.4.4" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.5" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.5.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.6" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.6.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml">[</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.5" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.2.cmml">x</mi><mn id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.6" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.7" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml">]</mo></mrow><mo id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.7" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.7.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.4b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4"><and id="S2.SS0.SSS0.Px1.p1.1.m1.4.4a.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4"></and><apply id="S2.SS0.SSS0.Px1.p1.1.m1.4.4b.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4"><eq id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.6.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.6"></eq><ci id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.5.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.5">𝑥</ci><list id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.2">𝑥</ci><cn id="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">…</ci><apply id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.2">𝑥</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.3.3.3">𝑇</ci></apply></list></apply><apply id="S2.SS0.SSS0.Px1.p1.1.m1.4.4c.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4"><in id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.7.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2505.20048v1#S2.SS0.SSS0.Px1.p1.1.m1.4.4.3.cmml" id="S2.SS0.SSS0.Px1.p1.1.m1.4.4d.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4"></share><apply id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.2">ℝ</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.4.4.8.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.4c">x=[x_{1},x_{2},\dots,x_{T}]\in\mathbb{R}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.4d">italic_x = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> denote a univariate time series of length <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">italic_T</annotation></semantics></math>, where <math alttext="x_{t}\in\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1"><in id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.1"></in><apply id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">x_{t}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math> represents the observation at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.1d">italic_t</annotation></semantics></math>. Our objective is to predict future values of the sequence based on historical observations.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Forecasting Task</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.3">Given a historical context window of fixed length <math alttext="P" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.1d">italic_P</annotation></semantics></math>, the model forecasts the next <math alttext="H" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">italic_H</annotation></semantics></math> steps. For each starting index <math alttext="i\in\{1,2,\dots,T-P-H+1\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m3.4"><semantics id="S2.SS0.SSS0.Px2.p1.3.m3.4a"><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.4.4" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.2.cmml">∈</mo><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml"><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml">{</mo><mn id="S2.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">1</mn><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml">,</mo><mn id="S2.SS0.SSS0.Px2.p1.3.m3.2.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.2.2.cmml">2</mn><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.4" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p1.3.m3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px2.p1.3.m3.3.3.cmml">…</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.5" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml">,</mo><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.2.cmml">T</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1.cmml">−</mo><mi id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.3.cmml">P</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1a" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1.cmml">−</mo><mi id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.4" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.4.cmml">H</mi></mrow><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml">+</mo><mn id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.6" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m3.4b"><apply id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4"><in id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.2"></in><ci id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.3">𝑖</ci><set id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1"><cn id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1">1</cn><cn id="S2.SS0.SSS0.Px2.p1.3.m3.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.3.m3.2.2">2</cn><ci id="S2.SS0.SSS0.Px2.p1.3.m3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.3.3">…</ci><apply id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1"><plus id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.1"></plus><apply id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2"><minus id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.1"></minus><ci id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.2">𝑇</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.3">𝑃</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.4.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.2.4">𝐻</ci></apply><cn id="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px2.p1.3.m3.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m3.4c">i\in\{1,2,\dots,T-P-H+1\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.3.m3.4d">italic_i ∈ { 1 , 2 , … , italic_T - italic_P - italic_H + 1 }</annotation></semantics></math>, we define:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><msub id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">𝐱</ci><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[x_{i},x_{i+1},\dots,x_{i+P-1}]\in\mathbb{R}^{P}," class="ltx_Math" display="inline" id="S2.E1.m2.2"><semantics id="S2.E1.m2.2a"><mrow id="S2.E1.m2.2.2.1" xref="S2.E1.m2.2.2.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1" xref="S2.E1.m2.2.2.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.5" xref="S2.E1.m2.2.2.1.1.5.cmml"></mi><mo id="S2.E1.m2.2.2.1.1.6" xref="S2.E1.m2.2.2.1.1.6.cmml">=</mo><mrow id="S2.E1.m2.2.2.1.1.3.3" xref="S2.E1.m2.2.2.1.1.3.4.cmml"><mo id="S2.E1.m2.2.2.1.1.3.3.4" stretchy="false" xref="S2.E1.m2.2.2.1.1.3.4.cmml">[</mo><msub id="S2.E1.m2.2.2.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m2.2.2.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m2.2.2.1.1.3.3.5" xref="S2.E1.m2.2.2.1.1.3.4.cmml">,</mo><msub id="S2.E1.m2.2.2.1.1.2.2.2" xref="S2.E1.m2.2.2.1.1.2.2.2.cmml"><mi id="S2.E1.m2.2.2.1.1.2.2.2.2" xref="S2.E1.m2.2.2.1.1.2.2.2.2.cmml">x</mi><mrow id="S2.E1.m2.2.2.1.1.2.2.2.3" xref="S2.E1.m2.2.2.1.1.2.2.2.3.cmml"><mi id="S2.E1.m2.2.2.1.1.2.2.2.3.2" xref="S2.E1.m2.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.E1.m2.2.2.1.1.2.2.2.3.1" xref="S2.E1.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="S2.E1.m2.2.2.1.1.2.2.2.3.3" xref="S2.E1.m2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E1.m2.2.2.1.1.3.3.6" xref="S2.E1.m2.2.2.1.1.3.4.cmml">,</mo><mi id="S2.E1.m2.1.1" mathvariant="normal" xref="S2.E1.m2.1.1.cmml">…</mi><mo id="S2.E1.m2.2.2.1.1.3.3.7" xref="S2.E1.m2.2.2.1.1.3.4.cmml">,</mo><msub id="S2.E1.m2.2.2.1.1.3.3.3" xref="S2.E1.m2.2.2.1.1.3.3.3.cmml"><mi id="S2.E1.m2.2.2.1.1.3.3.3.2" xref="S2.E1.m2.2.2.1.1.3.3.3.2.cmml">x</mi><mrow id="S2.E1.m2.2.2.1.1.3.3.3.3" xref="S2.E1.m2.2.2.1.1.3.3.3.3.cmml"><mrow id="S2.E1.m2.2.2.1.1.3.3.3.3.2" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.cmml"><mi id="S2.E1.m2.2.2.1.1.3.3.3.3.2.2" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.2.cmml">i</mi><mo id="S2.E1.m2.2.2.1.1.3.3.3.3.2.1" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.1.cmml">+</mo><mi id="S2.E1.m2.2.2.1.1.3.3.3.3.2.3" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.3.cmml">P</mi></mrow><mo id="S2.E1.m2.2.2.1.1.3.3.3.3.1" xref="S2.E1.m2.2.2.1.1.3.3.3.3.1.cmml">−</mo><mn id="S2.E1.m2.2.2.1.1.3.3.3.3.3" xref="S2.E1.m2.2.2.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E1.m2.2.2.1.1.3.3.8" stretchy="false" xref="S2.E1.m2.2.2.1.1.3.4.cmml">]</mo></mrow><mo id="S2.E1.m2.2.2.1.1.7" xref="S2.E1.m2.2.2.1.1.7.cmml">∈</mo><msup id="S2.E1.m2.2.2.1.1.8" xref="S2.E1.m2.2.2.1.1.8.cmml"><mi id="S2.E1.m2.2.2.1.1.8.2" xref="S2.E1.m2.2.2.1.1.8.2.cmml">ℝ</mi><mi id="S2.E1.m2.2.2.1.1.8.3" xref="S2.E1.m2.2.2.1.1.8.3.cmml">P</mi></msup></mrow><mo id="S2.E1.m2.2.2.1.2" xref="S2.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.2b"><apply id="S2.E1.m2.2.2.1.1.cmml" xref="S2.E1.m2.2.2.1"><and id="S2.E1.m2.2.2.1.1a.cmml" xref="S2.E1.m2.2.2.1"></and><apply id="S2.E1.m2.2.2.1.1b.cmml" xref="S2.E1.m2.2.2.1"><eq id="S2.E1.m2.2.2.1.1.6.cmml" xref="S2.E1.m2.2.2.1.1.6"></eq><csymbol cd="latexml" id="S2.E1.m2.2.2.1.1.5.cmml" xref="S2.E1.m2.2.2.1.1.5">absent</csymbol><list id="S2.E1.m2.2.2.1.1.3.4.cmml" xref="S2.E1.m2.2.2.1.1.3.3"><apply id="S2.E1.m2.2.2.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E1.m2.2.2.1.1.2.2.2.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.2.2.2.1.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2.2">𝑥</ci><apply id="S2.E1.m2.2.2.1.1.2.2.2.3.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2.3"><plus id="S2.E1.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2.3.1"></plus><ci id="S2.E1.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E1.m2.2.2.1.1.2.2.2.3.2">𝑖</ci><cn id="S2.E1.m2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1">…</ci><apply id="S2.E1.m2.2.2.1.1.3.3.3.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.3.3.3.1.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.3.3.3.2.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.2">𝑥</ci><apply id="S2.E1.m2.2.2.1.1.3.3.3.3.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3"><minus id="S2.E1.m2.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3.1"></minus><apply id="S2.E1.m2.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2"><plus id="S2.E1.m2.2.2.1.1.3.3.3.3.2.1.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.1"></plus><ci id="S2.E1.m2.2.2.1.1.3.3.3.3.2.2.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.2">𝑖</ci><ci id="S2.E1.m2.2.2.1.1.3.3.3.3.2.3.cmml" xref="S2.E1.m2.2.2.1.1.3.3.3.3.2.3">𝑃</ci></apply><cn id="S2.E1.m2.2.2.1.1.3.3.3.3.3.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.3.3.3.3.3">1</cn></apply></apply></list></apply><apply id="S2.E1.m2.2.2.1.1c.cmml" xref="S2.E1.m2.2.2.1"><in id="S2.E1.m2.2.2.1.1.7.cmml" xref="S2.E1.m2.2.2.1.1.7"></in><share href="https://arxiv.org/html/2505.20048v1#S2.E1.m2.2.2.1.1.3.cmml" id="S2.E1.m2.2.2.1.1d.cmml" xref="S2.E1.m2.2.2.1"></share><apply id="S2.E1.m2.2.2.1.1.8.cmml" xref="S2.E1.m2.2.2.1.1.8"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.8.1.cmml" xref="S2.E1.m2.2.2.1.1.8">superscript</csymbol><ci id="S2.E1.m2.2.2.1.1.8.2.cmml" xref="S2.E1.m2.2.2.1.1.8.2">ℝ</ci><ci id="S2.E1.m2.2.2.1.1.8.3.cmml" xref="S2.E1.m2.2.2.1.1.8.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.2c">\displaystyle=[x_{i},x_{i+1},\dots,x_{i+P-1}]\in\mathbb{R}^{P},</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m2.2d">= [ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i + italic_P - 1 end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{i}" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><msub id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">𝐲</mi><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2">𝐲</ci><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[x_{i+P},x_{i+P+1},\dots,x_{i+P+H-1}]\in\mathbb{R}^{H}." class="ltx_Math" display="inline" id="S2.E2.m2.2"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2.1" xref="S2.E2.m2.2.2.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1" xref="S2.E2.m2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.5" xref="S2.E2.m2.2.2.1.1.5.cmml"></mi><mo id="S2.E2.m2.2.2.1.1.6" xref="S2.E2.m2.2.2.1.1.6.cmml">=</mo><mrow id="S2.E2.m2.2.2.1.1.3.3" xref="S2.E2.m2.2.2.1.1.3.4.cmml"><mo id="S2.E2.m2.2.2.1.1.3.3.4" stretchy="false" xref="S2.E2.m2.2.2.1.1.3.4.cmml">[</mo><msub id="S2.E2.m2.2.2.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.E2.m2.2.2.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E2.m2.2.2.1.1.1.1.1.3.2" xref="S2.E2.m2.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.E2.m2.2.2.1.1.1.1.1.3.1" xref="S2.E2.m2.2.2.1.1.1.1.1.3.1.cmml">+</mo><mi id="S2.E2.m2.2.2.1.1.1.1.1.3.3" xref="S2.E2.m2.2.2.1.1.1.1.1.3.3.cmml">P</mi></mrow></msub><mo id="S2.E2.m2.2.2.1.1.3.3.5" xref="S2.E2.m2.2.2.1.1.3.4.cmml">,</mo><msub id="S2.E2.m2.2.2.1.1.2.2.2" xref="S2.E2.m2.2.2.1.1.2.2.2.cmml"><mi id="S2.E2.m2.2.2.1.1.2.2.2.2" xref="S2.E2.m2.2.2.1.1.2.2.2.2.cmml">x</mi><mrow id="S2.E2.m2.2.2.1.1.2.2.2.3" xref="S2.E2.m2.2.2.1.1.2.2.2.3.cmml"><mi id="S2.E2.m2.2.2.1.1.2.2.2.3.2" xref="S2.E2.m2.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.E2.m2.2.2.1.1.2.2.2.3.1" xref="S2.E2.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mi id="S2.E2.m2.2.2.1.1.2.2.2.3.3" xref="S2.E2.m2.2.2.1.1.2.2.2.3.3.cmml">P</mi><mo id="S2.E2.m2.2.2.1.1.2.2.2.3.1a" xref="S2.E2.m2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="S2.E2.m2.2.2.1.1.2.2.2.3.4" xref="S2.E2.m2.2.2.1.1.2.2.2.3.4.cmml">1</mn></mrow></msub><mo id="S2.E2.m2.2.2.1.1.3.3.6" xref="S2.E2.m2.2.2.1.1.3.4.cmml">,</mo><mi id="S2.E2.m2.1.1" mathvariant="normal" xref="S2.E2.m2.1.1.cmml">…</mi><mo id="S2.E2.m2.2.2.1.1.3.3.7" xref="S2.E2.m2.2.2.1.1.3.4.cmml">,</mo><msub id="S2.E2.m2.2.2.1.1.3.3.3" xref="S2.E2.m2.2.2.1.1.3.3.3.cmml"><mi id="S2.E2.m2.2.2.1.1.3.3.3.2" xref="S2.E2.m2.2.2.1.1.3.3.3.2.cmml">x</mi><mrow id="S2.E2.m2.2.2.1.1.3.3.3.3" xref="S2.E2.m2.2.2.1.1.3.3.3.3.cmml"><mrow id="S2.E2.m2.2.2.1.1.3.3.3.3.2" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.cmml"><mi id="S2.E2.m2.2.2.1.1.3.3.3.3.2.2" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.2.cmml">i</mi><mo id="S2.E2.m2.2.2.1.1.3.3.3.3.2.1" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.1.cmml">+</mo><mi id="S2.E2.m2.2.2.1.1.3.3.3.3.2.3" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.3.cmml">P</mi><mo id="S2.E2.m2.2.2.1.1.3.3.3.3.2.1a" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.1.cmml">+</mo><mi id="S2.E2.m2.2.2.1.1.3.3.3.3.2.4" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.4.cmml">H</mi></mrow><mo id="S2.E2.m2.2.2.1.1.3.3.3.3.1" xref="S2.E2.m2.2.2.1.1.3.3.3.3.1.cmml">−</mo><mn id="S2.E2.m2.2.2.1.1.3.3.3.3.3" xref="S2.E2.m2.2.2.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m2.2.2.1.1.3.3.8" stretchy="false" xref="S2.E2.m2.2.2.1.1.3.4.cmml">]</mo></mrow><mo id="S2.E2.m2.2.2.1.1.7" xref="S2.E2.m2.2.2.1.1.7.cmml">∈</mo><msup id="S2.E2.m2.2.2.1.1.8" xref="S2.E2.m2.2.2.1.1.8.cmml"><mi id="S2.E2.m2.2.2.1.1.8.2" xref="S2.E2.m2.2.2.1.1.8.2.cmml">ℝ</mi><mi id="S2.E2.m2.2.2.1.1.8.3" xref="S2.E2.m2.2.2.1.1.8.3.cmml">H</mi></msup></mrow><mo id="S2.E2.m2.2.2.1.2" lspace="0em" xref="S2.E2.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.1"><and id="S2.E2.m2.2.2.1.1a.cmml" xref="S2.E2.m2.2.2.1"></and><apply id="S2.E2.m2.2.2.1.1b.cmml" xref="S2.E2.m2.2.2.1"><eq id="S2.E2.m2.2.2.1.1.6.cmml" xref="S2.E2.m2.2.2.1.1.6"></eq><csymbol cd="latexml" id="S2.E2.m2.2.2.1.1.5.cmml" xref="S2.E2.m2.2.2.1.1.5">absent</csymbol><list id="S2.E2.m2.2.2.1.1.3.4.cmml" xref="S2.E2.m2.2.2.1.1.3.3"><apply id="S2.E2.m2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.2">𝑥</ci><apply id="S2.E2.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.3"><plus id="S2.E2.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.3.1"></plus><ci id="S2.E2.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.E2.m2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S2.E2.m2.2.2.1.1.2.2.2.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.2.2.2.1.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.2.2.2.2.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2.2">𝑥</ci><apply id="S2.E2.m2.2.2.1.1.2.2.2.3.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2.3"><plus id="S2.E2.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2.3.1"></plus><ci id="S2.E2.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.E2.m2.2.2.1.1.2.2.2.3.3.cmml" xref="S2.E2.m2.2.2.1.1.2.2.2.3.3">𝑃</ci><cn id="S2.E2.m2.2.2.1.1.2.2.2.3.4.cmml" type="integer" xref="S2.E2.m2.2.2.1.1.2.2.2.3.4">1</cn></apply></apply><ci id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1">…</ci><apply id="S2.E2.m2.2.2.1.1.3.3.3.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.3.3.3.1.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.3.3.3.2.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.2">𝑥</ci><apply id="S2.E2.m2.2.2.1.1.3.3.3.3.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3"><minus id="S2.E2.m2.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.1"></minus><apply id="S2.E2.m2.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2"><plus id="S2.E2.m2.2.2.1.1.3.3.3.3.2.1.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.1"></plus><ci id="S2.E2.m2.2.2.1.1.3.3.3.3.2.2.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.2">𝑖</ci><ci id="S2.E2.m2.2.2.1.1.3.3.3.3.2.3.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.3">𝑃</ci><ci id="S2.E2.m2.2.2.1.1.3.3.3.3.2.4.cmml" xref="S2.E2.m2.2.2.1.1.3.3.3.3.2.4">𝐻</ci></apply><cn id="S2.E2.m2.2.2.1.1.3.3.3.3.3.cmml" type="integer" xref="S2.E2.m2.2.2.1.1.3.3.3.3.3">1</cn></apply></apply></list></apply><apply id="S2.E2.m2.2.2.1.1c.cmml" xref="S2.E2.m2.2.2.1"><in id="S2.E2.m2.2.2.1.1.7.cmml" xref="S2.E2.m2.2.2.1.1.7"></in><share href="https://arxiv.org/html/2505.20048v1#S2.E2.m2.2.2.1.1.3.cmml" id="S2.E2.m2.2.2.1.1d.cmml" xref="S2.E2.m2.2.2.1"></share><apply id="S2.E2.m2.2.2.1.1.8.cmml" xref="S2.E2.m2.2.2.1.1.8"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.8.1.cmml" xref="S2.E2.m2.2.2.1.1.8">superscript</csymbol><ci id="S2.E2.m2.2.2.1.1.8.2.cmml" xref="S2.E2.m2.2.2.1.1.8.2">ℝ</ci><ci id="S2.E2.m2.2.2.1.1.8.3.cmml" xref="S2.E2.m2.2.2.1.1.8.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle=[x_{i+P},x_{i+P+1},\dots,x_{i+P+H-1}]\in\mathbb{R}^{H}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m2.2d">= [ italic_x start_POSTSUBSCRIPT italic_i + italic_P end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i + italic_P + 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i + italic_P + italic_H - 1 end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.4">The goal is to learn a forecasting function <math alttext="f_{\theta}:\mathbb{R}^{P}\rightarrow\mathbb{R}^{H}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.4.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.4.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p1.4.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.3.cmml">θ</mi></msub><mo id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.1.cmml">:</mo><mrow id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.cmml"><msup id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.3.cmml">P</mi></msup><mo id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.1" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.1.cmml">→</mo><msup id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.3.cmml">H</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m1.1b"><apply id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1"><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.1">:</ci><apply id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.2.3">𝜃</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3"><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.1">→</ci><apply id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.2">ℝ</ci><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.2.3">𝑃</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.2">ℝ</ci><ci id="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m1.1c">f_{\theta}:\mathbb{R}^{P}\rightarrow\mathbb{R}^{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.4.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : blackboard_R start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT</annotation></semantics></math> that maps the historical window to future values:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=f_{\theta}(\mathbf{x}_{i})." class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.3.2.2.cmml">𝐲</mi><mo id="S2.E3.m1.1.1.1.1.3.2.1" xref="S2.E3.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" lspace="0em" xref="S2.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"></eq><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2"><ci id="S2.E3.m1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.3.2.1">^</ci><ci id="S2.E3.m1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2.2">𝐲</ci></apply><ci id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\hat{\mathbf{y}}_{i}=f_{\theta}(\mathbf{x}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Common Operations and Notation</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Throughout the article, we use the following notation:</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p2">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><em class="ltx_emph ltx_font_italic" id="S2.I1.i1.p1.1.1">Input Embedding</em>: Each input <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">𝐱</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is mapped to a latent representation via a linear embedding:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e},\quad\mathbf{W}_{e}\in\mathbb%
{R}^{P\times d_{\text{model}}}\text{ or }\mathbb{R}^{1\times d_{\text{model}}}." class="ltx_Math" display="block" id="S2.Ex1.m1.1"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1.1"><mrow id="S2.Ex1.m1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.3.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml"><msub id="S2.Ex1.m1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex1.m1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S2.Ex1.m1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml">𝐖</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml">e</mi></msub></mrow></mrow><mo id="S2.Ex1.m1.1.1.1.1.2.3" rspace="1.167em" xref="S2.Ex1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.Ex1.m1.1.1.1.1.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.cmml"><msub id="S2.Ex1.m1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mi id="S2.Ex1.m1.1.1.1.1.2.2.2.3" xref="S2.Ex1.m1.1.1.1.1.2.2.2.3.cmml">e</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.2.2.1" xref="S2.Ex1.m1.1.1.1.1.2.2.1.cmml">∈</mo><mrow id="S2.Ex1.m1.1.1.1.1.2.2.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.cmml"><msup id="S2.Ex1.m1.1.1.1.1.2.2.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.3.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.2.cmml">ℝ</mi><mrow id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.2.cmml">P</mi><mo id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.1.cmml">×</mo><msub id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.2.cmml">d</mi><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3a.cmml">model</mtext></msub></mrow></msup><mo id="S2.Ex1.m1.1.1.1.1.2.2.3.1" xref="S2.Ex1.m1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.3a.cmml"> or </mtext><mo id="S2.Ex1.m1.1.1.1.1.2.2.3.1a" xref="S2.Ex1.m1.1.1.1.1.2.2.3.1.cmml">⁢</mo><msup id="S2.Ex1.m1.1.1.1.1.2.2.3.4" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.3.4.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.2.cmml">ℝ</mi><mrow id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.cmml"><mn id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.2.cmml">1</mn><mo id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.1.cmml">×</mo><msub id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.2.cmml">d</mi><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow></mrow></mrow><mo id="S2.Ex1.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1"><eq id="S2.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1"></eq><apply id="S2.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3"><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.2">𝐱</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.2">𝐖</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.3">𝑒</ci></apply></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2"><in id="S2.Ex1.m1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1"></in><apply id="S2.Ex1.m1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2">𝐖</ci><ci id="S2.Ex1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.3">𝑒</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3"><times id="S2.Ex1.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.1"></times><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2">superscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.2">ℝ</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3"><times id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.1"></times><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.2">𝑃</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.2">𝑑</ci><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3"><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3.cmml" mathsize="50%" xref="S2.Ex1.m1.1.1.1.1.2.2.3.2.3.3.3">model</mtext></ci></apply></apply></apply><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.3"><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.3"> or </mtext></ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.4.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.3.4.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4">superscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.4.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.2">ℝ</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3"><times id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.1"></times><cn id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.2.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.2">1</cn><apply id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.2">𝑑</ci><ci id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3"><mtext id="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3.cmml" mathsize="50%" xref="S2.Ex1.m1.1.1.1.1.2.2.3.4.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e},\quad\mathbf{W}_{e}\in\mathbb%
{R}^{P\times d_{\text{model}}}\text{ or }\mathbb{R}^{1\times d_{\text{model}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT or blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><em class="ltx_emph ltx_font_italic" id="S2.I1.i2.p1.1.1">Positional Encoding (PE)</em>: To inject temporal order, a positional encoding <math alttext="\text{PE}\in\mathbb{R}^{P\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2a.cmml">PE</mtext><mo id="S2.I1.i2.p1.1.m1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.I1.i2.p1.1.m1.1.1.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2.cmml">P</mi><mo id="S2.I1.i2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.I1.i2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.I1.i2.p1.1.m1.1.1.3.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.3.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.I1.i2.p1.1.m1.1.1.3.3.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><in id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1"></in><ci id="S2.I1.i2.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"><mtext id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">PE</mtext></ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3"><times id="S2.I1.i2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.1"></times><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.2">𝑃</ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.3.3a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.3"><mtext id="S2.I1.i2.p1.1.m1.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.I1.i2.p1.1.m1.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\text{PE}\in\mathbb{R}^{P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">PE ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is added:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE}," class="ltx_Math" display="block" id="S2.Ex2.m1.1"><semantics id="S2.Ex2.m1.1a"><mrow id="S2.Ex2.m1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.cmml"><msubsup id="S2.Ex2.m1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.1.1.1.1.2.2.2" xref="S2.Ex2.m1.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S2.Ex2.m1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.1.1.1.1.2.2.3.cmml">i</mi><mtext id="S2.Ex2.m1.1.1.1.1.2.3" xref="S2.Ex2.m1.1.1.1.1.2.3a.cmml">pos</mtext></msubsup><mo id="S2.Ex2.m1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.Ex2.m1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.3.cmml"><msub id="S2.Ex2.m1.1.1.1.1.3.2" xref="S2.Ex2.m1.1.1.1.1.3.2.cmml"><mi id="S2.Ex2.m1.1.1.1.1.3.2.2" xref="S2.Ex2.m1.1.1.1.1.3.2.2.cmml">𝐳</mi><mi id="S2.Ex2.m1.1.1.1.1.3.2.3" xref="S2.Ex2.m1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.Ex2.m1.1.1.1.1.3.1" xref="S2.Ex2.m1.1.1.1.1.3.1.cmml">+</mo><mtext id="S2.Ex2.m1.1.1.1.1.3.3" xref="S2.Ex2.m1.1.1.1.1.3.3a.cmml">PE</mtext></mrow></mrow><mo id="S2.Ex2.m1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.1b"><apply id="S2.Ex2.m1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1"><eq id="S2.Ex2.m1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1"></eq><apply id="S2.Ex2.m1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.Ex2.m1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.2.2.2">𝐳</ci><ci id="S2.Ex2.m1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.Ex2.m1.1.1.1.1.2.3a.cmml" xref="S2.Ex2.m1.1.1.1.1.2.3"><mtext id="S2.Ex2.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.Ex2.m1.1.1.1.1.2.3">pos</mtext></ci></apply><apply id="S2.Ex2.m1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.3"><plus id="S2.Ex2.m1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.1.1.1.1.3.1"></plus><apply id="S2.Ex2.m1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.3.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.3.2.2">𝐳</ci><ci id="S2.Ex2.m1.1.1.1.1.3.2.3.cmml" xref="S2.Ex2.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.Ex2.m1.1.1.1.1.3.3a.cmml" xref="S2.Ex2.m1.1.1.1.1.3.3"><mtext id="S2.Ex2.m1.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.1.1.1.1.3.3">PE</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.1c">\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT = bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + PE ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i2.p1.2">where PE is either:</p>
<ul class="ltx_itemize" id="S2.I1.i2.I1">
<li class="ltx_item" id="S2.I1.i2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.I1.i1.1.1.1">–</span></span>
<div class="ltx_para" id="S2.I1.i2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i2.I1.i1.p1.2"><em class="ltx_emph ltx_font_italic" id="S2.I1.i2.I1.i1.p1.2.1">Fixed sinusoidal</em>: <math alttext="\text{PE}_{(pos,2k)}=\sin\left(\frac{pos}{10000^{2k/d_{\text{model}}}}\right)" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i1.p1.1.m1.4"><semantics id="S2.I1.i2.I1.i1.p1.1.m1.4a"><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.5" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.cmml"><msub id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.cmml"><mtext id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2a.cmml">PE</mtext><mrow id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.3.cmml"><mo id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.3.cmml">(</mo><mrow id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">p</mi><mo id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1a" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.4" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.4" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.3.cmml">,</mo><mrow id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.cmml"><mn id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml">2</mn><mo id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.1" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.3" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml">k</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.5.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml"><mi id="S2.I1.i2.I1.i1.p1.1.m1.3.3" xref="S2.I1.i2.I1.i1.p1.1.m1.3.3.cmml">sin</mi><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2a" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml">⁡</mo><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml"><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2.1.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml">(</mo><mfrac id="S2.I1.i2.I1.i1.p1.1.m1.4.4" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.cmml"><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.cmml"><mi id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.2.cmml">p</mi><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.3.cmml">o</mi><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1a" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.4" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.4.cmml">s</mi></mrow><msup id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.cmml"><mn id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.2.cmml">10000</mn><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.cmml"><mrow id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.cmml"><mn id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.2.cmml">2</mn><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.3.cmml">k</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.1" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.1.cmml">/</mo><msub id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.2.cmml">d</mi><mtext id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mfrac><mo id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2.1.2" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i1.p1.1.m1.4b"><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.5.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5"><eq id="S2.I1.i2.I1.i1.p1.1.m1.4.5.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.1"></eq><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2">subscript</csymbol><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2a.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2"><mtext id="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.2.2">PE</mtext></ci><interval closure="open" id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2"><apply id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1"><times id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.1"></times><ci id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.2">𝑝</ci><ci id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.3">𝑜</ci><ci id="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.4.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.1.1.1.1.1.4">𝑠</ci></apply><apply id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2"><times id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.1"></times><cn id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.2">2</cn><ci id="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.2.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.5.3.2"><sin id="S2.I1.i2.I1.i1.p1.1.m1.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.3.3"></sin><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4"><divide id="S2.I1.i2.I1.i1.p1.1.m1.4.4.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4"></divide><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2"><times id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.1"></times><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.2">𝑝</ci><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.3">𝑜</ci><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.4.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.2.4">𝑠</ci></apply><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3">superscript</csymbol><cn id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.2">10000</cn><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3"><divide id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.1"></divide><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2"><times id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.1"></times><cn id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.2">2</cn><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.2.3">𝑘</ci></apply><apply id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.2">𝑑</ci><ci id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3a.cmml" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3"><mtext id="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3.cmml" mathsize="50%" xref="S2.I1.i2.I1.i1.p1.1.m1.4.4.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i1.p1.1.m1.4c">\text{PE}_{(pos,2k)}=\sin\left(\frac{pos}{10000^{2k/d_{\text{model}}}}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i1.p1.1.m1.4d">PE start_POSTSUBSCRIPT ( italic_p italic_o italic_s , 2 italic_k ) end_POSTSUBSCRIPT = roman_sin ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT 2 italic_k / italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math>, <math alttext="\text{PE}_{(pos,2k+1)}=\cos\left(\frac{pos}{10000^{2k/d_{\text{model}}}}\right)" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i1.p1.2.m2.4"><semantics id="S2.I1.i2.I1.i1.p1.2.m2.4a"><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.5" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.cmml"><msub id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.cmml"><mtext id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2a.cmml">PE</mtext><mrow id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.3.cmml"><mo id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.3" stretchy="false" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.3.cmml">(</mo><mrow id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.2" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml">p</mi><mo id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.3" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml">o</mi><mo id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1a" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.4" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.4" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.3.cmml">,</mo><mrow id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.cmml"><mrow id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.cmml"><mn id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.2.cmml">2</mn><mo id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.1" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.3" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.3.cmml">k</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.1" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.1.cmml">+</mo><mn id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.3" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.5" stretchy="false" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.5.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.1.cmml">=</mo><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml"><mi id="S2.I1.i2.I1.i1.p1.2.m2.3.3" xref="S2.I1.i2.I1.i1.p1.2.m2.3.3.cmml">cos</mi><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2a" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml">⁡</mo><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml"><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2.1.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml">(</mo><mfrac id="S2.I1.i2.I1.i1.p1.2.m2.4.4" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.cmml"><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.cmml"><mi id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.2.cmml">p</mi><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.3.cmml">o</mi><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1a" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.4" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.4.cmml">s</mi></mrow><msup id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.cmml"><mn id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.2.cmml">10000</mn><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.cmml"><mrow id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.cmml"><mn id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.2.cmml">2</mn><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.1.cmml">⁢</mo><mi id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.3.cmml">k</mi></mrow><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.1" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.1.cmml">/</mo><msub id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.2.cmml">d</mi><mtext id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mfrac><mo id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2.1.2" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i1.p1.2.m2.4b"><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.5.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5"><eq id="S2.I1.i2.I1.i1.p1.2.m2.4.5.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.1"></eq><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2">subscript</csymbol><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2a.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2"><mtext id="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.2.2">PE</mtext></ci><interval closure="open" id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2"><apply id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1"><times id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.1"></times><ci id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.3">𝑜</ci><ci id="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.4.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.1.1.1.1.1.4">𝑠</ci></apply><apply id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2"><plus id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.1"></plus><apply id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2"><times id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.1"></times><cn id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.2">2</cn><ci id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.2.3">𝑘</ci></apply><cn id="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.2.m2.2.2.2.2.2.3">1</cn></apply></interval></apply><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.5.3.2"><cos id="S2.I1.i2.I1.i1.p1.2.m2.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.3.3"></cos><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4"><divide id="S2.I1.i2.I1.i1.p1.2.m2.4.4.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4"></divide><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2"><times id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.1"></times><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.2">𝑝</ci><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.3">𝑜</ci><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.4.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.2.4">𝑠</ci></apply><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3">superscript</csymbol><cn id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.2">10000</cn><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3"><divide id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.1"></divide><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2"><times id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.1"></times><cn id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.2.cmml" type="integer" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.2">2</cn><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.2.3">𝑘</ci></apply><apply id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.2">𝑑</ci><ci id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3a.cmml" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3"><mtext id="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3.cmml" mathsize="50%" xref="S2.I1.i2.I1.i1.p1.2.m2.4.4.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i1.p1.2.m2.4c">\text{PE}_{(pos,2k+1)}=\cos\left(\frac{pos}{10000^{2k/d_{\text{model}}}}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i1.p1.2.m2.4d">PE start_POSTSUBSCRIPT ( italic_p italic_o italic_s , 2 italic_k + 1 ) end_POSTSUBSCRIPT = roman_cos ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT 2 italic_k / italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.I1.i2.1.1.1">–</span></span>
<div class="ltx_para" id="S2.I1.i2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.I1.i2.p1.1">or <span class="ltx_text ltx_font_italic" id="S2.I1.i2.I1.i2.p1.1.1">Learnable</span>: parameters optimized during training.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1"><em class="ltx_emph ltx_font_italic" id="S2.I1.i3.p1.1.1">Transformer Encoder</em>: Given a sequence <math alttext="\mathbf{Z}\in\mathbb{R}^{P\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i3.p1.1.m1.1a"><mrow id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.2" xref="S2.I1.i3.p1.1.m1.1.1.2.cmml">𝐙</mi><mo id="S2.I1.i3.p1.1.m1.1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.I1.i3.p1.1.m1.1.1.3" xref="S2.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.3.2" xref="S2.I1.i3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.I1.i3.p1.1.m1.1.1.3.3" xref="S2.I1.i3.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.3.3.2" xref="S2.I1.i3.p1.1.m1.1.1.3.3.2.cmml">P</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.I1.i3.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.I1.i3.p1.1.m1.1.1.3.3.3" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.3.3.3.2" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.I1.i3.p1.1.m1.1.1.3.3.3.3" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><apply id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1"><in id="S2.I1.i3.p1.1.m1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.1"></in><ci id="S2.I1.i3.p1.1.m1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2">𝐙</ci><apply id="S2.I1.i3.p1.1.m1.1.1.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3"><times id="S2.I1.i3.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.1"></times><ci id="S2.I1.i3.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.2">𝑃</ci><apply id="S2.I1.i3.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.3.3.3a.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.3"><mtext id="S2.I1.i3.p1.1.m1.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.I1.i3.p1.1.m1.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mathbf{Z}\in\mathbb{R}^{P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">bold_Z ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, the Transformer encoder applies multiple layers of multi-head self-attention (MSA) and feedforward networks (FFN):</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}^{(e)}=\text{TransformerEncoder}(\mathbf{Z})\\
=\text{LayerNorm}\left(\mathbf{Z}+\text{FFN}\left(\text{MSA}(\mathbf{Z})\right%
)\right)," class="ltx_Math" display="block" id="S2.E4.m1.23"><semantics id="S2.E4.m1.23a"><mtable displaystyle="true" id="S2.E4.m1.23.23.2" rowspacing="0pt"><mtr id="S2.E4.m1.23.23.2a"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.23.23.2b"><mrow id="S2.E4.m1.7.7.7.7.7"><msup id="S2.E4.m1.7.7.7.7.7.8"><mi id="S2.E4.m1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.cmml">𝐇</mi><mrow id="S2.E4.m1.2.2.2.2.2.2.1.3"><mo id="S2.E4.m1.2.2.2.2.2.2.1.3.1" stretchy="false">(</mo><mi id="S2.E4.m1.2.2.2.2.2.2.1.1" xref="S2.E4.m1.2.2.2.2.2.2.1.1.cmml">e</mi><mo id="S2.E4.m1.2.2.2.2.2.2.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E4.m1.3.3.3.3.3.3" xref="S2.E4.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E4.m1.7.7.7.7.7.9"><mtext id="S2.E4.m1.4.4.4.4.4.4" xref="S2.E4.m1.4.4.4.4.4.4a.cmml">TransformerEncoder</mtext><mo id="S2.E4.m1.7.7.7.7.7.9.1" xref="S2.E4.m1.22.22.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.7.7.7.9.2"><mo id="S2.E4.m1.5.5.5.5.5.5" stretchy="false" xref="S2.E4.m1.22.22.1.1.1.cmml">(</mo><mi id="S2.E4.m1.6.6.6.6.6.6" xref="S2.E4.m1.6.6.6.6.6.6.cmml">𝐙</mi><mo id="S2.E4.m1.7.7.7.7.7.7" stretchy="false" xref="S2.E4.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S2.E4.m1.23.23.2c"><mtd class="ltx_align_right" columnalign="right" id="S2.E4.m1.23.23.2d"><mrow id="S2.E4.m1.23.23.2.22.15.15.15"><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1"><mi id="S2.E4.m1.23.23.2.22.15.15.15.1.2" xref="S2.E4.m1.22.22.1.1.1.cmml"></mi><mo id="S2.E4.m1.8.8.8.1.1.1" xref="S2.E4.m1.8.8.8.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1"><mtext id="S2.E4.m1.9.9.9.2.2.2" xref="S2.E4.m1.9.9.9.2.2.2a.cmml">LayerNorm</mtext><mo id="S2.E4.m1.23.23.2.22.15.15.15.1.1.2" xref="S2.E4.m1.22.22.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1"><mo id="S2.E4.m1.10.10.10.3.3.3" xref="S2.E4.m1.22.22.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1"><mi id="S2.E4.m1.11.11.11.4.4.4" xref="S2.E4.m1.11.11.11.4.4.4.cmml">𝐙</mi><mo id="S2.E4.m1.12.12.12.5.5.5" xref="S2.E4.m1.12.12.12.5.5.5.cmml">+</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1"><mtext id="S2.E4.m1.13.13.13.6.6.6" xref="S2.E4.m1.13.13.13.6.6.6a.cmml">FFN</mtext><mo id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1.2" xref="S2.E4.m1.22.22.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1.1.1"><mo id="S2.E4.m1.14.14.14.7.7.7" xref="S2.E4.m1.22.22.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1.1.1.1"><mtext id="S2.E4.m1.15.15.15.8.8.8" xref="S2.E4.m1.15.15.15.8.8.8a.cmml">MSA</mtext><mo id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.22.22.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.23.23.2.22.15.15.15.1.1.1.1.1.1.1.1.1.2"><mo id="S2.E4.m1.16.16.16.9.9.9" stretchy="false" xref="S2.E4.m1.22.22.1.1.1.cmml">(</mo><mi id="S2.E4.m1.17.17.17.10.10.10" xref="S2.E4.m1.17.17.17.10.10.10.cmml">𝐙</mi><mo id="S2.E4.m1.18.18.18.11.11.11" stretchy="false" xref="S2.E4.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.19.19.19.12.12.12" xref="S2.E4.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.20.20.20.13.13.13" xref="S2.E4.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.21.21.21.14.14.14" xref="S2.E4.m1.22.22.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E4.m1.23b"><apply id="S2.E4.m1.22.22.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><and id="S2.E4.m1.22.22.1.1.1a.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></and><apply id="S2.E4.m1.22.22.1.1.1b.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><eq id="S2.E4.m1.3.3.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3"></eq><apply id="S2.E4.m1.22.22.1.1.1.3.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><csymbol cd="ambiguous" id="S2.E4.m1.22.22.1.1.1.3.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1">𝐇</ci><ci id="S2.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.1.1">𝑒</ci></apply><apply id="S2.E4.m1.22.22.1.1.1.5.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><times id="S2.E4.m1.22.22.1.1.1.5.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></times><ci id="S2.E4.m1.4.4.4.4.4.4a.cmml" xref="S2.E4.m1.4.4.4.4.4.4"><mtext id="S2.E4.m1.4.4.4.4.4.4.cmml" xref="S2.E4.m1.4.4.4.4.4.4">TransformerEncoder</mtext></ci><ci id="S2.E4.m1.6.6.6.6.6.6.cmml" xref="S2.E4.m1.6.6.6.6.6.6">𝐙</ci></apply></apply><apply id="S2.E4.m1.22.22.1.1.1c.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><eq id="S2.E4.m1.8.8.8.1.1.1.cmml" xref="S2.E4.m1.8.8.8.1.1.1"></eq><share href="https://arxiv.org/html/2505.20048v1#S2.E4.m1.22.22.1.1.1.5.cmml" id="S2.E4.m1.22.22.1.1.1d.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></share><apply id="S2.E4.m1.22.22.1.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><times id="S2.E4.m1.22.22.1.1.1.1.2.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></times><ci id="S2.E4.m1.9.9.9.2.2.2a.cmml" xref="S2.E4.m1.9.9.9.2.2.2"><mtext id="S2.E4.m1.9.9.9.2.2.2.cmml" xref="S2.E4.m1.9.9.9.2.2.2">LayerNorm</mtext></ci><apply id="S2.E4.m1.22.22.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><plus id="S2.E4.m1.12.12.12.5.5.5.cmml" xref="S2.E4.m1.12.12.12.5.5.5"></plus><ci id="S2.E4.m1.11.11.11.4.4.4.cmml" xref="S2.E4.m1.11.11.11.4.4.4">𝐙</ci><apply id="S2.E4.m1.22.22.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><times id="S2.E4.m1.22.22.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></times><ci id="S2.E4.m1.13.13.13.6.6.6a.cmml" xref="S2.E4.m1.13.13.13.6.6.6"><mtext id="S2.E4.m1.13.13.13.6.6.6.cmml" xref="S2.E4.m1.13.13.13.6.6.6">FFN</mtext></ci><apply id="S2.E4.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"><times id="S2.E4.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.7.7.7.9.1"></times><ci id="S2.E4.m1.15.15.15.8.8.8a.cmml" xref="S2.E4.m1.15.15.15.8.8.8"><mtext id="S2.E4.m1.15.15.15.8.8.8.cmml" xref="S2.E4.m1.15.15.15.8.8.8">MSA</mtext></ci><ci id="S2.E4.m1.17.17.17.10.10.10.cmml" xref="S2.E4.m1.17.17.17.10.10.10">𝐙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.23c">\mathbf{H}^{(e)}=\text{TransformerEncoder}(\mathbf{Z})\\
=\text{LayerNorm}\left(\mathbf{Z}+\text{FFN}\left(\text{MSA}(\mathbf{Z})\right%
)\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.23d">start_ROW start_CELL bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT = TransformerEncoder ( bold_Z ) end_CELL end_ROW start_ROW start_CELL = LayerNorm ( bold_Z + FFN ( MSA ( bold_Z ) ) ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i3.p1.2">where <math alttext="\mathbf{H}^{(e)}\in\mathbb{R}^{P\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.2.m1.1"><semantics id="S2.I1.i3.p1.2.m1.1a"><mrow id="S2.I1.i3.p1.2.m1.1.2" xref="S2.I1.i3.p1.2.m1.1.2.cmml"><msup id="S2.I1.i3.p1.2.m1.1.2.2" xref="S2.I1.i3.p1.2.m1.1.2.2.cmml"><mi id="S2.I1.i3.p1.2.m1.1.2.2.2" xref="S2.I1.i3.p1.2.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S2.I1.i3.p1.2.m1.1.1.1.3" xref="S2.I1.i3.p1.2.m1.1.2.2.cmml"><mo id="S2.I1.i3.p1.2.m1.1.1.1.3.1" stretchy="false" xref="S2.I1.i3.p1.2.m1.1.2.2.cmml">(</mo><mi id="S2.I1.i3.p1.2.m1.1.1.1.1" xref="S2.I1.i3.p1.2.m1.1.1.1.1.cmml">e</mi><mo id="S2.I1.i3.p1.2.m1.1.1.1.3.2" stretchy="false" xref="S2.I1.i3.p1.2.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="S2.I1.i3.p1.2.m1.1.2.1" xref="S2.I1.i3.p1.2.m1.1.2.1.cmml">∈</mo><msup id="S2.I1.i3.p1.2.m1.1.2.3" xref="S2.I1.i3.p1.2.m1.1.2.3.cmml"><mi id="S2.I1.i3.p1.2.m1.1.2.3.2" xref="S2.I1.i3.p1.2.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.I1.i3.p1.2.m1.1.2.3.3" xref="S2.I1.i3.p1.2.m1.1.2.3.3.cmml"><mi id="S2.I1.i3.p1.2.m1.1.2.3.3.2" xref="S2.I1.i3.p1.2.m1.1.2.3.3.2.cmml">P</mi><mo id="S2.I1.i3.p1.2.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.I1.i3.p1.2.m1.1.2.3.3.1.cmml">×</mo><msub id="S2.I1.i3.p1.2.m1.1.2.3.3.3" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.cmml"><mi id="S2.I1.i3.p1.2.m1.1.2.3.3.3.2" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.2.cmml">d</mi><mtext id="S2.I1.i3.p1.2.m1.1.2.3.3.3.3" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m1.1b"><apply id="S2.I1.i3.p1.2.m1.1.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2"><in id="S2.I1.i3.p1.2.m1.1.2.1.cmml" xref="S2.I1.i3.p1.2.m1.1.2.1"></in><apply id="S2.I1.i3.p1.2.m1.1.2.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.1.2.2.1.cmml" xref="S2.I1.i3.p1.2.m1.1.2.2">superscript</csymbol><ci id="S2.I1.i3.p1.2.m1.1.2.2.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2.2.2">𝐇</ci><ci id="S2.I1.i3.p1.2.m1.1.1.1.1.cmml" xref="S2.I1.i3.p1.2.m1.1.1.1.1">𝑒</ci></apply><apply id="S2.I1.i3.p1.2.m1.1.2.3.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.1.2.3.1.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3">superscript</csymbol><ci id="S2.I1.i3.p1.2.m1.1.2.3.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.2">ℝ</ci><apply id="S2.I1.i3.p1.2.m1.1.2.3.3.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3"><times id="S2.I1.i3.p1.2.m1.1.2.3.3.1.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.1"></times><ci id="S2.I1.i3.p1.2.m1.1.2.3.3.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.2">𝑃</ci><apply id="S2.I1.i3.p1.2.m1.1.2.3.3.3.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.1.2.3.3.3.1.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.1.2.3.3.3.2.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.2">𝑑</ci><ci id="S2.I1.i3.p1.2.m1.1.2.3.3.3.3a.cmml" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.3"><mtext id="S2.I1.i3.p1.2.m1.1.2.3.3.3.3.cmml" mathsize="50%" xref="S2.I1.i3.p1.2.m1.1.2.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m1.1c">\mathbf{H}^{(e)}\in\mathbb{R}^{P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.2.m1.1d">bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.4"><span class="ltx_text" id="S2.I1.i4.p1.4.1">Transformer Decoder</span>: Given a decoder input <math alttext="\mathbf{Z}^{(d)}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1"><semantics id="S2.I1.i4.p1.1.m1.1a"><msup id="S2.I1.i4.p1.1.m1.1.2" xref="S2.I1.i4.p1.1.m1.1.2.cmml"><mi id="S2.I1.i4.p1.1.m1.1.2.2" xref="S2.I1.i4.p1.1.m1.1.2.2.cmml">𝐙</mi><mrow id="S2.I1.i4.p1.1.m1.1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.2.cmml"><mo id="S2.I1.i4.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.I1.i4.p1.1.m1.1.2.cmml">(</mo><mi id="S2.I1.i4.p1.1.m1.1.1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.1.1.cmml">d</mi><mo id="S2.I1.i4.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.I1.i4.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><apply id="S2.I1.i4.p1.1.m1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.2.1.cmml" xref="S2.I1.i4.p1.1.m1.1.2">superscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.2.2.cmml" xref="S2.I1.i4.p1.1.m1.1.2.2">𝐙</ci><ci id="S2.I1.i4.p1.1.m1.1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\mathbf{Z}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.1.m1.1d">bold_Z start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math> and encoder output <math alttext="\mathbf{H}^{(e)}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.2.m2.1"><semantics id="S2.I1.i4.p1.2.m2.1a"><msup id="S2.I1.i4.p1.2.m2.1.2" xref="S2.I1.i4.p1.2.m2.1.2.cmml"><mi id="S2.I1.i4.p1.2.m2.1.2.2" xref="S2.I1.i4.p1.2.m2.1.2.2.cmml">𝐇</mi><mrow id="S2.I1.i4.p1.2.m2.1.1.1.3" xref="S2.I1.i4.p1.2.m2.1.2.cmml"><mo id="S2.I1.i4.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.I1.i4.p1.2.m2.1.2.cmml">(</mo><mi id="S2.I1.i4.p1.2.m2.1.1.1.1" xref="S2.I1.i4.p1.2.m2.1.1.1.1.cmml">e</mi><mo id="S2.I1.i4.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.I1.i4.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b"><apply id="S2.I1.i4.p1.2.m2.1.2.cmml" xref="S2.I1.i4.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.2.m2.1.2.1.cmml" xref="S2.I1.i4.p1.2.m2.1.2">superscript</csymbol><ci id="S2.I1.i4.p1.2.m2.1.2.2.cmml" xref="S2.I1.i4.p1.2.m2.1.2.2">𝐇</ci><ci id="S2.I1.i4.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">\mathbf{H}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.2.m2.1d">bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math>, the Transformer decoder applies self-attention over <math alttext="\mathbf{Z}^{(d)}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.3.m3.1"><semantics id="S2.I1.i4.p1.3.m3.1a"><msup id="S2.I1.i4.p1.3.m3.1.2" xref="S2.I1.i4.p1.3.m3.1.2.cmml"><mi id="S2.I1.i4.p1.3.m3.1.2.2" xref="S2.I1.i4.p1.3.m3.1.2.2.cmml">𝐙</mi><mrow id="S2.I1.i4.p1.3.m3.1.1.1.3" xref="S2.I1.i4.p1.3.m3.1.2.cmml"><mo id="S2.I1.i4.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S2.I1.i4.p1.3.m3.1.2.cmml">(</mo><mi id="S2.I1.i4.p1.3.m3.1.1.1.1" xref="S2.I1.i4.p1.3.m3.1.1.1.1.cmml">d</mi><mo id="S2.I1.i4.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S2.I1.i4.p1.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.3.m3.1b"><apply id="S2.I1.i4.p1.3.m3.1.2.cmml" xref="S2.I1.i4.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.3.m3.1.2.1.cmml" xref="S2.I1.i4.p1.3.m3.1.2">superscript</csymbol><ci id="S2.I1.i4.p1.3.m3.1.2.2.cmml" xref="S2.I1.i4.p1.3.m3.1.2.2">𝐙</ci><ci id="S2.I1.i4.p1.3.m3.1.1.1.1.cmml" xref="S2.I1.i4.p1.3.m3.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.3.m3.1c">\mathbf{Z}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.3.m3.1d">bold_Z start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math> and cross-attention with <math alttext="\mathbf{H}^{(e)}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.4.m4.1"><semantics id="S2.I1.i4.p1.4.m4.1a"><msup id="S2.I1.i4.p1.4.m4.1.2" xref="S2.I1.i4.p1.4.m4.1.2.cmml"><mi id="S2.I1.i4.p1.4.m4.1.2.2" xref="S2.I1.i4.p1.4.m4.1.2.2.cmml">𝐇</mi><mrow id="S2.I1.i4.p1.4.m4.1.1.1.3" xref="S2.I1.i4.p1.4.m4.1.2.cmml"><mo id="S2.I1.i4.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S2.I1.i4.p1.4.m4.1.2.cmml">(</mo><mi id="S2.I1.i4.p1.4.m4.1.1.1.1" xref="S2.I1.i4.p1.4.m4.1.1.1.1.cmml">e</mi><mo id="S2.I1.i4.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S2.I1.i4.p1.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.4.m4.1b"><apply id="S2.I1.i4.p1.4.m4.1.2.cmml" xref="S2.I1.i4.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S2.I1.i4.p1.4.m4.1.2.1.cmml" xref="S2.I1.i4.p1.4.m4.1.2">superscript</csymbol><ci id="S2.I1.i4.p1.4.m4.1.2.2.cmml" xref="S2.I1.i4.p1.4.m4.1.2.2">𝐇</ci><ci id="S2.I1.i4.p1.4.m4.1.1.1.1.cmml" xref="S2.I1.i4.p1.4.m4.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.4.m4.1c">\mathbf{H}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.4.m4.1d">bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}^{(d)}=\text{TransformerDecoder}(\mathbf{Z}^{(d)},\mathbf{H}^{(e)})%
\\
=\text{LayerNorm}\Bigg{(}\mathbf{Z}^{(d)}\\
+\text{CrossAttention}\left(\text{SelfAttention}(\mathbf{Z}^{(d)}),\mathbf{H}^%
{(e)}\right)\Bigg{)}." class="ltx_Math" display="block" id="S2.E5.m1.33"><semantics id="S2.E5.m1.33a"><mtable displaystyle="true" id="S2.E5.m1.33.33.3" rowspacing="0pt"><mtr id="S2.E5.m1.33.33.3a"><mtd class="ltx_align_left" columnalign="left" id="S2.E5.m1.33.33.3b"><mrow id="S2.E5.m1.33.33.3.32.13.13"><msup id="S2.E5.m1.33.33.3.32.13.13.14"><mi id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml">𝐇</mi><mrow id="S2.E5.m1.2.2.2.2.2.2.1.3"><mo id="S2.E5.m1.2.2.2.2.2.2.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.2.2.2.2.2.2.1.1" xref="S2.E5.m1.2.2.2.2.2.2.1.1.cmml">d</mi><mo id="S2.E5.m1.2.2.2.2.2.2.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E5.m1.3.3.3.3.3.3" xref="S2.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E5.m1.33.33.3.32.13.13.13"><mtext id="S2.E5.m1.4.4.4.4.4.4" xref="S2.E5.m1.4.4.4.4.4.4a.cmml">TransformerDecoder</mtext><mo id="S2.E5.m1.33.33.3.32.13.13.13.3" xref="S2.E5.m1.31.31.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.33.33.3.32.13.13.13.2.2"><mo id="S2.E5.m1.5.5.5.5.5.5" stretchy="false" xref="S2.E5.m1.31.31.1.1.1.cmml">(</mo><msup id="S2.E5.m1.32.32.2.31.12.12.12.1.1.1"><mi id="S2.E5.m1.6.6.6.6.6.6" xref="S2.E5.m1.6.6.6.6.6.6.cmml">𝐙</mi><mrow id="S2.E5.m1.7.7.7.7.7.7.1.3"><mo id="S2.E5.m1.7.7.7.7.7.7.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.7.7.7.7.7.7.1.1" xref="S2.E5.m1.7.7.7.7.7.7.1.1.cmml">d</mi><mo id="S2.E5.m1.7.7.7.7.7.7.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E5.m1.8.8.8.8.8.8" xref="S2.E5.m1.31.31.1.1.1.cmml">,</mo><msup id="S2.E5.m1.33.33.3.32.13.13.13.2.2.2"><mi id="S2.E5.m1.9.9.9.9.9.9" xref="S2.E5.m1.9.9.9.9.9.9.cmml">𝐇</mi><mrow id="S2.E5.m1.10.10.10.10.10.10.1.3"><mo id="S2.E5.m1.10.10.10.10.10.10.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.10.10.10.10.10.10.1.1" xref="S2.E5.m1.10.10.10.10.10.10.1.1.cmml">e</mi><mo id="S2.E5.m1.10.10.10.10.10.10.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E5.m1.11.11.11.11.11.11" stretchy="false" xref="S2.E5.m1.31.31.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S2.E5.m1.33.33.3c"><mtd class="ltx_align_right" columnalign="right" id="S2.E5.m1.33.33.3d"><mrow id="S2.E5.m1.16.16.16.5.5"><mo id="S2.E5.m1.12.12.12.1.1.1" xref="S2.E5.m1.12.12.12.1.1.1.cmml">=</mo><mtext id="S2.E5.m1.13.13.13.2.2.2" xref="S2.E5.m1.13.13.13.2.2.2a.cmml">LayerNorm</mtext><mrow id="S2.E5.m1.16.16.16.5.5.6"><mo id="S2.E5.m1.14.14.14.3.3.3" maxsize="260%" minsize="260%" xref="S2.E5.m1.31.31.1.1.1.cmml">(</mo><msup id="S2.E5.m1.16.16.16.5.5.6.1"><mi id="S2.E5.m1.15.15.15.4.4.4" xref="S2.E5.m1.15.15.15.4.4.4.cmml">𝐙</mi><mrow id="S2.E5.m1.16.16.16.5.5.5.1.3"><mo id="S2.E5.m1.16.16.16.5.5.5.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.16.16.16.5.5.5.1.1" xref="S2.E5.m1.16.16.16.5.5.5.1.1.cmml">d</mi><mo id="S2.E5.m1.16.16.16.5.5.5.1.3.2" stretchy="false">)</mo></mrow></msup></mrow></mrow></mtd></mtr><mtr id="S2.E5.m1.33.33.3e"><mtd class="ltx_align_right" columnalign="right" id="S2.E5.m1.33.33.3f"><mrow id="S2.E5.m1.30.30.30.14.14"><mo id="S2.E5.m1.17.17.17.1.1.1" xref="S2.E5.m1.17.17.17.1.1.1.cmml">+</mo><mtext id="S2.E5.m1.18.18.18.2.2.2" xref="S2.E5.m1.18.18.18.2.2.2a.cmml">CrossAttention</mtext><mrow id="S2.E5.m1.30.30.30.14.14.15"><mo id="S2.E5.m1.19.19.19.3.3.3" xref="S2.E5.m1.31.31.1.1.1.cmml">(</mo><mtext id="S2.E5.m1.20.20.20.4.4.4" xref="S2.E5.m1.20.20.20.4.4.4a.cmml">SelfAttention</mtext><mrow id="S2.E5.m1.30.30.30.14.14.15.1"><mo id="S2.E5.m1.21.21.21.5.5.5" stretchy="false" xref="S2.E5.m1.31.31.1.1.1.cmml">(</mo><msup id="S2.E5.m1.30.30.30.14.14.15.1.1"><mi id="S2.E5.m1.22.22.22.6.6.6" xref="S2.E5.m1.22.22.22.6.6.6.cmml">𝐙</mi><mrow id="S2.E5.m1.23.23.23.7.7.7.1.3"><mo id="S2.E5.m1.23.23.23.7.7.7.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.23.23.23.7.7.7.1.1" xref="S2.E5.m1.23.23.23.7.7.7.1.1.cmml">d</mi><mo id="S2.E5.m1.23.23.23.7.7.7.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E5.m1.24.24.24.8.8.8" stretchy="false" xref="S2.E5.m1.31.31.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.25.25.25.9.9.9" xref="S2.E5.m1.31.31.1.1.1.cmml">,</mo><msup id="S2.E5.m1.30.30.30.14.14.15.2"><mi id="S2.E5.m1.26.26.26.10.10.10" xref="S2.E5.m1.26.26.26.10.10.10.cmml">𝐇</mi><mrow id="S2.E5.m1.27.27.27.11.11.11.1.3"><mo id="S2.E5.m1.27.27.27.11.11.11.1.3.1" stretchy="false">(</mo><mi id="S2.E5.m1.27.27.27.11.11.11.1.1" xref="S2.E5.m1.27.27.27.11.11.11.1.1.cmml">e</mi><mo id="S2.E5.m1.27.27.27.11.11.11.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S2.E5.m1.28.28.28.12.12.12" xref="S2.E5.m1.31.31.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.29.29.29.13.13.13" maxsize="260%" minsize="260%" xref="S2.E5.m1.31.31.1.1.1.cmml">)</mo><mo id="S2.E5.m1.30.30.30.14.14.14" lspace="0em" xref="S2.E5.m1.31.31.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E5.m1.33b"><apply id="S2.E5.m1.31.31.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><and id="S2.E5.m1.31.31.1.1.1a.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></and><apply id="S2.E5.m1.31.31.1.1.1b.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><eq id="S2.E5.m1.3.3.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3.3.3"></eq><apply id="S2.E5.m1.31.31.1.1.1.5.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.5.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1">𝐇</ci><ci id="S2.E5.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1.1">𝑑</ci></apply><apply id="S2.E5.m1.31.31.1.1.1.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><times id="S2.E5.m1.31.31.1.1.1.2.3.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></times><ci id="S2.E5.m1.4.4.4.4.4.4a.cmml" xref="S2.E5.m1.4.4.4.4.4.4"><mtext id="S2.E5.m1.4.4.4.4.4.4.cmml" xref="S2.E5.m1.4.4.4.4.4.4">TransformerDecoder</mtext></ci><interval closure="open" id="S2.E5.m1.31.31.1.1.1.2.2.3.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><apply id="S2.E5.m1.31.31.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.6.6.6.6.6.6.cmml" xref="S2.E5.m1.6.6.6.6.6.6">𝐙</ci><ci id="S2.E5.m1.7.7.7.7.7.7.1.1.cmml" xref="S2.E5.m1.7.7.7.7.7.7.1.1">𝑑</ci></apply><apply id="S2.E5.m1.31.31.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.2.2.2.2.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.9.9.9.9.9.9.cmml" xref="S2.E5.m1.9.9.9.9.9.9">𝐇</ci><ci id="S2.E5.m1.10.10.10.10.10.10.1.1.cmml" xref="S2.E5.m1.10.10.10.10.10.10.1.1">𝑒</ci></apply></interval></apply></apply><apply id="S2.E5.m1.31.31.1.1.1c.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><eq id="S2.E5.m1.12.12.12.1.1.1.cmml" xref="S2.E5.m1.12.12.12.1.1.1"></eq><share href="https://arxiv.org/html/2505.20048v1#S2.E5.m1.31.31.1.1.1.2.cmml" id="S2.E5.m1.31.31.1.1.1d.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></share><apply id="S2.E5.m1.31.31.1.1.1.3.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><times id="S2.E5.m1.31.31.1.1.1.3.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></times><ci id="S2.E5.m1.13.13.13.2.2.2a.cmml" xref="S2.E5.m1.13.13.13.2.2.2"><mtext id="S2.E5.m1.13.13.13.2.2.2.cmml" xref="S2.E5.m1.13.13.13.2.2.2">LayerNorm</mtext></ci><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><plus id="S2.E5.m1.17.17.17.1.1.1.cmml" xref="S2.E5.m1.17.17.17.1.1.1"></plus><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.4.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.3.1.1.1.4.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.15.15.15.4.4.4.cmml" xref="S2.E5.m1.15.15.15.4.4.4">𝐙</ci><ci id="S2.E5.m1.16.16.16.5.5.5.1.1.cmml" xref="S2.E5.m1.16.16.16.5.5.5.1.1">𝑑</ci></apply><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><times id="S2.E5.m1.31.31.1.1.1.3.1.1.1.2.3.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></times><ci id="S2.E5.m1.18.18.18.2.2.2a.cmml" xref="S2.E5.m1.18.18.18.2.2.2"><mtext id="S2.E5.m1.18.18.18.2.2.2.cmml" xref="S2.E5.m1.18.18.18.2.2.2">CrossAttention</mtext></ci><interval closure="open" id="S2.E5.m1.31.31.1.1.1.3.1.1.1.2.2.3.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><times id="S2.E5.m1.31.31.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"></times><ci id="S2.E5.m1.20.20.20.4.4.4a.cmml" xref="S2.E5.m1.20.20.20.4.4.4"><mtext id="S2.E5.m1.20.20.20.4.4.4.cmml" xref="S2.E5.m1.20.20.20.4.4.4">SelfAttention</mtext></ci><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.22.22.22.6.6.6.cmml" xref="S2.E5.m1.22.22.22.6.6.6">𝐙</ci><ci id="S2.E5.m1.23.23.23.7.7.7.1.1.cmml" xref="S2.E5.m1.23.23.23.7.7.7.1.1">𝑑</ci></apply></apply><apply id="S2.E5.m1.31.31.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3"><csymbol cd="ambiguous" id="S2.E5.m1.31.31.1.1.1.3.1.1.1.2.2.2.2.1.cmml" xref="S2.E5.m1.33.33.3.32.13.13.13.3">superscript</csymbol><ci id="S2.E5.m1.26.26.26.10.10.10.cmml" xref="S2.E5.m1.26.26.26.10.10.10">𝐇</ci><ci id="S2.E5.m1.27.27.27.11.11.11.1.1.cmml" xref="S2.E5.m1.27.27.27.11.11.11.1.1">𝑒</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.33c">\mathbf{H}^{(d)}=\text{TransformerDecoder}(\mathbf{Z}^{(d)},\mathbf{H}^{(e)})%
\\
=\text{LayerNorm}\Bigg{(}\mathbf{Z}^{(d)}\\
+\text{CrossAttention}\left(\text{SelfAttention}(\mathbf{Z}^{(d)}),\mathbf{H}^%
{(e)}\right)\Bigg{)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.33d">start_ROW start_CELL bold_H start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT = TransformerDecoder ( bold_Z start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT , bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL = LayerNorm ( bold_Z start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL + CrossAttention ( SelfAttention ( bold_Z start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ) , bold_H start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i5.p1">
<p class="ltx_p" id="S2.I1.i5.p1.3"><em class="ltx_emph ltx_font_italic" id="S2.I1.i5.p1.3.1">Average Pooling (AvgPool)</em>: After encoding, we often apply average pooling over the sequence (token) dimension to get a fixed-size vector:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{AvgPool}(\mathbf{H})=\frac{1}{P}\sum_{p=1}^{P}\mathbf{H}_{p}," class="ltx_Math" display="block" id="S2.Ex3.m1.2"><semantics id="S2.Ex3.m1.2a"><mrow id="S2.Ex3.m1.2.2.1" xref="S2.Ex3.m1.2.2.1.1.cmml"><mrow id="S2.Ex3.m1.2.2.1.1" xref="S2.Ex3.m1.2.2.1.1.cmml"><mrow id="S2.Ex3.m1.2.2.1.1.2" xref="S2.Ex3.m1.2.2.1.1.2.cmml"><mtext id="S2.Ex3.m1.2.2.1.1.2.2" xref="S2.Ex3.m1.2.2.1.1.2.2a.cmml">AvgPool</mtext><mo id="S2.Ex3.m1.2.2.1.1.2.1" xref="S2.Ex3.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S2.Ex3.m1.2.2.1.1.2.3.2" xref="S2.Ex3.m1.2.2.1.1.2.cmml"><mo id="S2.Ex3.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="S2.Ex3.m1.2.2.1.1.2.cmml">(</mo><mi id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">𝐇</mi><mo id="S2.Ex3.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="S2.Ex3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.2.2.1.1.1" xref="S2.Ex3.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.Ex3.m1.2.2.1.1.3" xref="S2.Ex3.m1.2.2.1.1.3.cmml"><mfrac id="S2.Ex3.m1.2.2.1.1.3.2" xref="S2.Ex3.m1.2.2.1.1.3.2.cmml"><mn id="S2.Ex3.m1.2.2.1.1.3.2.2" xref="S2.Ex3.m1.2.2.1.1.3.2.2.cmml">1</mn><mi id="S2.Ex3.m1.2.2.1.1.3.2.3" xref="S2.Ex3.m1.2.2.1.1.3.2.3.cmml">P</mi></mfrac><mo id="S2.Ex3.m1.2.2.1.1.3.1" xref="S2.Ex3.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex3.m1.2.2.1.1.3.3" xref="S2.Ex3.m1.2.2.1.1.3.3.cmml"><munderover id="S2.Ex3.m1.2.2.1.1.3.3.1" xref="S2.Ex3.m1.2.2.1.1.3.3.1.cmml"><mo id="S2.Ex3.m1.2.2.1.1.3.3.1.2.2" movablelimits="false" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.cmml"><mi id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.2" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.2.cmml">p</mi><mo id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.1" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.3" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex3.m1.2.2.1.1.3.3.1.3" xref="S2.Ex3.m1.2.2.1.1.3.3.1.3.cmml">P</mi></munderover><msub id="S2.Ex3.m1.2.2.1.1.3.3.2" xref="S2.Ex3.m1.2.2.1.1.3.3.2.cmml"><mi id="S2.Ex3.m1.2.2.1.1.3.3.2.2" xref="S2.Ex3.m1.2.2.1.1.3.3.2.2.cmml">𝐇</mi><mi id="S2.Ex3.m1.2.2.1.1.3.3.2.3" xref="S2.Ex3.m1.2.2.1.1.3.3.2.3.cmml">p</mi></msub></mrow></mrow></mrow><mo id="S2.Ex3.m1.2.2.1.2" xref="S2.Ex3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.2b"><apply id="S2.Ex3.m1.2.2.1.1.cmml" xref="S2.Ex3.m1.2.2.1"><eq id="S2.Ex3.m1.2.2.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1"></eq><apply id="S2.Ex3.m1.2.2.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.2"><times id="S2.Ex3.m1.2.2.1.1.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.2.1"></times><ci id="S2.Ex3.m1.2.2.1.1.2.2a.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2"><mtext id="S2.Ex3.m1.2.2.1.1.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2">AvgPool</mtext></ci><ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">𝐇</ci></apply><apply id="S2.Ex3.m1.2.2.1.1.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3"><times id="S2.Ex3.m1.2.2.1.1.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.1"></times><apply id="S2.Ex3.m1.2.2.1.1.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.2"><divide id="S2.Ex3.m1.2.2.1.1.3.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.2"></divide><cn id="S2.Ex3.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="S2.Ex3.m1.2.2.1.1.3.2.2">1</cn><ci id="S2.Ex3.m1.2.2.1.1.3.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.2.3">𝑃</ci></apply><apply id="S2.Ex3.m1.2.2.1.1.3.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3"><apply id="S2.Ex3.m1.2.2.1.1.3.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.3.3.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1">superscript</csymbol><apply id="S2.Ex3.m1.2.2.1.1.3.3.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.3.3.1.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S2.Ex3.m1.2.2.1.1.3.3.1.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.2"></sum><apply id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3"><eq id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.2">𝑝</ci><cn id="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S2.Ex3.m1.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex3.m1.2.2.1.1.3.3.1.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.1.3">𝑃</ci></apply><apply id="S2.Ex3.m1.2.2.1.1.3.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.3.3.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.2">subscript</csymbol><ci id="S2.Ex3.m1.2.2.1.1.3.3.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.2.2">𝐇</ci><ci id="S2.Ex3.m1.2.2.1.1.3.3.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.2.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.2c">\text{AvgPool}(\mathbf{H})=\frac{1}{P}\sum_{p=1}^{P}\mathbf{H}_{p},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.2d">AvgPool ( bold_H ) = divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT bold_H start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i5.p1.2">where <math alttext="\mathbf{H}_{p}" class="ltx_Math" display="inline" id="S2.I1.i5.p1.1.m1.1"><semantics id="S2.I1.i5.p1.1.m1.1a"><msub id="S2.I1.i5.p1.1.m1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.cmml"><mi id="S2.I1.i5.p1.1.m1.1.1.2" xref="S2.I1.i5.p1.1.m1.1.1.2.cmml">𝐇</mi><mi id="S2.I1.i5.p1.1.m1.1.1.3" xref="S2.I1.i5.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.m1.1b"><apply id="S2.I1.i5.p1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i5.p1.1.m1.1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i5.p1.1.m1.1.1.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.2">𝐇</ci><ci id="S2.I1.i5.p1.1.m1.1.1.3.cmml" xref="S2.I1.i5.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.m1.1c">\mathbf{H}_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.1.m1.1d">bold_H start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="p" class="ltx_Math" display="inline" id="S2.I1.i5.p1.2.m2.1"><semantics id="S2.I1.i5.p1.2.m2.1a"><mi id="S2.I1.i5.p1.2.m2.1.1" xref="S2.I1.i5.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.2.m2.1b"><ci id="S2.I1.i5.p1.2.m2.1.1.cmml" xref="S2.I1.i5.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.2.m2.1d">italic_p</annotation></semantics></math>-th token embedding.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i6.p1">
<p class="ltx_p" id="S2.I1.i6.p1.3"><em class="ltx_emph ltx_font_italic" id="S2.I1.i6.p1.3.1">Output Projection</em>: The final output is generated by projecting the pooled or decoded representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{h}_{i}," class="ltx_Math" display="block" id="S2.Ex4.m1.1"><semantics id="S2.Ex4.m1.1a"><mrow id="S2.Ex4.m1.1.1.1" xref="S2.Ex4.m1.1.1.1.1.cmml"><mrow id="S2.Ex4.m1.1.1.1.1" xref="S2.Ex4.m1.1.1.1.1.cmml"><msub id="S2.Ex4.m1.1.1.1.1.2" xref="S2.Ex4.m1.1.1.1.1.2.cmml"><mover accent="true" id="S2.Ex4.m1.1.1.1.1.2.2" xref="S2.Ex4.m1.1.1.1.1.2.2.cmml"><mi id="S2.Ex4.m1.1.1.1.1.2.2.2" xref="S2.Ex4.m1.1.1.1.1.2.2.2.cmml">𝐲</mi><mo id="S2.Ex4.m1.1.1.1.1.2.2.1" xref="S2.Ex4.m1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.Ex4.m1.1.1.1.1.2.3" xref="S2.Ex4.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.Ex4.m1.1.1.1.1.1" xref="S2.Ex4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.Ex4.m1.1.1.1.1.3" xref="S2.Ex4.m1.1.1.1.1.3.cmml"><msub id="S2.Ex4.m1.1.1.1.1.3.2" xref="S2.Ex4.m1.1.1.1.1.3.2.cmml"><mi id="S2.Ex4.m1.1.1.1.1.3.2.2" xref="S2.Ex4.m1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S2.Ex4.m1.1.1.1.1.3.2.3" xref="S2.Ex4.m1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S2.Ex4.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex4.m1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S2.Ex4.m1.1.1.1.1.3.3" xref="S2.Ex4.m1.1.1.1.1.3.3.cmml"><mi id="S2.Ex4.m1.1.1.1.1.3.3.2" xref="S2.Ex4.m1.1.1.1.1.3.3.2.cmml">𝐡</mi><mi id="S2.Ex4.m1.1.1.1.1.3.3.3" xref="S2.Ex4.m1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S2.Ex4.m1.1.1.1.2" xref="S2.Ex4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.1b"><apply id="S2.Ex4.m1.1.1.1.1.cmml" xref="S2.Ex4.m1.1.1.1"><eq id="S2.Ex4.m1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.1.1.1.1.1"></eq><apply id="S2.Ex4.m1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex4.m1.1.1.1.1.2.1.cmml" xref="S2.Ex4.m1.1.1.1.1.2">subscript</csymbol><apply id="S2.Ex4.m1.1.1.1.1.2.2.cmml" xref="S2.Ex4.m1.1.1.1.1.2.2"><ci id="S2.Ex4.m1.1.1.1.1.2.2.1.cmml" xref="S2.Ex4.m1.1.1.1.1.2.2.1">^</ci><ci id="S2.Ex4.m1.1.1.1.1.2.2.2.cmml" xref="S2.Ex4.m1.1.1.1.1.2.2.2">𝐲</ci></apply><ci id="S2.Ex4.m1.1.1.1.1.2.3.cmml" xref="S2.Ex4.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex4.m1.1.1.1.1.3.cmml" xref="S2.Ex4.m1.1.1.1.1.3"><ci id="S2.Ex4.m1.1.1.1.1.3.1.cmml" xref="S2.Ex4.m1.1.1.1.1.3.1">⋅</ci><apply id="S2.Ex4.m1.1.1.1.1.3.2.cmml" xref="S2.Ex4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex4.m1.1.1.1.1.3.2.1.cmml" xref="S2.Ex4.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex4.m1.1.1.1.1.3.2.2.cmml" xref="S2.Ex4.m1.1.1.1.1.3.2.2">𝐖</ci><ci id="S2.Ex4.m1.1.1.1.1.3.2.3.cmml" xref="S2.Ex4.m1.1.1.1.1.3.2.3">𝑜</ci></apply><apply id="S2.Ex4.m1.1.1.1.1.3.3.cmml" xref="S2.Ex4.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex4.m1.1.1.1.1.3.3.1.cmml" xref="S2.Ex4.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex4.m1.1.1.1.1.3.3.2.cmml" xref="S2.Ex4.m1.1.1.1.1.3.3.2">𝐡</ci><ci id="S2.Ex4.m1.1.1.1.1.3.3.3.cmml" xref="S2.Ex4.m1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.1c">\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{h}_{i},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i6.p1.2">where <math alttext="\mathbf{W}_{o}\in\mathbb{R}^{d_{\text{model}}\times H}" class="ltx_Math" display="inline" id="S2.I1.i6.p1.1.m1.1"><semantics id="S2.I1.i6.p1.1.m1.1a"><mrow id="S2.I1.i6.p1.1.m1.1.1" xref="S2.I1.i6.p1.1.m1.1.1.cmml"><msub id="S2.I1.i6.p1.1.m1.1.1.2" xref="S2.I1.i6.p1.1.m1.1.1.2.cmml"><mi id="S2.I1.i6.p1.1.m1.1.1.2.2" xref="S2.I1.i6.p1.1.m1.1.1.2.2.cmml">𝐖</mi><mi id="S2.I1.i6.p1.1.m1.1.1.2.3" xref="S2.I1.i6.p1.1.m1.1.1.2.3.cmml">o</mi></msub><mo id="S2.I1.i6.p1.1.m1.1.1.1" xref="S2.I1.i6.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.I1.i6.p1.1.m1.1.1.3" xref="S2.I1.i6.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i6.p1.1.m1.1.1.3.2" xref="S2.I1.i6.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.I1.i6.p1.1.m1.1.1.3.3" xref="S2.I1.i6.p1.1.m1.1.1.3.3.cmml"><msub id="S2.I1.i6.p1.1.m1.1.1.3.3.2" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.I1.i6.p1.1.m1.1.1.3.3.2.2" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.2.cmml">d</mi><mtext id="S2.I1.i6.p1.1.m1.1.1.3.3.2.3" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.3a.cmml">model</mtext></msub><mo id="S2.I1.i6.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.I1.i6.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.I1.i6.p1.1.m1.1.1.3.3.3" xref="S2.I1.i6.p1.1.m1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.1.m1.1b"><apply id="S2.I1.i6.p1.1.m1.1.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1"><in id="S2.I1.i6.p1.1.m1.1.1.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1.1"></in><apply id="S2.I1.i6.p1.1.m1.1.1.2.cmml" xref="S2.I1.i6.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i6.p1.1.m1.1.1.2.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I1.i6.p1.1.m1.1.1.2.2.cmml" xref="S2.I1.i6.p1.1.m1.1.1.2.2">𝐖</ci><ci id="S2.I1.i6.p1.1.m1.1.1.2.3.cmml" xref="S2.I1.i6.p1.1.m1.1.1.2.3">𝑜</ci></apply><apply id="S2.I1.i6.p1.1.m1.1.1.3.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i6.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.I1.i6.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.I1.i6.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3"><times id="S2.I1.i6.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.1"></times><apply id="S2.I1.i6.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.I1.i6.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.I1.i6.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S2.I1.i6.p1.1.m1.1.1.3.3.2.3a.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.3"><mtext id="S2.I1.i6.p1.1.m1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.I1.i6.p1.1.m1.1.1.3.3.2.3">model</mtext></ci></apply><ci id="S2.I1.i6.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I1.i6.p1.1.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.1.m1.1c">\mathbf{W}_{o}\in\mathbb{R}^{d_{\text{model}}\times H}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.1.m1.1d">bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S2.I1.i6.p1.2.m2.1"><semantics id="S2.I1.i6.p1.2.m2.1a"><msub id="S2.I1.i6.p1.2.m2.1.1" xref="S2.I1.i6.p1.2.m2.1.1.cmml"><mi id="S2.I1.i6.p1.2.m2.1.1.2" xref="S2.I1.i6.p1.2.m2.1.1.2.cmml">𝐡</mi><mi id="S2.I1.i6.p1.2.m2.1.1.3" xref="S2.I1.i6.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.2.m2.1b"><apply id="S2.I1.i6.p1.2.m2.1.1.cmml" xref="S2.I1.i6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i6.p1.2.m2.1.1.1.cmml" xref="S2.I1.i6.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i6.p1.2.m2.1.1.2.cmml" xref="S2.I1.i6.p1.2.m2.1.1.2">𝐡</ci><ci id="S2.I1.i6.p1.2.m2.1.1.3.cmml" xref="S2.I1.i6.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.2.m2.1c">\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.2.m2.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the pooled hidden state.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p3">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p3.4">In the <span class="ltx_text ltx_font_typewriter" id="S2.SS0.SSS0.Px3.p3.4.1">Autoformer</span> model, the time series is decomposed into trend and seasonal components. The trend component, <math alttext="\mathbf{x}^{\text{trend}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p3.1.m1.1"><semantics id="S2.SS0.SSS0.Px3.p3.1.m1.1a"><msup id="S2.SS0.SSS0.Px3.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.2" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.2.cmml">𝐱</mi><mtext id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3a.cmml">trend</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p3.1.m1.1b"><apply id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.2">𝐱</ci><ci id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3a.cmml" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3"><mtext id="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px3.p3.1.m1.1.1.3">trend</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p3.1.m1.1c">\mathbf{x}^{\text{trend}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p3.1.m1.1d">bold_x start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT</annotation></semantics></math>, is obtained by applying a moving average (MA) filter with a kernel size <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p3.2.m2.1"><semantics id="S2.SS0.SSS0.Px3.p3.2.m2.1a"><mi id="S2.SS0.SSS0.Px3.p3.2.m2.1.1" xref="S2.SS0.SSS0.Px3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p3.2.m2.1b"><ci id="S2.SS0.SSS0.Px3.p3.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p3.2.m2.1d">italic_k</annotation></semantics></math>. The kernel size <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p3.3.m3.1"><semantics id="S2.SS0.SSS0.Px3.p3.3.m3.1a"><mi id="S2.SS0.SSS0.Px3.p3.3.m3.1.1" xref="S2.SS0.SSS0.Px3.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p3.3.m3.1b"><ci id="S2.SS0.SSS0.Px3.p3.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p3.3.m3.1d">italic_k</annotation></semantics></math> defines the window over which the average is computed. This filter smooths the time series to capture long-term trends, while the residual seasonal component, <math alttext="\mathbf{x}^{\text{seasonal}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p3.4.m4.1"><semantics id="S2.SS0.SSS0.Px3.p3.4.m4.1a"><msup id="S2.SS0.SSS0.Px3.p3.4.m4.1.1" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.2" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.2.cmml">𝐱</mi><mtext id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3a.cmml">seasonal</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p3.4.m4.1b"><apply id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.2">𝐱</ci><ci id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3a.cmml" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3"><mtext id="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px3.p3.4.m4.1.1.3">seasonal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p3.4.m4.1c">\mathbf{x}^{\text{seasonal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p3.4.m4.1d">bold_x start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT</annotation></semantics></math>, captures short-term periodic fluctuations.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p4">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p4.3">In <span class="ltx_text ltx_font_typewriter" id="S2.SS0.SSS0.Px3.p4.3.1">Informer</span>, the attention mechanism is enhanced using a sparse attention approach to improve efficiency. The sparsity score <math alttext="M(q_{i})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p4.1.m1.1"><semantics id="S2.SS0.SSS0.Px3.p4.1.m1.1a"><mrow id="S2.SS0.SSS0.Px3.p4.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.3" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.3.cmml">M</mi><mo id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.2" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.2.cmml">q</mi><mi id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p4.1.m1.1b"><apply id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1"><times id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.2"></times><ci id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.3">𝑀</ci><apply id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.2">𝑞</ci><ci id="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p4.1.m1.1c">M(q_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p4.1.m1.1d">italic_M ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> for each query <math alttext="q_{i}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p4.2.m2.1"><semantics id="S2.SS0.SSS0.Px3.p4.2.m2.1a"><msub id="S2.SS0.SSS0.Px3.p4.2.m2.1.1" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.2" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1.2.cmml">q</mi><mi id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.3" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p4.2.m2.1b"><apply id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1.2">𝑞</ci><ci id="S2.SS0.SSS0.Px3.p4.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p4.2.m2.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p4.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is computed by first calculating the attention between each query and all keys, and then applying a softmax function to identify the most relevant keys for each query. The sparsity score <math alttext="M(q_{i})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p4.3.m3.1"><semantics id="S2.SS0.SSS0.Px3.p4.3.m3.1a"><mrow id="S2.SS0.SSS0.Px3.p4.3.m3.1.1" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.3" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.3.cmml">M</mi><mo id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.2" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.2.cmml">q</mi><mi id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p4.3.m3.1b"><apply id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1"><times id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.2"></times><ci id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.3">𝑀</ci><apply id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.2">𝑞</ci><ci id="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p4.3.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p4.3.m3.1c">M(q_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p4.3.m3.1d">italic_M ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the difference between the maximum attention value and the average attention value over all keys, ensuring that only the most important keys are selected for attention computation. This enables the model to focus on a smaller subset of keys, significantly reducing computational complexity while retaining high performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_typewriter" id="S3.1.1">PatchTST</span> Variants: Architecture and Computational Complexity</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S3.p1.1.1">PatchTST</span> framework addresses accurate forecasting of univariate time series by first segmenting the input sequence into overlapping or non-overlapping patches of fixed-length patches, then modeling temporal dependencies using a Transformer-based architecture. In this section, we present and justify three architectural variants—<span class="ltx_text ltx_font_italic" id="S3.p1.1.2">Minimal</span>, <span class="ltx_text ltx_font_italic" id="S3.p1.1.3">Standard</span>, and <span class="ltx_text ltx_font_italic" id="S3.p1.1.4">Full</span>—each representing a progressively more flexible and expressive model design.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span class="ltx_text ltx_font_typewriter" id="S3.SS1.1.1">PatchTST</span> Minimal: A Lightweight Transformer Backbone</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The Minimal variant serves as a baseline design, emphasizing simplicity and computational efficiency. Each input patch <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is linearly projected into a higher-dimensional latent space:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}\in\mathbb{R}^{1\times d_{%
\text{model}}}," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.4.cmml"><msub id="S3.E6.m1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.4.2.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.4.2.2.cmml">𝐱</mi><mi id="S3.E6.m1.1.1.1.1.4.2.3" xref="S3.E6.m1.1.1.1.1.4.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.1.1.4.1.cmml">⋅</mo><msub id="S3.E6.m1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.4.3.cmml"><mi id="S3.E6.m1.1.1.1.1.4.3.2" xref="S3.E6.m1.1.1.1.1.4.3.2.cmml">𝐖</mi><mi id="S3.E6.m1.1.1.1.1.4.3.3" xref="S3.E6.m1.1.1.1.1.4.3.3.cmml">e</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.E6.m1.1.1.1.1.6" xref="S3.E6.m1.1.1.1.1.6.cmml"><mi id="S3.E6.m1.1.1.1.1.6.2" xref="S3.E6.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E6.m1.1.1.1.1.6.3" xref="S3.E6.m1.1.1.1.1.6.3.cmml"><mn id="S3.E6.m1.1.1.1.1.6.3.2" xref="S3.E6.m1.1.1.1.1.6.3.2.cmml">1</mn><mo id="S3.E6.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.1.1.6.3.1.cmml">×</mo><msub id="S3.E6.m1.1.1.1.1.6.3.3" xref="S3.E6.m1.1.1.1.1.6.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.6.3.3.2" xref="S3.E6.m1.1.1.1.1.6.3.3.2.cmml">d</mi><mtext id="S3.E6.m1.1.1.1.1.6.3.3.3" xref="S3.E6.m1.1.1.1.1.6.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><and id="S3.E6.m1.1.1.1.1a.cmml" xref="S3.E6.m1.1.1.1"></and><apply id="S3.E6.m1.1.1.1.1b.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"></eq><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2">𝐳</ci><ci id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.4"><ci id="S3.E6.m1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.4.1">⋅</ci><apply id="S3.E6.m1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2">𝐱</ci><ci id="S3.E6.m1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.4.3.2">𝐖</ci><ci id="S3.E6.m1.1.1.1.1.4.3.3.cmml" xref="S3.E6.m1.1.1.1.1.4.3.3">𝑒</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1c.cmml" xref="S3.E6.m1.1.1.1"><in id="S3.E6.m1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E6.m1.1.1.1.1.4.cmml" id="S3.E6.m1.1.1.1.1d.cmml" xref="S3.E6.m1.1.1.1"></share><apply id="S3.E6.m1.1.1.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.6.1.cmml" xref="S3.E6.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.6.2.cmml" xref="S3.E6.m1.1.1.1.1.6.2">ℝ</ci><apply id="S3.E6.m1.1.1.1.1.6.3.cmml" xref="S3.E6.m1.1.1.1.1.6.3"><times id="S3.E6.m1.1.1.1.1.6.3.1.cmml" xref="S3.E6.m1.1.1.1.1.6.3.1"></times><cn id="S3.E6.m1.1.1.1.1.6.3.2.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.6.3.2">1</cn><apply id="S3.E6.m1.1.1.1.1.6.3.3.cmml" xref="S3.E6.m1.1.1.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.6.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.6.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.6.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.6.3.3.2">𝑑</ci><ci id="S3.E6.m1.1.1.1.1.6.3.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.6.3.3.3"><mtext id="S3.E6.m1.1.1.1.1.6.3.3.3.cmml" mathsize="50%" xref="S3.E6.m1.1.1.1.1.6.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}\in\mathbb{R}^{1\times d_{%
\text{model}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.2">Fixed sinusoidal positional encodings are added to incorporate temporal information:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE}," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E7.m1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.3.cmml">i</mi><mtext id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3a.cmml">pos</mtext></msubsup><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">𝐳</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">+</mo><mtext id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3a.cmml">PE</mtext></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2">𝐳</ci><ci id="S3.E7.m1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.1.1.2.3a.cmml" xref="S3.E7.m1.1.1.1.1.2.3"><mtext id="S3.E7.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.2.3">pos</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><plus id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝐳</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><mtext id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3">PE</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT = bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + PE ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.3">This encoded representation is passed through a Transformer encoder, followed by average pooling and a linear projection:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx2">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><msub id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">𝐡</mi><mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2">𝐡</ci><ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}})," class="ltx_Math" display="inline" id="S3.E8.m2.1"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.cmml"><mtext id="S3.E8.m2.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S3.E8.m2.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E8.m2.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S3.E8.m2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3a.cmml">pos</mtext></msubsup><mo id="S3.E8.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1"><times id="S3.E8.m2.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.2"></times><ci id="S3.E8.m2.1.1.1.1.1.3a.cmml" xref="S3.E8.m2.1.1.1.1.1.3"><mtext id="S3.E8.m2.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3"><mtext id="S3.E8.m2.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E8.m2.1.1.1.1.1.1.1.1.3">pos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.1d">= TransformerEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{y}}_{i}" class="ltx_Math" display="inline" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><msub id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mover accent="true" id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">𝐲</mi><mo id="S3.E9.m1.1.1.2.1" xref="S3.E9.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"><ci id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.2.1">^</ci><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">𝐲</ci></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\hat{\mathbf{y}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i})\in\mathbb{R}^{%
H}," class="ltx_Math" display="inline" id="S3.E9.m2.1"><semantics id="S3.E9.m2.1a"><mrow id="S3.E9.m2.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mrow id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E9.m2.1.1.1.1.4" xref="S3.E9.m2.1.1.1.1.4.cmml">=</mo><mrow id="S3.E9.m2.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.cmml"><mrow id="S3.E9.m2.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.3.cmml"><msub id="S3.E9.m2.1.1.1.1.1.3.2" xref="S3.E9.m2.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m2.1.1.1.1.1.3.2.2" xref="S3.E9.m2.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E9.m2.1.1.1.1.1.3.2.3" xref="S3.E9.m2.1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S3.E9.m2.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m2.1.1.1.1.1.3.1.cmml">⋅</mo><mtext id="S3.E9.m2.1.1.1.1.1.3.3" xref="S3.E9.m2.1.1.1.1.1.3.3a.cmml">AvgPool</mtext></mrow><mo id="S3.E9.m2.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m2.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m2.1.1.1.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S3.E9.m2.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.1.1.1.1.5" xref="S3.E9.m2.1.1.1.1.5.cmml">∈</mo><msup id="S3.E9.m2.1.1.1.1.6" xref="S3.E9.m2.1.1.1.1.6.cmml"><mi id="S3.E9.m2.1.1.1.1.6.2" xref="S3.E9.m2.1.1.1.1.6.2.cmml">ℝ</mi><mi id="S3.E9.m2.1.1.1.1.6.3" xref="S3.E9.m2.1.1.1.1.6.3.cmml">H</mi></msup></mrow><mo id="S3.E9.m2.1.1.1.2" xref="S3.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.1b"><apply id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1"><and id="S3.E9.m2.1.1.1.1a.cmml" xref="S3.E9.m2.1.1.1"></and><apply id="S3.E9.m2.1.1.1.1b.cmml" xref="S3.E9.m2.1.1.1"><eq id="S3.E9.m2.1.1.1.1.4.cmml" xref="S3.E9.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.E9.m2.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E9.m2.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1"><times id="S3.E9.m2.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.2"></times><apply id="S3.E9.m2.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.3"><ci id="S3.E9.m2.1.1.1.1.1.3.1.cmml" xref="S3.E9.m2.1.1.1.1.1.3.1">⋅</ci><apply id="S3.E9.m2.1.1.1.1.1.3.2.cmml" xref="S3.E9.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m2.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E9.m2.1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m2.1.1.1.1.1.3.2.3">𝑜</ci></apply><ci id="S3.E9.m2.1.1.1.1.1.3.3a.cmml" xref="S3.E9.m2.1.1.1.1.1.3.3"><mtext id="S3.E9.m2.1.1.1.1.1.3.3.cmml" xref="S3.E9.m2.1.1.1.1.1.3.3">AvgPool</mtext></ci></apply><apply id="S3.E9.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S3.E9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m2.1.1.1.1c.cmml" xref="S3.E9.m2.1.1.1"><in id="S3.E9.m2.1.1.1.1.5.cmml" xref="S3.E9.m2.1.1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E9.m2.1.1.1.1.1.cmml" id="S3.E9.m2.1.1.1.1d.cmml" xref="S3.E9.m2.1.1.1"></share><apply id="S3.E9.m2.1.1.1.1.6.cmml" xref="S3.E9.m2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.6.1.cmml" xref="S3.E9.m2.1.1.1.1.6">superscript</csymbol><ci id="S3.E9.m2.1.1.1.1.6.2.cmml" xref="S3.E9.m2.1.1.1.1.6.2">ℝ</ci><ci id="S3.E9.m2.1.1.1.1.6.3.cmml" xref="S3.E9.m2.1.1.1.1.6.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.1c">\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i})\in\mathbb{R}^{%
H},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m2.1d">= bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ AvgPool ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.4">This variant is lightweight and suitable for short sequences or fast, interpretable inference.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Minimal}}=\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Feedforward}}+\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{Self-Attention}}." class="ltx_Math" display="block" id="S3.Ex5.m1.1"><semantics id="S3.Ex5.m1.1a"><mrow id="S3.Ex5.m1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml"><mrow id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml"><msub id="S3.Ex5.m1.1.1.1.1.2" xref="S3.Ex5.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.1.1.1.1.2.2" xref="S3.Ex5.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S3.Ex5.m1.1.1.1.1.2.3" xref="S3.Ex5.m1.1.1.1.1.2.3a.cmml">Minimal</mtext></msub><mo id="S3.Ex5.m1.1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.Ex5.m1.1.1.1.1.3" xref="S3.Ex5.m1.1.1.1.1.3.cmml"><munder id="S3.Ex5.m1.1.1.1.1.3.2" xref="S3.Ex5.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S3.Ex5.m1.1.1.1.1.3.2.2" xref="S3.Ex5.m1.1.1.1.1.3.2.2.cmml"><mrow id="S3.Ex5.m1.1.1.1.1.3.2.2.2" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.2.2.2.2" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.2.cmml">P</mi><mo id="S3.Ex5.m1.1.1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.1.cmml">⋅</mo><msubsup id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.2" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.2.cmml">d</mi><mtext id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3a.cmml">model</mtext><mn id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S3.Ex5.m1.1.1.1.1.3.2.2.1" xref="S3.Ex5.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex5.m1.1.1.1.1.3.2.3" xref="S3.Ex5.m1.1.1.1.1.3.2.3a.cmml">Feedforward</mtext></munder><mo id="S3.Ex5.m1.1.1.1.1.3.1" xref="S3.Ex5.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S3.Ex5.m1.1.1.1.1.3.3" xref="S3.Ex5.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S3.Ex5.m1.1.1.1.1.3.3.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.cmml"><mrow id="S3.Ex5.m1.1.1.1.1.3.3.2.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.cmml"><msup id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.2.cmml">P</mi><mn id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.3" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.Ex5.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msub id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.2.cmml">d</mi><mtext id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S3.Ex5.m1.1.1.1.1.3.3.2.1" xref="S3.Ex5.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex5.m1.1.1.1.1.3.3.3" xref="S3.Ex5.m1.1.1.1.1.3.3.3a.cmml">Self-Attention</mtext></munder></mrow></mrow><mo id="S3.Ex5.m1.1.1.1.2" lspace="0em" xref="S3.Ex5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1"><eq id="S3.Ex5.m1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1.1"></eq><apply id="S3.Ex5.m1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex5.m1.1.1.1.1.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.2.2">𝒪</ci><ci id="S3.Ex5.m1.1.1.1.1.2.3a.cmml" xref="S3.Ex5.m1.1.1.1.1.2.3"><mtext id="S3.Ex5.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.Ex5.m1.1.1.1.1.2.3">Minimal</mtext></ci></apply><apply id="S3.Ex5.m1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3"><plus id="S3.Ex5.m1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.1"></plus><apply id="S3.Ex5.m1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.Ex5.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2"><ci id="S3.Ex5.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S3.Ex5.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2"><ci id="S3.Ex5.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.1">⋅</ci><ci id="S3.Ex5.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.2">𝑃</ci><apply id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3">superscript</csymbol><apply id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.2">𝑑</ci><ci id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3a.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3"><mtext id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3.cmml" mathsize="70%" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.2.3">model</mtext></ci></apply><cn id="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.3.cmml" type="integer" xref="S3.Ex5.m1.1.1.1.1.3.2.2.2.3.3">2</cn></apply></apply></apply><ci id="S3.Ex5.m1.1.1.1.1.3.2.3a.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2.3"><mtext id="S3.Ex5.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.Ex5.m1.1.1.1.1.3.2.3">Feedforward</mtext></ci></apply><apply id="S3.Ex5.m1.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.Ex5.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2"><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S3.Ex5.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2"><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.1">⋅</ci><apply id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2">superscript</csymbol><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.2">𝑃</ci><cn id="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.3.cmml" type="integer" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.2.3">2</cn></apply><apply id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.2">𝑑</ci><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3a.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3"><mtext id="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3.cmml" mathsize="70%" xref="S3.Ex5.m1.1.1.1.1.3.3.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S3.Ex5.m1.1.1.1.1.3.3.3a.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.3"><mtext id="S3.Ex5.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.Ex5.m1.1.1.1.1.3.3.3">Self-Attention</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\mathcal{O}_{\text{Minimal}}=\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Feedforward}}+\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{Self-Attention}}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.1d">caligraphic_O start_POSTSUBSCRIPT Minimal end_POSTSUBSCRIPT = under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Feedforward end_POSTSUBSCRIPT + under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Self-Attention end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span class="ltx_text ltx_font_typewriter" id="S3.SS2.1.1">PatchTST</span> Standard: Learning Data-Driven Positional Embeddings</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The Standard variant replaces the fixed positional encodings with a learnable global positional embedding <math alttext="\mathbf{p}\in\mathbb{R}^{1\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝐩</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mtext id="S3.SS2.p1.1.m1.1.1.3.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐩</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><cn id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3.3.2">1</cn><apply id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.3a.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3.3"><mtext id="S3.SS2.p1.1.m1.1.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS2.p1.1.m1.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{p}\in\mathbb{R}^{1\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_p ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}^{\text{pos}}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}+\mathbf{p}," class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E10.m1.1.1.1.1.2.2.3" xref="S3.E10.m1.1.1.1.1.2.2.3.cmml">i</mi><mtext id="S3.E10.m1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.2.3a.cmml">pos</mtext></msubsup><mo id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mrow id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml"><msub id="S3.E10.m1.1.1.1.1.3.2.2" xref="S3.E10.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2.2.2" xref="S3.E10.m1.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mi id="S3.E10.m1.1.1.1.1.3.2.2.3" xref="S3.E10.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E10.m1.1.1.1.1.3.2.1.cmml">⋅</mo><msub id="S3.E10.m1.1.1.1.1.3.2.3" xref="S3.E10.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2.3.2" xref="S3.E10.m1.1.1.1.1.3.2.3.2.cmml">𝐖</mi><mi id="S3.E10.m1.1.1.1.1.3.2.3.3" xref="S3.E10.m1.1.1.1.1.3.2.3.3.cmml">e</mi></msub></mrow><mo id="S3.E10.m1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml">𝐩</mi></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"></eq><apply id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2">𝐳</ci><ci id="S3.E10.m1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E10.m1.1.1.1.1.2.3a.cmml" xref="S3.E10.m1.1.1.1.1.2.3"><mtext id="S3.E10.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E10.m1.1.1.1.1.2.3">pos</mtext></ci></apply><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><plus id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.1"></plus><apply id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2"><ci id="S3.E10.m1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.1">⋅</ci><apply id="S3.E10.m1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2.2">𝐱</ci><ci id="S3.E10.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.2">𝐖</ci><ci id="S3.E10.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3">𝑒</ci></apply></apply><ci id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3">𝐩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\mathbf{z}_{i}^{\text{pos}}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}+\mathbf{p},</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT = bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT + bold_p ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.2">This embedding is shared across all positions and learned during training, allowing the model to adapt its temporal representation. The rest of the architecture remains identical to Minimal architecture:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\text{AvgPool}(\text{%
TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}}))." class="ltx_Math" display="block" id="S3.Ex6.m1.1"><semantics id="S3.Ex6.m1.1a"><mrow id="S3.Ex6.m1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.cmml"><mrow id="S3.Ex6.m1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.cmml"><msub id="S3.Ex6.m1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Ex6.m1.1.1.1.1.3.2" xref="S3.Ex6.m1.1.1.1.1.3.2.cmml"><mi id="S3.Ex6.m1.1.1.1.1.3.2.2" xref="S3.Ex6.m1.1.1.1.1.3.2.2.cmml">𝐲</mi><mo id="S3.Ex6.m1.1.1.1.1.3.2.1" xref="S3.Ex6.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.Ex6.m1.1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex6.m1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex6.m1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.3.cmml"><msub id="S3.Ex6.m1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.3.2.2" xref="S3.Ex6.m1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.Ex6.m1.1.1.1.1.1.3.2.3" xref="S3.Ex6.m1.1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S3.Ex6.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex6.m1.1.1.1.1.1.3.1.cmml">⋅</mo><mtext id="S3.Ex6.m1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.1.1.3.3a.cmml">AvgPool</mtext></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">pos</mtext></msubsup><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m1.1.1.1.2" lspace="0em" xref="S3.Ex6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.1b"><apply id="S3.Ex6.m1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1"><eq id="S3.Ex6.m1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.2"></eq><apply id="S3.Ex6.m1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex6.m1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.3.2"><ci id="S3.Ex6.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.Ex6.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.3.2.2">𝐲</ci></apply><ci id="S3.Ex6.m1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex6.m1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1"><times id="S3.Ex6.m1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.2"></times><apply id="S3.Ex6.m1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3"><ci id="S3.Ex6.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.1">⋅</ci><apply id="S3.Ex6.m1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.Ex6.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.2.3">𝑜</ci></apply><ci id="S3.Ex6.m1.1.1.1.1.1.3.3a.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.3"><mtext id="S3.Ex6.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.3.3">AvgPool</mtext></ci></apply><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1"><times id="S3.Ex6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3"><mtext id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.1.1.1.3">pos</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.1c">\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\text{AvgPool}(\text{%
TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}})).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ AvgPool ( TransformerEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Standard}}=\mathcal{O}_{\text{Minimal}}+\underbrace{%
\mathcal{O}(d_{\text{model}})}_{\text{Embedding overhead (negligible)}}." class="ltx_Math" display="block" id="S3.Ex7.m1.2"><semantics id="S3.Ex7.m1.2a"><mrow id="S3.Ex7.m1.2.2.1" xref="S3.Ex7.m1.2.2.1.1.cmml"><mrow id="S3.Ex7.m1.2.2.1.1" xref="S3.Ex7.m1.2.2.1.1.cmml"><msub id="S3.Ex7.m1.2.2.1.1.2" xref="S3.Ex7.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.2.2.1.1.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.cmml">𝒪</mi><mtext id="S3.Ex7.m1.2.2.1.1.2.3" xref="S3.Ex7.m1.2.2.1.1.2.3a.cmml">Standard</mtext></msub><mo id="S3.Ex7.m1.2.2.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.Ex7.m1.2.2.1.1.3" xref="S3.Ex7.m1.2.2.1.1.3.cmml"><msub id="S3.Ex7.m1.2.2.1.1.3.2" xref="S3.Ex7.m1.2.2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.2.2.1.1.3.2.2" xref="S3.Ex7.m1.2.2.1.1.3.2.2.cmml">𝒪</mi><mtext id="S3.Ex7.m1.2.2.1.1.3.2.3" xref="S3.Ex7.m1.2.2.1.1.3.2.3a.cmml">Minimal</mtext></msub><mo id="S3.Ex7.m1.2.2.1.1.3.1" xref="S3.Ex7.m1.2.2.1.1.3.1.cmml">+</mo><munder id="S3.Ex7.m1.2.2.1.1.3.3" xref="S3.Ex7.m1.2.2.1.1.3.3.cmml"><munder accentunder="true" id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml"><mrow id="S3.Ex7.m1.1.1.1" xref="S3.Ex7.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.3.cmml">𝒪</mi><mo id="S3.Ex7.m1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex7.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex7.m1.1.1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.1.1.1.2.cmml">d</mi><mtext id="S3.Ex7.m1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.1.1.1.3a.cmml">model</mtext></msub><mo id="S3.Ex7.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.1.1.2" xref="S3.Ex7.m1.1.1.2.cmml">⏟</mo></munder><mtext id="S3.Ex7.m1.2.2.1.1.3.3.2" xref="S3.Ex7.m1.2.2.1.1.3.3.2a.cmml">Embedding overhead (negligible)</mtext></munder></mrow></mrow><mo id="S3.Ex7.m1.2.2.1.2" lspace="0em" xref="S3.Ex7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.2b"><apply id="S3.Ex7.m1.2.2.1.1.cmml" xref="S3.Ex7.m1.2.2.1"><eq id="S3.Ex7.m1.2.2.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1"></eq><apply id="S3.Ex7.m1.2.2.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2">𝒪</ci><ci id="S3.Ex7.m1.2.2.1.1.2.3a.cmml" xref="S3.Ex7.m1.2.2.1.1.2.3"><mtext id="S3.Ex7.m1.2.2.1.1.2.3.cmml" mathsize="70%" xref="S3.Ex7.m1.2.2.1.1.2.3">Standard</mtext></ci></apply><apply id="S3.Ex7.m1.2.2.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.3"><plus id="S3.Ex7.m1.2.2.1.1.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.3.1"></plus><apply id="S3.Ex7.m1.2.2.1.1.3.2.cmml" xref="S3.Ex7.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.3.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.3.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.3.2.2">𝒪</ci><ci id="S3.Ex7.m1.2.2.1.1.3.2.3a.cmml" xref="S3.Ex7.m1.2.2.1.1.3.2.3"><mtext id="S3.Ex7.m1.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S3.Ex7.m1.2.2.1.1.3.2.3">Minimal</mtext></ci></apply><apply id="S3.Ex7.m1.2.2.1.1.3.3.cmml" xref="S3.Ex7.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.3.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.3.3">subscript</csymbol><apply id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1"><ci id="S3.Ex7.m1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.2">⏟</ci><apply id="S3.Ex7.m1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1"><times id="S3.Ex7.m1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.2"></times><ci id="S3.Ex7.m1.1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.1.3">𝒪</ci><apply id="S3.Ex7.m1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex7.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.2">𝑑</ci><ci id="S3.Ex7.m1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.3"><mtext id="S3.Ex7.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.Ex7.m1.1.1.1.1.1.1.3">model</mtext></ci></apply></apply></apply><ci id="S3.Ex7.m1.2.2.1.1.3.3.2a.cmml" xref="S3.Ex7.m1.2.2.1.1.3.3.2"><mtext id="S3.Ex7.m1.2.2.1.1.3.3.2.cmml" mathsize="70%" xref="S3.Ex7.m1.2.2.1.1.3.3.2">Embedding overhead (negligible)</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.2c">\mathcal{O}_{\text{Standard}}=\mathcal{O}_{\text{Minimal}}+\underbrace{%
\mathcal{O}(d_{\text{model}})}_{\text{Embedding overhead (negligible)}}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.2d">caligraphic_O start_POSTSUBSCRIPT Standard end_POSTSUBSCRIPT = caligraphic_O start_POSTSUBSCRIPT Minimal end_POSTSUBSCRIPT + under⏟ start_ARG caligraphic_O ( italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT Embedding overhead (negligible) end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="ltx_text ltx_font_typewriter" id="S3.SS3.1.1">PatchTST</span> Full: A Flexible Encoder-Decoder Architecture</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The Full variant introduces a decoder with cross-attention, allowing the model to explicitly learn dependencies between past inputs and future predictions.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Encoder</h5>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.1">The input patch is embedded and encoded with sinusoidal positional encodings:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx3">
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Z}_{i}^{(e)}" class="ltx_Math" display="inline" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><msubsup id="S3.E11.m1.1.2" xref="S3.E11.m1.1.2.cmml"><mi id="S3.E11.m1.1.2.2.2" xref="S3.E11.m1.1.2.2.2.cmml">𝐙</mi><mi id="S3.E11.m1.1.2.2.3" xref="S3.E11.m1.1.2.2.3.cmml">i</mi><mrow id="S3.E11.m1.1.1.1.3" xref="S3.E11.m1.1.2.cmml"><mo id="S3.E11.m1.1.1.1.3.1" stretchy="false" xref="S3.E11.m1.1.2.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">e</mi><mo id="S3.E11.m1.1.1.1.3.2" stretchy="false" xref="S3.E11.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.2.cmml" xref="S3.E11.m1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.2.1.cmml" xref="S3.E11.m1.1.2">superscript</csymbol><apply id="S3.E11.m1.1.2.2.cmml" xref="S3.E11.m1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.2.2.1.cmml" xref="S3.E11.m1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.2.2.2.cmml" xref="S3.E11.m1.1.2.2.2">𝐙</ci><ci id="S3.E11.m1.1.2.2.3.cmml" xref="S3.E11.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\displaystyle\mathbf{Z}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">bold_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{P\times d_{\text{model}}}," class="ltx_Math" display="inline" id="S3.E11.m2.3"><semantics id="S3.E11.m2.3a"><mrow id="S3.E11.m2.3.3.1" xref="S3.E11.m2.3.3.1.1.cmml"><mrow id="S3.E11.m2.3.3.1.1" xref="S3.E11.m2.3.3.1.1.cmml"><mi id="S3.E11.m2.3.3.1.1.2" xref="S3.E11.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E11.m2.3.3.1.1.3" xref="S3.E11.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E11.m2.3.3.1.1.4" xref="S3.E11.m2.3.3.1.1.4.cmml"><mrow id="S3.E11.m2.3.3.1.1.4.2" xref="S3.E11.m2.3.3.1.1.4.2.cmml"><msub id="S3.E11.m2.3.3.1.1.4.2.2" xref="S3.E11.m2.3.3.1.1.4.2.2.cmml"><mi id="S3.E11.m2.3.3.1.1.4.2.2.2" xref="S3.E11.m2.3.3.1.1.4.2.2.2.cmml">𝐱</mi><mi id="S3.E11.m2.3.3.1.1.4.2.2.3" xref="S3.E11.m2.3.3.1.1.4.2.2.3.cmml">i</mi></msub><mo id="S3.E11.m2.3.3.1.1.4.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E11.m2.3.3.1.1.4.2.1.cmml">⋅</mo><msubsup id="S3.E11.m2.3.3.1.1.4.2.3" xref="S3.E11.m2.3.3.1.1.4.2.3.cmml"><mi id="S3.E11.m2.3.3.1.1.4.2.3.2.2" xref="S3.E11.m2.3.3.1.1.4.2.3.2.2.cmml">𝐖</mi><mi id="S3.E11.m2.3.3.1.1.4.2.3.2.3" xref="S3.E11.m2.3.3.1.1.4.2.3.2.3.cmml">e</mi><mrow id="S3.E11.m2.1.1.1.3" xref="S3.E11.m2.3.3.1.1.4.2.3.cmml"><mo id="S3.E11.m2.1.1.1.3.1" stretchy="false" xref="S3.E11.m2.3.3.1.1.4.2.3.cmml">(</mo><mi id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml">e</mi><mo id="S3.E11.m2.1.1.1.3.2" stretchy="false" xref="S3.E11.m2.3.3.1.1.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E11.m2.3.3.1.1.4.1" xref="S3.E11.m2.3.3.1.1.4.1.cmml">+</mo><msup id="S3.E11.m2.3.3.1.1.4.3" xref="S3.E11.m2.3.3.1.1.4.3.cmml"><mtext id="S3.E11.m2.3.3.1.1.4.3.2" xref="S3.E11.m2.3.3.1.1.4.3.2a.cmml">PE</mtext><mrow id="S3.E11.m2.2.2.1.3" xref="S3.E11.m2.3.3.1.1.4.3.cmml"><mo id="S3.E11.m2.2.2.1.3.1" stretchy="false" xref="S3.E11.m2.3.3.1.1.4.3.cmml">(</mo><mi id="S3.E11.m2.2.2.1.1" xref="S3.E11.m2.2.2.1.1.cmml">e</mi><mo id="S3.E11.m2.2.2.1.3.2" stretchy="false" xref="S3.E11.m2.3.3.1.1.4.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E11.m2.3.3.1.1.5" xref="S3.E11.m2.3.3.1.1.5.cmml">∈</mo><msup id="S3.E11.m2.3.3.1.1.6" xref="S3.E11.m2.3.3.1.1.6.cmml"><mi id="S3.E11.m2.3.3.1.1.6.2" xref="S3.E11.m2.3.3.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E11.m2.3.3.1.1.6.3" xref="S3.E11.m2.3.3.1.1.6.3.cmml"><mi id="S3.E11.m2.3.3.1.1.6.3.2" xref="S3.E11.m2.3.3.1.1.6.3.2.cmml">P</mi><mo id="S3.E11.m2.3.3.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E11.m2.3.3.1.1.6.3.1.cmml">×</mo><msub id="S3.E11.m2.3.3.1.1.6.3.3" xref="S3.E11.m2.3.3.1.1.6.3.3.cmml"><mi id="S3.E11.m2.3.3.1.1.6.3.3.2" xref="S3.E11.m2.3.3.1.1.6.3.3.2.cmml">d</mi><mtext id="S3.E11.m2.3.3.1.1.6.3.3.3" xref="S3.E11.m2.3.3.1.1.6.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><mo id="S3.E11.m2.3.3.1.2" xref="S3.E11.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.3b"><apply id="S3.E11.m2.3.3.1.1.cmml" xref="S3.E11.m2.3.3.1"><and id="S3.E11.m2.3.3.1.1a.cmml" xref="S3.E11.m2.3.3.1"></and><apply id="S3.E11.m2.3.3.1.1b.cmml" xref="S3.E11.m2.3.3.1"><eq id="S3.E11.m2.3.3.1.1.3.cmml" xref="S3.E11.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E11.m2.3.3.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E11.m2.3.3.1.1.4.cmml" xref="S3.E11.m2.3.3.1.1.4"><plus id="S3.E11.m2.3.3.1.1.4.1.cmml" xref="S3.E11.m2.3.3.1.1.4.1"></plus><apply id="S3.E11.m2.3.3.1.1.4.2.cmml" xref="S3.E11.m2.3.3.1.1.4.2"><ci id="S3.E11.m2.3.3.1.1.4.2.1.cmml" xref="S3.E11.m2.3.3.1.1.4.2.1">⋅</ci><apply id="S3.E11.m2.3.3.1.1.4.2.2.cmml" xref="S3.E11.m2.3.3.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.4.2.2.1.cmml" xref="S3.E11.m2.3.3.1.1.4.2.2">subscript</csymbol><ci id="S3.E11.m2.3.3.1.1.4.2.2.2.cmml" xref="S3.E11.m2.3.3.1.1.4.2.2.2">𝐱</ci><ci id="S3.E11.m2.3.3.1.1.4.2.2.3.cmml" xref="S3.E11.m2.3.3.1.1.4.2.2.3">𝑖</ci></apply><apply id="S3.E11.m2.3.3.1.1.4.2.3.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.4.2.3.1.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3">superscript</csymbol><apply id="S3.E11.m2.3.3.1.1.4.2.3.2.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.4.2.3.2.1.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3">subscript</csymbol><ci id="S3.E11.m2.3.3.1.1.4.2.3.2.2.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3.2.2">𝐖</ci><ci id="S3.E11.m2.3.3.1.1.4.2.3.2.3.cmml" xref="S3.E11.m2.3.3.1.1.4.2.3.2.3">𝑒</ci></apply><ci id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1">𝑒</ci></apply></apply><apply id="S3.E11.m2.3.3.1.1.4.3.cmml" xref="S3.E11.m2.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.4.3.1.cmml" xref="S3.E11.m2.3.3.1.1.4.3">superscript</csymbol><ci id="S3.E11.m2.3.3.1.1.4.3.2a.cmml" xref="S3.E11.m2.3.3.1.1.4.3.2"><mtext id="S3.E11.m2.3.3.1.1.4.3.2.cmml" xref="S3.E11.m2.3.3.1.1.4.3.2">PE</mtext></ci><ci id="S3.E11.m2.2.2.1.1.cmml" xref="S3.E11.m2.2.2.1.1">𝑒</ci></apply></apply></apply><apply id="S3.E11.m2.3.3.1.1c.cmml" xref="S3.E11.m2.3.3.1"><in id="S3.E11.m2.3.3.1.1.5.cmml" xref="S3.E11.m2.3.3.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E11.m2.3.3.1.1.4.cmml" id="S3.E11.m2.3.3.1.1d.cmml" xref="S3.E11.m2.3.3.1"></share><apply id="S3.E11.m2.3.3.1.1.6.cmml" xref="S3.E11.m2.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.6.1.cmml" xref="S3.E11.m2.3.3.1.1.6">superscript</csymbol><ci id="S3.E11.m2.3.3.1.1.6.2.cmml" xref="S3.E11.m2.3.3.1.1.6.2">ℝ</ci><apply id="S3.E11.m2.3.3.1.1.6.3.cmml" xref="S3.E11.m2.3.3.1.1.6.3"><times id="S3.E11.m2.3.3.1.1.6.3.1.cmml" xref="S3.E11.m2.3.3.1.1.6.3.1"></times><ci id="S3.E11.m2.3.3.1.1.6.3.2.cmml" xref="S3.E11.m2.3.3.1.1.6.3.2">𝑃</ci><apply id="S3.E11.m2.3.3.1.1.6.3.3.cmml" xref="S3.E11.m2.3.3.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.6.3.3.1.cmml" xref="S3.E11.m2.3.3.1.1.6.3.3">subscript</csymbol><ci id="S3.E11.m2.3.3.1.1.6.3.3.2.cmml" xref="S3.E11.m2.3.3.1.1.6.3.3.2">𝑑</ci><ci id="S3.E11.m2.3.3.1.1.6.3.3.3a.cmml" xref="S3.E11.m2.3.3.1.1.6.3.3.3"><mtext id="S3.E11.m2.3.3.1.1.6.3.3.3.cmml" mathsize="50%" xref="S3.E11.m2.3.3.1.1.6.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.3c">\displaystyle=\mathbf{x}_{i}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{P\times d_{\text{model}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m2.3d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(e)}" class="ltx_Math" display="inline" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><msubsup id="S3.E12.m1.1.2" xref="S3.E12.m1.1.2.cmml"><mi id="S3.E12.m1.1.2.2.2" xref="S3.E12.m1.1.2.2.2.cmml">𝐇</mi><mi id="S3.E12.m1.1.2.2.3" xref="S3.E12.m1.1.2.2.3.cmml">i</mi><mrow id="S3.E12.m1.1.1.1.3" xref="S3.E12.m1.1.2.cmml"><mo id="S3.E12.m1.1.1.1.3.1" stretchy="false" xref="S3.E12.m1.1.2.cmml">(</mo><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">e</mi><mo id="S3.E12.m1.1.1.1.3.2" stretchy="false" xref="S3.E12.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.2.cmml" xref="S3.E12.m1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.2.1.cmml" xref="S3.E12.m1.1.2">superscript</csymbol><apply id="S3.E12.m1.1.2.2.cmml" xref="S3.E12.m1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.2.2.1.cmml" xref="S3.E12.m1.1.2">subscript</csymbol><ci id="S3.E12.m1.1.2.2.2.cmml" xref="S3.E12.m1.1.2.2.2">𝐇</ci><ci id="S3.E12.m1.1.2.2.3.cmml" xref="S3.E12.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\mathbf{H}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerEncoder}(\mathbf{Z}_{i}^{(e)})." class="ltx_Math" display="inline" id="S3.E12.m2.2"><semantics id="S3.E12.m2.2a"><mrow id="S3.E12.m2.2.2.1" xref="S3.E12.m2.2.2.1.1.cmml"><mrow id="S3.E12.m2.2.2.1.1" xref="S3.E12.m2.2.2.1.1.cmml"><mi id="S3.E12.m2.2.2.1.1.3" xref="S3.E12.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E12.m2.2.2.1.1.2" xref="S3.E12.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E12.m2.2.2.1.1.1" xref="S3.E12.m2.2.2.1.1.1.cmml"><mtext id="S3.E12.m2.2.2.1.1.1.3" xref="S3.E12.m2.2.2.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S3.E12.m2.2.2.1.1.1.2" xref="S3.E12.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m2.2.2.1.1.1.1.1" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E12.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m2.2.2.1.1.1.1.1.1" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.m2.2.2.1.1.1.1.1.1.2.2" xref="S3.E12.m2.2.2.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mi id="S3.E12.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.E12.m2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E12.m2.1.1.1.3" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E12.m2.1.1.1.3.1" stretchy="false" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E12.m2.1.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml">e</mi><mo id="S3.E12.m2.1.1.1.3.2" stretchy="false" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E12.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m2.2.2.1.2" lspace="0em" xref="S3.E12.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m2.2b"><apply id="S3.E12.m2.2.2.1.1.cmml" xref="S3.E12.m2.2.2.1"><eq id="S3.E12.m2.2.2.1.1.2.cmml" xref="S3.E12.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E12.m2.2.2.1.1.3.cmml" xref="S3.E12.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E12.m2.2.2.1.1.1.cmml" xref="S3.E12.m2.2.2.1.1.1"><times id="S3.E12.m2.2.2.1.1.1.2.cmml" xref="S3.E12.m2.2.2.1.1.1.2"></times><ci id="S3.E12.m2.2.2.1.1.1.3a.cmml" xref="S3.E12.m2.2.2.1.1.1.3"><mtext id="S3.E12.m2.2.2.1.1.1.3.cmml" xref="S3.E12.m2.2.2.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S3.E12.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1.1.2.2">𝐙</ci><ci id="S3.E12.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E12.m2.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.2c">\displaystyle=\text{TransformerEncoder}(\mathbf{Z}_{i}^{(e)}).</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m2.2d">= TransformerEncoder ( bold_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Decoder</h5>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.1">The decoder input is formed by repeating the last element of the patch to enable autoregressive-style conditioning:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx4">
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{i}^{\text{rep}}" class="ltx_Math" display="inline" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><msubsup id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2.2" xref="S3.E13.m1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E13.m1.1.1.2.3" xref="S3.E13.m1.1.1.2.3.cmml">i</mi><mtext id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3a.cmml">rep</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1">superscript</csymbol><apply id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.2.1.cmml" xref="S3.E13.m1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.2.2">𝐱</ci><ci id="S3.E13.m1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.E13.m1.1.1.3a.cmml" xref="S3.E13.m1.1.1.3"><mtext id="S3.E13.m1.1.1.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.3">rep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle\mathbf{x}_{i}^{\text{rep}}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[x_{i+P-1},\dots,x_{i+P-1}]\in\mathbb{R}^{H}," class="ltx_Math" display="inline" id="S3.E13.m2.2"><semantics id="S3.E13.m2.2a"><mrow id="S3.E13.m2.2.2.1" xref="S3.E13.m2.2.2.1.1.cmml"><mrow id="S3.E13.m2.2.2.1.1" xref="S3.E13.m2.2.2.1.1.cmml"><mi id="S3.E13.m2.2.2.1.1.4" xref="S3.E13.m2.2.2.1.1.4.cmml"></mi><mo id="S3.E13.m2.2.2.1.1.5" xref="S3.E13.m2.2.2.1.1.5.cmml">=</mo><mrow id="S3.E13.m2.2.2.1.1.2.2" xref="S3.E13.m2.2.2.1.1.2.3.cmml"><mo id="S3.E13.m2.2.2.1.1.2.2.3" stretchy="false" xref="S3.E13.m2.2.2.1.1.2.3.cmml">[</mo><msub id="S3.E13.m2.2.2.1.1.1.1.1" xref="S3.E13.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.E13.m2.2.2.1.1.1.1.1.2" xref="S3.E13.m2.2.2.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E13.m2.2.2.1.1.1.1.1.3" xref="S3.E13.m2.2.2.1.1.1.1.1.3.cmml"><mrow id="S3.E13.m2.2.2.1.1.1.1.1.3.2" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.cmml"><mi id="S3.E13.m2.2.2.1.1.1.1.1.3.2.2" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.2.cmml">i</mi><mo id="S3.E13.m2.2.2.1.1.1.1.1.3.2.1" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.1.cmml">+</mo><mi id="S3.E13.m2.2.2.1.1.1.1.1.3.2.3" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.3.cmml">P</mi></mrow><mo id="S3.E13.m2.2.2.1.1.1.1.1.3.1" xref="S3.E13.m2.2.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E13.m2.2.2.1.1.1.1.1.3.3" xref="S3.E13.m2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E13.m2.2.2.1.1.2.2.4" xref="S3.E13.m2.2.2.1.1.2.3.cmml">,</mo><mi id="S3.E13.m2.1.1" mathvariant="normal" xref="S3.E13.m2.1.1.cmml">…</mi><mo id="S3.E13.m2.2.2.1.1.2.2.5" xref="S3.E13.m2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E13.m2.2.2.1.1.2.2.2" xref="S3.E13.m2.2.2.1.1.2.2.2.cmml"><mi id="S3.E13.m2.2.2.1.1.2.2.2.2" xref="S3.E13.m2.2.2.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.E13.m2.2.2.1.1.2.2.2.3" xref="S3.E13.m2.2.2.1.1.2.2.2.3.cmml"><mrow id="S3.E13.m2.2.2.1.1.2.2.2.3.2" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.cmml"><mi id="S3.E13.m2.2.2.1.1.2.2.2.3.2.2" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.2.cmml">i</mi><mo id="S3.E13.m2.2.2.1.1.2.2.2.3.2.1" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.1.cmml">+</mo><mi id="S3.E13.m2.2.2.1.1.2.2.2.3.2.3" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.3.cmml">P</mi></mrow><mo id="S3.E13.m2.2.2.1.1.2.2.2.3.1" xref="S3.E13.m2.2.2.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.E13.m2.2.2.1.1.2.2.2.3.3" xref="S3.E13.m2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E13.m2.2.2.1.1.2.2.6" stretchy="false" xref="S3.E13.m2.2.2.1.1.2.3.cmml">]</mo></mrow><mo id="S3.E13.m2.2.2.1.1.6" xref="S3.E13.m2.2.2.1.1.6.cmml">∈</mo><msup id="S3.E13.m2.2.2.1.1.7" xref="S3.E13.m2.2.2.1.1.7.cmml"><mi id="S3.E13.m2.2.2.1.1.7.2" xref="S3.E13.m2.2.2.1.1.7.2.cmml">ℝ</mi><mi id="S3.E13.m2.2.2.1.1.7.3" xref="S3.E13.m2.2.2.1.1.7.3.cmml">H</mi></msup></mrow><mo id="S3.E13.m2.2.2.1.2" xref="S3.E13.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m2.2b"><apply id="S3.E13.m2.2.2.1.1.cmml" xref="S3.E13.m2.2.2.1"><and id="S3.E13.m2.2.2.1.1a.cmml" xref="S3.E13.m2.2.2.1"></and><apply id="S3.E13.m2.2.2.1.1b.cmml" xref="S3.E13.m2.2.2.1"><eq id="S3.E13.m2.2.2.1.1.5.cmml" xref="S3.E13.m2.2.2.1.1.5"></eq><csymbol cd="latexml" id="S3.E13.m2.2.2.1.1.4.cmml" xref="S3.E13.m2.2.2.1.1.4">absent</csymbol><list id="S3.E13.m2.2.2.1.1.2.3.cmml" xref="S3.E13.m2.2.2.1.1.2.2"><apply id="S3.E13.m2.2.2.1.1.1.1.1.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.2">𝑥</ci><apply id="S3.E13.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3"><minus id="S3.E13.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3.1"></minus><apply id="S3.E13.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2"><plus id="S3.E13.m2.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.1"></plus><ci id="S3.E13.m2.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.2">𝑖</ci><ci id="S3.E13.m2.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m2.2.2.1.1.1.1.1.3.2.3">𝑃</ci></apply><cn id="S3.E13.m2.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E13.m2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E13.m2.1.1.cmml" xref="S3.E13.m2.1.1">…</ci><apply id="S3.E13.m2.2.2.1.1.2.2.2.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.1.1.2.2.2.1.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E13.m2.2.2.1.1.2.2.2.2.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.2">𝑥</ci><apply id="S3.E13.m2.2.2.1.1.2.2.2.3.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3"><minus id="S3.E13.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3.1"></minus><apply id="S3.E13.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2"><plus id="S3.E13.m2.2.2.1.1.2.2.2.3.2.1.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.1"></plus><ci id="S3.E13.m2.2.2.1.1.2.2.2.3.2.2.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.2">𝑖</ci><ci id="S3.E13.m2.2.2.1.1.2.2.2.3.2.3.cmml" xref="S3.E13.m2.2.2.1.1.2.2.2.3.2.3">𝑃</ci></apply><cn id="S3.E13.m2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E13.m2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.E13.m2.2.2.1.1c.cmml" xref="S3.E13.m2.2.2.1"><in id="S3.E13.m2.2.2.1.1.6.cmml" xref="S3.E13.m2.2.2.1.1.6"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E13.m2.2.2.1.1.2.cmml" id="S3.E13.m2.2.2.1.1d.cmml" xref="S3.E13.m2.2.2.1"></share><apply id="S3.E13.m2.2.2.1.1.7.cmml" xref="S3.E13.m2.2.2.1.1.7"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.1.1.7.1.cmml" xref="S3.E13.m2.2.2.1.1.7">superscript</csymbol><ci id="S3.E13.m2.2.2.1.1.7.2.cmml" xref="S3.E13.m2.2.2.1.1.7.2">ℝ</ci><ci id="S3.E13.m2.2.2.1.1.7.3.cmml" xref="S3.E13.m2.2.2.1.1.7.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.2c">\displaystyle=[x_{i+P-1},\dots,x_{i+P-1}]\in\mathbb{R}^{H},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m2.2d">= [ italic_x start_POSTSUBSCRIPT italic_i + italic_P - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i + italic_P - 1 end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Z}_{i}^{(d)}" class="ltx_Math" display="inline" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><msubsup id="S3.E14.m1.1.2" xref="S3.E14.m1.1.2.cmml"><mi id="S3.E14.m1.1.2.2.2" xref="S3.E14.m1.1.2.2.2.cmml">𝐙</mi><mi id="S3.E14.m1.1.2.2.3" xref="S3.E14.m1.1.2.2.3.cmml">i</mi><mrow id="S3.E14.m1.1.1.1.3" xref="S3.E14.m1.1.2.cmml"><mo id="S3.E14.m1.1.1.1.3.1" stretchy="false" xref="S3.E14.m1.1.2.cmml">(</mo><mi id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml">d</mi><mo id="S3.E14.m1.1.1.1.3.2" stretchy="false" xref="S3.E14.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.2.cmml" xref="S3.E14.m1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.2.1.cmml" xref="S3.E14.m1.1.2">superscript</csymbol><apply id="S3.E14.m1.1.2.2.cmml" xref="S3.E14.m1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.2.2.1.cmml" xref="S3.E14.m1.1.2">subscript</csymbol><ci id="S3.E14.m1.1.2.2.2.cmml" xref="S3.E14.m1.1.2.2.2">𝐙</ci><ci id="S3.E14.m1.1.2.2.3.cmml" xref="S3.E14.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle\mathbf{Z}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">bold_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text{PE}^{%
(d)}\in\mathbb{R}^{H\times d_{\text{model}}}," class="ltx_Math" display="inline" id="S3.E14.m2.3"><semantics id="S3.E14.m2.3a"><mrow id="S3.E14.m2.3.3.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.4" xref="S3.E14.m2.3.3.1.1.4.cmml"><mrow id="S3.E14.m2.3.3.1.1.4.2" xref="S3.E14.m2.3.3.1.1.4.2.cmml"><msubsup id="S3.E14.m2.3.3.1.1.4.2.2" xref="S3.E14.m2.3.3.1.1.4.2.2.cmml"><mi id="S3.E14.m2.3.3.1.1.4.2.2.2.2" xref="S3.E14.m2.3.3.1.1.4.2.2.2.2.cmml">𝐱</mi><mi id="S3.E14.m2.3.3.1.1.4.2.2.2.3" xref="S3.E14.m2.3.3.1.1.4.2.2.2.3.cmml">i</mi><mtext id="S3.E14.m2.3.3.1.1.4.2.2.3" xref="S3.E14.m2.3.3.1.1.4.2.2.3a.cmml">rep</mtext></msubsup><mo id="S3.E14.m2.3.3.1.1.4.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m2.3.3.1.1.4.2.1.cmml">⋅</mo><msubsup id="S3.E14.m2.3.3.1.1.4.2.3" xref="S3.E14.m2.3.3.1.1.4.2.3.cmml"><mi id="S3.E14.m2.3.3.1.1.4.2.3.2.2" xref="S3.E14.m2.3.3.1.1.4.2.3.2.2.cmml">𝐖</mi><mi id="S3.E14.m2.3.3.1.1.4.2.3.2.3" xref="S3.E14.m2.3.3.1.1.4.2.3.2.3.cmml">e</mi><mrow id="S3.E14.m2.1.1.1.3" xref="S3.E14.m2.3.3.1.1.4.2.3.cmml"><mo id="S3.E14.m2.1.1.1.3.1" stretchy="false" xref="S3.E14.m2.3.3.1.1.4.2.3.cmml">(</mo><mi id="S3.E14.m2.1.1.1.1" xref="S3.E14.m2.1.1.1.1.cmml">d</mi><mo id="S3.E14.m2.1.1.1.3.2" stretchy="false" xref="S3.E14.m2.3.3.1.1.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E14.m2.3.3.1.1.4.1" xref="S3.E14.m2.3.3.1.1.4.1.cmml">+</mo><msup id="S3.E14.m2.3.3.1.1.4.3" xref="S3.E14.m2.3.3.1.1.4.3.cmml"><mtext id="S3.E14.m2.3.3.1.1.4.3.2" xref="S3.E14.m2.3.3.1.1.4.3.2a.cmml">PE</mtext><mrow id="S3.E14.m2.2.2.1.3" xref="S3.E14.m2.3.3.1.1.4.3.cmml"><mo id="S3.E14.m2.2.2.1.3.1" stretchy="false" xref="S3.E14.m2.3.3.1.1.4.3.cmml">(</mo><mi id="S3.E14.m2.2.2.1.1" xref="S3.E14.m2.2.2.1.1.cmml">d</mi><mo id="S3.E14.m2.2.2.1.3.2" stretchy="false" xref="S3.E14.m2.3.3.1.1.4.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E14.m2.3.3.1.1.5" xref="S3.E14.m2.3.3.1.1.5.cmml">∈</mo><msup id="S3.E14.m2.3.3.1.1.6" xref="S3.E14.m2.3.3.1.1.6.cmml"><mi id="S3.E14.m2.3.3.1.1.6.2" xref="S3.E14.m2.3.3.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E14.m2.3.3.1.1.6.3" xref="S3.E14.m2.3.3.1.1.6.3.cmml"><mi id="S3.E14.m2.3.3.1.1.6.3.2" xref="S3.E14.m2.3.3.1.1.6.3.2.cmml">H</mi><mo id="S3.E14.m2.3.3.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m2.3.3.1.1.6.3.1.cmml">×</mo><msub id="S3.E14.m2.3.3.1.1.6.3.3" xref="S3.E14.m2.3.3.1.1.6.3.3.cmml"><mi id="S3.E14.m2.3.3.1.1.6.3.3.2" xref="S3.E14.m2.3.3.1.1.6.3.3.2.cmml">d</mi><mtext id="S3.E14.m2.3.3.1.1.6.3.3.3" xref="S3.E14.m2.3.3.1.1.6.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><mo id="S3.E14.m2.3.3.1.2" xref="S3.E14.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.3b"><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1"><and id="S3.E14.m2.3.3.1.1a.cmml" xref="S3.E14.m2.3.3.1"></and><apply id="S3.E14.m2.3.3.1.1b.cmml" xref="S3.E14.m2.3.3.1"><eq id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E14.m2.3.3.1.1.4.cmml" xref="S3.E14.m2.3.3.1.1.4"><plus id="S3.E14.m2.3.3.1.1.4.1.cmml" xref="S3.E14.m2.3.3.1.1.4.1"></plus><apply id="S3.E14.m2.3.3.1.1.4.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2"><ci id="S3.E14.m2.3.3.1.1.4.2.1.cmml" xref="S3.E14.m2.3.3.1.1.4.2.1">⋅</ci><apply id="S3.E14.m2.3.3.1.1.4.2.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.4.2.2.1.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2">superscript</csymbol><apply id="S3.E14.m2.3.3.1.1.4.2.2.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.4.2.2.2.1.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.4.2.2.2.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2.2.2">𝐱</ci><ci id="S3.E14.m2.3.3.1.1.4.2.2.2.3.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2.2.3">𝑖</ci></apply><ci id="S3.E14.m2.3.3.1.1.4.2.2.3a.cmml" xref="S3.E14.m2.3.3.1.1.4.2.2.3"><mtext id="S3.E14.m2.3.3.1.1.4.2.2.3.cmml" mathsize="70%" xref="S3.E14.m2.3.3.1.1.4.2.2.3">rep</mtext></ci></apply><apply id="S3.E14.m2.3.3.1.1.4.2.3.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.4.2.3.1.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3">superscript</csymbol><apply id="S3.E14.m2.3.3.1.1.4.2.3.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.4.2.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.4.2.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3.2.2">𝐖</ci><ci id="S3.E14.m2.3.3.1.1.4.2.3.2.3.cmml" xref="S3.E14.m2.3.3.1.1.4.2.3.2.3">𝑒</ci></apply><ci id="S3.E14.m2.1.1.1.1.cmml" xref="S3.E14.m2.1.1.1.1">𝑑</ci></apply></apply><apply id="S3.E14.m2.3.3.1.1.4.3.cmml" xref="S3.E14.m2.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.4.3.1.cmml" xref="S3.E14.m2.3.3.1.1.4.3">superscript</csymbol><ci id="S3.E14.m2.3.3.1.1.4.3.2a.cmml" xref="S3.E14.m2.3.3.1.1.4.3.2"><mtext id="S3.E14.m2.3.3.1.1.4.3.2.cmml" xref="S3.E14.m2.3.3.1.1.4.3.2">PE</mtext></ci><ci id="S3.E14.m2.2.2.1.1.cmml" xref="S3.E14.m2.2.2.1.1">𝑑</ci></apply></apply></apply><apply id="S3.E14.m2.3.3.1.1c.cmml" xref="S3.E14.m2.3.3.1"><in id="S3.E14.m2.3.3.1.1.5.cmml" xref="S3.E14.m2.3.3.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E14.m2.3.3.1.1.4.cmml" id="S3.E14.m2.3.3.1.1d.cmml" xref="S3.E14.m2.3.3.1"></share><apply id="S3.E14.m2.3.3.1.1.6.cmml" xref="S3.E14.m2.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.6.1.cmml" xref="S3.E14.m2.3.3.1.1.6">superscript</csymbol><ci id="S3.E14.m2.3.3.1.1.6.2.cmml" xref="S3.E14.m2.3.3.1.1.6.2">ℝ</ci><apply id="S3.E14.m2.3.3.1.1.6.3.cmml" xref="S3.E14.m2.3.3.1.1.6.3"><times id="S3.E14.m2.3.3.1.1.6.3.1.cmml" xref="S3.E14.m2.3.3.1.1.6.3.1"></times><ci id="S3.E14.m2.3.3.1.1.6.3.2.cmml" xref="S3.E14.m2.3.3.1.1.6.3.2">𝐻</ci><apply id="S3.E14.m2.3.3.1.1.6.3.3.cmml" xref="S3.E14.m2.3.3.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.6.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.6.3.3">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.6.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.6.3.3.2">𝑑</ci><ci id="S3.E14.m2.3.3.1.1.6.3.3.3a.cmml" xref="S3.E14.m2.3.3.1.1.6.3.3.3"><mtext id="S3.E14.m2.3.3.1.1.6.3.3.3.cmml" mathsize="50%" xref="S3.E14.m2.3.3.1.1.6.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.3c">\displaystyle=\mathbf{x}_{i}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text{PE}^{%
(d)}\in\mathbb{R}^{H\times d_{\text{model}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m2.3d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(d)}" class="ltx_Math" display="inline" id="S3.E15.m1.1"><semantics id="S3.E15.m1.1a"><msubsup id="S3.E15.m1.1.2" xref="S3.E15.m1.1.2.cmml"><mi id="S3.E15.m1.1.2.2.2" xref="S3.E15.m1.1.2.2.2.cmml">𝐇</mi><mi id="S3.E15.m1.1.2.2.3" xref="S3.E15.m1.1.2.2.3.cmml">i</mi><mrow id="S3.E15.m1.1.1.1.3" xref="S3.E15.m1.1.2.cmml"><mo id="S3.E15.m1.1.1.1.3.1" stretchy="false" xref="S3.E15.m1.1.2.cmml">(</mo><mi id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml">d</mi><mo id="S3.E15.m1.1.1.1.3.2" stretchy="false" xref="S3.E15.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.2.cmml" xref="S3.E15.m1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.2.1.cmml" xref="S3.E15.m1.1.2">superscript</csymbol><apply id="S3.E15.m1.1.2.2.cmml" xref="S3.E15.m1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.2.2.1.cmml" xref="S3.E15.m1.1.2">subscript</csymbol><ci id="S3.E15.m1.1.2.2.2.cmml" xref="S3.E15.m1.1.2.2.2">𝐇</ci><ci id="S3.E15.m1.1.2.2.3.cmml" xref="S3.E15.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle\mathbf{H}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerDecoder}(\mathbf{Z}_{i}^{(d)},\mathbf{H}_{i}^{(%
e)})." class="ltx_Math" display="inline" id="S3.E15.m2.3"><semantics id="S3.E15.m2.3a"><mrow id="S3.E15.m2.3.3.1" xref="S3.E15.m2.3.3.1.1.cmml"><mrow id="S3.E15.m2.3.3.1.1" xref="S3.E15.m2.3.3.1.1.cmml"><mi id="S3.E15.m2.3.3.1.1.4" xref="S3.E15.m2.3.3.1.1.4.cmml"></mi><mo id="S3.E15.m2.3.3.1.1.3" xref="S3.E15.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E15.m2.3.3.1.1.2" xref="S3.E15.m2.3.3.1.1.2.cmml"><mtext id="S3.E15.m2.3.3.1.1.2.4" xref="S3.E15.m2.3.3.1.1.2.4a.cmml">TransformerDecoder</mtext><mo id="S3.E15.m2.3.3.1.1.2.3" xref="S3.E15.m2.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S3.E15.m2.3.3.1.1.2.2.2" xref="S3.E15.m2.3.3.1.1.2.2.3.cmml"><mo id="S3.E15.m2.3.3.1.1.2.2.2.3" stretchy="false" xref="S3.E15.m2.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E15.m2.3.3.1.1.1.1.1.1" xref="S3.E15.m2.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E15.m2.3.3.1.1.1.1.1.1.2.2" xref="S3.E15.m2.3.3.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mi id="S3.E15.m2.3.3.1.1.1.1.1.1.2.3" xref="S3.E15.m2.3.3.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E15.m2.1.1.1.3" xref="S3.E15.m2.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E15.m2.1.1.1.3.1" stretchy="false" xref="S3.E15.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E15.m2.1.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml">d</mi><mo id="S3.E15.m2.1.1.1.3.2" stretchy="false" xref="S3.E15.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E15.m2.3.3.1.1.2.2.2.4" xref="S3.E15.m2.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E15.m2.3.3.1.1.2.2.2.2" xref="S3.E15.m2.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E15.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E15.m2.3.3.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mi id="S3.E15.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E15.m2.3.3.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E15.m2.2.2.1.3" xref="S3.E15.m2.3.3.1.1.2.2.2.2.cmml"><mo id="S3.E15.m2.2.2.1.3.1" stretchy="false" xref="S3.E15.m2.3.3.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E15.m2.2.2.1.1" xref="S3.E15.m2.2.2.1.1.cmml">e</mi><mo id="S3.E15.m2.2.2.1.3.2" stretchy="false" xref="S3.E15.m2.3.3.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E15.m2.3.3.1.1.2.2.2.5" stretchy="false" xref="S3.E15.m2.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m2.3.3.1.2" lspace="0em" xref="S3.E15.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m2.3b"><apply id="S3.E15.m2.3.3.1.1.cmml" xref="S3.E15.m2.3.3.1"><eq id="S3.E15.m2.3.3.1.1.3.cmml" xref="S3.E15.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E15.m2.3.3.1.1.4.cmml" xref="S3.E15.m2.3.3.1.1.4">absent</csymbol><apply id="S3.E15.m2.3.3.1.1.2.cmml" xref="S3.E15.m2.3.3.1.1.2"><times id="S3.E15.m2.3.3.1.1.2.3.cmml" xref="S3.E15.m2.3.3.1.1.2.3"></times><ci id="S3.E15.m2.3.3.1.1.2.4a.cmml" xref="S3.E15.m2.3.3.1.1.2.4"><mtext id="S3.E15.m2.3.3.1.1.2.4.cmml" xref="S3.E15.m2.3.3.1.1.2.4">TransformerDecoder</mtext></ci><interval closure="open" id="S3.E15.m2.3.3.1.1.2.2.3.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2"><apply id="S3.E15.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E15.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1.2.2">𝐙</ci><ci id="S3.E15.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m2.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E15.m2.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1.1">𝑑</ci></apply><apply id="S3.E15.m2.3.3.1.1.2.2.2.2.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E15.m2.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E15.m2.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2.2.2">𝐇</ci><ci id="S3.E15.m2.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E15.m2.3.3.1.1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E15.m2.2.2.1.1.cmml" xref="S3.E15.m2.2.2.1.1">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m2.3c">\displaystyle=\text{TransformerDecoder}(\mathbf{Z}_{i}^{(d)},\mathbf{H}_{i}^{(%
e)}).</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m2.3d">= TransformerDecoder ( bold_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Output</h5>
<div class="ltx_para" id="S3.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px3.p1.1">The decoder output is projected to obtain the forecast:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}\in\mathbb{R}^{H}." class="ltx_Math" display="block" id="S3.E16.m1.2"><semantics id="S3.E16.m1.2a"><mrow id="S3.E16.m1.2.2.1" xref="S3.E16.m1.2.2.1.1.cmml"><mrow id="S3.E16.m1.2.2.1.1" xref="S3.E16.m1.2.2.1.1.cmml"><msub id="S3.E16.m1.2.2.1.1.2" xref="S3.E16.m1.2.2.1.1.2.cmml"><mover accent="true" id="S3.E16.m1.2.2.1.1.2.2" xref="S3.E16.m1.2.2.1.1.2.2.cmml"><mi id="S3.E16.m1.2.2.1.1.2.2.2" xref="S3.E16.m1.2.2.1.1.2.2.2.cmml">𝐲</mi><mo id="S3.E16.m1.2.2.1.1.2.2.1" xref="S3.E16.m1.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.2.2.1.1.2.3" xref="S3.E16.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E16.m1.2.2.1.1.3" xref="S3.E16.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E16.m1.2.2.1.1.4" xref="S3.E16.m1.2.2.1.1.4.cmml"><msub id="S3.E16.m1.2.2.1.1.4.2" xref="S3.E16.m1.2.2.1.1.4.2.cmml"><mi id="S3.E16.m1.2.2.1.1.4.2.2" xref="S3.E16.m1.2.2.1.1.4.2.2.cmml">𝐖</mi><mi id="S3.E16.m1.2.2.1.1.4.2.3" xref="S3.E16.m1.2.2.1.1.4.2.3.cmml">o</mi></msub><mo id="S3.E16.m1.2.2.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E16.m1.2.2.1.1.4.1.cmml">⋅</mo><msubsup id="S3.E16.m1.2.2.1.1.4.3" xref="S3.E16.m1.2.2.1.1.4.3.cmml"><mi id="S3.E16.m1.2.2.1.1.4.3.2.2" xref="S3.E16.m1.2.2.1.1.4.3.2.2.cmml">𝐇</mi><mi id="S3.E16.m1.2.2.1.1.4.3.2.3" xref="S3.E16.m1.2.2.1.1.4.3.2.3.cmml">i</mi><mrow id="S3.E16.m1.1.1.1.3" xref="S3.E16.m1.2.2.1.1.4.3.cmml"><mo id="S3.E16.m1.1.1.1.3.1" stretchy="false" xref="S3.E16.m1.2.2.1.1.4.3.cmml">(</mo><mi id="S3.E16.m1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml">d</mi><mo id="S3.E16.m1.1.1.1.3.2" stretchy="false" xref="S3.E16.m1.2.2.1.1.4.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E16.m1.2.2.1.1.5" xref="S3.E16.m1.2.2.1.1.5.cmml">∈</mo><msup id="S3.E16.m1.2.2.1.1.6" xref="S3.E16.m1.2.2.1.1.6.cmml"><mi id="S3.E16.m1.2.2.1.1.6.2" xref="S3.E16.m1.2.2.1.1.6.2.cmml">ℝ</mi><mi id="S3.E16.m1.2.2.1.1.6.3" xref="S3.E16.m1.2.2.1.1.6.3.cmml">H</mi></msup></mrow><mo id="S3.E16.m1.2.2.1.2" lspace="0em" xref="S3.E16.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.2b"><apply id="S3.E16.m1.2.2.1.1.cmml" xref="S3.E16.m1.2.2.1"><and id="S3.E16.m1.2.2.1.1a.cmml" xref="S3.E16.m1.2.2.1"></and><apply id="S3.E16.m1.2.2.1.1b.cmml" xref="S3.E16.m1.2.2.1"><eq id="S3.E16.m1.2.2.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.3"></eq><apply id="S3.E16.m1.2.2.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.2.1.cmml" xref="S3.E16.m1.2.2.1.1.2">subscript</csymbol><apply id="S3.E16.m1.2.2.1.1.2.2.cmml" xref="S3.E16.m1.2.2.1.1.2.2"><ci id="S3.E16.m1.2.2.1.1.2.2.1.cmml" xref="S3.E16.m1.2.2.1.1.2.2.1">^</ci><ci id="S3.E16.m1.2.2.1.1.2.2.2.cmml" xref="S3.E16.m1.2.2.1.1.2.2.2">𝐲</ci></apply><ci id="S3.E16.m1.2.2.1.1.2.3.cmml" xref="S3.E16.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E16.m1.2.2.1.1.4.cmml" xref="S3.E16.m1.2.2.1.1.4"><ci id="S3.E16.m1.2.2.1.1.4.1.cmml" xref="S3.E16.m1.2.2.1.1.4.1">⋅</ci><apply id="S3.E16.m1.2.2.1.1.4.2.cmml" xref="S3.E16.m1.2.2.1.1.4.2"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.4.2.1.cmml" xref="S3.E16.m1.2.2.1.1.4.2">subscript</csymbol><ci id="S3.E16.m1.2.2.1.1.4.2.2.cmml" xref="S3.E16.m1.2.2.1.1.4.2.2">𝐖</ci><ci id="S3.E16.m1.2.2.1.1.4.2.3.cmml" xref="S3.E16.m1.2.2.1.1.4.2.3">𝑜</ci></apply><apply id="S3.E16.m1.2.2.1.1.4.3.cmml" xref="S3.E16.m1.2.2.1.1.4.3"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.4.3.1.cmml" xref="S3.E16.m1.2.2.1.1.4.3">superscript</csymbol><apply id="S3.E16.m1.2.2.1.1.4.3.2.cmml" xref="S3.E16.m1.2.2.1.1.4.3"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.4.3.2.1.cmml" xref="S3.E16.m1.2.2.1.1.4.3">subscript</csymbol><ci id="S3.E16.m1.2.2.1.1.4.3.2.2.cmml" xref="S3.E16.m1.2.2.1.1.4.3.2.2">𝐇</ci><ci id="S3.E16.m1.2.2.1.1.4.3.2.3.cmml" xref="S3.E16.m1.2.2.1.1.4.3.2.3">𝑖</ci></apply><ci id="S3.E16.m1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.E16.m1.2.2.1.1c.cmml" xref="S3.E16.m1.2.2.1"><in id="S3.E16.m1.2.2.1.1.5.cmml" xref="S3.E16.m1.2.2.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S3.E16.m1.2.2.1.1.4.cmml" id="S3.E16.m1.2.2.1.1d.cmml" xref="S3.E16.m1.2.2.1"></share><apply id="S3.E16.m1.2.2.1.1.6.cmml" xref="S3.E16.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.6.1.cmml" xref="S3.E16.m1.2.2.1.1.6">superscript</csymbol><ci id="S3.E16.m1.2.2.1.1.6.2.cmml" xref="S3.E16.m1.2.2.1.1.6.2">ℝ</ci><ci id="S3.E16.m1.2.2.1.1.6.3.cmml" xref="S3.E16.m1.2.2.1.1.6.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.2c">\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}\in\mathbb{R}^{H}.</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.2d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S3.SS3.SSS0.Px4.p1">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Full}}=\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Encoder FFN}}+\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{Encoder %
Attention}}+\underbrace{H\cdot d_{\text{model}}^{2}}_{\text{Decoder FFN}}+%
\underbrace{H\cdot P\cdot d_{\text{model}}}_{\text{Cross-Attention}}." class="ltx_Math" display="block" id="S3.Ex8.m1.1"><semantics id="S3.Ex8.m1.1a"><mrow id="S3.Ex8.m1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.cmml"><mrow id="S3.Ex8.m1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.cmml"><msub id="S3.Ex8.m1.1.1.1.1.2" xref="S3.Ex8.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex8.m1.1.1.1.1.2.2" xref="S3.Ex8.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S3.Ex8.m1.1.1.1.1.2.3" xref="S3.Ex8.m1.1.1.1.1.2.3a.cmml">Full</mtext></msub><mo id="S3.Ex8.m1.1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.Ex8.m1.1.1.1.1.3" xref="S3.Ex8.m1.1.1.1.1.3.cmml"><munder id="S3.Ex8.m1.1.1.1.1.3.2" xref="S3.Ex8.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S3.Ex8.m1.1.1.1.1.3.2.2" xref="S3.Ex8.m1.1.1.1.1.3.2.2.cmml"><mrow id="S3.Ex8.m1.1.1.1.1.3.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.2.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.2.cmml">P</mi><mo id="S3.Ex8.m1.1.1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.1.cmml">⋅</mo><msubsup id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.2" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.2.cmml">d</mi><mtext id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3a.cmml">model</mtext><mn id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.3" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S3.Ex8.m1.1.1.1.1.3.2.2.1" xref="S3.Ex8.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex8.m1.1.1.1.1.3.2.3" xref="S3.Ex8.m1.1.1.1.1.3.2.3a.cmml">Encoder FFN</mtext></munder><mo id="S3.Ex8.m1.1.1.1.1.3.1" xref="S3.Ex8.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S3.Ex8.m1.1.1.1.1.3.3" xref="S3.Ex8.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S3.Ex8.m1.1.1.1.1.3.3.2" xref="S3.Ex8.m1.1.1.1.1.3.3.2.cmml"><mrow id="S3.Ex8.m1.1.1.1.1.3.3.2.2" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.cmml"><msup id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.2.cmml">P</mi><mn id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.3" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.Ex8.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msub id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.2" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.2.cmml">d</mi><mtext id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S3.Ex8.m1.1.1.1.1.3.3.2.1" xref="S3.Ex8.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex8.m1.1.1.1.1.3.3.3" xref="S3.Ex8.m1.1.1.1.1.3.3.3a.cmml">Encoder Attention</mtext></munder><mo id="S3.Ex8.m1.1.1.1.1.3.1a" xref="S3.Ex8.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S3.Ex8.m1.1.1.1.1.3.4" xref="S3.Ex8.m1.1.1.1.1.3.4.cmml"><munder accentunder="true" id="S3.Ex8.m1.1.1.1.1.3.4.2" xref="S3.Ex8.m1.1.1.1.1.3.4.2.cmml"><mrow id="S3.Ex8.m1.1.1.1.1.3.4.2.2" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.4.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.2.cmml">H</mi><mo id="S3.Ex8.m1.1.1.1.1.3.4.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.1.cmml">⋅</mo><msubsup id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.2" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.2.cmml">d</mi><mtext id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3a.cmml">model</mtext><mn id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.3" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S3.Ex8.m1.1.1.1.1.3.4.2.1" xref="S3.Ex8.m1.1.1.1.1.3.4.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex8.m1.1.1.1.1.3.4.3" xref="S3.Ex8.m1.1.1.1.1.3.4.3a.cmml">Decoder FFN</mtext></munder><mo id="S3.Ex8.m1.1.1.1.1.3.1b" xref="S3.Ex8.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S3.Ex8.m1.1.1.1.1.3.5" xref="S3.Ex8.m1.1.1.1.1.3.5.cmml"><munder accentunder="true" id="S3.Ex8.m1.1.1.1.1.3.5.2" xref="S3.Ex8.m1.1.1.1.1.3.5.2.cmml"><mrow id="S3.Ex8.m1.1.1.1.1.3.5.2.2" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.5.2.2.2" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.2.cmml">H</mi><mo id="S3.Ex8.m1.1.1.1.1.3.5.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.1.cmml">⋅</mo><mi id="S3.Ex8.m1.1.1.1.1.3.5.2.2.3" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.3.cmml">P</mi><mo id="S3.Ex8.m1.1.1.1.1.3.5.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.1.cmml">⋅</mo><msub id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.cmml"><mi id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.2" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.2.cmml">d</mi><mtext id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3a.cmml">model</mtext></msub></mrow><mo id="S3.Ex8.m1.1.1.1.1.3.5.2.1" xref="S3.Ex8.m1.1.1.1.1.3.5.2.1.cmml">⏟</mo></munder><mtext id="S3.Ex8.m1.1.1.1.1.3.5.3" xref="S3.Ex8.m1.1.1.1.1.3.5.3a.cmml">Cross-Attention</mtext></munder></mrow></mrow><mo id="S3.Ex8.m1.1.1.1.2" lspace="0em" xref="S3.Ex8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.1b"><apply id="S3.Ex8.m1.1.1.1.1.cmml" xref="S3.Ex8.m1.1.1.1"><eq id="S3.Ex8.m1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.1.1.1.1.1"></eq><apply id="S3.Ex8.m1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.2.2">𝒪</ci><ci id="S3.Ex8.m1.1.1.1.1.2.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.2.3"><mtext id="S3.Ex8.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.2.3">Full</mtext></ci></apply><apply id="S3.Ex8.m1.1.1.1.1.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3"><plus id="S3.Ex8.m1.1.1.1.1.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.1"></plus><apply id="S3.Ex8.m1.1.1.1.1.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2"><ci id="S3.Ex8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S3.Ex8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2"><ci id="S3.Ex8.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.1">⋅</ci><ci id="S3.Ex8.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.2">𝑃</ci><apply id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3">superscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.2">𝑑</ci><ci id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.2.3">model</mtext></ci></apply><cn id="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.3.cmml" type="integer" xref="S3.Ex8.m1.1.1.1.1.3.2.2.2.3.3">2</cn></apply></apply></apply><ci id="S3.Ex8.m1.1.1.1.1.3.2.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.2.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.2.3">Encoder FFN</mtext></ci></apply><apply id="S3.Ex8.m1.1.1.1.1.3.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2"><ci id="S3.Ex8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S3.Ex8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2"><ci id="S3.Ex8.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.1">⋅</ci><apply id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2">superscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.2">𝑃</ci><cn id="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.3.cmml" type="integer" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.2.3">2</cn></apply><apply id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.2">𝑑</ci><ci id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.3.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S3.Ex8.m1.1.1.1.1.3.3.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.3.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.3.3">Encoder Attention</mtext></ci></apply><apply id="S3.Ex8.m1.1.1.1.1.3.4.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.4.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4">subscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.4.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2"><ci id="S3.Ex8.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.1">⏟</ci><apply id="S3.Ex8.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2"><ci id="S3.Ex8.m1.1.1.1.1.3.4.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.1">⋅</ci><ci id="S3.Ex8.m1.1.1.1.1.3.4.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.2">𝐻</ci><apply id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3">superscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.2">𝑑</ci><ci id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.2.3">model</mtext></ci></apply><cn id="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.3.cmml" type="integer" xref="S3.Ex8.m1.1.1.1.1.3.4.2.2.3.3">2</cn></apply></apply></apply><ci id="S3.Ex8.m1.1.1.1.1.3.4.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.4.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.4.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.4.3">Decoder FFN</mtext></ci></apply><apply id="S3.Ex8.m1.1.1.1.1.3.5.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.5.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5">subscript</csymbol><apply id="S3.Ex8.m1.1.1.1.1.3.5.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2"><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.1">⏟</ci><apply id="S3.Ex8.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2"><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.2.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.1">⋅</ci><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.2.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.2">𝐻</ci><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.2.3.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.3">𝑃</ci><apply id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4"><csymbol cd="ambiguous" id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.1.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4">subscript</csymbol><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.2.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.2">𝑑</ci><ci id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.5.2.2.4.3">model</mtext></ci></apply></apply></apply><ci id="S3.Ex8.m1.1.1.1.1.3.5.3a.cmml" xref="S3.Ex8.m1.1.1.1.1.3.5.3"><mtext id="S3.Ex8.m1.1.1.1.1.3.5.3.cmml" mathsize="70%" xref="S3.Ex8.m1.1.1.1.1.3.5.3">Cross-Attention</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.1c">\mathcal{O}_{\text{Full}}=\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Encoder FFN}}+\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{Encoder %
Attention}}+\underbrace{H\cdot d_{\text{model}}^{2}}_{\text{Decoder FFN}}+%
\underbrace{H\cdot P\cdot d_{\text{model}}}_{\text{Cross-Attention}}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8.m1.1d">caligraphic_O start_POSTSUBSCRIPT Full end_POSTSUBSCRIPT = under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Encoder FFN end_POSTSUBSCRIPT + under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Encoder Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_H ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Decoder FFN end_POSTSUBSCRIPT + under⏟ start_ARG italic_H ⋅ italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Cross-Attention end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Comparative Summary</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Each <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p1.1.1">PatchTST</span> variant is designed to address different forecasting needs and trade-offs: (i) The <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.2">Minimal</span> variant provides fast training and interpretable forecasts, well-suited for small datasets and short horizons; (ii) The <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.3">Standard</span> variant adds learnable temporal representations, improving adaptability to real-world signals without significant computational overhead; (iii) The <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.4">Full</span> variant introduces an encoder-decoder structure that improves long-horizon modeling at the cost of increased complexity. A comparative overview of <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p1.1.5">PatchTST</span> variants is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S3.T1" title="Table 1 ‣ 3.4 Comparative Summary ‣ 3 PatchTST Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">1</span></a>, and the complete forecasting procedure for the Full variant is provided in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#alg1" title="Algorithm 1 ‣ 8 Conclusion ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">1</span></a> in Appendix.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.6.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.7.2" style="font-size:90%;">Comparison of <span class="ltx_text ltx_font_typewriter" id="S3.T1.7.2.1">PatchTST</span>  Variants</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.3.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Model Variant</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Positional Encoding</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Architecture</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Time Complexity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Minimal <span class="ltx_text ltx_font_typewriter" id="S3.T1.1.1.2.1">PatchTST</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Sinusoidal</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><mrow id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.1.1.1.m1.1.1.1.1" xref="S3.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.T1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.1.1.1.m1.1.1.1.1.1" xref="S3.T1.1.1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.T1.1.1.1.m1.1.1.1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.cmml"><msup id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S3.T1.1.1.1.m1.1.1.1.1.1.2.1" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml">d</mi><mtext id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S3.T1.1.1.1.m1.1.1.1.1.1.1" xref="S3.T1.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.T1.1.1.1.m1.1.1.1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.T1.1.1.1.m1.1.1.1.1.1.3.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S3.T1.1.1.1.m1.1.1.1.1.1.3.1" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.2" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3a.cmml">model</mtext><mn id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.3" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.T1.1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><times id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2"></times><ci id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3">𝒪</ci><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1"><plus id="S3.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2"><times id="S3.T1.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.1"></times><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.2.3">2</cn></apply><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3a.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3"><mtext id="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.T1.1.1.1.m1.1.1.1.1.1.2.3.3">model</mtext></ci></apply></apply><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3"><times id="S3.T1.1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.1"></times><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.2">𝑑</ci><ci id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3a.cmml" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3"><mtext id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.2.3">model</mtext></ci></apply><cn id="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S3.T1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Standard <span class="ltx_text ltx_font_typewriter" id="S3.T1.2.2.2.1">PatchTST</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Trainable (global)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})" class="ltx_Math" display="inline" id="S3.T1.2.2.1.m1.1"><semantics id="S3.T1.2.2.1.m1.1a"><mrow id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.2.2.1.m1.1.1.3" xref="S3.T1.2.2.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.T1.2.2.1.m1.1.1.2" xref="S3.T1.2.2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.2.2.1.m1.1.1.1.1" xref="S3.T1.2.2.1.m1.1.1.1.1.1.cmml"><mo id="S3.T1.2.2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.T1.2.2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.2.2.1.m1.1.1.1.1.1" xref="S3.T1.2.2.1.m1.1.1.1.1.1.cmml"><mrow id="S3.T1.2.2.1.m1.1.1.1.1.1.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.cmml"><msup id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S3.T1.2.2.1.m1.1.1.1.1.1.2.1" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.2.cmml">d</mi><mtext id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S3.T1.2.2.1.m1.1.1.1.1.1.1" xref="S3.T1.2.2.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.T1.2.2.1.m1.1.1.1.1.1.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.T1.2.2.1.m1.1.1.1.1.1.3.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S3.T1.2.2.1.m1.1.1.1.1.1.3.1" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.2" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3a.cmml">model</mtext><mn id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.3" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.T1.2.2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.T1.2.2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><apply id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1"><times id="S3.T1.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.1.m1.1.1.2"></times><ci id="S3.T1.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.1.m1.1.1.3">𝒪</ci><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1"><plus id="S3.T1.2.2.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.1"></plus><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2"><times id="S3.T1.2.2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.1"></times><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.2.3">2</cn></apply><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3a.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3"><mtext id="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.T1.2.2.1.m1.1.1.1.1.1.2.3.3">model</mtext></ci></apply></apply><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3"><times id="S3.T1.2.2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.1"></times><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.2">𝑑</ci><ci id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3a.cmml" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3"><mtext id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.2.3">model</mtext></ci></apply><cn id="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.T1.2.2.1.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.1.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.3.3">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S3.T1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Full <span class="ltx_text ltx_font_typewriter" id="S3.T1.3.3.2.1">PatchTST</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Sinusoidal (dual)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-Decoder</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d_{\text{model}}+HPd_{\text{model}}+Hd_{\text{model}}^{2})" class="ltx_Math" display="inline" id="S3.T1.3.3.1.m1.1"><semantics id="S3.T1.3.3.1.m1.1a"><mrow id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.3.3.1.m1.1.1.3" xref="S3.T1.3.3.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.T1.3.3.1.m1.1.1.2" xref="S3.T1.3.3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.3.3.1.m1.1.1.1.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.cmml"><mo id="S3.T1.3.3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.T1.3.3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.3.3.1.m1.1.1.1.1.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.cmml"><mrow id="S3.T1.3.3.1.m1.1.1.1.1.1.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.cmml"><msup id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.2.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.2.cmml">d</mi><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.T1.3.3.1.m1.1.1.1.1.1.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.3.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.2.cmml">H</mi><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.3.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.3.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.3.cmml">P</mi><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.3.1a" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.2.cmml">d</mi><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3a.cmml">model</mtext></msub></mrow><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.1a" xref="S3.T1.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.T1.3.3.1.m1.1.1.1.1.1.4" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.4.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.2.cmml">H</mi><mo id="S3.T1.3.3.1.m1.1.1.1.1.1.4.1" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.cmml"><mi id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.2" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.2.cmml">d</mi><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3a.cmml">model</mtext><mn id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.3" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.T1.3.3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.T1.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><apply id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1"><times id="S3.T1.3.3.1.m1.1.1.2.cmml" xref="S3.T1.3.3.1.m1.1.1.2"></times><ci id="S3.T1.3.3.1.m1.1.1.3.cmml" xref="S3.T1.3.3.1.m1.1.1.3">𝒪</ci><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1"><plus id="S3.T1.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.1"></plus><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2"><times id="S3.T1.3.3.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.1"></times><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.2.3">2</cn></apply><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3a.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3"><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.T1.3.3.1.m1.1.1.1.1.1.2.3.3">model</mtext></ci></apply></apply><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3"><times id="S3.T1.3.3.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.1"></times><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.2">𝐻</ci><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.3">𝑃</ci><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.2">𝑑</ci><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3a.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3"><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3.cmml" mathsize="70%" xref="S3.T1.3.3.1.m1.1.1.1.1.1.3.4.3">model</mtext></ci></apply></apply><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.4.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4"><times id="S3.T1.3.3.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.1"></times><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.4.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.2">𝐻</ci><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3">superscript</csymbol><apply id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.2">𝑑</ci><ci id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3a.cmml" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3"><mtext id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3.cmml" mathsize="70%" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.2.3">model</mtext></ci></apply><cn id="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.T1.3.3.1.m1.1.1.1.1.1.4.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">\mathcal{O}(P^{2}d_{\text{model}}+HPd_{\text{model}}+Hd_{\text{model}}^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.1.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_H italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_H italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_typewriter" id="S4.1.1">Informer</span>  Variants: Architecture and Computational Complexity</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Transformer models have demonstrated strong performance in sequence modeling, yet their standard self-attention mechanism suffers from quadratic time complexity with respect to input length. This poses a bottleneck for long time series forecasting. To overcome this, we present three variants based on the <span class="ltx_text ltx_font_typewriter" id="S4.p1.1.1">Informer</span> framework—Minimal, Standard, and Full—each offering a different balance between expressiveness and computational efficiency.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_typewriter" id="S4.SS1.1.1">Informer</span> Minimal: Baseline with Full Self-Attention</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The Minimal variant adopts a standard encoder-only Transformer architecture. Each input patch is projected into a latent space using a linear transformation:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}\in\mathbb{R}^{P\times d_{%
\text{model}}}." class="ltx_Math" display="block" id="S4.E17.m1.1"><semantics id="S4.E17.m1.1a"><mrow id="S4.E17.m1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml"><mrow id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml"><msub id="S4.E17.m1.1.1.1.1.2" xref="S4.E17.m1.1.1.1.1.2.cmml"><mi id="S4.E17.m1.1.1.1.1.2.2" xref="S4.E17.m1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E17.m1.1.1.1.1.2.3" xref="S4.E17.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E17.m1.1.1.1.1.3" xref="S4.E17.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E17.m1.1.1.1.1.4" xref="S4.E17.m1.1.1.1.1.4.cmml"><msub id="S4.E17.m1.1.1.1.1.4.2" xref="S4.E17.m1.1.1.1.1.4.2.cmml"><mi id="S4.E17.m1.1.1.1.1.4.2.2" xref="S4.E17.m1.1.1.1.1.4.2.2.cmml">𝐱</mi><mi id="S4.E17.m1.1.1.1.1.4.2.3" xref="S4.E17.m1.1.1.1.1.4.2.3.cmml">i</mi></msub><mo id="S4.E17.m1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.1.1.1.1.4.1.cmml">⋅</mo><msub id="S4.E17.m1.1.1.1.1.4.3" xref="S4.E17.m1.1.1.1.1.4.3.cmml"><mi id="S4.E17.m1.1.1.1.1.4.3.2" xref="S4.E17.m1.1.1.1.1.4.3.2.cmml">𝐖</mi><mi id="S4.E17.m1.1.1.1.1.4.3.3" xref="S4.E17.m1.1.1.1.1.4.3.3.cmml">e</mi></msub></mrow><mo id="S4.E17.m1.1.1.1.1.5" xref="S4.E17.m1.1.1.1.1.5.cmml">∈</mo><msup id="S4.E17.m1.1.1.1.1.6" xref="S4.E17.m1.1.1.1.1.6.cmml"><mi id="S4.E17.m1.1.1.1.1.6.2" xref="S4.E17.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S4.E17.m1.1.1.1.1.6.3" xref="S4.E17.m1.1.1.1.1.6.3.cmml"><mi id="S4.E17.m1.1.1.1.1.6.3.2" xref="S4.E17.m1.1.1.1.1.6.3.2.cmml">P</mi><mo id="S4.E17.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.1.1.1.1.6.3.1.cmml">×</mo><msub id="S4.E17.m1.1.1.1.1.6.3.3" xref="S4.E17.m1.1.1.1.1.6.3.3.cmml"><mi id="S4.E17.m1.1.1.1.1.6.3.3.2" xref="S4.E17.m1.1.1.1.1.6.3.3.2.cmml">d</mi><mtext id="S4.E17.m1.1.1.1.1.6.3.3.3" xref="S4.E17.m1.1.1.1.1.6.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><mo id="S4.E17.m1.1.1.1.2" lspace="0em" xref="S4.E17.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.1b"><apply id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1"><and id="S4.E17.m1.1.1.1.1a.cmml" xref="S4.E17.m1.1.1.1"></and><apply id="S4.E17.m1.1.1.1.1b.cmml" xref="S4.E17.m1.1.1.1"><eq id="S4.E17.m1.1.1.1.1.3.cmml" xref="S4.E17.m1.1.1.1.1.3"></eq><apply id="S4.E17.m1.1.1.1.1.2.cmml" xref="S4.E17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.2.1.cmml" xref="S4.E17.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E17.m1.1.1.1.1.2.2.cmml" xref="S4.E17.m1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E17.m1.1.1.1.1.2.3.cmml" xref="S4.E17.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E17.m1.1.1.1.1.4.cmml" xref="S4.E17.m1.1.1.1.1.4"><ci id="S4.E17.m1.1.1.1.1.4.1.cmml" xref="S4.E17.m1.1.1.1.1.4.1">⋅</ci><apply id="S4.E17.m1.1.1.1.1.4.2.cmml" xref="S4.E17.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.4.2.1.cmml" xref="S4.E17.m1.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E17.m1.1.1.1.1.4.2.2.cmml" xref="S4.E17.m1.1.1.1.1.4.2.2">𝐱</ci><ci id="S4.E17.m1.1.1.1.1.4.2.3.cmml" xref="S4.E17.m1.1.1.1.1.4.2.3">𝑖</ci></apply><apply id="S4.E17.m1.1.1.1.1.4.3.cmml" xref="S4.E17.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.4.3.1.cmml" xref="S4.E17.m1.1.1.1.1.4.3">subscript</csymbol><ci id="S4.E17.m1.1.1.1.1.4.3.2.cmml" xref="S4.E17.m1.1.1.1.1.4.3.2">𝐖</ci><ci id="S4.E17.m1.1.1.1.1.4.3.3.cmml" xref="S4.E17.m1.1.1.1.1.4.3.3">𝑒</ci></apply></apply></apply><apply id="S4.E17.m1.1.1.1.1c.cmml" xref="S4.E17.m1.1.1.1"><in id="S4.E17.m1.1.1.1.1.5.cmml" xref="S4.E17.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S4.E17.m1.1.1.1.1.4.cmml" id="S4.E17.m1.1.1.1.1d.cmml" xref="S4.E17.m1.1.1.1"></share><apply id="S4.E17.m1.1.1.1.1.6.cmml" xref="S4.E17.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.6.1.cmml" xref="S4.E17.m1.1.1.1.1.6">superscript</csymbol><ci id="S4.E17.m1.1.1.1.1.6.2.cmml" xref="S4.E17.m1.1.1.1.1.6.2">ℝ</ci><apply id="S4.E17.m1.1.1.1.1.6.3.cmml" xref="S4.E17.m1.1.1.1.1.6.3"><times id="S4.E17.m1.1.1.1.1.6.3.1.cmml" xref="S4.E17.m1.1.1.1.1.6.3.1"></times><ci id="S4.E17.m1.1.1.1.1.6.3.2.cmml" xref="S4.E17.m1.1.1.1.1.6.3.2">𝑃</ci><apply id="S4.E17.m1.1.1.1.1.6.3.3.cmml" xref="S4.E17.m1.1.1.1.1.6.3.3"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.6.3.3.1.cmml" xref="S4.E17.m1.1.1.1.1.6.3.3">subscript</csymbol><ci id="S4.E17.m1.1.1.1.1.6.3.3.2.cmml" xref="S4.E17.m1.1.1.1.1.6.3.3.2">𝑑</ci><ci id="S4.E17.m1.1.1.1.1.6.3.3.3a.cmml" xref="S4.E17.m1.1.1.1.1.6.3.3.3"><mtext id="S4.E17.m1.1.1.1.1.6.3.3.3.cmml" mathsize="50%" xref="S4.E17.m1.1.1.1.1.6.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.1c">\mathbf{z}_{i}=\mathbf{x}_{i}\cdot\mathbf{W}_{e}\in\mathbb{R}^{P\times d_{%
\text{model}}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To retain temporal information, fixed sinusoidal positional encodings are added:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE}(i)," class="ltx_Math" display="block" id="S4.E18.m1.2"><semantics id="S4.E18.m1.2a"><mrow id="S4.E18.m1.2.2.1" xref="S4.E18.m1.2.2.1.1.cmml"><mrow id="S4.E18.m1.2.2.1.1" xref="S4.E18.m1.2.2.1.1.cmml"><msubsup id="S4.E18.m1.2.2.1.1.2" xref="S4.E18.m1.2.2.1.1.2.cmml"><mi id="S4.E18.m1.2.2.1.1.2.2.2" xref="S4.E18.m1.2.2.1.1.2.2.2.cmml">𝐳</mi><mi id="S4.E18.m1.2.2.1.1.2.2.3" xref="S4.E18.m1.2.2.1.1.2.2.3.cmml">i</mi><mtext id="S4.E18.m1.2.2.1.1.2.3" xref="S4.E18.m1.2.2.1.1.2.3a.cmml">pos</mtext></msubsup><mo id="S4.E18.m1.2.2.1.1.1" xref="S4.E18.m1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E18.m1.2.2.1.1.3" xref="S4.E18.m1.2.2.1.1.3.cmml"><msub id="S4.E18.m1.2.2.1.1.3.2" xref="S4.E18.m1.2.2.1.1.3.2.cmml"><mi id="S4.E18.m1.2.2.1.1.3.2.2" xref="S4.E18.m1.2.2.1.1.3.2.2.cmml">𝐳</mi><mi id="S4.E18.m1.2.2.1.1.3.2.3" xref="S4.E18.m1.2.2.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E18.m1.2.2.1.1.3.1" xref="S4.E18.m1.2.2.1.1.3.1.cmml">+</mo><mrow id="S4.E18.m1.2.2.1.1.3.3" xref="S4.E18.m1.2.2.1.1.3.3.cmml"><mtext id="S4.E18.m1.2.2.1.1.3.3.2" xref="S4.E18.m1.2.2.1.1.3.3.2a.cmml">PE</mtext><mo id="S4.E18.m1.2.2.1.1.3.3.1" xref="S4.E18.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mrow id="S4.E18.m1.2.2.1.1.3.3.3.2" xref="S4.E18.m1.2.2.1.1.3.3.cmml"><mo id="S4.E18.m1.2.2.1.1.3.3.3.2.1" stretchy="false" xref="S4.E18.m1.2.2.1.1.3.3.cmml">(</mo><mi id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml">i</mi><mo id="S4.E18.m1.2.2.1.1.3.3.3.2.2" stretchy="false" xref="S4.E18.m1.2.2.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E18.m1.2.2.1.2" xref="S4.E18.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.2b"><apply id="S4.E18.m1.2.2.1.1.cmml" xref="S4.E18.m1.2.2.1"><eq id="S4.E18.m1.2.2.1.1.1.cmml" xref="S4.E18.m1.2.2.1.1.1"></eq><apply id="S4.E18.m1.2.2.1.1.2.cmml" xref="S4.E18.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.2.2.1.1.2.1.cmml" xref="S4.E18.m1.2.2.1.1.2">superscript</csymbol><apply id="S4.E18.m1.2.2.1.1.2.2.cmml" xref="S4.E18.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.2.2.1.1.2.2.1.cmml" xref="S4.E18.m1.2.2.1.1.2">subscript</csymbol><ci id="S4.E18.m1.2.2.1.1.2.2.2.cmml" xref="S4.E18.m1.2.2.1.1.2.2.2">𝐳</ci><ci id="S4.E18.m1.2.2.1.1.2.2.3.cmml" xref="S4.E18.m1.2.2.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E18.m1.2.2.1.1.2.3a.cmml" xref="S4.E18.m1.2.2.1.1.2.3"><mtext id="S4.E18.m1.2.2.1.1.2.3.cmml" mathsize="70%" xref="S4.E18.m1.2.2.1.1.2.3">pos</mtext></ci></apply><apply id="S4.E18.m1.2.2.1.1.3.cmml" xref="S4.E18.m1.2.2.1.1.3"><plus id="S4.E18.m1.2.2.1.1.3.1.cmml" xref="S4.E18.m1.2.2.1.1.3.1"></plus><apply id="S4.E18.m1.2.2.1.1.3.2.cmml" xref="S4.E18.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.2.2.1.1.3.2.1.cmml" xref="S4.E18.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S4.E18.m1.2.2.1.1.3.2.2.cmml" xref="S4.E18.m1.2.2.1.1.3.2.2">𝐳</ci><ci id="S4.E18.m1.2.2.1.1.3.2.3.cmml" xref="S4.E18.m1.2.2.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E18.m1.2.2.1.1.3.3.cmml" xref="S4.E18.m1.2.2.1.1.3.3"><times id="S4.E18.m1.2.2.1.1.3.3.1.cmml" xref="S4.E18.m1.2.2.1.1.3.3.1"></times><ci id="S4.E18.m1.2.2.1.1.3.3.2a.cmml" xref="S4.E18.m1.2.2.1.1.3.3.2"><mtext id="S4.E18.m1.2.2.1.1.3.3.2.cmml" xref="S4.E18.m1.2.2.1.1.3.3.2">PE</mtext></ci><ci id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.2c">\mathbf{z}_{i}^{\text{pos}}=\mathbf{z}_{i}+\text{PE}(i),</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.2d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT = bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + PE ( italic_i ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.2">This sequence is passed through a multi-layer Transformer encoder:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx5">
<tbody id="S4.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S4.E19.m1.1"><semantics id="S4.E19.m1.1a"><msub id="S4.E19.m1.1.1" xref="S4.E19.m1.1.1.cmml"><mi id="S4.E19.m1.1.1.2" xref="S4.E19.m1.1.1.2.cmml">𝐡</mi><mi id="S4.E19.m1.1.1.3" xref="S4.E19.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E19.m1.1b"><apply id="S4.E19.m1.1.1.cmml" xref="S4.E19.m1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.cmml" xref="S4.E19.m1.1.1">subscript</csymbol><ci id="S4.E19.m1.1.1.2.cmml" xref="S4.E19.m1.1.1.2">𝐡</ci><ci id="S4.E19.m1.1.1.3.cmml" xref="S4.E19.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.1c">\displaystyle\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}})," class="ltx_Math" display="inline" id="S4.E19.m2.1"><semantics id="S4.E19.m2.1a"><mrow id="S4.E19.m2.1.1.1" xref="S4.E19.m2.1.1.1.1.cmml"><mrow id="S4.E19.m2.1.1.1.1" xref="S4.E19.m2.1.1.1.1.cmml"><mi id="S4.E19.m2.1.1.1.1.3" xref="S4.E19.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E19.m2.1.1.1.1.2" xref="S4.E19.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E19.m2.1.1.1.1.1" xref="S4.E19.m2.1.1.1.1.1.cmml"><mtext id="S4.E19.m2.1.1.1.1.1.3" xref="S4.E19.m2.1.1.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S4.E19.m2.1.1.1.1.1.2" xref="S4.E19.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E19.m2.1.1.1.1.1.1.1" xref="S4.E19.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E19.m2.1.1.1.1.1.1.1.1" xref="S4.E19.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E19.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.E19.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E19.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.E19.m2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S4.E19.m2.1.1.1.1.1.1.1.1.3" xref="S4.E19.m2.1.1.1.1.1.1.1.1.3a.cmml">pos</mtext></msubsup><mo id="S4.E19.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E19.m2.1.1.1.2" xref="S4.E19.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m2.1b"><apply id="S4.E19.m2.1.1.1.1.cmml" xref="S4.E19.m2.1.1.1"><eq id="S4.E19.m2.1.1.1.1.2.cmml" xref="S4.E19.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E19.m2.1.1.1.1.3.cmml" xref="S4.E19.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E19.m2.1.1.1.1.1.cmml" xref="S4.E19.m2.1.1.1.1.1"><times id="S4.E19.m2.1.1.1.1.1.2.cmml" xref="S4.E19.m2.1.1.1.1.1.2"></times><ci id="S4.E19.m2.1.1.1.1.1.3a.cmml" xref="S4.E19.m2.1.1.1.1.1.3"><mtext id="S4.E19.m2.1.1.1.1.1.3.cmml" xref="S4.E19.m2.1.1.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S4.E19.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E19.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E19.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E19.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E19.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E19.m2.1.1.1.1.1.1.1.1.3"><mtext id="S4.E19.m2.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.E19.m2.1.1.1.1.1.1.1.1.3">pos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m2.1c">\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{\text{pos}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m2.1d">= TransformerEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="S4.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{y}}_{i}" class="ltx_Math" display="inline" id="S4.E20.m1.1"><semantics id="S4.E20.m1.1a"><msub id="S4.E20.m1.1.1" xref="S4.E20.m1.1.1.cmml"><mover accent="true" id="S4.E20.m1.1.1.2" xref="S4.E20.m1.1.1.2.cmml"><mi id="S4.E20.m1.1.1.2.2" xref="S4.E20.m1.1.1.2.2.cmml">𝐲</mi><mo id="S4.E20.m1.1.1.2.1" xref="S4.E20.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E20.m1.1.1.3" xref="S4.E20.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E20.m1.1b"><apply id="S4.E20.m1.1.1.cmml" xref="S4.E20.m1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.1.1.1.cmml" xref="S4.E20.m1.1.1">subscript</csymbol><apply id="S4.E20.m1.1.1.2.cmml" xref="S4.E20.m1.1.1.2"><ci id="S4.E20.m1.1.1.2.1.cmml" xref="S4.E20.m1.1.1.2.1">^</ci><ci id="S4.E20.m1.1.1.2.2.cmml" xref="S4.E20.m1.1.1.2.2">𝐲</ci></apply><ci id="S4.E20.m1.1.1.3.cmml" xref="S4.E20.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.1c">\displaystyle\hat{\mathbf{y}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i})," class="ltx_Math" display="inline" id="S4.E20.m2.1"><semantics id="S4.E20.m2.1a"><mrow id="S4.E20.m2.1.1.1" xref="S4.E20.m2.1.1.1.1.cmml"><mrow id="S4.E20.m2.1.1.1.1" xref="S4.E20.m2.1.1.1.1.cmml"><mi id="S4.E20.m2.1.1.1.1.3" xref="S4.E20.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E20.m2.1.1.1.1.2" xref="S4.E20.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E20.m2.1.1.1.1.1" xref="S4.E20.m2.1.1.1.1.1.cmml"><mrow id="S4.E20.m2.1.1.1.1.1.3" xref="S4.E20.m2.1.1.1.1.1.3.cmml"><msub id="S4.E20.m2.1.1.1.1.1.3.2" xref="S4.E20.m2.1.1.1.1.1.3.2.cmml"><mi id="S4.E20.m2.1.1.1.1.1.3.2.2" xref="S4.E20.m2.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S4.E20.m2.1.1.1.1.1.3.2.3" xref="S4.E20.m2.1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S4.E20.m2.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E20.m2.1.1.1.1.1.3.1.cmml">⋅</mo><mtext id="S4.E20.m2.1.1.1.1.1.3.3" xref="S4.E20.m2.1.1.1.1.1.3.3a.cmml">AvgPool</mtext></mrow><mo id="S4.E20.m2.1.1.1.1.1.2" xref="S4.E20.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E20.m2.1.1.1.1.1.1.1" xref="S4.E20.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E20.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E20.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E20.m2.1.1.1.1.1.1.1.1" xref="S4.E20.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E20.m2.1.1.1.1.1.1.1.1.2" xref="S4.E20.m2.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.E20.m2.1.1.1.1.1.1.1.1.3" xref="S4.E20.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E20.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E20.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E20.m2.1.1.1.2" xref="S4.E20.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m2.1b"><apply id="S4.E20.m2.1.1.1.1.cmml" xref="S4.E20.m2.1.1.1"><eq id="S4.E20.m2.1.1.1.1.2.cmml" xref="S4.E20.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E20.m2.1.1.1.1.3.cmml" xref="S4.E20.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E20.m2.1.1.1.1.1.cmml" xref="S4.E20.m2.1.1.1.1.1"><times id="S4.E20.m2.1.1.1.1.1.2.cmml" xref="S4.E20.m2.1.1.1.1.1.2"></times><apply id="S4.E20.m2.1.1.1.1.1.3.cmml" xref="S4.E20.m2.1.1.1.1.1.3"><ci id="S4.E20.m2.1.1.1.1.1.3.1.cmml" xref="S4.E20.m2.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E20.m2.1.1.1.1.1.3.2.cmml" xref="S4.E20.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E20.m2.1.1.1.1.1.3.2.1.cmml" xref="S4.E20.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E20.m2.1.1.1.1.1.3.2.2.cmml" xref="S4.E20.m2.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S4.E20.m2.1.1.1.1.1.3.2.3.cmml" xref="S4.E20.m2.1.1.1.1.1.3.2.3">𝑜</ci></apply><ci id="S4.E20.m2.1.1.1.1.1.3.3a.cmml" xref="S4.E20.m2.1.1.1.1.1.3.3"><mtext id="S4.E20.m2.1.1.1.1.1.3.3.cmml" xref="S4.E20.m2.1.1.1.1.1.3.3">AvgPool</mtext></ci></apply><apply id="S4.E20.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E20.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E20.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E20.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E20.m2.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S4.E20.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E20.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m2.1c">\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m2.1d">= bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ AvgPool ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.3">This model serves as a full-attention baseline, but its complexity increases quadratically with the input length.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<table class="ltx_equation ltx_eqn_table" id="S4.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Minimal}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}" class="ltx_Math" display="block" id="S4.Ex9.m1.1"><semantics id="S4.Ex9.m1.1a"><mrow id="S4.Ex9.m1.1.1" xref="S4.Ex9.m1.1.1.cmml"><msub id="S4.Ex9.m1.1.1.2" xref="S4.Ex9.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex9.m1.1.1.2.2" xref="S4.Ex9.m1.1.1.2.2.cmml">𝒪</mi><mtext id="S4.Ex9.m1.1.1.2.3" xref="S4.Ex9.m1.1.1.2.3a.cmml">Minimal</mtext></msub><mo id="S4.Ex9.m1.1.1.1" xref="S4.Ex9.m1.1.1.1.cmml">=</mo><mrow id="S4.Ex9.m1.1.1.3" xref="S4.Ex9.m1.1.1.3.cmml"><munder id="S4.Ex9.m1.1.1.3.2" xref="S4.Ex9.m1.1.1.3.2.cmml"><munder accentunder="true" id="S4.Ex9.m1.1.1.3.2.2" xref="S4.Ex9.m1.1.1.3.2.2.cmml"><mrow id="S4.Ex9.m1.1.1.3.2.2.2" xref="S4.Ex9.m1.1.1.3.2.2.2.cmml"><msup id="S4.Ex9.m1.1.1.3.2.2.2.2" xref="S4.Ex9.m1.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex9.m1.1.1.3.2.2.2.2.2" xref="S4.Ex9.m1.1.1.3.2.2.2.2.2.cmml">P</mi><mn id="S4.Ex9.m1.1.1.3.2.2.2.2.3" xref="S4.Ex9.m1.1.1.3.2.2.2.2.3.cmml">2</mn></msup><mo id="S4.Ex9.m1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex9.m1.1.1.3.2.2.2.1.cmml">⋅</mo><msub id="S4.Ex9.m1.1.1.3.2.2.2.3" xref="S4.Ex9.m1.1.1.3.2.2.2.3.cmml"><mi id="S4.Ex9.m1.1.1.3.2.2.2.3.2" xref="S4.Ex9.m1.1.1.3.2.2.2.3.2.cmml">d</mi><mtext id="S4.Ex9.m1.1.1.3.2.2.2.3.3" xref="S4.Ex9.m1.1.1.3.2.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S4.Ex9.m1.1.1.3.2.2.1" xref="S4.Ex9.m1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex9.m1.1.1.3.2.3" xref="S4.Ex9.m1.1.1.3.2.3a.cmml">Self-Attention</mtext></munder><mo id="S4.Ex9.m1.1.1.3.1" xref="S4.Ex9.m1.1.1.3.1.cmml">+</mo><munder id="S4.Ex9.m1.1.1.3.3" xref="S4.Ex9.m1.1.1.3.3.cmml"><munder accentunder="true" id="S4.Ex9.m1.1.1.3.3.2" xref="S4.Ex9.m1.1.1.3.3.2.cmml"><mrow id="S4.Ex9.m1.1.1.3.3.2.2" xref="S4.Ex9.m1.1.1.3.3.2.2.cmml"><mi id="S4.Ex9.m1.1.1.3.3.2.2.2" xref="S4.Ex9.m1.1.1.3.3.2.2.2.cmml">P</mi><mo id="S4.Ex9.m1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex9.m1.1.1.3.3.2.2.1.cmml">⋅</mo><msubsup id="S4.Ex9.m1.1.1.3.3.2.2.3" xref="S4.Ex9.m1.1.1.3.3.2.2.3.cmml"><mi id="S4.Ex9.m1.1.1.3.3.2.2.3.2.2" xref="S4.Ex9.m1.1.1.3.3.2.2.3.2.2.cmml">d</mi><mtext id="S4.Ex9.m1.1.1.3.3.2.2.3.2.3" xref="S4.Ex9.m1.1.1.3.3.2.2.3.2.3a.cmml">model</mtext><mn id="S4.Ex9.m1.1.1.3.3.2.2.3.3" xref="S4.Ex9.m1.1.1.3.3.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S4.Ex9.m1.1.1.3.3.2.1" xref="S4.Ex9.m1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex9.m1.1.1.3.3.3" xref="S4.Ex9.m1.1.1.3.3.3a.cmml">Feedforward Layers</mtext></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.1b"><apply id="S4.Ex9.m1.1.1.cmml" xref="S4.Ex9.m1.1.1"><eq id="S4.Ex9.m1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1"></eq><apply id="S4.Ex9.m1.1.1.2.cmml" xref="S4.Ex9.m1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.2.1.cmml" xref="S4.Ex9.m1.1.1.2">subscript</csymbol><ci id="S4.Ex9.m1.1.1.2.2.cmml" xref="S4.Ex9.m1.1.1.2.2">𝒪</ci><ci id="S4.Ex9.m1.1.1.2.3a.cmml" xref="S4.Ex9.m1.1.1.2.3"><mtext id="S4.Ex9.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.Ex9.m1.1.1.2.3">Minimal</mtext></ci></apply><apply id="S4.Ex9.m1.1.1.3.cmml" xref="S4.Ex9.m1.1.1.3"><plus id="S4.Ex9.m1.1.1.3.1.cmml" xref="S4.Ex9.m1.1.1.3.1"></plus><apply id="S4.Ex9.m1.1.1.3.2.cmml" xref="S4.Ex9.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.2.1.cmml" xref="S4.Ex9.m1.1.1.3.2">subscript</csymbol><apply id="S4.Ex9.m1.1.1.3.2.2.cmml" xref="S4.Ex9.m1.1.1.3.2.2"><ci id="S4.Ex9.m1.1.1.3.2.2.1.cmml" xref="S4.Ex9.m1.1.1.3.2.2.1">⏟</ci><apply id="S4.Ex9.m1.1.1.3.2.2.2.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2"><ci id="S4.Ex9.m1.1.1.3.2.2.2.1.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.1">⋅</ci><apply id="S4.Ex9.m1.1.1.3.2.2.2.2.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.2">superscript</csymbol><ci id="S4.Ex9.m1.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.2.2">𝑃</ci><cn id="S4.Ex9.m1.1.1.3.2.2.2.2.3.cmml" type="integer" xref="S4.Ex9.m1.1.1.3.2.2.2.2.3">2</cn></apply><apply id="S4.Ex9.m1.1.1.3.2.2.2.3.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.2.2.2.3.1.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S4.Ex9.m1.1.1.3.2.2.2.3.2.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.3.2">𝑑</ci><ci id="S4.Ex9.m1.1.1.3.2.2.2.3.3a.cmml" xref="S4.Ex9.m1.1.1.3.2.2.2.3.3"><mtext id="S4.Ex9.m1.1.1.3.2.2.2.3.3.cmml" mathsize="70%" xref="S4.Ex9.m1.1.1.3.2.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S4.Ex9.m1.1.1.3.2.3a.cmml" xref="S4.Ex9.m1.1.1.3.2.3"><mtext id="S4.Ex9.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.Ex9.m1.1.1.3.2.3">Self-Attention</mtext></ci></apply><apply id="S4.Ex9.m1.1.1.3.3.cmml" xref="S4.Ex9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.3.1.cmml" xref="S4.Ex9.m1.1.1.3.3">subscript</csymbol><apply id="S4.Ex9.m1.1.1.3.3.2.cmml" xref="S4.Ex9.m1.1.1.3.3.2"><ci id="S4.Ex9.m1.1.1.3.3.2.1.cmml" xref="S4.Ex9.m1.1.1.3.3.2.1">⏟</ci><apply id="S4.Ex9.m1.1.1.3.3.2.2.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2"><ci id="S4.Ex9.m1.1.1.3.3.2.2.1.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.1">⋅</ci><ci id="S4.Ex9.m1.1.1.3.3.2.2.2.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.2">𝑃</ci><apply id="S4.Ex9.m1.1.1.3.3.2.2.3.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.3.2.2.3.1.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3">superscript</csymbol><apply id="S4.Ex9.m1.1.1.3.3.2.2.3.2.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.3.3.2.2.3.2.1.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S4.Ex9.m1.1.1.3.3.2.2.3.2.2.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3.2.2">𝑑</ci><ci id="S4.Ex9.m1.1.1.3.3.2.2.3.2.3a.cmml" xref="S4.Ex9.m1.1.1.3.3.2.2.3.2.3"><mtext id="S4.Ex9.m1.1.1.3.3.2.2.3.2.3.cmml" mathsize="70%" xref="S4.Ex9.m1.1.1.3.3.2.2.3.2.3">model</mtext></ci></apply><cn id="S4.Ex9.m1.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.1.1.3.3.2.2.3.3">2</cn></apply></apply></apply><ci id="S4.Ex9.m1.1.1.3.3.3a.cmml" xref="S4.Ex9.m1.1.1.3.3.3"><mtext id="S4.Ex9.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S4.Ex9.m1.1.1.3.3.3">Feedforward Layers</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.1c">\mathcal{O}_{\text{Minimal}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex9.m1.1d">caligraphic_O start_POSTSUBSCRIPT Minimal end_POSTSUBSCRIPT = under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Self-Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Feedforward Layers end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmremark1.1.1.1">Remark 1</span></span></h6>
<div class="ltx_para" id="Thmremark1.p1">
<p class="ltx_p" id="Thmremark1.p1.1"><span class="ltx_text ltx_font_italic" id="Thmremark1.p1.1.1">The primary difference between <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.1">PatchTST</span> Minimal and <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.2">Informer</span> Minimal lies in how they process time series data and the underlying architectural philosophy they follow. <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.3">PatchTST</span> Minimal adopts a patch-based approach where the input sequence is segmented into fixed-length patches, which are then embedded and processed by a Transformer encoder. This design focuses on capturing local patterns efficiently, reducing the input sequence length and computational complexity. In contrast, <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.4">Informer</span> Minimal follows a more conventional Transformer structure, directly operating on the full-resolution time series using positional encoding and self-attention across all time steps. This enables it to retain fine-grained temporal dependencies but can be more computationally intensive for long sequences. While <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.5">PatchTST</span> Minimal excels in modeling smooth, low-frequency patterns with fewer tokens, <span class="ltx_text ltx_font_typewriter" id="Thmremark1.p1.1.1.6">Informer</span> Minimal is better suited for capturing detailed, high-frequency dynamics in time series data.</span></p>
</div>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_typewriter" id="S4.SS2.1.1">Informer</span> Standard: ProbSparse Attention for Scalable Forecasting</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The Standard variant improves scalability by replacing full attention with a sparse approximation known as ProbSparse attention. This mechanism identifies a subset of “informative” queries and restricts attention to them.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Query Selection</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">For each query vector <math alttext="\mathbf{q}_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝐪</mi><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐪</ci><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">\mathbf{q}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, a sparsity score is computed:</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M(\mathbf{q}_{i})=\max_{j}\left(\frac{\mathbf{q}_{i}\cdot\mathbf{k}_{j}}{\sqrt%
{d_{\text{model}}}}\right)-\frac{1}{P}\sum_{j=1}^{P}\frac{\mathbf{q}_{i}\cdot%
\mathbf{k}_{j}}{\sqrt{d_{\text{model}}}}," class="ltx_Math" display="block" id="S4.E21.m1.2"><semantics id="S4.E21.m1.2a"><mrow id="S4.E21.m1.2.2.1" xref="S4.E21.m1.2.2.1.1.cmml"><mrow id="S4.E21.m1.2.2.1.1" xref="S4.E21.m1.2.2.1.1.cmml"><mrow id="S4.E21.m1.2.2.1.1.1" xref="S4.E21.m1.2.2.1.1.1.cmml"><mi id="S4.E21.m1.2.2.1.1.1.3" xref="S4.E21.m1.2.2.1.1.1.3.cmml">M</mi><mo id="S4.E21.m1.2.2.1.1.1.2" xref="S4.E21.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E21.m1.2.2.1.1.1.1.1" xref="S4.E21.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E21.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E21.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E21.m1.2.2.1.1.1.1.1.1" xref="S4.E21.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E21.m1.2.2.1.1.1.1.1.1.2" xref="S4.E21.m1.2.2.1.1.1.1.1.1.2.cmml">𝐪</mi><mi id="S4.E21.m1.2.2.1.1.1.1.1.1.3" xref="S4.E21.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E21.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E21.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.2.2.1.1.3" xref="S4.E21.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E21.m1.2.2.1.1.2" xref="S4.E21.m1.2.2.1.1.2.cmml"><mrow id="S4.E21.m1.2.2.1.1.2.1.1" xref="S4.E21.m1.2.2.1.1.2.1.2.cmml"><munder id="S4.E21.m1.2.2.1.1.2.1.1.1" xref="S4.E21.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S4.E21.m1.2.2.1.1.2.1.1.1.2" xref="S4.E21.m1.2.2.1.1.2.1.1.1.2.cmml">max</mi><mi id="S4.E21.m1.2.2.1.1.2.1.1.1.3" xref="S4.E21.m1.2.2.1.1.2.1.1.1.3.cmml">j</mi></munder><mo id="S4.E21.m1.2.2.1.1.2.1.1a" xref="S4.E21.m1.2.2.1.1.2.1.2.cmml">⁡</mo><mrow id="S4.E21.m1.2.2.1.1.2.1.1.2" xref="S4.E21.m1.2.2.1.1.2.1.2.cmml"><mo id="S4.E21.m1.2.2.1.1.2.1.1.2.1" xref="S4.E21.m1.2.2.1.1.2.1.2.cmml">(</mo><mfrac id="S4.E21.m1.1.1" xref="S4.E21.m1.1.1.cmml"><mrow id="S4.E21.m1.1.1.2" xref="S4.E21.m1.1.1.2.cmml"><msub id="S4.E21.m1.1.1.2.2" xref="S4.E21.m1.1.1.2.2.cmml"><mi id="S4.E21.m1.1.1.2.2.2" xref="S4.E21.m1.1.1.2.2.2.cmml">𝐪</mi><mi id="S4.E21.m1.1.1.2.2.3" xref="S4.E21.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E21.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E21.m1.1.1.2.1.cmml">⋅</mo><msub id="S4.E21.m1.1.1.2.3" xref="S4.E21.m1.1.1.2.3.cmml"><mi id="S4.E21.m1.1.1.2.3.2" xref="S4.E21.m1.1.1.2.3.2.cmml">𝐤</mi><mi id="S4.E21.m1.1.1.2.3.3" xref="S4.E21.m1.1.1.2.3.3.cmml">j</mi></msub></mrow><msqrt id="S4.E21.m1.1.1.3" xref="S4.E21.m1.1.1.3.cmml"><msub id="S4.E21.m1.1.1.3.2" xref="S4.E21.m1.1.1.3.2.cmml"><mi id="S4.E21.m1.1.1.3.2.2" xref="S4.E21.m1.1.1.3.2.2.cmml">d</mi><mtext id="S4.E21.m1.1.1.3.2.3" xref="S4.E21.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="S4.E21.m1.2.2.1.1.2.1.1.2.2" xref="S4.E21.m1.2.2.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.2.2.1.1.2.2" xref="S4.E21.m1.2.2.1.1.2.2.cmml">−</mo><mrow id="S4.E21.m1.2.2.1.1.2.3" xref="S4.E21.m1.2.2.1.1.2.3.cmml"><mfrac id="S4.E21.m1.2.2.1.1.2.3.2" xref="S4.E21.m1.2.2.1.1.2.3.2.cmml"><mn id="S4.E21.m1.2.2.1.1.2.3.2.2" xref="S4.E21.m1.2.2.1.1.2.3.2.2.cmml">1</mn><mi id="S4.E21.m1.2.2.1.1.2.3.2.3" xref="S4.E21.m1.2.2.1.1.2.3.2.3.cmml">P</mi></mfrac><mo id="S4.E21.m1.2.2.1.1.2.3.1" xref="S4.E21.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mrow id="S4.E21.m1.2.2.1.1.2.3.3" xref="S4.E21.m1.2.2.1.1.2.3.3.cmml"><munderover id="S4.E21.m1.2.2.1.1.2.3.3.1" xref="S4.E21.m1.2.2.1.1.2.3.3.1.cmml"><mo id="S4.E21.m1.2.2.1.1.2.3.3.1.2.2" movablelimits="false" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.cmml"><mi id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.2" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.2.cmml">j</mi><mo id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.1" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.3" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E21.m1.2.2.1.1.2.3.3.1.3" xref="S4.E21.m1.2.2.1.1.2.3.3.1.3.cmml">P</mi></munderover><mfrac id="S4.E21.m1.2.2.1.1.2.3.3.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.cmml"><mrow id="S4.E21.m1.2.2.1.1.2.3.3.2.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.cmml"><msub id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.cmml"><mi id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.2.cmml">𝐪</mi><mi id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.3" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S4.E21.m1.2.2.1.1.2.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.1.cmml">⋅</mo><msub id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.cmml"><mi id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.2.cmml">𝐤</mi><mi id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.3" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.3.cmml">j</mi></msub></mrow><msqrt id="S4.E21.m1.2.2.1.1.2.3.3.2.3" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.cmml"><msub id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.cmml"><mi id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.2" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.2.cmml">d</mi><mtext id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac></mrow></mrow></mrow></mrow><mo id="S4.E21.m1.2.2.1.2" xref="S4.E21.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E21.m1.2b"><apply id="S4.E21.m1.2.2.1.1.cmml" xref="S4.E21.m1.2.2.1"><eq id="S4.E21.m1.2.2.1.1.3.cmml" xref="S4.E21.m1.2.2.1.1.3"></eq><apply id="S4.E21.m1.2.2.1.1.1.cmml" xref="S4.E21.m1.2.2.1.1.1"><times id="S4.E21.m1.2.2.1.1.1.2.cmml" xref="S4.E21.m1.2.2.1.1.1.2"></times><ci id="S4.E21.m1.2.2.1.1.1.3.cmml" xref="S4.E21.m1.2.2.1.1.1.3">𝑀</ci><apply id="S4.E21.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E21.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E21.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E21.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.2.2.1.1.1.1.1.1.2">𝐪</ci><ci id="S4.E21.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E21.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E21.m1.2.2.1.1.2.cmml" xref="S4.E21.m1.2.2.1.1.2"><minus id="S4.E21.m1.2.2.1.1.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.2"></minus><apply id="S4.E21.m1.2.2.1.1.2.1.2.cmml" xref="S4.E21.m1.2.2.1.1.2.1.1"><apply id="S4.E21.m1.2.2.1.1.2.1.1.1.cmml" xref="S4.E21.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E21.m1.2.2.1.1.2.1.1.1">subscript</csymbol><max id="S4.E21.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S4.E21.m1.2.2.1.1.2.1.1.1.2"></max><ci id="S4.E21.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S4.E21.m1.2.2.1.1.2.1.1.1.3">𝑗</ci></apply><apply id="S4.E21.m1.1.1.cmml" xref="S4.E21.m1.1.1"><divide id="S4.E21.m1.1.1.1.cmml" xref="S4.E21.m1.1.1"></divide><apply id="S4.E21.m1.1.1.2.cmml" xref="S4.E21.m1.1.1.2"><ci id="S4.E21.m1.1.1.2.1.cmml" xref="S4.E21.m1.1.1.2.1">⋅</ci><apply id="S4.E21.m1.1.1.2.2.cmml" xref="S4.E21.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.2.2.1.cmml" xref="S4.E21.m1.1.1.2.2">subscript</csymbol><ci id="S4.E21.m1.1.1.2.2.2.cmml" xref="S4.E21.m1.1.1.2.2.2">𝐪</ci><ci id="S4.E21.m1.1.1.2.2.3.cmml" xref="S4.E21.m1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E21.m1.1.1.2.3.cmml" xref="S4.E21.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.2.3.1.cmml" xref="S4.E21.m1.1.1.2.3">subscript</csymbol><ci id="S4.E21.m1.1.1.2.3.2.cmml" xref="S4.E21.m1.1.1.2.3.2">𝐤</ci><ci id="S4.E21.m1.1.1.2.3.3.cmml" xref="S4.E21.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S4.E21.m1.1.1.3.cmml" xref="S4.E21.m1.1.1.3"><root id="S4.E21.m1.1.1.3a.cmml" xref="S4.E21.m1.1.1.3"></root><apply id="S4.E21.m1.1.1.3.2.cmml" xref="S4.E21.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.3.2.1.cmml" xref="S4.E21.m1.1.1.3.2">subscript</csymbol><ci id="S4.E21.m1.1.1.3.2.2.cmml" xref="S4.E21.m1.1.1.3.2.2">𝑑</ci><ci id="S4.E21.m1.1.1.3.2.3a.cmml" xref="S4.E21.m1.1.1.3.2.3"><mtext id="S4.E21.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E21.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply></apply><apply id="S4.E21.m1.2.2.1.1.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3"><times id="S4.E21.m1.2.2.1.1.2.3.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.1"></times><apply id="S4.E21.m1.2.2.1.1.2.3.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.2"><divide id="S4.E21.m1.2.2.1.1.2.3.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.2"></divide><cn id="S4.E21.m1.2.2.1.1.2.3.2.2.cmml" type="integer" xref="S4.E21.m1.2.2.1.1.2.3.2.2">1</cn><ci id="S4.E21.m1.2.2.1.1.2.3.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.2.3">𝑃</ci></apply><apply id="S4.E21.m1.2.2.1.1.2.3.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3"><apply id="S4.E21.m1.2.2.1.1.2.3.3.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.3.3.1.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1">superscript</csymbol><apply id="S4.E21.m1.2.2.1.1.2.3.3.1.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.3.3.1.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1">subscript</csymbol><sum id="S4.E21.m1.2.2.1.1.2.3.3.1.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.2"></sum><apply id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3"><eq id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.1"></eq><ci id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.2">𝑗</ci><cn id="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.E21.m1.2.2.1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E21.m1.2.2.1.1.2.3.3.1.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.1.3">𝑃</ci></apply><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2"><divide id="S4.E21.m1.2.2.1.1.2.3.3.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2"></divide><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2"><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.1">⋅</ci><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2">subscript</csymbol><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.2">𝐪</ci><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.2.3">𝑖</ci></apply><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3">subscript</csymbol><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.2">𝐤</ci><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.2.3.3">𝑗</ci></apply></apply><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.3.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3"><root id="S4.E21.m1.2.2.1.1.2.3.3.2.3a.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3"></root><apply id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.1.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2">subscript</csymbol><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.2.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.2">𝑑</ci><ci id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3a.cmml" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3"><mtext id="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3.cmml" mathsize="70%" xref="S4.E21.m1.2.2.1.1.2.3.3.2.3.2.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.2c">M(\mathbf{q}_{i})=\max_{j}\left(\frac{\mathbf{q}_{i}\cdot\mathbf{k}_{j}}{\sqrt%
{d_{\text{model}}}}\right)-\frac{1}{P}\sum_{j=1}^{P}\frac{\mathbf{q}_{i}\cdot%
\mathbf{k}_{j}}{\sqrt{d_{\text{model}}}},</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m1.2d">italic_M ( bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = roman_max start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( divide start_ARG bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) - divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT divide start_ARG bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.2">Only the top-<math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p3.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.1.m1.1d">italic_u</annotation></semantics></math> queries with the highest scores (where <math alttext="u=\mathcal{O}(\log P)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p3.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml">u</mi><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.3" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.3.cmml">𝒪</mi><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.1.cmml">log</mi><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1a" lspace="0.167em" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml">⁡</mo><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.2.cmml">P</mi></mrow><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1"><eq id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.2"></eq><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.3">𝑢</ci><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1"><times id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.3">𝒪</ci><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1"><log id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.1"></log><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.2">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.2.m2.1c">u=\mathcal{O}(\log P)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.2.m2.1d">italic_u = caligraphic_O ( roman_log italic_P )</annotation></semantics></math>) are selected to perform full attention over all keys.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Encoding</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">These selected queries are processed using the ProbSparse encoder:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx6">
<tbody id="S4.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S4.E22.m1.1"><semantics id="S4.E22.m1.1a"><msub id="S4.E22.m1.1.1" xref="S4.E22.m1.1.1.cmml"><mi id="S4.E22.m1.1.1.2" xref="S4.E22.m1.1.1.2.cmml">𝐡</mi><mi id="S4.E22.m1.1.1.3" xref="S4.E22.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E22.m1.1b"><apply id="S4.E22.m1.1.1.cmml" xref="S4.E22.m1.1.1"><csymbol cd="ambiguous" id="S4.E22.m1.1.1.1.cmml" xref="S4.E22.m1.1.1">subscript</csymbol><ci id="S4.E22.m1.1.1.2.cmml" xref="S4.E22.m1.1.1.2">𝐡</ci><ci id="S4.E22.m1.1.1.3.cmml" xref="S4.E22.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m1.1c">\displaystyle\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{ProbSparseEncoder}(\mathbf{z}_{i}^{\text{pos}})," class="ltx_Math" display="inline" id="S4.E22.m2.1"><semantics id="S4.E22.m2.1a"><mrow id="S4.E22.m2.1.1.1" xref="S4.E22.m2.1.1.1.1.cmml"><mrow id="S4.E22.m2.1.1.1.1" xref="S4.E22.m2.1.1.1.1.cmml"><mi id="S4.E22.m2.1.1.1.1.3" xref="S4.E22.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E22.m2.1.1.1.1.2" xref="S4.E22.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E22.m2.1.1.1.1.1" xref="S4.E22.m2.1.1.1.1.1.cmml"><mtext id="S4.E22.m2.1.1.1.1.1.3" xref="S4.E22.m2.1.1.1.1.1.3a.cmml">ProbSparseEncoder</mtext><mo id="S4.E22.m2.1.1.1.1.1.2" xref="S4.E22.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E22.m2.1.1.1.1.1.1.1" xref="S4.E22.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E22.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E22.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E22.m2.1.1.1.1.1.1.1.1" xref="S4.E22.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E22.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.E22.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E22.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.E22.m2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S4.E22.m2.1.1.1.1.1.1.1.1.3" xref="S4.E22.m2.1.1.1.1.1.1.1.1.3a.cmml">pos</mtext></msubsup><mo id="S4.E22.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E22.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E22.m2.1.1.1.2" xref="S4.E22.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E22.m2.1b"><apply id="S4.E22.m2.1.1.1.1.cmml" xref="S4.E22.m2.1.1.1"><eq id="S4.E22.m2.1.1.1.1.2.cmml" xref="S4.E22.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E22.m2.1.1.1.1.3.cmml" xref="S4.E22.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E22.m2.1.1.1.1.1.cmml" xref="S4.E22.m2.1.1.1.1.1"><times id="S4.E22.m2.1.1.1.1.1.2.cmml" xref="S4.E22.m2.1.1.1.1.1.2"></times><ci id="S4.E22.m2.1.1.1.1.1.3a.cmml" xref="S4.E22.m2.1.1.1.1.1.3"><mtext id="S4.E22.m2.1.1.1.1.1.3.cmml" xref="S4.E22.m2.1.1.1.1.1.3">ProbSparseEncoder</mtext></ci><apply id="S4.E22.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E22.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E22.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E22.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E22.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E22.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E22.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E22.m2.1.1.1.1.1.1.1.1.3"><mtext id="S4.E22.m2.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.E22.m2.1.1.1.1.1.1.1.1.3">pos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m2.1c">\displaystyle=\text{ProbSparseEncoder}(\mathbf{z}_{i}^{\text{pos}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m2.1d">= ProbSparseEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
<tbody id="S4.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{y}}_{i}" class="ltx_Math" display="inline" id="S4.E23.m1.1"><semantics id="S4.E23.m1.1a"><msub id="S4.E23.m1.1.1" xref="S4.E23.m1.1.1.cmml"><mover accent="true" id="S4.E23.m1.1.1.2" xref="S4.E23.m1.1.1.2.cmml"><mi id="S4.E23.m1.1.1.2.2" xref="S4.E23.m1.1.1.2.2.cmml">𝐲</mi><mo id="S4.E23.m1.1.1.2.1" xref="S4.E23.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E23.m1.1.1.3" xref="S4.E23.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E23.m1.1b"><apply id="S4.E23.m1.1.1.cmml" xref="S4.E23.m1.1.1"><csymbol cd="ambiguous" id="S4.E23.m1.1.1.1.cmml" xref="S4.E23.m1.1.1">subscript</csymbol><apply id="S4.E23.m1.1.1.2.cmml" xref="S4.E23.m1.1.1.2"><ci id="S4.E23.m1.1.1.2.1.cmml" xref="S4.E23.m1.1.1.2.1">^</ci><ci id="S4.E23.m1.1.1.2.2.cmml" xref="S4.E23.m1.1.1.2.2">𝐲</ci></apply><ci id="S4.E23.m1.1.1.3.cmml" xref="S4.E23.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m1.1c">\displaystyle\hat{\mathbf{y}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i})." class="ltx_Math" display="inline" id="S4.E23.m2.1"><semantics id="S4.E23.m2.1a"><mrow id="S4.E23.m2.1.1.1" xref="S4.E23.m2.1.1.1.1.cmml"><mrow id="S4.E23.m2.1.1.1.1" xref="S4.E23.m2.1.1.1.1.cmml"><mi id="S4.E23.m2.1.1.1.1.3" xref="S4.E23.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E23.m2.1.1.1.1.2" xref="S4.E23.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E23.m2.1.1.1.1.1" xref="S4.E23.m2.1.1.1.1.1.cmml"><mrow id="S4.E23.m2.1.1.1.1.1.3" xref="S4.E23.m2.1.1.1.1.1.3.cmml"><msub id="S4.E23.m2.1.1.1.1.1.3.2" xref="S4.E23.m2.1.1.1.1.1.3.2.cmml"><mi id="S4.E23.m2.1.1.1.1.1.3.2.2" xref="S4.E23.m2.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S4.E23.m2.1.1.1.1.1.3.2.3" xref="S4.E23.m2.1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S4.E23.m2.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E23.m2.1.1.1.1.1.3.1.cmml">⋅</mo><mtext id="S4.E23.m2.1.1.1.1.1.3.3" xref="S4.E23.m2.1.1.1.1.1.3.3a.cmml">AvgPool</mtext></mrow><mo id="S4.E23.m2.1.1.1.1.1.2" xref="S4.E23.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E23.m2.1.1.1.1.1.1.1" xref="S4.E23.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E23.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E23.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E23.m2.1.1.1.1.1.1.1.1" xref="S4.E23.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E23.m2.1.1.1.1.1.1.1.1.2" xref="S4.E23.m2.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.E23.m2.1.1.1.1.1.1.1.1.3" xref="S4.E23.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E23.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E23.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E23.m2.1.1.1.2" lspace="0em" xref="S4.E23.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E23.m2.1b"><apply id="S4.E23.m2.1.1.1.1.cmml" xref="S4.E23.m2.1.1.1"><eq id="S4.E23.m2.1.1.1.1.2.cmml" xref="S4.E23.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E23.m2.1.1.1.1.3.cmml" xref="S4.E23.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E23.m2.1.1.1.1.1.cmml" xref="S4.E23.m2.1.1.1.1.1"><times id="S4.E23.m2.1.1.1.1.1.2.cmml" xref="S4.E23.m2.1.1.1.1.1.2"></times><apply id="S4.E23.m2.1.1.1.1.1.3.cmml" xref="S4.E23.m2.1.1.1.1.1.3"><ci id="S4.E23.m2.1.1.1.1.1.3.1.cmml" xref="S4.E23.m2.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E23.m2.1.1.1.1.1.3.2.cmml" xref="S4.E23.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E23.m2.1.1.1.1.1.3.2.1.cmml" xref="S4.E23.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E23.m2.1.1.1.1.1.3.2.2.cmml" xref="S4.E23.m2.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S4.E23.m2.1.1.1.1.1.3.2.3.cmml" xref="S4.E23.m2.1.1.1.1.1.3.2.3">𝑜</ci></apply><ci id="S4.E23.m2.1.1.1.1.1.3.3a.cmml" xref="S4.E23.m2.1.1.1.1.1.3.3"><mtext id="S4.E23.m2.1.1.1.1.1.3.3.cmml" xref="S4.E23.m2.1.1.1.1.1.3.3">AvgPool</mtext></ci></apply><apply id="S4.E23.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E23.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E23.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E23.m2.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S4.E23.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E23.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m2.1c">\displaystyle=\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m2.1d">= bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ AvgPool ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p1">
<table class="ltx_equation ltx_eqn_table" id="S4.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Standard}}=\underbrace{\log P\cdot P\cdot d_{\text{model}}}%
_{\text{Sparse Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Feedforward Layers}}." class="ltx_Math" display="block" id="S4.Ex10.m1.1"><semantics id="S4.Ex10.m1.1a"><mrow id="S4.Ex10.m1.1.1.1" xref="S4.Ex10.m1.1.1.1.1.cmml"><mrow id="S4.Ex10.m1.1.1.1.1" xref="S4.Ex10.m1.1.1.1.1.cmml"><msub id="S4.Ex10.m1.1.1.1.1.2" xref="S4.Ex10.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex10.m1.1.1.1.1.2.2" xref="S4.Ex10.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S4.Ex10.m1.1.1.1.1.2.3" xref="S4.Ex10.m1.1.1.1.1.2.3a.cmml">Standard</mtext></msub><mo id="S4.Ex10.m1.1.1.1.1.1" xref="S4.Ex10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.Ex10.m1.1.1.1.1.3" xref="S4.Ex10.m1.1.1.1.1.3.cmml"><munder id="S4.Ex10.m1.1.1.1.1.3.2" xref="S4.Ex10.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S4.Ex10.m1.1.1.1.1.3.2.2" xref="S4.Ex10.m1.1.1.1.1.3.2.2.cmml"><mrow id="S4.Ex10.m1.1.1.1.1.3.2.2.2" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S4.Ex10.m1.1.1.1.1.3.2.2.2.1" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.1.cmml">log</mi><mo id="S4.Ex10.m1.1.1.1.1.3.2.2.2a" lspace="0.167em" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.cmml">⁡</mo><mrow id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.2" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.2.cmml">P</mi><mo id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1.cmml">⋅</mo><mi id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.3" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.3.cmml">P</mi><mo id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1.cmml">⋅</mo><msub id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.cmml"><mi id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.2" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.2.cmml">d</mi><mtext id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.Ex10.m1.1.1.1.1.3.2.2.1" xref="S4.Ex10.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex10.m1.1.1.1.1.3.2.3" xref="S4.Ex10.m1.1.1.1.1.3.2.3a.cmml">Sparse Attention</mtext></munder><mo id="S4.Ex10.m1.1.1.1.1.3.1" xref="S4.Ex10.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S4.Ex10.m1.1.1.1.1.3.3" xref="S4.Ex10.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S4.Ex10.m1.1.1.1.1.3.3.2" xref="S4.Ex10.m1.1.1.1.1.3.3.2.cmml"><mrow id="S4.Ex10.m1.1.1.1.1.3.3.2.2" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S4.Ex10.m1.1.1.1.1.3.3.2.2.2" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.2.cmml">P</mi><mo id="S4.Ex10.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msubsup id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.2" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.2.cmml">d</mi><mtext id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml">model</mtext><mn id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.3" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S4.Ex10.m1.1.1.1.1.3.3.2.1" xref="S4.Ex10.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex10.m1.1.1.1.1.3.3.3" xref="S4.Ex10.m1.1.1.1.1.3.3.3a.cmml">Feedforward Layers</mtext></munder></mrow></mrow><mo id="S4.Ex10.m1.1.1.1.2" lspace="0em" xref="S4.Ex10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex10.m1.1b"><apply id="S4.Ex10.m1.1.1.1.1.cmml" xref="S4.Ex10.m1.1.1.1"><eq id="S4.Ex10.m1.1.1.1.1.1.cmml" xref="S4.Ex10.m1.1.1.1.1.1"></eq><apply id="S4.Ex10.m1.1.1.1.1.2.cmml" xref="S4.Ex10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex10.m1.1.1.1.1.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.2.2">𝒪</ci><ci id="S4.Ex10.m1.1.1.1.1.2.3a.cmml" xref="S4.Ex10.m1.1.1.1.1.2.3"><mtext id="S4.Ex10.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.Ex10.m1.1.1.1.1.2.3">Standard</mtext></ci></apply><apply id="S4.Ex10.m1.1.1.1.1.3.cmml" xref="S4.Ex10.m1.1.1.1.1.3"><plus id="S4.Ex10.m1.1.1.1.1.3.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.1"></plus><apply id="S4.Ex10.m1.1.1.1.1.3.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.Ex10.m1.1.1.1.1.3.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2"><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S4.Ex10.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2"><log id="S4.Ex10.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.1"></log><apply id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2"><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.1">⋅</ci><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.2">𝑃</ci><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.3">𝑃</ci><apply id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4">subscript</csymbol><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.2">𝑑</ci><ci id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3a.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3"><mtext id="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3.cmml" mathsize="70%" xref="S4.Ex10.m1.1.1.1.1.3.2.2.2.2.4.3">model</mtext></ci></apply></apply></apply></apply><ci id="S4.Ex10.m1.1.1.1.1.3.2.3a.cmml" xref="S4.Ex10.m1.1.1.1.1.3.2.3"><mtext id="S4.Ex10.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.Ex10.m1.1.1.1.1.3.2.3">Sparse Attention</mtext></ci></apply><apply id="S4.Ex10.m1.1.1.1.1.3.3.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.3.3.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.Ex10.m1.1.1.1.1.3.3.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2"><ci id="S4.Ex10.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S4.Ex10.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2"><ci id="S4.Ex10.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.1">⋅</ci><ci id="S4.Ex10.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.2">𝑃</ci><apply id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3">superscript</csymbol><apply id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.1.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.2.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.2">𝑑</ci><ci id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3"><mtext id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3.cmml" mathsize="70%" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.2.3">model</mtext></ci></apply><cn id="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S4.Ex10.m1.1.1.1.1.3.3.2.2.3.3">2</cn></apply></apply></apply><ci id="S4.Ex10.m1.1.1.1.1.3.3.3a.cmml" xref="S4.Ex10.m1.1.1.1.1.3.3.3"><mtext id="S4.Ex10.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S4.Ex10.m1.1.1.1.1.3.3.3">Feedforward Layers</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex10.m1.1c">\mathcal{O}_{\text{Standard}}=\underbrace{\log P\cdot P\cdot d_{\text{model}}}%
_{\text{Sparse Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{%
Feedforward Layers}}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex10.m1.1d">caligraphic_O start_POSTSUBSCRIPT Standard end_POSTSUBSCRIPT = under⏟ start_ARG roman_log italic_P ⋅ italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Sparse Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Feedforward Layers end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p2.1">This represents a significant improvement over the quadratic complexity of the Minimal variant.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_typewriter" id="S4.SS3.1.1">Informer</span> Full: Sequence-to-Sequence Architecture with Dual Attention</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The Full variant extends <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p1.1.1">Informer</span> into a full encoder-decoder architecture. Both the encoder and decoder employ ProbSparse attention, enabling modeling of long-range dependencies in both input and output sequences.</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Encoder</h5>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx7">
<tbody id="S4.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}^{(e)}" class="ltx_Math" display="inline" id="S4.E24.m1.1"><semantics id="S4.E24.m1.1a"><msubsup id="S4.E24.m1.1.2" xref="S4.E24.m1.1.2.cmml"><mi id="S4.E24.m1.1.2.2.2" xref="S4.E24.m1.1.2.2.2.cmml">𝐳</mi><mi id="S4.E24.m1.1.2.2.3" xref="S4.E24.m1.1.2.2.3.cmml">i</mi><mrow id="S4.E24.m1.1.1.1.3" xref="S4.E24.m1.1.2.cmml"><mo id="S4.E24.m1.1.1.1.3.1" stretchy="false" xref="S4.E24.m1.1.2.cmml">(</mo><mi id="S4.E24.m1.1.1.1.1" xref="S4.E24.m1.1.1.1.1.cmml">e</mi><mo id="S4.E24.m1.1.1.1.3.2" stretchy="false" xref="S4.E24.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E24.m1.1b"><apply id="S4.E24.m1.1.2.cmml" xref="S4.E24.m1.1.2"><csymbol cd="ambiguous" id="S4.E24.m1.1.2.1.cmml" xref="S4.E24.m1.1.2">superscript</csymbol><apply id="S4.E24.m1.1.2.2.cmml" xref="S4.E24.m1.1.2"><csymbol cd="ambiguous" id="S4.E24.m1.1.2.2.1.cmml" xref="S4.E24.m1.1.2">subscript</csymbol><ci id="S4.E24.m1.1.2.2.2.cmml" xref="S4.E24.m1.1.2.2.2">𝐳</ci><ci id="S4.E24.m1.1.2.2.3.cmml" xref="S4.E24.m1.1.2.2.3">𝑖</ci></apply><ci id="S4.E24.m1.1.1.1.1.cmml" xref="S4.E24.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m1.1c">\displaystyle\mathbf{z}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}," class="ltx_Math" display="inline" id="S4.E24.m2.3"><semantics id="S4.E24.m2.3a"><mrow id="S4.E24.m2.3.3.1" xref="S4.E24.m2.3.3.1.1.cmml"><mrow id="S4.E24.m2.3.3.1.1" xref="S4.E24.m2.3.3.1.1.cmml"><mi id="S4.E24.m2.3.3.1.1.2" xref="S4.E24.m2.3.3.1.1.2.cmml"></mi><mo id="S4.E24.m2.3.3.1.1.1" xref="S4.E24.m2.3.3.1.1.1.cmml">=</mo><mrow id="S4.E24.m2.3.3.1.1.3" xref="S4.E24.m2.3.3.1.1.3.cmml"><mrow id="S4.E24.m2.3.3.1.1.3.2" xref="S4.E24.m2.3.3.1.1.3.2.cmml"><msub id="S4.E24.m2.3.3.1.1.3.2.2" xref="S4.E24.m2.3.3.1.1.3.2.2.cmml"><mi id="S4.E24.m2.3.3.1.1.3.2.2.2" xref="S4.E24.m2.3.3.1.1.3.2.2.2.cmml">𝐱</mi><mi id="S4.E24.m2.3.3.1.1.3.2.2.3" xref="S4.E24.m2.3.3.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S4.E24.m2.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E24.m2.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S4.E24.m2.3.3.1.1.3.2.3" xref="S4.E24.m2.3.3.1.1.3.2.3.cmml"><mi id="S4.E24.m2.3.3.1.1.3.2.3.2.2" xref="S4.E24.m2.3.3.1.1.3.2.3.2.2.cmml">𝐖</mi><mi id="S4.E24.m2.3.3.1.1.3.2.3.2.3" xref="S4.E24.m2.3.3.1.1.3.2.3.2.3.cmml">e</mi><mrow id="S4.E24.m2.1.1.1.3" xref="S4.E24.m2.3.3.1.1.3.2.3.cmml"><mo id="S4.E24.m2.1.1.1.3.1" stretchy="false" xref="S4.E24.m2.3.3.1.1.3.2.3.cmml">(</mo><mi id="S4.E24.m2.1.1.1.1" xref="S4.E24.m2.1.1.1.1.cmml">e</mi><mo id="S4.E24.m2.1.1.1.3.2" stretchy="false" xref="S4.E24.m2.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E24.m2.3.3.1.1.3.1" xref="S4.E24.m2.3.3.1.1.3.1.cmml">+</mo><msup id="S4.E24.m2.3.3.1.1.3.3" xref="S4.E24.m2.3.3.1.1.3.3.cmml"><mtext id="S4.E24.m2.3.3.1.1.3.3.2" xref="S4.E24.m2.3.3.1.1.3.3.2a.cmml">PE</mtext><mrow id="S4.E24.m2.2.2.1.3" xref="S4.E24.m2.3.3.1.1.3.3.cmml"><mo id="S4.E24.m2.2.2.1.3.1" stretchy="false" xref="S4.E24.m2.3.3.1.1.3.3.cmml">(</mo><mi id="S4.E24.m2.2.2.1.1" xref="S4.E24.m2.2.2.1.1.cmml">e</mi><mo id="S4.E24.m2.2.2.1.3.2" stretchy="false" xref="S4.E24.m2.3.3.1.1.3.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S4.E24.m2.3.3.1.2" xref="S4.E24.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E24.m2.3b"><apply id="S4.E24.m2.3.3.1.1.cmml" xref="S4.E24.m2.3.3.1"><eq id="S4.E24.m2.3.3.1.1.1.cmml" xref="S4.E24.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S4.E24.m2.3.3.1.1.2.cmml" xref="S4.E24.m2.3.3.1.1.2">absent</csymbol><apply id="S4.E24.m2.3.3.1.1.3.cmml" xref="S4.E24.m2.3.3.1.1.3"><plus id="S4.E24.m2.3.3.1.1.3.1.cmml" xref="S4.E24.m2.3.3.1.1.3.1"></plus><apply id="S4.E24.m2.3.3.1.1.3.2.cmml" xref="S4.E24.m2.3.3.1.1.3.2"><ci id="S4.E24.m2.3.3.1.1.3.2.1.cmml" xref="S4.E24.m2.3.3.1.1.3.2.1">⋅</ci><apply id="S4.E24.m2.3.3.1.1.3.2.2.cmml" xref="S4.E24.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E24.m2.3.3.1.1.3.2.2.1.cmml" xref="S4.E24.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S4.E24.m2.3.3.1.1.3.2.2.2.cmml" xref="S4.E24.m2.3.3.1.1.3.2.2.2">𝐱</ci><ci id="S4.E24.m2.3.3.1.1.3.2.2.3.cmml" xref="S4.E24.m2.3.3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E24.m2.3.3.1.1.3.2.3.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E24.m2.3.3.1.1.3.2.3.1.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3">superscript</csymbol><apply id="S4.E24.m2.3.3.1.1.3.2.3.2.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E24.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3">subscript</csymbol><ci id="S4.E24.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3.2.2">𝐖</ci><ci id="S4.E24.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S4.E24.m2.3.3.1.1.3.2.3.2.3">𝑒</ci></apply><ci id="S4.E24.m2.1.1.1.1.cmml" xref="S4.E24.m2.1.1.1.1">𝑒</ci></apply></apply><apply id="S4.E24.m2.3.3.1.1.3.3.cmml" xref="S4.E24.m2.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E24.m2.3.3.1.1.3.3.1.cmml" xref="S4.E24.m2.3.3.1.1.3.3">superscript</csymbol><ci id="S4.E24.m2.3.3.1.1.3.3.2a.cmml" xref="S4.E24.m2.3.3.1.1.3.3.2"><mtext id="S4.E24.m2.3.3.1.1.3.3.2.cmml" xref="S4.E24.m2.3.3.1.1.3.3.2">PE</mtext></ci><ci id="S4.E24.m2.2.2.1.1.cmml" xref="S4.E24.m2.2.2.1.1">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m2.3c">\displaystyle=\mathbf{x}_{i}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)},</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m2.3d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="S4.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(e)}" class="ltx_Math" display="inline" id="S4.E25.m1.1"><semantics id="S4.E25.m1.1a"><msubsup id="S4.E25.m1.1.2" xref="S4.E25.m1.1.2.cmml"><mi id="S4.E25.m1.1.2.2.2" xref="S4.E25.m1.1.2.2.2.cmml">𝐇</mi><mi id="S4.E25.m1.1.2.2.3" xref="S4.E25.m1.1.2.2.3.cmml">i</mi><mrow id="S4.E25.m1.1.1.1.3" xref="S4.E25.m1.1.2.cmml"><mo id="S4.E25.m1.1.1.1.3.1" stretchy="false" xref="S4.E25.m1.1.2.cmml">(</mo><mi id="S4.E25.m1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.cmml">e</mi><mo id="S4.E25.m1.1.1.1.3.2" stretchy="false" xref="S4.E25.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E25.m1.1b"><apply id="S4.E25.m1.1.2.cmml" xref="S4.E25.m1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.2.1.cmml" xref="S4.E25.m1.1.2">superscript</csymbol><apply id="S4.E25.m1.1.2.2.cmml" xref="S4.E25.m1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.2.2.1.cmml" xref="S4.E25.m1.1.2">subscript</csymbol><ci id="S4.E25.m1.1.2.2.2.cmml" xref="S4.E25.m1.1.2.2.2">𝐇</ci><ci id="S4.E25.m1.1.2.2.3.cmml" xref="S4.E25.m1.1.2.2.3">𝑖</ci></apply><ci id="S4.E25.m1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m1.1c">\displaystyle\mathbf{H}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{ProbSparseEncoder}(\mathbf{z}_{i}^{(e)})." class="ltx_Math" display="inline" id="S4.E25.m2.2"><semantics id="S4.E25.m2.2a"><mrow id="S4.E25.m2.2.2.1" xref="S4.E25.m2.2.2.1.1.cmml"><mrow id="S4.E25.m2.2.2.1.1" xref="S4.E25.m2.2.2.1.1.cmml"><mi id="S4.E25.m2.2.2.1.1.3" xref="S4.E25.m2.2.2.1.1.3.cmml"></mi><mo id="S4.E25.m2.2.2.1.1.2" xref="S4.E25.m2.2.2.1.1.2.cmml">=</mo><mrow id="S4.E25.m2.2.2.1.1.1" xref="S4.E25.m2.2.2.1.1.1.cmml"><mtext id="S4.E25.m2.2.2.1.1.1.3" xref="S4.E25.m2.2.2.1.1.1.3a.cmml">ProbSparseEncoder</mtext><mo id="S4.E25.m2.2.2.1.1.1.2" xref="S4.E25.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E25.m2.2.2.1.1.1.1.1" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E25.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E25.m2.2.2.1.1.1.1.1.1" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E25.m2.2.2.1.1.1.1.1.1.2.2" xref="S4.E25.m2.2.2.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E25.m2.2.2.1.1.1.1.1.1.2.3" xref="S4.E25.m2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S4.E25.m2.1.1.1.3" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E25.m2.1.1.1.3.1" stretchy="false" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E25.m2.1.1.1.1" xref="S4.E25.m2.1.1.1.1.cmml">e</mi><mo id="S4.E25.m2.1.1.1.3.2" stretchy="false" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E25.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E25.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E25.m2.2.2.1.2" lspace="0em" xref="S4.E25.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E25.m2.2b"><apply id="S4.E25.m2.2.2.1.1.cmml" xref="S4.E25.m2.2.2.1"><eq id="S4.E25.m2.2.2.1.1.2.cmml" xref="S4.E25.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S4.E25.m2.2.2.1.1.3.cmml" xref="S4.E25.m2.2.2.1.1.3">absent</csymbol><apply id="S4.E25.m2.2.2.1.1.1.cmml" xref="S4.E25.m2.2.2.1.1.1"><times id="S4.E25.m2.2.2.1.1.1.2.cmml" xref="S4.E25.m2.2.2.1.1.1.2"></times><ci id="S4.E25.m2.2.2.1.1.1.3a.cmml" xref="S4.E25.m2.2.2.1.1.1.3"><mtext id="S4.E25.m2.2.2.1.1.1.3.cmml" xref="S4.E25.m2.2.2.1.1.1.3">ProbSparseEncoder</mtext></ci><apply id="S4.E25.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E25.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E25.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E25.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E25.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E25.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E25.m2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E25.m2.1.1.1.1.cmml" xref="S4.E25.m2.1.1.1.1">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m2.2c">\displaystyle=\text{ProbSparseEncoder}(\mathbf{z}_{i}^{(e)}).</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m2.2d">= ProbSparseEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Decoder</h5>
<div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx8">
<tbody id="S4.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{i}^{\text{rep}}" class="ltx_Math" display="inline" id="S4.E26.m1.1"><semantics id="S4.E26.m1.1a"><msubsup id="S4.E26.m1.1.1" xref="S4.E26.m1.1.1.cmml"><mi id="S4.E26.m1.1.1.2.2" xref="S4.E26.m1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E26.m1.1.1.2.3" xref="S4.E26.m1.1.1.2.3.cmml">i</mi><mtext id="S4.E26.m1.1.1.3" xref="S4.E26.m1.1.1.3a.cmml">rep</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.E26.m1.1b"><apply id="S4.E26.m1.1.1.cmml" xref="S4.E26.m1.1.1"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.1.cmml" xref="S4.E26.m1.1.1">superscript</csymbol><apply id="S4.E26.m1.1.1.2.cmml" xref="S4.E26.m1.1.1"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.2.1.cmml" xref="S4.E26.m1.1.1">subscript</csymbol><ci id="S4.E26.m1.1.1.2.2.cmml" xref="S4.E26.m1.1.1.2.2">𝐱</ci><ci id="S4.E26.m1.1.1.2.3.cmml" xref="S4.E26.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.E26.m1.1.1.3a.cmml" xref="S4.E26.m1.1.1.3"><mtext id="S4.E26.m1.1.1.3.cmml" mathsize="70%" xref="S4.E26.m1.1.1.3">rep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m1.1c">\displaystyle\mathbf{x}_{i}^{\text{rep}}</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[x_{i+P-1},\dots,x_{i+P-1}]\in\mathbb{R}^{H}," class="ltx_Math" display="inline" id="S4.E26.m2.2"><semantics id="S4.E26.m2.2a"><mrow id="S4.E26.m2.2.2.1" xref="S4.E26.m2.2.2.1.1.cmml"><mrow id="S4.E26.m2.2.2.1.1" xref="S4.E26.m2.2.2.1.1.cmml"><mi id="S4.E26.m2.2.2.1.1.4" xref="S4.E26.m2.2.2.1.1.4.cmml"></mi><mo id="S4.E26.m2.2.2.1.1.5" xref="S4.E26.m2.2.2.1.1.5.cmml">=</mo><mrow id="S4.E26.m2.2.2.1.1.2.2" xref="S4.E26.m2.2.2.1.1.2.3.cmml"><mo id="S4.E26.m2.2.2.1.1.2.2.3" stretchy="false" xref="S4.E26.m2.2.2.1.1.2.3.cmml">[</mo><msub id="S4.E26.m2.2.2.1.1.1.1.1" xref="S4.E26.m2.2.2.1.1.1.1.1.cmml"><mi id="S4.E26.m2.2.2.1.1.1.1.1.2" xref="S4.E26.m2.2.2.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E26.m2.2.2.1.1.1.1.1.3" xref="S4.E26.m2.2.2.1.1.1.1.1.3.cmml"><mrow id="S4.E26.m2.2.2.1.1.1.1.1.3.2" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.cmml"><mi id="S4.E26.m2.2.2.1.1.1.1.1.3.2.2" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.2.cmml">i</mi><mo id="S4.E26.m2.2.2.1.1.1.1.1.3.2.1" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.1.cmml">+</mo><mi id="S4.E26.m2.2.2.1.1.1.1.1.3.2.3" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.3.cmml">P</mi></mrow><mo id="S4.E26.m2.2.2.1.1.1.1.1.3.1" xref="S4.E26.m2.2.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E26.m2.2.2.1.1.1.1.1.3.3" xref="S4.E26.m2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E26.m2.2.2.1.1.2.2.4" xref="S4.E26.m2.2.2.1.1.2.3.cmml">,</mo><mi id="S4.E26.m2.1.1" mathvariant="normal" xref="S4.E26.m2.1.1.cmml">…</mi><mo id="S4.E26.m2.2.2.1.1.2.2.5" xref="S4.E26.m2.2.2.1.1.2.3.cmml">,</mo><msub id="S4.E26.m2.2.2.1.1.2.2.2" xref="S4.E26.m2.2.2.1.1.2.2.2.cmml"><mi id="S4.E26.m2.2.2.1.1.2.2.2.2" xref="S4.E26.m2.2.2.1.1.2.2.2.2.cmml">x</mi><mrow id="S4.E26.m2.2.2.1.1.2.2.2.3" xref="S4.E26.m2.2.2.1.1.2.2.2.3.cmml"><mrow id="S4.E26.m2.2.2.1.1.2.2.2.3.2" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.cmml"><mi id="S4.E26.m2.2.2.1.1.2.2.2.3.2.2" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.2.cmml">i</mi><mo id="S4.E26.m2.2.2.1.1.2.2.2.3.2.1" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.1.cmml">+</mo><mi id="S4.E26.m2.2.2.1.1.2.2.2.3.2.3" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.3.cmml">P</mi></mrow><mo id="S4.E26.m2.2.2.1.1.2.2.2.3.1" xref="S4.E26.m2.2.2.1.1.2.2.2.3.1.cmml">−</mo><mn id="S4.E26.m2.2.2.1.1.2.2.2.3.3" xref="S4.E26.m2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E26.m2.2.2.1.1.2.2.6" stretchy="false" xref="S4.E26.m2.2.2.1.1.2.3.cmml">]</mo></mrow><mo id="S4.E26.m2.2.2.1.1.6" xref="S4.E26.m2.2.2.1.1.6.cmml">∈</mo><msup id="S4.E26.m2.2.2.1.1.7" xref="S4.E26.m2.2.2.1.1.7.cmml"><mi id="S4.E26.m2.2.2.1.1.7.2" xref="S4.E26.m2.2.2.1.1.7.2.cmml">ℝ</mi><mi id="S4.E26.m2.2.2.1.1.7.3" xref="S4.E26.m2.2.2.1.1.7.3.cmml">H</mi></msup></mrow><mo id="S4.E26.m2.2.2.1.2" xref="S4.E26.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E26.m2.2b"><apply id="S4.E26.m2.2.2.1.1.cmml" xref="S4.E26.m2.2.2.1"><and id="S4.E26.m2.2.2.1.1a.cmml" xref="S4.E26.m2.2.2.1"></and><apply id="S4.E26.m2.2.2.1.1b.cmml" xref="S4.E26.m2.2.2.1"><eq id="S4.E26.m2.2.2.1.1.5.cmml" xref="S4.E26.m2.2.2.1.1.5"></eq><csymbol cd="latexml" id="S4.E26.m2.2.2.1.1.4.cmml" xref="S4.E26.m2.2.2.1.1.4">absent</csymbol><list id="S4.E26.m2.2.2.1.1.2.3.cmml" xref="S4.E26.m2.2.2.1.1.2.2"><apply id="S4.E26.m2.2.2.1.1.1.1.1.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E26.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E26.m2.2.2.1.1.1.1.1.2.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.2">𝑥</ci><apply id="S4.E26.m2.2.2.1.1.1.1.1.3.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3"><minus id="S4.E26.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3.1"></minus><apply id="S4.E26.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2"><plus id="S4.E26.m2.2.2.1.1.1.1.1.3.2.1.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.1"></plus><ci id="S4.E26.m2.2.2.1.1.1.1.1.3.2.2.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.2">𝑖</ci><ci id="S4.E26.m2.2.2.1.1.1.1.1.3.2.3.cmml" xref="S4.E26.m2.2.2.1.1.1.1.1.3.2.3">𝑃</ci></apply><cn id="S4.E26.m2.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E26.m2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E26.m2.1.1.cmml" xref="S4.E26.m2.1.1">…</ci><apply id="S4.E26.m2.2.2.1.1.2.2.2.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E26.m2.2.2.1.1.2.2.2.1.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S4.E26.m2.2.2.1.1.2.2.2.2.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.2">𝑥</ci><apply id="S4.E26.m2.2.2.1.1.2.2.2.3.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3"><minus id="S4.E26.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3.1"></minus><apply id="S4.E26.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2"><plus id="S4.E26.m2.2.2.1.1.2.2.2.3.2.1.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.1"></plus><ci id="S4.E26.m2.2.2.1.1.2.2.2.3.2.2.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.2">𝑖</ci><ci id="S4.E26.m2.2.2.1.1.2.2.2.3.2.3.cmml" xref="S4.E26.m2.2.2.1.1.2.2.2.3.2.3">𝑃</ci></apply><cn id="S4.E26.m2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E26.m2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S4.E26.m2.2.2.1.1c.cmml" xref="S4.E26.m2.2.2.1"><in id="S4.E26.m2.2.2.1.1.6.cmml" xref="S4.E26.m2.2.2.1.1.6"></in><share href="https://arxiv.org/html/2505.20048v1#S4.E26.m2.2.2.1.1.2.cmml" id="S4.E26.m2.2.2.1.1d.cmml" xref="S4.E26.m2.2.2.1"></share><apply id="S4.E26.m2.2.2.1.1.7.cmml" xref="S4.E26.m2.2.2.1.1.7"><csymbol cd="ambiguous" id="S4.E26.m2.2.2.1.1.7.1.cmml" xref="S4.E26.m2.2.2.1.1.7">superscript</csymbol><ci id="S4.E26.m2.2.2.1.1.7.2.cmml" xref="S4.E26.m2.2.2.1.1.7.2">ℝ</ci><ci id="S4.E26.m2.2.2.1.1.7.3.cmml" xref="S4.E26.m2.2.2.1.1.7.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m2.2c">\displaystyle=[x_{i+P-1},\dots,x_{i+P-1}]\in\mathbb{R}^{H},</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m2.2d">= [ italic_x start_POSTSUBSCRIPT italic_i + italic_P - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i + italic_P - 1 end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
<tbody id="S4.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}^{(d)}" class="ltx_Math" display="inline" id="S4.E27.m1.1"><semantics id="S4.E27.m1.1a"><msubsup id="S4.E27.m1.1.2" xref="S4.E27.m1.1.2.cmml"><mi id="S4.E27.m1.1.2.2.2" xref="S4.E27.m1.1.2.2.2.cmml">𝐳</mi><mi id="S4.E27.m1.1.2.2.3" xref="S4.E27.m1.1.2.2.3.cmml">i</mi><mrow id="S4.E27.m1.1.1.1.3" xref="S4.E27.m1.1.2.cmml"><mo id="S4.E27.m1.1.1.1.3.1" stretchy="false" xref="S4.E27.m1.1.2.cmml">(</mo><mi id="S4.E27.m1.1.1.1.1" xref="S4.E27.m1.1.1.1.1.cmml">d</mi><mo id="S4.E27.m1.1.1.1.3.2" stretchy="false" xref="S4.E27.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E27.m1.1b"><apply id="S4.E27.m1.1.2.cmml" xref="S4.E27.m1.1.2"><csymbol cd="ambiguous" id="S4.E27.m1.1.2.1.cmml" xref="S4.E27.m1.1.2">superscript</csymbol><apply id="S4.E27.m1.1.2.2.cmml" xref="S4.E27.m1.1.2"><csymbol cd="ambiguous" id="S4.E27.m1.1.2.2.1.cmml" xref="S4.E27.m1.1.2">subscript</csymbol><ci id="S4.E27.m1.1.2.2.2.cmml" xref="S4.E27.m1.1.2.2.2">𝐳</ci><ci id="S4.E27.m1.1.2.2.3.cmml" xref="S4.E27.m1.1.2.2.3">𝑖</ci></apply><ci id="S4.E27.m1.1.1.1.1.cmml" xref="S4.E27.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m1.1c">\displaystyle\mathbf{z}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text{PE}^{%
(d)}," class="ltx_Math" display="inline" id="S4.E27.m2.3"><semantics id="S4.E27.m2.3a"><mrow id="S4.E27.m2.3.3.1" xref="S4.E27.m2.3.3.1.1.cmml"><mrow id="S4.E27.m2.3.3.1.1" xref="S4.E27.m2.3.3.1.1.cmml"><mi id="S4.E27.m2.3.3.1.1.2" xref="S4.E27.m2.3.3.1.1.2.cmml"></mi><mo id="S4.E27.m2.3.3.1.1.1" xref="S4.E27.m2.3.3.1.1.1.cmml">=</mo><mrow id="S4.E27.m2.3.3.1.1.3" xref="S4.E27.m2.3.3.1.1.3.cmml"><mrow id="S4.E27.m2.3.3.1.1.3.2" xref="S4.E27.m2.3.3.1.1.3.2.cmml"><msubsup id="S4.E27.m2.3.3.1.1.3.2.2" xref="S4.E27.m2.3.3.1.1.3.2.2.cmml"><mi id="S4.E27.m2.3.3.1.1.3.2.2.2.2" xref="S4.E27.m2.3.3.1.1.3.2.2.2.2.cmml">𝐱</mi><mi id="S4.E27.m2.3.3.1.1.3.2.2.2.3" xref="S4.E27.m2.3.3.1.1.3.2.2.2.3.cmml">i</mi><mtext id="S4.E27.m2.3.3.1.1.3.2.2.3" xref="S4.E27.m2.3.3.1.1.3.2.2.3a.cmml">rep</mtext></msubsup><mo id="S4.E27.m2.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E27.m2.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S4.E27.m2.3.3.1.1.3.2.3" xref="S4.E27.m2.3.3.1.1.3.2.3.cmml"><mi id="S4.E27.m2.3.3.1.1.3.2.3.2.2" xref="S4.E27.m2.3.3.1.1.3.2.3.2.2.cmml">𝐖</mi><mi id="S4.E27.m2.3.3.1.1.3.2.3.2.3" xref="S4.E27.m2.3.3.1.1.3.2.3.2.3.cmml">e</mi><mrow id="S4.E27.m2.1.1.1.3" xref="S4.E27.m2.3.3.1.1.3.2.3.cmml"><mo id="S4.E27.m2.1.1.1.3.1" stretchy="false" xref="S4.E27.m2.3.3.1.1.3.2.3.cmml">(</mo><mi id="S4.E27.m2.1.1.1.1" xref="S4.E27.m2.1.1.1.1.cmml">d</mi><mo id="S4.E27.m2.1.1.1.3.2" stretchy="false" xref="S4.E27.m2.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E27.m2.3.3.1.1.3.1" xref="S4.E27.m2.3.3.1.1.3.1.cmml">+</mo><msup id="S4.E27.m2.3.3.1.1.3.3" xref="S4.E27.m2.3.3.1.1.3.3.cmml"><mtext id="S4.E27.m2.3.3.1.1.3.3.2" xref="S4.E27.m2.3.3.1.1.3.3.2a.cmml">PE</mtext><mrow id="S4.E27.m2.2.2.1.3" xref="S4.E27.m2.3.3.1.1.3.3.cmml"><mo id="S4.E27.m2.2.2.1.3.1" stretchy="false" xref="S4.E27.m2.3.3.1.1.3.3.cmml">(</mo><mi id="S4.E27.m2.2.2.1.1" xref="S4.E27.m2.2.2.1.1.cmml">d</mi><mo id="S4.E27.m2.2.2.1.3.2" stretchy="false" xref="S4.E27.m2.3.3.1.1.3.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S4.E27.m2.3.3.1.2" xref="S4.E27.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E27.m2.3b"><apply id="S4.E27.m2.3.3.1.1.cmml" xref="S4.E27.m2.3.3.1"><eq id="S4.E27.m2.3.3.1.1.1.cmml" xref="S4.E27.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S4.E27.m2.3.3.1.1.2.cmml" xref="S4.E27.m2.3.3.1.1.2">absent</csymbol><apply id="S4.E27.m2.3.3.1.1.3.cmml" xref="S4.E27.m2.3.3.1.1.3"><plus id="S4.E27.m2.3.3.1.1.3.1.cmml" xref="S4.E27.m2.3.3.1.1.3.1"></plus><apply id="S4.E27.m2.3.3.1.1.3.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2"><ci id="S4.E27.m2.3.3.1.1.3.2.1.cmml" xref="S4.E27.m2.3.3.1.1.3.2.1">⋅</ci><apply id="S4.E27.m2.3.3.1.1.3.2.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E27.m2.3.3.1.1.3.2.2.1.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2">superscript</csymbol><apply id="S4.E27.m2.3.3.1.1.3.2.2.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E27.m2.3.3.1.1.3.2.2.2.1.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S4.E27.m2.3.3.1.1.3.2.2.2.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2.2.2">𝐱</ci><ci id="S4.E27.m2.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S4.E27.m2.3.3.1.1.3.2.2.3a.cmml" xref="S4.E27.m2.3.3.1.1.3.2.2.3"><mtext id="S4.E27.m2.3.3.1.1.3.2.2.3.cmml" mathsize="70%" xref="S4.E27.m2.3.3.1.1.3.2.2.3">rep</mtext></ci></apply><apply id="S4.E27.m2.3.3.1.1.3.2.3.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E27.m2.3.3.1.1.3.2.3.1.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3">superscript</csymbol><apply id="S4.E27.m2.3.3.1.1.3.2.3.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E27.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3">subscript</csymbol><ci id="S4.E27.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3.2.2">𝐖</ci><ci id="S4.E27.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S4.E27.m2.3.3.1.1.3.2.3.2.3">𝑒</ci></apply><ci id="S4.E27.m2.1.1.1.1.cmml" xref="S4.E27.m2.1.1.1.1">𝑑</ci></apply></apply><apply id="S4.E27.m2.3.3.1.1.3.3.cmml" xref="S4.E27.m2.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E27.m2.3.3.1.1.3.3.1.cmml" xref="S4.E27.m2.3.3.1.1.3.3">superscript</csymbol><ci id="S4.E27.m2.3.3.1.1.3.3.2a.cmml" xref="S4.E27.m2.3.3.1.1.3.3.2"><mtext id="S4.E27.m2.3.3.1.1.3.3.2.cmml" xref="S4.E27.m2.3.3.1.1.3.3.2">PE</mtext></ci><ci id="S4.E27.m2.2.2.1.1.cmml" xref="S4.E27.m2.2.2.1.1">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m2.3c">\displaystyle=\mathbf{x}_{i}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text{PE}^{%
(d)},</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m2.3d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
<tbody id="S4.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(d)}" class="ltx_Math" display="inline" id="S4.E28.m1.1"><semantics id="S4.E28.m1.1a"><msubsup id="S4.E28.m1.1.2" xref="S4.E28.m1.1.2.cmml"><mi id="S4.E28.m1.1.2.2.2" xref="S4.E28.m1.1.2.2.2.cmml">𝐇</mi><mi id="S4.E28.m1.1.2.2.3" xref="S4.E28.m1.1.2.2.3.cmml">i</mi><mrow id="S4.E28.m1.1.1.1.3" xref="S4.E28.m1.1.2.cmml"><mo id="S4.E28.m1.1.1.1.3.1" stretchy="false" xref="S4.E28.m1.1.2.cmml">(</mo><mi id="S4.E28.m1.1.1.1.1" xref="S4.E28.m1.1.1.1.1.cmml">d</mi><mo id="S4.E28.m1.1.1.1.3.2" stretchy="false" xref="S4.E28.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E28.m1.1b"><apply id="S4.E28.m1.1.2.cmml" xref="S4.E28.m1.1.2"><csymbol cd="ambiguous" id="S4.E28.m1.1.2.1.cmml" xref="S4.E28.m1.1.2">superscript</csymbol><apply id="S4.E28.m1.1.2.2.cmml" xref="S4.E28.m1.1.2"><csymbol cd="ambiguous" id="S4.E28.m1.1.2.2.1.cmml" xref="S4.E28.m1.1.2">subscript</csymbol><ci id="S4.E28.m1.1.2.2.2.cmml" xref="S4.E28.m1.1.2.2.2">𝐇</ci><ci id="S4.E28.m1.1.2.2.3.cmml" xref="S4.E28.m1.1.2.2.3">𝑖</ci></apply><ci id="S4.E28.m1.1.1.1.1.cmml" xref="S4.E28.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m1.1c">\displaystyle\mathbf{H}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{ProbSparseDecoder}(\mathbf{z}_{i}^{(d)},\mathbf{H}_{i}^{(e%
)})." class="ltx_Math" display="inline" id="S4.E28.m2.3"><semantics id="S4.E28.m2.3a"><mrow id="S4.E28.m2.3.3.1" xref="S4.E28.m2.3.3.1.1.cmml"><mrow id="S4.E28.m2.3.3.1.1" xref="S4.E28.m2.3.3.1.1.cmml"><mi id="S4.E28.m2.3.3.1.1.4" xref="S4.E28.m2.3.3.1.1.4.cmml"></mi><mo id="S4.E28.m2.3.3.1.1.3" xref="S4.E28.m2.3.3.1.1.3.cmml">=</mo><mrow id="S4.E28.m2.3.3.1.1.2" xref="S4.E28.m2.3.3.1.1.2.cmml"><mtext id="S4.E28.m2.3.3.1.1.2.4" xref="S4.E28.m2.3.3.1.1.2.4a.cmml">ProbSparseDecoder</mtext><mo id="S4.E28.m2.3.3.1.1.2.3" xref="S4.E28.m2.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S4.E28.m2.3.3.1.1.2.2.2" xref="S4.E28.m2.3.3.1.1.2.2.3.cmml"><mo id="S4.E28.m2.3.3.1.1.2.2.2.3" stretchy="false" xref="S4.E28.m2.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E28.m2.3.3.1.1.1.1.1.1" xref="S4.E28.m2.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E28.m2.3.3.1.1.1.1.1.1.2.2" xref="S4.E28.m2.3.3.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E28.m2.3.3.1.1.1.1.1.1.2.3" xref="S4.E28.m2.3.3.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S4.E28.m2.1.1.1.3" xref="S4.E28.m2.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E28.m2.1.1.1.3.1" stretchy="false" xref="S4.E28.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E28.m2.1.1.1.1" xref="S4.E28.m2.1.1.1.1.cmml">d</mi><mo id="S4.E28.m2.1.1.1.3.2" stretchy="false" xref="S4.E28.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E28.m2.3.3.1.1.2.2.2.4" xref="S4.E28.m2.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E28.m2.3.3.1.1.2.2.2.2" xref="S4.E28.m2.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E28.m2.3.3.1.1.2.2.2.2.2.2" xref="S4.E28.m2.3.3.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mi id="S4.E28.m2.3.3.1.1.2.2.2.2.2.3" xref="S4.E28.m2.3.3.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S4.E28.m2.2.2.1.3" xref="S4.E28.m2.3.3.1.1.2.2.2.2.cmml"><mo id="S4.E28.m2.2.2.1.3.1" stretchy="false" xref="S4.E28.m2.3.3.1.1.2.2.2.2.cmml">(</mo><mi id="S4.E28.m2.2.2.1.1" xref="S4.E28.m2.2.2.1.1.cmml">e</mi><mo id="S4.E28.m2.2.2.1.3.2" stretchy="false" xref="S4.E28.m2.3.3.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E28.m2.3.3.1.1.2.2.2.5" stretchy="false" xref="S4.E28.m2.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E28.m2.3.3.1.2" lspace="0em" xref="S4.E28.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E28.m2.3b"><apply id="S4.E28.m2.3.3.1.1.cmml" xref="S4.E28.m2.3.3.1"><eq id="S4.E28.m2.3.3.1.1.3.cmml" xref="S4.E28.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S4.E28.m2.3.3.1.1.4.cmml" xref="S4.E28.m2.3.3.1.1.4">absent</csymbol><apply id="S4.E28.m2.3.3.1.1.2.cmml" xref="S4.E28.m2.3.3.1.1.2"><times id="S4.E28.m2.3.3.1.1.2.3.cmml" xref="S4.E28.m2.3.3.1.1.2.3"></times><ci id="S4.E28.m2.3.3.1.1.2.4a.cmml" xref="S4.E28.m2.3.3.1.1.2.4"><mtext id="S4.E28.m2.3.3.1.1.2.4.cmml" xref="S4.E28.m2.3.3.1.1.2.4">ProbSparseDecoder</mtext></ci><interval closure="open" id="S4.E28.m2.3.3.1.1.2.2.3.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2"><apply id="S4.E28.m2.3.3.1.1.1.1.1.1.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E28.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E28.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E28.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E28.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E28.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E28.m2.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E28.m2.1.1.1.1.cmml" xref="S4.E28.m2.1.1.1.1">𝑑</ci></apply><apply id="S4.E28.m2.3.3.1.1.2.2.2.2.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E28.m2.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E28.m2.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E28.m2.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E28.m2.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2.2.2">𝐇</ci><ci id="S4.E28.m2.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E28.m2.3.3.1.1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E28.m2.2.2.1.1.cmml" xref="S4.E28.m2.2.2.1.1">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m2.3c">\displaystyle=\text{ProbSparseDecoder}(\mathbf{z}_{i}^{(d)},\mathbf{H}_{i}^{(e%
)}).</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m2.3d">= ProbSparseDecoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Output</h5>
<div class="ltx_para" id="S4.SS3.SSS0.Px3.p1">
<table class="ltx_equation ltx_eqn_table" id="S4.E29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}\in\mathbb{R}^{H}." class="ltx_Math" display="block" id="S4.E29.m1.2"><semantics id="S4.E29.m1.2a"><mrow id="S4.E29.m1.2.2.1" xref="S4.E29.m1.2.2.1.1.cmml"><mrow id="S4.E29.m1.2.2.1.1" xref="S4.E29.m1.2.2.1.1.cmml"><msub id="S4.E29.m1.2.2.1.1.2" xref="S4.E29.m1.2.2.1.1.2.cmml"><mover accent="true" id="S4.E29.m1.2.2.1.1.2.2" xref="S4.E29.m1.2.2.1.1.2.2.cmml"><mi id="S4.E29.m1.2.2.1.1.2.2.2" xref="S4.E29.m1.2.2.1.1.2.2.2.cmml">𝐲</mi><mo id="S4.E29.m1.2.2.1.1.2.2.1" xref="S4.E29.m1.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E29.m1.2.2.1.1.2.3" xref="S4.E29.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S4.E29.m1.2.2.1.1.3" xref="S4.E29.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E29.m1.2.2.1.1.4" xref="S4.E29.m1.2.2.1.1.4.cmml"><msub id="S4.E29.m1.2.2.1.1.4.2" xref="S4.E29.m1.2.2.1.1.4.2.cmml"><mi id="S4.E29.m1.2.2.1.1.4.2.2" xref="S4.E29.m1.2.2.1.1.4.2.2.cmml">𝐖</mi><mi id="S4.E29.m1.2.2.1.1.4.2.3" xref="S4.E29.m1.2.2.1.1.4.2.3.cmml">o</mi></msub><mo id="S4.E29.m1.2.2.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E29.m1.2.2.1.1.4.1.cmml">⋅</mo><msubsup id="S4.E29.m1.2.2.1.1.4.3" xref="S4.E29.m1.2.2.1.1.4.3.cmml"><mi id="S4.E29.m1.2.2.1.1.4.3.2.2" xref="S4.E29.m1.2.2.1.1.4.3.2.2.cmml">𝐇</mi><mi id="S4.E29.m1.2.2.1.1.4.3.2.3" xref="S4.E29.m1.2.2.1.1.4.3.2.3.cmml">i</mi><mrow id="S4.E29.m1.1.1.1.3" xref="S4.E29.m1.2.2.1.1.4.3.cmml"><mo id="S4.E29.m1.1.1.1.3.1" stretchy="false" xref="S4.E29.m1.2.2.1.1.4.3.cmml">(</mo><mi id="S4.E29.m1.1.1.1.1" xref="S4.E29.m1.1.1.1.1.cmml">d</mi><mo id="S4.E29.m1.1.1.1.3.2" stretchy="false" xref="S4.E29.m1.2.2.1.1.4.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E29.m1.2.2.1.1.5" xref="S4.E29.m1.2.2.1.1.5.cmml">∈</mo><msup id="S4.E29.m1.2.2.1.1.6" xref="S4.E29.m1.2.2.1.1.6.cmml"><mi id="S4.E29.m1.2.2.1.1.6.2" xref="S4.E29.m1.2.2.1.1.6.2.cmml">ℝ</mi><mi id="S4.E29.m1.2.2.1.1.6.3" xref="S4.E29.m1.2.2.1.1.6.3.cmml">H</mi></msup></mrow><mo id="S4.E29.m1.2.2.1.2" lspace="0em" xref="S4.E29.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E29.m1.2b"><apply id="S4.E29.m1.2.2.1.1.cmml" xref="S4.E29.m1.2.2.1"><and id="S4.E29.m1.2.2.1.1a.cmml" xref="S4.E29.m1.2.2.1"></and><apply id="S4.E29.m1.2.2.1.1b.cmml" xref="S4.E29.m1.2.2.1"><eq id="S4.E29.m1.2.2.1.1.3.cmml" xref="S4.E29.m1.2.2.1.1.3"></eq><apply id="S4.E29.m1.2.2.1.1.2.cmml" xref="S4.E29.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E29.m1.2.2.1.1.2.1.cmml" xref="S4.E29.m1.2.2.1.1.2">subscript</csymbol><apply id="S4.E29.m1.2.2.1.1.2.2.cmml" xref="S4.E29.m1.2.2.1.1.2.2"><ci id="S4.E29.m1.2.2.1.1.2.2.1.cmml" xref="S4.E29.m1.2.2.1.1.2.2.1">^</ci><ci id="S4.E29.m1.2.2.1.1.2.2.2.cmml" xref="S4.E29.m1.2.2.1.1.2.2.2">𝐲</ci></apply><ci id="S4.E29.m1.2.2.1.1.2.3.cmml" xref="S4.E29.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S4.E29.m1.2.2.1.1.4.cmml" xref="S4.E29.m1.2.2.1.1.4"><ci id="S4.E29.m1.2.2.1.1.4.1.cmml" xref="S4.E29.m1.2.2.1.1.4.1">⋅</ci><apply id="S4.E29.m1.2.2.1.1.4.2.cmml" xref="S4.E29.m1.2.2.1.1.4.2"><csymbol cd="ambiguous" id="S4.E29.m1.2.2.1.1.4.2.1.cmml" xref="S4.E29.m1.2.2.1.1.4.2">subscript</csymbol><ci id="S4.E29.m1.2.2.1.1.4.2.2.cmml" xref="S4.E29.m1.2.2.1.1.4.2.2">𝐖</ci><ci id="S4.E29.m1.2.2.1.1.4.2.3.cmml" xref="S4.E29.m1.2.2.1.1.4.2.3">𝑜</ci></apply><apply id="S4.E29.m1.2.2.1.1.4.3.cmml" xref="S4.E29.m1.2.2.1.1.4.3"><csymbol cd="ambiguous" id="S4.E29.m1.2.2.1.1.4.3.1.cmml" xref="S4.E29.m1.2.2.1.1.4.3">superscript</csymbol><apply id="S4.E29.m1.2.2.1.1.4.3.2.cmml" xref="S4.E29.m1.2.2.1.1.4.3"><csymbol cd="ambiguous" id="S4.E29.m1.2.2.1.1.4.3.2.1.cmml" xref="S4.E29.m1.2.2.1.1.4.3">subscript</csymbol><ci id="S4.E29.m1.2.2.1.1.4.3.2.2.cmml" xref="S4.E29.m1.2.2.1.1.4.3.2.2">𝐇</ci><ci id="S4.E29.m1.2.2.1.1.4.3.2.3.cmml" xref="S4.E29.m1.2.2.1.1.4.3.2.3">𝑖</ci></apply><ci id="S4.E29.m1.1.1.1.1.cmml" xref="S4.E29.m1.1.1.1.1">𝑑</ci></apply></apply></apply><apply id="S4.E29.m1.2.2.1.1c.cmml" xref="S4.E29.m1.2.2.1"><in id="S4.E29.m1.2.2.1.1.5.cmml" xref="S4.E29.m1.2.2.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#S4.E29.m1.2.2.1.1.4.cmml" id="S4.E29.m1.2.2.1.1d.cmml" xref="S4.E29.m1.2.2.1"></share><apply id="S4.E29.m1.2.2.1.1.6.cmml" xref="S4.E29.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S4.E29.m1.2.2.1.1.6.1.cmml" xref="S4.E29.m1.2.2.1.1.6">superscript</csymbol><ci id="S4.E29.m1.2.2.1.1.6.2.cmml" xref="S4.E29.m1.2.2.1.1.6.2">ℝ</ci><ci id="S4.E29.m1.2.2.1.1.6.3.cmml" xref="S4.E29.m1.2.2.1.1.6.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m1.2c">\hat{\mathbf{y}}_{i}=\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}\in\mathbb{R}^{H}.</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m1.2d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S4.SS3.SSS0.Px4.p1">
<table class="ltx_equation ltx_eqn_table" id="S4.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Full}}=\underbrace{\log P\cdot P\cdot d_{\text{model}}}_{%
\text{Encoder Sparse Attention}}+\underbrace{\log H\cdot H\cdot d_{\text{model%
}}}_{\text{Decoder Sparse Attention}}+\underbrace{H\cdot P\cdot d_{\text{model%
}}}_{\text{Cross-Attention}}" class="ltx_Math" display="block" id="S4.Ex11.m1.1"><semantics id="S4.Ex11.m1.1a"><mrow id="S4.Ex11.m1.1.1" xref="S4.Ex11.m1.1.1.cmml"><msub id="S4.Ex11.m1.1.1.2" xref="S4.Ex11.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex11.m1.1.1.2.2" xref="S4.Ex11.m1.1.1.2.2.cmml">𝒪</mi><mtext id="S4.Ex11.m1.1.1.2.3" xref="S4.Ex11.m1.1.1.2.3a.cmml">Full</mtext></msub><mo id="S4.Ex11.m1.1.1.1" xref="S4.Ex11.m1.1.1.1.cmml">=</mo><mrow id="S4.Ex11.m1.1.1.3" xref="S4.Ex11.m1.1.1.3.cmml"><munder id="S4.Ex11.m1.1.1.3.2" xref="S4.Ex11.m1.1.1.3.2.cmml"><munder accentunder="true" id="S4.Ex11.m1.1.1.3.2.2" xref="S4.Ex11.m1.1.1.3.2.2.cmml"><mrow id="S4.Ex11.m1.1.1.3.2.2.2" xref="S4.Ex11.m1.1.1.3.2.2.2.cmml"><mi id="S4.Ex11.m1.1.1.3.2.2.2.1" xref="S4.Ex11.m1.1.1.3.2.2.2.1.cmml">log</mi><mo id="S4.Ex11.m1.1.1.3.2.2.2a" lspace="0.167em" xref="S4.Ex11.m1.1.1.3.2.2.2.cmml">⁡</mo><mrow id="S4.Ex11.m1.1.1.3.2.2.2.2" xref="S4.Ex11.m1.1.1.3.2.2.2.2.cmml"><mi id="S4.Ex11.m1.1.1.3.2.2.2.2.2" xref="S4.Ex11.m1.1.1.3.2.2.2.2.2.cmml">P</mi><mo id="S4.Ex11.m1.1.1.3.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.2.2.2.2.1.cmml">⋅</mo><mi id="S4.Ex11.m1.1.1.3.2.2.2.2.3" xref="S4.Ex11.m1.1.1.3.2.2.2.2.3.cmml">P</mi><mo id="S4.Ex11.m1.1.1.3.2.2.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.2.2.2.2.1.cmml">⋅</mo><msub id="S4.Ex11.m1.1.1.3.2.2.2.2.4" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.cmml"><mi id="S4.Ex11.m1.1.1.3.2.2.2.2.4.2" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.2.cmml">d</mi><mtext id="S4.Ex11.m1.1.1.3.2.2.2.2.4.3" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.Ex11.m1.1.1.3.2.2.1" xref="S4.Ex11.m1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex11.m1.1.1.3.2.3" xref="S4.Ex11.m1.1.1.3.2.3a.cmml">Encoder Sparse Attention</mtext></munder><mo id="S4.Ex11.m1.1.1.3.1" xref="S4.Ex11.m1.1.1.3.1.cmml">+</mo><munder id="S4.Ex11.m1.1.1.3.3" xref="S4.Ex11.m1.1.1.3.3.cmml"><munder accentunder="true" id="S4.Ex11.m1.1.1.3.3.2" xref="S4.Ex11.m1.1.1.3.3.2.cmml"><mrow id="S4.Ex11.m1.1.1.3.3.2.2" xref="S4.Ex11.m1.1.1.3.3.2.2.cmml"><mi id="S4.Ex11.m1.1.1.3.3.2.2.1" xref="S4.Ex11.m1.1.1.3.3.2.2.1.cmml">log</mi><mo id="S4.Ex11.m1.1.1.3.3.2.2a" lspace="0.167em" xref="S4.Ex11.m1.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S4.Ex11.m1.1.1.3.3.2.2.2" xref="S4.Ex11.m1.1.1.3.3.2.2.2.cmml"><mi id="S4.Ex11.m1.1.1.3.3.2.2.2.2" xref="S4.Ex11.m1.1.1.3.3.2.2.2.2.cmml">H</mi><mo id="S4.Ex11.m1.1.1.3.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.3.2.2.2.1.cmml">⋅</mo><mi id="S4.Ex11.m1.1.1.3.3.2.2.2.3" xref="S4.Ex11.m1.1.1.3.3.2.2.2.3.cmml">H</mi><mo id="S4.Ex11.m1.1.1.3.3.2.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.3.2.2.2.1.cmml">⋅</mo><msub id="S4.Ex11.m1.1.1.3.3.2.2.2.4" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.cmml"><mi id="S4.Ex11.m1.1.1.3.3.2.2.2.4.2" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.2.cmml">d</mi><mtext id="S4.Ex11.m1.1.1.3.3.2.2.2.4.3" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.Ex11.m1.1.1.3.3.2.1" xref="S4.Ex11.m1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex11.m1.1.1.3.3.3" xref="S4.Ex11.m1.1.1.3.3.3a.cmml">Decoder Sparse Attention</mtext></munder><mo id="S4.Ex11.m1.1.1.3.1a" xref="S4.Ex11.m1.1.1.3.1.cmml">+</mo><munder id="S4.Ex11.m1.1.1.3.4" xref="S4.Ex11.m1.1.1.3.4.cmml"><munder accentunder="true" id="S4.Ex11.m1.1.1.3.4.2" xref="S4.Ex11.m1.1.1.3.4.2.cmml"><mrow id="S4.Ex11.m1.1.1.3.4.2.2" xref="S4.Ex11.m1.1.1.3.4.2.2.cmml"><mi id="S4.Ex11.m1.1.1.3.4.2.2.2" xref="S4.Ex11.m1.1.1.3.4.2.2.2.cmml">H</mi><mo id="S4.Ex11.m1.1.1.3.4.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.4.2.2.1.cmml">⋅</mo><mi id="S4.Ex11.m1.1.1.3.4.2.2.3" xref="S4.Ex11.m1.1.1.3.4.2.2.3.cmml">P</mi><mo id="S4.Ex11.m1.1.1.3.4.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.Ex11.m1.1.1.3.4.2.2.1.cmml">⋅</mo><msub id="S4.Ex11.m1.1.1.3.4.2.2.4" xref="S4.Ex11.m1.1.1.3.4.2.2.4.cmml"><mi id="S4.Ex11.m1.1.1.3.4.2.2.4.2" xref="S4.Ex11.m1.1.1.3.4.2.2.4.2.cmml">d</mi><mtext id="S4.Ex11.m1.1.1.3.4.2.2.4.3" xref="S4.Ex11.m1.1.1.3.4.2.2.4.3a.cmml">model</mtext></msub></mrow><mo id="S4.Ex11.m1.1.1.3.4.2.1" xref="S4.Ex11.m1.1.1.3.4.2.1.cmml">⏟</mo></munder><mtext id="S4.Ex11.m1.1.1.3.4.3" xref="S4.Ex11.m1.1.1.3.4.3a.cmml">Cross-Attention</mtext></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex11.m1.1b"><apply id="S4.Ex11.m1.1.1.cmml" xref="S4.Ex11.m1.1.1"><eq id="S4.Ex11.m1.1.1.1.cmml" xref="S4.Ex11.m1.1.1.1"></eq><apply id="S4.Ex11.m1.1.1.2.cmml" xref="S4.Ex11.m1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.2.1.cmml" xref="S4.Ex11.m1.1.1.2">subscript</csymbol><ci id="S4.Ex11.m1.1.1.2.2.cmml" xref="S4.Ex11.m1.1.1.2.2">𝒪</ci><ci id="S4.Ex11.m1.1.1.2.3a.cmml" xref="S4.Ex11.m1.1.1.2.3"><mtext id="S4.Ex11.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.2.3">Full</mtext></ci></apply><apply id="S4.Ex11.m1.1.1.3.cmml" xref="S4.Ex11.m1.1.1.3"><plus id="S4.Ex11.m1.1.1.3.1.cmml" xref="S4.Ex11.m1.1.1.3.1"></plus><apply id="S4.Ex11.m1.1.1.3.2.cmml" xref="S4.Ex11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.2.1.cmml" xref="S4.Ex11.m1.1.1.3.2">subscript</csymbol><apply id="S4.Ex11.m1.1.1.3.2.2.cmml" xref="S4.Ex11.m1.1.1.3.2.2"><ci id="S4.Ex11.m1.1.1.3.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.2.2.1">⏟</ci><apply id="S4.Ex11.m1.1.1.3.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2"><log id="S4.Ex11.m1.1.1.3.2.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.1"></log><apply id="S4.Ex11.m1.1.1.3.2.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2"><ci id="S4.Ex11.m1.1.1.3.2.2.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.1">⋅</ci><ci id="S4.Ex11.m1.1.1.3.2.2.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.2">𝑃</ci><ci id="S4.Ex11.m1.1.1.3.2.2.2.2.3.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.3">𝑃</ci><apply id="S4.Ex11.m1.1.1.3.2.2.2.2.4.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.2.2.2.2.4.1.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4">subscript</csymbol><ci id="S4.Ex11.m1.1.1.3.2.2.2.2.4.2.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.2">𝑑</ci><ci id="S4.Ex11.m1.1.1.3.2.2.2.2.4.3a.cmml" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.3"><mtext id="S4.Ex11.m1.1.1.3.2.2.2.2.4.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.2.2.2.2.4.3">model</mtext></ci></apply></apply></apply></apply><ci id="S4.Ex11.m1.1.1.3.2.3a.cmml" xref="S4.Ex11.m1.1.1.3.2.3"><mtext id="S4.Ex11.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.2.3">Encoder Sparse Attention</mtext></ci></apply><apply id="S4.Ex11.m1.1.1.3.3.cmml" xref="S4.Ex11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.3.1.cmml" xref="S4.Ex11.m1.1.1.3.3">subscript</csymbol><apply id="S4.Ex11.m1.1.1.3.3.2.cmml" xref="S4.Ex11.m1.1.1.3.3.2"><ci id="S4.Ex11.m1.1.1.3.3.2.1.cmml" xref="S4.Ex11.m1.1.1.3.3.2.1">⏟</ci><apply id="S4.Ex11.m1.1.1.3.3.2.2.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2"><log id="S4.Ex11.m1.1.1.3.3.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.1"></log><apply id="S4.Ex11.m1.1.1.3.3.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2"><ci id="S4.Ex11.m1.1.1.3.3.2.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.1">⋅</ci><ci id="S4.Ex11.m1.1.1.3.3.2.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.2">𝐻</ci><ci id="S4.Ex11.m1.1.1.3.3.2.2.2.3.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.3">𝐻</ci><apply id="S4.Ex11.m1.1.1.3.3.2.2.2.4.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.3.2.2.2.4.1.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4">subscript</csymbol><ci id="S4.Ex11.m1.1.1.3.3.2.2.2.4.2.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.2">𝑑</ci><ci id="S4.Ex11.m1.1.1.3.3.2.2.2.4.3a.cmml" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.3"><mtext id="S4.Ex11.m1.1.1.3.3.2.2.2.4.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.3.2.2.2.4.3">model</mtext></ci></apply></apply></apply></apply><ci id="S4.Ex11.m1.1.1.3.3.3a.cmml" xref="S4.Ex11.m1.1.1.3.3.3"><mtext id="S4.Ex11.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.3.3">Decoder Sparse Attention</mtext></ci></apply><apply id="S4.Ex11.m1.1.1.3.4.cmml" xref="S4.Ex11.m1.1.1.3.4"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.4.1.cmml" xref="S4.Ex11.m1.1.1.3.4">subscript</csymbol><apply id="S4.Ex11.m1.1.1.3.4.2.cmml" xref="S4.Ex11.m1.1.1.3.4.2"><ci id="S4.Ex11.m1.1.1.3.4.2.1.cmml" xref="S4.Ex11.m1.1.1.3.4.2.1">⏟</ci><apply id="S4.Ex11.m1.1.1.3.4.2.2.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2"><ci id="S4.Ex11.m1.1.1.3.4.2.2.1.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.1">⋅</ci><ci id="S4.Ex11.m1.1.1.3.4.2.2.2.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.2">𝐻</ci><ci id="S4.Ex11.m1.1.1.3.4.2.2.3.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.3">𝑃</ci><apply id="S4.Ex11.m1.1.1.3.4.2.2.4.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.4"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.3.4.2.2.4.1.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.4">subscript</csymbol><ci id="S4.Ex11.m1.1.1.3.4.2.2.4.2.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.4.2">𝑑</ci><ci id="S4.Ex11.m1.1.1.3.4.2.2.4.3a.cmml" xref="S4.Ex11.m1.1.1.3.4.2.2.4.3"><mtext id="S4.Ex11.m1.1.1.3.4.2.2.4.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.4.2.2.4.3">model</mtext></ci></apply></apply></apply><ci id="S4.Ex11.m1.1.1.3.4.3a.cmml" xref="S4.Ex11.m1.1.1.3.4.3"><mtext id="S4.Ex11.m1.1.1.3.4.3.cmml" mathsize="70%" xref="S4.Ex11.m1.1.1.3.4.3">Cross-Attention</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex11.m1.1c">\mathcal{O}_{\text{Full}}=\underbrace{\log P\cdot P\cdot d_{\text{model}}}_{%
\text{Encoder Sparse Attention}}+\underbrace{\log H\cdot H\cdot d_{\text{model%
}}}_{\text{Decoder Sparse Attention}}+\underbrace{H\cdot P\cdot d_{\text{model%
}}}_{\text{Cross-Attention}}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex11.m1.1d">caligraphic_O start_POSTSUBSCRIPT Full end_POSTSUBSCRIPT = under⏟ start_ARG roman_log italic_P ⋅ italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Encoder Sparse Attention end_POSTSUBSCRIPT + under⏟ start_ARG roman_log italic_H ⋅ italic_H ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Decoder Sparse Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_H ⋅ italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Cross-Attention end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Comparative Summary</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Each <span class="ltx_text ltx_font_typewriter" id="S4.SS4.p1.1.1">Informer</span>  variant offers different strengths: (i) <span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.2">Minimal</span> serves as a full-attention benchmark and is effective for short sequences, but computationally expensive; (ii) <span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.3">Standard</span> improves scalability using probabilistic attention, offering a good balance of efficiency and accuracy; (iii) <span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.4">Full</span> introduces a sequence-to-sequence structure for modeling long-term, non-stationary patterns, at higher computational cost. A comparative overview is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S4.T2" title="Table 2 ‣ 4.4 Comparative Summary ‣ 4 Informer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">2</span></a>, and the complete forecasting procedure for the Full variant is provided in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#alg2" title="Algorithm 2 ‣ 8 Conclusion ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">2</span></a> in Appendix. The following Theorem we prove the reduction complexity resulted by employing ProbSparse technique.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.6.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.7.2" style="font-size:90%;">Comparison of <span class="ltx_text ltx_font_typewriter" id="S4.T2.7.2.1">Informer</span> Variants</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.3.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Model Variant</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.3.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Attention Type</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.3.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Architecture</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.3.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Time Complexity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Minimal <span class="ltx_text ltx_font_typewriter" id="S4.T2.1.1.2.1">Informer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Full Self-Attention</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T2.1.1.1.m1.1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S4.T2.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.1.1.1.m1.1.1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.T2.1.1.1.m1.1.1.1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.cmml"><msup id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S4.T2.1.1.1.m1.1.1.1.1.1.2.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.2.cmml">d</mi><mtext id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S4.T2.1.1.1.m1.1.1.1.1.1.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.T2.1.1.1.m1.1.1.1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.T2.1.1.1.m1.1.1.1.1.1.3.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S4.T2.1.1.1.m1.1.1.1.1.1.3.1" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.2" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.2.cmml">d</mi><mtext id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3a.cmml">model</mtext><mn id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.3" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S4.T2.1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><times id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2"></times><ci id="S4.T2.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3">𝒪</ci><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1"><plus id="S4.T2.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2"><times id="S4.T2.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.1"></times><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.2.3">2</cn></apply><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3a.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3"><mtext id="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S4.T2.1.1.1.m1.1.1.1.1.1.2.3.3">model</mtext></ci></apply></apply><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3"><times id="S4.T2.1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.1"></times><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.2">𝑑</ci><ci id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3a.cmml" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3"><mtext id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.2.3">model</mtext></ci></apply><cn id="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.T2.1.1.1.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\mathcal{O}(P^{2}d_{\text{model}}+Pd_{\text{model}}^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Standard <span class="ltx_text ltx_font_typewriter" id="S4.T2.2.2.2.1">Informer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ProbSparse (log-scaled)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(\log P\cdot Pd_{\text{model}}+Pd_{\text{model}}^{2})" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T2.2.2.1.m1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.cmml"><mo id="S4.T2.2.2.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T2.2.2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.2.2.1.m1.1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.cmml"><mrow id="S4.T2.2.2.1.m1.1.1.1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.2.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.1.cmml">log</mi><mo id="S4.T2.2.2.1.m1.1.1.1.1.1.2a" lspace="0.167em" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.cmml"><mrow id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.2.cmml">P</mi><mo id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.1.cmml">⋅</mo><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.3.cmml">P</mi></mrow><mo id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.2.cmml">d</mi><mtext id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.T2.2.2.1.m1.1.1.1.1.1.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.T2.2.2.1.m1.1.1.1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.3.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S4.T2.2.2.1.m1.1.1.1.1.1.3.1" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.2" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.2.cmml">d</mi><mtext id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3a.cmml">model</mtext><mn id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.3" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S4.T2.2.2.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T2.2.2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><times id="S4.T2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2"></times><ci id="S4.T2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.1.m1.1.1.3">𝒪</ci><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1"><plus id="S4.T2.2.2.1.m1.1.1.1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.1"></plus><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2"><log id="S4.T2.2.2.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.1"></log><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2"><times id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.1"></times><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2"><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.1">⋅</ci><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.2">𝑃</ci><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.2.3">𝑃</ci></apply><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3a.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3"><mtext id="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3.cmml" mathsize="70%" xref="S4.T2.2.2.1.m1.1.1.1.1.1.2.2.3.3">model</mtext></ci></apply></apply></apply><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.3.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3"><times id="S4.T2.2.2.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.1"></times><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.2">𝑑</ci><ci id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3a.cmml" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3"><mtext id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.2.3">model</mtext></ci></apply><cn id="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.T2.2.2.1.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\mathcal{O}(\log P\cdot Pd_{\text{model}}+Pd_{\text{model}}^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">caligraphic_O ( roman_log italic_P ⋅ italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S4.T2.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Full <span class="ltx_text ltx_font_typewriter" id="S4.T2.3.3.2.1">Informer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ProbSparse (dual)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-Decoder</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(\log P\cdot Pd_{\text{model}}+\log H\cdot Hd_{\text{model}}+HPd_{%
\text{model}})" class="ltx_Math" display="inline" id="S4.T2.3.3.1.m1.1"><semantics id="S4.T2.3.3.1.m1.1a"><mrow id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.3.3.1.m1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.3.cmml">𝒪</mi><mo id="S4.T2.3.3.1.m1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.cmml"><mo id="S4.T2.3.3.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T2.3.3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.cmml"><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.2.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.1.cmml">log</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.2a" lspace="0.167em" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.cmml"><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.2.cmml">P</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.1.cmml">⋅</mo><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.3.cmml">P</mi></mrow><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.2.cmml">d</mi><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.3.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.cmml"><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.2.cmml">H</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.1.cmml">⋅</mo><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.3.cmml">H</mi></mrow><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.2.cmml">d</mi><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.1a" xref="S4.T2.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.T2.3.3.1.m1.1.1.1.1.1.4" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.4.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.2.cmml">H</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.4.1" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.4.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.3.cmml">P</mi><mo id="S4.T2.3.3.1.m1.1.1.1.1.1.4.1a" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.cmml"><mi id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.2" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.2.cmml">d</mi><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3a.cmml">model</mtext></msub></mrow></mrow><mo id="S4.T2.3.3.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T2.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"><times id="S4.T2.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2"></times><ci id="S4.T2.3.3.1.m1.1.1.3.cmml" xref="S4.T2.3.3.1.m1.1.1.3">𝒪</ci><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1"><plus id="S4.T2.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.1"></plus><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2"><log id="S4.T2.3.3.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.1"></log><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2"><times id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.1"></times><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2"><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.1">⋅</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.2">𝑃</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.2.3">𝑃</ci></apply><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3a.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3"><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3.cmml" mathsize="70%" xref="S4.T2.3.3.1.m1.1.1.1.1.1.2.2.3.3">model</mtext></ci></apply></apply></apply><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3"><log id="S4.T2.3.3.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.1"></log><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2"><times id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.1"></times><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2"><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.1">⋅</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.2">𝐻</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.2.3">𝐻</ci></apply><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.2">𝑑</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3a.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3"><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3.cmml" mathsize="70%" xref="S4.T2.3.3.1.m1.1.1.1.1.1.3.2.3.3">model</mtext></ci></apply></apply></apply><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.4.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4"><times id="S4.T2.3.3.1.m1.1.1.1.1.1.4.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.1"></times><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.4.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.2">𝐻</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.4.3.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.3">𝑃</ci><apply id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.1.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.2.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.2">𝑑</ci><ci id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3a.cmml" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3"><mtext id="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3.cmml" mathsize="70%" xref="S4.T2.3.3.1.m1.1.1.1.1.1.4.4.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">\mathcal{O}(\log P\cdot Pd_{\text{model}}+\log H\cdot Hd_{\text{model}}+HPd_{%
\text{model}})</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.m1.1d">caligraphic_O ( roman_log italic_P ⋅ italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + roman_log italic_H ⋅ italic_H italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT + italic_H italic_P italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT )</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem1.1.1.1">Theorem 1</span></span></h6>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p" id="Thmtheorem1.p1.2"><span class="ltx_text ltx_font_italic" id="Thmtheorem1.p1.2.2">(Attention Complexity Reduction in ProbSparse <span class="ltx_text ltx_font_typewriter" id="Thmtheorem1.p1.2.2.1">Informer</span>)
If the attention mechanism is dominated by a small number of significant query-key pairs, ProbSparse reduces the attention complexity from <math alttext="\mathcal{O}(L_{Q}L_{K})" class="ltx_Math" display="inline" id="Thmtheorem1.p1.1.1.m1.1"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mrow id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.1.1.m1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3.cmml">𝒪</mi><mo id="Thmtheorem1.p1.1.1.m1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml"><msub id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.2" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.2.cmml">L</mi><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.3" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><msub id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.2" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.2.cmml">L</mi><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.3" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.3.cmml">K</mi></msub></mrow><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><apply id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1"><times id="Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.2"></times><ci id="Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3">𝒪</ci><apply id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1"><times id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1"></times><apply id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.2">𝐿</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.2">𝐿</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">\mathcal{O}(L_{Q}L_{K})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.1.1.m1.1d">caligraphic_O ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT )</annotation></semantics></math> to <math alttext="\mathcal{O}(L_{Q}\log L_{K})" class="ltx_Math" display="inline" id="Thmtheorem1.p1.2.2.m2.1"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><mrow id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.2.2.m2.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.cmml">𝒪</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.2.2.m2.1.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.2" stretchy="false" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><msub id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.2" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.2.cmml">L</mi><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.3" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1" lspace="0.167em" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml">⁡</mo><msub id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.2" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.3" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.3.cmml">K</mi></msub></mrow></mrow><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.3" stretchy="false" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1"><times id="Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2"></times><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3">𝒪</ci><apply id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1"><times id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1"></times><apply id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.2">𝐿</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3"><log id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.1"></log><apply id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.2">𝐿</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.2.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">\mathcal{O}(L_{Q}\log L_{K})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.2.2.m2.1d">caligraphic_O ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT roman_log italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT )</annotation></semantics></math> with bounded approximation error.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_proof" id="Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem2.1.1.1">Proof 4.2</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem2.p1">
<p class="ltx_p" id="Thmtheorem2.p1.3"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.3.3">Let <math alttext="Q\in\mathbb{R}^{L_{Q}\times d_{\text{model}}}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.1.1.m1.1"><semantics id="Thmtheorem2.p1.1.1.m1.1a"><mrow id="Thmtheorem2.p1.1.1.m1.1.1" xref="Thmtheorem2.p1.1.1.m1.1.1.cmml"><mi id="Thmtheorem2.p1.1.1.m1.1.1.2" xref="Thmtheorem2.p1.1.1.m1.1.1.2.cmml">Q</mi><mo id="Thmtheorem2.p1.1.1.m1.1.1.1" xref="Thmtheorem2.p1.1.1.m1.1.1.1.cmml">∈</mo><msup id="Thmtheorem2.p1.1.1.m1.1.1.3" xref="Thmtheorem2.p1.1.1.m1.1.1.3.cmml"><mi id="Thmtheorem2.p1.1.1.m1.1.1.3.2" xref="Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Thmtheorem2.p1.1.1.m1.1.1.3.3" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml"><msub id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.cmml"><mi id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.2" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.3" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.3.cmml">Q</mi></msub><mo id="Thmtheorem2.p1.1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.cmml"><mi id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.2" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.2.cmml">d</mi><mtext class="ltx_mathvariant_italic" id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.1.1.m1.1b"><apply id="Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1"><in id="Thmtheorem2.p1.1.1.m1.1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.1"></in><ci id="Thmtheorem2.p1.1.1.m1.1.1.2.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.2">𝑄</ci><apply id="Thmtheorem2.p1.1.1.m1.1.1.3.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.1.1.m1.1.1.3.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3">superscript</csymbol><ci id="Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.2">ℝ</ci><apply id="Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3"><times id="Thmtheorem2.p1.1.1.m1.1.1.3.3.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.1"></times><apply id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.2.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.2">𝐿</ci><ci id="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.3.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.2.3">𝑄</ci></apply><apply id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.2.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3a.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3"><mtext class="ltx_mathvariant_italic" id="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3.cmml" mathsize="50%" xref="Thmtheorem2.p1.1.1.m1.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.1.1.m1.1c">Q\in\mathbb{R}^{L_{Q}\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.1.1.m1.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="K\in\mathbb{R}^{L_{K}\times d_{\text{model}}}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.2.2.m2.1"><semantics id="Thmtheorem2.p1.2.2.m2.1a"><mrow id="Thmtheorem2.p1.2.2.m2.1.1" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.2" xref="Thmtheorem2.p1.2.2.m2.1.1.2.cmml">K</mi><mo id="Thmtheorem2.p1.2.2.m2.1.1.1" xref="Thmtheorem2.p1.2.2.m2.1.1.1.cmml">∈</mo><msup id="Thmtheorem2.p1.2.2.m2.1.1.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.3.2" xref="Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Thmtheorem2.p1.2.2.m2.1.1.3.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.cmml"><msub id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.2" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.3.cmml">K</mi></msub><mo id="Thmtheorem2.p1.2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.1.cmml">×</mo><msub id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.2" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.2.cmml">d</mi><mtext class="ltx_mathvariant_italic" id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.2.2.m2.1b"><apply id="Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1"><in id="Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.1"></in><ci id="Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2">𝐾</ci><apply id="Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.m2.1.1.3.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3">superscript</csymbol><ci id="Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.2">ℝ</ci><apply id="Thmtheorem2.p1.2.2.m2.1.1.3.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3"><times id="Thmtheorem2.p1.2.2.m2.1.1.3.3.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.1"></times><apply id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.2">𝐿</ci><ci id="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.2.3">𝐾</ci></apply><apply id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3">subscript</csymbol><ci id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3a.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3"><mtext class="ltx_mathvariant_italic" id="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="Thmtheorem2.p1.2.2.m2.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.2.2.m2.1c">K\in\mathbb{R}^{L_{K}\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.2.2.m2.1d">italic_K ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> be the query and key matrices. For each query <math alttext="q_{i}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.3.3.m3.1"><semantics id="Thmtheorem2.p1.3.3.m3.1a"><msub id="Thmtheorem2.p1.3.3.m3.1.1" xref="Thmtheorem2.p1.3.3.m3.1.1.cmml"><mi id="Thmtheorem2.p1.3.3.m3.1.1.2" xref="Thmtheorem2.p1.3.3.m3.1.1.2.cmml">q</mi><mi id="Thmtheorem2.p1.3.3.m3.1.1.3" xref="Thmtheorem2.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.3.3.m3.1b"><apply id="Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.3.3.m3.1.1.1.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmtheorem2.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1.2">𝑞</ci><ci id="Thmtheorem2.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem2.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.3.3.m3.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.3.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, define a sparsity score:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M(q_{i},K)=\max_{j}\left(\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}%
\right)-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{%
\text{model}}}}." class="ltx_Math" display="block" id="S4.Ex12.m1.3"><semantics id="S4.Ex12.m1.3a"><mrow id="S4.Ex12.m1.3.3.1" xref="S4.Ex12.m1.3.3.1.1.cmml"><mrow id="S4.Ex12.m1.3.3.1.1" xref="S4.Ex12.m1.3.3.1.1.cmml"><mrow id="S4.Ex12.m1.3.3.1.1.1" xref="S4.Ex12.m1.3.3.1.1.1.cmml"><mi id="S4.Ex12.m1.3.3.1.1.1.3" xref="S4.Ex12.m1.3.3.1.1.1.3.cmml">M</mi><mo id="S4.Ex12.m1.3.3.1.1.1.2" xref="S4.Ex12.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex12.m1.3.3.1.1.1.1.1" xref="S4.Ex12.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.Ex12.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.Ex12.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S4.Ex12.m1.3.3.1.1.1.1.1.1" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.Ex12.m1.3.3.1.1.1.1.1.1.2" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1.2.cmml">q</mi><mi id="S4.Ex12.m1.3.3.1.1.1.1.1.1.3" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex12.m1.3.3.1.1.1.1.1.3" xref="S4.Ex12.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S4.Ex12.m1.1.1" xref="S4.Ex12.m1.1.1.cmml">K</mi><mo id="S4.Ex12.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.Ex12.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex12.m1.3.3.1.1.3" xref="S4.Ex12.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.Ex12.m1.3.3.1.1.2" xref="S4.Ex12.m1.3.3.1.1.2.cmml"><mrow id="S4.Ex12.m1.3.3.1.1.2.1.1" xref="S4.Ex12.m1.3.3.1.1.2.1.2.cmml"><munder id="S4.Ex12.m1.3.3.1.1.2.1.1.1" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.1.1.1.2" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1.2.cmml">max</mi><mi id="S4.Ex12.m1.3.3.1.1.2.1.1.1.3" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1.3.cmml">j</mi></munder><mo id="S4.Ex12.m1.3.3.1.1.2.1.1a" xref="S4.Ex12.m1.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="S4.Ex12.m1.3.3.1.1.2.1.1.2" xref="S4.Ex12.m1.3.3.1.1.2.1.2.cmml"><mo id="S4.Ex12.m1.3.3.1.1.2.1.1.2.1" xref="S4.Ex12.m1.3.3.1.1.2.1.2.cmml">(</mo><mfrac id="S4.Ex12.m1.2.2" xref="S4.Ex12.m1.2.2.cmml"><mrow id="S4.Ex12.m1.2.2.2" xref="S4.Ex12.m1.2.2.2.cmml"><msub id="S4.Ex12.m1.2.2.2.2" xref="S4.Ex12.m1.2.2.2.2.cmml"><mi id="S4.Ex12.m1.2.2.2.2.2" xref="S4.Ex12.m1.2.2.2.2.2.cmml">q</mi><mi id="S4.Ex12.m1.2.2.2.2.3" xref="S4.Ex12.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.Ex12.m1.2.2.2.1" xref="S4.Ex12.m1.2.2.2.1.cmml">⁢</mo><msubsup id="S4.Ex12.m1.2.2.2.3" xref="S4.Ex12.m1.2.2.2.3.cmml"><mi id="S4.Ex12.m1.2.2.2.3.2.2" xref="S4.Ex12.m1.2.2.2.3.2.2.cmml">k</mi><mi id="S4.Ex12.m1.2.2.2.3.2.3" xref="S4.Ex12.m1.2.2.2.3.2.3.cmml">j</mi><mo id="S4.Ex12.m1.2.2.2.3.3" xref="S4.Ex12.m1.2.2.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="S4.Ex12.m1.2.2.3" xref="S4.Ex12.m1.2.2.3.cmml"><msub id="S4.Ex12.m1.2.2.3.2" xref="S4.Ex12.m1.2.2.3.2.cmml"><mi id="S4.Ex12.m1.2.2.3.2.2" xref="S4.Ex12.m1.2.2.3.2.2.cmml">d</mi><mtext class="ltx_mathvariant_italic" id="S4.Ex12.m1.2.2.3.2.3" xref="S4.Ex12.m1.2.2.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="S4.Ex12.m1.3.3.1.1.2.1.1.2.2" xref="S4.Ex12.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex12.m1.3.3.1.1.2.2" xref="S4.Ex12.m1.3.3.1.1.2.2.cmml">−</mo><mrow id="S4.Ex12.m1.3.3.1.1.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.cmml"><mfrac id="S4.Ex12.m1.3.3.1.1.2.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.2.cmml"><mn id="S4.Ex12.m1.3.3.1.1.2.3.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.2.2.cmml">1</mn><msub id="S4.Ex12.m1.3.3.1.1.2.3.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.2.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3.2.cmml">L</mi><mi id="S4.Ex12.m1.3.3.1.1.2.3.2.3.3" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3.3.cmml">K</mi></msub></mfrac><mo id="S4.Ex12.m1.3.3.1.1.2.3.1" xref="S4.Ex12.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mrow id="S4.Ex12.m1.3.3.1.1.2.3.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.cmml"><munderover id="S4.Ex12.m1.3.3.1.1.2.3.3.1" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.cmml"><mo id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.2" movablelimits="false" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.2.cmml">j</mi><mo id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.1" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.2.cmml">L</mi><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.3.cmml">K</mi></msub></munderover><mfrac id="S4.Ex12.m1.3.3.1.1.2.3.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.cmml"><mrow id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.cmml"><msub id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.2.cmml">q</mi><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.1" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.1.cmml">⁢</mo><msubsup id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.2.cmml">k</mi><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.3.cmml">j</mi><mo id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.cmml"><msub id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.cmml"><mi id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.2" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.2.cmml">d</mi><mtext class="ltx_mathvariant_italic" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac></mrow></mrow></mrow></mrow><mo id="S4.Ex12.m1.3.3.1.2" lspace="0em" xref="S4.Ex12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex12.m1.3b"><apply id="S4.Ex12.m1.3.3.1.1.cmml" xref="S4.Ex12.m1.3.3.1"><eq id="S4.Ex12.m1.3.3.1.1.3.cmml" xref="S4.Ex12.m1.3.3.1.1.3"></eq><apply id="S4.Ex12.m1.3.3.1.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.1"><times id="S4.Ex12.m1.3.3.1.1.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.1.2"></times><ci id="S4.Ex12.m1.3.3.1.1.1.3.cmml" xref="S4.Ex12.m1.3.3.1.1.1.3">𝑀</ci><interval closure="open" id="S4.Ex12.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.1.1.1"><apply id="S4.Ex12.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1.2">𝑞</ci><ci id="S4.Ex12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex12.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.Ex12.m1.1.1.cmml" xref="S4.Ex12.m1.1.1">𝐾</ci></interval></apply><apply id="S4.Ex12.m1.3.3.1.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2"><minus id="S4.Ex12.m1.3.3.1.1.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.2"></minus><apply id="S4.Ex12.m1.3.3.1.1.2.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.1.1"><apply id="S4.Ex12.m1.3.3.1.1.2.1.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1">subscript</csymbol><max id="S4.Ex12.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1.2"></max><ci id="S4.Ex12.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.1.1.1.3">𝑗</ci></apply><apply id="S4.Ex12.m1.2.2.cmml" xref="S4.Ex12.m1.2.2"><divide id="S4.Ex12.m1.2.2.1.cmml" xref="S4.Ex12.m1.2.2"></divide><apply id="S4.Ex12.m1.2.2.2.cmml" xref="S4.Ex12.m1.2.2.2"><times id="S4.Ex12.m1.2.2.2.1.cmml" xref="S4.Ex12.m1.2.2.2.1"></times><apply id="S4.Ex12.m1.2.2.2.2.cmml" xref="S4.Ex12.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex12.m1.2.2.2.2.1.cmml" xref="S4.Ex12.m1.2.2.2.2">subscript</csymbol><ci id="S4.Ex12.m1.2.2.2.2.2.cmml" xref="S4.Ex12.m1.2.2.2.2.2">𝑞</ci><ci id="S4.Ex12.m1.2.2.2.2.3.cmml" xref="S4.Ex12.m1.2.2.2.2.3">𝑖</ci></apply><apply id="S4.Ex12.m1.2.2.2.3.cmml" xref="S4.Ex12.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.2.2.2.3.1.cmml" xref="S4.Ex12.m1.2.2.2.3">superscript</csymbol><apply id="S4.Ex12.m1.2.2.2.3.2.cmml" xref="S4.Ex12.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.2.2.2.3.2.1.cmml" xref="S4.Ex12.m1.2.2.2.3">subscript</csymbol><ci id="S4.Ex12.m1.2.2.2.3.2.2.cmml" xref="S4.Ex12.m1.2.2.2.3.2.2">𝑘</ci><ci id="S4.Ex12.m1.2.2.2.3.2.3.cmml" xref="S4.Ex12.m1.2.2.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="S4.Ex12.m1.2.2.2.3.3.cmml" xref="S4.Ex12.m1.2.2.2.3.3">top</csymbol></apply></apply><apply id="S4.Ex12.m1.2.2.3.cmml" xref="S4.Ex12.m1.2.2.3"><root id="S4.Ex12.m1.2.2.3a.cmml" xref="S4.Ex12.m1.2.2.3"></root><apply id="S4.Ex12.m1.2.2.3.2.cmml" xref="S4.Ex12.m1.2.2.3.2"><csymbol cd="ambiguous" id="S4.Ex12.m1.2.2.3.2.1.cmml" xref="S4.Ex12.m1.2.2.3.2">subscript</csymbol><ci id="S4.Ex12.m1.2.2.3.2.2.cmml" xref="S4.Ex12.m1.2.2.3.2.2">𝑑</ci><ci id="S4.Ex12.m1.2.2.3.2.3a.cmml" xref="S4.Ex12.m1.2.2.3.2.3"><mtext class="ltx_mathvariant_italic" id="S4.Ex12.m1.2.2.3.2.3.cmml" mathsize="70%" xref="S4.Ex12.m1.2.2.3.2.3">model</mtext></ci></apply></apply></apply></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3"><times id="S4.Ex12.m1.3.3.1.1.2.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.1"></times><apply id="S4.Ex12.m1.3.3.1.1.2.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2"><divide id="S4.Ex12.m1.3.3.1.1.2.3.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2"></divide><cn id="S4.Ex12.m1.3.3.1.1.2.3.2.2.cmml" type="integer" xref="S4.Ex12.m1.3.3.1.1.2.3.2.2">1</cn><apply id="S4.Ex12.m1.3.3.1.1.2.3.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.2.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.2.3.2.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3.2">𝐿</ci><ci id="S4.Ex12.m1.3.3.1.1.2.3.2.3.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.2.3.3">𝐾</ci></apply></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3"><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.1.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1">superscript</csymbol><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1">subscript</csymbol><sum id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.2"></sum><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3"><eq id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.1"></eq><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.2">𝑗</ci><cn id="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.2.3.3">1</cn></apply></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.2">𝐿</ci><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.1.3.3">𝐾</ci></apply></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2"><divide id="S4.Ex12.m1.3.3.1.1.2.3.3.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2"></divide><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2"><times id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.1"></times><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.2">𝑞</ci><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.2.3">𝑖</ci></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3">superscript</csymbol><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.2">𝑘</ci><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.2.3.3">top</csymbol></apply></apply><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3"><root id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3a.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3"></root><apply id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.1.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2">subscript</csymbol><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.2.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.2">𝑑</ci><ci id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3a.cmml" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3"><mtext class="ltx_mathvariant_italic" id="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3.cmml" mathsize="70%" xref="S4.Ex12.m1.3.3.1.1.2.3.3.2.3.2.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex12.m1.3c">M(q_{i},K)=\max_{j}\left(\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}%
\right)-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{%
\text{model}}}}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex12.m1.3d">italic_M ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K ) = roman_max start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) - divide start_ARG 1 end_ARG start_ARG italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmtheorem2.p1.9"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.9.6">Let <math alttext="u=c\log L_{K}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.4.1.m1.1"><semantics id="Thmtheorem2.p1.4.1.m1.1a"><mrow id="Thmtheorem2.p1.4.1.m1.1.1" xref="Thmtheorem2.p1.4.1.m1.1.1.cmml"><mi id="Thmtheorem2.p1.4.1.m1.1.1.2" xref="Thmtheorem2.p1.4.1.m1.1.1.2.cmml">u</mi><mo id="Thmtheorem2.p1.4.1.m1.1.1.1" xref="Thmtheorem2.p1.4.1.m1.1.1.1.cmml">=</mo><mrow id="Thmtheorem2.p1.4.1.m1.1.1.3" xref="Thmtheorem2.p1.4.1.m1.1.1.3.cmml"><mi id="Thmtheorem2.p1.4.1.m1.1.1.3.2" xref="Thmtheorem2.p1.4.1.m1.1.1.3.2.cmml">c</mi><mo id="Thmtheorem2.p1.4.1.m1.1.1.3.1" lspace="0.167em" xref="Thmtheorem2.p1.4.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.4.1.m1.1.1.3.3" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.cmml"><mi id="Thmtheorem2.p1.4.1.m1.1.1.3.3.1" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.1.cmml">log</mi><mo id="Thmtheorem2.p1.4.1.m1.1.1.3.3a" lspace="0.167em" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.cmml">⁡</mo><msub id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.cmml"><mi id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.2" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.3" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.3.cmml">K</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.4.1.m1.1b"><apply id="Thmtheorem2.p1.4.1.m1.1.1.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1"><eq id="Thmtheorem2.p1.4.1.m1.1.1.1.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.1"></eq><ci id="Thmtheorem2.p1.4.1.m1.1.1.2.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.2">𝑢</ci><apply id="Thmtheorem2.p1.4.1.m1.1.1.3.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3"><times id="Thmtheorem2.p1.4.1.m1.1.1.3.1.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.1"></times><ci id="Thmtheorem2.p1.4.1.m1.1.1.3.2.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.2">𝑐</ci><apply id="Thmtheorem2.p1.4.1.m1.1.1.3.3.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3"><log id="Thmtheorem2.p1.4.1.m1.1.1.3.3.1.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.1"></log><apply id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.1.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.2.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.2">𝐿</ci><ci id="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.3.cmml" xref="Thmtheorem2.p1.4.1.m1.1.1.3.3.2.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.4.1.m1.1c">u=c\log L_{K}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.4.1.m1.1d">italic_u = italic_c roman_log italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> for some constant <math alttext="c&gt;0" class="ltx_Math" display="inline" id="Thmtheorem2.p1.5.2.m2.1"><semantics id="Thmtheorem2.p1.5.2.m2.1a"><mrow id="Thmtheorem2.p1.5.2.m2.1.1" xref="Thmtheorem2.p1.5.2.m2.1.1.cmml"><mi id="Thmtheorem2.p1.5.2.m2.1.1.2" xref="Thmtheorem2.p1.5.2.m2.1.1.2.cmml">c</mi><mo id="Thmtheorem2.p1.5.2.m2.1.1.1" xref="Thmtheorem2.p1.5.2.m2.1.1.1.cmml">&gt;</mo><mn id="Thmtheorem2.p1.5.2.m2.1.1.3" xref="Thmtheorem2.p1.5.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.5.2.m2.1b"><apply id="Thmtheorem2.p1.5.2.m2.1.1.cmml" xref="Thmtheorem2.p1.5.2.m2.1.1"><gt id="Thmtheorem2.p1.5.2.m2.1.1.1.cmml" xref="Thmtheorem2.p1.5.2.m2.1.1.1"></gt><ci id="Thmtheorem2.p1.5.2.m2.1.1.2.cmml" xref="Thmtheorem2.p1.5.2.m2.1.1.2">𝑐</ci><cn id="Thmtheorem2.p1.5.2.m2.1.1.3.cmml" type="integer" xref="Thmtheorem2.p1.5.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.5.2.m2.1c">c&gt;0</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.5.2.m2.1d">italic_c &gt; 0</annotation></semantics></math>. Compute full attention for the top-<math alttext="u" class="ltx_Math" display="inline" id="Thmtheorem2.p1.6.3.m3.1"><semantics id="Thmtheorem2.p1.6.3.m3.1a"><mi id="Thmtheorem2.p1.6.3.m3.1.1" xref="Thmtheorem2.p1.6.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.6.3.m3.1b"><ci id="Thmtheorem2.p1.6.3.m3.1.1.cmml" xref="Thmtheorem2.p1.6.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.6.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.6.3.m3.1d">italic_u</annotation></semantics></math> queries: <math alttext="\mathcal{O}(uL_{K})=\mathcal{O}(L_{K}\log L_{K})" class="ltx_Math" display="inline" id="Thmtheorem2.p1.7.4.m4.2"><semantics id="Thmtheorem2.p1.7.4.m4.2a"><mrow id="Thmtheorem2.p1.7.4.m4.2.2" xref="Thmtheorem2.p1.7.4.m4.2.2.cmml"><mrow id="Thmtheorem2.p1.7.4.m4.1.1.1" xref="Thmtheorem2.p1.7.4.m4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem2.p1.7.4.m4.1.1.1.3" xref="Thmtheorem2.p1.7.4.m4.1.1.1.3.cmml">𝒪</mi><mo id="Thmtheorem2.p1.7.4.m4.1.1.1.2" xref="Thmtheorem2.p1.7.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.cmml"><mo id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.2" stretchy="false" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.cmml"><mi id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.2" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.2.cmml">u</mi><mo id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.1" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.cmml"><mi id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.2" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.2.cmml">L</mi><mi id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.3" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.3.cmml">K</mi></msub></mrow><mo id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.3" stretchy="false" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem2.p1.7.4.m4.2.2.3" xref="Thmtheorem2.p1.7.4.m4.2.2.3.cmml">=</mo><mrow id="Thmtheorem2.p1.7.4.m4.2.2.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem2.p1.7.4.m4.2.2.2.3" xref="Thmtheorem2.p1.7.4.m4.2.2.2.3.cmml">𝒪</mi><mo id="Thmtheorem2.p1.7.4.m4.2.2.2.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.cmml"><mo id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.2" stretchy="false" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.cmml"><msub id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.cmml"><mi id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.3" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.3.cmml">K</mi></msub><mo id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.1" lspace="0.167em" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.cmml"><mi id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.1" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.1.cmml">log</mi><mo id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3a" lspace="0.167em" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.cmml">⁡</mo><msub id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.cmml"><mi id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.2" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.3" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.3.cmml">K</mi></msub></mrow></mrow><mo id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.3" stretchy="false" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.7.4.m4.2b"><apply id="Thmtheorem2.p1.7.4.m4.2.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2"><eq id="Thmtheorem2.p1.7.4.m4.2.2.3.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.3"></eq><apply id="Thmtheorem2.p1.7.4.m4.1.1.1.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1"><times id="Thmtheorem2.p1.7.4.m4.1.1.1.2.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.2"></times><ci id="Thmtheorem2.p1.7.4.m4.1.1.1.3.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.3">𝒪</ci><apply id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1"><times id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.1"></times><ci id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.2.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.2">𝑢</ci><apply id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.1.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.2.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.2">𝐿</ci><ci id="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.3.cmml" xref="Thmtheorem2.p1.7.4.m4.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply></apply><apply id="Thmtheorem2.p1.7.4.m4.2.2.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2"><times id="Thmtheorem2.p1.7.4.m4.2.2.2.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.2"></times><ci id="Thmtheorem2.p1.7.4.m4.2.2.2.3.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.3">𝒪</ci><apply id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1"><times id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.1.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.1"></times><apply id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.1.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2">subscript</csymbol><ci id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.2">𝐿</ci><ci id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.3.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.2.3">𝐾</ci></apply><apply id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3"><log id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.1.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.1"></log><apply id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.1.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.2.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.2">𝐿</ci><ci id="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.3.cmml" xref="Thmtheorem2.p1.7.4.m4.2.2.2.1.1.1.3.2.3">𝐾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.7.4.m4.2c">\mathcal{O}(uL_{K})=\mathcal{O}(L_{K}\log L_{K})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.7.4.m4.2d">caligraphic_O ( italic_u italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ) = caligraphic_O ( italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT roman_log italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT )</annotation></semantics></math>. Approximate the remaining queries using attention over <math alttext="u" class="ltx_Math" display="inline" id="Thmtheorem2.p1.8.5.m5.1"><semantics id="Thmtheorem2.p1.8.5.m5.1a"><mi id="Thmtheorem2.p1.8.5.m5.1.1" xref="Thmtheorem2.p1.8.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.8.5.m5.1b"><ci id="Thmtheorem2.p1.8.5.m5.1.1.cmml" xref="Thmtheorem2.p1.8.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.8.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.8.5.m5.1d">italic_u</annotation></semantics></math> keys: <math alttext="\mathcal{O}((L_{Q}-u)\cdot u)=\mathcal{O}(L_{Q}\log L_{K})" class="ltx_Math" display="inline" id="Thmtheorem2.p1.9.6.m6.2"><semantics id="Thmtheorem2.p1.9.6.m6.2a"><mrow id="Thmtheorem2.p1.9.6.m6.2.2" xref="Thmtheorem2.p1.9.6.m6.2.2.cmml"><mrow id="Thmtheorem2.p1.9.6.m6.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem2.p1.9.6.m6.1.1.1.3" xref="Thmtheorem2.p1.9.6.m6.1.1.1.3.cmml">𝒪</mi><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.2" xref="Thmtheorem2.p1.9.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.cmml"><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.2" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.cmml"><mrow id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.cmml"><msub id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.2" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.3" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.1" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.3" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.2" rspace="0.222em" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.3" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.3" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem2.p1.9.6.m6.2.2.3" xref="Thmtheorem2.p1.9.6.m6.2.2.3.cmml">=</mo><mrow id="Thmtheorem2.p1.9.6.m6.2.2.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem2.p1.9.6.m6.2.2.2.3" xref="Thmtheorem2.p1.9.6.m6.2.2.2.3.cmml">𝒪</mi><mo id="Thmtheorem2.p1.9.6.m6.2.2.2.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.2.cmml">⁢</mo><mrow id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.cmml"><mo id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.2" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.cmml"><msub id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.cmml"><mi id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.3" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.3.cmml">Q</mi></msub><mo id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.1" lspace="0.167em" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.cmml"><mi id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.1" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.1.cmml">log</mi><mo id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3a" lspace="0.167em" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.cmml">⁡</mo><msub id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.cmml"><mi id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.2" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.2.cmml">L</mi><mi id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.3" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.3.cmml">K</mi></msub></mrow></mrow><mo id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.3" stretchy="false" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.9.6.m6.2b"><apply id="Thmtheorem2.p1.9.6.m6.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2"><eq id="Thmtheorem2.p1.9.6.m6.2.2.3.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.3"></eq><apply id="Thmtheorem2.p1.9.6.m6.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1"><times id="Thmtheorem2.p1.9.6.m6.1.1.1.2.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.2"></times><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.3.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.3">𝒪</ci><apply id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1"><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.2.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.2">⋅</ci><apply id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1"><minus id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.1"></minus><apply id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.2">𝐿</ci><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><ci id="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.3.cmml" xref="Thmtheorem2.p1.9.6.m6.1.1.1.1.1.1.3">𝑢</ci></apply></apply><apply id="Thmtheorem2.p1.9.6.m6.2.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2"><times id="Thmtheorem2.p1.9.6.m6.2.2.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.2"></times><ci id="Thmtheorem2.p1.9.6.m6.2.2.2.3.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.3">𝒪</ci><apply id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1"><times id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.1.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.1"></times><apply id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.1.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2">subscript</csymbol><ci id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.2">𝐿</ci><ci id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.3.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.2.3">𝑄</ci></apply><apply id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3"><log id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.1.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.1"></log><apply id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.1.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.2.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.2">𝐿</ci><ci id="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.3.cmml" xref="Thmtheorem2.p1.9.6.m6.2.2.2.1.1.1.3.2.3">𝐾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.9.6.m6.2c">\mathcal{O}((L_{Q}-u)\cdot u)=\mathcal{O}(L_{Q}\log L_{K})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.9.6.m6.2d">caligraphic_O ( ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT - italic_u ) ⋅ italic_u ) = caligraphic_O ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT roman_log italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT )</annotation></semantics></math>.</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Total cost: }\mathcal{O}(L_{Q}\log L_{K}),\quad\text{assuming }L_{Q}\sim
L%
_{K}." class="ltx_Math" display="block" id="S4.Ex13.m1.1"><semantics id="S4.Ex13.m1.1a"><mrow id="S4.Ex13.m1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mrow id="S4.Ex13.m1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mrow id="S4.Ex13.m1.1.1.1.1.2.2" xref="S4.Ex13.m1.1.1.1.1.2.3.cmml"><mrow id="S4.Ex13.m1.1.1.1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S4.Ex13.m1.1.1.1.1.1.1.1.3" xref="S4.Ex13.m1.1.1.1.1.1.1.1.3a.cmml">Total cost: </mtext><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex13.m1.1.1.1.1.1.1.1.4" xref="S4.Ex13.m1.1.1.1.1.1.1.1.4.cmml">𝒪</mi><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.2a" xref="S4.Ex13.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.167em" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">K</mi></msub></mrow></mrow><mo id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex13.m1.1.1.1.1.2.2.3" rspace="1.167em" xref="S4.Ex13.m1.1.1.1.1.2.3.cmml">,</mo><mrow id="S4.Ex13.m1.1.1.1.1.2.2.2" xref="S4.Ex13.m1.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S4.Ex13.m1.1.1.1.1.2.2.2.2" xref="S4.Ex13.m1.1.1.1.1.2.2.2.2a.cmml">assuming </mtext><mo id="S4.Ex13.m1.1.1.1.1.2.2.2.1" xref="S4.Ex13.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S4.Ex13.m1.1.1.1.1.2.2.2.3" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.Ex13.m1.1.1.1.1.2.2.2.3.2" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3.2.cmml">L</mi><mi id="S4.Ex13.m1.1.1.1.1.2.2.2.3.3" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3.3.cmml">Q</mi></msub></mrow></mrow><mo id="S4.Ex13.m1.1.1.1.1.3" xref="S4.Ex13.m1.1.1.1.1.3.cmml">∼</mo><msub id="S4.Ex13.m1.1.1.1.1.4" xref="S4.Ex13.m1.1.1.1.1.4.cmml"><mi id="S4.Ex13.m1.1.1.1.1.4.2" xref="S4.Ex13.m1.1.1.1.1.4.2.cmml">L</mi><mi id="S4.Ex13.m1.1.1.1.1.4.3" xref="S4.Ex13.m1.1.1.1.1.4.3.cmml">K</mi></msub></mrow><mo id="S4.Ex13.m1.1.1.1.2" lspace="0em" xref="S4.Ex13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex13.m1.1b"><apply id="S4.Ex13.m1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1"><csymbol cd="latexml" id="S4.Ex13.m1.1.1.1.1.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3">similar-to</csymbol><list id="S4.Ex13.m1.1.1.1.1.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2"><apply id="S4.Ex13.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1"><times id="S4.Ex13.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.3a.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.Ex13.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.3">Total cost: </mtext></ci><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.4">𝒪</ci><apply id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1"><times id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐿</ci><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3"><log id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝐾</ci></apply></apply></apply></apply><apply id="S4.Ex13.m1.1.1.1.1.2.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2"><times id="S4.Ex13.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.1"></times><ci id="S4.Ex13.m1.1.1.1.1.2.2.2.2a.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_italic" id="S4.Ex13.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.2">assuming </mtext></ci><apply id="S4.Ex13.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3.2">𝐿</ci><ci id="S4.Ex13.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.Ex13.m1.1.1.1.1.2.2.2.3.3">𝑄</ci></apply></apply></list><apply id="S4.Ex13.m1.1.1.1.1.4.cmml" xref="S4.Ex13.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.4.1.cmml" xref="S4.Ex13.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.4.2.cmml" xref="S4.Ex13.m1.1.1.1.1.4.2">𝐿</ci><ci id="S4.Ex13.m1.1.1.1.1.4.3.cmml" xref="S4.Ex13.m1.1.1.1.1.4.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex13.m1.1c">\text{Total cost: }\mathcal{O}(L_{Q}\log L_{K}),\quad\text{assuming }L_{Q}\sim
L%
_{K}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex13.m1.1d">Total cost: caligraphic_O ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT roman_log italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ) , assuming italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∼ italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmtheorem2.p1.13"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.13.1">The approximation error satisfies:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|\Delta\text{Attention}\|\leq C\epsilon," class="ltx_Math" display="block" id="S4.Ex14.m1.1"><semantics id="S4.Ex14.m1.1a"><mrow id="S4.Ex14.m1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex14.m1.1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex14.m1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.Ex14.m1.1.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="S4.Ex14.m1.1.1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mtext class="ltx_mathvariant_italic" id="S4.Ex14.m1.1.1.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.1.1.1.3a.cmml">Attention</mtext></mrow><mo id="S4.Ex14.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.Ex14.m1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.2.cmml">≤</mo><mrow id="S4.Ex14.m1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.3.2" xref="S4.Ex14.m1.1.1.1.1.3.2.cmml">C</mi><mo id="S4.Ex14.m1.1.1.1.1.3.1" xref="S4.Ex14.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex14.m1.1.1.1.1.3.3" xref="S4.Ex14.m1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S4.Ex14.m1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex14.m1.1b"><apply id="S4.Ex14.m1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1"><leq id="S4.Ex14.m1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2"></leq><apply id="S4.Ex14.m1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex14.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex14.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1"><times id="S4.Ex14.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1"></times><ci id="S4.Ex14.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.2">Δ</ci><ci id="S4.Ex14.m1.1.1.1.1.1.1.1.3a.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.Ex14.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.3">Attention</mtext></ci></apply></apply><apply id="S4.Ex14.m1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3"><times id="S4.Ex14.m1.1.1.1.1.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.1"></times><ci id="S4.Ex14.m1.1.1.1.1.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2">𝐶</ci><ci id="S4.Ex14.m1.1.1.1.1.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex14.m1.1c">\|\Delta\text{Attention}\|\leq C\epsilon,</annotation><annotation encoding="application/x-llamapun" id="S4.Ex14.m1.1d">∥ roman_Δ Attention ∥ ≤ italic_C italic_ϵ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmtheorem2.p1.12"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.12.3">where <math alttext="\epsilon" class="ltx_Math" display="inline" id="Thmtheorem2.p1.10.1.m1.1"><semantics id="Thmtheorem2.p1.10.1.m1.1a"><mi id="Thmtheorem2.p1.10.1.m1.1.1" xref="Thmtheorem2.p1.10.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.10.1.m1.1b"><ci id="Thmtheorem2.p1.10.1.m1.1.1.cmml" xref="Thmtheorem2.p1.10.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.10.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.10.1.m1.1d">italic_ϵ</annotation></semantics></math> decays exponentially with <math alttext="u" class="ltx_Math" display="inline" id="Thmtheorem2.p1.11.2.m2.1"><semantics id="Thmtheorem2.p1.11.2.m2.1a"><mi id="Thmtheorem2.p1.11.2.m2.1.1" xref="Thmtheorem2.p1.11.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.11.2.m2.1b"><ci id="Thmtheorem2.p1.11.2.m2.1.1.cmml" xref="Thmtheorem2.p1.11.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.11.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.11.2.m2.1d">italic_u</annotation></semantics></math>, and <math alttext="C" class="ltx_Math" display="inline" id="Thmtheorem2.p1.12.3.m3.1"><semantics id="Thmtheorem2.p1.12.3.m3.1a"><mi id="Thmtheorem2.p1.12.3.m3.1.1" xref="Thmtheorem2.p1.12.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.12.3.m3.1b"><ci id="Thmtheorem2.p1.12.3.m3.1.1.cmml" xref="Thmtheorem2.p1.12.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.12.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.12.3.m3.1d">italic_C</annotation></semantics></math> is a constant. Thus, the reduction in complexity is achieved without significant loss in accuracy.</span></p>
</div>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span class="ltx_text ltx_font_typewriter" id="S5.1.1">Autoformer</span> Variants: Architecture and Computational Complexity</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_typewriter" id="S5.p1.1.1">Autoformer</span> addresses the limitations of Transformer-based time series forecasting by introducing a decomposition architecture that separates each input sequence into trend and seasonal components. This inductive bias improves forecasting stability and interpretability, especially for signals with periodic or long-term structural patterns. We present three architectural variants—Minimal, Standard, and Full—tailored to different forecasting tasks and computational budgets.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.2"><span class="ltx_text ltx_font_typewriter" id="S5.p2.2.1">Autoformer</span> applies a moving average filter <math alttext="\text{MA}_{k}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mtext id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2a.cmml">MA</mtext><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2a.cmml" xref="S5.p2.1.m1.1.1.2"><mtext id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">MA</mtext></ci><ci id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\text{MA}_{k}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">MA start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> of kernel size <math alttext="k" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">italic_k</annotation></semantics></math> to decompose each input into trend and seasonal components:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx9">
<tbody id="S5.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{i}^{\text{trend}}" class="ltx_Math" display="inline" id="S5.E30.m1.1"><semantics id="S5.E30.m1.1a"><msubsup id="S5.E30.m1.1.1" xref="S5.E30.m1.1.1.cmml"><mi id="S5.E30.m1.1.1.2.2" xref="S5.E30.m1.1.1.2.2.cmml">𝐱</mi><mi id="S5.E30.m1.1.1.2.3" xref="S5.E30.m1.1.1.2.3.cmml">i</mi><mtext id="S5.E30.m1.1.1.3" xref="S5.E30.m1.1.1.3a.cmml">trend</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S5.E30.m1.1b"><apply id="S5.E30.m1.1.1.cmml" xref="S5.E30.m1.1.1"><csymbol cd="ambiguous" id="S5.E30.m1.1.1.1.cmml" xref="S5.E30.m1.1.1">superscript</csymbol><apply id="S5.E30.m1.1.1.2.cmml" xref="S5.E30.m1.1.1"><csymbol cd="ambiguous" id="S5.E30.m1.1.1.2.1.cmml" xref="S5.E30.m1.1.1">subscript</csymbol><ci id="S5.E30.m1.1.1.2.2.cmml" xref="S5.E30.m1.1.1.2.2">𝐱</ci><ci id="S5.E30.m1.1.1.2.3.cmml" xref="S5.E30.m1.1.1.2.3">𝑖</ci></apply><ci id="S5.E30.m1.1.1.3a.cmml" xref="S5.E30.m1.1.1.3"><mtext id="S5.E30.m1.1.1.3.cmml" mathsize="70%" xref="S5.E30.m1.1.1.3">trend</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E30.m1.1c">\displaystyle\mathbf{x}_{i}^{\text{trend}}</annotation><annotation encoding="application/x-llamapun" id="S5.E30.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{MA}_{k}(\mathbf{x}_{i})," class="ltx_Math" display="inline" id="S5.E30.m2.1"><semantics id="S5.E30.m2.1a"><mrow id="S5.E30.m2.1.1.1" xref="S5.E30.m2.1.1.1.1.cmml"><mrow id="S5.E30.m2.1.1.1.1" xref="S5.E30.m2.1.1.1.1.cmml"><mi id="S5.E30.m2.1.1.1.1.3" xref="S5.E30.m2.1.1.1.1.3.cmml"></mi><mo id="S5.E30.m2.1.1.1.1.2" xref="S5.E30.m2.1.1.1.1.2.cmml">=</mo><mrow id="S5.E30.m2.1.1.1.1.1" xref="S5.E30.m2.1.1.1.1.1.cmml"><msub id="S5.E30.m2.1.1.1.1.1.3" xref="S5.E30.m2.1.1.1.1.1.3.cmml"><mtext id="S5.E30.m2.1.1.1.1.1.3.2" xref="S5.E30.m2.1.1.1.1.1.3.2a.cmml">MA</mtext><mi id="S5.E30.m2.1.1.1.1.1.3.3" xref="S5.E30.m2.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S5.E30.m2.1.1.1.1.1.2" xref="S5.E30.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E30.m2.1.1.1.1.1.1.1" xref="S5.E30.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E30.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E30.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E30.m2.1.1.1.1.1.1.1.1" xref="S5.E30.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E30.m2.1.1.1.1.1.1.1.1.2" xref="S5.E30.m2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S5.E30.m2.1.1.1.1.1.1.1.1.3" xref="S5.E30.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E30.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E30.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E30.m2.1.1.1.2" xref="S5.E30.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E30.m2.1b"><apply id="S5.E30.m2.1.1.1.1.cmml" xref="S5.E30.m2.1.1.1"><eq id="S5.E30.m2.1.1.1.1.2.cmml" xref="S5.E30.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S5.E30.m2.1.1.1.1.3.cmml" xref="S5.E30.m2.1.1.1.1.3">absent</csymbol><apply id="S5.E30.m2.1.1.1.1.1.cmml" xref="S5.E30.m2.1.1.1.1.1"><times id="S5.E30.m2.1.1.1.1.1.2.cmml" xref="S5.E30.m2.1.1.1.1.1.2"></times><apply id="S5.E30.m2.1.1.1.1.1.3.cmml" xref="S5.E30.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E30.m2.1.1.1.1.1.3.1.cmml" xref="S5.E30.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E30.m2.1.1.1.1.1.3.2a.cmml" xref="S5.E30.m2.1.1.1.1.1.3.2"><mtext id="S5.E30.m2.1.1.1.1.1.3.2.cmml" xref="S5.E30.m2.1.1.1.1.1.3.2">MA</mtext></ci><ci id="S5.E30.m2.1.1.1.1.1.3.3.cmml" xref="S5.E30.m2.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S5.E30.m2.1.1.1.1.1.1.1.1.cmml" xref="S5.E30.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E30.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E30.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E30.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E30.m2.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S5.E30.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E30.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E30.m2.1c">\displaystyle=\text{MA}_{k}(\mathbf{x}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S5.E30.m2.1d">= MA start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
<tbody id="S5.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{i}^{\text{seasonal}}" class="ltx_Math" display="inline" id="S5.E31.m1.1"><semantics id="S5.E31.m1.1a"><msubsup id="S5.E31.m1.1.1" xref="S5.E31.m1.1.1.cmml"><mi id="S5.E31.m1.1.1.2.2" xref="S5.E31.m1.1.1.2.2.cmml">𝐱</mi><mi id="S5.E31.m1.1.1.2.3" xref="S5.E31.m1.1.1.2.3.cmml">i</mi><mtext id="S5.E31.m1.1.1.3" xref="S5.E31.m1.1.1.3a.cmml">seasonal</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S5.E31.m1.1b"><apply id="S5.E31.m1.1.1.cmml" xref="S5.E31.m1.1.1"><csymbol cd="ambiguous" id="S5.E31.m1.1.1.1.cmml" xref="S5.E31.m1.1.1">superscript</csymbol><apply id="S5.E31.m1.1.1.2.cmml" xref="S5.E31.m1.1.1"><csymbol cd="ambiguous" id="S5.E31.m1.1.1.2.1.cmml" xref="S5.E31.m1.1.1">subscript</csymbol><ci id="S5.E31.m1.1.1.2.2.cmml" xref="S5.E31.m1.1.1.2.2">𝐱</ci><ci id="S5.E31.m1.1.1.2.3.cmml" xref="S5.E31.m1.1.1.2.3">𝑖</ci></apply><ci id="S5.E31.m1.1.1.3a.cmml" xref="S5.E31.m1.1.1.3"><mtext id="S5.E31.m1.1.1.3.cmml" mathsize="70%" xref="S5.E31.m1.1.1.3">seasonal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E31.m1.1c">\displaystyle\mathbf{x}_{i}^{\text{seasonal}}</annotation><annotation encoding="application/x-llamapun" id="S5.E31.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}-\mathbf{x}_{i}^{\text{trend}}," class="ltx_Math" display="inline" id="S5.E31.m2.1"><semantics id="S5.E31.m2.1a"><mrow id="S5.E31.m2.1.1.1" xref="S5.E31.m2.1.1.1.1.cmml"><mrow id="S5.E31.m2.1.1.1.1" xref="S5.E31.m2.1.1.1.1.cmml"><mi id="S5.E31.m2.1.1.1.1.2" xref="S5.E31.m2.1.1.1.1.2.cmml"></mi><mo id="S5.E31.m2.1.1.1.1.1" xref="S5.E31.m2.1.1.1.1.1.cmml">=</mo><mrow id="S5.E31.m2.1.1.1.1.3" xref="S5.E31.m2.1.1.1.1.3.cmml"><msub id="S5.E31.m2.1.1.1.1.3.2" xref="S5.E31.m2.1.1.1.1.3.2.cmml"><mi id="S5.E31.m2.1.1.1.1.3.2.2" xref="S5.E31.m2.1.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S5.E31.m2.1.1.1.1.3.2.3" xref="S5.E31.m2.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S5.E31.m2.1.1.1.1.3.1" xref="S5.E31.m2.1.1.1.1.3.1.cmml">−</mo><msubsup id="S5.E31.m2.1.1.1.1.3.3" xref="S5.E31.m2.1.1.1.1.3.3.cmml"><mi id="S5.E31.m2.1.1.1.1.3.3.2.2" xref="S5.E31.m2.1.1.1.1.3.3.2.2.cmml">𝐱</mi><mi id="S5.E31.m2.1.1.1.1.3.3.2.3" xref="S5.E31.m2.1.1.1.1.3.3.2.3.cmml">i</mi><mtext id="S5.E31.m2.1.1.1.1.3.3.3" xref="S5.E31.m2.1.1.1.1.3.3.3a.cmml">trend</mtext></msubsup></mrow></mrow><mo id="S5.E31.m2.1.1.1.2" xref="S5.E31.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E31.m2.1b"><apply id="S5.E31.m2.1.1.1.1.cmml" xref="S5.E31.m2.1.1.1"><eq id="S5.E31.m2.1.1.1.1.1.cmml" xref="S5.E31.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S5.E31.m2.1.1.1.1.2.cmml" xref="S5.E31.m2.1.1.1.1.2">absent</csymbol><apply id="S5.E31.m2.1.1.1.1.3.cmml" xref="S5.E31.m2.1.1.1.1.3"><minus id="S5.E31.m2.1.1.1.1.3.1.cmml" xref="S5.E31.m2.1.1.1.1.3.1"></minus><apply id="S5.E31.m2.1.1.1.1.3.2.cmml" xref="S5.E31.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E31.m2.1.1.1.1.3.2.1.cmml" xref="S5.E31.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S5.E31.m2.1.1.1.1.3.2.2.cmml" xref="S5.E31.m2.1.1.1.1.3.2.2">𝐱</ci><ci id="S5.E31.m2.1.1.1.1.3.2.3.cmml" xref="S5.E31.m2.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S5.E31.m2.1.1.1.1.3.3.cmml" xref="S5.E31.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.E31.m2.1.1.1.1.3.3.1.cmml" xref="S5.E31.m2.1.1.1.1.3.3">superscript</csymbol><apply id="S5.E31.m2.1.1.1.1.3.3.2.cmml" xref="S5.E31.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.E31.m2.1.1.1.1.3.3.2.1.cmml" xref="S5.E31.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S5.E31.m2.1.1.1.1.3.3.2.2.cmml" xref="S5.E31.m2.1.1.1.1.3.3.2.2">𝐱</ci><ci id="S5.E31.m2.1.1.1.1.3.3.2.3.cmml" xref="S5.E31.m2.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S5.E31.m2.1.1.1.1.3.3.3a.cmml" xref="S5.E31.m2.1.1.1.1.3.3.3"><mtext id="S5.E31.m2.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S5.E31.m2.1.1.1.1.3.3.3">trend</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E31.m2.1c">\displaystyle=\mathbf{x}_{i}-\mathbf{x}_{i}^{\text{trend}},</annotation><annotation encoding="application/x-llamapun" id="S5.E31.m2.1d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.p2.3">This decomposition is used throughout all model variants.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span><span class="ltx_text ltx_font_typewriter" id="S5.SS1.1.1">Autoformer</span> Minimal: Lightweight Forecasting with Minimal Overhead</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">The Minimal variant retains the decomposition structure but applies a short moving average (e.g. <math alttext="k=3" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">k</mi><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><eq id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">𝑘</ci><cn id="S5.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_k = 3</annotation></semantics></math>) and a shallow encoder-only Transformer. The seasonal component is embedded and positionally encoded:</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx10">
<tbody id="S5.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}" class="ltx_Math" display="inline" id="S5.E32.m1.1"><semantics id="S5.E32.m1.1a"><msub id="S5.E32.m1.1.1" xref="S5.E32.m1.1.1.cmml"><mi id="S5.E32.m1.1.1.2" xref="S5.E32.m1.1.1.2.cmml">𝐳</mi><mi id="S5.E32.m1.1.1.3" xref="S5.E32.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.E32.m1.1b"><apply id="S5.E32.m1.1.1.cmml" xref="S5.E32.m1.1.1"><csymbol cd="ambiguous" id="S5.E32.m1.1.1.1.cmml" xref="S5.E32.m1.1.1">subscript</csymbol><ci id="S5.E32.m1.1.1.2.cmml" xref="S5.E32.m1.1.1.2">𝐳</ci><ci id="S5.E32.m1.1.1.3.cmml" xref="S5.E32.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E32.m1.1c">\displaystyle\mathbf{z}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.E32.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Embed}(\mathbf{x}_{i}^{\text{seasonal}})+\text{PE}(i)," class="ltx_Math" display="inline" id="S5.E32.m2.2"><semantics id="S5.E32.m2.2a"><mrow id="S5.E32.m2.2.2.1" xref="S5.E32.m2.2.2.1.1.cmml"><mrow id="S5.E32.m2.2.2.1.1" xref="S5.E32.m2.2.2.1.1.cmml"><mi id="S5.E32.m2.2.2.1.1.3" xref="S5.E32.m2.2.2.1.1.3.cmml"></mi><mo id="S5.E32.m2.2.2.1.1.2" xref="S5.E32.m2.2.2.1.1.2.cmml">=</mo><mrow id="S5.E32.m2.2.2.1.1.1" xref="S5.E32.m2.2.2.1.1.1.cmml"><mrow id="S5.E32.m2.2.2.1.1.1.1" xref="S5.E32.m2.2.2.1.1.1.1.cmml"><mtext id="S5.E32.m2.2.2.1.1.1.1.3" xref="S5.E32.m2.2.2.1.1.1.1.3a.cmml">Embed</mtext><mo id="S5.E32.m2.2.2.1.1.1.1.2" xref="S5.E32.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E32.m2.2.2.1.1.1.1.1.1" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S5.E32.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S5.E32.m2.2.2.1.1.1.1.1.1.1" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S5.E32.m2.2.2.1.1.1.1.1.1.1.3" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.3a.cmml">seasonal</mtext></msubsup><mo id="S5.E32.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E32.m2.2.2.1.1.1.2" xref="S5.E32.m2.2.2.1.1.1.2.cmml">+</mo><mrow id="S5.E32.m2.2.2.1.1.1.3" xref="S5.E32.m2.2.2.1.1.1.3.cmml"><mtext id="S5.E32.m2.2.2.1.1.1.3.2" xref="S5.E32.m2.2.2.1.1.1.3.2a.cmml">PE</mtext><mo id="S5.E32.m2.2.2.1.1.1.3.1" xref="S5.E32.m2.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S5.E32.m2.2.2.1.1.1.3.3.2" xref="S5.E32.m2.2.2.1.1.1.3.cmml"><mo id="S5.E32.m2.2.2.1.1.1.3.3.2.1" stretchy="false" xref="S5.E32.m2.2.2.1.1.1.3.cmml">(</mo><mi id="S5.E32.m2.1.1" xref="S5.E32.m2.1.1.cmml">i</mi><mo id="S5.E32.m2.2.2.1.1.1.3.3.2.2" stretchy="false" xref="S5.E32.m2.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E32.m2.2.2.1.2" xref="S5.E32.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E32.m2.2b"><apply id="S5.E32.m2.2.2.1.1.cmml" xref="S5.E32.m2.2.2.1"><eq id="S5.E32.m2.2.2.1.1.2.cmml" xref="S5.E32.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S5.E32.m2.2.2.1.1.3.cmml" xref="S5.E32.m2.2.2.1.1.3">absent</csymbol><apply id="S5.E32.m2.2.2.1.1.1.cmml" xref="S5.E32.m2.2.2.1.1.1"><plus id="S5.E32.m2.2.2.1.1.1.2.cmml" xref="S5.E32.m2.2.2.1.1.1.2"></plus><apply id="S5.E32.m2.2.2.1.1.1.1.cmml" xref="S5.E32.m2.2.2.1.1.1.1"><times id="S5.E32.m2.2.2.1.1.1.1.2.cmml" xref="S5.E32.m2.2.2.1.1.1.1.2"></times><ci id="S5.E32.m2.2.2.1.1.1.1.3a.cmml" xref="S5.E32.m2.2.2.1.1.1.1.3"><mtext id="S5.E32.m2.2.2.1.1.1.1.3.cmml" xref="S5.E32.m2.2.2.1.1.1.1.3">Embed</mtext></ci><apply id="S5.E32.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E32.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.E32.m2.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.3"><mtext id="S5.E32.m2.2.2.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S5.E32.m2.2.2.1.1.1.1.1.1.1.3">seasonal</mtext></ci></apply></apply><apply id="S5.E32.m2.2.2.1.1.1.3.cmml" xref="S5.E32.m2.2.2.1.1.1.3"><times id="S5.E32.m2.2.2.1.1.1.3.1.cmml" xref="S5.E32.m2.2.2.1.1.1.3.1"></times><ci id="S5.E32.m2.2.2.1.1.1.3.2a.cmml" xref="S5.E32.m2.2.2.1.1.1.3.2"><mtext id="S5.E32.m2.2.2.1.1.1.3.2.cmml" xref="S5.E32.m2.2.2.1.1.1.3.2">PE</mtext></ci><ci id="S5.E32.m2.1.1.cmml" xref="S5.E32.m2.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E32.m2.2c">\displaystyle=\text{Embed}(\mathbf{x}_{i}^{\text{seasonal}})+\text{PE}(i),</annotation><annotation encoding="application/x-llamapun" id="S5.E32.m2.2d">= Embed ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT ) + PE ( italic_i ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
<tbody id="S5.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{i}" class="ltx_Math" display="inline" id="S5.E33.m1.1"><semantics id="S5.E33.m1.1a"><msub id="S5.E33.m1.1.1" xref="S5.E33.m1.1.1.cmml"><mi id="S5.E33.m1.1.1.2" xref="S5.E33.m1.1.1.2.cmml">𝐡</mi><mi id="S5.E33.m1.1.1.3" xref="S5.E33.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.E33.m1.1b"><apply id="S5.E33.m1.1.1.cmml" xref="S5.E33.m1.1.1"><csymbol cd="ambiguous" id="S5.E33.m1.1.1.1.cmml" xref="S5.E33.m1.1.1">subscript</csymbol><ci id="S5.E33.m1.1.1.2.cmml" xref="S5.E33.m1.1.1.2">𝐡</ci><ci id="S5.E33.m1.1.1.3.cmml" xref="S5.E33.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E33.m1.1c">\displaystyle\mathbf{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.E33.m1.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i})," class="ltx_Math" display="inline" id="S5.E33.m2.1"><semantics id="S5.E33.m2.1a"><mrow id="S5.E33.m2.1.1.1" xref="S5.E33.m2.1.1.1.1.cmml"><mrow id="S5.E33.m2.1.1.1.1" xref="S5.E33.m2.1.1.1.1.cmml"><mi id="S5.E33.m2.1.1.1.1.3" xref="S5.E33.m2.1.1.1.1.3.cmml"></mi><mo id="S5.E33.m2.1.1.1.1.2" xref="S5.E33.m2.1.1.1.1.2.cmml">=</mo><mrow id="S5.E33.m2.1.1.1.1.1" xref="S5.E33.m2.1.1.1.1.1.cmml"><mtext id="S5.E33.m2.1.1.1.1.1.3" xref="S5.E33.m2.1.1.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S5.E33.m2.1.1.1.1.1.2" xref="S5.E33.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E33.m2.1.1.1.1.1.1.1" xref="S5.E33.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E33.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E33.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E33.m2.1.1.1.1.1.1.1.1" xref="S5.E33.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E33.m2.1.1.1.1.1.1.1.1.2" xref="S5.E33.m2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S5.E33.m2.1.1.1.1.1.1.1.1.3" xref="S5.E33.m2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E33.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E33.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E33.m2.1.1.1.2" xref="S5.E33.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E33.m2.1b"><apply id="S5.E33.m2.1.1.1.1.cmml" xref="S5.E33.m2.1.1.1"><eq id="S5.E33.m2.1.1.1.1.2.cmml" xref="S5.E33.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S5.E33.m2.1.1.1.1.3.cmml" xref="S5.E33.m2.1.1.1.1.3">absent</csymbol><apply id="S5.E33.m2.1.1.1.1.1.cmml" xref="S5.E33.m2.1.1.1.1.1"><times id="S5.E33.m2.1.1.1.1.1.2.cmml" xref="S5.E33.m2.1.1.1.1.1.2"></times><ci id="S5.E33.m2.1.1.1.1.1.3a.cmml" xref="S5.E33.m2.1.1.1.1.1.3"><mtext id="S5.E33.m2.1.1.1.1.1.3.cmml" xref="S5.E33.m2.1.1.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S5.E33.m2.1.1.1.1.1.1.1.1.cmml" xref="S5.E33.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E33.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E33.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E33.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E33.m2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S5.E33.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E33.m2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E33.m2.1c">\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S5.E33.m2.1d">= TransformerEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">The final prediction combines the seasonal output with a linear projection of the trend:</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S5.E34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\underbrace{\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_%
{i})}_{\text{seasonal}}+\underbrace{\mathbf{W}_{t}\cdot\mathbf{x}_{i}^{\text{%
trend}}}_{\text{trend}}" class="ltx_Math" display="block" id="S5.E34.m1.1"><semantics id="S5.E34.m1.1a"><mrow id="S5.E34.m1.1.2" xref="S5.E34.m1.1.2.cmml"><msub id="S5.E34.m1.1.2.2" xref="S5.E34.m1.1.2.2.cmml"><mover accent="true" id="S5.E34.m1.1.2.2.2" xref="S5.E34.m1.1.2.2.2.cmml"><mi id="S5.E34.m1.1.2.2.2.2" xref="S5.E34.m1.1.2.2.2.2.cmml">𝐲</mi><mo id="S5.E34.m1.1.2.2.2.1" xref="S5.E34.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E34.m1.1.2.2.3" xref="S5.E34.m1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E34.m1.1.2.1" xref="S5.E34.m1.1.2.1.cmml">=</mo><mrow id="S5.E34.m1.1.2.3" xref="S5.E34.m1.1.2.3.cmml"><munder id="S5.E34.m1.1.2.3.2" xref="S5.E34.m1.1.2.3.2.cmml"><munder accentunder="true" id="S5.E34.m1.1.1" xref="S5.E34.m1.1.1.cmml"><mrow id="S5.E34.m1.1.1.1" xref="S5.E34.m1.1.1.1.cmml"><mrow id="S5.E34.m1.1.1.1.3" xref="S5.E34.m1.1.1.1.3.cmml"><msub id="S5.E34.m1.1.1.1.3.2" xref="S5.E34.m1.1.1.1.3.2.cmml"><mi id="S5.E34.m1.1.1.1.3.2.2" xref="S5.E34.m1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S5.E34.m1.1.1.1.3.2.3" xref="S5.E34.m1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="S5.E34.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S5.E34.m1.1.1.1.3.1.cmml">⋅</mo><mtext id="S5.E34.m1.1.1.1.3.3" xref="S5.E34.m1.1.1.1.3.3a.cmml">AvgPool</mtext></mrow><mo id="S5.E34.m1.1.1.1.2" xref="S5.E34.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E34.m1.1.1.1.1.1" xref="S5.E34.m1.1.1.1.1.1.1.cmml"><mo id="S5.E34.m1.1.1.1.1.1.2" stretchy="false" xref="S5.E34.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E34.m1.1.1.1.1.1.1" xref="S5.E34.m1.1.1.1.1.1.1.cmml"><mi id="S5.E34.m1.1.1.1.1.1.1.2" xref="S5.E34.m1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S5.E34.m1.1.1.1.1.1.1.3" xref="S5.E34.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E34.m1.1.1.1.1.1.3" stretchy="false" xref="S5.E34.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E34.m1.1.1.2" xref="S5.E34.m1.1.1.2.cmml">⏟</mo></munder><mtext id="S5.E34.m1.1.2.3.2.2" xref="S5.E34.m1.1.2.3.2.2a.cmml">seasonal</mtext></munder><mo id="S5.E34.m1.1.2.3.1" xref="S5.E34.m1.1.2.3.1.cmml">+</mo><munder id="S5.E34.m1.1.2.3.3" xref="S5.E34.m1.1.2.3.3.cmml"><munder accentunder="true" id="S5.E34.m1.1.2.3.3.2" xref="S5.E34.m1.1.2.3.3.2.cmml"><mrow id="S5.E34.m1.1.2.3.3.2.2" xref="S5.E34.m1.1.2.3.3.2.2.cmml"><msub id="S5.E34.m1.1.2.3.3.2.2.2" xref="S5.E34.m1.1.2.3.3.2.2.2.cmml"><mi id="S5.E34.m1.1.2.3.3.2.2.2.2" xref="S5.E34.m1.1.2.3.3.2.2.2.2.cmml">𝐖</mi><mi id="S5.E34.m1.1.2.3.3.2.2.2.3" xref="S5.E34.m1.1.2.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S5.E34.m1.1.2.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E34.m1.1.2.3.3.2.2.1.cmml">⋅</mo><msubsup id="S5.E34.m1.1.2.3.3.2.2.3" xref="S5.E34.m1.1.2.3.3.2.2.3.cmml"><mi id="S5.E34.m1.1.2.3.3.2.2.3.2.2" xref="S5.E34.m1.1.2.3.3.2.2.3.2.2.cmml">𝐱</mi><mi id="S5.E34.m1.1.2.3.3.2.2.3.2.3" xref="S5.E34.m1.1.2.3.3.2.2.3.2.3.cmml">i</mi><mtext id="S5.E34.m1.1.2.3.3.2.2.3.3" xref="S5.E34.m1.1.2.3.3.2.2.3.3a.cmml">trend</mtext></msubsup></mrow><mo id="S5.E34.m1.1.2.3.3.2.1" xref="S5.E34.m1.1.2.3.3.2.1.cmml">⏟</mo></munder><mtext id="S5.E34.m1.1.2.3.3.3" xref="S5.E34.m1.1.2.3.3.3a.cmml">trend</mtext></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E34.m1.1b"><apply id="S5.E34.m1.1.2.cmml" xref="S5.E34.m1.1.2"><eq id="S5.E34.m1.1.2.1.cmml" xref="S5.E34.m1.1.2.1"></eq><apply id="S5.E34.m1.1.2.2.cmml" xref="S5.E34.m1.1.2.2"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.2.1.cmml" xref="S5.E34.m1.1.2.2">subscript</csymbol><apply id="S5.E34.m1.1.2.2.2.cmml" xref="S5.E34.m1.1.2.2.2"><ci id="S5.E34.m1.1.2.2.2.1.cmml" xref="S5.E34.m1.1.2.2.2.1">^</ci><ci id="S5.E34.m1.1.2.2.2.2.cmml" xref="S5.E34.m1.1.2.2.2.2">𝐲</ci></apply><ci id="S5.E34.m1.1.2.2.3.cmml" xref="S5.E34.m1.1.2.2.3">𝑖</ci></apply><apply id="S5.E34.m1.1.2.3.cmml" xref="S5.E34.m1.1.2.3"><plus id="S5.E34.m1.1.2.3.1.cmml" xref="S5.E34.m1.1.2.3.1"></plus><apply id="S5.E34.m1.1.2.3.2.cmml" xref="S5.E34.m1.1.2.3.2"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.3.2.1.cmml" xref="S5.E34.m1.1.2.3.2">subscript</csymbol><apply id="S5.E34.m1.1.1.cmml" xref="S5.E34.m1.1.1"><ci id="S5.E34.m1.1.1.2.cmml" xref="S5.E34.m1.1.1.2">⏟</ci><apply id="S5.E34.m1.1.1.1.cmml" xref="S5.E34.m1.1.1.1"><times id="S5.E34.m1.1.1.1.2.cmml" xref="S5.E34.m1.1.1.1.2"></times><apply id="S5.E34.m1.1.1.1.3.cmml" xref="S5.E34.m1.1.1.1.3"><ci id="S5.E34.m1.1.1.1.3.1.cmml" xref="S5.E34.m1.1.1.1.3.1">⋅</ci><apply id="S5.E34.m1.1.1.1.3.2.cmml" xref="S5.E34.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E34.m1.1.1.1.3.2.1.cmml" xref="S5.E34.m1.1.1.1.3.2">subscript</csymbol><ci id="S5.E34.m1.1.1.1.3.2.2.cmml" xref="S5.E34.m1.1.1.1.3.2.2">𝐖</ci><ci id="S5.E34.m1.1.1.1.3.2.3.cmml" xref="S5.E34.m1.1.1.1.3.2.3">𝑜</ci></apply><ci id="S5.E34.m1.1.1.1.3.3a.cmml" xref="S5.E34.m1.1.1.1.3.3"><mtext id="S5.E34.m1.1.1.1.3.3.cmml" xref="S5.E34.m1.1.1.1.3.3">AvgPool</mtext></ci></apply><apply id="S5.E34.m1.1.1.1.1.1.1.cmml" xref="S5.E34.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E34.m1.1.1.1.1.1.1.1.cmml" xref="S5.E34.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.E34.m1.1.1.1.1.1.1.2.cmml" xref="S5.E34.m1.1.1.1.1.1.1.2">𝐡</ci><ci id="S5.E34.m1.1.1.1.1.1.1.3.cmml" xref="S5.E34.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><ci id="S5.E34.m1.1.2.3.2.2a.cmml" xref="S5.E34.m1.1.2.3.2.2"><mtext id="S5.E34.m1.1.2.3.2.2.cmml" mathsize="70%" xref="S5.E34.m1.1.2.3.2.2">seasonal</mtext></ci></apply><apply id="S5.E34.m1.1.2.3.3.cmml" xref="S5.E34.m1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.3.3.1.cmml" xref="S5.E34.m1.1.2.3.3">subscript</csymbol><apply id="S5.E34.m1.1.2.3.3.2.cmml" xref="S5.E34.m1.1.2.3.3.2"><ci id="S5.E34.m1.1.2.3.3.2.1.cmml" xref="S5.E34.m1.1.2.3.3.2.1">⏟</ci><apply id="S5.E34.m1.1.2.3.3.2.2.cmml" xref="S5.E34.m1.1.2.3.3.2.2"><ci id="S5.E34.m1.1.2.3.3.2.2.1.cmml" xref="S5.E34.m1.1.2.3.3.2.2.1">⋅</ci><apply id="S5.E34.m1.1.2.3.3.2.2.2.cmml" xref="S5.E34.m1.1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.3.3.2.2.2.1.cmml" xref="S5.E34.m1.1.2.3.3.2.2.2">subscript</csymbol><ci id="S5.E34.m1.1.2.3.3.2.2.2.2.cmml" xref="S5.E34.m1.1.2.3.3.2.2.2.2">𝐖</ci><ci id="S5.E34.m1.1.2.3.3.2.2.2.3.cmml" xref="S5.E34.m1.1.2.3.3.2.2.2.3">𝑡</ci></apply><apply id="S5.E34.m1.1.2.3.3.2.2.3.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.3.3.2.2.3.1.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3">superscript</csymbol><apply id="S5.E34.m1.1.2.3.3.2.2.3.2.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.E34.m1.1.2.3.3.2.2.3.2.1.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3">subscript</csymbol><ci id="S5.E34.m1.1.2.3.3.2.2.3.2.2.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3.2.2">𝐱</ci><ci id="S5.E34.m1.1.2.3.3.2.2.3.2.3.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3.2.3">𝑖</ci></apply><ci id="S5.E34.m1.1.2.3.3.2.2.3.3a.cmml" xref="S5.E34.m1.1.2.3.3.2.2.3.3"><mtext id="S5.E34.m1.1.2.3.3.2.2.3.3.cmml" mathsize="70%" xref="S5.E34.m1.1.2.3.3.2.2.3.3">trend</mtext></ci></apply></apply></apply><ci id="S5.E34.m1.1.2.3.3.3a.cmml" xref="S5.E34.m1.1.2.3.3.3"><mtext id="S5.E34.m1.1.2.3.3.3.cmml" mathsize="70%" xref="S5.E34.m1.1.2.3.3.3">trend</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E34.m1.1c">\hat{\mathbf{y}}_{i}=\underbrace{\mathbf{W}_{o}\cdot\text{AvgPool}(\mathbf{h}_%
{i})}_{\text{seasonal}}+\underbrace{\mathbf{W}_{t}\cdot\mathbf{x}_{i}^{\text{%
trend}}}_{\text{trend}}</annotation><annotation encoding="application/x-llamapun" id="S5.E34.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = under⏟ start_ARG bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ AvgPool ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT seasonal end_POSTSUBSCRIPT + under⏟ start_ARG bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT trend end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
</div>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p1">
<table class="ltx_equation ltx_eqn_table" id="S5.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Simple}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}." class="ltx_Math" display="block" id="S5.Ex15.m1.1"><semantics id="S5.Ex15.m1.1a"><mrow id="S5.Ex15.m1.1.1.1" xref="S5.Ex15.m1.1.1.1.1.cmml"><mrow id="S5.Ex15.m1.1.1.1.1" xref="S5.Ex15.m1.1.1.1.1.cmml"><msub id="S5.Ex15.m1.1.1.1.1.2" xref="S5.Ex15.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Ex15.m1.1.1.1.1.2.2" xref="S5.Ex15.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S5.Ex15.m1.1.1.1.1.2.3" xref="S5.Ex15.m1.1.1.1.1.2.3a.cmml">Simple</mtext></msub><mo id="S5.Ex15.m1.1.1.1.1.1" xref="S5.Ex15.m1.1.1.1.1.1.cmml">=</mo><mrow id="S5.Ex15.m1.1.1.1.1.3" xref="S5.Ex15.m1.1.1.1.1.3.cmml"><munder id="S5.Ex15.m1.1.1.1.1.3.2" xref="S5.Ex15.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S5.Ex15.m1.1.1.1.1.3.2.2" xref="S5.Ex15.m1.1.1.1.1.3.2.2.cmml"><mrow id="S5.Ex15.m1.1.1.1.1.3.2.2.2" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.cmml"><msup id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.2" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.2.cmml">P</mi><mn id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.3" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.3.cmml">2</mn></msup><mo id="S5.Ex15.m1.1.1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.1.cmml">⋅</mo><msub id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.2" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.2.cmml">d</mi><mtext id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S5.Ex15.m1.1.1.1.1.3.2.2.1" xref="S5.Ex15.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex15.m1.1.1.1.1.3.2.3" xref="S5.Ex15.m1.1.1.1.1.3.2.3a.cmml">Self-Attention</mtext></munder><mo id="S5.Ex15.m1.1.1.1.1.3.1" xref="S5.Ex15.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S5.Ex15.m1.1.1.1.1.3.3" xref="S5.Ex15.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S5.Ex15.m1.1.1.1.1.3.3.2" xref="S5.Ex15.m1.1.1.1.1.3.3.2.cmml"><mrow id="S5.Ex15.m1.1.1.1.1.3.3.2.2" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S5.Ex15.m1.1.1.1.1.3.3.2.2.2" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.2.cmml">P</mi><mo id="S5.Ex15.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msubsup id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.2" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.2.cmml">d</mi><mtext id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml">model</mtext><mn id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.3" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S5.Ex15.m1.1.1.1.1.3.3.2.1" xref="S5.Ex15.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex15.m1.1.1.1.1.3.3.3" xref="S5.Ex15.m1.1.1.1.1.3.3.3a.cmml">Feedforward Layers</mtext></munder></mrow></mrow><mo id="S5.Ex15.m1.1.1.1.2" lspace="0em" xref="S5.Ex15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex15.m1.1b"><apply id="S5.Ex15.m1.1.1.1.1.cmml" xref="S5.Ex15.m1.1.1.1"><eq id="S5.Ex15.m1.1.1.1.1.1.cmml" xref="S5.Ex15.m1.1.1.1.1.1"></eq><apply id="S5.Ex15.m1.1.1.1.1.2.cmml" xref="S5.Ex15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex15.m1.1.1.1.1.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.2.2">𝒪</ci><ci id="S5.Ex15.m1.1.1.1.1.2.3a.cmml" xref="S5.Ex15.m1.1.1.1.1.2.3"><mtext id="S5.Ex15.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S5.Ex15.m1.1.1.1.1.2.3">Simple</mtext></ci></apply><apply id="S5.Ex15.m1.1.1.1.1.3.cmml" xref="S5.Ex15.m1.1.1.1.1.3"><plus id="S5.Ex15.m1.1.1.1.1.3.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.1"></plus><apply id="S5.Ex15.m1.1.1.1.1.3.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S5.Ex15.m1.1.1.1.1.3.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2"><ci id="S5.Ex15.m1.1.1.1.1.3.2.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S5.Ex15.m1.1.1.1.1.3.2.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2"><ci id="S5.Ex15.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.1">⋅</ci><apply id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2">superscript</csymbol><ci id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.2">𝑃</ci><cn id="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.3.cmml" type="integer" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.2.3">2</cn></apply><apply id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.2">𝑑</ci><ci id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3a.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3"><mtext id="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3.cmml" mathsize="70%" xref="S5.Ex15.m1.1.1.1.1.3.2.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S5.Ex15.m1.1.1.1.1.3.2.3a.cmml" xref="S5.Ex15.m1.1.1.1.1.3.2.3"><mtext id="S5.Ex15.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S5.Ex15.m1.1.1.1.1.3.2.3">Self-Attention</mtext></ci></apply><apply id="S5.Ex15.m1.1.1.1.1.3.3.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.3.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S5.Ex15.m1.1.1.1.1.3.3.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2"><ci id="S5.Ex15.m1.1.1.1.1.3.3.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S5.Ex15.m1.1.1.1.1.3.3.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2"><ci id="S5.Ex15.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.1">⋅</ci><ci id="S5.Ex15.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.2">𝑃</ci><apply id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3">superscript</csymbol><apply id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.1.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.2.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.2">𝑑</ci><ci id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3"><mtext id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3.cmml" mathsize="70%" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.2.3">model</mtext></ci></apply><cn id="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S5.Ex15.m1.1.1.1.1.3.3.2.2.3.3">2</cn></apply></apply></apply><ci id="S5.Ex15.m1.1.1.1.1.3.3.3a.cmml" xref="S5.Ex15.m1.1.1.1.1.3.3.3"><mtext id="S5.Ex15.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S5.Ex15.m1.1.1.1.1.3.3.3">Feedforward Layers</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex15.m1.1c">\mathcal{O}_{\text{Simple}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}.</annotation><annotation encoding="application/x-llamapun" id="S5.Ex15.m1.1d">caligraphic_O start_POSTSUBSCRIPT Simple end_POSTSUBSCRIPT = under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Self-Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Feedforward Layers end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span><span class="ltx_text ltx_font_typewriter" id="S5.SS2.1.1">Autoformer</span> Standard: Improved Stability with Enhanced Decomposition Awareness</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The Standard variant builds on the Minimal design, retaining the same decomposition mechanism and encoder structure, but with deeper residual blocks, better weight initialization, and loss balancing for trend and seasonal outputs. These improvements enhance robustness on medium-term horizons.</p>
</div>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<table class="ltx_equation ltx_eqn_table" id="S5.Ex16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Standard}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}." class="ltx_Math" display="block" id="S5.Ex16.m1.1"><semantics id="S5.Ex16.m1.1a"><mrow id="S5.Ex16.m1.1.1.1" xref="S5.Ex16.m1.1.1.1.1.cmml"><mrow id="S5.Ex16.m1.1.1.1.1" xref="S5.Ex16.m1.1.1.1.1.cmml"><msub id="S5.Ex16.m1.1.1.1.1.2" xref="S5.Ex16.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Ex16.m1.1.1.1.1.2.2" xref="S5.Ex16.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S5.Ex16.m1.1.1.1.1.2.3" xref="S5.Ex16.m1.1.1.1.1.2.3a.cmml">Standard</mtext></msub><mo id="S5.Ex16.m1.1.1.1.1.1" xref="S5.Ex16.m1.1.1.1.1.1.cmml">=</mo><mrow id="S5.Ex16.m1.1.1.1.1.3" xref="S5.Ex16.m1.1.1.1.1.3.cmml"><munder id="S5.Ex16.m1.1.1.1.1.3.2" xref="S5.Ex16.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S5.Ex16.m1.1.1.1.1.3.2.2" xref="S5.Ex16.m1.1.1.1.1.3.2.2.cmml"><mrow id="S5.Ex16.m1.1.1.1.1.3.2.2.2" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.cmml"><msup id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.2" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.2.cmml">P</mi><mn id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.3" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.3.cmml">2</mn></msup><mo id="S5.Ex16.m1.1.1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.1.cmml">⋅</mo><msub id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.2" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.2.cmml">d</mi><mtext id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S5.Ex16.m1.1.1.1.1.3.2.2.1" xref="S5.Ex16.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex16.m1.1.1.1.1.3.2.3" xref="S5.Ex16.m1.1.1.1.1.3.2.3a.cmml">Self-Attention</mtext></munder><mo id="S5.Ex16.m1.1.1.1.1.3.1" xref="S5.Ex16.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S5.Ex16.m1.1.1.1.1.3.3" xref="S5.Ex16.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S5.Ex16.m1.1.1.1.1.3.3.2" xref="S5.Ex16.m1.1.1.1.1.3.3.2.cmml"><mrow id="S5.Ex16.m1.1.1.1.1.3.3.2.2" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S5.Ex16.m1.1.1.1.1.3.3.2.2.2" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.2.cmml">P</mi><mo id="S5.Ex16.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msubsup id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.2" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.2.cmml">d</mi><mtext id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml">model</mtext><mn id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.3" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.3.cmml">2</mn></msubsup></mrow><mo id="S5.Ex16.m1.1.1.1.1.3.3.2.1" xref="S5.Ex16.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex16.m1.1.1.1.1.3.3.3" xref="S5.Ex16.m1.1.1.1.1.3.3.3a.cmml">Feedforward Layers</mtext></munder></mrow></mrow><mo id="S5.Ex16.m1.1.1.1.2" lspace="0em" xref="S5.Ex16.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex16.m1.1b"><apply id="S5.Ex16.m1.1.1.1.1.cmml" xref="S5.Ex16.m1.1.1.1"><eq id="S5.Ex16.m1.1.1.1.1.1.cmml" xref="S5.Ex16.m1.1.1.1.1.1"></eq><apply id="S5.Ex16.m1.1.1.1.1.2.cmml" xref="S5.Ex16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex16.m1.1.1.1.1.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.2.2">𝒪</ci><ci id="S5.Ex16.m1.1.1.1.1.2.3a.cmml" xref="S5.Ex16.m1.1.1.1.1.2.3"><mtext id="S5.Ex16.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S5.Ex16.m1.1.1.1.1.2.3">Standard</mtext></ci></apply><apply id="S5.Ex16.m1.1.1.1.1.3.cmml" xref="S5.Ex16.m1.1.1.1.1.3"><plus id="S5.Ex16.m1.1.1.1.1.3.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.1"></plus><apply id="S5.Ex16.m1.1.1.1.1.3.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S5.Ex16.m1.1.1.1.1.3.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2"><ci id="S5.Ex16.m1.1.1.1.1.3.2.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S5.Ex16.m1.1.1.1.1.3.2.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2"><ci id="S5.Ex16.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.1">⋅</ci><apply id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2">superscript</csymbol><ci id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.2">𝑃</ci><cn id="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.3.cmml" type="integer" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.2.3">2</cn></apply><apply id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.2">𝑑</ci><ci id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3a.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3"><mtext id="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3.cmml" mathsize="70%" xref="S5.Ex16.m1.1.1.1.1.3.2.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S5.Ex16.m1.1.1.1.1.3.2.3a.cmml" xref="S5.Ex16.m1.1.1.1.1.3.2.3"><mtext id="S5.Ex16.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S5.Ex16.m1.1.1.1.1.3.2.3">Self-Attention</mtext></ci></apply><apply id="S5.Ex16.m1.1.1.1.1.3.3.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.3.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S5.Ex16.m1.1.1.1.1.3.3.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2"><ci id="S5.Ex16.m1.1.1.1.1.3.3.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S5.Ex16.m1.1.1.1.1.3.3.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2"><ci id="S5.Ex16.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.1">⋅</ci><ci id="S5.Ex16.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.2">𝑃</ci><apply id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3">superscript</csymbol><apply id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.1.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.2.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.2">𝑑</ci><ci id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3a.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3"><mtext id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3.cmml" mathsize="70%" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.2.3">model</mtext></ci></apply><cn id="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S5.Ex16.m1.1.1.1.1.3.3.2.2.3.3">2</cn></apply></apply></apply><ci id="S5.Ex16.m1.1.1.1.1.3.3.3a.cmml" xref="S5.Ex16.m1.1.1.1.1.3.3.3"><mtext id="S5.Ex16.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S5.Ex16.m1.1.1.1.1.3.3.3">Feedforward Layers</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex16.m1.1c">\mathcal{O}_{\text{Standard}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Self-Attention}}+\underbrace{P\cdot d_{\text{model}}^{2}}_{\text{Feedforward %
Layers}}.</annotation><annotation encoding="application/x-llamapun" id="S5.Ex16.m1.1d">caligraphic_O start_POSTSUBSCRIPT Standard end_POSTSUBSCRIPT = under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Self-Attention end_POSTSUBSCRIPT + under⏟ start_ARG italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Feedforward Layers end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span><span class="ltx_text ltx_font_typewriter" id="S5.SS3.1.1">Autoformer</span> Full: Sequence-to-Sequence Modeling for Long-Horizon Forecasts</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">The Full variant introduces a sequence-to-sequence encoder-decoder design with longer moving average filtering (e.g., <math alttext="k=25" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">k</mi><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><eq id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></eq><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑘</ci><cn id="S5.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS3.p1.1.m1.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">k=25</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_k = 25</annotation></semantics></math>). This variant is built for complex, long-horizon forecasting where future sequences differ structurally from the past.</p>
</div>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Encoder</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px1.p1">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx11">
<tbody id="S5.E35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}^{(e)}" class="ltx_Math" display="inline" id="S5.E35.m1.1"><semantics id="S5.E35.m1.1a"><msubsup id="S5.E35.m1.1.2" xref="S5.E35.m1.1.2.cmml"><mi id="S5.E35.m1.1.2.2.2" xref="S5.E35.m1.1.2.2.2.cmml">𝐳</mi><mi id="S5.E35.m1.1.2.2.3" xref="S5.E35.m1.1.2.2.3.cmml">i</mi><mrow id="S5.E35.m1.1.1.1.3" xref="S5.E35.m1.1.2.cmml"><mo id="S5.E35.m1.1.1.1.3.1" stretchy="false" xref="S5.E35.m1.1.2.cmml">(</mo><mi id="S5.E35.m1.1.1.1.1" xref="S5.E35.m1.1.1.1.1.cmml">e</mi><mo id="S5.E35.m1.1.1.1.3.2" stretchy="false" xref="S5.E35.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.E35.m1.1b"><apply id="S5.E35.m1.1.2.cmml" xref="S5.E35.m1.1.2"><csymbol cd="ambiguous" id="S5.E35.m1.1.2.1.cmml" xref="S5.E35.m1.1.2">superscript</csymbol><apply id="S5.E35.m1.1.2.2.cmml" xref="S5.E35.m1.1.2"><csymbol cd="ambiguous" id="S5.E35.m1.1.2.2.1.cmml" xref="S5.E35.m1.1.2">subscript</csymbol><ci id="S5.E35.m1.1.2.2.2.cmml" xref="S5.E35.m1.1.2.2.2">𝐳</ci><ci id="S5.E35.m1.1.2.2.3.cmml" xref="S5.E35.m1.1.2.2.3">𝑖</ci></apply><ci id="S5.E35.m1.1.1.1.1.cmml" xref="S5.E35.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E35.m1.1c">\displaystyle\mathbf{z}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S5.E35.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{x}_{i}^{\text{seasonal}}\cdot\mathbf{W}_{e}^{(e)}+\text{%
PE}^{(e)}," class="ltx_Math" display="inline" id="S5.E35.m2.3"><semantics id="S5.E35.m2.3a"><mrow id="S5.E35.m2.3.3.1" xref="S5.E35.m2.3.3.1.1.cmml"><mrow id="S5.E35.m2.3.3.1.1" xref="S5.E35.m2.3.3.1.1.cmml"><mi id="S5.E35.m2.3.3.1.1.2" xref="S5.E35.m2.3.3.1.1.2.cmml"></mi><mo id="S5.E35.m2.3.3.1.1.1" xref="S5.E35.m2.3.3.1.1.1.cmml">=</mo><mrow id="S5.E35.m2.3.3.1.1.3" xref="S5.E35.m2.3.3.1.1.3.cmml"><mrow id="S5.E35.m2.3.3.1.1.3.2" xref="S5.E35.m2.3.3.1.1.3.2.cmml"><msubsup id="S5.E35.m2.3.3.1.1.3.2.2" xref="S5.E35.m2.3.3.1.1.3.2.2.cmml"><mi id="S5.E35.m2.3.3.1.1.3.2.2.2.2" xref="S5.E35.m2.3.3.1.1.3.2.2.2.2.cmml">𝐱</mi><mi id="S5.E35.m2.3.3.1.1.3.2.2.2.3" xref="S5.E35.m2.3.3.1.1.3.2.2.2.3.cmml">i</mi><mtext id="S5.E35.m2.3.3.1.1.3.2.2.3" xref="S5.E35.m2.3.3.1.1.3.2.2.3a.cmml">seasonal</mtext></msubsup><mo id="S5.E35.m2.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E35.m2.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S5.E35.m2.3.3.1.1.3.2.3" xref="S5.E35.m2.3.3.1.1.3.2.3.cmml"><mi id="S5.E35.m2.3.3.1.1.3.2.3.2.2" xref="S5.E35.m2.3.3.1.1.3.2.3.2.2.cmml">𝐖</mi><mi id="S5.E35.m2.3.3.1.1.3.2.3.2.3" xref="S5.E35.m2.3.3.1.1.3.2.3.2.3.cmml">e</mi><mrow id="S5.E35.m2.1.1.1.3" xref="S5.E35.m2.3.3.1.1.3.2.3.cmml"><mo id="S5.E35.m2.1.1.1.3.1" stretchy="false" xref="S5.E35.m2.3.3.1.1.3.2.3.cmml">(</mo><mi id="S5.E35.m2.1.1.1.1" xref="S5.E35.m2.1.1.1.1.cmml">e</mi><mo id="S5.E35.m2.1.1.1.3.2" stretchy="false" xref="S5.E35.m2.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E35.m2.3.3.1.1.3.1" xref="S5.E35.m2.3.3.1.1.3.1.cmml">+</mo><msup id="S5.E35.m2.3.3.1.1.3.3" xref="S5.E35.m2.3.3.1.1.3.3.cmml"><mtext id="S5.E35.m2.3.3.1.1.3.3.2" xref="S5.E35.m2.3.3.1.1.3.3.2a.cmml">PE</mtext><mrow id="S5.E35.m2.2.2.1.3" xref="S5.E35.m2.3.3.1.1.3.3.cmml"><mo id="S5.E35.m2.2.2.1.3.1" stretchy="false" xref="S5.E35.m2.3.3.1.1.3.3.cmml">(</mo><mi id="S5.E35.m2.2.2.1.1" xref="S5.E35.m2.2.2.1.1.cmml">e</mi><mo id="S5.E35.m2.2.2.1.3.2" stretchy="false" xref="S5.E35.m2.3.3.1.1.3.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S5.E35.m2.3.3.1.2" xref="S5.E35.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E35.m2.3b"><apply id="S5.E35.m2.3.3.1.1.cmml" xref="S5.E35.m2.3.3.1"><eq id="S5.E35.m2.3.3.1.1.1.cmml" xref="S5.E35.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S5.E35.m2.3.3.1.1.2.cmml" xref="S5.E35.m2.3.3.1.1.2">absent</csymbol><apply id="S5.E35.m2.3.3.1.1.3.cmml" xref="S5.E35.m2.3.3.1.1.3"><plus id="S5.E35.m2.3.3.1.1.3.1.cmml" xref="S5.E35.m2.3.3.1.1.3.1"></plus><apply id="S5.E35.m2.3.3.1.1.3.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2"><ci id="S5.E35.m2.3.3.1.1.3.2.1.cmml" xref="S5.E35.m2.3.3.1.1.3.2.1">⋅</ci><apply id="S5.E35.m2.3.3.1.1.3.2.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E35.m2.3.3.1.1.3.2.2.1.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2">superscript</csymbol><apply id="S5.E35.m2.3.3.1.1.3.2.2.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E35.m2.3.3.1.1.3.2.2.2.1.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S5.E35.m2.3.3.1.1.3.2.2.2.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2.2.2">𝐱</ci><ci id="S5.E35.m2.3.3.1.1.3.2.2.2.3.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S5.E35.m2.3.3.1.1.3.2.2.3a.cmml" xref="S5.E35.m2.3.3.1.1.3.2.2.3"><mtext id="S5.E35.m2.3.3.1.1.3.2.2.3.cmml" mathsize="70%" xref="S5.E35.m2.3.3.1.1.3.2.2.3">seasonal</mtext></ci></apply><apply id="S5.E35.m2.3.3.1.1.3.2.3.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E35.m2.3.3.1.1.3.2.3.1.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3">superscript</csymbol><apply id="S5.E35.m2.3.3.1.1.3.2.3.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E35.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3">subscript</csymbol><ci id="S5.E35.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3.2.2">𝐖</ci><ci id="S5.E35.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S5.E35.m2.3.3.1.1.3.2.3.2.3">𝑒</ci></apply><ci id="S5.E35.m2.1.1.1.1.cmml" xref="S5.E35.m2.1.1.1.1">𝑒</ci></apply></apply><apply id="S5.E35.m2.3.3.1.1.3.3.cmml" xref="S5.E35.m2.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S5.E35.m2.3.3.1.1.3.3.1.cmml" xref="S5.E35.m2.3.3.1.1.3.3">superscript</csymbol><ci id="S5.E35.m2.3.3.1.1.3.3.2a.cmml" xref="S5.E35.m2.3.3.1.1.3.3.2"><mtext id="S5.E35.m2.3.3.1.1.3.3.2.cmml" xref="S5.E35.m2.3.3.1.1.3.3.2">PE</mtext></ci><ci id="S5.E35.m2.2.2.1.1.cmml" xref="S5.E35.m2.2.2.1.1">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E35.m2.3c">\displaystyle=\mathbf{x}_{i}^{\text{seasonal}}\cdot\mathbf{W}_{e}^{(e)}+\text{%
PE}^{(e)},</annotation><annotation encoding="application/x-llamapun" id="S5.E35.m2.3d">= bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
<tbody id="S5.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(e)}" class="ltx_Math" display="inline" id="S5.E36.m1.1"><semantics id="S5.E36.m1.1a"><msubsup id="S5.E36.m1.1.2" xref="S5.E36.m1.1.2.cmml"><mi id="S5.E36.m1.1.2.2.2" xref="S5.E36.m1.1.2.2.2.cmml">𝐇</mi><mi id="S5.E36.m1.1.2.2.3" xref="S5.E36.m1.1.2.2.3.cmml">i</mi><mrow id="S5.E36.m1.1.1.1.3" xref="S5.E36.m1.1.2.cmml"><mo id="S5.E36.m1.1.1.1.3.1" stretchy="false" xref="S5.E36.m1.1.2.cmml">(</mo><mi id="S5.E36.m1.1.1.1.1" xref="S5.E36.m1.1.1.1.1.cmml">e</mi><mo id="S5.E36.m1.1.1.1.3.2" stretchy="false" xref="S5.E36.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.E36.m1.1b"><apply id="S5.E36.m1.1.2.cmml" xref="S5.E36.m1.1.2"><csymbol cd="ambiguous" id="S5.E36.m1.1.2.1.cmml" xref="S5.E36.m1.1.2">superscript</csymbol><apply id="S5.E36.m1.1.2.2.cmml" xref="S5.E36.m1.1.2"><csymbol cd="ambiguous" id="S5.E36.m1.1.2.2.1.cmml" xref="S5.E36.m1.1.2">subscript</csymbol><ci id="S5.E36.m1.1.2.2.2.cmml" xref="S5.E36.m1.1.2.2.2">𝐇</ci><ci id="S5.E36.m1.1.2.2.3.cmml" xref="S5.E36.m1.1.2.2.3">𝑖</ci></apply><ci id="S5.E36.m1.1.1.1.1.cmml" xref="S5.E36.m1.1.1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E36.m1.1c">\displaystyle\mathbf{H}_{i}^{(e)}</annotation><annotation encoding="application/x-llamapun" id="S5.E36.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{(e)})." class="ltx_Math" display="inline" id="S5.E36.m2.2"><semantics id="S5.E36.m2.2a"><mrow id="S5.E36.m2.2.2.1" xref="S5.E36.m2.2.2.1.1.cmml"><mrow id="S5.E36.m2.2.2.1.1" xref="S5.E36.m2.2.2.1.1.cmml"><mi id="S5.E36.m2.2.2.1.1.3" xref="S5.E36.m2.2.2.1.1.3.cmml"></mi><mo id="S5.E36.m2.2.2.1.1.2" xref="S5.E36.m2.2.2.1.1.2.cmml">=</mo><mrow id="S5.E36.m2.2.2.1.1.1" xref="S5.E36.m2.2.2.1.1.1.cmml"><mtext id="S5.E36.m2.2.2.1.1.1.3" xref="S5.E36.m2.2.2.1.1.1.3a.cmml">TransformerEncoder</mtext><mo id="S5.E36.m2.2.2.1.1.1.2" xref="S5.E36.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S5.E36.m2.2.2.1.1.1.1.1" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S5.E36.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S5.E36.m2.2.2.1.1.1.1.1.1" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S5.E36.m2.2.2.1.1.1.1.1.1.2.2" xref="S5.E36.m2.2.2.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S5.E36.m2.2.2.1.1.1.1.1.1.2.3" xref="S5.E36.m2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S5.E36.m2.1.1.1.3" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S5.E36.m2.1.1.1.3.1" stretchy="false" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E36.m2.1.1.1.1" xref="S5.E36.m2.1.1.1.1.cmml">e</mi><mo id="S5.E36.m2.1.1.1.3.2" stretchy="false" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S5.E36.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S5.E36.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E36.m2.2.2.1.2" lspace="0em" xref="S5.E36.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E36.m2.2b"><apply id="S5.E36.m2.2.2.1.1.cmml" xref="S5.E36.m2.2.2.1"><eq id="S5.E36.m2.2.2.1.1.2.cmml" xref="S5.E36.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S5.E36.m2.2.2.1.1.3.cmml" xref="S5.E36.m2.2.2.1.1.3">absent</csymbol><apply id="S5.E36.m2.2.2.1.1.1.cmml" xref="S5.E36.m2.2.2.1.1.1"><times id="S5.E36.m2.2.2.1.1.1.2.cmml" xref="S5.E36.m2.2.2.1.1.1.2"></times><ci id="S5.E36.m2.2.2.1.1.1.3a.cmml" xref="S5.E36.m2.2.2.1.1.1.3"><mtext id="S5.E36.m2.2.2.1.1.1.3.cmml" xref="S5.E36.m2.2.2.1.1.1.3">TransformerEncoder</mtext></ci><apply id="S5.E36.m2.2.2.1.1.1.1.1.1.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E36.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S5.E36.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E36.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S5.E36.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S5.E36.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S5.E36.m2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.E36.m2.1.1.1.1.cmml" xref="S5.E36.m2.1.1.1.1">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E36.m2.2c">\displaystyle=\text{TransformerEncoder}(\mathbf{z}_{i}^{(e)}).</annotation><annotation encoding="application/x-llamapun" id="S5.E36.m2.2d">= TransformerEncoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Decoder</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px2.p1.1">The seasonal decoder input is initialized to zeros:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx12">
<tbody id="S5.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{i}^{(d)}" class="ltx_Math" display="inline" id="S5.E37.m1.1"><semantics id="S5.E37.m1.1a"><msubsup id="S5.E37.m1.1.2" xref="S5.E37.m1.1.2.cmml"><mi id="S5.E37.m1.1.2.2.2" xref="S5.E37.m1.1.2.2.2.cmml">𝐳</mi><mi id="S5.E37.m1.1.2.2.3" xref="S5.E37.m1.1.2.2.3.cmml">i</mi><mrow id="S5.E37.m1.1.1.1.3" xref="S5.E37.m1.1.2.cmml"><mo id="S5.E37.m1.1.1.1.3.1" stretchy="false" xref="S5.E37.m1.1.2.cmml">(</mo><mi id="S5.E37.m1.1.1.1.1" xref="S5.E37.m1.1.1.1.1.cmml">d</mi><mo id="S5.E37.m1.1.1.1.3.2" stretchy="false" xref="S5.E37.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.E37.m1.1b"><apply id="S5.E37.m1.1.2.cmml" xref="S5.E37.m1.1.2"><csymbol cd="ambiguous" id="S5.E37.m1.1.2.1.cmml" xref="S5.E37.m1.1.2">superscript</csymbol><apply id="S5.E37.m1.1.2.2.cmml" xref="S5.E37.m1.1.2"><csymbol cd="ambiguous" id="S5.E37.m1.1.2.2.1.cmml" xref="S5.E37.m1.1.2">subscript</csymbol><ci id="S5.E37.m1.1.2.2.2.cmml" xref="S5.E37.m1.1.2.2.2">𝐳</ci><ci id="S5.E37.m1.1.2.2.3.cmml" xref="S5.E37.m1.1.2.2.3">𝑖</ci></apply><ci id="S5.E37.m1.1.1.1.1.cmml" xref="S5.E37.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E37.m1.1c">\displaystyle\mathbf{z}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S5.E37.m1.1d">bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{0}_{B\times H\times 1}\cdot\mathbf{W}_{e}^{(d)}+\text{PE%
}^{(d)}," class="ltx_Math" display="inline" id="S5.E37.m2.3"><semantics id="S5.E37.m2.3a"><mrow id="S5.E37.m2.3.3.1" xref="S5.E37.m2.3.3.1.1.cmml"><mrow id="S5.E37.m2.3.3.1.1" xref="S5.E37.m2.3.3.1.1.cmml"><mi id="S5.E37.m2.3.3.1.1.2" xref="S5.E37.m2.3.3.1.1.2.cmml"></mi><mo id="S5.E37.m2.3.3.1.1.1" xref="S5.E37.m2.3.3.1.1.1.cmml">=</mo><mrow id="S5.E37.m2.3.3.1.1.3" xref="S5.E37.m2.3.3.1.1.3.cmml"><mrow id="S5.E37.m2.3.3.1.1.3.2" xref="S5.E37.m2.3.3.1.1.3.2.cmml"><msub id="S5.E37.m2.3.3.1.1.3.2.2" xref="S5.E37.m2.3.3.1.1.3.2.2.cmml"><mn id="S5.E37.m2.3.3.1.1.3.2.2.2" xref="S5.E37.m2.3.3.1.1.3.2.2.2.cmml">𝟎</mn><mrow id="S5.E37.m2.3.3.1.1.3.2.2.3" xref="S5.E37.m2.3.3.1.1.3.2.2.3.cmml"><mi id="S5.E37.m2.3.3.1.1.3.2.2.3.2" xref="S5.E37.m2.3.3.1.1.3.2.2.3.2.cmml">B</mi><mo id="S5.E37.m2.3.3.1.1.3.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S5.E37.m2.3.3.1.1.3.2.2.3.1.cmml">×</mo><mi id="S5.E37.m2.3.3.1.1.3.2.2.3.3" xref="S5.E37.m2.3.3.1.1.3.2.2.3.3.cmml">H</mi><mo id="S5.E37.m2.3.3.1.1.3.2.2.3.1a" lspace="0.222em" rspace="0.222em" xref="S5.E37.m2.3.3.1.1.3.2.2.3.1.cmml">×</mo><mn id="S5.E37.m2.3.3.1.1.3.2.2.3.4" xref="S5.E37.m2.3.3.1.1.3.2.2.3.4.cmml">1</mn></mrow></msub><mo id="S5.E37.m2.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E37.m2.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S5.E37.m2.3.3.1.1.3.2.3" xref="S5.E37.m2.3.3.1.1.3.2.3.cmml"><mi id="S5.E37.m2.3.3.1.1.3.2.3.2.2" xref="S5.E37.m2.3.3.1.1.3.2.3.2.2.cmml">𝐖</mi><mi id="S5.E37.m2.3.3.1.1.3.2.3.2.3" xref="S5.E37.m2.3.3.1.1.3.2.3.2.3.cmml">e</mi><mrow id="S5.E37.m2.1.1.1.3" xref="S5.E37.m2.3.3.1.1.3.2.3.cmml"><mo id="S5.E37.m2.1.1.1.3.1" stretchy="false" xref="S5.E37.m2.3.3.1.1.3.2.3.cmml">(</mo><mi id="S5.E37.m2.1.1.1.1" xref="S5.E37.m2.1.1.1.1.cmml">d</mi><mo id="S5.E37.m2.1.1.1.3.2" stretchy="false" xref="S5.E37.m2.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E37.m2.3.3.1.1.3.1" xref="S5.E37.m2.3.3.1.1.3.1.cmml">+</mo><msup id="S5.E37.m2.3.3.1.1.3.3" xref="S5.E37.m2.3.3.1.1.3.3.cmml"><mtext id="S5.E37.m2.3.3.1.1.3.3.2" xref="S5.E37.m2.3.3.1.1.3.3.2a.cmml">PE</mtext><mrow id="S5.E37.m2.2.2.1.3" xref="S5.E37.m2.3.3.1.1.3.3.cmml"><mo id="S5.E37.m2.2.2.1.3.1" stretchy="false" xref="S5.E37.m2.3.3.1.1.3.3.cmml">(</mo><mi id="S5.E37.m2.2.2.1.1" xref="S5.E37.m2.2.2.1.1.cmml">d</mi><mo id="S5.E37.m2.2.2.1.3.2" stretchy="false" xref="S5.E37.m2.3.3.1.1.3.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S5.E37.m2.3.3.1.2" xref="S5.E37.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E37.m2.3b"><apply id="S5.E37.m2.3.3.1.1.cmml" xref="S5.E37.m2.3.3.1"><eq id="S5.E37.m2.3.3.1.1.1.cmml" xref="S5.E37.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S5.E37.m2.3.3.1.1.2.cmml" xref="S5.E37.m2.3.3.1.1.2">absent</csymbol><apply id="S5.E37.m2.3.3.1.1.3.cmml" xref="S5.E37.m2.3.3.1.1.3"><plus id="S5.E37.m2.3.3.1.1.3.1.cmml" xref="S5.E37.m2.3.3.1.1.3.1"></plus><apply id="S5.E37.m2.3.3.1.1.3.2.cmml" xref="S5.E37.m2.3.3.1.1.3.2"><ci id="S5.E37.m2.3.3.1.1.3.2.1.cmml" xref="S5.E37.m2.3.3.1.1.3.2.1">⋅</ci><apply id="S5.E37.m2.3.3.1.1.3.2.2.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E37.m2.3.3.1.1.3.2.2.1.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2">subscript</csymbol><cn id="S5.E37.m2.3.3.1.1.3.2.2.2.cmml" type="integer" xref="S5.E37.m2.3.3.1.1.3.2.2.2">0</cn><apply id="S5.E37.m2.3.3.1.1.3.2.2.3.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2.3"><times id="S5.E37.m2.3.3.1.1.3.2.2.3.1.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2.3.1"></times><ci id="S5.E37.m2.3.3.1.1.3.2.2.3.2.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2.3.2">𝐵</ci><ci id="S5.E37.m2.3.3.1.1.3.2.2.3.3.cmml" xref="S5.E37.m2.3.3.1.1.3.2.2.3.3">𝐻</ci><cn id="S5.E37.m2.3.3.1.1.3.2.2.3.4.cmml" type="integer" xref="S5.E37.m2.3.3.1.1.3.2.2.3.4">1</cn></apply></apply><apply id="S5.E37.m2.3.3.1.1.3.2.3.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E37.m2.3.3.1.1.3.2.3.1.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3">superscript</csymbol><apply id="S5.E37.m2.3.3.1.1.3.2.3.2.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E37.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3">subscript</csymbol><ci id="S5.E37.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3.2.2">𝐖</ci><ci id="S5.E37.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S5.E37.m2.3.3.1.1.3.2.3.2.3">𝑒</ci></apply><ci id="S5.E37.m2.1.1.1.1.cmml" xref="S5.E37.m2.1.1.1.1">𝑑</ci></apply></apply><apply id="S5.E37.m2.3.3.1.1.3.3.cmml" xref="S5.E37.m2.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S5.E37.m2.3.3.1.1.3.3.1.cmml" xref="S5.E37.m2.3.3.1.1.3.3">superscript</csymbol><ci id="S5.E37.m2.3.3.1.1.3.3.2a.cmml" xref="S5.E37.m2.3.3.1.1.3.3.2"><mtext id="S5.E37.m2.3.3.1.1.3.3.2.cmml" xref="S5.E37.m2.3.3.1.1.3.3.2">PE</mtext></ci><ci id="S5.E37.m2.2.2.1.1.cmml" xref="S5.E37.m2.2.2.1.1">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E37.m2.3c">\displaystyle=\mathbf{0}_{B\times H\times 1}\cdot\mathbf{W}_{e}^{(d)}+\text{PE%
}^{(d)},</annotation><annotation encoding="application/x-llamapun" id="S5.E37.m2.3d">= bold_0 start_POSTSUBSCRIPT italic_B × italic_H × 1 end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
<tbody id="S5.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{i}^{(d)}" class="ltx_Math" display="inline" id="S5.E38.m1.1"><semantics id="S5.E38.m1.1a"><msubsup id="S5.E38.m1.1.2" xref="S5.E38.m1.1.2.cmml"><mi id="S5.E38.m1.1.2.2.2" xref="S5.E38.m1.1.2.2.2.cmml">𝐇</mi><mi id="S5.E38.m1.1.2.2.3" xref="S5.E38.m1.1.2.2.3.cmml">i</mi><mrow id="S5.E38.m1.1.1.1.3" xref="S5.E38.m1.1.2.cmml"><mo id="S5.E38.m1.1.1.1.3.1" stretchy="false" xref="S5.E38.m1.1.2.cmml">(</mo><mi id="S5.E38.m1.1.1.1.1" xref="S5.E38.m1.1.1.1.1.cmml">d</mi><mo id="S5.E38.m1.1.1.1.3.2" stretchy="false" xref="S5.E38.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.E38.m1.1b"><apply id="S5.E38.m1.1.2.cmml" xref="S5.E38.m1.1.2"><csymbol cd="ambiguous" id="S5.E38.m1.1.2.1.cmml" xref="S5.E38.m1.1.2">superscript</csymbol><apply id="S5.E38.m1.1.2.2.cmml" xref="S5.E38.m1.1.2"><csymbol cd="ambiguous" id="S5.E38.m1.1.2.2.1.cmml" xref="S5.E38.m1.1.2">subscript</csymbol><ci id="S5.E38.m1.1.2.2.2.cmml" xref="S5.E38.m1.1.2.2.2">𝐇</ci><ci id="S5.E38.m1.1.2.2.3.cmml" xref="S5.E38.m1.1.2.2.3">𝑖</ci></apply><ci id="S5.E38.m1.1.1.1.1.cmml" xref="S5.E38.m1.1.1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E38.m1.1c">\displaystyle\mathbf{H}_{i}^{(d)}</annotation><annotation encoding="application/x-llamapun" id="S5.E38.m1.1d">bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{TransformerDecoder}(\mathbf{z}_{i}^{(d)}.\mathbf{H}_{i}^{(%
e)})." class="ltx_math_unparsed" display="inline" id="S5.E38.m2.2"><semantics id="S5.E38.m2.2a"><mrow id="S5.E38.m2.2b"><mo id="S5.E38.m2.2.3">=</mo><mtext id="S5.E38.m2.2.4">TransformerDecoder</mtext><mrow id="S5.E38.m2.2.5"><mo id="S5.E38.m2.2.5.1" stretchy="false">(</mo><msubsup id="S5.E38.m2.2.5.2"><mi id="S5.E38.m2.2.5.2.2.2">𝐳</mi><mi id="S5.E38.m2.2.5.2.2.3">i</mi><mrow id="S5.E38.m2.1.1.1.3"><mo id="S5.E38.m2.1.1.1.3.1" stretchy="false">(</mo><mi id="S5.E38.m2.1.1.1.1">d</mi><mo id="S5.E38.m2.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S5.E38.m2.2.5.3" lspace="0em" rspace="0.167em">.</mo><msubsup id="S5.E38.m2.2.5.4"><mi id="S5.E38.m2.2.5.4.2.2">𝐇</mi><mi id="S5.E38.m2.2.5.4.2.3">i</mi><mrow id="S5.E38.m2.2.2.1.3"><mo id="S5.E38.m2.2.2.1.3.1" stretchy="false">(</mo><mi id="S5.E38.m2.2.2.1.1">e</mi><mo id="S5.E38.m2.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S5.E38.m2.2.5.5" stretchy="false">)</mo></mrow><mo id="S5.E38.m2.2.6" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S5.E38.m2.2c">\displaystyle=\text{TransformerDecoder}(\mathbf{z}_{i}^{(d)}.\mathbf{H}_{i}^{(%
e)}).</annotation><annotation encoding="application/x-llamapun" id="S5.E38.m2.2d">= TransformerDecoder ( bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT . bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Output</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px3.p1">
<table class="ltx_equation ltx_eqn_table" id="S5.E39">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}_{i}=\underbrace{\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}}_{%
\text{seasonal}}+\underbrace{\mathbf{W}_{t}\cdot\mathbf{x}_{i}^{\text{trend}}}%
_{\text{trend}}." class="ltx_Math" display="block" id="S5.E39.m1.2"><semantics id="S5.E39.m1.2a"><mrow id="S5.E39.m1.2.2.1" xref="S5.E39.m1.2.2.1.1.cmml"><mrow id="S5.E39.m1.2.2.1.1" xref="S5.E39.m1.2.2.1.1.cmml"><msub id="S5.E39.m1.2.2.1.1.2" xref="S5.E39.m1.2.2.1.1.2.cmml"><mover accent="true" id="S5.E39.m1.2.2.1.1.2.2" xref="S5.E39.m1.2.2.1.1.2.2.cmml"><mi id="S5.E39.m1.2.2.1.1.2.2.2" xref="S5.E39.m1.2.2.1.1.2.2.2.cmml">𝐲</mi><mo id="S5.E39.m1.2.2.1.1.2.2.1" xref="S5.E39.m1.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E39.m1.2.2.1.1.2.3" xref="S5.E39.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S5.E39.m1.2.2.1.1.1" xref="S5.E39.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E39.m1.2.2.1.1.3" xref="S5.E39.m1.2.2.1.1.3.cmml"><munder id="S5.E39.m1.2.2.1.1.3.2" xref="S5.E39.m1.2.2.1.1.3.2.cmml"><munder accentunder="true" id="S5.E39.m1.1.1" xref="S5.E39.m1.1.1.cmml"><mrow id="S5.E39.m1.1.1.1" xref="S5.E39.m1.1.1.1.cmml"><msub id="S5.E39.m1.1.1.1.3" xref="S5.E39.m1.1.1.1.3.cmml"><mi id="S5.E39.m1.1.1.1.3.2" xref="S5.E39.m1.1.1.1.3.2.cmml">𝐖</mi><mi id="S5.E39.m1.1.1.1.3.3" xref="S5.E39.m1.1.1.1.3.3.cmml">o</mi></msub><mo id="S5.E39.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S5.E39.m1.1.1.1.2.cmml">⋅</mo><msubsup id="S5.E39.m1.1.1.1.4" xref="S5.E39.m1.1.1.1.4.cmml"><mi id="S5.E39.m1.1.1.1.4.2.2" xref="S5.E39.m1.1.1.1.4.2.2.cmml">𝐇</mi><mi id="S5.E39.m1.1.1.1.4.2.3" xref="S5.E39.m1.1.1.1.4.2.3.cmml">i</mi><mrow id="S5.E39.m1.1.1.1.1.1.3" xref="S5.E39.m1.1.1.1.4.cmml"><mo id="S5.E39.m1.1.1.1.1.1.3.1" stretchy="false" xref="S5.E39.m1.1.1.1.4.cmml">(</mo><mi id="S5.E39.m1.1.1.1.1.1.1" xref="S5.E39.m1.1.1.1.1.1.1.cmml">d</mi><mo id="S5.E39.m1.1.1.1.1.1.3.2" stretchy="false" xref="S5.E39.m1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E39.m1.1.1.2" xref="S5.E39.m1.1.1.2.cmml">⏟</mo></munder><mtext id="S5.E39.m1.2.2.1.1.3.2.2" xref="S5.E39.m1.2.2.1.1.3.2.2a.cmml">seasonal</mtext></munder><mo id="S5.E39.m1.2.2.1.1.3.1" xref="S5.E39.m1.2.2.1.1.3.1.cmml">+</mo><munder id="S5.E39.m1.2.2.1.1.3.3" xref="S5.E39.m1.2.2.1.1.3.3.cmml"><munder accentunder="true" id="S5.E39.m1.2.2.1.1.3.3.2" xref="S5.E39.m1.2.2.1.1.3.3.2.cmml"><mrow id="S5.E39.m1.2.2.1.1.3.3.2.2" xref="S5.E39.m1.2.2.1.1.3.3.2.2.cmml"><msub id="S5.E39.m1.2.2.1.1.3.3.2.2.2" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2.cmml"><mi id="S5.E39.m1.2.2.1.1.3.3.2.2.2.2" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2.2.cmml">𝐖</mi><mi id="S5.E39.m1.2.2.1.1.3.3.2.2.2.3" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S5.E39.m1.2.2.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E39.m1.2.2.1.1.3.3.2.2.1.cmml">⋅</mo><msubsup id="S5.E39.m1.2.2.1.1.3.3.2.2.3" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.cmml"><mi id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.2" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.2.cmml">𝐱</mi><mi id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.3" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.3.cmml">i</mi><mtext id="S5.E39.m1.2.2.1.1.3.3.2.2.3.3" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.3a.cmml">trend</mtext></msubsup></mrow><mo id="S5.E39.m1.2.2.1.1.3.3.2.1" xref="S5.E39.m1.2.2.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S5.E39.m1.2.2.1.1.3.3.3" xref="S5.E39.m1.2.2.1.1.3.3.3a.cmml">trend</mtext></munder></mrow></mrow><mo id="S5.E39.m1.2.2.1.2" lspace="0em" xref="S5.E39.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E39.m1.2b"><apply id="S5.E39.m1.2.2.1.1.cmml" xref="S5.E39.m1.2.2.1"><eq id="S5.E39.m1.2.2.1.1.1.cmml" xref="S5.E39.m1.2.2.1.1.1"></eq><apply id="S5.E39.m1.2.2.1.1.2.cmml" xref="S5.E39.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.2.1.cmml" xref="S5.E39.m1.2.2.1.1.2">subscript</csymbol><apply id="S5.E39.m1.2.2.1.1.2.2.cmml" xref="S5.E39.m1.2.2.1.1.2.2"><ci id="S5.E39.m1.2.2.1.1.2.2.1.cmml" xref="S5.E39.m1.2.2.1.1.2.2.1">^</ci><ci id="S5.E39.m1.2.2.1.1.2.2.2.cmml" xref="S5.E39.m1.2.2.1.1.2.2.2">𝐲</ci></apply><ci id="S5.E39.m1.2.2.1.1.2.3.cmml" xref="S5.E39.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S5.E39.m1.2.2.1.1.3.cmml" xref="S5.E39.m1.2.2.1.1.3"><plus id="S5.E39.m1.2.2.1.1.3.1.cmml" xref="S5.E39.m1.2.2.1.1.3.1"></plus><apply id="S5.E39.m1.2.2.1.1.3.2.cmml" xref="S5.E39.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.3.2.1.cmml" xref="S5.E39.m1.2.2.1.1.3.2">subscript</csymbol><apply id="S5.E39.m1.1.1.cmml" xref="S5.E39.m1.1.1"><ci id="S5.E39.m1.1.1.2.cmml" xref="S5.E39.m1.1.1.2">⏟</ci><apply id="S5.E39.m1.1.1.1.cmml" xref="S5.E39.m1.1.1.1"><ci id="S5.E39.m1.1.1.1.2.cmml" xref="S5.E39.m1.1.1.1.2">⋅</ci><apply id="S5.E39.m1.1.1.1.3.cmml" xref="S5.E39.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E39.m1.1.1.1.3.1.cmml" xref="S5.E39.m1.1.1.1.3">subscript</csymbol><ci id="S5.E39.m1.1.1.1.3.2.cmml" xref="S5.E39.m1.1.1.1.3.2">𝐖</ci><ci id="S5.E39.m1.1.1.1.3.3.cmml" xref="S5.E39.m1.1.1.1.3.3">𝑜</ci></apply><apply id="S5.E39.m1.1.1.1.4.cmml" xref="S5.E39.m1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E39.m1.1.1.1.4.1.cmml" xref="S5.E39.m1.1.1.1.4">superscript</csymbol><apply id="S5.E39.m1.1.1.1.4.2.cmml" xref="S5.E39.m1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E39.m1.1.1.1.4.2.1.cmml" xref="S5.E39.m1.1.1.1.4">subscript</csymbol><ci id="S5.E39.m1.1.1.1.4.2.2.cmml" xref="S5.E39.m1.1.1.1.4.2.2">𝐇</ci><ci id="S5.E39.m1.1.1.1.4.2.3.cmml" xref="S5.E39.m1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S5.E39.m1.1.1.1.1.1.1.cmml" xref="S5.E39.m1.1.1.1.1.1.1">𝑑</ci></apply></apply></apply><ci id="S5.E39.m1.2.2.1.1.3.2.2a.cmml" xref="S5.E39.m1.2.2.1.1.3.2.2"><mtext id="S5.E39.m1.2.2.1.1.3.2.2.cmml" mathsize="70%" xref="S5.E39.m1.2.2.1.1.3.2.2">seasonal</mtext></ci></apply><apply id="S5.E39.m1.2.2.1.1.3.3.cmml" xref="S5.E39.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.3.3.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3">subscript</csymbol><apply id="S5.E39.m1.2.2.1.1.3.3.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2"><ci id="S5.E39.m1.2.2.1.1.3.3.2.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.1">⏟</ci><apply id="S5.E39.m1.2.2.1.1.3.3.2.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2"><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.1">⋅</ci><apply id="S5.E39.m1.2.2.1.1.3.3.2.2.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.3.3.2.2.2.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2">subscript</csymbol><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.2.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2.2">𝐖</ci><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.2.3.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.2.3">𝑡</ci></apply><apply id="S5.E39.m1.2.2.1.1.3.3.2.2.3.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.3.3.2.2.3.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3">superscript</csymbol><apply id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.1.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3">subscript</csymbol><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.2.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.2">𝐱</ci><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.3.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.2.3">𝑖</ci></apply><ci id="S5.E39.m1.2.2.1.1.3.3.2.2.3.3a.cmml" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.3"><mtext id="S5.E39.m1.2.2.1.1.3.3.2.2.3.3.cmml" mathsize="70%" xref="S5.E39.m1.2.2.1.1.3.3.2.2.3.3">trend</mtext></ci></apply></apply></apply><ci id="S5.E39.m1.2.2.1.1.3.3.3a.cmml" xref="S5.E39.m1.2.2.1.1.3.3.3"><mtext id="S5.E39.m1.2.2.1.1.3.3.3.cmml" mathsize="70%" xref="S5.E39.m1.2.2.1.1.3.3.3">trend</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E39.m1.2c">\hat{\mathbf{y}}_{i}=\underbrace{\mathbf{W}_{o}\cdot\mathbf{H}_{i}^{(d)}}_{%
\text{seasonal}}+\underbrace{\mathbf{W}_{t}\cdot\mathbf{x}_{i}^{\text{trend}}}%
_{\text{trend}}.</annotation><annotation encoding="application/x-llamapun" id="S5.E39.m1.2d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = under⏟ start_ARG bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ⋅ bold_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT seasonal end_POSTSUBSCRIPT + under⏟ start_ARG bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT trend end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(39)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Computational Complexity</h5>
<div class="ltx_para" id="S5.SS3.SSS0.Px4.p1">
<table class="ltx_equation ltx_eqn_table" id="S5.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{\text{Full}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Encoder Self-Attn}}+\underbrace{H^{2}\cdot d_{\text{model}}}_{\text{Decoder %
Self-Attn}}+\underbrace{H\cdot P\cdot d_{\text{model}}}_{\text{Cross-Attention%
}}." class="ltx_Math" display="block" id="S5.Ex17.m1.1"><semantics id="S5.Ex17.m1.1a"><mrow id="S5.Ex17.m1.1.1.1" xref="S5.Ex17.m1.1.1.1.1.cmml"><mrow id="S5.Ex17.m1.1.1.1.1" xref="S5.Ex17.m1.1.1.1.1.cmml"><msub id="S5.Ex17.m1.1.1.1.1.2" xref="S5.Ex17.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Ex17.m1.1.1.1.1.2.2" xref="S5.Ex17.m1.1.1.1.1.2.2.cmml">𝒪</mi><mtext id="S5.Ex17.m1.1.1.1.1.2.3" xref="S5.Ex17.m1.1.1.1.1.2.3a.cmml">Full</mtext></msub><mo id="S5.Ex17.m1.1.1.1.1.1" xref="S5.Ex17.m1.1.1.1.1.1.cmml">=</mo><mrow id="S5.Ex17.m1.1.1.1.1.3" xref="S5.Ex17.m1.1.1.1.1.3.cmml"><munder id="S5.Ex17.m1.1.1.1.1.3.2" xref="S5.Ex17.m1.1.1.1.1.3.2.cmml"><munder accentunder="true" id="S5.Ex17.m1.1.1.1.1.3.2.2" xref="S5.Ex17.m1.1.1.1.1.3.2.2.cmml"><mrow id="S5.Ex17.m1.1.1.1.1.3.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.cmml"><msup id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.2.cmml">P</mi><mn id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.3" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.3.cmml">2</mn></msup><mo id="S5.Ex17.m1.1.1.1.1.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.1.cmml">⋅</mo><msub id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.2" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.2.cmml">d</mi><mtext id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S5.Ex17.m1.1.1.1.1.3.2.2.1" xref="S5.Ex17.m1.1.1.1.1.3.2.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex17.m1.1.1.1.1.3.2.3" xref="S5.Ex17.m1.1.1.1.1.3.2.3a.cmml">Encoder Self-Attn</mtext></munder><mo id="S5.Ex17.m1.1.1.1.1.3.1" xref="S5.Ex17.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S5.Ex17.m1.1.1.1.1.3.3" xref="S5.Ex17.m1.1.1.1.1.3.3.cmml"><munder accentunder="true" id="S5.Ex17.m1.1.1.1.1.3.3.2" xref="S5.Ex17.m1.1.1.1.1.3.3.2.cmml"><mrow id="S5.Ex17.m1.1.1.1.1.3.3.2.2" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.cmml"><msup id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.2.cmml">H</mi><mn id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.3" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S5.Ex17.m1.1.1.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.1.cmml">⋅</mo><msub id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.2" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.2.cmml">d</mi><mtext id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S5.Ex17.m1.1.1.1.1.3.3.2.1" xref="S5.Ex17.m1.1.1.1.1.3.3.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex17.m1.1.1.1.1.3.3.3" xref="S5.Ex17.m1.1.1.1.1.3.3.3a.cmml">Decoder Self-Attn</mtext></munder><mo id="S5.Ex17.m1.1.1.1.1.3.1a" xref="S5.Ex17.m1.1.1.1.1.3.1.cmml">+</mo><munder id="S5.Ex17.m1.1.1.1.1.3.4" xref="S5.Ex17.m1.1.1.1.1.3.4.cmml"><munder accentunder="true" id="S5.Ex17.m1.1.1.1.1.3.4.2" xref="S5.Ex17.m1.1.1.1.1.3.4.2.cmml"><mrow id="S5.Ex17.m1.1.1.1.1.3.4.2.2" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.4.2.2.2" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.2.cmml">H</mi><mo id="S5.Ex17.m1.1.1.1.1.3.4.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.1.cmml">⋅</mo><mi id="S5.Ex17.m1.1.1.1.1.3.4.2.2.3" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.3.cmml">P</mi><mo id="S5.Ex17.m1.1.1.1.1.3.4.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.1.cmml">⋅</mo><msub id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.cmml"><mi id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.2" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.2.cmml">d</mi><mtext id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3a.cmml">model</mtext></msub></mrow><mo id="S5.Ex17.m1.1.1.1.1.3.4.2.1" xref="S5.Ex17.m1.1.1.1.1.3.4.2.1.cmml">⏟</mo></munder><mtext id="S5.Ex17.m1.1.1.1.1.3.4.3" xref="S5.Ex17.m1.1.1.1.1.3.4.3a.cmml">Cross-Attention</mtext></munder></mrow></mrow><mo id="S5.Ex17.m1.1.1.1.2" lspace="0em" xref="S5.Ex17.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex17.m1.1b"><apply id="S5.Ex17.m1.1.1.1.1.cmml" xref="S5.Ex17.m1.1.1.1"><eq id="S5.Ex17.m1.1.1.1.1.1.cmml" xref="S5.Ex17.m1.1.1.1.1.1"></eq><apply id="S5.Ex17.m1.1.1.1.1.2.cmml" xref="S5.Ex17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.2.2">𝒪</ci><ci id="S5.Ex17.m1.1.1.1.1.2.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.2.3"><mtext id="S5.Ex17.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.2.3">Full</mtext></ci></apply><apply id="S5.Ex17.m1.1.1.1.1.3.cmml" xref="S5.Ex17.m1.1.1.1.1.3"><plus id="S5.Ex17.m1.1.1.1.1.3.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.1"></plus><apply id="S5.Ex17.m1.1.1.1.1.3.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S5.Ex17.m1.1.1.1.1.3.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2"><ci id="S5.Ex17.m1.1.1.1.1.3.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.1">⏟</ci><apply id="S5.Ex17.m1.1.1.1.1.3.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2"><ci id="S5.Ex17.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.1">⋅</ci><apply id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2">superscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.2">𝑃</ci><cn id="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.3.cmml" type="integer" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.2.3">2</cn></apply><apply id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.2">𝑑</ci><ci id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.2.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S5.Ex17.m1.1.1.1.1.3.2.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.2.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.2.3">Encoder Self-Attn</mtext></ci></apply><apply id="S5.Ex17.m1.1.1.1.1.3.3.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.3.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S5.Ex17.m1.1.1.1.1.3.3.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2"><ci id="S5.Ex17.m1.1.1.1.1.3.3.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.1">⏟</ci><apply id="S5.Ex17.m1.1.1.1.1.3.3.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2"><ci id="S5.Ex17.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.1">⋅</ci><apply id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2">superscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.2">𝐻</ci><cn id="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.3.cmml" type="integer" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.2.3">2</cn></apply><apply id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.2">𝑑</ci><ci id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.3.2.2.3.3">model</mtext></ci></apply></apply></apply><ci id="S5.Ex17.m1.1.1.1.1.3.3.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.3.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.3.3">Decoder Self-Attn</mtext></ci></apply><apply id="S5.Ex17.m1.1.1.1.1.3.4.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.4.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4">subscript</csymbol><apply id="S5.Ex17.m1.1.1.1.1.3.4.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2"><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.1">⏟</ci><apply id="S5.Ex17.m1.1.1.1.1.3.4.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2"><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.2.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.1">⋅</ci><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.2.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.2">𝐻</ci><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.2.3.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.3">𝑃</ci><apply id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4"><csymbol cd="ambiguous" id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.1.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4">subscript</csymbol><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.2.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.2">𝑑</ci><ci id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.4.2.2.4.3">model</mtext></ci></apply></apply></apply><ci id="S5.Ex17.m1.1.1.1.1.3.4.3a.cmml" xref="S5.Ex17.m1.1.1.1.1.3.4.3"><mtext id="S5.Ex17.m1.1.1.1.1.3.4.3.cmml" mathsize="70%" xref="S5.Ex17.m1.1.1.1.1.3.4.3">Cross-Attention</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex17.m1.1c">\mathcal{O}_{\text{Full}}=\underbrace{P^{2}\cdot d_{\text{model}}}_{\text{%
Encoder Self-Attn}}+\underbrace{H^{2}\cdot d_{\text{model}}}_{\text{Decoder %
Self-Attn}}+\underbrace{H\cdot P\cdot d_{\text{model}}}_{\text{Cross-Attention%
}}.</annotation><annotation encoding="application/x-llamapun" id="S5.Ex17.m1.1d">caligraphic_O start_POSTSUBSCRIPT Full end_POSTSUBSCRIPT = under⏟ start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Encoder Self-Attn end_POSTSUBSCRIPT + under⏟ start_ARG italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Decoder Self-Attn end_POSTSUBSCRIPT + under⏟ start_ARG italic_H ⋅ italic_P ⋅ italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT Cross-Attention end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Comparative Summary</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">The three <span class="ltx_text ltx_font_typewriter" id="S5.SS4.p1.1.1">Autoformer</span> variants provide flexible options depending on the forecasting setting: (i) <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS4.p1.1.2">Autoformer<span class="ltx_text ltx_font_serif" id="S5.SS4.p1.1.2.1"> Minimal</span></span> is fast and interpretable, ideal for clean signals or short horizons; (ii) <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS4.p1.1.3">Autoformer<span class="ltx_text ltx_font_serif" id="S5.SS4.p1.1.3.1"> Standard</span></span> is a balanced architecture that improves generalization with little added cost; (iii) <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="S5.SS4.p1.1.4">Autoformer<span class="ltx_text ltx_font_serif" id="S5.SS4.p1.1.4.1"> Full</span></span> provides high capacity and long-range modeling power, suitable for highly dynamic time series. Each variant leverages trend-seasonal decomposition, enabling consistent signal separation while scaling from minimal to full-capacity architectures. A comparative overview is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S5.T3" title="Table 3 ‣ 5.4 Comparative Summary ‣ 5 Autoformer Variants: Architecture and Computational Complexity ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">3</span></a>, and the complete forecasting procedure for the Full variant is provided in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#alg3" title="Algorithm 3 ‣ 8 Conclusion ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">3</span></a> in Appendix.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.9.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.10.2" style="font-size:90%;">Comparison of <span class="ltx_text ltx_font_typewriter" id="S5.T3.10.2.1">Autoformer</span>  Variants</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.6.7.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Model Variant</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.6.7.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Decomposition Details</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.6.7.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Architecture</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T3.6.7.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Time Complexity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Minimal <span class="ltx_text ltx_font_typewriter" id="S5.T3.2.2.3.1">Autoformer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MA filter (<math alttext="k=3" class="ltx_Math" display="inline" id="S5.T3.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.m1.1a"><mrow id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml"><mi id="S5.T3.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.m1.1.1.2.cmml">k</mi><mo id="S5.T3.1.1.1.m1.1.1.1" xref="S5.T3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1"><eq id="S5.T3.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1.1"></eq><ci id="S5.T3.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.m1.1.1.2">𝑘</ci><cn id="S5.T3.1.1.1.m1.1.1.3.cmml" type="integer" xref="S5.T3.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.m1.1d">italic_k = 3</annotation></semantics></math>), additive output</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d+Pd^{2})" class="ltx_Math" display="inline" id="S5.T3.2.2.2.m1.1"><semantics id="S5.T3.2.2.2.m1.1a"><mrow id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.2.2.2.m1.1.1.3" xref="S5.T3.2.2.2.m1.1.1.3.cmml">𝒪</mi><mo id="S5.T3.2.2.2.m1.1.1.2" xref="S5.T3.2.2.2.m1.1.1.2.cmml">⁢</mo><mrow id="S5.T3.2.2.2.m1.1.1.1.1" xref="S5.T3.2.2.2.m1.1.1.1.1.1.cmml"><mo id="S5.T3.2.2.2.m1.1.1.1.1.2" stretchy="false" xref="S5.T3.2.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T3.2.2.2.m1.1.1.1.1.1" xref="S5.T3.2.2.2.m1.1.1.1.1.1.cmml"><mrow id="S5.T3.2.2.2.m1.1.1.1.1.1.2" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.cmml"><msup id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.cmml"><mi id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.2" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.3" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S5.T3.2.2.2.m1.1.1.1.1.1.2.1" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.T3.2.2.2.m1.1.1.1.1.1.2.3" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="S5.T3.2.2.2.m1.1.1.1.1.1.1" xref="S5.T3.2.2.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T3.2.2.2.m1.1.1.1.1.1.3" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S5.T3.2.2.2.m1.1.1.1.1.1.3.2" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S5.T3.2.2.2.m1.1.1.1.1.1.3.1" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.2" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.2.cmml">d</mi><mn id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.3" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S5.T3.2.2.2.m1.1.1.1.1.3" stretchy="false" xref="S5.T3.2.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><apply id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1"><times id="S5.T3.2.2.2.m1.1.1.2.cmml" xref="S5.T3.2.2.2.m1.1.1.2"></times><ci id="S5.T3.2.2.2.m1.1.1.3.cmml" xref="S5.T3.2.2.2.m1.1.1.3">𝒪</ci><apply id="S5.T3.2.2.2.m1.1.1.1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1"><plus id="S5.T3.2.2.2.m1.1.1.1.1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.1"></plus><apply id="S5.T3.2.2.2.m1.1.1.1.1.1.2.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2"><times id="S5.T3.2.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.1"></times><apply id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="S5.T3.2.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S5.T3.2.2.2.m1.1.1.1.1.1.3.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3"><times id="S5.T3.2.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.1"></times><ci id="S5.T3.2.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.2">𝑑</ci><cn id="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S5.T3.2.2.2.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">\mathcal{O}(P^{2}d+Pd^{2})</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.2.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + italic_P italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Standard <span class="ltx_text ltx_font_typewriter" id="S5.T3.4.4.3.1">Autoformer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MA filter (<math alttext="k=3" class="ltx_Math" display="inline" id="S5.T3.3.3.1.m1.1"><semantics id="S5.T3.3.3.1.m1.1a"><mrow id="S5.T3.3.3.1.m1.1.1" xref="S5.T3.3.3.1.m1.1.1.cmml"><mi id="S5.T3.3.3.1.m1.1.1.2" xref="S5.T3.3.3.1.m1.1.1.2.cmml">k</mi><mo id="S5.T3.3.3.1.m1.1.1.1" xref="S5.T3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.3.3.1.m1.1.1.3" xref="S5.T3.3.3.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.1.m1.1b"><apply id="S5.T3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.1.m1.1.1"><eq id="S5.T3.3.3.1.m1.1.1.1.cmml" xref="S5.T3.3.3.1.m1.1.1.1"></eq><ci id="S5.T3.3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.3.1.m1.1.1.2">𝑘</ci><cn id="S5.T3.3.3.1.m1.1.1.3.cmml" type="integer" xref="S5.T3.3.3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.1.m1.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.1.m1.1d">italic_k = 3</annotation></semantics></math>), tuned encoder</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d+Pd^{2})" class="ltx_Math" display="inline" id="S5.T3.4.4.2.m1.1"><semantics id="S5.T3.4.4.2.m1.1a"><mrow id="S5.T3.4.4.2.m1.1.1" xref="S5.T3.4.4.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.4.4.2.m1.1.1.3" xref="S5.T3.4.4.2.m1.1.1.3.cmml">𝒪</mi><mo id="S5.T3.4.4.2.m1.1.1.2" xref="S5.T3.4.4.2.m1.1.1.2.cmml">⁢</mo><mrow id="S5.T3.4.4.2.m1.1.1.1.1" xref="S5.T3.4.4.2.m1.1.1.1.1.1.cmml"><mo id="S5.T3.4.4.2.m1.1.1.1.1.2" stretchy="false" xref="S5.T3.4.4.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T3.4.4.2.m1.1.1.1.1.1" xref="S5.T3.4.4.2.m1.1.1.1.1.1.cmml"><mrow id="S5.T3.4.4.2.m1.1.1.1.1.1.2" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.cmml"><msup id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.cmml"><mi id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.2" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.3" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S5.T3.4.4.2.m1.1.1.1.1.1.2.1" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.T3.4.4.2.m1.1.1.1.1.1.2.3" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="S5.T3.4.4.2.m1.1.1.1.1.1.1" xref="S5.T3.4.4.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T3.4.4.2.m1.1.1.1.1.1.3" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.cmml"><mi id="S5.T3.4.4.2.m1.1.1.1.1.1.3.2" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.2.cmml">P</mi><mo id="S5.T3.4.4.2.m1.1.1.1.1.1.3.1" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.2" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.2.cmml">d</mi><mn id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.3" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S5.T3.4.4.2.m1.1.1.1.1.3" stretchy="false" xref="S5.T3.4.4.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.2.m1.1b"><apply id="S5.T3.4.4.2.m1.1.1.cmml" xref="S5.T3.4.4.2.m1.1.1"><times id="S5.T3.4.4.2.m1.1.1.2.cmml" xref="S5.T3.4.4.2.m1.1.1.2"></times><ci id="S5.T3.4.4.2.m1.1.1.3.cmml" xref="S5.T3.4.4.2.m1.1.1.3">𝒪</ci><apply id="S5.T3.4.4.2.m1.1.1.1.1.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1"><plus id="S5.T3.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.1"></plus><apply id="S5.T3.4.4.2.m1.1.1.1.1.1.2.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2"><times id="S5.T3.4.4.2.m1.1.1.1.1.1.2.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.1"></times><apply id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="S5.T3.4.4.2.m1.1.1.1.1.1.2.3.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S5.T3.4.4.2.m1.1.1.1.1.1.3.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3"><times id="S5.T3.4.4.2.m1.1.1.1.1.1.3.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.1"></times><ci id="S5.T3.4.4.2.m1.1.1.1.1.1.3.2.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.2">𝑃</ci><apply id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.2">𝑑</ci><cn id="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S5.T3.4.4.2.m1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.2.m1.1c">\mathcal{O}(P^{2}d+Pd^{2})</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.4.2.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + italic_P italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S5.T3.6.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Full <span class="ltx_text ltx_font_typewriter" id="S5.T3.6.6.3.1">Autoformer</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MA filter (<math alttext="k=25" class="ltx_Math" display="inline" id="S5.T3.5.5.1.m1.1"><semantics id="S5.T3.5.5.1.m1.1a"><mrow id="S5.T3.5.5.1.m1.1.1" xref="S5.T3.5.5.1.m1.1.1.cmml"><mi id="S5.T3.5.5.1.m1.1.1.2" xref="S5.T3.5.5.1.m1.1.1.2.cmml">k</mi><mo id="S5.T3.5.5.1.m1.1.1.1" xref="S5.T3.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.5.5.1.m1.1.1.3" xref="S5.T3.5.5.1.m1.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.1.m1.1b"><apply id="S5.T3.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.1.m1.1.1"><eq id="S5.T3.5.5.1.m1.1.1.1.cmml" xref="S5.T3.5.5.1.m1.1.1.1"></eq><ci id="S5.T3.5.5.1.m1.1.1.2.cmml" xref="S5.T3.5.5.1.m1.1.1.2">𝑘</ci><cn id="S5.T3.5.5.1.m1.1.1.3.cmml" type="integer" xref="S5.T3.5.5.1.m1.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.1.m1.1c">k=25</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.5.1.m1.1d">italic_k = 25</annotation></semantics></math>), sequence-to-sequence</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.6.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Encoder-Decoder</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{O}(P^{2}d+H^{2}d+HPd)" class="ltx_Math" display="inline" id="S5.T3.6.6.2.m1.1"><semantics id="S5.T3.6.6.2.m1.1a"><mrow id="S5.T3.6.6.2.m1.1.1" xref="S5.T3.6.6.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.6.6.2.m1.1.1.3" xref="S5.T3.6.6.2.m1.1.1.3.cmml">𝒪</mi><mo id="S5.T3.6.6.2.m1.1.1.2" xref="S5.T3.6.6.2.m1.1.1.2.cmml">⁢</mo><mrow id="S5.T3.6.6.2.m1.1.1.1.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.cmml"><mo id="S5.T3.6.6.2.m1.1.1.1.1.2" stretchy="false" xref="S5.T3.6.6.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T3.6.6.2.m1.1.1.1.1.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.cmml"><mrow id="S5.T3.6.6.2.m1.1.1.1.1.1.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.cmml"><msup id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.cmml"><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.2.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.2.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T3.6.6.2.m1.1.1.1.1.1.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.cmml"><msup id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.cmml"><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.2.cmml">H</mi><mn id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.3.cmml">2</mn></msup><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.3.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.3.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.3.cmml">d</mi></mrow><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.1a" xref="S5.T3.6.6.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T3.6.6.2.m1.1.1.1.1.1.4" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.cmml"><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.4.2" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.2.cmml">H</mi><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.4.1" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.4.3" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.3.cmml">P</mi><mo id="S5.T3.6.6.2.m1.1.1.1.1.1.4.1a" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S5.T3.6.6.2.m1.1.1.1.1.1.4.4" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.4.cmml">d</mi></mrow></mrow><mo id="S5.T3.6.6.2.m1.1.1.1.1.3" stretchy="false" xref="S5.T3.6.6.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.2.m1.1b"><apply id="S5.T3.6.6.2.m1.1.1.cmml" xref="S5.T3.6.6.2.m1.1.1"><times id="S5.T3.6.6.2.m1.1.1.2.cmml" xref="S5.T3.6.6.2.m1.1.1.2"></times><ci id="S5.T3.6.6.2.m1.1.1.3.cmml" xref="S5.T3.6.6.2.m1.1.1.3">𝒪</ci><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1"><plus id="S5.T3.6.6.2.m1.1.1.1.1.1.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.1"></plus><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2"><times id="S5.T3.6.6.2.m1.1.1.1.1.1.2.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.1"></times><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.2.3.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.3.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3"><times id="S5.T3.6.6.2.m1.1.1.1.1.1.3.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.1"></times><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.2">𝐻</ci><cn id="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.3.3.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S5.T3.6.6.2.m1.1.1.1.1.1.4.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4"><times id="S5.T3.6.6.2.m1.1.1.1.1.1.4.1.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.1"></times><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.4.2.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.2">𝐻</ci><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.4.3.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.3">𝑃</ci><ci id="S5.T3.6.6.2.m1.1.1.1.1.1.4.4.cmml" xref="S5.T3.6.6.2.m1.1.1.1.1.1.4.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.2.m1.1c">\mathcal{O}(P^{2}d+H^{2}d+HPd)</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.6.2.m1.1d">caligraphic_O ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + italic_H start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + italic_H italic_P italic_d )</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Numerical Simulations</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.2">To systematically evaluate the performance of Transformer-based forecasting models, we construct a diverse set of synthetic signals that reflect various temporal dynamics observed in real-world time series. Let <math alttext="t\in\{0,1,2,\dots,499\}" class="ltx_Math" display="inline" id="S6.p1.1.m1.5"><semantics id="S6.p1.1.m1.5a"><mrow id="S6.p1.1.m1.5.6" xref="S6.p1.1.m1.5.6.cmml"><mi id="S6.p1.1.m1.5.6.2" xref="S6.p1.1.m1.5.6.2.cmml">t</mi><mo id="S6.p1.1.m1.5.6.1" xref="S6.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="S6.p1.1.m1.5.6.3.2" xref="S6.p1.1.m1.5.6.3.1.cmml"><mo id="S6.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S6.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">0</mn><mo id="S6.p1.1.m1.5.6.3.2.2" xref="S6.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.p1.1.m1.2.2" xref="S6.p1.1.m1.2.2.cmml">1</mn><mo id="S6.p1.1.m1.5.6.3.2.3" xref="S6.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.p1.1.m1.3.3" xref="S6.p1.1.m1.3.3.cmml">2</mn><mo id="S6.p1.1.m1.5.6.3.2.4" xref="S6.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S6.p1.1.m1.4.4" mathvariant="normal" xref="S6.p1.1.m1.4.4.cmml">…</mi><mo id="S6.p1.1.m1.5.6.3.2.5" xref="S6.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.p1.1.m1.5.5" xref="S6.p1.1.m1.5.5.cmml">499</mn><mo id="S6.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S6.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.5b"><apply id="S6.p1.1.m1.5.6.cmml" xref="S6.p1.1.m1.5.6"><in id="S6.p1.1.m1.5.6.1.cmml" xref="S6.p1.1.m1.5.6.1"></in><ci id="S6.p1.1.m1.5.6.2.cmml" xref="S6.p1.1.m1.5.6.2">𝑡</ci><set id="S6.p1.1.m1.5.6.3.1.cmml" xref="S6.p1.1.m1.5.6.3.2"><cn id="S6.p1.1.m1.1.1.cmml" type="integer" xref="S6.p1.1.m1.1.1">0</cn><cn id="S6.p1.1.m1.2.2.cmml" type="integer" xref="S6.p1.1.m1.2.2">1</cn><cn id="S6.p1.1.m1.3.3.cmml" type="integer" xref="S6.p1.1.m1.3.3">2</cn><ci id="S6.p1.1.m1.4.4.cmml" xref="S6.p1.1.m1.4.4">…</ci><cn id="S6.p1.1.m1.5.5.cmml" type="integer" xref="S6.p1.1.m1.5.5">499</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.5c">t\in\{0,1,2,\dots,499\}</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.5d">italic_t ∈ { 0 , 1 , 2 , … , 499 }</annotation></semantics></math>. The clean signals <math alttext="s(t)" class="ltx_Math" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mrow id="S6.p1.2.m2.1.2" xref="S6.p1.2.m2.1.2.cmml"><mi id="S6.p1.2.m2.1.2.2" xref="S6.p1.2.m2.1.2.2.cmml">s</mi><mo id="S6.p1.2.m2.1.2.1" xref="S6.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S6.p1.2.m2.1.2.3.2" xref="S6.p1.2.m2.1.2.cmml"><mo id="S6.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S6.p1.2.m2.1.2.cmml">(</mo><mi id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">t</mi><mo id="S6.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S6.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><apply id="S6.p1.2.m2.1.2.cmml" xref="S6.p1.2.m2.1.2"><times id="S6.p1.2.m2.1.2.1.cmml" xref="S6.p1.2.m2.1.2.1"></times><ci id="S6.p1.2.m2.1.2.2.cmml" xref="S6.p1.2.m2.1.2.2">𝑠</ci><ci id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">s(t)</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">italic_s ( italic_t )</annotation></semantics></math> are mathematically defined as:</p>
</div>
<div class="ltx_para" id="S6.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx13">
<tbody id="S6.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Sine:}\quad s(t)=\sin\left(\frac{2\pi t}{40}\right)," class="ltx_Math" display="inline" id="S6.Ex18.m1.5"><semantics id="S6.Ex18.m1.5a"><mrow id="S6.Ex18.m1.5.5.1" xref="S6.Ex18.m1.5.5.1.1.cmml"><mrow id="S6.Ex18.m1.5.5.1.1" xref="S6.Ex18.m1.5.5.1.1.cmml"><mrow id="S6.Ex18.m1.5.5.1.1.1.1" xref="S6.Ex18.m1.5.5.1.1.1.2.cmml"><mtext id="S6.Ex18.m1.4.4" xref="S6.Ex18.m1.4.4a.cmml">Sine:</mtext><mspace id="S6.Ex18.m1.5.5.1.1.1.1.2" width="1em" xref="S6.Ex18.m1.5.5.1.1.1.2.cmml"></mspace><mrow id="S6.Ex18.m1.5.5.1.1.1.1.1" xref="S6.Ex18.m1.5.5.1.1.1.1.1.cmml"><mi id="S6.Ex18.m1.5.5.1.1.1.1.1.2" xref="S6.Ex18.m1.5.5.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex18.m1.5.5.1.1.1.1.1.1" xref="S6.Ex18.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex18.m1.5.5.1.1.1.1.1.3.2" xref="S6.Ex18.m1.5.5.1.1.1.1.1.cmml"><mo id="S6.Ex18.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex18.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex18.m1.1.1" xref="S6.Ex18.m1.1.1.cmml">t</mi><mo id="S6.Ex18.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex18.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex18.m1.5.5.1.1.2" xref="S6.Ex18.m1.5.5.1.1.2.cmml">=</mo><mrow id="S6.Ex18.m1.5.5.1.1.3.2" xref="S6.Ex18.m1.5.5.1.1.3.1.cmml"><mi id="S6.Ex18.m1.2.2" xref="S6.Ex18.m1.2.2.cmml">sin</mi><mo id="S6.Ex18.m1.5.5.1.1.3.2a" xref="S6.Ex18.m1.5.5.1.1.3.1.cmml">⁡</mo><mrow id="S6.Ex18.m1.5.5.1.1.3.2.1" xref="S6.Ex18.m1.5.5.1.1.3.1.cmml"><mo id="S6.Ex18.m1.5.5.1.1.3.2.1.1" xref="S6.Ex18.m1.5.5.1.1.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex18.m1.3.3" xref="S6.Ex18.m1.3.3.cmml"><mfrac id="S6.Ex18.m1.3.3a" xref="S6.Ex18.m1.3.3.cmml"><mrow id="S6.Ex18.m1.3.3.2" xref="S6.Ex18.m1.3.3.2.cmml"><mn id="S6.Ex18.m1.3.3.2.2" xref="S6.Ex18.m1.3.3.2.2.cmml">2</mn><mo id="S6.Ex18.m1.3.3.2.1" xref="S6.Ex18.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex18.m1.3.3.2.3" xref="S6.Ex18.m1.3.3.2.3.cmml">π</mi><mo id="S6.Ex18.m1.3.3.2.1a" xref="S6.Ex18.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex18.m1.3.3.2.4" xref="S6.Ex18.m1.3.3.2.4.cmml">t</mi></mrow><mn id="S6.Ex18.m1.3.3.3" xref="S6.Ex18.m1.3.3.3.cmml">40</mn></mfrac></mstyle><mo id="S6.Ex18.m1.5.5.1.1.3.2.1.2" xref="S6.Ex18.m1.5.5.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex18.m1.5.5.1.2" xref="S6.Ex18.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex18.m1.5b"><apply id="S6.Ex18.m1.5.5.1.1.cmml" xref="S6.Ex18.m1.5.5.1"><eq id="S6.Ex18.m1.5.5.1.1.2.cmml" xref="S6.Ex18.m1.5.5.1.1.2"></eq><list id="S6.Ex18.m1.5.5.1.1.1.2.cmml" xref="S6.Ex18.m1.5.5.1.1.1.1"><ci id="S6.Ex18.m1.4.4a.cmml" xref="S6.Ex18.m1.4.4"><mtext id="S6.Ex18.m1.4.4.cmml" xref="S6.Ex18.m1.4.4">Sine:</mtext></ci><apply id="S6.Ex18.m1.5.5.1.1.1.1.1.cmml" xref="S6.Ex18.m1.5.5.1.1.1.1.1"><times id="S6.Ex18.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex18.m1.5.5.1.1.1.1.1.1"></times><ci id="S6.Ex18.m1.5.5.1.1.1.1.1.2.cmml" xref="S6.Ex18.m1.5.5.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex18.m1.1.1.cmml" xref="S6.Ex18.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex18.m1.5.5.1.1.3.1.cmml" xref="S6.Ex18.m1.5.5.1.1.3.2"><sin id="S6.Ex18.m1.2.2.cmml" xref="S6.Ex18.m1.2.2"></sin><apply id="S6.Ex18.m1.3.3.cmml" xref="S6.Ex18.m1.3.3"><divide id="S6.Ex18.m1.3.3.1.cmml" xref="S6.Ex18.m1.3.3"></divide><apply id="S6.Ex18.m1.3.3.2.cmml" xref="S6.Ex18.m1.3.3.2"><times id="S6.Ex18.m1.3.3.2.1.cmml" xref="S6.Ex18.m1.3.3.2.1"></times><cn id="S6.Ex18.m1.3.3.2.2.cmml" type="integer" xref="S6.Ex18.m1.3.3.2.2">2</cn><ci id="S6.Ex18.m1.3.3.2.3.cmml" xref="S6.Ex18.m1.3.3.2.3">𝜋</ci><ci id="S6.Ex18.m1.3.3.2.4.cmml" xref="S6.Ex18.m1.3.3.2.4">𝑡</ci></apply><cn id="S6.Ex18.m1.3.3.3.cmml" type="integer" xref="S6.Ex18.m1.3.3.3">40</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex18.m1.5c">\displaystyle\text{Sine:}\quad s(t)=\sin\left(\frac{2\pi t}{40}\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex18.m1.5d">Sine: italic_s ( italic_t ) = roman_sin ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 40 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Cosine + Trend:}\quad s(t)=0.01t+\cos\left(\frac{2\pi t}{50%
}\right)," class="ltx_Math" display="inline" id="S6.Ex19.m1.5"><semantics id="S6.Ex19.m1.5a"><mrow id="S6.Ex19.m1.5.5.1" xref="S6.Ex19.m1.5.5.1.1.cmml"><mrow id="S6.Ex19.m1.5.5.1.1" xref="S6.Ex19.m1.5.5.1.1.cmml"><mrow id="S6.Ex19.m1.5.5.1.1.1.1" xref="S6.Ex19.m1.5.5.1.1.1.2.cmml"><mtext id="S6.Ex19.m1.4.4" xref="S6.Ex19.m1.4.4a.cmml">Cosine + Trend:</mtext><mspace id="S6.Ex19.m1.5.5.1.1.1.1.2" width="1em" xref="S6.Ex19.m1.5.5.1.1.1.2.cmml"></mspace><mrow id="S6.Ex19.m1.5.5.1.1.1.1.1" xref="S6.Ex19.m1.5.5.1.1.1.1.1.cmml"><mi id="S6.Ex19.m1.5.5.1.1.1.1.1.2" xref="S6.Ex19.m1.5.5.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex19.m1.5.5.1.1.1.1.1.1" xref="S6.Ex19.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex19.m1.5.5.1.1.1.1.1.3.2" xref="S6.Ex19.m1.5.5.1.1.1.1.1.cmml"><mo id="S6.Ex19.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex19.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex19.m1.1.1" xref="S6.Ex19.m1.1.1.cmml">t</mi><mo id="S6.Ex19.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex19.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex19.m1.5.5.1.1.2" xref="S6.Ex19.m1.5.5.1.1.2.cmml">=</mo><mrow id="S6.Ex19.m1.5.5.1.1.3" xref="S6.Ex19.m1.5.5.1.1.3.cmml"><mrow id="S6.Ex19.m1.5.5.1.1.3.2" xref="S6.Ex19.m1.5.5.1.1.3.2.cmml"><mn id="S6.Ex19.m1.5.5.1.1.3.2.2" xref="S6.Ex19.m1.5.5.1.1.3.2.2.cmml">0.01</mn><mo id="S6.Ex19.m1.5.5.1.1.3.2.1" xref="S6.Ex19.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S6.Ex19.m1.5.5.1.1.3.2.3" xref="S6.Ex19.m1.5.5.1.1.3.2.3.cmml">t</mi></mrow><mo id="S6.Ex19.m1.5.5.1.1.3.1" xref="S6.Ex19.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S6.Ex19.m1.5.5.1.1.3.3.2" xref="S6.Ex19.m1.5.5.1.1.3.3.1.cmml"><mi id="S6.Ex19.m1.2.2" xref="S6.Ex19.m1.2.2.cmml">cos</mi><mo id="S6.Ex19.m1.5.5.1.1.3.3.2a" xref="S6.Ex19.m1.5.5.1.1.3.3.1.cmml">⁡</mo><mrow id="S6.Ex19.m1.5.5.1.1.3.3.2.1" xref="S6.Ex19.m1.5.5.1.1.3.3.1.cmml"><mo id="S6.Ex19.m1.5.5.1.1.3.3.2.1.1" xref="S6.Ex19.m1.5.5.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex19.m1.3.3" xref="S6.Ex19.m1.3.3.cmml"><mfrac id="S6.Ex19.m1.3.3a" xref="S6.Ex19.m1.3.3.cmml"><mrow id="S6.Ex19.m1.3.3.2" xref="S6.Ex19.m1.3.3.2.cmml"><mn id="S6.Ex19.m1.3.3.2.2" xref="S6.Ex19.m1.3.3.2.2.cmml">2</mn><mo id="S6.Ex19.m1.3.3.2.1" xref="S6.Ex19.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex19.m1.3.3.2.3" xref="S6.Ex19.m1.3.3.2.3.cmml">π</mi><mo id="S6.Ex19.m1.3.3.2.1a" xref="S6.Ex19.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex19.m1.3.3.2.4" xref="S6.Ex19.m1.3.3.2.4.cmml">t</mi></mrow><mn id="S6.Ex19.m1.3.3.3" xref="S6.Ex19.m1.3.3.3.cmml">50</mn></mfrac></mstyle><mo id="S6.Ex19.m1.5.5.1.1.3.3.2.1.2" xref="S6.Ex19.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex19.m1.5.5.1.2" xref="S6.Ex19.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex19.m1.5b"><apply id="S6.Ex19.m1.5.5.1.1.cmml" xref="S6.Ex19.m1.5.5.1"><eq id="S6.Ex19.m1.5.5.1.1.2.cmml" xref="S6.Ex19.m1.5.5.1.1.2"></eq><list id="S6.Ex19.m1.5.5.1.1.1.2.cmml" xref="S6.Ex19.m1.5.5.1.1.1.1"><ci id="S6.Ex19.m1.4.4a.cmml" xref="S6.Ex19.m1.4.4"><mtext id="S6.Ex19.m1.4.4.cmml" xref="S6.Ex19.m1.4.4">Cosine + Trend:</mtext></ci><apply id="S6.Ex19.m1.5.5.1.1.1.1.1.cmml" xref="S6.Ex19.m1.5.5.1.1.1.1.1"><times id="S6.Ex19.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex19.m1.5.5.1.1.1.1.1.1"></times><ci id="S6.Ex19.m1.5.5.1.1.1.1.1.2.cmml" xref="S6.Ex19.m1.5.5.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex19.m1.1.1.cmml" xref="S6.Ex19.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex19.m1.5.5.1.1.3.cmml" xref="S6.Ex19.m1.5.5.1.1.3"><plus id="S6.Ex19.m1.5.5.1.1.3.1.cmml" xref="S6.Ex19.m1.5.5.1.1.3.1"></plus><apply id="S6.Ex19.m1.5.5.1.1.3.2.cmml" xref="S6.Ex19.m1.5.5.1.1.3.2"><times id="S6.Ex19.m1.5.5.1.1.3.2.1.cmml" xref="S6.Ex19.m1.5.5.1.1.3.2.1"></times><cn id="S6.Ex19.m1.5.5.1.1.3.2.2.cmml" type="float" xref="S6.Ex19.m1.5.5.1.1.3.2.2">0.01</cn><ci id="S6.Ex19.m1.5.5.1.1.3.2.3.cmml" xref="S6.Ex19.m1.5.5.1.1.3.2.3">𝑡</ci></apply><apply id="S6.Ex19.m1.5.5.1.1.3.3.1.cmml" xref="S6.Ex19.m1.5.5.1.1.3.3.2"><cos id="S6.Ex19.m1.2.2.cmml" xref="S6.Ex19.m1.2.2"></cos><apply id="S6.Ex19.m1.3.3.cmml" xref="S6.Ex19.m1.3.3"><divide id="S6.Ex19.m1.3.3.1.cmml" xref="S6.Ex19.m1.3.3"></divide><apply id="S6.Ex19.m1.3.3.2.cmml" xref="S6.Ex19.m1.3.3.2"><times id="S6.Ex19.m1.3.3.2.1.cmml" xref="S6.Ex19.m1.3.3.2.1"></times><cn id="S6.Ex19.m1.3.3.2.2.cmml" type="integer" xref="S6.Ex19.m1.3.3.2.2">2</cn><ci id="S6.Ex19.m1.3.3.2.3.cmml" xref="S6.Ex19.m1.3.3.2.3">𝜋</ci><ci id="S6.Ex19.m1.3.3.2.4.cmml" xref="S6.Ex19.m1.3.3.2.4">𝑡</ci></apply><cn id="S6.Ex19.m1.3.3.3.cmml" type="integer" xref="S6.Ex19.m1.3.3.3">50</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex19.m1.5c">\displaystyle\text{Cosine + Trend:}\quad s(t)=0.01t+\cos\left(\frac{2\pi t}{50%
}\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex19.m1.5d">Cosine + Trend: italic_s ( italic_t ) = 0.01 italic_t + roman_cos ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 50 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Exponential Decay $\times$ Sine:}\quad s(t)=e^{-0.01t}\cdot%
\sin\left(\frac{2\pi t}{50}\right)," class="ltx_Math" display="inline" id="S6.Ex20.m1.5"><semantics id="S6.Ex20.m1.5a"><mrow id="S6.Ex20.m1.5.5.1" xref="S6.Ex20.m1.5.5.1.1.cmml"><mrow id="S6.Ex20.m1.5.5.1.1" xref="S6.Ex20.m1.5.5.1.1.cmml"><mrow id="S6.Ex20.m1.5.5.1.1.1.1" xref="S6.Ex20.m1.5.5.1.1.1.2.cmml"><mrow id="S6.Ex20.m1.1.1.1a" xref="S6.Ex20.m1.1.1.1ac.cmml"><mtext id="S6.Ex20.m1.1.1.1aa" xref="S6.Ex20.m1.1.1.1ac.cmml">Exponential Decay </mtext><mo id="S6.Ex20.m1.1.1.1.m1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.Ex20.m1.1.1.1.m1.1.1.cmml">×</mo><mtext id="S6.Ex20.m1.1.1.1ab" xref="S6.Ex20.m1.1.1.1ac.cmml"> Sine:</mtext></mrow><mspace id="S6.Ex20.m1.5.5.1.1.1.1.2" width="1em" xref="S6.Ex20.m1.5.5.1.1.1.2.cmml"></mspace><mrow id="S6.Ex20.m1.5.5.1.1.1.1.1" xref="S6.Ex20.m1.5.5.1.1.1.1.1.cmml"><mi id="S6.Ex20.m1.5.5.1.1.1.1.1.2" xref="S6.Ex20.m1.5.5.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex20.m1.5.5.1.1.1.1.1.1" xref="S6.Ex20.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex20.m1.5.5.1.1.1.1.1.3.2" xref="S6.Ex20.m1.5.5.1.1.1.1.1.cmml"><mo id="S6.Ex20.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex20.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex20.m1.2.2" xref="S6.Ex20.m1.2.2.cmml">t</mi><mo id="S6.Ex20.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex20.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex20.m1.5.5.1.1.2" xref="S6.Ex20.m1.5.5.1.1.2.cmml">=</mo><mrow id="S6.Ex20.m1.5.5.1.1.3" xref="S6.Ex20.m1.5.5.1.1.3.cmml"><msup id="S6.Ex20.m1.5.5.1.1.3.2" xref="S6.Ex20.m1.5.5.1.1.3.2.cmml"><mi id="S6.Ex20.m1.5.5.1.1.3.2.2" xref="S6.Ex20.m1.5.5.1.1.3.2.2.cmml">e</mi><mrow id="S6.Ex20.m1.5.5.1.1.3.2.3" xref="S6.Ex20.m1.5.5.1.1.3.2.3.cmml"><mo id="S6.Ex20.m1.5.5.1.1.3.2.3a" xref="S6.Ex20.m1.5.5.1.1.3.2.3.cmml">−</mo><mrow id="S6.Ex20.m1.5.5.1.1.3.2.3.2" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.cmml"><mn id="S6.Ex20.m1.5.5.1.1.3.2.3.2.2" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.2.cmml">0.01</mn><mo id="S6.Ex20.m1.5.5.1.1.3.2.3.2.1" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.1.cmml">⁢</mo><mi id="S6.Ex20.m1.5.5.1.1.3.2.3.2.3" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.3.cmml">t</mi></mrow></mrow></msup><mo id="S6.Ex20.m1.5.5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.Ex20.m1.5.5.1.1.3.1.cmml">⋅</mo><mrow id="S6.Ex20.m1.5.5.1.1.3.3.2" xref="S6.Ex20.m1.5.5.1.1.3.3.1.cmml"><mi id="S6.Ex20.m1.3.3" xref="S6.Ex20.m1.3.3.cmml">sin</mi><mo id="S6.Ex20.m1.5.5.1.1.3.3.2a" xref="S6.Ex20.m1.5.5.1.1.3.3.1.cmml">⁡</mo><mrow id="S6.Ex20.m1.5.5.1.1.3.3.2.1" xref="S6.Ex20.m1.5.5.1.1.3.3.1.cmml"><mo id="S6.Ex20.m1.5.5.1.1.3.3.2.1.1" xref="S6.Ex20.m1.5.5.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex20.m1.4.4" xref="S6.Ex20.m1.4.4.cmml"><mfrac id="S6.Ex20.m1.4.4a" xref="S6.Ex20.m1.4.4.cmml"><mrow id="S6.Ex20.m1.4.4.2" xref="S6.Ex20.m1.4.4.2.cmml"><mn id="S6.Ex20.m1.4.4.2.2" xref="S6.Ex20.m1.4.4.2.2.cmml">2</mn><mo id="S6.Ex20.m1.4.4.2.1" xref="S6.Ex20.m1.4.4.2.1.cmml">⁢</mo><mi id="S6.Ex20.m1.4.4.2.3" xref="S6.Ex20.m1.4.4.2.3.cmml">π</mi><mo id="S6.Ex20.m1.4.4.2.1a" xref="S6.Ex20.m1.4.4.2.1.cmml">⁢</mo><mi id="S6.Ex20.m1.4.4.2.4" xref="S6.Ex20.m1.4.4.2.4.cmml">t</mi></mrow><mn id="S6.Ex20.m1.4.4.3" xref="S6.Ex20.m1.4.4.3.cmml">50</mn></mfrac></mstyle><mo id="S6.Ex20.m1.5.5.1.1.3.3.2.1.2" xref="S6.Ex20.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex20.m1.5.5.1.2" xref="S6.Ex20.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex20.m1.5b"><apply id="S6.Ex20.m1.5.5.1.1.cmml" xref="S6.Ex20.m1.5.5.1"><eq id="S6.Ex20.m1.5.5.1.1.2.cmml" xref="S6.Ex20.m1.5.5.1.1.2"></eq><list id="S6.Ex20.m1.5.5.1.1.1.2.cmml" xref="S6.Ex20.m1.5.5.1.1.1.1"><ci id="S6.Ex20.m1.1.1.1ac.cmml" xref="S6.Ex20.m1.1.1.1a"><mrow id="S6.Ex20.m1.1.1.1a.cmml" xref="S6.Ex20.m1.1.1.1a"><mtext id="S6.Ex20.m1.1.1.1aa.cmml" xref="S6.Ex20.m1.1.1.1a">Exponential Decay </mtext><mo id="S6.Ex20.m1.1.1.1.m1.1.1.cmml" xref="S6.Ex20.m1.1.1.1.m1.1.1">×</mo><mtext id="S6.Ex20.m1.1.1.1ab.cmml" xref="S6.Ex20.m1.1.1.1a"> Sine:</mtext></mrow></ci><apply id="S6.Ex20.m1.5.5.1.1.1.1.1.cmml" xref="S6.Ex20.m1.5.5.1.1.1.1.1"><times id="S6.Ex20.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex20.m1.5.5.1.1.1.1.1.1"></times><ci id="S6.Ex20.m1.5.5.1.1.1.1.1.2.cmml" xref="S6.Ex20.m1.5.5.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex20.m1.2.2.cmml" xref="S6.Ex20.m1.2.2">𝑡</ci></apply></list><apply id="S6.Ex20.m1.5.5.1.1.3.cmml" xref="S6.Ex20.m1.5.5.1.1.3"><ci id="S6.Ex20.m1.5.5.1.1.3.1.cmml" xref="S6.Ex20.m1.5.5.1.1.3.1">⋅</ci><apply id="S6.Ex20.m1.5.5.1.1.3.2.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex20.m1.5.5.1.1.3.2.1.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2">superscript</csymbol><ci id="S6.Ex20.m1.5.5.1.1.3.2.2.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.2">𝑒</ci><apply id="S6.Ex20.m1.5.5.1.1.3.2.3.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.3"><minus id="S6.Ex20.m1.5.5.1.1.3.2.3.1.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.3"></minus><apply id="S6.Ex20.m1.5.5.1.1.3.2.3.2.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2"><times id="S6.Ex20.m1.5.5.1.1.3.2.3.2.1.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.1"></times><cn id="S6.Ex20.m1.5.5.1.1.3.2.3.2.2.cmml" type="float" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.2">0.01</cn><ci id="S6.Ex20.m1.5.5.1.1.3.2.3.2.3.cmml" xref="S6.Ex20.m1.5.5.1.1.3.2.3.2.3">𝑡</ci></apply></apply></apply><apply id="S6.Ex20.m1.5.5.1.1.3.3.1.cmml" xref="S6.Ex20.m1.5.5.1.1.3.3.2"><sin id="S6.Ex20.m1.3.3.cmml" xref="S6.Ex20.m1.3.3"></sin><apply id="S6.Ex20.m1.4.4.cmml" xref="S6.Ex20.m1.4.4"><divide id="S6.Ex20.m1.4.4.1.cmml" xref="S6.Ex20.m1.4.4"></divide><apply id="S6.Ex20.m1.4.4.2.cmml" xref="S6.Ex20.m1.4.4.2"><times id="S6.Ex20.m1.4.4.2.1.cmml" xref="S6.Ex20.m1.4.4.2.1"></times><cn id="S6.Ex20.m1.4.4.2.2.cmml" type="integer" xref="S6.Ex20.m1.4.4.2.2">2</cn><ci id="S6.Ex20.m1.4.4.2.3.cmml" xref="S6.Ex20.m1.4.4.2.3">𝜋</ci><ci id="S6.Ex20.m1.4.4.2.4.cmml" xref="S6.Ex20.m1.4.4.2.4">𝑡</ci></apply><cn id="S6.Ex20.m1.4.4.3.cmml" type="integer" xref="S6.Ex20.m1.4.4.3">50</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex20.m1.5c">\displaystyle\text{Exponential Decay $\times$ Sine:}\quad s(t)=e^{-0.01t}\cdot%
\sin\left(\frac{2\pi t}{50}\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex20.m1.5d">Exponential Decay × Sine: italic_s ( italic_t ) = italic_e start_POSTSUPERSCRIPT - 0.01 italic_t end_POSTSUPERSCRIPT ⋅ roman_sin ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 50 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{2nd Order Polynomial:}\quad s(t)=0.0001t^{2}-0.03t+3," class="ltx_Math" display="inline" id="S6.Ex21.m1.3"><semantics id="S6.Ex21.m1.3a"><mrow id="S6.Ex21.m1.3.3.1" xref="S6.Ex21.m1.3.3.1.1.cmml"><mrow id="S6.Ex21.m1.3.3.1.1" xref="S6.Ex21.m1.3.3.1.1.cmml"><mrow id="S6.Ex21.m1.3.3.1.1.1.1" xref="S6.Ex21.m1.3.3.1.1.1.2.cmml"><mtext id="S6.Ex21.m1.2.2" xref="S6.Ex21.m1.2.2a.cmml">2nd Order Polynomial:</mtext><mspace id="S6.Ex21.m1.3.3.1.1.1.1.2" width="1em" xref="S6.Ex21.m1.3.3.1.1.1.2.cmml"></mspace><mrow id="S6.Ex21.m1.3.3.1.1.1.1.1" xref="S6.Ex21.m1.3.3.1.1.1.1.1.cmml"><mi id="S6.Ex21.m1.3.3.1.1.1.1.1.2" xref="S6.Ex21.m1.3.3.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex21.m1.3.3.1.1.1.1.1.1" xref="S6.Ex21.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex21.m1.3.3.1.1.1.1.1.3.2" xref="S6.Ex21.m1.3.3.1.1.1.1.1.cmml"><mo id="S6.Ex21.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex21.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex21.m1.1.1" xref="S6.Ex21.m1.1.1.cmml">t</mi><mo id="S6.Ex21.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex21.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex21.m1.3.3.1.1.2" xref="S6.Ex21.m1.3.3.1.1.2.cmml">=</mo><mrow id="S6.Ex21.m1.3.3.1.1.3" xref="S6.Ex21.m1.3.3.1.1.3.cmml"><mrow id="S6.Ex21.m1.3.3.1.1.3.2" xref="S6.Ex21.m1.3.3.1.1.3.2.cmml"><mrow id="S6.Ex21.m1.3.3.1.1.3.2.2" xref="S6.Ex21.m1.3.3.1.1.3.2.2.cmml"><mn id="S6.Ex21.m1.3.3.1.1.3.2.2.2" xref="S6.Ex21.m1.3.3.1.1.3.2.2.2.cmml">0.0001</mn><mo id="S6.Ex21.m1.3.3.1.1.3.2.2.1" xref="S6.Ex21.m1.3.3.1.1.3.2.2.1.cmml">⁢</mo><msup id="S6.Ex21.m1.3.3.1.1.3.2.2.3" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S6.Ex21.m1.3.3.1.1.3.2.2.3.2" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3.2.cmml">t</mi><mn id="S6.Ex21.m1.3.3.1.1.3.2.2.3.3" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3.3.cmml">2</mn></msup></mrow><mo id="S6.Ex21.m1.3.3.1.1.3.2.1" xref="S6.Ex21.m1.3.3.1.1.3.2.1.cmml">−</mo><mrow id="S6.Ex21.m1.3.3.1.1.3.2.3" xref="S6.Ex21.m1.3.3.1.1.3.2.3.cmml"><mn id="S6.Ex21.m1.3.3.1.1.3.2.3.2" xref="S6.Ex21.m1.3.3.1.1.3.2.3.2.cmml">0.03</mn><mo id="S6.Ex21.m1.3.3.1.1.3.2.3.1" xref="S6.Ex21.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S6.Ex21.m1.3.3.1.1.3.2.3.3" xref="S6.Ex21.m1.3.3.1.1.3.2.3.3.cmml">t</mi></mrow></mrow><mo id="S6.Ex21.m1.3.3.1.1.3.1" xref="S6.Ex21.m1.3.3.1.1.3.1.cmml">+</mo><mn id="S6.Ex21.m1.3.3.1.1.3.3" xref="S6.Ex21.m1.3.3.1.1.3.3.cmml">3</mn></mrow></mrow><mo id="S6.Ex21.m1.3.3.1.2" xref="S6.Ex21.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex21.m1.3b"><apply id="S6.Ex21.m1.3.3.1.1.cmml" xref="S6.Ex21.m1.3.3.1"><eq id="S6.Ex21.m1.3.3.1.1.2.cmml" xref="S6.Ex21.m1.3.3.1.1.2"></eq><list id="S6.Ex21.m1.3.3.1.1.1.2.cmml" xref="S6.Ex21.m1.3.3.1.1.1.1"><ci id="S6.Ex21.m1.2.2a.cmml" xref="S6.Ex21.m1.2.2"><mtext id="S6.Ex21.m1.2.2.cmml" xref="S6.Ex21.m1.2.2">2nd Order Polynomial:</mtext></ci><apply id="S6.Ex21.m1.3.3.1.1.1.1.1.cmml" xref="S6.Ex21.m1.3.3.1.1.1.1.1"><times id="S6.Ex21.m1.3.3.1.1.1.1.1.1.cmml" xref="S6.Ex21.m1.3.3.1.1.1.1.1.1"></times><ci id="S6.Ex21.m1.3.3.1.1.1.1.1.2.cmml" xref="S6.Ex21.m1.3.3.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex21.m1.1.1.cmml" xref="S6.Ex21.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex21.m1.3.3.1.1.3.cmml" xref="S6.Ex21.m1.3.3.1.1.3"><plus id="S6.Ex21.m1.3.3.1.1.3.1.cmml" xref="S6.Ex21.m1.3.3.1.1.3.1"></plus><apply id="S6.Ex21.m1.3.3.1.1.3.2.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2"><minus id="S6.Ex21.m1.3.3.1.1.3.2.1.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.1"></minus><apply id="S6.Ex21.m1.3.3.1.1.3.2.2.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.2"><times id="S6.Ex21.m1.3.3.1.1.3.2.2.1.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.2.1"></times><cn id="S6.Ex21.m1.3.3.1.1.3.2.2.2.cmml" type="float" xref="S6.Ex21.m1.3.3.1.1.3.2.2.2">0.0001</cn><apply id="S6.Ex21.m1.3.3.1.1.3.2.2.3.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S6.Ex21.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3">superscript</csymbol><ci id="S6.Ex21.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3.2">𝑡</ci><cn id="S6.Ex21.m1.3.3.1.1.3.2.2.3.3.cmml" type="integer" xref="S6.Ex21.m1.3.3.1.1.3.2.2.3.3">2</cn></apply></apply><apply id="S6.Ex21.m1.3.3.1.1.3.2.3.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.3"><times id="S6.Ex21.m1.3.3.1.1.3.2.3.1.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.3.1"></times><cn id="S6.Ex21.m1.3.3.1.1.3.2.3.2.cmml" type="float" xref="S6.Ex21.m1.3.3.1.1.3.2.3.2">0.03</cn><ci id="S6.Ex21.m1.3.3.1.1.3.2.3.3.cmml" xref="S6.Ex21.m1.3.3.1.1.3.2.3.3">𝑡</ci></apply></apply><cn id="S6.Ex21.m1.3.3.1.1.3.3.cmml" type="integer" xref="S6.Ex21.m1.3.3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex21.m1.3c">\displaystyle\text{2nd Order Polynomial:}\quad s(t)=0.0001t^{2}-0.03t+3,</annotation><annotation encoding="application/x-llamapun" id="S6.Ex21.m1.3d">2nd Order Polynomial: italic_s ( italic_t ) = 0.0001 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 0.03 italic_t + 3 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Log \texttimes Sine:}\quad s(t)=\log(1+t)\cdot\sin\left(%
\frac{2\pi t}{80}\right)," class="ltx_Math" display="inline" id="S6.Ex22.m1.6"><semantics id="S6.Ex22.m1.6a"><mrow id="S6.Ex22.m1.6.6.1" xref="S6.Ex22.m1.6.6.1.1.cmml"><mrow id="S6.Ex22.m1.6.6.1.1" xref="S6.Ex22.m1.6.6.1.1.cmml"><mrow id="S6.Ex22.m1.6.6.1.1.1.1" xref="S6.Ex22.m1.6.6.1.1.1.2.cmml"><mtext id="S6.Ex22.m1.5.5" xref="S6.Ex22.m1.5.5a.cmml">Log × Sine:</mtext><mspace id="S6.Ex22.m1.6.6.1.1.1.1.2" width="1em" xref="S6.Ex22.m1.6.6.1.1.1.2.cmml"></mspace><mrow id="S6.Ex22.m1.6.6.1.1.1.1.1" xref="S6.Ex22.m1.6.6.1.1.1.1.1.cmml"><mi id="S6.Ex22.m1.6.6.1.1.1.1.1.2" xref="S6.Ex22.m1.6.6.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex22.m1.6.6.1.1.1.1.1.1" xref="S6.Ex22.m1.6.6.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex22.m1.6.6.1.1.1.1.1.3.2" xref="S6.Ex22.m1.6.6.1.1.1.1.1.cmml"><mo id="S6.Ex22.m1.6.6.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex22.m1.6.6.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex22.m1.1.1" xref="S6.Ex22.m1.1.1.cmml">t</mi><mo id="S6.Ex22.m1.6.6.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex22.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex22.m1.6.6.1.1.3" xref="S6.Ex22.m1.6.6.1.1.3.cmml">=</mo><mrow id="S6.Ex22.m1.6.6.1.1.2" xref="S6.Ex22.m1.6.6.1.1.2.cmml"><mrow id="S6.Ex22.m1.6.6.1.1.2.1.1" xref="S6.Ex22.m1.6.6.1.1.2.1.2.cmml"><mi id="S6.Ex22.m1.2.2" xref="S6.Ex22.m1.2.2.cmml">log</mi><mo id="S6.Ex22.m1.6.6.1.1.2.1.1a" xref="S6.Ex22.m1.6.6.1.1.2.1.2.cmml">⁡</mo><mrow id="S6.Ex22.m1.6.6.1.1.2.1.1.1" xref="S6.Ex22.m1.6.6.1.1.2.1.2.cmml"><mo id="S6.Ex22.m1.6.6.1.1.2.1.1.1.2" stretchy="false" xref="S6.Ex22.m1.6.6.1.1.2.1.2.cmml">(</mo><mrow id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.cmml"><mn id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.2" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.1" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.1.cmml">+</mo><mi id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.3" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.3.cmml">t</mi></mrow><mo id="S6.Ex22.m1.6.6.1.1.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S6.Ex22.m1.6.6.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S6.Ex22.m1.6.6.1.1.2.2" rspace="0.222em" xref="S6.Ex22.m1.6.6.1.1.2.2.cmml">⋅</mo><mrow id="S6.Ex22.m1.6.6.1.1.2.3.2" xref="S6.Ex22.m1.6.6.1.1.2.3.1.cmml"><mi id="S6.Ex22.m1.3.3" xref="S6.Ex22.m1.3.3.cmml">sin</mi><mo id="S6.Ex22.m1.6.6.1.1.2.3.2a" xref="S6.Ex22.m1.6.6.1.1.2.3.1.cmml">⁡</mo><mrow id="S6.Ex22.m1.6.6.1.1.2.3.2.1" xref="S6.Ex22.m1.6.6.1.1.2.3.1.cmml"><mo id="S6.Ex22.m1.6.6.1.1.2.3.2.1.1" xref="S6.Ex22.m1.6.6.1.1.2.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex22.m1.4.4" xref="S6.Ex22.m1.4.4.cmml"><mfrac id="S6.Ex22.m1.4.4a" xref="S6.Ex22.m1.4.4.cmml"><mrow id="S6.Ex22.m1.4.4.2" xref="S6.Ex22.m1.4.4.2.cmml"><mn id="S6.Ex22.m1.4.4.2.2" xref="S6.Ex22.m1.4.4.2.2.cmml">2</mn><mo id="S6.Ex22.m1.4.4.2.1" xref="S6.Ex22.m1.4.4.2.1.cmml">⁢</mo><mi id="S6.Ex22.m1.4.4.2.3" xref="S6.Ex22.m1.4.4.2.3.cmml">π</mi><mo id="S6.Ex22.m1.4.4.2.1a" xref="S6.Ex22.m1.4.4.2.1.cmml">⁢</mo><mi id="S6.Ex22.m1.4.4.2.4" xref="S6.Ex22.m1.4.4.2.4.cmml">t</mi></mrow><mn id="S6.Ex22.m1.4.4.3" xref="S6.Ex22.m1.4.4.3.cmml">80</mn></mfrac></mstyle><mo id="S6.Ex22.m1.6.6.1.1.2.3.2.1.2" xref="S6.Ex22.m1.6.6.1.1.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex22.m1.6.6.1.2" xref="S6.Ex22.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex22.m1.6b"><apply id="S6.Ex22.m1.6.6.1.1.cmml" xref="S6.Ex22.m1.6.6.1"><eq id="S6.Ex22.m1.6.6.1.1.3.cmml" xref="S6.Ex22.m1.6.6.1.1.3"></eq><list id="S6.Ex22.m1.6.6.1.1.1.2.cmml" xref="S6.Ex22.m1.6.6.1.1.1.1"><ci id="S6.Ex22.m1.5.5a.cmml" xref="S6.Ex22.m1.5.5"><mtext id="S6.Ex22.m1.5.5.cmml" xref="S6.Ex22.m1.5.5">Log × Sine:</mtext></ci><apply id="S6.Ex22.m1.6.6.1.1.1.1.1.cmml" xref="S6.Ex22.m1.6.6.1.1.1.1.1"><times id="S6.Ex22.m1.6.6.1.1.1.1.1.1.cmml" xref="S6.Ex22.m1.6.6.1.1.1.1.1.1"></times><ci id="S6.Ex22.m1.6.6.1.1.1.1.1.2.cmml" xref="S6.Ex22.m1.6.6.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex22.m1.1.1.cmml" xref="S6.Ex22.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex22.m1.6.6.1.1.2.cmml" xref="S6.Ex22.m1.6.6.1.1.2"><ci id="S6.Ex22.m1.6.6.1.1.2.2.cmml" xref="S6.Ex22.m1.6.6.1.1.2.2">⋅</ci><apply id="S6.Ex22.m1.6.6.1.1.2.1.2.cmml" xref="S6.Ex22.m1.6.6.1.1.2.1.1"><log id="S6.Ex22.m1.2.2.cmml" xref="S6.Ex22.m1.2.2"></log><apply id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.cmml" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1"><plus id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.1"></plus><cn id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.2.cmml" type="integer" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.2">1</cn><ci id="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.3.cmml" xref="S6.Ex22.m1.6.6.1.1.2.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S6.Ex22.m1.6.6.1.1.2.3.1.cmml" xref="S6.Ex22.m1.6.6.1.1.2.3.2"><sin id="S6.Ex22.m1.3.3.cmml" xref="S6.Ex22.m1.3.3"></sin><apply id="S6.Ex22.m1.4.4.cmml" xref="S6.Ex22.m1.4.4"><divide id="S6.Ex22.m1.4.4.1.cmml" xref="S6.Ex22.m1.4.4"></divide><apply id="S6.Ex22.m1.4.4.2.cmml" xref="S6.Ex22.m1.4.4.2"><times id="S6.Ex22.m1.4.4.2.1.cmml" xref="S6.Ex22.m1.4.4.2.1"></times><cn id="S6.Ex22.m1.4.4.2.2.cmml" type="integer" xref="S6.Ex22.m1.4.4.2.2">2</cn><ci id="S6.Ex22.m1.4.4.2.3.cmml" xref="S6.Ex22.m1.4.4.2.3">𝜋</ci><ci id="S6.Ex22.m1.4.4.2.4.cmml" xref="S6.Ex22.m1.4.4.2.4">𝑡</ci></apply><cn id="S6.Ex22.m1.4.4.3.cmml" type="integer" xref="S6.Ex22.m1.4.4.3">80</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex22.m1.6c">\displaystyle\text{Log \texttimes Sine:}\quad s(t)=\log(1+t)\cdot\sin\left(%
\frac{2\pi t}{80}\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex22.m1.6d">Log × Sine: italic_s ( italic_t ) = roman_log ( 1 + italic_t ) ⋅ roman_sin ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 80 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Gaussian Bump:}\quad s(t)=\exp\left(-\frac{(t-250)^{2}}{2%
\cdot 50^{2}}\right)," class="ltx_Math" display="inline" id="S6.Ex23.m1.5"><semantics id="S6.Ex23.m1.5a"><mrow id="S6.Ex23.m1.5.5.1" xref="S6.Ex23.m1.5.5.1.1.cmml"><mrow id="S6.Ex23.m1.5.5.1.1" xref="S6.Ex23.m1.5.5.1.1.cmml"><mrow id="S6.Ex23.m1.5.5.1.1.1.1" xref="S6.Ex23.m1.5.5.1.1.1.2.cmml"><mtext id="S6.Ex23.m1.4.4" xref="S6.Ex23.m1.4.4a.cmml">Gaussian Bump:</mtext><mspace id="S6.Ex23.m1.5.5.1.1.1.1.2" width="1em" xref="S6.Ex23.m1.5.5.1.1.1.2.cmml"></mspace><mrow id="S6.Ex23.m1.5.5.1.1.1.1.1" xref="S6.Ex23.m1.5.5.1.1.1.1.1.cmml"><mi id="S6.Ex23.m1.5.5.1.1.1.1.1.2" xref="S6.Ex23.m1.5.5.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex23.m1.5.5.1.1.1.1.1.1" xref="S6.Ex23.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex23.m1.5.5.1.1.1.1.1.3.2" xref="S6.Ex23.m1.5.5.1.1.1.1.1.cmml"><mo id="S6.Ex23.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex23.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex23.m1.2.2" xref="S6.Ex23.m1.2.2.cmml">t</mi><mo id="S6.Ex23.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex23.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex23.m1.5.5.1.1.3" xref="S6.Ex23.m1.5.5.1.1.3.cmml">=</mo><mrow id="S6.Ex23.m1.5.5.1.1.2.1" xref="S6.Ex23.m1.5.5.1.1.2.2.cmml"><mi id="S6.Ex23.m1.3.3" xref="S6.Ex23.m1.3.3.cmml">exp</mi><mo id="S6.Ex23.m1.5.5.1.1.2.1a" xref="S6.Ex23.m1.5.5.1.1.2.2.cmml">⁡</mo><mrow id="S6.Ex23.m1.5.5.1.1.2.1.1" xref="S6.Ex23.m1.5.5.1.1.2.2.cmml"><mo id="S6.Ex23.m1.5.5.1.1.2.1.1.2" xref="S6.Ex23.m1.5.5.1.1.2.2.cmml">(</mo><mrow id="S6.Ex23.m1.5.5.1.1.2.1.1.1" xref="S6.Ex23.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S6.Ex23.m1.5.5.1.1.2.1.1.1a" xref="S6.Ex23.m1.5.5.1.1.2.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="S6.Ex23.m1.1.1" xref="S6.Ex23.m1.1.1.cmml"><mfrac id="S6.Ex23.m1.1.1a" xref="S6.Ex23.m1.1.1.cmml"><msup id="S6.Ex23.m1.1.1.1" xref="S6.Ex23.m1.1.1.1.cmml"><mrow id="S6.Ex23.m1.1.1.1.1.1" xref="S6.Ex23.m1.1.1.1.1.1.1.cmml"><mo id="S6.Ex23.m1.1.1.1.1.1.2" stretchy="false" xref="S6.Ex23.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex23.m1.1.1.1.1.1.1" xref="S6.Ex23.m1.1.1.1.1.1.1.cmml"><mi id="S6.Ex23.m1.1.1.1.1.1.1.2" xref="S6.Ex23.m1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S6.Ex23.m1.1.1.1.1.1.1.1" xref="S6.Ex23.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S6.Ex23.m1.1.1.1.1.1.1.3" xref="S6.Ex23.m1.1.1.1.1.1.1.3.cmml">250</mn></mrow><mo id="S6.Ex23.m1.1.1.1.1.1.3" stretchy="false" xref="S6.Ex23.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.Ex23.m1.1.1.1.3" xref="S6.Ex23.m1.1.1.1.3.cmml">2</mn></msup><mrow id="S6.Ex23.m1.1.1.3" xref="S6.Ex23.m1.1.1.3.cmml"><mn id="S6.Ex23.m1.1.1.3.2" xref="S6.Ex23.m1.1.1.3.2.cmml">2</mn><mo id="S6.Ex23.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.Ex23.m1.1.1.3.1.cmml">⋅</mo><msup id="S6.Ex23.m1.1.1.3.3" xref="S6.Ex23.m1.1.1.3.3.cmml"><mn id="S6.Ex23.m1.1.1.3.3.2" xref="S6.Ex23.m1.1.1.3.3.2.cmml">50</mn><mn id="S6.Ex23.m1.1.1.3.3.3" xref="S6.Ex23.m1.1.1.3.3.3.cmml">2</mn></msup></mrow></mfrac></mstyle></mrow><mo id="S6.Ex23.m1.5.5.1.1.2.1.1.3" xref="S6.Ex23.m1.5.5.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex23.m1.5.5.1.2" xref="S6.Ex23.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex23.m1.5b"><apply id="S6.Ex23.m1.5.5.1.1.cmml" xref="S6.Ex23.m1.5.5.1"><eq id="S6.Ex23.m1.5.5.1.1.3.cmml" xref="S6.Ex23.m1.5.5.1.1.3"></eq><list id="S6.Ex23.m1.5.5.1.1.1.2.cmml" xref="S6.Ex23.m1.5.5.1.1.1.1"><ci id="S6.Ex23.m1.4.4a.cmml" xref="S6.Ex23.m1.4.4"><mtext id="S6.Ex23.m1.4.4.cmml" xref="S6.Ex23.m1.4.4">Gaussian Bump:</mtext></ci><apply id="S6.Ex23.m1.5.5.1.1.1.1.1.cmml" xref="S6.Ex23.m1.5.5.1.1.1.1.1"><times id="S6.Ex23.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex23.m1.5.5.1.1.1.1.1.1"></times><ci id="S6.Ex23.m1.5.5.1.1.1.1.1.2.cmml" xref="S6.Ex23.m1.5.5.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex23.m1.2.2.cmml" xref="S6.Ex23.m1.2.2">𝑡</ci></apply></list><apply id="S6.Ex23.m1.5.5.1.1.2.2.cmml" xref="S6.Ex23.m1.5.5.1.1.2.1"><exp id="S6.Ex23.m1.3.3.cmml" xref="S6.Ex23.m1.3.3"></exp><apply id="S6.Ex23.m1.5.5.1.1.2.1.1.1.cmml" xref="S6.Ex23.m1.5.5.1.1.2.1.1.1"><minus id="S6.Ex23.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S6.Ex23.m1.5.5.1.1.2.1.1.1"></minus><apply id="S6.Ex23.m1.1.1.cmml" xref="S6.Ex23.m1.1.1"><divide id="S6.Ex23.m1.1.1.2.cmml" xref="S6.Ex23.m1.1.1"></divide><apply id="S6.Ex23.m1.1.1.1.cmml" xref="S6.Ex23.m1.1.1.1"><csymbol cd="ambiguous" id="S6.Ex23.m1.1.1.1.2.cmml" xref="S6.Ex23.m1.1.1.1">superscript</csymbol><apply id="S6.Ex23.m1.1.1.1.1.1.1.cmml" xref="S6.Ex23.m1.1.1.1.1.1"><minus id="S6.Ex23.m1.1.1.1.1.1.1.1.cmml" xref="S6.Ex23.m1.1.1.1.1.1.1.1"></minus><ci id="S6.Ex23.m1.1.1.1.1.1.1.2.cmml" xref="S6.Ex23.m1.1.1.1.1.1.1.2">𝑡</ci><cn id="S6.Ex23.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.Ex23.m1.1.1.1.1.1.1.3">250</cn></apply><cn id="S6.Ex23.m1.1.1.1.3.cmml" type="integer" xref="S6.Ex23.m1.1.1.1.3">2</cn></apply><apply id="S6.Ex23.m1.1.1.3.cmml" xref="S6.Ex23.m1.1.1.3"><ci id="S6.Ex23.m1.1.1.3.1.cmml" xref="S6.Ex23.m1.1.1.3.1">⋅</ci><cn id="S6.Ex23.m1.1.1.3.2.cmml" type="integer" xref="S6.Ex23.m1.1.1.3.2">2</cn><apply id="S6.Ex23.m1.1.1.3.3.cmml" xref="S6.Ex23.m1.1.1.3.3"><csymbol cd="ambiguous" id="S6.Ex23.m1.1.1.3.3.1.cmml" xref="S6.Ex23.m1.1.1.3.3">superscript</csymbol><cn id="S6.Ex23.m1.1.1.3.3.2.cmml" type="integer" xref="S6.Ex23.m1.1.1.3.3.2">50</cn><cn id="S6.Ex23.m1.1.1.3.3.3.cmml" type="integer" xref="S6.Ex23.m1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex23.m1.5c">\displaystyle\text{Gaussian Bump:}\quad s(t)=\exp\left(-\frac{(t-250)^{2}}{2%
\cdot 50^{2}}\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex23.m1.5d">Gaussian Bump: italic_s ( italic_t ) = roman_exp ( - divide start_ARG ( italic_t - 250 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 ⋅ 50 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Long Period Sine:}\quad s(t)=\sin\left(\frac{2\pi t}{100}%
\right)," class="ltx_Math" display="inline" id="S6.Ex24.m1.5"><semantics id="S6.Ex24.m1.5a"><mrow id="S6.Ex24.m1.5.5.1" xref="S6.Ex24.m1.5.5.1.1.cmml"><mrow id="S6.Ex24.m1.5.5.1.1" xref="S6.Ex24.m1.5.5.1.1.cmml"><mrow id="S6.Ex24.m1.5.5.1.1.1.1" xref="S6.Ex24.m1.5.5.1.1.1.2.cmml"><mtext id="S6.Ex24.m1.4.4" xref="S6.Ex24.m1.4.4a.cmml">Long Period Sine:</mtext><mspace id="S6.Ex24.m1.5.5.1.1.1.1.2" width="1em" xref="S6.Ex24.m1.5.5.1.1.1.2.cmml"></mspace><mrow id="S6.Ex24.m1.5.5.1.1.1.1.1" xref="S6.Ex24.m1.5.5.1.1.1.1.1.cmml"><mi id="S6.Ex24.m1.5.5.1.1.1.1.1.2" xref="S6.Ex24.m1.5.5.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex24.m1.5.5.1.1.1.1.1.1" xref="S6.Ex24.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex24.m1.5.5.1.1.1.1.1.3.2" xref="S6.Ex24.m1.5.5.1.1.1.1.1.cmml"><mo id="S6.Ex24.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex24.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex24.m1.1.1" xref="S6.Ex24.m1.1.1.cmml">t</mi><mo id="S6.Ex24.m1.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex24.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex24.m1.5.5.1.1.2" xref="S6.Ex24.m1.5.5.1.1.2.cmml">=</mo><mrow id="S6.Ex24.m1.5.5.1.1.3.2" xref="S6.Ex24.m1.5.5.1.1.3.1.cmml"><mi id="S6.Ex24.m1.2.2" xref="S6.Ex24.m1.2.2.cmml">sin</mi><mo id="S6.Ex24.m1.5.5.1.1.3.2a" xref="S6.Ex24.m1.5.5.1.1.3.1.cmml">⁡</mo><mrow id="S6.Ex24.m1.5.5.1.1.3.2.1" xref="S6.Ex24.m1.5.5.1.1.3.1.cmml"><mo id="S6.Ex24.m1.5.5.1.1.3.2.1.1" xref="S6.Ex24.m1.5.5.1.1.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex24.m1.3.3" xref="S6.Ex24.m1.3.3.cmml"><mfrac id="S6.Ex24.m1.3.3a" xref="S6.Ex24.m1.3.3.cmml"><mrow id="S6.Ex24.m1.3.3.2" xref="S6.Ex24.m1.3.3.2.cmml"><mn id="S6.Ex24.m1.3.3.2.2" xref="S6.Ex24.m1.3.3.2.2.cmml">2</mn><mo id="S6.Ex24.m1.3.3.2.1" xref="S6.Ex24.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex24.m1.3.3.2.3" xref="S6.Ex24.m1.3.3.2.3.cmml">π</mi><mo id="S6.Ex24.m1.3.3.2.1a" xref="S6.Ex24.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex24.m1.3.3.2.4" xref="S6.Ex24.m1.3.3.2.4.cmml">t</mi></mrow><mn id="S6.Ex24.m1.3.3.3" xref="S6.Ex24.m1.3.3.3.cmml">100</mn></mfrac></mstyle><mo id="S6.Ex24.m1.5.5.1.1.3.2.1.2" xref="S6.Ex24.m1.5.5.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex24.m1.5.5.1.2" xref="S6.Ex24.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex24.m1.5b"><apply id="S6.Ex24.m1.5.5.1.1.cmml" xref="S6.Ex24.m1.5.5.1"><eq id="S6.Ex24.m1.5.5.1.1.2.cmml" xref="S6.Ex24.m1.5.5.1.1.2"></eq><list id="S6.Ex24.m1.5.5.1.1.1.2.cmml" xref="S6.Ex24.m1.5.5.1.1.1.1"><ci id="S6.Ex24.m1.4.4a.cmml" xref="S6.Ex24.m1.4.4"><mtext id="S6.Ex24.m1.4.4.cmml" xref="S6.Ex24.m1.4.4">Long Period Sine:</mtext></ci><apply id="S6.Ex24.m1.5.5.1.1.1.1.1.cmml" xref="S6.Ex24.m1.5.5.1.1.1.1.1"><times id="S6.Ex24.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex24.m1.5.5.1.1.1.1.1.1"></times><ci id="S6.Ex24.m1.5.5.1.1.1.1.1.2.cmml" xref="S6.Ex24.m1.5.5.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex24.m1.1.1.cmml" xref="S6.Ex24.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex24.m1.5.5.1.1.3.1.cmml" xref="S6.Ex24.m1.5.5.1.1.3.2"><sin id="S6.Ex24.m1.2.2.cmml" xref="S6.Ex24.m1.2.2"></sin><apply id="S6.Ex24.m1.3.3.cmml" xref="S6.Ex24.m1.3.3"><divide id="S6.Ex24.m1.3.3.1.cmml" xref="S6.Ex24.m1.3.3"></divide><apply id="S6.Ex24.m1.3.3.2.cmml" xref="S6.Ex24.m1.3.3.2"><times id="S6.Ex24.m1.3.3.2.1.cmml" xref="S6.Ex24.m1.3.3.2.1"></times><cn id="S6.Ex24.m1.3.3.2.2.cmml" type="integer" xref="S6.Ex24.m1.3.3.2.2">2</cn><ci id="S6.Ex24.m1.3.3.2.3.cmml" xref="S6.Ex24.m1.3.3.2.3">𝜋</ci><ci id="S6.Ex24.m1.3.3.2.4.cmml" xref="S6.Ex24.m1.3.3.2.4">𝑡</ci></apply><cn id="S6.Ex24.m1.3.3.3.cmml" type="integer" xref="S6.Ex24.m1.3.3.3">100</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex24.m1.5c">\displaystyle\text{Long Period Sine:}\quad s(t)=\sin\left(\frac{2\pi t}{100}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S6.Ex24.m1.5d">Long Period Sine: italic_s ( italic_t ) = roman_sin ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 100 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Cubic Polynomial:}\quad s(t)=0.00001(t-250)^{3}+0.05t," class="ltx_Math" display="inline" id="S6.Ex25.m1.3"><semantics id="S6.Ex25.m1.3a"><mrow id="S6.Ex25.m1.3.3.1" xref="S6.Ex25.m1.3.3.1.1.cmml"><mrow id="S6.Ex25.m1.3.3.1.1" xref="S6.Ex25.m1.3.3.1.1.cmml"><mrow id="S6.Ex25.m1.3.3.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.1.2.cmml"><mtext id="S6.Ex25.m1.2.2" xref="S6.Ex25.m1.2.2a.cmml">Cubic Polynomial:</mtext><mspace id="S6.Ex25.m1.3.3.1.1.1.1.2" width="1em" xref="S6.Ex25.m1.3.3.1.1.1.2.cmml"></mspace><mrow id="S6.Ex25.m1.3.3.1.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.1.1.1.cmml"><mi id="S6.Ex25.m1.3.3.1.1.1.1.1.2" xref="S6.Ex25.m1.3.3.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex25.m1.3.3.1.1.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex25.m1.3.3.1.1.1.1.1.3.2" xref="S6.Ex25.m1.3.3.1.1.1.1.1.cmml"><mo id="S6.Ex25.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex25.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex25.m1.1.1" xref="S6.Ex25.m1.1.1.cmml">t</mi><mo id="S6.Ex25.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex25.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex25.m1.3.3.1.1.3" xref="S6.Ex25.m1.3.3.1.1.3.cmml">=</mo><mrow id="S6.Ex25.m1.3.3.1.1.2" xref="S6.Ex25.m1.3.3.1.1.2.cmml"><mrow id="S6.Ex25.m1.3.3.1.1.2.1" xref="S6.Ex25.m1.3.3.1.1.2.1.cmml"><mn id="S6.Ex25.m1.3.3.1.1.2.1.3" xref="S6.Ex25.m1.3.3.1.1.2.1.3.cmml">0.00001</mn><mo id="S6.Ex25.m1.3.3.1.1.2.1.2" xref="S6.Ex25.m1.3.3.1.1.2.1.2.cmml">⁢</mo><msup id="S6.Ex25.m1.3.3.1.1.2.1.1" xref="S6.Ex25.m1.3.3.1.1.2.1.1.cmml"><mrow id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mo id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.2" stretchy="false" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">t</mi><mo id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">−</mo><mn id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">250</mn></mrow><mo id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.3" stretchy="false" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.Ex25.m1.3.3.1.1.2.1.1.3" xref="S6.Ex25.m1.3.3.1.1.2.1.1.3.cmml">3</mn></msup></mrow><mo id="S6.Ex25.m1.3.3.1.1.2.2" xref="S6.Ex25.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S6.Ex25.m1.3.3.1.1.2.3" xref="S6.Ex25.m1.3.3.1.1.2.3.cmml"><mn id="S6.Ex25.m1.3.3.1.1.2.3.2" xref="S6.Ex25.m1.3.3.1.1.2.3.2.cmml">0.05</mn><mo id="S6.Ex25.m1.3.3.1.1.2.3.1" xref="S6.Ex25.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S6.Ex25.m1.3.3.1.1.2.3.3" xref="S6.Ex25.m1.3.3.1.1.2.3.3.cmml">t</mi></mrow></mrow></mrow><mo id="S6.Ex25.m1.3.3.1.2" xref="S6.Ex25.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex25.m1.3b"><apply id="S6.Ex25.m1.3.3.1.1.cmml" xref="S6.Ex25.m1.3.3.1"><eq id="S6.Ex25.m1.3.3.1.1.3.cmml" xref="S6.Ex25.m1.3.3.1.1.3"></eq><list id="S6.Ex25.m1.3.3.1.1.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.1.1"><ci id="S6.Ex25.m1.2.2a.cmml" xref="S6.Ex25.m1.2.2"><mtext id="S6.Ex25.m1.2.2.cmml" xref="S6.Ex25.m1.2.2">Cubic Polynomial:</mtext></ci><apply id="S6.Ex25.m1.3.3.1.1.1.1.1.cmml" xref="S6.Ex25.m1.3.3.1.1.1.1.1"><times id="S6.Ex25.m1.3.3.1.1.1.1.1.1.cmml" xref="S6.Ex25.m1.3.3.1.1.1.1.1.1"></times><ci id="S6.Ex25.m1.3.3.1.1.1.1.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex25.m1.1.1.cmml" xref="S6.Ex25.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex25.m1.3.3.1.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.2"><plus id="S6.Ex25.m1.3.3.1.1.2.2.cmml" xref="S6.Ex25.m1.3.3.1.1.2.2"></plus><apply id="S6.Ex25.m1.3.3.1.1.2.1.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1"><times id="S6.Ex25.m1.3.3.1.1.2.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.2"></times><cn id="S6.Ex25.m1.3.3.1.1.2.1.3.cmml" type="float" xref="S6.Ex25.m1.3.3.1.1.2.1.3">0.00001</cn><apply id="S6.Ex25.m1.3.3.1.1.2.1.1.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="S6.Ex25.m1.3.3.1.1.2.1.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.1">superscript</csymbol><apply id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1"><minus id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.1"></minus><ci id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.2">𝑡</ci><cn id="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" type="integer" xref="S6.Ex25.m1.3.3.1.1.2.1.1.1.1.1.3">250</cn></apply><cn id="S6.Ex25.m1.3.3.1.1.2.1.1.3.cmml" type="integer" xref="S6.Ex25.m1.3.3.1.1.2.1.1.3">3</cn></apply></apply><apply id="S6.Ex25.m1.3.3.1.1.2.3.cmml" xref="S6.Ex25.m1.3.3.1.1.2.3"><times id="S6.Ex25.m1.3.3.1.1.2.3.1.cmml" xref="S6.Ex25.m1.3.3.1.1.2.3.1"></times><cn id="S6.Ex25.m1.3.3.1.1.2.3.2.cmml" type="float" xref="S6.Ex25.m1.3.3.1.1.2.3.2">0.05</cn><ci id="S6.Ex25.m1.3.3.1.1.2.3.3.cmml" xref="S6.Ex25.m1.3.3.1.1.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex25.m1.3c">\displaystyle\text{Cubic Polynomial:}\quad s(t)=0.00001(t-250)^{3}+0.05t,</annotation><annotation encoding="application/x-llamapun" id="S6.Ex25.m1.3d">Cubic Polynomial: italic_s ( italic_t ) = 0.00001 ( italic_t - 250 ) start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT + 0.05 italic_t ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Exponential Growth:}\quad s(t)=e^{0.005t}," class="ltx_Math" display="inline" id="S6.Ex26.m1.3"><semantics id="S6.Ex26.m1.3a"><mrow id="S6.Ex26.m1.3.3.1" xref="S6.Ex26.m1.3.3.1.1.cmml"><mrow id="S6.Ex26.m1.3.3.1.1" xref="S6.Ex26.m1.3.3.1.1.cmml"><mrow id="S6.Ex26.m1.3.3.1.1.1.1" xref="S6.Ex26.m1.3.3.1.1.1.2.cmml"><mtext id="S6.Ex26.m1.2.2" xref="S6.Ex26.m1.2.2a.cmml">Exponential Growth:</mtext><mspace id="S6.Ex26.m1.3.3.1.1.1.1.2" width="1em" xref="S6.Ex26.m1.3.3.1.1.1.2.cmml"></mspace><mrow id="S6.Ex26.m1.3.3.1.1.1.1.1" xref="S6.Ex26.m1.3.3.1.1.1.1.1.cmml"><mi id="S6.Ex26.m1.3.3.1.1.1.1.1.2" xref="S6.Ex26.m1.3.3.1.1.1.1.1.2.cmml">s</mi><mo id="S6.Ex26.m1.3.3.1.1.1.1.1.1" xref="S6.Ex26.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S6.Ex26.m1.3.3.1.1.1.1.1.3.2" xref="S6.Ex26.m1.3.3.1.1.1.1.1.cmml"><mo id="S6.Ex26.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S6.Ex26.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S6.Ex26.m1.1.1" xref="S6.Ex26.m1.1.1.cmml">t</mi><mo id="S6.Ex26.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S6.Ex26.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex26.m1.3.3.1.1.2" xref="S6.Ex26.m1.3.3.1.1.2.cmml">=</mo><msup id="S6.Ex26.m1.3.3.1.1.3" xref="S6.Ex26.m1.3.3.1.1.3.cmml"><mi id="S6.Ex26.m1.3.3.1.1.3.2" xref="S6.Ex26.m1.3.3.1.1.3.2.cmml">e</mi><mrow id="S6.Ex26.m1.3.3.1.1.3.3" xref="S6.Ex26.m1.3.3.1.1.3.3.cmml"><mn id="S6.Ex26.m1.3.3.1.1.3.3.2" xref="S6.Ex26.m1.3.3.1.1.3.3.2.cmml">0.005</mn><mo id="S6.Ex26.m1.3.3.1.1.3.3.1" xref="S6.Ex26.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S6.Ex26.m1.3.3.1.1.3.3.3" xref="S6.Ex26.m1.3.3.1.1.3.3.3.cmml">t</mi></mrow></msup></mrow><mo id="S6.Ex26.m1.3.3.1.2" xref="S6.Ex26.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex26.m1.3b"><apply id="S6.Ex26.m1.3.3.1.1.cmml" xref="S6.Ex26.m1.3.3.1"><eq id="S6.Ex26.m1.3.3.1.1.2.cmml" xref="S6.Ex26.m1.3.3.1.1.2"></eq><list id="S6.Ex26.m1.3.3.1.1.1.2.cmml" xref="S6.Ex26.m1.3.3.1.1.1.1"><ci id="S6.Ex26.m1.2.2a.cmml" xref="S6.Ex26.m1.2.2"><mtext id="S6.Ex26.m1.2.2.cmml" xref="S6.Ex26.m1.2.2">Exponential Growth:</mtext></ci><apply id="S6.Ex26.m1.3.3.1.1.1.1.1.cmml" xref="S6.Ex26.m1.3.3.1.1.1.1.1"><times id="S6.Ex26.m1.3.3.1.1.1.1.1.1.cmml" xref="S6.Ex26.m1.3.3.1.1.1.1.1.1"></times><ci id="S6.Ex26.m1.3.3.1.1.1.1.1.2.cmml" xref="S6.Ex26.m1.3.3.1.1.1.1.1.2">𝑠</ci><ci id="S6.Ex26.m1.1.1.cmml" xref="S6.Ex26.m1.1.1">𝑡</ci></apply></list><apply id="S6.Ex26.m1.3.3.1.1.3.cmml" xref="S6.Ex26.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S6.Ex26.m1.3.3.1.1.3.1.cmml" xref="S6.Ex26.m1.3.3.1.1.3">superscript</csymbol><ci id="S6.Ex26.m1.3.3.1.1.3.2.cmml" xref="S6.Ex26.m1.3.3.1.1.3.2">𝑒</ci><apply id="S6.Ex26.m1.3.3.1.1.3.3.cmml" xref="S6.Ex26.m1.3.3.1.1.3.3"><times id="S6.Ex26.m1.3.3.1.1.3.3.1.cmml" xref="S6.Ex26.m1.3.3.1.1.3.3.1"></times><cn id="S6.Ex26.m1.3.3.1.1.3.3.2.cmml" type="float" xref="S6.Ex26.m1.3.3.1.1.3.3.2">0.005</cn><ci id="S6.Ex26.m1.3.3.1.1.3.3.3.cmml" xref="S6.Ex26.m1.3.3.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex26.m1.3c">\displaystyle\text{Exponential Growth:}\quad s(t)=e^{0.005t},</annotation><annotation encoding="application/x-llamapun" id="S6.Ex26.m1.3d">Exponential Growth: italic_s ( italic_t ) = italic_e start_POSTSUPERSCRIPT 0.005 italic_t end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S6.Ex27.3.2.1.1">Cosine Envelope × Sine:</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S6.Ex28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad\quad s(t)=\left(1+0.5\cos\left(\frac{2\pi t}{100}\right)%
\right)\cdot\sin\left(\frac{2\pi t}{30}\right)." class="ltx_Math" display="inline" id="S6.Ex28.m1.6"><semantics id="S6.Ex28.m1.6a"><mrow id="S6.Ex28.m1.6.6.1" xref="S6.Ex28.m1.6.6.1.1.cmml"><mrow id="S6.Ex28.m1.6.6.1.1" xref="S6.Ex28.m1.6.6.1.1.cmml"><mrow id="S6.Ex28.m1.6.6.1.1.3" xref="S6.Ex28.m1.6.6.1.1.3.cmml"><mi id="S6.Ex28.m1.6.6.1.1.3.2" xref="S6.Ex28.m1.6.6.1.1.3.2.cmml">s</mi><mo id="S6.Ex28.m1.6.6.1.1.3.1" xref="S6.Ex28.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex28.m1.6.6.1.1.3.3.2" xref="S6.Ex28.m1.6.6.1.1.3.cmml"><mo id="S6.Ex28.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S6.Ex28.m1.6.6.1.1.3.cmml">(</mo><mi id="S6.Ex28.m1.1.1" xref="S6.Ex28.m1.1.1.cmml">t</mi><mo id="S6.Ex28.m1.6.6.1.1.3.3.2.2" stretchy="false" xref="S6.Ex28.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex28.m1.6.6.1.1.2" xref="S6.Ex28.m1.6.6.1.1.2.cmml">=</mo><mrow id="S6.Ex28.m1.6.6.1.1.1" xref="S6.Ex28.m1.6.6.1.1.1.cmml"><mrow id="S6.Ex28.m1.6.6.1.1.1.1.1" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.2" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.1.1.1" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.cmml"><mn id="S6.Ex28.m1.6.6.1.1.1.1.1.1.2" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.2.cmml">1</mn><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.1.1" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.cmml"><mn id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.2" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.2.cmml">0.5</mn><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.1" lspace="0.167em" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml"><mi id="S6.Ex28.m1.2.2" xref="S6.Ex28.m1.2.2.cmml">cos</mi><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2a" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2.1" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml"><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2.1.1" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex28.m1.3.3" xref="S6.Ex28.m1.3.3.cmml"><mfrac id="S6.Ex28.m1.3.3a" xref="S6.Ex28.m1.3.3.cmml"><mrow id="S6.Ex28.m1.3.3.2" xref="S6.Ex28.m1.3.3.2.cmml"><mn id="S6.Ex28.m1.3.3.2.2" xref="S6.Ex28.m1.3.3.2.2.cmml">2</mn><mo id="S6.Ex28.m1.3.3.2.1" xref="S6.Ex28.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex28.m1.3.3.2.3" xref="S6.Ex28.m1.3.3.2.3.cmml">π</mi><mo id="S6.Ex28.m1.3.3.2.1a" xref="S6.Ex28.m1.3.3.2.1.cmml">⁢</mo><mi id="S6.Ex28.m1.3.3.2.4" xref="S6.Ex28.m1.3.3.2.4.cmml">t</mi></mrow><mn id="S6.Ex28.m1.3.3.3" xref="S6.Ex28.m1.3.3.3.cmml">100</mn></mfrac></mstyle><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2.1.2" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex28.m1.6.6.1.1.1.1.1.3" rspace="0.055em" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S6.Ex28.m1.6.6.1.1.1.2" rspace="0.222em" xref="S6.Ex28.m1.6.6.1.1.1.2.cmml">⋅</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.3.2" xref="S6.Ex28.m1.6.6.1.1.1.3.1.cmml"><mi id="S6.Ex28.m1.4.4" xref="S6.Ex28.m1.4.4.cmml">sin</mi><mo id="S6.Ex28.m1.6.6.1.1.1.3.2a" xref="S6.Ex28.m1.6.6.1.1.1.3.1.cmml">⁡</mo><mrow id="S6.Ex28.m1.6.6.1.1.1.3.2.1" xref="S6.Ex28.m1.6.6.1.1.1.3.1.cmml"><mo id="S6.Ex28.m1.6.6.1.1.1.3.2.1.1" xref="S6.Ex28.m1.6.6.1.1.1.3.1.cmml">(</mo><mstyle displaystyle="true" id="S6.Ex28.m1.5.5" xref="S6.Ex28.m1.5.5.cmml"><mfrac id="S6.Ex28.m1.5.5a" xref="S6.Ex28.m1.5.5.cmml"><mrow id="S6.Ex28.m1.5.5.2" xref="S6.Ex28.m1.5.5.2.cmml"><mn id="S6.Ex28.m1.5.5.2.2" xref="S6.Ex28.m1.5.5.2.2.cmml">2</mn><mo id="S6.Ex28.m1.5.5.2.1" xref="S6.Ex28.m1.5.5.2.1.cmml">⁢</mo><mi id="S6.Ex28.m1.5.5.2.3" xref="S6.Ex28.m1.5.5.2.3.cmml">π</mi><mo id="S6.Ex28.m1.5.5.2.1a" xref="S6.Ex28.m1.5.5.2.1.cmml">⁢</mo><mi id="S6.Ex28.m1.5.5.2.4" xref="S6.Ex28.m1.5.5.2.4.cmml">t</mi></mrow><mn id="S6.Ex28.m1.5.5.3" xref="S6.Ex28.m1.5.5.3.cmml">30</mn></mfrac></mstyle><mo id="S6.Ex28.m1.6.6.1.1.1.3.2.1.2" xref="S6.Ex28.m1.6.6.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex28.m1.6.6.1.2" lspace="0em" xref="S6.Ex28.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex28.m1.6b"><apply id="S6.Ex28.m1.6.6.1.1.cmml" xref="S6.Ex28.m1.6.6.1"><eq id="S6.Ex28.m1.6.6.1.1.2.cmml" xref="S6.Ex28.m1.6.6.1.1.2"></eq><apply id="S6.Ex28.m1.6.6.1.1.3.cmml" xref="S6.Ex28.m1.6.6.1.1.3"><times id="S6.Ex28.m1.6.6.1.1.3.1.cmml" xref="S6.Ex28.m1.6.6.1.1.3.1"></times><ci id="S6.Ex28.m1.6.6.1.1.3.2.cmml" xref="S6.Ex28.m1.6.6.1.1.3.2">𝑠</ci><ci id="S6.Ex28.m1.1.1.cmml" xref="S6.Ex28.m1.1.1">𝑡</ci></apply><apply id="S6.Ex28.m1.6.6.1.1.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1"><ci id="S6.Ex28.m1.6.6.1.1.1.2.cmml" xref="S6.Ex28.m1.6.6.1.1.1.2">⋅</ci><apply id="S6.Ex28.m1.6.6.1.1.1.1.1.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1.1.1"><plus id="S6.Ex28.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.1"></plus><cn id="S6.Ex28.m1.6.6.1.1.1.1.1.1.2.cmml" type="integer" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.2">1</cn><apply id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3"><times id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.1"></times><cn id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.2.cmml" type="float" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.2">0.5</cn><apply id="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1.1.1.1.3.3.2"><cos id="S6.Ex28.m1.2.2.cmml" xref="S6.Ex28.m1.2.2"></cos><apply id="S6.Ex28.m1.3.3.cmml" xref="S6.Ex28.m1.3.3"><divide id="S6.Ex28.m1.3.3.1.cmml" xref="S6.Ex28.m1.3.3"></divide><apply id="S6.Ex28.m1.3.3.2.cmml" xref="S6.Ex28.m1.3.3.2"><times id="S6.Ex28.m1.3.3.2.1.cmml" xref="S6.Ex28.m1.3.3.2.1"></times><cn id="S6.Ex28.m1.3.3.2.2.cmml" type="integer" xref="S6.Ex28.m1.3.3.2.2">2</cn><ci id="S6.Ex28.m1.3.3.2.3.cmml" xref="S6.Ex28.m1.3.3.2.3">𝜋</ci><ci id="S6.Ex28.m1.3.3.2.4.cmml" xref="S6.Ex28.m1.3.3.2.4">𝑡</ci></apply><cn id="S6.Ex28.m1.3.3.3.cmml" type="integer" xref="S6.Ex28.m1.3.3.3">100</cn></apply></apply></apply></apply><apply id="S6.Ex28.m1.6.6.1.1.1.3.1.cmml" xref="S6.Ex28.m1.6.6.1.1.1.3.2"><sin id="S6.Ex28.m1.4.4.cmml" xref="S6.Ex28.m1.4.4"></sin><apply id="S6.Ex28.m1.5.5.cmml" xref="S6.Ex28.m1.5.5"><divide id="S6.Ex28.m1.5.5.1.cmml" xref="S6.Ex28.m1.5.5"></divide><apply id="S6.Ex28.m1.5.5.2.cmml" xref="S6.Ex28.m1.5.5.2"><times id="S6.Ex28.m1.5.5.2.1.cmml" xref="S6.Ex28.m1.5.5.2.1"></times><cn id="S6.Ex28.m1.5.5.2.2.cmml" type="integer" xref="S6.Ex28.m1.5.5.2.2">2</cn><ci id="S6.Ex28.m1.5.5.2.3.cmml" xref="S6.Ex28.m1.5.5.2.3">𝜋</ci><ci id="S6.Ex28.m1.5.5.2.4.cmml" xref="S6.Ex28.m1.5.5.2.4">𝑡</ci></apply><cn id="S6.Ex28.m1.5.5.3.cmml" type="integer" xref="S6.Ex28.m1.5.5.3">30</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex28.m1.6c">\displaystyle\quad\quad s(t)=\left(1+0.5\cos\left(\frac{2\pi t}{100}\right)%
\right)\cdot\sin\left(\frac{2\pi t}{30}\right).</annotation><annotation encoding="application/x-llamapun" id="S6.Ex28.m1.6d">italic_s ( italic_t ) = ( 1 + 0.5 roman_cos ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 100 end_ARG ) ) ⋅ roman_sin ( divide start_ARG 2 italic_π italic_t end_ARG start_ARG 30 end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">These synthetic signals are intentionally crafted to isolate different forecasting challenges:</p>
</div>
<div class="ltx_para" id="S6.p4">
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i1.p1.1.1">Sine, Long Period Sine:</span> Clean periodic structures that assess the model’s ability to recognize short versus long cycles.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i2.p1.1.1">Cosine + Trend, Exponential Growth:</span> Trends and compound effects that test extrapolation capabilities.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i3.p1.1.1">Exponential Decay × Sine:</span> Decreasing amplitude signals that challenge long-term memory and decay modeling.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i4.p1">
<p class="ltx_p" id="S6.I1.i4.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i4.p1.1.1">2nd Order and Cubic Polynomial:</span> Smooth non-periodic curvature for evaluating structural generalization and overfitting.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i5.p1">
<p class="ltx_p" id="S6.I1.i5.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i5.p1.1.1">Log × Sine:</span> Combines slow growth and fast oscillations, requiring flexible temporal representation.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i6.p1">
<p class="ltx_p" id="S6.I1.i6.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i6.p1.1.1">Gaussian Bump:</span> Localized pulse to test event detection within longer sequences.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i7.p1">
<p class="ltx_p" id="S6.I1.i7.p1.1"><span class="ltx_text ltx_font_typewriter" id="S6.I1.i7.p1.1.1">Cosine Envelope × Sine:</span> Modulated oscillation to assess adaptability to evolving amplitude and frequency.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Noise Injection Strategy</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">To mimic realistic imperfections in real-world data, we inject noise into the clean signals through a multi-component process:</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">(i) Additive Gaussian Noise: Models measurement uncertainty with:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.Ex29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{noisy}}(t)=s(t)+\mathcal{N}(0,0.10)." class="ltx_Math" display="block" id="S6.Ex29.m1.5"><semantics id="S6.Ex29.m1.5a"><mrow id="S6.Ex29.m1.5.5.1" xref="S6.Ex29.m1.5.5.1.1.cmml"><mrow id="S6.Ex29.m1.5.5.1.1" xref="S6.Ex29.m1.5.5.1.1.cmml"><mrow id="S6.Ex29.m1.5.5.1.1.2" xref="S6.Ex29.m1.5.5.1.1.2.cmml"><msub id="S6.Ex29.m1.5.5.1.1.2.2" xref="S6.Ex29.m1.5.5.1.1.2.2.cmml"><mi id="S6.Ex29.m1.5.5.1.1.2.2.2" xref="S6.Ex29.m1.5.5.1.1.2.2.2.cmml">s</mi><mtext id="S6.Ex29.m1.5.5.1.1.2.2.3" xref="S6.Ex29.m1.5.5.1.1.2.2.3a.cmml">noisy</mtext></msub><mo id="S6.Ex29.m1.5.5.1.1.2.1" xref="S6.Ex29.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S6.Ex29.m1.5.5.1.1.2.3.2" xref="S6.Ex29.m1.5.5.1.1.2.cmml"><mo id="S6.Ex29.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.2.cmml">(</mo><mi id="S6.Ex29.m1.1.1" xref="S6.Ex29.m1.1.1.cmml">t</mi><mo id="S6.Ex29.m1.5.5.1.1.2.3.2.2" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S6.Ex29.m1.5.5.1.1.1" xref="S6.Ex29.m1.5.5.1.1.1.cmml">=</mo><mrow id="S6.Ex29.m1.5.5.1.1.3" xref="S6.Ex29.m1.5.5.1.1.3.cmml"><mrow id="S6.Ex29.m1.5.5.1.1.3.2" xref="S6.Ex29.m1.5.5.1.1.3.2.cmml"><mi id="S6.Ex29.m1.5.5.1.1.3.2.2" xref="S6.Ex29.m1.5.5.1.1.3.2.2.cmml">s</mi><mo id="S6.Ex29.m1.5.5.1.1.3.2.1" xref="S6.Ex29.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S6.Ex29.m1.5.5.1.1.3.2.3.2" xref="S6.Ex29.m1.5.5.1.1.3.2.cmml"><mo id="S6.Ex29.m1.5.5.1.1.3.2.3.2.1" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S6.Ex29.m1.2.2" xref="S6.Ex29.m1.2.2.cmml">t</mi><mo id="S6.Ex29.m1.5.5.1.1.3.2.3.2.2" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S6.Ex29.m1.5.5.1.1.3.1" xref="S6.Ex29.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S6.Ex29.m1.5.5.1.1.3.3" xref="S6.Ex29.m1.5.5.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex29.m1.5.5.1.1.3.3.2" xref="S6.Ex29.m1.5.5.1.1.3.3.2.cmml">𝒩</mi><mo id="S6.Ex29.m1.5.5.1.1.3.3.1" xref="S6.Ex29.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mrow id="S6.Ex29.m1.5.5.1.1.3.3.3.2" xref="S6.Ex29.m1.5.5.1.1.3.3.3.1.cmml"><mo id="S6.Ex29.m1.5.5.1.1.3.3.3.2.1" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.3.3.3.1.cmml">(</mo><mn id="S6.Ex29.m1.3.3" xref="S6.Ex29.m1.3.3.cmml">0</mn><mo id="S6.Ex29.m1.5.5.1.1.3.3.3.2.2" xref="S6.Ex29.m1.5.5.1.1.3.3.3.1.cmml">,</mo><mn id="S6.Ex29.m1.4.4" xref="S6.Ex29.m1.4.4.cmml">0.10</mn><mo id="S6.Ex29.m1.5.5.1.1.3.3.3.2.3" stretchy="false" xref="S6.Ex29.m1.5.5.1.1.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.Ex29.m1.5.5.1.2" lspace="0em" xref="S6.Ex29.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex29.m1.5b"><apply id="S6.Ex29.m1.5.5.1.1.cmml" xref="S6.Ex29.m1.5.5.1"><eq id="S6.Ex29.m1.5.5.1.1.1.cmml" xref="S6.Ex29.m1.5.5.1.1.1"></eq><apply id="S6.Ex29.m1.5.5.1.1.2.cmml" xref="S6.Ex29.m1.5.5.1.1.2"><times id="S6.Ex29.m1.5.5.1.1.2.1.cmml" xref="S6.Ex29.m1.5.5.1.1.2.1"></times><apply id="S6.Ex29.m1.5.5.1.1.2.2.cmml" xref="S6.Ex29.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S6.Ex29.m1.5.5.1.1.2.2.1.cmml" xref="S6.Ex29.m1.5.5.1.1.2.2">subscript</csymbol><ci id="S6.Ex29.m1.5.5.1.1.2.2.2.cmml" xref="S6.Ex29.m1.5.5.1.1.2.2.2">𝑠</ci><ci id="S6.Ex29.m1.5.5.1.1.2.2.3a.cmml" xref="S6.Ex29.m1.5.5.1.1.2.2.3"><mtext id="S6.Ex29.m1.5.5.1.1.2.2.3.cmml" mathsize="70%" xref="S6.Ex29.m1.5.5.1.1.2.2.3">noisy</mtext></ci></apply><ci id="S6.Ex29.m1.1.1.cmml" xref="S6.Ex29.m1.1.1">𝑡</ci></apply><apply id="S6.Ex29.m1.5.5.1.1.3.cmml" xref="S6.Ex29.m1.5.5.1.1.3"><plus id="S6.Ex29.m1.5.5.1.1.3.1.cmml" xref="S6.Ex29.m1.5.5.1.1.3.1"></plus><apply id="S6.Ex29.m1.5.5.1.1.3.2.cmml" xref="S6.Ex29.m1.5.5.1.1.3.2"><times id="S6.Ex29.m1.5.5.1.1.3.2.1.cmml" xref="S6.Ex29.m1.5.5.1.1.3.2.1"></times><ci id="S6.Ex29.m1.5.5.1.1.3.2.2.cmml" xref="S6.Ex29.m1.5.5.1.1.3.2.2">𝑠</ci><ci id="S6.Ex29.m1.2.2.cmml" xref="S6.Ex29.m1.2.2">𝑡</ci></apply><apply id="S6.Ex29.m1.5.5.1.1.3.3.cmml" xref="S6.Ex29.m1.5.5.1.1.3.3"><times id="S6.Ex29.m1.5.5.1.1.3.3.1.cmml" xref="S6.Ex29.m1.5.5.1.1.3.3.1"></times><ci id="S6.Ex29.m1.5.5.1.1.3.3.2.cmml" xref="S6.Ex29.m1.5.5.1.1.3.3.2">𝒩</ci><interval closure="open" id="S6.Ex29.m1.5.5.1.1.3.3.3.1.cmml" xref="S6.Ex29.m1.5.5.1.1.3.3.3.2"><cn id="S6.Ex29.m1.3.3.cmml" type="integer" xref="S6.Ex29.m1.3.3">0</cn><cn id="S6.Ex29.m1.4.4.cmml" type="float" xref="S6.Ex29.m1.4.4">0.10</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex29.m1.5c">s_{\text{noisy}}(t)=s(t)+\mathcal{N}(0,0.10).</annotation><annotation encoding="application/x-llamapun" id="S6.Ex29.m1.5d">italic_s start_POSTSUBSCRIPT noisy end_POSTSUBSCRIPT ( italic_t ) = italic_s ( italic_t ) + caligraphic_N ( 0 , 0.10 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">(ii) Multiplicative Amplitude Jitter: Simulates sensor variability or calibration drift:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.Ex30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{noisy}}(t)\leftarrow s_{\text{noisy}}(t)\cdot(1+\mathcal{N}(0,0.08))." class="ltx_Math" display="block" id="S6.Ex30.m1.5"><semantics id="S6.Ex30.m1.5a"><mrow id="S6.Ex30.m1.5.5.1" xref="S6.Ex30.m1.5.5.1.1.cmml"><mrow id="S6.Ex30.m1.5.5.1.1" xref="S6.Ex30.m1.5.5.1.1.cmml"><mrow id="S6.Ex30.m1.5.5.1.1.3" xref="S6.Ex30.m1.5.5.1.1.3.cmml"><msub id="S6.Ex30.m1.5.5.1.1.3.2" xref="S6.Ex30.m1.5.5.1.1.3.2.cmml"><mi id="S6.Ex30.m1.5.5.1.1.3.2.2" xref="S6.Ex30.m1.5.5.1.1.3.2.2.cmml">s</mi><mtext id="S6.Ex30.m1.5.5.1.1.3.2.3" xref="S6.Ex30.m1.5.5.1.1.3.2.3a.cmml">noisy</mtext></msub><mo id="S6.Ex30.m1.5.5.1.1.3.1" xref="S6.Ex30.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex30.m1.5.5.1.1.3.3.2" xref="S6.Ex30.m1.5.5.1.1.3.cmml"><mo id="S6.Ex30.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.3.cmml">(</mo><mi id="S6.Ex30.m1.1.1" xref="S6.Ex30.m1.1.1.cmml">t</mi><mo id="S6.Ex30.m1.5.5.1.1.3.3.2.2" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex30.m1.5.5.1.1.2" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.2.cmml">←</mo><mrow id="S6.Ex30.m1.5.5.1.1.1" xref="S6.Ex30.m1.5.5.1.1.1.cmml"><mrow id="S6.Ex30.m1.5.5.1.1.1.3" xref="S6.Ex30.m1.5.5.1.1.1.3.cmml"><msub id="S6.Ex30.m1.5.5.1.1.1.3.2" xref="S6.Ex30.m1.5.5.1.1.1.3.2.cmml"><mi id="S6.Ex30.m1.5.5.1.1.1.3.2.2" xref="S6.Ex30.m1.5.5.1.1.1.3.2.2.cmml">s</mi><mtext id="S6.Ex30.m1.5.5.1.1.1.3.2.3" xref="S6.Ex30.m1.5.5.1.1.1.3.2.3a.cmml">noisy</mtext></msub><mo id="S6.Ex30.m1.5.5.1.1.1.3.1" xref="S6.Ex30.m1.5.5.1.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex30.m1.5.5.1.1.1.3.3.2" xref="S6.Ex30.m1.5.5.1.1.1.3.cmml"><mo id="S6.Ex30.m1.5.5.1.1.1.3.3.2.1" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.3.cmml">(</mo><mi id="S6.Ex30.m1.2.2" xref="S6.Ex30.m1.2.2.cmml">t</mi><mo id="S6.Ex30.m1.5.5.1.1.1.3.3.2.2" rspace="0.055em" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex30.m1.5.5.1.1.1.2" rspace="0.222em" xref="S6.Ex30.m1.5.5.1.1.1.2.cmml">⋅</mo><mrow id="S6.Ex30.m1.5.5.1.1.1.1.1" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex30.m1.5.5.1.1.1.1.1.1" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.cmml"><mn id="S6.Ex30.m1.5.5.1.1.1.1.1.1.2" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.2.cmml">1</mn><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.1.1" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.2" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.2.cmml">𝒩</mi><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.1" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.1.cmml"><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">(</mo><mn id="S6.Ex30.m1.3.3" xref="S6.Ex30.m1.3.3.cmml">0</mn><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.2.2" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">,</mo><mn id="S6.Ex30.m1.4.4" xref="S6.Ex30.m1.4.4.cmml">0.08</mn><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex30.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex30.m1.5.5.1.2" lspace="0em" xref="S6.Ex30.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex30.m1.5b"><apply id="S6.Ex30.m1.5.5.1.1.cmml" xref="S6.Ex30.m1.5.5.1"><ci id="S6.Ex30.m1.5.5.1.1.2.cmml" xref="S6.Ex30.m1.5.5.1.1.2">←</ci><apply id="S6.Ex30.m1.5.5.1.1.3.cmml" xref="S6.Ex30.m1.5.5.1.1.3"><times id="S6.Ex30.m1.5.5.1.1.3.1.cmml" xref="S6.Ex30.m1.5.5.1.1.3.1"></times><apply id="S6.Ex30.m1.5.5.1.1.3.2.cmml" xref="S6.Ex30.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex30.m1.5.5.1.1.3.2.1.cmml" xref="S6.Ex30.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S6.Ex30.m1.5.5.1.1.3.2.2.cmml" xref="S6.Ex30.m1.5.5.1.1.3.2.2">𝑠</ci><ci id="S6.Ex30.m1.5.5.1.1.3.2.3a.cmml" xref="S6.Ex30.m1.5.5.1.1.3.2.3"><mtext id="S6.Ex30.m1.5.5.1.1.3.2.3.cmml" mathsize="70%" xref="S6.Ex30.m1.5.5.1.1.3.2.3">noisy</mtext></ci></apply><ci id="S6.Ex30.m1.1.1.cmml" xref="S6.Ex30.m1.1.1">𝑡</ci></apply><apply id="S6.Ex30.m1.5.5.1.1.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1"><ci id="S6.Ex30.m1.5.5.1.1.1.2.cmml" xref="S6.Ex30.m1.5.5.1.1.1.2">⋅</ci><apply id="S6.Ex30.m1.5.5.1.1.1.3.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3"><times id="S6.Ex30.m1.5.5.1.1.1.3.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3.1"></times><apply id="S6.Ex30.m1.5.5.1.1.1.3.2.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex30.m1.5.5.1.1.1.3.2.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S6.Ex30.m1.5.5.1.1.1.3.2.2.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3.2.2">𝑠</ci><ci id="S6.Ex30.m1.5.5.1.1.1.3.2.3a.cmml" xref="S6.Ex30.m1.5.5.1.1.1.3.2.3"><mtext id="S6.Ex30.m1.5.5.1.1.1.3.2.3.cmml" mathsize="70%" xref="S6.Ex30.m1.5.5.1.1.1.3.2.3">noisy</mtext></ci></apply><ci id="S6.Ex30.m1.2.2.cmml" xref="S6.Ex30.m1.2.2">𝑡</ci></apply><apply id="S6.Ex30.m1.5.5.1.1.1.1.1.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1"><plus id="S6.Ex30.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.1"></plus><cn id="S6.Ex30.m1.5.5.1.1.1.1.1.1.2.cmml" type="integer" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.2">1</cn><apply id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3"><times id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.1"></times><ci id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.2">𝒩</ci><interval closure="open" id="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S6.Ex30.m1.5.5.1.1.1.1.1.1.3.3.2"><cn id="S6.Ex30.m1.3.3.cmml" type="integer" xref="S6.Ex30.m1.3.3">0</cn><cn id="S6.Ex30.m1.4.4.cmml" type="float" xref="S6.Ex30.m1.4.4">0.08</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex30.m1.5c">s_{\text{noisy}}(t)\leftarrow s_{\text{noisy}}(t)\cdot(1+\mathcal{N}(0,0.08)).</annotation><annotation encoding="application/x-llamapun" id="S6.Ex30.m1.5d">italic_s start_POSTSUBSCRIPT noisy end_POSTSUBSCRIPT ( italic_t ) ← italic_s start_POSTSUBSCRIPT noisy end_POSTSUBSCRIPT ( italic_t ) ⋅ ( 1 + caligraphic_N ( 0 , 0.08 ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.1">(iii) Random Temporal Shift: With 10% probability, a small shift <math alttext="\Delta t\in[-10,10]" class="ltx_Math" display="inline" id="S6.SS1.p4.1.m1.2"><semantics id="S6.SS1.p4.1.m1.2a"><mrow id="S6.SS1.p4.1.m1.2.2" xref="S6.SS1.p4.1.m1.2.2.cmml"><mrow id="S6.SS1.p4.1.m1.2.2.3" xref="S6.SS1.p4.1.m1.2.2.3.cmml"><mi id="S6.SS1.p4.1.m1.2.2.3.2" mathvariant="normal" xref="S6.SS1.p4.1.m1.2.2.3.2.cmml">Δ</mi><mo id="S6.SS1.p4.1.m1.2.2.3.1" xref="S6.SS1.p4.1.m1.2.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p4.1.m1.2.2.3.3" xref="S6.SS1.p4.1.m1.2.2.3.3.cmml">t</mi></mrow><mo id="S6.SS1.p4.1.m1.2.2.2" xref="S6.SS1.p4.1.m1.2.2.2.cmml">∈</mo><mrow id="S6.SS1.p4.1.m1.2.2.1.1" xref="S6.SS1.p4.1.m1.2.2.1.2.cmml"><mo id="S6.SS1.p4.1.m1.2.2.1.1.2" stretchy="false" xref="S6.SS1.p4.1.m1.2.2.1.2.cmml">[</mo><mrow id="S6.SS1.p4.1.m1.2.2.1.1.1" xref="S6.SS1.p4.1.m1.2.2.1.1.1.cmml"><mo id="S6.SS1.p4.1.m1.2.2.1.1.1a" xref="S6.SS1.p4.1.m1.2.2.1.1.1.cmml">−</mo><mn id="S6.SS1.p4.1.m1.2.2.1.1.1.2" xref="S6.SS1.p4.1.m1.2.2.1.1.1.2.cmml">10</mn></mrow><mo id="S6.SS1.p4.1.m1.2.2.1.1.3" xref="S6.SS1.p4.1.m1.2.2.1.2.cmml">,</mo><mn id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml">10</mn><mo id="S6.SS1.p4.1.m1.2.2.1.1.4" stretchy="false" xref="S6.SS1.p4.1.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.2b"><apply id="S6.SS1.p4.1.m1.2.2.cmml" xref="S6.SS1.p4.1.m1.2.2"><in id="S6.SS1.p4.1.m1.2.2.2.cmml" xref="S6.SS1.p4.1.m1.2.2.2"></in><apply id="S6.SS1.p4.1.m1.2.2.3.cmml" xref="S6.SS1.p4.1.m1.2.2.3"><times id="S6.SS1.p4.1.m1.2.2.3.1.cmml" xref="S6.SS1.p4.1.m1.2.2.3.1"></times><ci id="S6.SS1.p4.1.m1.2.2.3.2.cmml" xref="S6.SS1.p4.1.m1.2.2.3.2">Δ</ci><ci id="S6.SS1.p4.1.m1.2.2.3.3.cmml" xref="S6.SS1.p4.1.m1.2.2.3.3">𝑡</ci></apply><interval closure="closed" id="S6.SS1.p4.1.m1.2.2.1.2.cmml" xref="S6.SS1.p4.1.m1.2.2.1.1"><apply id="S6.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S6.SS1.p4.1.m1.2.2.1.1.1"><minus id="S6.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S6.SS1.p4.1.m1.2.2.1.1.1"></minus><cn id="S6.SS1.p4.1.m1.2.2.1.1.1.2.cmml" type="integer" xref="S6.SS1.p4.1.m1.2.2.1.1.1.2">10</cn></apply><cn id="S6.SS1.p4.1.m1.1.1.cmml" type="integer" xref="S6.SS1.p4.1.m1.1.1">10</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.2c">\Delta t\in[-10,10]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p4.1.m1.2d">roman_Δ italic_t ∈ [ - 10 , 10 ]</annotation></semantics></math> is applied to model event misalignment:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.Ex31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{noisy}}(t)\leftarrow s_{\text{noisy}}(t+\Delta t)." class="ltx_Math" display="block" id="S6.Ex31.m1.2"><semantics id="S6.Ex31.m1.2a"><mrow id="S6.Ex31.m1.2.2.1" xref="S6.Ex31.m1.2.2.1.1.cmml"><mrow id="S6.Ex31.m1.2.2.1.1" xref="S6.Ex31.m1.2.2.1.1.cmml"><mrow id="S6.Ex31.m1.2.2.1.1.3" xref="S6.Ex31.m1.2.2.1.1.3.cmml"><msub id="S6.Ex31.m1.2.2.1.1.3.2" xref="S6.Ex31.m1.2.2.1.1.3.2.cmml"><mi id="S6.Ex31.m1.2.2.1.1.3.2.2" xref="S6.Ex31.m1.2.2.1.1.3.2.2.cmml">s</mi><mtext id="S6.Ex31.m1.2.2.1.1.3.2.3" xref="S6.Ex31.m1.2.2.1.1.3.2.3a.cmml">noisy</mtext></msub><mo id="S6.Ex31.m1.2.2.1.1.3.1" xref="S6.Ex31.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S6.Ex31.m1.2.2.1.1.3.3.2" xref="S6.Ex31.m1.2.2.1.1.3.cmml"><mo id="S6.Ex31.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S6.Ex31.m1.2.2.1.1.3.cmml">(</mo><mi id="S6.Ex31.m1.1.1" xref="S6.Ex31.m1.1.1.cmml">t</mi><mo id="S6.Ex31.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S6.Ex31.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S6.Ex31.m1.2.2.1.1.2" stretchy="false" xref="S6.Ex31.m1.2.2.1.1.2.cmml">←</mo><mrow id="S6.Ex31.m1.2.2.1.1.1" xref="S6.Ex31.m1.2.2.1.1.1.cmml"><msub id="S6.Ex31.m1.2.2.1.1.1.3" xref="S6.Ex31.m1.2.2.1.1.1.3.cmml"><mi id="S6.Ex31.m1.2.2.1.1.1.3.2" xref="S6.Ex31.m1.2.2.1.1.1.3.2.cmml">s</mi><mtext id="S6.Ex31.m1.2.2.1.1.1.3.3" xref="S6.Ex31.m1.2.2.1.1.1.3.3a.cmml">noisy</mtext></msub><mo id="S6.Ex31.m1.2.2.1.1.1.2" xref="S6.Ex31.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S6.Ex31.m1.2.2.1.1.1.1.1" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S6.Ex31.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.Ex31.m1.2.2.1.1.1.1.1.1" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S6.Ex31.m1.2.2.1.1.1.1.1.1.2" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.2.cmml">t</mi><mo id="S6.Ex31.m1.2.2.1.1.1.1.1.1.1" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.1" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.3" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></mrow><mo id="S6.Ex31.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.Ex31.m1.2.2.1.2" lspace="0em" xref="S6.Ex31.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex31.m1.2b"><apply id="S6.Ex31.m1.2.2.1.1.cmml" xref="S6.Ex31.m1.2.2.1"><ci id="S6.Ex31.m1.2.2.1.1.2.cmml" xref="S6.Ex31.m1.2.2.1.1.2">←</ci><apply id="S6.Ex31.m1.2.2.1.1.3.cmml" xref="S6.Ex31.m1.2.2.1.1.3"><times id="S6.Ex31.m1.2.2.1.1.3.1.cmml" xref="S6.Ex31.m1.2.2.1.1.3.1"></times><apply id="S6.Ex31.m1.2.2.1.1.3.2.cmml" xref="S6.Ex31.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S6.Ex31.m1.2.2.1.1.3.2.1.cmml" xref="S6.Ex31.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S6.Ex31.m1.2.2.1.1.3.2.2.cmml" xref="S6.Ex31.m1.2.2.1.1.3.2.2">𝑠</ci><ci id="S6.Ex31.m1.2.2.1.1.3.2.3a.cmml" xref="S6.Ex31.m1.2.2.1.1.3.2.3"><mtext id="S6.Ex31.m1.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S6.Ex31.m1.2.2.1.1.3.2.3">noisy</mtext></ci></apply><ci id="S6.Ex31.m1.1.1.cmml" xref="S6.Ex31.m1.1.1">𝑡</ci></apply><apply id="S6.Ex31.m1.2.2.1.1.1.cmml" xref="S6.Ex31.m1.2.2.1.1.1"><times id="S6.Ex31.m1.2.2.1.1.1.2.cmml" xref="S6.Ex31.m1.2.2.1.1.1.2"></times><apply id="S6.Ex31.m1.2.2.1.1.1.3.cmml" xref="S6.Ex31.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S6.Ex31.m1.2.2.1.1.1.3.1.cmml" xref="S6.Ex31.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S6.Ex31.m1.2.2.1.1.1.3.2.cmml" xref="S6.Ex31.m1.2.2.1.1.1.3.2">𝑠</ci><ci id="S6.Ex31.m1.2.2.1.1.1.3.3a.cmml" xref="S6.Ex31.m1.2.2.1.1.1.3.3"><mtext id="S6.Ex31.m1.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S6.Ex31.m1.2.2.1.1.1.3.3">noisy</mtext></ci></apply><apply id="S6.Ex31.m1.2.2.1.1.1.1.1.1.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1"><plus id="S6.Ex31.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.1"></plus><ci id="S6.Ex31.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.2">𝑡</ci><apply id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3"><times id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.2">Δ</ci><ci id="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S6.Ex31.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex31.m1.2c">s_{\text{noisy}}(t)\leftarrow s_{\text{noisy}}(t+\Delta t).</annotation><annotation encoding="application/x-llamapun" id="S6.Ex31.m1.2d">italic_s start_POSTSUBSCRIPT noisy end_POSTSUBSCRIPT ( italic_t ) ← italic_s start_POSTSUBSCRIPT noisy end_POSTSUBSCRIPT ( italic_t + roman_Δ italic_t ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S6.SS1.p5">
<p class="ltx_p" id="S6.SS1.p5.1">This noise scheme provides a controlled yet diverse perturbation, effectively testing the robustness and generalization capacity of forecasting models under noisy conditions. Moreover, all signals (clean and noisy) are normalized to the unit interval <math alttext="[0,1]" class="ltx_Math" display="inline" id="S6.SS1.p5.1.m1.2"><semantics id="S6.SS1.p5.1.m1.2a"><mrow id="S6.SS1.p5.1.m1.2.3.2" xref="S6.SS1.p5.1.m1.2.3.1.cmml"><mo id="S6.SS1.p5.1.m1.2.3.2.1" stretchy="false" xref="S6.SS1.p5.1.m1.2.3.1.cmml">[</mo><mn id="S6.SS1.p5.1.m1.1.1" xref="S6.SS1.p5.1.m1.1.1.cmml">0</mn><mo id="S6.SS1.p5.1.m1.2.3.2.2" xref="S6.SS1.p5.1.m1.2.3.1.cmml">,</mo><mn id="S6.SS1.p5.1.m1.2.2" xref="S6.SS1.p5.1.m1.2.2.cmml">1</mn><mo id="S6.SS1.p5.1.m1.2.3.2.3" stretchy="false" xref="S6.SS1.p5.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p5.1.m1.2b"><interval closure="closed" id="S6.SS1.p5.1.m1.2.3.1.cmml" xref="S6.SS1.p5.1.m1.2.3.2"><cn id="S6.SS1.p5.1.m1.1.1.cmml" type="integer" xref="S6.SS1.p5.1.m1.1.1">0</cn><cn id="S6.SS1.p5.1.m1.2.2.cmml" type="integer" xref="S6.SS1.p5.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p5.1.m1.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p5.1.m1.2d">[ 0 , 1 ]</annotation></semantics></math> using the transformation:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.Ex32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{s}(t)=\frac{s(t)-\min_{t}s(t)}{\max_{t}s(t)-\min_{t}s(t)}," class="ltx_Math" display="block" id="S6.Ex32.m1.6"><semantics id="S6.Ex32.m1.6a"><mrow id="S6.Ex32.m1.6.6.1" xref="S6.Ex32.m1.6.6.1.1.cmml"><mrow id="S6.Ex32.m1.6.6.1.1" xref="S6.Ex32.m1.6.6.1.1.cmml"><mrow id="S6.Ex32.m1.6.6.1.1.2" xref="S6.Ex32.m1.6.6.1.1.2.cmml"><mover accent="true" id="S6.Ex32.m1.6.6.1.1.2.2" xref="S6.Ex32.m1.6.6.1.1.2.2.cmml"><mi id="S6.Ex32.m1.6.6.1.1.2.2.2" xref="S6.Ex32.m1.6.6.1.1.2.2.2.cmml">s</mi><mo id="S6.Ex32.m1.6.6.1.1.2.2.1" xref="S6.Ex32.m1.6.6.1.1.2.2.1.cmml">^</mo></mover><mo id="S6.Ex32.m1.6.6.1.1.2.1" xref="S6.Ex32.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S6.Ex32.m1.6.6.1.1.2.3.2" xref="S6.Ex32.m1.6.6.1.1.2.cmml"><mo id="S6.Ex32.m1.6.6.1.1.2.3.2.1" stretchy="false" xref="S6.Ex32.m1.6.6.1.1.2.cmml">(</mo><mi id="S6.Ex32.m1.5.5" xref="S6.Ex32.m1.5.5.cmml">t</mi><mo id="S6.Ex32.m1.6.6.1.1.2.3.2.2" stretchy="false" xref="S6.Ex32.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S6.Ex32.m1.6.6.1.1.1" xref="S6.Ex32.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S6.Ex32.m1.4.4" xref="S6.Ex32.m1.4.4.cmml"><mrow id="S6.Ex32.m1.2.2.2" xref="S6.Ex32.m1.2.2.2.cmml"><mrow id="S6.Ex32.m1.2.2.2.4" xref="S6.Ex32.m1.2.2.2.4.cmml"><mi id="S6.Ex32.m1.2.2.2.4.2" xref="S6.Ex32.m1.2.2.2.4.2.cmml">s</mi><mo id="S6.Ex32.m1.2.2.2.4.1" xref="S6.Ex32.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S6.Ex32.m1.2.2.2.4.3.2" xref="S6.Ex32.m1.2.2.2.4.cmml"><mo id="S6.Ex32.m1.2.2.2.4.3.2.1" stretchy="false" xref="S6.Ex32.m1.2.2.2.4.cmml">(</mo><mi id="S6.Ex32.m1.1.1.1.1" xref="S6.Ex32.m1.1.1.1.1.cmml">t</mi><mo id="S6.Ex32.m1.2.2.2.4.3.2.2" stretchy="false" xref="S6.Ex32.m1.2.2.2.4.cmml">)</mo></mrow></mrow><mo id="S6.Ex32.m1.2.2.2.3" xref="S6.Ex32.m1.2.2.2.3.cmml">−</mo><mrow id="S6.Ex32.m1.2.2.2.5" xref="S6.Ex32.m1.2.2.2.5.cmml"><mrow id="S6.Ex32.m1.2.2.2.5.2" xref="S6.Ex32.m1.2.2.2.5.2.cmml"><msub id="S6.Ex32.m1.2.2.2.5.2.1" xref="S6.Ex32.m1.2.2.2.5.2.1.cmml"><mi id="S6.Ex32.m1.2.2.2.5.2.1.2" xref="S6.Ex32.m1.2.2.2.5.2.1.2.cmml">min</mi><mi id="S6.Ex32.m1.2.2.2.5.2.1.3" xref="S6.Ex32.m1.2.2.2.5.2.1.3.cmml">t</mi></msub><mo id="S6.Ex32.m1.2.2.2.5.2a" lspace="0.167em" xref="S6.Ex32.m1.2.2.2.5.2.cmml">⁡</mo><mi id="S6.Ex32.m1.2.2.2.5.2.2" xref="S6.Ex32.m1.2.2.2.5.2.2.cmml">s</mi></mrow><mo id="S6.Ex32.m1.2.2.2.5.1" xref="S6.Ex32.m1.2.2.2.5.1.cmml">⁢</mo><mrow id="S6.Ex32.m1.2.2.2.5.3.2" xref="S6.Ex32.m1.2.2.2.5.cmml"><mo id="S6.Ex32.m1.2.2.2.5.3.2.1" stretchy="false" xref="S6.Ex32.m1.2.2.2.5.cmml">(</mo><mi id="S6.Ex32.m1.2.2.2.2" xref="S6.Ex32.m1.2.2.2.2.cmml">t</mi><mo id="S6.Ex32.m1.2.2.2.5.3.2.2" stretchy="false" xref="S6.Ex32.m1.2.2.2.5.cmml">)</mo></mrow></mrow></mrow><mrow id="S6.Ex32.m1.4.4.4" xref="S6.Ex32.m1.4.4.4.cmml"><mrow id="S6.Ex32.m1.4.4.4.4" xref="S6.Ex32.m1.4.4.4.4.cmml"><mrow id="S6.Ex32.m1.4.4.4.4.2" xref="S6.Ex32.m1.4.4.4.4.2.cmml"><msub id="S6.Ex32.m1.4.4.4.4.2.1" xref="S6.Ex32.m1.4.4.4.4.2.1.cmml"><mi id="S6.Ex32.m1.4.4.4.4.2.1.2" xref="S6.Ex32.m1.4.4.4.4.2.1.2.cmml">max</mi><mi id="S6.Ex32.m1.4.4.4.4.2.1.3" xref="S6.Ex32.m1.4.4.4.4.2.1.3.cmml">t</mi></msub><mo id="S6.Ex32.m1.4.4.4.4.2a" lspace="0.167em" xref="S6.Ex32.m1.4.4.4.4.2.cmml">⁡</mo><mi id="S6.Ex32.m1.4.4.4.4.2.2" xref="S6.Ex32.m1.4.4.4.4.2.2.cmml">s</mi></mrow><mo id="S6.Ex32.m1.4.4.4.4.1" xref="S6.Ex32.m1.4.4.4.4.1.cmml">⁢</mo><mrow id="S6.Ex32.m1.4.4.4.4.3.2" xref="S6.Ex32.m1.4.4.4.4.cmml"><mo id="S6.Ex32.m1.4.4.4.4.3.2.1" stretchy="false" xref="S6.Ex32.m1.4.4.4.4.cmml">(</mo><mi id="S6.Ex32.m1.3.3.3.1" xref="S6.Ex32.m1.3.3.3.1.cmml">t</mi><mo id="S6.Ex32.m1.4.4.4.4.3.2.2" stretchy="false" xref="S6.Ex32.m1.4.4.4.4.cmml">)</mo></mrow></mrow><mo id="S6.Ex32.m1.4.4.4.3" xref="S6.Ex32.m1.4.4.4.3.cmml">−</mo><mrow id="S6.Ex32.m1.4.4.4.5" xref="S6.Ex32.m1.4.4.4.5.cmml"><mrow id="S6.Ex32.m1.4.4.4.5.2" xref="S6.Ex32.m1.4.4.4.5.2.cmml"><msub id="S6.Ex32.m1.4.4.4.5.2.1" xref="S6.Ex32.m1.4.4.4.5.2.1.cmml"><mi id="S6.Ex32.m1.4.4.4.5.2.1.2" xref="S6.Ex32.m1.4.4.4.5.2.1.2.cmml">min</mi><mi id="S6.Ex32.m1.4.4.4.5.2.1.3" xref="S6.Ex32.m1.4.4.4.5.2.1.3.cmml">t</mi></msub><mo id="S6.Ex32.m1.4.4.4.5.2a" lspace="0.167em" xref="S6.Ex32.m1.4.4.4.5.2.cmml">⁡</mo><mi id="S6.Ex32.m1.4.4.4.5.2.2" xref="S6.Ex32.m1.4.4.4.5.2.2.cmml">s</mi></mrow><mo id="S6.Ex32.m1.4.4.4.5.1" xref="S6.Ex32.m1.4.4.4.5.1.cmml">⁢</mo><mrow id="S6.Ex32.m1.4.4.4.5.3.2" xref="S6.Ex32.m1.4.4.4.5.cmml"><mo id="S6.Ex32.m1.4.4.4.5.3.2.1" stretchy="false" xref="S6.Ex32.m1.4.4.4.5.cmml">(</mo><mi id="S6.Ex32.m1.4.4.4.2" xref="S6.Ex32.m1.4.4.4.2.cmml">t</mi><mo id="S6.Ex32.m1.4.4.4.5.3.2.2" stretchy="false" xref="S6.Ex32.m1.4.4.4.5.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S6.Ex32.m1.6.6.1.2" xref="S6.Ex32.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex32.m1.6b"><apply id="S6.Ex32.m1.6.6.1.1.cmml" xref="S6.Ex32.m1.6.6.1"><eq id="S6.Ex32.m1.6.6.1.1.1.cmml" xref="S6.Ex32.m1.6.6.1.1.1"></eq><apply id="S6.Ex32.m1.6.6.1.1.2.cmml" xref="S6.Ex32.m1.6.6.1.1.2"><times id="S6.Ex32.m1.6.6.1.1.2.1.cmml" xref="S6.Ex32.m1.6.6.1.1.2.1"></times><apply id="S6.Ex32.m1.6.6.1.1.2.2.cmml" xref="S6.Ex32.m1.6.6.1.1.2.2"><ci id="S6.Ex32.m1.6.6.1.1.2.2.1.cmml" xref="S6.Ex32.m1.6.6.1.1.2.2.1">^</ci><ci id="S6.Ex32.m1.6.6.1.1.2.2.2.cmml" xref="S6.Ex32.m1.6.6.1.1.2.2.2">𝑠</ci></apply><ci id="S6.Ex32.m1.5.5.cmml" xref="S6.Ex32.m1.5.5">𝑡</ci></apply><apply id="S6.Ex32.m1.4.4.cmml" xref="S6.Ex32.m1.4.4"><divide id="S6.Ex32.m1.4.4.5.cmml" xref="S6.Ex32.m1.4.4"></divide><apply id="S6.Ex32.m1.2.2.2.cmml" xref="S6.Ex32.m1.2.2.2"><minus id="S6.Ex32.m1.2.2.2.3.cmml" xref="S6.Ex32.m1.2.2.2.3"></minus><apply id="S6.Ex32.m1.2.2.2.4.cmml" xref="S6.Ex32.m1.2.2.2.4"><times id="S6.Ex32.m1.2.2.2.4.1.cmml" xref="S6.Ex32.m1.2.2.2.4.1"></times><ci id="S6.Ex32.m1.2.2.2.4.2.cmml" xref="S6.Ex32.m1.2.2.2.4.2">𝑠</ci><ci id="S6.Ex32.m1.1.1.1.1.cmml" xref="S6.Ex32.m1.1.1.1.1">𝑡</ci></apply><apply id="S6.Ex32.m1.2.2.2.5.cmml" xref="S6.Ex32.m1.2.2.2.5"><times id="S6.Ex32.m1.2.2.2.5.1.cmml" xref="S6.Ex32.m1.2.2.2.5.1"></times><apply id="S6.Ex32.m1.2.2.2.5.2.cmml" xref="S6.Ex32.m1.2.2.2.5.2"><apply id="S6.Ex32.m1.2.2.2.5.2.1.cmml" xref="S6.Ex32.m1.2.2.2.5.2.1"><csymbol cd="ambiguous" id="S6.Ex32.m1.2.2.2.5.2.1.1.cmml" xref="S6.Ex32.m1.2.2.2.5.2.1">subscript</csymbol><min id="S6.Ex32.m1.2.2.2.5.2.1.2.cmml" xref="S6.Ex32.m1.2.2.2.5.2.1.2"></min><ci id="S6.Ex32.m1.2.2.2.5.2.1.3.cmml" xref="S6.Ex32.m1.2.2.2.5.2.1.3">𝑡</ci></apply><ci id="S6.Ex32.m1.2.2.2.5.2.2.cmml" xref="S6.Ex32.m1.2.2.2.5.2.2">𝑠</ci></apply><ci id="S6.Ex32.m1.2.2.2.2.cmml" xref="S6.Ex32.m1.2.2.2.2">𝑡</ci></apply></apply><apply id="S6.Ex32.m1.4.4.4.cmml" xref="S6.Ex32.m1.4.4.4"><minus id="S6.Ex32.m1.4.4.4.3.cmml" xref="S6.Ex32.m1.4.4.4.3"></minus><apply id="S6.Ex32.m1.4.4.4.4.cmml" xref="S6.Ex32.m1.4.4.4.4"><times id="S6.Ex32.m1.4.4.4.4.1.cmml" xref="S6.Ex32.m1.4.4.4.4.1"></times><apply id="S6.Ex32.m1.4.4.4.4.2.cmml" xref="S6.Ex32.m1.4.4.4.4.2"><apply id="S6.Ex32.m1.4.4.4.4.2.1.cmml" xref="S6.Ex32.m1.4.4.4.4.2.1"><csymbol cd="ambiguous" id="S6.Ex32.m1.4.4.4.4.2.1.1.cmml" xref="S6.Ex32.m1.4.4.4.4.2.1">subscript</csymbol><max id="S6.Ex32.m1.4.4.4.4.2.1.2.cmml" xref="S6.Ex32.m1.4.4.4.4.2.1.2"></max><ci id="S6.Ex32.m1.4.4.4.4.2.1.3.cmml" xref="S6.Ex32.m1.4.4.4.4.2.1.3">𝑡</ci></apply><ci id="S6.Ex32.m1.4.4.4.4.2.2.cmml" xref="S6.Ex32.m1.4.4.4.4.2.2">𝑠</ci></apply><ci id="S6.Ex32.m1.3.3.3.1.cmml" xref="S6.Ex32.m1.3.3.3.1">𝑡</ci></apply><apply id="S6.Ex32.m1.4.4.4.5.cmml" xref="S6.Ex32.m1.4.4.4.5"><times id="S6.Ex32.m1.4.4.4.5.1.cmml" xref="S6.Ex32.m1.4.4.4.5.1"></times><apply id="S6.Ex32.m1.4.4.4.5.2.cmml" xref="S6.Ex32.m1.4.4.4.5.2"><apply id="S6.Ex32.m1.4.4.4.5.2.1.cmml" xref="S6.Ex32.m1.4.4.4.5.2.1"><csymbol cd="ambiguous" id="S6.Ex32.m1.4.4.4.5.2.1.1.cmml" xref="S6.Ex32.m1.4.4.4.5.2.1">subscript</csymbol><min id="S6.Ex32.m1.4.4.4.5.2.1.2.cmml" xref="S6.Ex32.m1.4.4.4.5.2.1.2"></min><ci id="S6.Ex32.m1.4.4.4.5.2.1.3.cmml" xref="S6.Ex32.m1.4.4.4.5.2.1.3">𝑡</ci></apply><ci id="S6.Ex32.m1.4.4.4.5.2.2.cmml" xref="S6.Ex32.m1.4.4.4.5.2.2">𝑠</ci></apply><ci id="S6.Ex32.m1.4.4.4.2.cmml" xref="S6.Ex32.m1.4.4.4.2">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex32.m1.6c">\hat{s}(t)=\frac{s(t)-\min_{t}s(t)}{\max_{t}s(t)-\min_{t}s(t)},</annotation><annotation encoding="application/x-llamapun" id="S6.Ex32.m1.6d">over^ start_ARG italic_s end_ARG ( italic_t ) = divide start_ARG italic_s ( italic_t ) - roman_min start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_s ( italic_t ) end_ARG start_ARG roman_max start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_s ( italic_t ) - roman_min start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_s ( italic_t ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS1.p5.2">This step ensures scale invariance and facilitates stable training and comparison across signals of varying magnitudes.</p>
</div>
<div class="ltx_para" id="S6.SS1.p6">
<p class="ltx_p" id="S6.SS1.p6.1">The noisy synthetic signals are visualized alongside the clean ones in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F1" title="Figure 1 ‣ 6.1 Noise Injection Strategy ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S6.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="642" id="S6.F1.sf1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F1.sf1.3.2" style="font-size:90%;">Noisy synthetic signals.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="642" id="S6.F1.sf2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F1.sf2.3.2" style="font-size:90%;">Clean synthetic signals.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S6.F1.3.2" style="font-size:90%;">10 synthetic time series data used for benchmarking transformer-based forecasting models.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Hardware Setup</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.2">All deep learning model training was performed on a high-performance computing node equipped with an <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.1">NVIDIA A100</span> <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.2">GPU</span> featuring <math alttext="80" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><cn id="S6.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">80</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">80</annotation></semantics></math> GB of high-bandwidth Video RAM (<span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.3">VRAM</span>), optimized for large-scale machine learning workloads. The system was configured with <math alttext="256" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mn id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><cn id="S6.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S6.SS2.p1.2.m2.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">256</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">256</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.4">GB</span> of main memory accessible per <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.5">CPU</span> core, ensuring efficient handling of high-dimensional data and large batch sizes. Training tasks were orchestrated using the Simple <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.6">Linux</span> Utility for Resource Management (<span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.7">SLURM</span>), which allocated compute resources with job-specific constraints to ensure optimal utilization of the <span class="ltx_text ltx_font_typewriter" id="S6.SS2.p1.2.8">A100</span>’s memory architecture. This hardware-software configuration significantly accelerated the training process and maintained computational stability, which was critical for learning long-range temporal dependencies in wind power time series data.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Training setup</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.5">To ensure a fair and consistent comparison across different Transformer-based architectures, we standardized the model configuration parameters for all variants. Specifically, each model—including <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p1.5.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p1.5.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p1.5.3">PatchTST</span> variants—was implemented with a model dimension (<math alttext="d_{model}" class="ltx_Math" display="inline" id="S6.SS3.p1.1.m1.1"><semantics id="S6.SS3.p1.1.m1.1a"><msub id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.p1.1.m1.1.1.2" xref="S6.SS3.p1.1.m1.1.1.2.cmml">d</mi><mrow id="S6.SS3.p1.1.m1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.3.cmml"><mi id="S6.SS3.p1.1.m1.1.1.3.2" xref="S6.SS3.p1.1.m1.1.1.3.2.cmml">m</mi><mo id="S6.SS3.p1.1.m1.1.1.3.1" xref="S6.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS3.p1.1.m1.1.1.3.3" xref="S6.SS3.p1.1.m1.1.1.3.3.cmml">o</mi><mo id="S6.SS3.p1.1.m1.1.1.3.1a" xref="S6.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS3.p1.1.m1.1.1.3.4" xref="S6.SS3.p1.1.m1.1.1.3.4.cmml">d</mi><mo id="S6.SS3.p1.1.m1.1.1.3.1b" xref="S6.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS3.p1.1.m1.1.1.3.5" xref="S6.SS3.p1.1.m1.1.1.3.5.cmml">e</mi><mo id="S6.SS3.p1.1.m1.1.1.3.1c" xref="S6.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS3.p1.1.m1.1.1.3.6" xref="S6.SS3.p1.1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><apply id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.2">𝑑</ci><apply id="S6.SS3.p1.1.m1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3"><times id="S6.SS3.p1.1.m1.1.1.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.3.1"></times><ci id="S6.SS3.p1.1.m1.1.1.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.3.2">𝑚</ci><ci id="S6.SS3.p1.1.m1.1.1.3.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S6.SS3.p1.1.m1.1.1.3.4.cmml" xref="S6.SS3.p1.1.m1.1.1.3.4">𝑑</ci><ci id="S6.SS3.p1.1.m1.1.1.3.5.cmml" xref="S6.SS3.p1.1.m1.1.1.3.5">𝑒</ci><ci id="S6.SS3.p1.1.m1.1.1.3.6.cmml" xref="S6.SS3.p1.1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">d_{model}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>) of <math alttext="8" class="ltx_Math" display="inline" id="S6.SS3.p1.2.m2.1"><semantics id="S6.SS3.p1.2.m2.1a"><mn id="S6.SS3.p1.2.m2.1.1" xref="S6.SS3.p1.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.1b"><cn id="S6.SS3.p1.2.m2.1.1.cmml" type="integer" xref="S6.SS3.p1.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.1c">8</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.2.m2.1d">8</annotation></semantics></math>, number of attention heads set to <math alttext="2" class="ltx_Math" display="inline" id="S6.SS3.p1.3.m3.1"><semantics id="S6.SS3.p1.3.m3.1a"><mn id="S6.SS3.p1.3.m3.1.1" xref="S6.SS3.p1.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.3.m3.1b"><cn id="S6.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S6.SS3.p1.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.3.m3.1d">2</annotation></semantics></math>, feedforward network dimension of <math alttext="32" class="ltx_Math" display="inline" id="S6.SS3.p1.4.m4.1"><semantics id="S6.SS3.p1.4.m4.1a"><mn id="S6.SS3.p1.4.m4.1.1" xref="S6.SS3.p1.4.m4.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.4.m4.1b"><cn id="S6.SS3.p1.4.m4.1.1.cmml" type="integer" xref="S6.SS3.p1.4.m4.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.4.m4.1c">32</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.4.m4.1d">32</annotation></semantics></math>, and <math alttext="2" class="ltx_Math" display="inline" id="S6.SS3.p1.5.m5.1"><semantics id="S6.SS3.p1.5.m5.1a"><mn id="S6.SS3.p1.5.m5.1.1" xref="S6.SS3.p1.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.5.m5.1b"><cn id="S6.SS3.p1.5.m5.1.1.cmml" type="integer" xref="S6.SS3.p1.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.5.m5.1c">2</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.5.m5.1d">2</annotation></semantics></math> encoder layers (and 1 decoder layer where applicable). This uniform setup minimizes the influence of architectural hyperparameter variations, thereby allowing the evaluation to focus solely on the intrinsic differences in model design and attention mechanisms. Such standardization is crucial for isolating the effects of core architectural innovations in comparative forecasting tasks.</p>
</div>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1">All models were trained for 300, and 600 epochs with the <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p2.1.1">Adam</span> optimizer (learning rate = <math alttext="10^{-3}" class="ltx_Math" display="inline" id="S6.SS3.p2.1.m1.1"><semantics id="S6.SS3.p2.1.m1.1a"><msup id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml"><mn id="S6.SS3.p2.1.m1.1.1.2" xref="S6.SS3.p2.1.m1.1.1.2.cmml">10</mn><mrow id="S6.SS3.p2.1.m1.1.1.3" xref="S6.SS3.p2.1.m1.1.1.3.cmml"><mo id="S6.SS3.p2.1.m1.1.1.3a" xref="S6.SS3.p2.1.m1.1.1.3.cmml">−</mo><mn id="S6.SS3.p2.1.m1.1.1.3.2" xref="S6.SS3.p2.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><apply id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.1.m1.1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">superscript</csymbol><cn id="S6.SS3.p2.1.m1.1.1.2.cmml" type="integer" xref="S6.SS3.p2.1.m1.1.1.2">10</cn><apply id="S6.SS3.p2.1.m1.1.1.3.cmml" xref="S6.SS3.p2.1.m1.1.1.3"><minus id="S6.SS3.p2.1.m1.1.1.3.1.cmml" xref="S6.SS3.p2.1.m1.1.1.3"></minus><cn id="S6.SS3.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S6.SS3.p2.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.1.m1.1d">10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>), minimizing the mean squared error (MSE) between predictions and ground truth for clean and noisy signals, respectively.</p>
</div>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1">Each <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p3.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p3.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.SS3.p3.1.3">Autoformer</span> variant is evaluated across 5 different patch lengths and 5 forecast horizons on a suite of 10 synthetic signals, resulting in a total of 750 configurations (<math alttext="3\times 5\times 5\times 10" class="ltx_Math" display="inline" id="S6.SS3.p3.1.m1.1"><semantics id="S6.SS3.p3.1.m1.1a"><mrow id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml"><mn id="S6.SS3.p3.1.m1.1.1.2" xref="S6.SS3.p3.1.m1.1.1.2.cmml">3</mn><mo id="S6.SS3.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS3.p3.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS3.p3.1.m1.1.1.3" xref="S6.SS3.p3.1.m1.1.1.3.cmml">5</mn><mo id="S6.SS3.p3.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS3.p3.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS3.p3.1.m1.1.1.4" xref="S6.SS3.p3.1.m1.1.1.4.cmml">5</mn><mo id="S6.SS3.p3.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S6.SS3.p3.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS3.p3.1.m1.1.1.5" xref="S6.SS3.p3.1.m1.1.1.5.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.m1.1b"><apply id="S6.SS3.p3.1.m1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1"><times id="S6.SS3.p3.1.m1.1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1.1"></times><cn id="S6.SS3.p3.1.m1.1.1.2.cmml" type="integer" xref="S6.SS3.p3.1.m1.1.1.2">3</cn><cn id="S6.SS3.p3.1.m1.1.1.3.cmml" type="integer" xref="S6.SS3.p3.1.m1.1.1.3">5</cn><cn id="S6.SS3.p3.1.m1.1.1.4.cmml" type="integer" xref="S6.SS3.p3.1.m1.1.1.4">5</cn><cn id="S6.SS3.p3.1.m1.1.1.5.cmml" type="integer" xref="S6.SS3.p3.1.m1.1.1.5">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.m1.1c">3\times 5\times 5\times 10</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p3.1.m1.1d">3 × 5 × 5 × 10</annotation></semantics></math>) for clean signals. To assess robustness under realistic conditions, an additional set of 750 configurations is tested on noisy versions of the same signals, yielding a comprehensive total of 1500 model evaluations. To enhance clarity and interpretability, we present the results as heatmaps averaged over all signals for each model variant. Forecasting performance is measured using root mean square error (RMSE) and mean absolute error (MAE), evaluated over grids of patch lengths and forecast horizons.</p>
</div>
<section class="ltx_paragraph" id="S6.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Code availability statement</h5>
<div class="ltx_para" id="S6.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS3.SSS0.Px1.p1.1">The complete source code used in this study—including the full implementation of the Transformer-based models for time-series forecasting—is openly available in the dedicated <span class="ltx_text ltx_font_typewriter" id="S6.SS3.SSS0.Px1.p1.1.1">compactformer</span> GitHub repository<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Ali-Forootani/compactformer" title="">https://github.com/Ali-Forootani/compactformer</a> or <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Ali-Forootani/compact-transformers/tree/main" title="">https://github.com/Ali-Forootani/compact-transformers/tree/main</a></span></span></span> and Zenodo <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://zenodo.org/records/15518817" title="">https://zenodo.org/records/15518817</a>, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://zenodo.org/records/15518836" title="">https://zenodo.org/records/15518836</a></span></span></span>. <span class="ltx_text ltx_font_typewriter" id="S6.SS3.SSS0.Px1.p1.1.2">compactformer</span> is a modular, research-grade <span class="ltx_text ltx_font_typewriter" id="S6.SS3.SSS0.Px1.p1.1.3">Python</span> package that offers a unified interface for Transformer-based time-series forecasting, enabling reproducible experimentation and rapid prototyping.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Evaluation of <span class="ltx_text ltx_font_typewriter" id="S6.SS4.1.1">PatchTST</span> Variants under Clean and Noisy Conditions</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F2" title="Figure 2 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">2</span></a> presents heatmaps of RMSE and MAE averaged over all signals, separately for clean and noisy conditions. Each cell corresponds to the mean forecast error for a given patch length and forecast horizon combination. Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T4" title="Table 4 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">4</span></a> highlights the best-performing configuration for each signal under clean conditions, while Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T5" title="Table 5 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.4 Evaluation of PatchTST Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">5</span></a> reports the corresponding results for noisy signals.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">These tables present the best-performing <span class="ltx_text ltx_font_typewriter" id="S6.SS4.p2.1.1">PatchTST</span> model for each signal type based on RMSE and MAE values, highlighting the optimal configurations of patch length and forecast horizon for both clean and noisy signals.</p>
</div>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Minimal Variant</h5>
<div class="ltx_para" id="S6.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px1.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS4.SSS0.Px1.p1.1.1">PatchTST</span> Minimal variant demonstrates competitive performance, especially in configurations with shorter forecast horizons. Across different patch lengths and horizons, it consistently maintains low RMSE and MAE values, with the best results observed at smaller patch lengths and short to mid-range horizons. Specifically, for clean signals, it achieves its best performance with patch lengths of 4 or 8 and forecast horizons of 2 or 4, showing strong forecasting accuracy (RMSE as low as 0.0270 and MAE as low as 0.0205).</p>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px1.p2.1">For noisy signals, the Minimal variant still exhibits strong robustness, although the performance is slightly reduced compared to clean signals. The variant continues to perform well in the shorter horizon configurations (patch lengths of 4, 8, and 12) with RMSE and MAE values maintaining a good balance between accuracy and computational efficiency. In the noisy environment, the RMSE stays around 0.0623 to 0.0757 and the MAE varies between 0.0501 and 0.0596.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Standard Variant</h5>
<div class="ltx_para" id="S6.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px2.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS4.SSS0.Px2.p1.1.1">PatchTST</span> Standard variant demonstrates the best overall performance across various configurations, showing excellent accuracy and stability in both clean and noisy conditions. For clean signals, it consistently achieves low RMSE and MAE across all patch lengths and forecast horizons. The variant shows its best results at a patch length of 12 and a forecast horizon of 4 or 8, with RMSE values as low as 0.0260 and MAE values as low as 0.0232, making it a highly reliable choice for a variety of signal types.</p>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px2.p2.1">In noisy environments, the Standard variant maintains impressive robustness. Although the performance slightly declines compared to clean signals, the variant continues to deliver competitive RMSE (ranging from 0.0521 to 0.0847) and MAE (ranging from 0.0414 to 0.0601) values. This suggests that the Standard variant is particularly suited for applications requiring stable performance across different levels of noise.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Full Variant Performance</h5>
<div class="ltx_para" id="S6.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS4.SSS0.Px3.p1.1.1">PatchTST</span> Full variant excels in configurations involving complex, nonlinear signals, especially under noisy conditions. It consistently achieves strong performance across a variety of patch lengths and forecast horizons, though it is computationally more demanding than the Minimal and Standard variants.</p>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px3.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p2.1">For clean signals, the Full variant performs well across all configurations. It shows its best results with a patch length of 12 and a forecast horizon of 8 or 20, achieving RMSE values as low as 0.0302 and MAE values as low as 0.0234. This indicates that the Full variant is capable of capturing intricate temporal dependencies effectively.</p>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px3.p3">
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p3.1">In noisy environments, the Full variant remains robust but slightly less accurate compared to clean signals. It performs particularly well with longer patch lengths (12 and 20) and longer forecast horizons (8 and 20). For example, at a patch length of 12 and horizon 20, it achieves RMSE values around 0.0447 and MAE values near 0.0357, demonstrating its ability to handle noisy signals while maintaining solid forecasting accuracy.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Sensitivity to Patch and Horizon Lengths</h5>
<div class="ltx_para" id="S6.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px4.p1.1">As demonstrated in the figures, all <span class="ltx_text ltx_font_typewriter" id="S6.SS4.SSS0.Px4.p1.1.1">PatchTST</span> variants exhibit varying degrees of sensitivity to patch length and forecast horizon. Generally, increasing the patch length up to 12 or 16 improves forecasting accuracy, though performance gains level off or even degrade slightly for longer patch lengths in noisy conditions. The Minimal variant is most effective for short forecast horizons, while the Standard variant maintains strong performance across a broader range of horizons. The Full variant tends to perform better on longer horizons, especially when dealing with complex or noisy signals.</p>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T4.6.1.1" style="font-size:129%;">Table 4</span>: </span><span class="ltx_text" id="S6.T4.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T4.7.2.1">PatchTST</span>  Model per Signal Based on RMSE &amp; MAE (Clean Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T4.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T4.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T4.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T4.8.2.1.1"><span class="ltx_text" id="S6.T4.8.2.1.1.1" style="font-size:70%;">2nd Order Poly</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.8.2.1.2"><span class="ltx_text" id="S6.T4.8.2.1.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.8.2.1.3"><span class="ltx_text" id="S6.T4.8.2.1.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.8.2.1.4"><span class="ltx_text" id="S6.T4.8.2.1.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.8.2.1.5"><span class="ltx_text" id="S6.T4.8.2.1.5.1" style="font-size:70%;">0.0389</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.8.2.1.6"><span class="ltx_text" id="S6.T4.8.2.1.6.1" style="font-size:70%;">0.0297</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T4.8.3.2.1"><span class="ltx_text" id="S6.T4.8.3.2.1.1" style="font-size:70%;">Cos + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.3.2.2"><span class="ltx_text" id="S6.T4.8.3.2.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.3.2.3"><span class="ltx_text" id="S6.T4.8.3.2.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.3.2.4"><span class="ltx_text" id="S6.T4.8.3.2.4.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.3.2.5"><span class="ltx_text" id="S6.T4.8.3.2.5.1" style="font-size:70%;">0.0020</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.3.2.6"><span class="ltx_text" id="S6.T4.8.3.2.6.1" style="font-size:70%;">0.0015</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T4.8.4.3.1"><span class="ltx_text" id="S6.T4.8.4.3.1.1" style="font-size:70%;">CosEnv × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.4.3.2"><span class="ltx_text" id="S6.T4.8.4.3.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.4.3.3"><span class="ltx_text" id="S6.T4.8.4.3.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.4.3.4"><span class="ltx_text" id="S6.T4.8.4.3.4.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.4.3.5"><span class="ltx_text" id="S6.T4.8.4.3.5.1" style="font-size:70%;">0.0027</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.4.3.6"><span class="ltx_text" id="S6.T4.8.4.3.6.1" style="font-size:70%;">0.0020</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T4.8.5.4.1"><span class="ltx_text" id="S6.T4.8.5.4.1.1" style="font-size:70%;">Cubic Poly</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.5.4.2"><span class="ltx_text" id="S6.T4.8.5.4.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.5.4.3"><span class="ltx_text" id="S6.T4.8.5.4.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.5.4.4"><span class="ltx_text" id="S6.T4.8.5.4.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.5.4.5"><span class="ltx_text" id="S6.T4.8.5.4.5.1" style="font-size:70%;">0.0389</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.5.4.6"><span class="ltx_text" id="S6.T4.8.5.4.6.1" style="font-size:70%;">0.0297</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T4.8.6.5.1"><span class="ltx_text" id="S6.T4.8.6.5.1.1" style="font-size:70%;">ExpDec × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.6.5.2"><span class="ltx_text" id="S6.T4.8.6.5.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.6.5.3"><span class="ltx_text" id="S6.T4.8.6.5.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.6.5.4"><span class="ltx_text" id="S6.T4.8.6.5.4.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.6.5.5"><span class="ltx_text" id="S6.T4.8.6.5.5.1" style="font-size:70%;">0.0000</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.6.5.6"><span class="ltx_text" id="S6.T4.8.6.5.6.1" style="font-size:70%;">0.0000</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T4.8.7.6.1"><span class="ltx_text" id="S6.T4.8.7.6.1.1" style="font-size:70%;">Exp Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.7.6.2"><span class="ltx_text" id="S6.T4.8.7.6.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.7.6.3"><span class="ltx_text" id="S6.T4.8.7.6.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.7.6.4"><span class="ltx_text" id="S6.T4.8.7.6.4.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.7.6.5"><span class="ltx_text" id="S6.T4.8.7.6.5.1" style="font-size:70%;">0.0575</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.7.6.6"><span class="ltx_text" id="S6.T4.8.7.6.6.1" style="font-size:70%;">0.0418</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T4.8.8.7.1"><span class="ltx_text" id="S6.T4.8.8.7.1.1" style="font-size:70%;">Gauss Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.8.7.2"><span class="ltx_text" id="S6.T4.8.8.7.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.8.7.3"><span class="ltx_text" id="S6.T4.8.8.7.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.8.7.4"><span class="ltx_text" id="S6.T4.8.8.7.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.8.7.5"><span class="ltx_text" id="S6.T4.8.8.7.5.1" style="font-size:70%;">0.0607</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.8.7.6"><span class="ltx_text" id="S6.T4.8.8.7.6.1" style="font-size:70%;">0.0496</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T4.8.9.8.1"><span class="ltx_text" id="S6.T4.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.9.8.2"><span class="ltx_text" id="S6.T4.8.9.8.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.9.8.3"><span class="ltx_text" id="S6.T4.8.9.8.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.9.8.4"><span class="ltx_text" id="S6.T4.8.9.8.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.9.8.5"><span class="ltx_text" id="S6.T4.8.9.8.5.1" style="font-size:70%;">0.0076</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.9.8.6"><span class="ltx_text" id="S6.T4.8.9.8.6.1" style="font-size:70%;">0.0062</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T4.8.10.9.1"><span class="ltx_text" id="S6.T4.8.10.9.1.1" style="font-size:70%;">Long Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.10.9.2"><span class="ltx_text" id="S6.T4.8.10.9.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.10.9.3"><span class="ltx_text" id="S6.T4.8.10.9.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.10.9.4"><span class="ltx_text" id="S6.T4.8.10.9.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.10.9.5"><span class="ltx_text" id="S6.T4.8.10.9.5.1" style="font-size:70%;">0.0706</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.8.10.9.6"><span class="ltx_text" id="S6.T4.8.10.9.6.1" style="font-size:70%;">0.0528</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T4.8.11.10.1"><span class="ltx_text" id="S6.T4.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.8.11.10.2"><span class="ltx_text" id="S6.T4.8.11.10.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.8.11.10.3"><span class="ltx_text" id="S6.T4.8.11.10.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.8.11.10.4"><span class="ltx_text" id="S6.T4.8.11.10.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.8.11.10.5"><span class="ltx_text" id="S6.T4.8.11.10.5.1" style="font-size:70%;">0.0001</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.8.11.10.6"><span class="ltx_text" id="S6.T4.8.11.10.6.1" style="font-size:70%;">0.0001</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S6.T5">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T5.6.1.1" style="font-size:129%;">Table 5</span>: </span><span class="ltx_text" id="S6.T5.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T5.7.2.1">PatchTST</span>  Model per Signal Based on RMSE &amp; MAE (Noisy Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T5.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T5.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T5.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T5.8.2.1.1"><span class="ltx_text" id="S6.T5.8.2.1.1.1" style="font-size:70%;">2nd Order Poly</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.8.2.1.2"><span class="ltx_text" id="S6.T5.8.2.1.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.8.2.1.3"><span class="ltx_text" id="S6.T5.8.2.1.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.8.2.1.4"><span class="ltx_text" id="S6.T5.8.2.1.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.8.2.1.5"><span class="ltx_text" id="S6.T5.8.2.1.5.1" style="font-size:70%;">0.1015</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.8.2.1.6"><span class="ltx_text" id="S6.T5.8.2.1.6.1" style="font-size:70%;">0.0828</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T5.8.3.2.1"><span class="ltx_text" id="S6.T5.8.3.2.1.1" style="font-size:70%;">Cos + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.3.2.2"><span class="ltx_text" id="S6.T5.8.3.2.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.3.2.3"><span class="ltx_text" id="S6.T5.8.3.2.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.3.2.4"><span class="ltx_text" id="S6.T5.8.3.2.4.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.3.2.5"><span class="ltx_text" id="S6.T5.8.3.2.5.1" style="font-size:70%;">0.0216</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.3.2.6"><span class="ltx_text" id="S6.T5.8.3.2.6.1" style="font-size:70%;">0.0175</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T5.8.4.3.1"><span class="ltx_text" id="S6.T5.8.4.3.1.1" style="font-size:70%;">CosEnv × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.4.3.2"><span class="ltx_text" id="S6.T5.8.4.3.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.4.3.3"><span class="ltx_text" id="S6.T5.8.4.3.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.4.3.4"><span class="ltx_text" id="S6.T5.8.4.3.4.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.4.3.5"><span class="ltx_text" id="S6.T5.8.4.3.5.1" style="font-size:70%;">0.0338</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.4.3.6"><span class="ltx_text" id="S6.T5.8.4.3.6.1" style="font-size:70%;">0.0269</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T5.8.5.4.1"><span class="ltx_text" id="S6.T5.8.5.4.1.1" style="font-size:70%;">Cubic Poly</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.5.4.2"><span class="ltx_text" id="S6.T5.8.5.4.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.5.4.3"><span class="ltx_text" id="S6.T5.8.5.4.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.5.4.4"><span class="ltx_text" id="S6.T5.8.5.4.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.5.4.5"><span class="ltx_text" id="S6.T5.8.5.4.5.1" style="font-size:70%;">0.0357</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.5.4.6"><span class="ltx_text" id="S6.T5.8.5.4.6.1" style="font-size:70%;">0.0279</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T5.8.6.5.1"><span class="ltx_text" id="S6.T5.8.6.5.1.1" style="font-size:70%;">ExpDec × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.6.5.2"><span class="ltx_text" id="S6.T5.8.6.5.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.6.5.3"><span class="ltx_text" id="S6.T5.8.6.5.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.6.5.4"><span class="ltx_text" id="S6.T5.8.6.5.4.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.6.5.5"><span class="ltx_text" id="S6.T5.8.6.5.5.1" style="font-size:70%;">0.0447</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.6.5.6"><span class="ltx_text" id="S6.T5.8.6.5.6.1" style="font-size:70%;">0.0357</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T5.8.7.6.1"><span class="ltx_text" id="S6.T5.8.7.6.1.1" style="font-size:70%;">Exp Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.7.6.2"><span class="ltx_text" id="S6.T5.8.7.6.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.7.6.3"><span class="ltx_text" id="S6.T5.8.7.6.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.7.6.4"><span class="ltx_text" id="S6.T5.8.7.6.4.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.7.6.5"><span class="ltx_text" id="S6.T5.8.7.6.5.1" style="font-size:70%;">0.0782</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.7.6.6"><span class="ltx_text" id="S6.T5.8.7.6.6.1" style="font-size:70%;">0.0613</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T5.8.8.7.1"><span class="ltx_text" id="S6.T5.8.8.7.1.1" style="font-size:70%;">Gauss Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.7.2"><span class="ltx_text" id="S6.T5.8.8.7.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.7.3"><span class="ltx_text" id="S6.T5.8.8.7.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.7.4"><span class="ltx_text" id="S6.T5.8.8.7.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.7.5"><span class="ltx_text" id="S6.T5.8.8.7.5.1" style="font-size:70%;">0.0607</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.7.6"><span class="ltx_text" id="S6.T5.8.8.7.6.1" style="font-size:70%;">0.0496</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T5.8.9.8.1"><span class="ltx_text" id="S6.T5.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.9.8.2"><span class="ltx_text" id="S6.T5.8.9.8.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.9.8.3"><span class="ltx_text" id="S6.T5.8.9.8.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.9.8.4"><span class="ltx_text" id="S6.T5.8.9.8.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.9.8.5"><span class="ltx_text" id="S6.T5.8.9.8.5.1" style="font-size:70%;">0.0076</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.9.8.6"><span class="ltx_text" id="S6.T5.8.9.8.6.1" style="font-size:70%;">0.0062</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T5.8.10.9.1"><span class="ltx_text" id="S6.T5.8.10.9.1.1" style="font-size:70%;">Long Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.10.9.2"><span class="ltx_text" id="S6.T5.8.10.9.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.10.9.3"><span class="ltx_text" id="S6.T5.8.10.9.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.10.9.4"><span class="ltx_text" id="S6.T5.8.10.9.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.10.9.5"><span class="ltx_text" id="S6.T5.8.10.9.5.1" style="font-size:70%;">0.0374</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.8.10.9.6"><span class="ltx_text" id="S6.T5.8.10.9.6.1" style="font-size:70%;">0.0312</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T5.8.11.10.1"><span class="ltx_text" id="S6.T5.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.8.11.10.2"><span class="ltx_text" id="S6.T5.8.11.10.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.8.11.10.3"><span class="ltx_text" id="S6.T5.8.11.10.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.8.11.10.4"><span class="ltx_text" id="S6.T5.8.11.10.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.8.11.10.5"><span class="ltx_text" id="S6.T5.8.11.10.5.1" style="font-size:70%;">0.0364</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.8.11.10.6"><span class="ltx_text" id="S6.T5.8.11.10.6.1" style="font-size:70%;">0.0300</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="465" id="S6.F2.g1" src="x3.png" width="838"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S6.F2.4.2" style="font-size:90%;">Performance of <span class="ltx_text ltx_font_typewriter" id="S6.F2.4.2.1">PatchTST</span> variants (Minimal, Standard, Full) on various patch lengths and forecast horizons, averaged over all signals. Left column: RMSE heatmaps. Right column: MAE heatmaps.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Evaluation of <span class="ltx_text ltx_font_typewriter" id="S6.SS5.1.1">Informer</span> Variants under Clean and Noisy Conditions</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">We evaluate three <span class="ltx_text ltx_font_typewriter" id="S6.SS5.p1.1.1">Informer</span> variants—Minimal, Standard, and Full—across a grid of five patch lengths and five forecast horizons for each of ten synthetic signals, resulting in a total of 750 configurations (<math alttext="3\times 5\times 5\times 10" class="ltx_Math" display="inline" id="S6.SS5.p1.1.m1.1"><semantics id="S6.SS5.p1.1.m1.1a"><mrow id="S6.SS5.p1.1.m1.1.1" xref="S6.SS5.p1.1.m1.1.1.cmml"><mn id="S6.SS5.p1.1.m1.1.1.2" xref="S6.SS5.p1.1.m1.1.1.2.cmml">3</mn><mo id="S6.SS5.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS5.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS5.p1.1.m1.1.1.3" xref="S6.SS5.p1.1.m1.1.1.3.cmml">5</mn><mo id="S6.SS5.p1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS5.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS5.p1.1.m1.1.1.4" xref="S6.SS5.p1.1.m1.1.1.4.cmml">5</mn><mo id="S6.SS5.p1.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S6.SS5.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS5.p1.1.m1.1.1.5" xref="S6.SS5.p1.1.m1.1.1.5.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS5.p1.1.m1.1b"><apply id="S6.SS5.p1.1.m1.1.1.cmml" xref="S6.SS5.p1.1.m1.1.1"><times id="S6.SS5.p1.1.m1.1.1.1.cmml" xref="S6.SS5.p1.1.m1.1.1.1"></times><cn id="S6.SS5.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS5.p1.1.m1.1.1.2">3</cn><cn id="S6.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS5.p1.1.m1.1.1.3">5</cn><cn id="S6.SS5.p1.1.m1.1.1.4.cmml" type="integer" xref="S6.SS5.p1.1.m1.1.1.4">5</cn><cn id="S6.SS5.p1.1.m1.1.1.5.cmml" type="integer" xref="S6.SS5.p1.1.m1.1.1.5">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS5.p1.1.m1.1c">3\times 5\times 5\times 10</annotation><annotation encoding="application/x-llamapun" id="S6.SS5.p1.1.m1.1d">3 × 5 × 5 × 10</annotation></semantics></math>) per dataset. To provide a comprehensive overview of model behavior, Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F3" title="Figure 3 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">3</span></a> displays heatmaps of mean RMSE and MAE values, averaged across all signals. Results are reported separately for clean and noisy inputs. These visualizations help identify performance trends with respect to model complexity, patch size, and forecast horizon. Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T6" title="Table 6 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">6</span></a> highlights the best-performing configuration for each signal under clean conditions, while Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T7" title="Table 7 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.5 Evaluation of Informer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">7</span></a> shows the corresponding results for noisy signals. These tables present the best-performing <span class="ltx_text ltx_font_typewriter" id="S6.SS5.p1.1.2">Informer</span> model for each signal type based on RMSE and MAE values, highlighting the optimal configurations of patch length and forecast horizon for both clean and noisy signals.</p>
</div>
<section class="ltx_paragraph" id="S6.SS5.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Minimal Variant Performance</h5>
<div class="ltx_para" id="S6.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS5.SSS0.Px1.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS5.SSS0.Px1.p1.1.1">Informer</span> Minimal variant performs well across different configurations, showing the lowest RMSE and MAE values for clean signals, especially in shorter forecast horizons and smaller patch lengths. For clean signals, it achieves its best results at patch lengths of 4 and 8, with RMSE values as low as 0.0491 and MAE values around 0.0410. As the forecast horizon increases, the performance slightly degrades, but the model remains effective across various configurations.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS5.SSS0.Px1.p2.1">In noisy environments, the Minimal variant experiences a reduction in performance compared to clean signals, but it still performs relatively well. The RMSE values for noisy signals range from 0.0699 to 0.0964, and the MAE ranges from 0.0559 to 0.0796, with the best performance observed at shorter forecast horizons (2 and 4) and smaller patch lengths (4 and 8). Despite the added noise, the Minimal variant remains robust, especially in configurations with shorter patch lengths and forecast horizons.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS5.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Standard Variant Performance</h5>
<div class="ltx_para" id="S6.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS5.SSS0.Px2.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS5.SSS0.Px2.p1.1.1">Informer</span> Standard variant shows strong performance across a variety of configurations, with consistent results for both clean and noisy signals. For clean signals, it achieves its best performance at a patch length of 12 and a forecast horizon of 4 or 8, where it records RMSE values as low as 0.0525 and MAE values as low as 0.0399. As the forecast horizon increases, the model maintains strong performance, though slight increases in RMSE and MAE can be observed, particularly at longer patch lengths.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS5.SSS0.Px2.p2.1">In noisy environments, the Standard variant’s performance does degrade slightly compared to clean signals, but it still shows resilience. The RMSE values for noisy signals range from 0.0680 to 0.1060, and the MAE ranges from 0.0546 to 0.0796. The best performance is achieved with smaller patch lengths (4 and 8) and shorter forecast horizons (2 and 4). Despite the added noise, the Standard variant performs admirably across most configurations, making it a versatile choice for a wide range of time series forecasting tasks.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS5.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Full Variant</h5>
<div class="ltx_para" id="S6.SS5.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS5.SSS0.Px3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS5.SSS0.Px3.p1.1.1">Informer</span> Full variant demonstrates strong performance across a variety of patch lengths and forecast horizons, particularly for noisy signals. For clean signals, the Full variant performs well across all configurations, with the best results typically seen with patch lengths of 12 and 16 and forecast horizons of 4 or 8. It achieves RMSE values as low as 0.0353 and MAE values around 0.0265. The performance remains solid as the forecast horizon increases, although the RMSE and MAE do rise slightly as the patch length and horizon increase.</p>
</div>
<div class="ltx_para" id="S6.SS5.SSS0.Px3.p2">
<p class="ltx_p" id="S6.SS5.SSS0.Px3.p2.1">In noisy environments, the Full variant still performs well but with a noticeable decline compared to clean signals. The RMSE for noisy signals ranges from 0.0709 to 0.1101, and the MAE varies between 0.0566 and 0.0876. The best performance is typically observed at smaller patch lengths (4 and 8) and shorter forecast horizons (2 and 4). Despite this reduction in performance due to noise, the Full variant maintains robust forecasting accuracy, especially for longer horizons.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS5.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Sensitivity to Patch and Horizon Lengths</h5>
<div class="ltx_para" id="S6.SS5.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS5.SSS0.Px4.p1.1">All three variants exhibit sensitivity to both patch size and forecast horizon. On clean signals, shorter horizons (up to 4 steps) yield the best RMSE and MAE values for Minimal and Standard models. In contrast, the Full variant maintains stable performance even at longer horizons, reflecting its superior ability to abstract temporal structure. Across variants, optimal patch lengths are typically found in the 12 to 16 range. Short patches (e.g., length 4) often lead to underfitting, while longer patches (e.g., length 20) occasionally degrade performance, particularly under noisy conditions. This suggests a need to balance context length with model capacity to avoid overfitting or loss of resolution.</p>
</div>
<figure class="ltx_table" id="S6.T6">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T6.6.1.1" style="font-size:129%;">Table 6</span>: </span><span class="ltx_text" id="S6.T6.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T6.7.2.1">Informer</span>  Model per Signal Based on RMSE &amp; MAE (Clean Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T6.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T6.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T6.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T6.8.2.1.1"><span class="ltx_text" id="S6.T6.8.2.1.1.1" style="font-size:70%;">2nd Order Polynomial</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.8.2.1.2"><span class="ltx_text" id="S6.T6.8.2.1.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.8.2.1.3"><span class="ltx_text" id="S6.T6.8.2.1.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.8.2.1.4"><span class="ltx_text" id="S6.T6.8.2.1.4.1" style="font-size:70%;">10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.8.2.1.5"><span class="ltx_text" id="S6.T6.8.2.1.5.1" style="font-size:70%;">0.0421</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.8.2.1.6"><span class="ltx_text" id="S6.T6.8.2.1.6.1" style="font-size:70%;">0.0309</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T6.8.3.2.1"><span class="ltx_text" id="S6.T6.8.3.2.1.1" style="font-size:70%;">Cosine + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.3.2.2"><span class="ltx_text" id="S6.T6.8.3.2.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.3.2.3"><span class="ltx_text" id="S6.T6.8.3.2.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.3.2.4"><span class="ltx_text" id="S6.T6.8.3.2.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.3.2.5"><span class="ltx_text" id="S6.T6.8.3.2.5.1" style="font-size:70%;">0.0127</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.3.2.6"><span class="ltx_text" id="S6.T6.8.3.2.6.1" style="font-size:70%;">0.0100</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T6.8.4.3.1"><span class="ltx_text" id="S6.T6.8.4.3.1.1" style="font-size:70%;">CosEnvelope × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.4.3.2"><span class="ltx_text" id="S6.T6.8.4.3.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.4.3.3"><span class="ltx_text" id="S6.T6.8.4.3.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.4.3.4"><span class="ltx_text" id="S6.T6.8.4.3.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.4.3.5"><span class="ltx_text" id="S6.T6.8.4.3.5.1" style="font-size:70%;">0.0068</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.4.3.6"><span class="ltx_text" id="S6.T6.8.4.3.6.1" style="font-size:70%;">0.0052</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T6.8.5.4.1"><span class="ltx_text" id="S6.T6.8.5.4.1.1" style="font-size:70%;">Cubic Polynomial</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.5.4.2"><span class="ltx_text" id="S6.T6.8.5.4.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.5.4.3"><span class="ltx_text" id="S6.T6.8.5.4.3.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.5.4.4"><span class="ltx_text" id="S6.T6.8.5.4.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.5.4.5"><span class="ltx_text" id="S6.T6.8.5.4.5.1" style="font-size:70%;">0.0400</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.5.4.6"><span class="ltx_text" id="S6.T6.8.5.4.6.1" style="font-size:70%;">0.0300</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T6.8.6.5.1"><span class="ltx_text" id="S6.T6.8.6.5.1.1" style="font-size:70%;">Exp. Decay × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.6.5.2"><span class="ltx_text" id="S6.T6.8.6.5.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.6.5.3"><span class="ltx_text" id="S6.T6.8.6.5.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.6.5.4"><span class="ltx_text" id="S6.T6.8.6.5.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.6.5.5"><span class="ltx_text" id="S6.T6.8.6.5.5.1" style="font-size:70%;">0.0002</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.6.5.6"><span class="ltx_text" id="S6.T6.8.6.5.6.1" style="font-size:70%;">0.0001</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T6.8.7.6.1"><span class="ltx_text" id="S6.T6.8.7.6.1.1" style="font-size:70%;">Exponential Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.7.6.2"><span class="ltx_text" id="S6.T6.8.7.6.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.7.6.3"><span class="ltx_text" id="S6.T6.8.7.6.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.7.6.4"><span class="ltx_text" id="S6.T6.8.7.6.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.7.6.5"><span class="ltx_text" id="S6.T6.8.7.6.5.1" style="font-size:70%;">0.0271</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.7.6.6"><span class="ltx_text" id="S6.T6.8.7.6.6.1" style="font-size:70%;">0.0206</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T6.8.8.7.1"><span class="ltx_text" id="S6.T6.8.8.7.1.1" style="font-size:70%;">Gaussian Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.8.7.2"><span class="ltx_text" id="S6.T6.8.8.7.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.8.7.3"><span class="ltx_text" id="S6.T6.8.8.7.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.8.7.4"><span class="ltx_text" id="S6.T6.8.8.7.4.1" style="font-size:70%;">6</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.8.7.5"><span class="ltx_text" id="S6.T6.8.8.7.5.1" style="font-size:70%;">0.0006</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.8.7.6"><span class="ltx_text" id="S6.T6.8.8.7.6.1" style="font-size:70%;">0.0005</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T6.8.9.8.1"><span class="ltx_text" id="S6.T6.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.9.8.2"><span class="ltx_text" id="S6.T6.8.9.8.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.9.8.3"><span class="ltx_text" id="S6.T6.8.9.8.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.9.8.4"><span class="ltx_text" id="S6.T6.8.9.8.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.9.8.5"><span class="ltx_text" id="S6.T6.8.9.8.5.1" style="font-size:70%;">0.0042</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.9.8.6"><span class="ltx_text" id="S6.T6.8.9.8.6.1" style="font-size:70%;">0.0038</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T6.8.10.9.1"><span class="ltx_text" id="S6.T6.8.10.9.1.1" style="font-size:70%;">Long Period Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.10.9.2"><span class="ltx_text" id="S6.T6.8.10.9.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.10.9.3"><span class="ltx_text" id="S6.T6.8.10.9.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.10.9.4"><span class="ltx_text" id="S6.T6.8.10.9.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.10.9.5"><span class="ltx_text" id="S6.T6.8.10.9.5.1" style="font-size:70%;">0.0014</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.8.10.9.6"><span class="ltx_text" id="S6.T6.8.10.9.6.1" style="font-size:70%;">0.0011</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T6.8.11.10.1"><span class="ltx_text" id="S6.T6.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.8.11.10.2"><span class="ltx_text" id="S6.T6.8.11.10.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.8.11.10.3"><span class="ltx_text" id="S6.T6.8.11.10.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.8.11.10.4"><span class="ltx_text" id="S6.T6.8.11.10.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.8.11.10.5"><span class="ltx_text" id="S6.T6.8.11.10.5.1" style="font-size:70%;">0.0011</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.8.11.10.6"><span class="ltx_text" id="S6.T6.8.11.10.6.1" style="font-size:70%;">0.0009</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S6.T7">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T7.6.1.1" style="font-size:129%;">Table 7</span>: </span><span class="ltx_text" id="S6.T7.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T7.7.2.1">Informer</span>  Model per Signal Based on RMSE &amp; MAE (Noisy Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T7.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T7.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T7.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T7.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T7.8.2.1.1"><span class="ltx_text" id="S6.T7.8.2.1.1.1" style="font-size:70%;">2nd Order Polynomial</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.8.2.1.2"><span class="ltx_text" id="S6.T7.8.2.1.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.8.2.1.3"><span class="ltx_text" id="S6.T7.8.2.1.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.8.2.1.4"><span class="ltx_text" id="S6.T7.8.2.1.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.8.2.1.5"><span class="ltx_text" id="S6.T7.8.2.1.5.1" style="font-size:70%;">0.0832</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.8.2.1.6"><span class="ltx_text" id="S6.T7.8.2.1.6.1" style="font-size:70%;">0.0677</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T7.8.3.2.1"><span class="ltx_text" id="S6.T7.8.3.2.1.1" style="font-size:70%;">Cosine + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.3.2.2"><span class="ltx_text" id="S6.T7.8.3.2.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.3.2.3"><span class="ltx_text" id="S6.T7.8.3.2.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.3.2.4"><span class="ltx_text" id="S6.T7.8.3.2.4.1" style="font-size:70%;">10</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.3.2.5"><span class="ltx_text" id="S6.T7.8.3.2.5.1" style="font-size:70%;">0.0172</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.3.2.6"><span class="ltx_text" id="S6.T7.8.3.2.6.1" style="font-size:70%;">0.0132</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T7.8.4.3.1"><span class="ltx_text" id="S6.T7.8.4.3.1.1" style="font-size:70%;">CosEnvelope × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.4.3.2"><span class="ltx_text" id="S6.T7.8.4.3.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.4.3.3"><span class="ltx_text" id="S6.T7.8.4.3.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.4.3.4"><span class="ltx_text" id="S6.T7.8.4.3.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.4.3.5"><span class="ltx_text" id="S6.T7.8.4.3.5.1" style="font-size:70%;">0.0379</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.4.3.6"><span class="ltx_text" id="S6.T7.8.4.3.6.1" style="font-size:70%;">0.0301</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T7.8.5.4.1"><span class="ltx_text" id="S6.T7.8.5.4.1.1" style="font-size:70%;">Cubic Polynomial</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.5.4.2"><span class="ltx_text" id="S6.T7.8.5.4.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.5.4.3"><span class="ltx_text" id="S6.T7.8.5.4.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.5.4.4"><span class="ltx_text" id="S6.T7.8.5.4.4.1" style="font-size:70%;">10</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.5.4.5"><span class="ltx_text" id="S6.T7.8.5.4.5.1" style="font-size:70%;">0.0290</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.5.4.6"><span class="ltx_text" id="S6.T7.8.5.4.6.1" style="font-size:70%;">0.0200</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T7.8.6.5.1"><span class="ltx_text" id="S6.T7.8.6.5.1.1" style="font-size:70%;">Exp. Decay × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.6.5.2"><span class="ltx_text" id="S6.T7.8.6.5.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.6.5.3"><span class="ltx_text" id="S6.T7.8.6.5.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.6.5.4"><span class="ltx_text" id="S6.T7.8.6.5.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.6.5.5"><span class="ltx_text" id="S6.T7.8.6.5.5.1" style="font-size:70%;">0.0448</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.6.5.6"><span class="ltx_text" id="S6.T7.8.6.5.6.1" style="font-size:70%;">0.0343</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T7.8.7.6.1"><span class="ltx_text" id="S6.T7.8.7.6.1.1" style="font-size:70%;">Exponential Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.7.6.2"><span class="ltx_text" id="S6.T7.8.7.6.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.7.6.3"><span class="ltx_text" id="S6.T7.8.7.6.3.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.7.6.4"><span class="ltx_text" id="S6.T7.8.7.6.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.7.6.5"><span class="ltx_text" id="S6.T7.8.7.6.5.1" style="font-size:70%;">0.0597</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.7.6.6"><span class="ltx_text" id="S6.T7.8.7.6.6.1" style="font-size:70%;">0.0453</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T7.8.8.7.1"><span class="ltx_text" id="S6.T7.8.8.7.1.1" style="font-size:70%;">Gaussian Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.8.7.2"><span class="ltx_text" id="S6.T7.8.8.7.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.8.7.3"><span class="ltx_text" id="S6.T7.8.8.7.3.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.8.7.4"><span class="ltx_text" id="S6.T7.8.8.7.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.8.7.5"><span class="ltx_text" id="S6.T7.8.8.7.5.1" style="font-size:70%;">0.0589</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.8.7.6"><span class="ltx_text" id="S6.T7.8.8.7.6.1" style="font-size:70%;">0.0463</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T7.8.9.8.1"><span class="ltx_text" id="S6.T7.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.9.8.2"><span class="ltx_text" id="S6.T7.8.9.8.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.9.8.3"><span class="ltx_text" id="S6.T7.8.9.8.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.9.8.4"><span class="ltx_text" id="S6.T7.8.9.8.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.9.8.5"><span class="ltx_text" id="S6.T7.8.9.8.5.1" style="font-size:70%;">0.0093</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.9.8.6"><span class="ltx_text" id="S6.T7.8.9.8.6.1" style="font-size:70%;">0.0071</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T7.8.10.9.1"><span class="ltx_text" id="S6.T7.8.10.9.1.1" style="font-size:70%;">Long Period Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.10.9.2"><span class="ltx_text" id="S6.T7.8.10.9.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.10.9.3"><span class="ltx_text" id="S6.T7.8.10.9.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.10.9.4"><span class="ltx_text" id="S6.T7.8.10.9.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.10.9.5"><span class="ltx_text" id="S6.T7.8.10.9.5.1" style="font-size:70%;">0.0375</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.8.10.9.6"><span class="ltx_text" id="S6.T7.8.10.9.6.1" style="font-size:70%;">0.0304</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T7.8.11.10.1"><span class="ltx_text" id="S6.T7.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.8.11.10.2"><span class="ltx_text" id="S6.T7.8.11.10.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.8.11.10.3"><span class="ltx_text" id="S6.T7.8.11.10.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.8.11.10.4"><span class="ltx_text" id="S6.T7.8.11.10.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.8.11.10.5"><span class="ltx_text" id="S6.T7.8.11.10.5.1" style="font-size:70%;">0.0368</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.8.11.10.6"><span class="ltx_text" id="S6.T7.8.11.10.6.1" style="font-size:70%;">0.0299</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="465" id="S6.F3.g1" src="x4.png" width="838"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S6.F3.4.2" style="font-size:90%;">Performance of <span class="ltx_text ltx_font_typewriter" id="S6.F3.4.2.1">Informer</span> variants (Minimal, Standard, Full) on various patch lengths and forecast horizons, averaged over all signals.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6 </span>Evaluation of <span class="ltx_text ltx_font_typewriter" id="S6.SS6.1.1">Autoformer</span> Variants under Clean and Noisy Conditions</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">We evaluated three <span class="ltx_text ltx_font_typewriter" id="S6.SS6.p1.1.1">Autoformer</span> variants—Minimal, Standard, and Full—on a collection of ten synthetic time series. Each experiment spans five patch lengths and five forecast horizons, resulting in a total of 750 configurations per setting (<math alttext="3\times 5\times 5\times 10" class="ltx_Math" display="inline" id="S6.SS6.p1.1.m1.1"><semantics id="S6.SS6.p1.1.m1.1a"><mrow id="S6.SS6.p1.1.m1.1.1" xref="S6.SS6.p1.1.m1.1.1.cmml"><mn id="S6.SS6.p1.1.m1.1.1.2" xref="S6.SS6.p1.1.m1.1.1.2.cmml">3</mn><mo id="S6.SS6.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS6.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS6.p1.1.m1.1.1.3" xref="S6.SS6.p1.1.m1.1.1.3.cmml">5</mn><mo id="S6.SS6.p1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS6.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS6.p1.1.m1.1.1.4" xref="S6.SS6.p1.1.m1.1.1.4.cmml">5</mn><mo id="S6.SS6.p1.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S6.SS6.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS6.p1.1.m1.1.1.5" xref="S6.SS6.p1.1.m1.1.1.5.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p1.1.m1.1b"><apply id="S6.SS6.p1.1.m1.1.1.cmml" xref="S6.SS6.p1.1.m1.1.1"><times id="S6.SS6.p1.1.m1.1.1.1.cmml" xref="S6.SS6.p1.1.m1.1.1.1"></times><cn id="S6.SS6.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS6.p1.1.m1.1.1.2">3</cn><cn id="S6.SS6.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS6.p1.1.m1.1.1.3">5</cn><cn id="S6.SS6.p1.1.m1.1.1.4.cmml" type="integer" xref="S6.SS6.p1.1.m1.1.1.4">5</cn><cn id="S6.SS6.p1.1.m1.1.1.5.cmml" type="integer" xref="S6.SS6.p1.1.m1.1.1.5">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p1.1.m1.1c">3\times 5\times 5\times 10</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p1.1.m1.1d">3 × 5 × 5 × 10</annotation></semantics></math>). Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F4" title="Figure 4 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">4</span></a> presents heatmaps of the mean RMSE and MAE values, averaged across all signals, under both clean and noisy conditions. Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T8" title="Table 8 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">8</span></a> highlights the best-performing configuration for each signal under clean conditions, while Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.T9" title="Table 9 ‣ Sensitivity to Patch and Horizon Lengths ‣ 6.6 Evaluation of Autoformer Variants under Clean and Noisy Conditions ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">9</span></a> shows the corresponding results for noisy signals. These tables show the top-performing <span class="ltx_text ltx_font_typewriter" id="S6.SS6.p1.1.2">Autoformer</span> model for each signal type according to RMSE and MAE metrics, emphasizing the best patch length and forecast horizon settings for both clean and noisy signals.</p>
</div>
<section class="ltx_paragraph" id="S6.SS6.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Minimal Variant</h5>
<div class="ltx_para" id="S6.SS6.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS6.SSS0.Px1.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS6.SSS0.Px1.p1.1.1">Autoformer</span> Minimal variant demonstrates strong performance in both clean and noisy environments, with particularly low RMSE and MAE values for clean signals. For clean signals, the best performance is achieved with smaller patch lengths (4 and 8) and shorter forecast horizons (2 and 4). The RMSE values range from 0.0051 to 0.0167, while the MAE values range from 0.0031 to 0.0132, showing that the Minimal variant excels in predicting simple signals with high accuracy at these configurations.</p>
</div>
<div class="ltx_para" id="S6.SS6.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS6.SSS0.Px1.p2.1">In noisy conditions, the Minimal variant exhibits some decline in performance but continues to perform well across a variety of configurations. The RMSE values for noisy signals range from 0.0278 to 0.0562, and the MAE values range from 0.0220 to 0.0457, indicating that it remains relatively robust in noisy scenarios. The best performance in noisy environments is observed at shorter patch lengths (4 and 8) and horizons of 2 and 4.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS6.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Standard Variant</h5>
<div class="ltx_para" id="S6.SS6.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS6.SSS0.Px2.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS6.SSS0.Px2.p1.1.1">Autoformer</span> Standard variant shows consistent and reliable performance across various patch lengths and forecast horizons, with both clean and noisy signals. For clean signals, it achieves its best performance with patch lengths of 4 and 8 and shorter forecast horizons (2 and 4). The RMSE values for clean signals range from 0.0147 to 0.0296, and the MAE values range from 0.0057 to 0.0219, demonstrating its ability to capture the patterns in simpler signals effectively.</p>
</div>
<div class="ltx_para" id="S6.SS6.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS6.SSS0.Px2.p2.1">In noisy environments, the Standard variant experiences a slight degradation in performance, but it still performs relatively well. The RMSE for noisy signals ranges from 0.0335 to 0.0617, and the MAE ranges from 0.0235 to 0.0469. The best results in noisy conditions are typically seen at shorter patch lengths (4 and 8) and shorter forecast horizons (2 and 4), where the model maintains a good balance between accuracy and computational efficiency.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS6.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Full Variant</h5>
<div class="ltx_para" id="S6.SS6.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS6.SSS0.Px3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS6.SSS0.Px3.p1.1.1">Autoformer</span> Full variant shows strong performance, especially in noisy environments, where its ability to model complex patterns comes to the fore. For clean signals, the Full variant performs well across all configurations. The best performance is observed with shorter patch lengths (4 and 8) and forecast horizons of 4 and 8, achieving RMSE values as low as 0.0705 and MAE values around 0.0541. As the patch length and horizon increase, the performance remains stable, although there is a slight increase in RMSE and MAE values.</p>
</div>
<div class="ltx_para" id="S6.SS6.SSS0.Px3.p2">
<p class="ltx_p" id="S6.SS6.SSS0.Px3.p2.1">In noisy conditions, the Full variant still maintains strong performance, though it experiences a noticeable decline compared to clean signals. The RMSE for noisy signals ranges from 0.0793 to 0.1101, and the MAE ranges from 0.0541 to 0.0731. The best performance in noisy conditions is generally seen with shorter patch lengths (4 and 8) and forecast horizons of 2 and 4. Despite the noise, the Full variant continues to capture complex temporal dependencies effectively.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS6.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Sensitivity to Patch and Horizon Lengths</h5>
<div class="ltx_para" id="S6.SS6.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS6.SSS0.Px4.p1.1">Across both clean and noisy conditions, the most accurate forecasts are observed when patch lengths range from 12 to 16. Shorter patches (e.g., length 4) generally lead to underfitting due to insufficient context, while very long patches (e.g. length 20) introduce variability and can degrade performance. Forecast accuracy declines with increasing horizon length across all variants, but this degradation is least severe for the Standard variant. In contrast, the Minimal and Full variants experience sharper performance drops at longer horizons, particularly under noisy conditions.</p>
</div>
<figure class="ltx_table" id="S6.T8">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T8.6.1.1" style="font-size:129%;">Table 8</span>: </span><span class="ltx_text" id="S6.T8.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T8.7.2.1">Autoformer</span>  Model per Signal Based on RMSE &amp; MAE (Clean Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T8.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T8.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T8.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T8.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T8.8.2.1.1"><span class="ltx_text" id="S6.T8.8.2.1.1.1" style="font-size:70%;">2nd Order Polynomial</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.8.2.1.2"><span class="ltx_text" id="S6.T8.8.2.1.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.8.2.1.3"><span class="ltx_text" id="S6.T8.8.2.1.3.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.8.2.1.4"><span class="ltx_text" id="S6.T8.8.2.1.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.8.2.1.5"><span class="ltx_text" id="S6.T8.8.2.1.5.1" style="font-size:70%;">0.0081</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.8.2.1.6"><span class="ltx_text" id="S6.T8.8.2.1.6.1" style="font-size:70%;">0.0064</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T8.8.3.2.1"><span class="ltx_text" id="S6.T8.8.3.2.1.1" style="font-size:70%;">Cosine + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.3.2.2"><span class="ltx_text" id="S6.T8.8.3.2.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.3.2.3"><span class="ltx_text" id="S6.T8.8.3.2.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.3.2.4"><span class="ltx_text" id="S6.T8.8.3.2.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.3.2.5"><span class="ltx_text" id="S6.T8.8.3.2.5.1" style="font-size:70%;">0.0007</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.3.2.6"><span class="ltx_text" id="S6.T8.8.3.2.6.1" style="font-size:70%;">0.0007</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T8.8.4.3.1"><span class="ltx_text" id="S6.T8.8.4.3.1.1" style="font-size:70%;">CosEnvelope × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.4.3.2"><span class="ltx_text" id="S6.T8.8.4.3.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.4.3.3"><span class="ltx_text" id="S6.T8.8.4.3.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.4.3.4"><span class="ltx_text" id="S6.T8.8.4.3.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.4.3.5"><span class="ltx_text" id="S6.T8.8.4.3.5.1" style="font-size:70%;">0.0020</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.4.3.6"><span class="ltx_text" id="S6.T8.8.4.3.6.1" style="font-size:70%;">0.0017</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T8.8.5.4.1"><span class="ltx_text" id="S6.T8.8.5.4.1.1" style="font-size:70%;">Cubic Polynomial</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.5.4.2"><span class="ltx_text" id="S6.T8.8.5.4.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.5.4.3"><span class="ltx_text" id="S6.T8.8.5.4.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.5.4.4"><span class="ltx_text" id="S6.T8.8.5.4.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.5.4.5"><span class="ltx_text" id="S6.T8.8.5.4.5.1" style="font-size:70%;">0.0020</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.5.4.6"><span class="ltx_text" id="S6.T8.8.5.4.6.1" style="font-size:70%;">0.0016</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T8.8.6.5.1"><span class="ltx_text" id="S6.T8.8.6.5.1.1" style="font-size:70%;">Exp. Decay × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.6.5.2"><span class="ltx_text" id="S6.T8.8.6.5.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.6.5.3"><span class="ltx_text" id="S6.T8.8.6.5.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.6.5.4"><span class="ltx_text" id="S6.T8.8.6.5.4.1" style="font-size:70%;">6</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.6.5.5"><span class="ltx_text" id="S6.T8.8.6.5.5.1" style="font-size:70%;">0.0001</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.6.5.6"><span class="ltx_text" id="S6.T8.8.6.5.6.1" style="font-size:70%;">0.0001</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T8.8.7.6.1"><span class="ltx_text" id="S6.T8.8.7.6.1.1" style="font-size:70%;">Exponential Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.7.6.2"><span class="ltx_text" id="S6.T8.8.7.6.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.7.6.3"><span class="ltx_text" id="S6.T8.8.7.6.3.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.7.6.4"><span class="ltx_text" id="S6.T8.8.7.6.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.7.6.5"><span class="ltx_text" id="S6.T8.8.7.6.5.1" style="font-size:70%;">0.0001</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.7.6.6"><span class="ltx_text" id="S6.T8.8.7.6.6.1" style="font-size:70%;">0.0001</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T8.8.8.7.1"><span class="ltx_text" id="S6.T8.8.8.7.1.1" style="font-size:70%;">Gaussian Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.8.7.2"><span class="ltx_text" id="S6.T8.8.8.7.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.8.7.3"><span class="ltx_text" id="S6.T8.8.8.7.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.8.7.4"><span class="ltx_text" id="S6.T8.8.8.7.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.8.7.5"><span class="ltx_text" id="S6.T8.8.8.7.5.1" style="font-size:70%;">0.0002</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.8.7.6"><span class="ltx_text" id="S6.T8.8.8.7.6.1" style="font-size:70%;">0.0002</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T8.8.9.8.1"><span class="ltx_text" id="S6.T8.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.9.8.2"><span class="ltx_text" id="S6.T8.8.9.8.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.9.8.3"><span class="ltx_text" id="S6.T8.8.9.8.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.9.8.4"><span class="ltx_text" id="S6.T8.8.9.8.4.1" style="font-size:70%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.9.8.5"><span class="ltx_text" id="S6.T8.8.9.8.5.1" style="font-size:70%;">0.0022</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.9.8.6"><span class="ltx_text" id="S6.T8.8.9.8.6.1" style="font-size:70%;">0.0020</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T8.8.10.9.1"><span class="ltx_text" id="S6.T8.8.10.9.1.1" style="font-size:70%;">Long Period Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.10.9.2"><span class="ltx_text" id="S6.T8.8.10.9.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.10.9.3"><span class="ltx_text" id="S6.T8.8.10.9.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.10.9.4"><span class="ltx_text" id="S6.T8.8.10.9.4.1" style="font-size:70%;">10</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.10.9.5"><span class="ltx_text" id="S6.T8.8.10.9.5.1" style="font-size:70%;">0.0005</span></td>
<td class="ltx_td ltx_align_center" id="S6.T8.8.10.9.6"><span class="ltx_text" id="S6.T8.8.10.9.6.1" style="font-size:70%;">0.0004</span></td>
</tr>
<tr class="ltx_tr" id="S6.T8.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T8.8.11.10.1"><span class="ltx_text" id="S6.T8.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.8.11.10.2"><span class="ltx_text" id="S6.T8.8.11.10.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.8.11.10.3"><span class="ltx_text" id="S6.T8.8.11.10.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.8.11.10.4"><span class="ltx_text" id="S6.T8.8.11.10.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.8.11.10.5"><span class="ltx_text" id="S6.T8.8.11.10.5.1" style="font-size:70%;">0.0004</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.8.11.10.6"><span class="ltx_text" id="S6.T8.8.11.10.6.1" style="font-size:70%;">0.0003</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S6.T9">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T9.6.1.1" style="font-size:129%;">Table 9</span>: </span><span class="ltx_text" id="S6.T9.7.2" style="font-size:129%;">Best <span class="ltx_text ltx_font_typewriter" id="S6.T9.7.2.1">Autoformer</span> Model per Signal based on RMSE &amp; MAE (Noisy Signals)</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T9.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T9.8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.1.1" style="font-size:70%;">Signal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.2.1" style="font-size:70%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.3.1" style="font-size:70%;">Patch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.4.1" style="font-size:70%;">Horizon</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.5.1" style="font-size:70%;">RMSE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.8.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T9.8.1.1.6.1" style="font-size:70%;">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T9.8.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T9.8.2.1.1"><span class="ltx_text" id="S6.T9.8.2.1.1.1" style="font-size:70%;">2nd Order Polynomial</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.8.2.1.2"><span class="ltx_text" id="S6.T9.8.2.1.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.8.2.1.3"><span class="ltx_text" id="S6.T9.8.2.1.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.8.2.1.4"><span class="ltx_text" id="S6.T9.8.2.1.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.8.2.1.5"><span class="ltx_text" id="S6.T9.8.2.1.5.1" style="font-size:70%;">0.0064</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.8.2.1.6"><span class="ltx_text" id="S6.T9.8.2.1.6.1" style="font-size:70%;">0.0052</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.3.2">
<td class="ltx_td ltx_align_left" id="S6.T9.8.3.2.1"><span class="ltx_text" id="S6.T9.8.3.2.1.1" style="font-size:70%;">Cosine + Trend</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.3.2.2"><span class="ltx_text" id="S6.T9.8.3.2.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.3.2.3"><span class="ltx_text" id="S6.T9.8.3.2.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.3.2.4"><span class="ltx_text" id="S6.T9.8.3.2.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.3.2.5"><span class="ltx_text" id="S6.T9.8.3.2.5.1" style="font-size:70%;">0.0138</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.3.2.6"><span class="ltx_text" id="S6.T9.8.3.2.6.1" style="font-size:70%;">0.0105</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.4.3">
<td class="ltx_td ltx_align_left" id="S6.T9.8.4.3.1"><span class="ltx_text" id="S6.T9.8.4.3.1.1" style="font-size:70%;">CosEnvelope × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.4.3.2"><span class="ltx_text" id="S6.T9.8.4.3.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.4.3.3"><span class="ltx_text" id="S6.T9.8.4.3.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.4.3.4"><span class="ltx_text" id="S6.T9.8.4.3.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.4.3.5"><span class="ltx_text" id="S6.T9.8.4.3.5.1" style="font-size:70%;">0.0392</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.4.3.6"><span class="ltx_text" id="S6.T9.8.4.3.6.1" style="font-size:70%;">0.0314</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.5.4">
<td class="ltx_td ltx_align_left" id="S6.T9.8.5.4.1"><span class="ltx_text" id="S6.T9.8.5.4.1.1" style="font-size:70%;">Cubic Polynomial</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.5.4.2"><span class="ltx_text" id="S6.T9.8.5.4.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.5.4.3"><span class="ltx_text" id="S6.T9.8.5.4.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.5.4.4"><span class="ltx_text" id="S6.T9.8.5.4.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.5.4.5"><span class="ltx_text" id="S6.T9.8.5.4.5.1" style="font-size:70%;">0.0033</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.5.4.6"><span class="ltx_text" id="S6.T9.8.5.4.6.1" style="font-size:70%;">0.0027</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.6.5">
<td class="ltx_td ltx_align_left" id="S6.T9.8.6.5.1"><span class="ltx_text" id="S6.T9.8.6.5.1.1" style="font-size:70%;">Exp. Decay × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.6.5.2"><span class="ltx_text" id="S6.T9.8.6.5.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.6.5.3"><span class="ltx_text" id="S6.T9.8.6.5.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.6.5.4"><span class="ltx_text" id="S6.T9.8.6.5.4.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.6.5.5"><span class="ltx_text" id="S6.T9.8.6.5.5.1" style="font-size:70%;">0.0444</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.6.5.6"><span class="ltx_text" id="S6.T9.8.6.5.6.1" style="font-size:70%;">0.0354</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.7.6">
<td class="ltx_td ltx_align_left" id="S6.T9.8.7.6.1"><span class="ltx_text" id="S6.T9.8.7.6.1.1" style="font-size:70%;">Exponential Growth</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.7.6.2"><span class="ltx_text" id="S6.T9.8.7.6.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.7.6.3"><span class="ltx_text" id="S6.T9.8.7.6.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.7.6.4"><span class="ltx_text" id="S6.T9.8.7.6.4.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.7.6.5"><span class="ltx_text" id="S6.T9.8.7.6.5.1" style="font-size:70%;">0.0072</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.7.6.6"><span class="ltx_text" id="S6.T9.8.7.6.6.1" style="font-size:70%;">0.0057</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.8.7">
<td class="ltx_td ltx_align_left" id="S6.T9.8.8.7.1"><span class="ltx_text" id="S6.T9.8.8.7.1.1" style="font-size:70%;">Gaussian Bump</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.8.7.2"><span class="ltx_text" id="S6.T9.8.8.7.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.8.7.3"><span class="ltx_text" id="S6.T9.8.8.7.3.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.8.7.4"><span class="ltx_text" id="S6.T9.8.8.7.4.1" style="font-size:70%;">12</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.8.7.5"><span class="ltx_text" id="S6.T9.8.8.7.5.1" style="font-size:70%;">0.0591</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.8.7.6"><span class="ltx_text" id="S6.T9.8.8.7.6.1" style="font-size:70%;">0.0482</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.9.8">
<td class="ltx_td ltx_align_left" id="S6.T9.8.9.8.1"><span class="ltx_text" id="S6.T9.8.9.8.1.1" style="font-size:70%;">Log × Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.9.8.2"><span class="ltx_text" id="S6.T9.8.9.8.2.1" style="font-size:70%;">Minimal</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.9.8.3"><span class="ltx_text" id="S6.T9.8.9.8.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.9.8.4"><span class="ltx_text" id="S6.T9.8.9.8.4.1" style="font-size:70%;">8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.9.8.5"><span class="ltx_text" id="S6.T9.8.9.8.5.1" style="font-size:70%;">0.0074</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.9.8.6"><span class="ltx_text" id="S6.T9.8.9.8.6.1" style="font-size:70%;">0.0059</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.10.9">
<td class="ltx_td ltx_align_left" id="S6.T9.8.10.9.1"><span class="ltx_text" id="S6.T9.8.10.9.1.1" style="font-size:70%;">Long Period Sine</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.10.9.2"><span class="ltx_text" id="S6.T9.8.10.9.2.1" style="font-size:70%;">Full</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.10.9.3"><span class="ltx_text" id="S6.T9.8.10.9.3.1" style="font-size:70%;">16</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.10.9.4"><span class="ltx_text" id="S6.T9.8.10.9.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.10.9.5"><span class="ltx_text" id="S6.T9.8.10.9.5.1" style="font-size:70%;">0.0367</span></td>
<td class="ltx_td ltx_align_center" id="S6.T9.8.10.9.6"><span class="ltx_text" id="S6.T9.8.10.9.6.1" style="font-size:70%;">0.0285</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.8.11.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T9.8.11.10.1"><span class="ltx_text" id="S6.T9.8.11.10.1.1" style="font-size:70%;">Sine</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.8.11.10.2"><span class="ltx_text" id="S6.T9.8.11.10.2.1" style="font-size:70%;">Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.8.11.10.3"><span class="ltx_text" id="S6.T9.8.11.10.3.1" style="font-size:70%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.8.11.10.4"><span class="ltx_text" id="S6.T9.8.11.10.4.1" style="font-size:70%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.8.11.10.5"><span class="ltx_text" id="S6.T9.8.11.10.5.1" style="font-size:70%;">0.0358</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.8.11.10.6"><span class="ltx_text" id="S6.T9.8.11.10.6.1" style="font-size:70%;">0.0294</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="466" id="S6.F4.g1" src="x5.png" width="838"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.3.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S6.F4.4.2" style="font-size:90%;">Performance of <span class="ltx_text ltx_font_typewriter" id="S6.F4.4.2.1">Autoformer</span> variants (Minimal, Standard, Full) on various patch lengths and forecast horizons, averaged over all signals.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.7 </span>Cross-Family Model Comparison for Clean Signals</h3>
<div class="ltx_para" id="S6.SS7.p1">
<p class="ltx_p" id="S6.SS7.p1.1">To evaluate overall forecasting performance, we computed the average RMSE and MAE for all model variants within each architecture family—<span class="ltx_text ltx_font_typewriter" id="S6.SS7.p1.1.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S6.SS7.p1.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.SS7.p1.1.3">PatchTST</span>. Scores were averaged across five patch lengths and five forecast horizons on ten synthetic signals, resulting in a comprehensive performance profile for each family. The aggregated results are visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F5" title="Figure 5 ‣ Patch and Horizon Sensitivity ‣ 6.7 Cross-Family Model Comparison for Clean Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">5</span></a>, which presents RMSE and MAE heatmaps averaged over all experiments. These plots reveal general performance trends across the full hyperparameter grid.</p>
</div>
<section class="ltx_paragraph" id="S6.SS7.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px1.1.1">Autoformer</span> Family</h5>
<div class="ltx_para" id="S6.SS7.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS7.SSS0.Px1.p1.2">The <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px1.p1.2.1">Autoformer</span> variants achieve the lowest average RMSE and MAE across nearly all configurations. This strong performance is largely attributed to the built-in trend-seasonal decomposition, which enables the model to separate long-term structure from short-term variation. RMSE values remain consistently below 0.045, with the best results observed at shorter forecast horizons (e.g., <math alttext="H=2" class="ltx_Math" display="inline" id="S6.SS7.SSS0.Px1.p1.1.m1.1"><semantics id="S6.SS7.SSS0.Px1.p1.1.m1.1a"><mrow id="S6.SS7.SSS0.Px1.p1.1.m1.1.1" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.2" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml">H</mi><mo id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.1" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.3" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS7.SSS0.Px1.p1.1.m1.1b"><apply id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1"><eq id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.2">𝐻</ci><cn id="S6.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS7.SSS0.Px1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.SSS0.Px1.p1.1.m1.1c">H=2</annotation><annotation encoding="application/x-llamapun" id="S6.SS7.SSS0.Px1.p1.1.m1.1d">italic_H = 2</annotation></semantics></math> and <math alttext="H=4" class="ltx_Math" display="inline" id="S6.SS7.SSS0.Px1.p1.2.m2.1"><semantics id="S6.SS7.SSS0.Px1.p1.2.m2.1a"><mrow id="S6.SS7.SSS0.Px1.p1.2.m2.1.1" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.2" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.2.cmml">H</mi><mo id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.1" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.3" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS7.SSS0.Px1.p1.2.m2.1b"><apply id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1"><eq id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.2">𝐻</ci><cn id="S6.SS7.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS7.SSS0.Px1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.SSS0.Px1.p1.2.m2.1c">H=4</annotation><annotation encoding="application/x-llamapun" id="S6.SS7.SSS0.Px1.p1.2.m2.1d">italic_H = 4</annotation></semantics></math>) and patch lengths between 12 and 20. Similarly, MAE values stay below 0.027 across the grid. The low variance in error across both patch and horizon dimensions highlights the model’s stability and reliability in structured, low-noise environments.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS7.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px2.1.1">PatchTST</span> Family</h5>
<div class="ltx_para" id="S6.SS7.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS7.SSS0.Px2.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px2.p1.1.1">PatchTST</span> family performs nearly as well as <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px2.p1.1.2">Autoformer</span>, consistently ranking second in both RMSE and MAE. The patch-based representation allows the model to capture localized temporal patterns efficiently, while Transformer encoders model inter-patch dependencies. RMSE values mostly fall below 0.04, and MAE remains under 0.03 across most settings. The best performance is observed with patch lengths between 12 and 16. Notably, <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px2.p1.1.3">PatchTST</span> shows minimal degradation as forecast horizons increase, suggesting that its hybrid design balances complexity and generalization effectively. This makes it a robust and flexible choice, particularly for medium-term forecasting tasks.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS7.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px3.1.1">Informer</span> Family</h5>
<div class="ltx_para" id="S6.SS7.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS7.SSS0.Px3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px3.p1.1.1">Informer</span> models perform less consistently than the other two families. RMSE values range from approximately 0.043 to 0.096, and MAE reaches up to 0.076, especially at longer horizons (<math alttext="H=8,10" class="ltx_Math" display="inline" id="S6.SS7.SSS0.Px3.p1.1.m1.2"><semantics id="S6.SS7.SSS0.Px3.p1.1.m1.2a"><mrow id="S6.SS7.SSS0.Px3.p1.1.m1.2.3" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.cmml"><mi id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.2" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.2.cmml">H</mi><mo id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.1" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.2" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.1.cmml"><mn id="S6.SS7.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS7.SSS0.Px3.p1.1.m1.1.1.cmml">8</mn><mo id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.2.1" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S6.SS7.SSS0.Px3.p1.1.m1.2.2" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.2.cmml">10</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS7.SSS0.Px3.p1.1.m1.2b"><apply id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.cmml" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3"><eq id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.1"></eq><ci id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.2.cmml" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.2">𝐻</ci><list id="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.1.cmml" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.3.3.2"><cn id="S6.SS7.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS7.SSS0.Px3.p1.1.m1.1.1">8</cn><cn id="S6.SS7.SSS0.Px3.p1.1.m1.2.2.cmml" type="integer" xref="S6.SS7.SSS0.Px3.p1.1.m1.2.2">10</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.SSS0.Px3.p1.1.m1.2c">H=8,10</annotation><annotation encoding="application/x-llamapun" id="S6.SS7.SSS0.Px3.p1.1.m1.2d">italic_H = 8 , 10</annotation></semantics></math>) and shorter patch lengths. Although the ProbSparse attention mechanism improves computational efficiency, it appears less effective in capturing the precise long-term dependencies needed for clean, synthetic signals. The performance heatmaps show greater variability compared to <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px3.p1.1.2">Autoformer</span> and <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px3.p1.1.3">PatchTST</span>, with noticeable drops in accuracy when the context window is too short or the forecast horizon is long. These results suggest that <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px3.p1.1.4">Informer</span> may be better suited to more complex or noisy real-world datasets where full attention becomes computationally prohibitive.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS7.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Patch and Horizon Sensitivity</h5>
<div class="ltx_para" id="S6.SS7.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS7.SSS0.Px4.p1.2">All three model families exhibit sensitivity to patch size and forecast horizon. The most accurate forecasts are consistently obtained at short horizons (typically <math alttext="H=2" class="ltx_Math" display="inline" id="S6.SS7.SSS0.Px4.p1.1.m1.1"><semantics id="S6.SS7.SSS0.Px4.p1.1.m1.1a"><mrow id="S6.SS7.SSS0.Px4.p1.1.m1.1.1" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.2" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.2.cmml">H</mi><mo id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.1" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.3" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS7.SSS0.Px4.p1.1.m1.1b"><apply id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1"><eq id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.1"></eq><ci id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.2">𝐻</ci><cn id="S6.SS7.SSS0.Px4.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS7.SSS0.Px4.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.SSS0.Px4.p1.1.m1.1c">H=2</annotation><annotation encoding="application/x-llamapun" id="S6.SS7.SSS0.Px4.p1.1.m1.1d">italic_H = 2</annotation></semantics></math> or <math alttext="H=4" class="ltx_Math" display="inline" id="S6.SS7.SSS0.Px4.p1.2.m2.1"><semantics id="S6.SS7.SSS0.Px4.p1.2.m2.1a"><mrow id="S6.SS7.SSS0.Px4.p1.2.m2.1.1" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.2" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.2.cmml">H</mi><mo id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.1" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.3" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS7.SSS0.Px4.p1.2.m2.1b"><apply id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1"><eq id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.1"></eq><ci id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.2">𝐻</ci><cn id="S6.SS7.SSS0.Px4.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS7.SSS0.Px4.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.SSS0.Px4.p1.2.m2.1c">H=4</annotation><annotation encoding="application/x-llamapun" id="S6.SS7.SSS0.Px4.p1.2.m2.1d">italic_H = 4</annotation></semantics></math>) and patch lengths between 8 and 16. Beyond this range, performance gains taper off, and in some cases, model accuracy degrades due to overfitting or insufficient long-term modeling capacity. While both <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p1.2.1">Autoformer</span> and <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p1.2.2">PatchTST</span> remain relatively stable across varying configurations, <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p1.2.3">Informer</span> shows greater performance fluctuations, especially in the presence of short patches and extended horizons.</p>
</div>
<div class="ltx_para" id="S6.SS7.SSS0.Px4.p2">
<p class="ltx_p" id="S6.SS7.SSS0.Px4.p2.1">The comparative results show that <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p2.1.1">Autoformer</span> achieves the best overall forecasting performance across synthetic signals, benefiting from its decomposition-based inductive bias. <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p2.1.2">PatchTST</span> offers a strong alternative with nearly comparable accuracy, combined with a simpler and more training-efficient architecture. In contrast, <span class="ltx_text ltx_font_typewriter" id="S6.SS7.SSS0.Px4.p2.1.3">Informer</span> performs less reliably in this controlled, low-noise setting, likely due to its sparse attention mechanism being less effective for smooth, periodic, or trend-dominated signals. These findings emphasize the importance of selecting a model architecture that aligns with the underlying signal characteristics, including noise level, temporal structure, and desired forecast horizon.</p>
</div>
<figure class="ltx_figure" id="S6.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="520" id="S6.F5.g1" src="x6.png" width="539"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F5.9.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S6.F5.10.2" style="font-size:90%;">Aggregated RMSE and MAE heatmaps compare <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.3">PatchTST</span> across 10 synthetic signals, 5 patch lengths, and 5 forecast horizons. <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.4">Autoformer</span> leads overall, aided by trend-seasonal decomposition. <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.5">PatchTST</span> performs competitively, often matching or beating <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.6">Autoformer</span> in MAE. <span class="ltx_text ltx_font_typewriter" id="S6.F5.10.2.7">Informer</span> shows higher errors, especially at longer horizons. Global color normalization ensures fair comparison.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.8 </span>Cross-Family Model Comparison for Noisy Signals</h3>
<div class="ltx_para" id="S6.SS8.p1">
<p class="ltx_p" id="S6.SS8.p1.1">To evaluate overall forecasting performance under noisy conditions, we computed the average RMSE and MAE for all model variants within each architecture family—<span class="ltx_text ltx_font_typewriter" id="S6.SS8.p1.1.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S6.SS8.p1.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.SS8.p1.1.3">PatchTST</span>. Each model was assessed across five patch lengths and five forecast horizons for ten synthetic signals. The resulting heatmaps, shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S6.F6" title="Figure 6 ‣ Patch and Horizon Sensitivity ‣ 6.8 Cross-Family Model Comparison for Noisy Signals ‣ 6 Numerical Simulations ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">6</span></a>, summarize the mean forecasting error of each model family across the full hyperparameter grid in the presence of input noise.</p>
</div>
<section class="ltx_paragraph" id="S6.SS8.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px1.1.1">Autoformer</span> Family</h5>
<div class="ltx_para" id="S6.SS8.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS8.SSS0.Px1.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px1.p1.1.1">Autoformer</span> family remains the most accurate under noisy conditions. RMSE values range from 0.046 to 0.076 across all patch and horizon combinations, while MAE values fall between 0.038 and 0.059. The model’s trend-seasonal decomposition continues to be effective, allowing it to filter out high-frequency noise and maintain predictive stability. Best results are observed for shorter forecast horizons (4 to 8 steps) and patch lengths between 12 and 20, where the model achieves an optimal balance between temporal context and noise resilience.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS8.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px2.1.1">PatchTST</span> Family</h5>
<div class="ltx_para" id="S6.SS8.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS8.SSS0.Px2.p1.2">The <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px2.p1.2.1">PatchTST</span> family also performs well in noisy environments, with RMSE values generally below 0.07 and MAE under 0.058 in most settings. Its patch-based attention mechanism allows for effective modeling of local patterns, even when noise partially obscures signal features. Although there is a slight increase in error at longer horizons—particularly for <math alttext="H=16" class="ltx_Math" display="inline" id="S6.SS8.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS8.SSS0.Px2.p1.1.m1.1a"><mrow id="S6.SS8.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.2" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.2.cmml">H</mi><mo id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.1" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.3" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS8.SSS0.Px2.p1.1.m1.1b"><apply id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1"><eq id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.2">𝐻</ci><cn id="S6.SS8.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS8.SSS0.Px2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS8.SSS0.Px2.p1.1.m1.1c">H=16</annotation><annotation encoding="application/x-llamapun" id="S6.SS8.SSS0.Px2.p1.1.m1.1d">italic_H = 16</annotation></semantics></math> and <math alttext="H=20" class="ltx_Math" display="inline" id="S6.SS8.SSS0.Px2.p1.2.m2.1"><semantics id="S6.SS8.SSS0.Px2.p1.2.m2.1a"><mrow id="S6.SS8.SSS0.Px2.p1.2.m2.1.1" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.2" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.2.cmml">H</mi><mo id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.1" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.3" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS8.SSS0.Px2.p1.2.m2.1b"><apply id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1"><eq id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.1"></eq><ci id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.2">𝐻</ci><cn id="S6.SS8.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS8.SSS0.Px2.p1.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS8.SSS0.Px2.p1.2.m2.1c">H=20</annotation><annotation encoding="application/x-llamapun" id="S6.SS8.SSS0.Px2.p1.2.m2.1d">italic_H = 20</annotation></semantics></math>—the model maintains relatively stable performance across different patch lengths. This consistency makes <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px2.p1.2.2">PatchTST</span> a strong candidate for practical applications where robustness, efficiency, and training simplicity are key considerations.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS8.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px3.1.1">Informer</span> Family</h5>
<div class="ltx_para" id="S6.SS8.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS8.SSS0.Px3.p1.1">The <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px3.p1.1.1">Informer</span> family experiences the largest decline in performance under noisy input. RMSE values reach up to 0.10 in several configurations, and MAE exceeds 0.06 consistently, peaking at 0.077 for long horizons and small patch lengths. These results indicate that the ProbSparse attention mechanism may struggle in noisy settings, where the approximation can omit important temporal dependencies. The heatmaps show high sensitivity to both patch length and horizon size, especially for configurations involving short patches and long-term predictions. This suggests that <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px3.p1.1.2">Informer</span> is less suited for forecasting tasks involving corrupted or noisy signals.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS8.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Patch and Horizon Sensitivity</h5>
<div class="ltx_para" id="S6.SS8.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS8.SSS0.Px4.p1.1">All three model families exhibit increased sensitivity to patch length and forecasting horizon when noise is present. The most reliable performance is achieved with patch lengths between 12 and 20 and forecast horizons ranging from 4 to 8. At shorter patch lengths, all models underperform due to limited contextual information. As the forecast horizon increases, error generally rises across all models; however, <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px4.p1.1.1">Autoformer</span> shows the smallest degradation, likely due to its decomposition mechanism. In contrast, <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px4.p1.1.2">Informer</span> shows steep declines in accuracy with increasing horizon length, particularly when paired with short patches.</p>
</div>
<div class="ltx_para" id="S6.SS8.SSS0.Px4.p2">
<p class="ltx_p" id="S6.SS8.SSS0.Px4.p2.1">In noisy forecasting scenarios, <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px4.p2.1.1">Autoformer</span> continues to offer the most accurate and stable performance. Its built-in trend-seasonal decomposition provides a strong inductive bias that helps isolate relevant patterns from noise. <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px4.p2.1.2">PatchTST</span> also performs well, showing reliable generalization across a variety of conditions and offering a computationally efficient alternative. The <span class="ltx_text ltx_font_typewriter" id="S6.SS8.SSS0.Px4.p2.1.3">Informer</span> architecture, while fast and scalable, demonstrates greater vulnerability to noise, with larger prediction errors and less stable behavior across hyperparameter configurations. These findings emphasize the importance of architectural choices when working with noisy time series, highlighting the benefits of decomposition-based and locality-aware models.</p>
</div>
<figure class="ltx_figure" id="S6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="516" id="S6.F6.g1" src="x7.png" width="539"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F6.9.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S6.F6.10.2" style="font-size:90%;">Aggregated RMSE and MAE heatmaps (averaged over model variants and noisy signals) compare <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.3">PatchTST</span> across patch lengths and horizons. <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.4">Autoformer</span> remains robust under noise, aided by decomposition. <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.5">PatchTST</span> performs comparably, often matching or slightly outperforming <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.6">Autoformer</span> in MAE at longer horizons. <span class="ltx_text ltx_font_typewriter" id="S6.F6.10.2.7">Informer</span> shows higher errors, highlighting reduced noise robustness. Color scales are globally normalized for fair comparison.</span></figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Outlook: Toward Koopman-Enhanced Transformer Architectures</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">The <span class="ltx_text ltx_font_italic" id="S7.p1.1.1">Koopman operator</span> provides a powerful, operator-theoretic framework to analyze nonlinear dynamical systems through the lens of linear dynamics in infinite-dimensional spaces. This operator acts on the space of observable functions, evolving them forward in time according to the system dynamics rather than directly propagating the states themselves <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib30" title="">30</a>]</cite>. This remarkable property enables the use of linear analysis techniques, even when the underlying system is nonlinear and potentially chaotic. Recent developments have revitalized interest in Koopman theory, particularly through data-driven methods such as Dynamic Mode Decomposition (DMD), which offer practical means to approximate the operator from measurements and facilitate modal analysis, prediction, and control in complex systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">While Koopman-based methods have traditionally been applied to deterministic systems governed by ordinary or partial differential equations—such as fluid dynamics, robotics, and chaotic systems—they are increasingly being explored for data-driven forecasting. Prior works such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib34" title="">34</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#bib.bib35" title="">35</a>]</cite> demonstrated how deep networks can be used to approximate Koopman-invariant subspaces, enabling stable rollout predictions over time. However, most of these studies focus on dynamical reconstruction or control, rather than general-purpose time series forecasting.</p>
</div>
<div class="ltx_para" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">Our approach bridges this gap by combining Koopman operator learning with Transformer-based sequence models, such as <span class="ltx_text ltx_font_typewriter" id="S7.p3.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S7.p3.1.2">Autoformer</span>, and <span class="ltx_text ltx_font_typewriter" id="S7.p3.1.3">Informer</span>. We use a Transformer encoder to extract temporally-aware latent representations from input time series patches, and then apply a constrained Koopman operator in the latent space to evolve the system forward. The operator is spectrally regularized to ensure stability, and the decoder projects the evolved latent states back into the original observable space. While classical forecasting methods treat time series as stochastic sequences with limited structural assumptions, our hybrid framework explicitly enforces a structured latent dynamic, making it well-suited for forecasting systems that arise from physical or biological processes. To the best of our knowledge, this work is among the first to integrate Koopman theory with Transformer-based backbones for robust, interpretable multi-step forecasting.</p>
</div>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Future Directions for Transformer-based Forecasting</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">This article has already systematically benchmarked, analyzed, and proposed different variants for Transformer-based forecasting models, namely <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.3">Autoformer</span>, across a wide range of synthetic signals and forecast settings. These models have demonstrated distinct advantages depending on signal characteristics, forecast horizons, and noise levels. However, all architectures primarily rely on direct autoregressive or encoder-decoder mechanisms, which, while effective, do not explicitly exploit the potential benefits of modeling system dynamics in latent linear spaces. Variants such as <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.4">Informer</span>, <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.5">Autoformer</span>, and <span class="ltx_text ltx_font_typewriter" id="S7.SS1.p1.1.6">PatchTST</span> are designed to address specific challenges like long-range dependencies, non-stationarity, and local pattern extraction. However, when modeling dynamical systems, such as oscillators or physical processes, simple prediction accuracy is not enough. These systems obey inherent physical principles, often expressed via: Stability properties (bounded energy, no explosion in latent space), Latent linear dynamics, Consistency over long horizons.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Deep Koopformer: Stability-Constrained Transformer-Koopman Framework</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">An important direction for advancing time series forecasting lies in extending Transformer-based models—such as <span class="ltx_text ltx_font_typewriter" id="S7.SS2.p1.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S7.SS2.p1.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S7.SS2.p1.1.3">Autoformer</span>—by integrating them with principled representations of dynamical systems. To this end, we propose <em class="ltx_emph ltx_font_italic" id="S7.SS2.p1.1.4">Deep Koopformer</em>, a hybrid framework that couples Transformer-based encoders with a stability-constrained Koopman operator. This design enables accurate forecasting while ensuring stable and interpretable latent dynamics, particularly for nonlinear or oscillatory systems.</p>
</div>
<div class="ltx_para" id="S7.SS2.p2">
<p class="ltx_p" id="S7.SS2.p2.1">The Koopman operator, a linear transformation acting on a lifted latent space, provides a natural bridge between deep sequence modeling and dynamical systems theory. By embedding the input sequence into a latent representation via a Transformer, and propagating this representation linearly through a parameterized Koopman operator, the Deep Koopformer enforces structured, stable latent evolution. This approach retains the flexibility of Transformers while introducing a physically motivated inductive bias into the temporal modeling process.</p>
</div>
<div class="ltx_para" id="S7.SS2.p3">
<p class="ltx_p" id="S7.SS2.p3.1">Traditional Transformer architectures, when optimized solely for short-term prediction accuracy, exhibit several well-known limitations:</p>
<ul class="ltx_itemize" id="S7.I1">
<li class="ltx_item" id="S7.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i1.p1">
<p class="ltx_p" id="S7.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.i1.p1.1.1">Unstable latent dynamics:</span> Without explicit constraints, latent states may grow unbounded or collapse, leading to numerical instability.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i2.p1">
<p class="ltx_p" id="S7.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.i2.p1.1.1">Forecast divergence:</span> Iterative rollouts amplify errors, especially in complex dynamical systems with sensitive dependence on initial conditions.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i3.p1">
<p class="ltx_p" id="S7.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.i3.p1.1.1">Opaque latent space:</span> The lack of structure in the latent representation hinders interpretability and limits reliability in real-world settings.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS2.p4">
<p class="ltx_p" id="S7.SS2.p4.1">By incorporating both <span class="ltx_text ltx_font_italic" id="S7.SS2.p4.1.1">spectral stability constraints</span> on the Koopman operator and a <span class="ltx_text ltx_font_italic" id="S7.SS2.p4.1.2">Lyapunov-inspired regularization</span> to penalize energy growth in latent space, Deep Koopformer directly addresses these challenges. The resulting model exhibits improved robustness, generalization, and alignment with the qualitative behavior of the underlying dynamical processes.</p>
</div>
<div class="ltx_para" id="S7.SS2.p5">
<p class="ltx_p" id="S7.SS2.p5.1">In the following section we detail different parts of the Deep Koopformer.</p>
</div>
<section class="ltx_subsubsection" id="S7.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.1 </span>Input-to-Output Transformation in Deep Koopformer</h4>
<div class="ltx_para" id="S7.SS2.SSS1.p1">
<p class="ltx_p" id="S7.SS2.SSS1.p1.1">The input consists of a sequence of observations:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="x_{t}\in\mathbb{R}^{d}," class="ltx_Math" display="block" id="S7.Ex33.m1.1"><semantics id="S7.Ex33.m1.1a"><mrow id="S7.Ex33.m1.1.1.1" xref="S7.Ex33.m1.1.1.1.1.cmml"><mrow id="S7.Ex33.m1.1.1.1.1" xref="S7.Ex33.m1.1.1.1.1.cmml"><msub id="S7.Ex33.m1.1.1.1.1.2" xref="S7.Ex33.m1.1.1.1.1.2.cmml"><mi id="S7.Ex33.m1.1.1.1.1.2.2" xref="S7.Ex33.m1.1.1.1.1.2.2.cmml">x</mi><mi id="S7.Ex33.m1.1.1.1.1.2.3" xref="S7.Ex33.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S7.Ex33.m1.1.1.1.1.1" xref="S7.Ex33.m1.1.1.1.1.1.cmml">∈</mo><msup id="S7.Ex33.m1.1.1.1.1.3" xref="S7.Ex33.m1.1.1.1.1.3.cmml"><mi id="S7.Ex33.m1.1.1.1.1.3.2" xref="S7.Ex33.m1.1.1.1.1.3.2.cmml">ℝ</mi><mi id="S7.Ex33.m1.1.1.1.1.3.3" xref="S7.Ex33.m1.1.1.1.1.3.3.cmml">d</mi></msup></mrow><mo id="S7.Ex33.m1.1.1.1.2" xref="S7.Ex33.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex33.m1.1b"><apply id="S7.Ex33.m1.1.1.1.1.cmml" xref="S7.Ex33.m1.1.1.1"><in id="S7.Ex33.m1.1.1.1.1.1.cmml" xref="S7.Ex33.m1.1.1.1.1.1"></in><apply id="S7.Ex33.m1.1.1.1.1.2.cmml" xref="S7.Ex33.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.Ex33.m1.1.1.1.1.2.1.cmml" xref="S7.Ex33.m1.1.1.1.1.2">subscript</csymbol><ci id="S7.Ex33.m1.1.1.1.1.2.2.cmml" xref="S7.Ex33.m1.1.1.1.1.2.2">𝑥</ci><ci id="S7.Ex33.m1.1.1.1.1.2.3.cmml" xref="S7.Ex33.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex33.m1.1.1.1.1.3.cmml" xref="S7.Ex33.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex33.m1.1.1.1.1.3.1.cmml" xref="S7.Ex33.m1.1.1.1.1.3">superscript</csymbol><ci id="S7.Ex33.m1.1.1.1.1.3.2.cmml" xref="S7.Ex33.m1.1.1.1.1.3.2">ℝ</ci><ci id="S7.Ex33.m1.1.1.1.1.3.3.cmml" xref="S7.Ex33.m1.1.1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex33.m1.1c">x_{t}\in\mathbb{R}^{d},</annotation><annotation encoding="application/x-llamapun" id="S7.Ex33.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p3">
<p class="ltx_p" id="S7.SS2.SSS1.p3.2">where <math alttext="x_{t}" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p3.1.m1.1"><semantics id="S7.SS2.SSS1.p3.1.m1.1a"><msub id="S7.SS2.SSS1.p3.1.m1.1.1" xref="S7.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S7.SS2.SSS1.p3.1.m1.1.1.2" xref="S7.SS2.SSS1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S7.SS2.SSS1.p3.1.m1.1.1.3" xref="S7.SS2.SSS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p3.1.m1.1b"><apply id="S7.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S7.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S7.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S7.SS2.SSS1.p3.1.m1.1.1.2">𝑥</ci><ci id="S7.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S7.SS2.SSS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p3.1.m1.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the observed time series at time step <math alttext="t" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p3.2.m2.1"><semantics id="S7.SS2.SSS1.p3.2.m2.1a"><mi id="S7.SS2.SSS1.p3.2.m2.1.1" xref="S7.SS2.SSS1.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p3.2.m2.1b"><ci id="S7.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S7.SS2.SSS1.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p3.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p3.2.m2.1d">italic_t</annotation></semantics></math>. This input is embedded into a latent space through a Transformer-based encoder:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S7.E40">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{t}=\mathrm{Encoder}(x_{t})," class="ltx_Math" display="block" id="S7.E40.m1.1"><semantics id="S7.E40.m1.1a"><mrow id="S7.E40.m1.1.1.1" xref="S7.E40.m1.1.1.1.1.cmml"><mrow id="S7.E40.m1.1.1.1.1" xref="S7.E40.m1.1.1.1.1.cmml"><msub id="S7.E40.m1.1.1.1.1.3" xref="S7.E40.m1.1.1.1.1.3.cmml"><mi id="S7.E40.m1.1.1.1.1.3.2" xref="S7.E40.m1.1.1.1.1.3.2.cmml">z</mi><mi id="S7.E40.m1.1.1.1.1.3.3" xref="S7.E40.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S7.E40.m1.1.1.1.1.2" xref="S7.E40.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E40.m1.1.1.1.1.1" xref="S7.E40.m1.1.1.1.1.1.cmml"><mi id="S7.E40.m1.1.1.1.1.1.3" xref="S7.E40.m1.1.1.1.1.1.3.cmml">Encoder</mi><mo id="S7.E40.m1.1.1.1.1.1.2" xref="S7.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E40.m1.1.1.1.1.1.1.1" xref="S7.E40.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E40.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E40.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.E40.m1.1.1.1.1.1.1.1.1" xref="S7.E40.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E40.m1.1.1.1.1.1.1.1.1.2" xref="S7.E40.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S7.E40.m1.1.1.1.1.1.1.1.1.3" xref="S7.E40.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.E40.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E40.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E40.m1.1.1.1.2" xref="S7.E40.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E40.m1.1b"><apply id="S7.E40.m1.1.1.1.1.cmml" xref="S7.E40.m1.1.1.1"><eq id="S7.E40.m1.1.1.1.1.2.cmml" xref="S7.E40.m1.1.1.1.1.2"></eq><apply id="S7.E40.m1.1.1.1.1.3.cmml" xref="S7.E40.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E40.m1.1.1.1.1.3.1.cmml" xref="S7.E40.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.E40.m1.1.1.1.1.3.2.cmml" xref="S7.E40.m1.1.1.1.1.3.2">𝑧</ci><ci id="S7.E40.m1.1.1.1.1.3.3.cmml" xref="S7.E40.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S7.E40.m1.1.1.1.1.1.cmml" xref="S7.E40.m1.1.1.1.1.1"><times id="S7.E40.m1.1.1.1.1.1.2.cmml" xref="S7.E40.m1.1.1.1.1.1.2"></times><ci id="S7.E40.m1.1.1.1.1.1.3.cmml" xref="S7.E40.m1.1.1.1.1.1.3">Encoder</ci><apply id="S7.E40.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E40.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E40.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E40.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E40.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E40.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S7.E40.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E40.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E40.m1.1c">z_{t}=\mathrm{Encoder}(x_{t}),</annotation><annotation encoding="application/x-llamapun" id="S7.E40.m1.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_Encoder ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(40)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p5">
<p class="ltx_p" id="S7.SS2.SSS1.p5.1">where <math alttext="z_{t}\in\mathbb{R}^{d_{\text{latent}}}" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p5.1.m1.1"><semantics id="S7.SS2.SSS1.p5.1.m1.1a"><mrow id="S7.SS2.SSS1.p5.1.m1.1.1" xref="S7.SS2.SSS1.p5.1.m1.1.1.cmml"><msub id="S7.SS2.SSS1.p5.1.m1.1.1.2" xref="S7.SS2.SSS1.p5.1.m1.1.1.2.cmml"><mi id="S7.SS2.SSS1.p5.1.m1.1.1.2.2" xref="S7.SS2.SSS1.p5.1.m1.1.1.2.2.cmml">z</mi><mi id="S7.SS2.SSS1.p5.1.m1.1.1.2.3" xref="S7.SS2.SSS1.p5.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S7.SS2.SSS1.p5.1.m1.1.1.1" xref="S7.SS2.SSS1.p5.1.m1.1.1.1.cmml">∈</mo><msup id="S7.SS2.SSS1.p5.1.m1.1.1.3" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.cmml"><mi id="S7.SS2.SSS1.p5.1.m1.1.1.3.2" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S7.SS2.SSS1.p5.1.m1.1.1.3.3" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.cmml"><mi id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.2" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.2.cmml">d</mi><mtext id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3a.cmml">latent</mtext></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p5.1.m1.1b"><apply id="S7.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1"><in id="S7.SS2.SSS1.p5.1.m1.1.1.1.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.1"></in><apply id="S7.SS2.SSS1.p5.1.m1.1.1.2.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p5.1.m1.1.1.2.1.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS2.SSS1.p5.1.m1.1.1.2.2.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.2.2">𝑧</ci><ci id="S7.SS2.SSS1.p5.1.m1.1.1.2.3.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S7.SS2.SSS1.p5.1.m1.1.1.3.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p5.1.m1.1.1.3.1.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3">superscript</csymbol><ci id="S7.SS2.SSS1.p5.1.m1.1.1.3.2.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.2">ℝ</ci><apply id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.1.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3">subscript</csymbol><ci id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.2.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.2">𝑑</ci><ci id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3a.cmml" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3"><mtext id="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3.cmml" mathsize="50%" xref="S7.SS2.SSS1.p5.1.m1.1.1.3.3.3">latent</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p5.1.m1.1c">z_{t}\in\mathbb{R}^{d_{\text{latent}}}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p5.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT latent end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the latent representation learned to capture complex temporal dependencies.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p6">
<p class="ltx_p" id="S7.SS2.SSS1.p6.1">The temporal evolution in the latent space is modeled via a learned Koopman operator <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p6.1.m1.1"><semantics id="S7.SS2.SSS1.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.SSS1.p6.1.m1.1.1" xref="S7.SS2.SSS1.p6.1.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p6.1.m1.1b"><ci id="S7.SS2.SSS1.p6.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p6.1.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p6.1.m1.1c">\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p6.1.m1.1d">caligraphic_K</annotation></semantics></math>, assumed linear:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p7">
<table class="ltx_equation ltx_eqn_table" id="S7.E41">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{t+1}=\mathcal{K}(z_{t})." class="ltx_Math" display="block" id="S7.E41.m1.1"><semantics id="S7.E41.m1.1a"><mrow id="S7.E41.m1.1.1.1" xref="S7.E41.m1.1.1.1.1.cmml"><mrow id="S7.E41.m1.1.1.1.1" xref="S7.E41.m1.1.1.1.1.cmml"><msub id="S7.E41.m1.1.1.1.1.3" xref="S7.E41.m1.1.1.1.1.3.cmml"><mi id="S7.E41.m1.1.1.1.1.3.2" xref="S7.E41.m1.1.1.1.1.3.2.cmml">z</mi><mrow id="S7.E41.m1.1.1.1.1.3.3" xref="S7.E41.m1.1.1.1.1.3.3.cmml"><mi id="S7.E41.m1.1.1.1.1.3.3.2" xref="S7.E41.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S7.E41.m1.1.1.1.1.3.3.1" xref="S7.E41.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S7.E41.m1.1.1.1.1.3.3.3" xref="S7.E41.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S7.E41.m1.1.1.1.1.2" xref="S7.E41.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E41.m1.1.1.1.1.1" xref="S7.E41.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E41.m1.1.1.1.1.1.3" xref="S7.E41.m1.1.1.1.1.1.3.cmml">𝒦</mi><mo id="S7.E41.m1.1.1.1.1.1.2" xref="S7.E41.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E41.m1.1.1.1.1.1.1.1" xref="S7.E41.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E41.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E41.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.E41.m1.1.1.1.1.1.1.1.1" xref="S7.E41.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E41.m1.1.1.1.1.1.1.1.1.2" xref="S7.E41.m1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.E41.m1.1.1.1.1.1.1.1.1.3" xref="S7.E41.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.E41.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E41.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E41.m1.1.1.1.2" lspace="0em" xref="S7.E41.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E41.m1.1b"><apply id="S7.E41.m1.1.1.1.1.cmml" xref="S7.E41.m1.1.1.1"><eq id="S7.E41.m1.1.1.1.1.2.cmml" xref="S7.E41.m1.1.1.1.1.2"></eq><apply id="S7.E41.m1.1.1.1.1.3.cmml" xref="S7.E41.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E41.m1.1.1.1.1.3.1.cmml" xref="S7.E41.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.E41.m1.1.1.1.1.3.2.cmml" xref="S7.E41.m1.1.1.1.1.3.2">𝑧</ci><apply id="S7.E41.m1.1.1.1.1.3.3.cmml" xref="S7.E41.m1.1.1.1.1.3.3"><plus id="S7.E41.m1.1.1.1.1.3.3.1.cmml" xref="S7.E41.m1.1.1.1.1.3.3.1"></plus><ci id="S7.E41.m1.1.1.1.1.3.3.2.cmml" xref="S7.E41.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="S7.E41.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S7.E41.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S7.E41.m1.1.1.1.1.1.cmml" xref="S7.E41.m1.1.1.1.1.1"><times id="S7.E41.m1.1.1.1.1.1.2.cmml" xref="S7.E41.m1.1.1.1.1.1.2"></times><ci id="S7.E41.m1.1.1.1.1.1.3.cmml" xref="S7.E41.m1.1.1.1.1.1.3">𝒦</ci><apply id="S7.E41.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E41.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E41.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E41.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E41.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E41.m1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.E41.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E41.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E41.m1.1c">z_{t+1}=\mathcal{K}(z_{t}).</annotation><annotation encoding="application/x-llamapun" id="S7.E41.m1.1d">italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = caligraphic_K ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(41)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p8">
<p class="ltx_p" id="S7.SS2.SSS1.p8.1">The Koopman operator is parametrized as:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p9">
<table class="ltx_equation ltx_eqn_table" id="S7.E42">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{K}=U\cdot\mathrm{diag}(S)\cdot V^{\top}," class="ltx_Math" display="block" id="S7.E42.m1.2"><semantics id="S7.E42.m1.2a"><mrow id="S7.E42.m1.2.2.1" xref="S7.E42.m1.2.2.1.1.cmml"><mrow id="S7.E42.m1.2.2.1.1" xref="S7.E42.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E42.m1.2.2.1.1.2" xref="S7.E42.m1.2.2.1.1.2.cmml">𝒦</mi><mo id="S7.E42.m1.2.2.1.1.1" xref="S7.E42.m1.2.2.1.1.1.cmml">=</mo><mrow id="S7.E42.m1.2.2.1.1.3" xref="S7.E42.m1.2.2.1.1.3.cmml"><mrow id="S7.E42.m1.2.2.1.1.3.2" xref="S7.E42.m1.2.2.1.1.3.2.cmml"><mrow id="S7.E42.m1.2.2.1.1.3.2.2" xref="S7.E42.m1.2.2.1.1.3.2.2.cmml"><mi id="S7.E42.m1.2.2.1.1.3.2.2.2" xref="S7.E42.m1.2.2.1.1.3.2.2.2.cmml">U</mi><mo id="S7.E42.m1.2.2.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S7.E42.m1.2.2.1.1.3.2.2.1.cmml">⋅</mo><mi id="S7.E42.m1.2.2.1.1.3.2.2.3" xref="S7.E42.m1.2.2.1.1.3.2.2.3.cmml">diag</mi></mrow><mo id="S7.E42.m1.2.2.1.1.3.2.1" xref="S7.E42.m1.2.2.1.1.3.2.1.cmml">⁢</mo><mrow id="S7.E42.m1.2.2.1.1.3.2.3.2" xref="S7.E42.m1.2.2.1.1.3.2.cmml"><mo id="S7.E42.m1.2.2.1.1.3.2.3.2.1" stretchy="false" xref="S7.E42.m1.2.2.1.1.3.2.cmml">(</mo><mi id="S7.E42.m1.1.1" xref="S7.E42.m1.1.1.cmml">S</mi><mo id="S7.E42.m1.2.2.1.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S7.E42.m1.2.2.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S7.E42.m1.2.2.1.1.3.1" rspace="0.222em" xref="S7.E42.m1.2.2.1.1.3.1.cmml">⋅</mo><msup id="S7.E42.m1.2.2.1.1.3.3" xref="S7.E42.m1.2.2.1.1.3.3.cmml"><mi id="S7.E42.m1.2.2.1.1.3.3.2" xref="S7.E42.m1.2.2.1.1.3.3.2.cmml">V</mi><mo id="S7.E42.m1.2.2.1.1.3.3.3" xref="S7.E42.m1.2.2.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><mo id="S7.E42.m1.2.2.1.2" xref="S7.E42.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E42.m1.2b"><apply id="S7.E42.m1.2.2.1.1.cmml" xref="S7.E42.m1.2.2.1"><eq id="S7.E42.m1.2.2.1.1.1.cmml" xref="S7.E42.m1.2.2.1.1.1"></eq><ci id="S7.E42.m1.2.2.1.1.2.cmml" xref="S7.E42.m1.2.2.1.1.2">𝒦</ci><apply id="S7.E42.m1.2.2.1.1.3.cmml" xref="S7.E42.m1.2.2.1.1.3"><ci id="S7.E42.m1.2.2.1.1.3.1.cmml" xref="S7.E42.m1.2.2.1.1.3.1">⋅</ci><apply id="S7.E42.m1.2.2.1.1.3.2.cmml" xref="S7.E42.m1.2.2.1.1.3.2"><times id="S7.E42.m1.2.2.1.1.3.2.1.cmml" xref="S7.E42.m1.2.2.1.1.3.2.1"></times><apply id="S7.E42.m1.2.2.1.1.3.2.2.cmml" xref="S7.E42.m1.2.2.1.1.3.2.2"><ci id="S7.E42.m1.2.2.1.1.3.2.2.1.cmml" xref="S7.E42.m1.2.2.1.1.3.2.2.1">⋅</ci><ci id="S7.E42.m1.2.2.1.1.3.2.2.2.cmml" xref="S7.E42.m1.2.2.1.1.3.2.2.2">𝑈</ci><ci id="S7.E42.m1.2.2.1.1.3.2.2.3.cmml" xref="S7.E42.m1.2.2.1.1.3.2.2.3">diag</ci></apply><ci id="S7.E42.m1.1.1.cmml" xref="S7.E42.m1.1.1">𝑆</ci></apply><apply id="S7.E42.m1.2.2.1.1.3.3.cmml" xref="S7.E42.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S7.E42.m1.2.2.1.1.3.3.1.cmml" xref="S7.E42.m1.2.2.1.1.3.3">superscript</csymbol><ci id="S7.E42.m1.2.2.1.1.3.3.2.cmml" xref="S7.E42.m1.2.2.1.1.3.3.2">𝑉</ci><csymbol cd="latexml" id="S7.E42.m1.2.2.1.1.3.3.3.cmml" xref="S7.E42.m1.2.2.1.1.3.3.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E42.m1.2c">\mathcal{K}=U\cdot\mathrm{diag}(S)\cdot V^{\top},</annotation><annotation encoding="application/x-llamapun" id="S7.E42.m1.2d">caligraphic_K = italic_U ⋅ roman_diag ( italic_S ) ⋅ italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(42)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p10">
<p class="ltx_p" id="S7.SS2.SSS1.p10.3">where <math alttext="U" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p10.1.m1.1"><semantics id="S7.SS2.SSS1.p10.1.m1.1a"><mi id="S7.SS2.SSS1.p10.1.m1.1.1" xref="S7.SS2.SSS1.p10.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p10.1.m1.1b"><ci id="S7.SS2.SSS1.p10.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p10.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p10.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p10.1.m1.1d">italic_U</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p10.2.m2.1"><semantics id="S7.SS2.SSS1.p10.2.m2.1a"><mi id="S7.SS2.SSS1.p10.2.m2.1.1" xref="S7.SS2.SSS1.p10.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p10.2.m2.1b"><ci id="S7.SS2.SSS1.p10.2.m2.1.1.cmml" xref="S7.SS2.SSS1.p10.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p10.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p10.2.m2.1d">italic_V</annotation></semantics></math> are orthogonal matrices and <math alttext="S" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p10.3.m3.1"><semantics id="S7.SS2.SSS1.p10.3.m3.1a"><mi id="S7.SS2.SSS1.p10.3.m3.1.1" xref="S7.SS2.SSS1.p10.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p10.3.m3.1b"><ci id="S7.SS2.SSS1.p10.3.m3.1.1.cmml" xref="S7.SS2.SSS1.p10.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p10.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p10.3.m3.1d">italic_S</annotation></semantics></math> is a diagonal vector whose values are constrained to ensure stability:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p11">
<table class="ltx_equation ltx_eqn_table" id="S7.E43">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{i}=\sigma(S_{i}^{\text{raw}})\cdot 0.99." class="ltx_Math" display="block" id="S7.E43.m1.1"><semantics id="S7.E43.m1.1a"><mrow id="S7.E43.m1.1.1.1" xref="S7.E43.m1.1.1.1.1.cmml"><mrow id="S7.E43.m1.1.1.1.1" xref="S7.E43.m1.1.1.1.1.cmml"><msub id="S7.E43.m1.1.1.1.1.3" xref="S7.E43.m1.1.1.1.1.3.cmml"><mi id="S7.E43.m1.1.1.1.1.3.2" xref="S7.E43.m1.1.1.1.1.3.2.cmml">S</mi><mi id="S7.E43.m1.1.1.1.1.3.3" xref="S7.E43.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S7.E43.m1.1.1.1.1.2" xref="S7.E43.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E43.m1.1.1.1.1.1" xref="S7.E43.m1.1.1.1.1.1.cmml"><mrow id="S7.E43.m1.1.1.1.1.1.1" xref="S7.E43.m1.1.1.1.1.1.1.cmml"><mi id="S7.E43.m1.1.1.1.1.1.1.3" xref="S7.E43.m1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S7.E43.m1.1.1.1.1.1.1.2" xref="S7.E43.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E43.m1.1.1.1.1.1.1.1.1" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E43.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S7.E43.m1.1.1.1.1.1.1.1.1.1" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S7.E43.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.3a.cmml">raw</mtext></msubsup><mo id="S7.E43.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E43.m1.1.1.1.1.1.2" rspace="0.222em" xref="S7.E43.m1.1.1.1.1.1.2.cmml">⋅</mo><mn id="S7.E43.m1.1.1.1.1.1.3" xref="S7.E43.m1.1.1.1.1.1.3.cmml">0.99</mn></mrow></mrow><mo id="S7.E43.m1.1.1.1.2" lspace="0em" xref="S7.E43.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E43.m1.1b"><apply id="S7.E43.m1.1.1.1.1.cmml" xref="S7.E43.m1.1.1.1"><eq id="S7.E43.m1.1.1.1.1.2.cmml" xref="S7.E43.m1.1.1.1.1.2"></eq><apply id="S7.E43.m1.1.1.1.1.3.cmml" xref="S7.E43.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E43.m1.1.1.1.1.3.1.cmml" xref="S7.E43.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.E43.m1.1.1.1.1.3.2.cmml" xref="S7.E43.m1.1.1.1.1.3.2">𝑆</ci><ci id="S7.E43.m1.1.1.1.1.3.3.cmml" xref="S7.E43.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S7.E43.m1.1.1.1.1.1.cmml" xref="S7.E43.m1.1.1.1.1.1"><ci id="S7.E43.m1.1.1.1.1.1.2.cmml" xref="S7.E43.m1.1.1.1.1.1.2">⋅</ci><apply id="S7.E43.m1.1.1.1.1.1.1.cmml" xref="S7.E43.m1.1.1.1.1.1.1"><times id="S7.E43.m1.1.1.1.1.1.1.2.cmml" xref="S7.E43.m1.1.1.1.1.1.1.2"></times><ci id="S7.E43.m1.1.1.1.1.1.1.3.cmml" xref="S7.E43.m1.1.1.1.1.1.1.3">𝜎</ci><apply id="S7.E43.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E43.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S7.E43.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S7.E43.m1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S7.E43.m1.1.1.1.1.1.1.1.1.1.3">raw</mtext></ci></apply></apply><cn id="S7.E43.m1.1.1.1.1.1.3.cmml" type="float" xref="S7.E43.m1.1.1.1.1.1.3">0.99</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E43.m1.1c">S_{i}=\sigma(S_{i}^{\text{raw}})\cdot 0.99.</annotation><annotation encoding="application/x-llamapun" id="S7.E43.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ ( italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT raw end_POSTSUPERSCRIPT ) ⋅ 0.99 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(43)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p12">
<p class="ltx_p" id="S7.SS2.SSS1.p12.1">The propagated latent state is subsequently decoded to predict the next observed state:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p13">
<table class="ltx_equation ltx_eqn_table" id="S7.E44">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{x}_{t+1}=\mathrm{Decoder}(z_{t+1})," class="ltx_Math" display="block" id="S7.E44.m1.1"><semantics id="S7.E44.m1.1a"><mrow id="S7.E44.m1.1.1.1" xref="S7.E44.m1.1.1.1.1.cmml"><mrow id="S7.E44.m1.1.1.1.1" xref="S7.E44.m1.1.1.1.1.cmml"><msub id="S7.E44.m1.1.1.1.1.3" xref="S7.E44.m1.1.1.1.1.3.cmml"><mover accent="true" id="S7.E44.m1.1.1.1.1.3.2" xref="S7.E44.m1.1.1.1.1.3.2.cmml"><mi id="S7.E44.m1.1.1.1.1.3.2.2" xref="S7.E44.m1.1.1.1.1.3.2.2.cmml">x</mi><mo id="S7.E44.m1.1.1.1.1.3.2.1" xref="S7.E44.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S7.E44.m1.1.1.1.1.3.3" xref="S7.E44.m1.1.1.1.1.3.3.cmml"><mi id="S7.E44.m1.1.1.1.1.3.3.2" xref="S7.E44.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S7.E44.m1.1.1.1.1.3.3.1" xref="S7.E44.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S7.E44.m1.1.1.1.1.3.3.3" xref="S7.E44.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S7.E44.m1.1.1.1.1.2" xref="S7.E44.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E44.m1.1.1.1.1.1" xref="S7.E44.m1.1.1.1.1.1.cmml"><mi id="S7.E44.m1.1.1.1.1.1.3" xref="S7.E44.m1.1.1.1.1.1.3.cmml">Decoder</mi><mo id="S7.E44.m1.1.1.1.1.1.2" xref="S7.E44.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E44.m1.1.1.1.1.1.1.1" xref="S7.E44.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E44.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E44.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.E44.m1.1.1.1.1.1.1.1.1" xref="S7.E44.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E44.m1.1.1.1.1.1.1.1.1.2" xref="S7.E44.m1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S7.E44.m1.1.1.1.1.1.1.1.1.3" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.E44.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.E44.m1.1.1.1.1.1.1.1.1.3.1" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S7.E44.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S7.E44.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E44.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E44.m1.1.1.1.2" xref="S7.E44.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E44.m1.1b"><apply id="S7.E44.m1.1.1.1.1.cmml" xref="S7.E44.m1.1.1.1"><eq id="S7.E44.m1.1.1.1.1.2.cmml" xref="S7.E44.m1.1.1.1.1.2"></eq><apply id="S7.E44.m1.1.1.1.1.3.cmml" xref="S7.E44.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E44.m1.1.1.1.1.3.1.cmml" xref="S7.E44.m1.1.1.1.1.3">subscript</csymbol><apply id="S7.E44.m1.1.1.1.1.3.2.cmml" xref="S7.E44.m1.1.1.1.1.3.2"><ci id="S7.E44.m1.1.1.1.1.3.2.1.cmml" xref="S7.E44.m1.1.1.1.1.3.2.1">^</ci><ci id="S7.E44.m1.1.1.1.1.3.2.2.cmml" xref="S7.E44.m1.1.1.1.1.3.2.2">𝑥</ci></apply><apply id="S7.E44.m1.1.1.1.1.3.3.cmml" xref="S7.E44.m1.1.1.1.1.3.3"><plus id="S7.E44.m1.1.1.1.1.3.3.1.cmml" xref="S7.E44.m1.1.1.1.1.3.3.1"></plus><ci id="S7.E44.m1.1.1.1.1.3.3.2.cmml" xref="S7.E44.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="S7.E44.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S7.E44.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S7.E44.m1.1.1.1.1.1.cmml" xref="S7.E44.m1.1.1.1.1.1"><times id="S7.E44.m1.1.1.1.1.1.2.cmml" xref="S7.E44.m1.1.1.1.1.1.2"></times><ci id="S7.E44.m1.1.1.1.1.1.3.cmml" xref="S7.E44.m1.1.1.1.1.1.3">Decoder</ci><apply id="S7.E44.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E44.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E44.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S7.E44.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3"><plus id="S7.E44.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S7.E44.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S7.E44.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.E44.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E44.m1.1c">\hat{x}_{t+1}=\mathrm{Decoder}(z_{t+1}),</annotation><annotation encoding="application/x-llamapun" id="S7.E44.m1.1d">over^ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = roman_Decoder ( italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(44)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p14">
<p class="ltx_p" id="S7.SS2.SSS1.p14.1">where <math alttext="\hat{x}_{t+1}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S7.SS2.SSS1.p14.1.m1.1"><semantics id="S7.SS2.SSS1.p14.1.m1.1a"><mrow id="S7.SS2.SSS1.p14.1.m1.1.1" xref="S7.SS2.SSS1.p14.1.m1.1.1.cmml"><msub id="S7.SS2.SSS1.p14.1.m1.1.1.2" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.cmml"><mover accent="true" id="S7.SS2.SSS1.p14.1.m1.1.1.2.2" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2.cmml"><mi id="S7.SS2.SSS1.p14.1.m1.1.1.2.2.2" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2.2.cmml">x</mi><mo id="S7.SS2.SSS1.p14.1.m1.1.1.2.2.1" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S7.SS2.SSS1.p14.1.m1.1.1.2.3" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.cmml"><mi id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.2" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.1" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.1.cmml">+</mo><mn id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.3" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S7.SS2.SSS1.p14.1.m1.1.1.1" xref="S7.SS2.SSS1.p14.1.m1.1.1.1.cmml">∈</mo><msup id="S7.SS2.SSS1.p14.1.m1.1.1.3" xref="S7.SS2.SSS1.p14.1.m1.1.1.3.cmml"><mi id="S7.SS2.SSS1.p14.1.m1.1.1.3.2" xref="S7.SS2.SSS1.p14.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S7.SS2.SSS1.p14.1.m1.1.1.3.3" xref="S7.SS2.SSS1.p14.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p14.1.m1.1b"><apply id="S7.SS2.SSS1.p14.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1"><in id="S7.SS2.SSS1.p14.1.m1.1.1.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.1"></in><apply id="S7.SS2.SSS1.p14.1.m1.1.1.2.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p14.1.m1.1.1.2.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2">subscript</csymbol><apply id="S7.SS2.SSS1.p14.1.m1.1.1.2.2.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2"><ci id="S7.SS2.SSS1.p14.1.m1.1.1.2.2.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2.1">^</ci><ci id="S7.SS2.SSS1.p14.1.m1.1.1.2.2.2.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.2.2">𝑥</ci></apply><apply id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3"><plus id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.1"></plus><ci id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.2.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.2">𝑡</ci><cn id="S7.SS2.SSS1.p14.1.m1.1.1.2.3.3.cmml" type="integer" xref="S7.SS2.SSS1.p14.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S7.SS2.SSS1.p14.1.m1.1.1.3.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.SS2.SSS1.p14.1.m1.1.1.3.1.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.3">superscript</csymbol><ci id="S7.SS2.SSS1.p14.1.m1.1.1.3.2.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.3.2">ℝ</ci><ci id="S7.SS2.SSS1.p14.1.m1.1.1.3.3.cmml" xref="S7.SS2.SSS1.p14.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p14.1.m1.1c">\hat{x}_{t+1}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p14.1.m1.1d">over^ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the predicted observation at the next time step. The complete transformation can thus be expressed as:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS1.p15">
<table class="ltx_equation ltx_eqn_table" id="S7.E45">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{x}_{t+1}=\mathrm{Decoder}(\mathcal{K}(\mathrm{Encoder}(x_{t})))." class="ltx_Math" display="block" id="S7.E45.m1.1"><semantics id="S7.E45.m1.1a"><mrow id="S7.E45.m1.1.1.1" xref="S7.E45.m1.1.1.1.1.cmml"><mrow id="S7.E45.m1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.cmml"><msub id="S7.E45.m1.1.1.1.1.3" xref="S7.E45.m1.1.1.1.1.3.cmml"><mover accent="true" id="S7.E45.m1.1.1.1.1.3.2" xref="S7.E45.m1.1.1.1.1.3.2.cmml"><mi id="S7.E45.m1.1.1.1.1.3.2.2" xref="S7.E45.m1.1.1.1.1.3.2.2.cmml">x</mi><mo id="S7.E45.m1.1.1.1.1.3.2.1" xref="S7.E45.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S7.E45.m1.1.1.1.1.3.3" xref="S7.E45.m1.1.1.1.1.3.3.cmml"><mi id="S7.E45.m1.1.1.1.1.3.3.2" xref="S7.E45.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S7.E45.m1.1.1.1.1.3.3.1" xref="S7.E45.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S7.E45.m1.1.1.1.1.3.3.3" xref="S7.E45.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S7.E45.m1.1.1.1.1.2" xref="S7.E45.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E45.m1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.cmml"><mi id="S7.E45.m1.1.1.1.1.1.3" xref="S7.E45.m1.1.1.1.1.1.3.cmml">Decoder</mi><mo id="S7.E45.m1.1.1.1.1.1.2" xref="S7.E45.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E45.m1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E45.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E45.m1.1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E45.m1.1.1.1.1.1.1.1.1.3" xref="S7.E45.m1.1.1.1.1.1.1.1.1.3.cmml">𝒦</mi><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.2" xref="S7.E45.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">Encoder</mi><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E45.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E45.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E45.m1.1.1.1.2" lspace="0em" xref="S7.E45.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E45.m1.1b"><apply id="S7.E45.m1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1"><eq id="S7.E45.m1.1.1.1.1.2.cmml" xref="S7.E45.m1.1.1.1.1.2"></eq><apply id="S7.E45.m1.1.1.1.1.3.cmml" xref="S7.E45.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E45.m1.1.1.1.1.3.1.cmml" xref="S7.E45.m1.1.1.1.1.3">subscript</csymbol><apply id="S7.E45.m1.1.1.1.1.3.2.cmml" xref="S7.E45.m1.1.1.1.1.3.2"><ci id="S7.E45.m1.1.1.1.1.3.2.1.cmml" xref="S7.E45.m1.1.1.1.1.3.2.1">^</ci><ci id="S7.E45.m1.1.1.1.1.3.2.2.cmml" xref="S7.E45.m1.1.1.1.1.3.2.2">𝑥</ci></apply><apply id="S7.E45.m1.1.1.1.1.3.3.cmml" xref="S7.E45.m1.1.1.1.1.3.3"><plus id="S7.E45.m1.1.1.1.1.3.3.1.cmml" xref="S7.E45.m1.1.1.1.1.3.3.1"></plus><ci id="S7.E45.m1.1.1.1.1.3.3.2.cmml" xref="S7.E45.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="S7.E45.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S7.E45.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S7.E45.m1.1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1.1.1"><times id="S7.E45.m1.1.1.1.1.1.2.cmml" xref="S7.E45.m1.1.1.1.1.1.2"></times><ci id="S7.E45.m1.1.1.1.1.1.3.cmml" xref="S7.E45.m1.1.1.1.1.1.3">Decoder</ci><apply id="S7.E45.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1"><times id="S7.E45.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S7.E45.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.3">𝒦</ci><apply id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1"><times id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.3">Encoder</ci><apply id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E45.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E45.m1.1c">\hat{x}_{t+1}=\mathrm{Decoder}(\mathcal{K}(\mathrm{Encoder}(x_{t}))).</annotation><annotation encoding="application/x-llamapun" id="S7.E45.m1.1d">over^ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = roman_Decoder ( caligraphic_K ( roman_Encoder ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(45)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.2 </span>Spectral Stability via Koopman Parametrization</h4>
<div class="ltx_para" id="S7.SS2.SSS2.p1">
<p class="ltx_p" id="S7.SS2.SSS2.p1.1">In unconstrained models, latent dynamics may become unstable, leading to diverging predictions and poor generalization in long-horizon forecasting. To address this, we enforce spectral stability within the Koopman operator design. By construction, the spectral radius of <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p1.1.m1.1"><semantics id="S7.SS2.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.SSS2.p1.1.m1.1.1" xref="S7.SS2.SSS2.p1.1.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p1.1.m1.1b"><ci id="S7.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p1.1.m1.1c">\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p1.1.m1.1d">caligraphic_K</annotation></semantics></math> is strictly controlled:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S7.E46">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\rho(\mathcal{K})=\max|\lambda_{i}|\leq 0.99." class="ltx_Math" display="block" id="S7.E46.m1.2"><semantics id="S7.E46.m1.2a"><mrow id="S7.E46.m1.2.2.1" xref="S7.E46.m1.2.2.1.1.cmml"><mrow id="S7.E46.m1.2.2.1.1" xref="S7.E46.m1.2.2.1.1.cmml"><mrow id="S7.E46.m1.2.2.1.1.3" xref="S7.E46.m1.2.2.1.1.3.cmml"><mi id="S7.E46.m1.2.2.1.1.3.2" xref="S7.E46.m1.2.2.1.1.3.2.cmml">ρ</mi><mo id="S7.E46.m1.2.2.1.1.3.1" xref="S7.E46.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S7.E46.m1.2.2.1.1.3.3.2" xref="S7.E46.m1.2.2.1.1.3.cmml"><mo id="S7.E46.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S7.E46.m1.2.2.1.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S7.E46.m1.1.1" xref="S7.E46.m1.1.1.cmml">𝒦</mi><mo id="S7.E46.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S7.E46.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S7.E46.m1.2.2.1.1.4" xref="S7.E46.m1.2.2.1.1.4.cmml">=</mo><mrow id="S7.E46.m1.2.2.1.1.1" xref="S7.E46.m1.2.2.1.1.1.cmml"><mi id="S7.E46.m1.2.2.1.1.1.2" xref="S7.E46.m1.2.2.1.1.1.2.cmml">max</mi><mo id="S7.E46.m1.2.2.1.1.1a" xref="S7.E46.m1.2.2.1.1.1.cmml">⁡</mo><mrow id="S7.E46.m1.2.2.1.1.1.1.1" xref="S7.E46.m1.2.2.1.1.1.1.2.cmml"><mo id="S7.E46.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S7.E46.m1.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S7.E46.m1.2.2.1.1.1.1.1.1" xref="S7.E46.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S7.E46.m1.2.2.1.1.1.1.1.1.2" xref="S7.E46.m1.2.2.1.1.1.1.1.1.2.cmml">λ</mi><mi id="S7.E46.m1.2.2.1.1.1.1.1.1.3" xref="S7.E46.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S7.E46.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S7.E46.m1.2.2.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S7.E46.m1.2.2.1.1.5" xref="S7.E46.m1.2.2.1.1.5.cmml">≤</mo><mn id="S7.E46.m1.2.2.1.1.6" xref="S7.E46.m1.2.2.1.1.6.cmml">0.99</mn></mrow><mo id="S7.E46.m1.2.2.1.2" lspace="0em" xref="S7.E46.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E46.m1.2b"><apply id="S7.E46.m1.2.2.1.1.cmml" xref="S7.E46.m1.2.2.1"><and id="S7.E46.m1.2.2.1.1a.cmml" xref="S7.E46.m1.2.2.1"></and><apply id="S7.E46.m1.2.2.1.1b.cmml" xref="S7.E46.m1.2.2.1"><eq id="S7.E46.m1.2.2.1.1.4.cmml" xref="S7.E46.m1.2.2.1.1.4"></eq><apply id="S7.E46.m1.2.2.1.1.3.cmml" xref="S7.E46.m1.2.2.1.1.3"><times id="S7.E46.m1.2.2.1.1.3.1.cmml" xref="S7.E46.m1.2.2.1.1.3.1"></times><ci id="S7.E46.m1.2.2.1.1.3.2.cmml" xref="S7.E46.m1.2.2.1.1.3.2">𝜌</ci><ci id="S7.E46.m1.1.1.cmml" xref="S7.E46.m1.1.1">𝒦</ci></apply><apply id="S7.E46.m1.2.2.1.1.1.cmml" xref="S7.E46.m1.2.2.1.1.1"><max id="S7.E46.m1.2.2.1.1.1.2.cmml" xref="S7.E46.m1.2.2.1.1.1.2"></max><apply id="S7.E46.m1.2.2.1.1.1.1.2.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1"><abs id="S7.E46.m1.2.2.1.1.1.1.2.1.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1.2"></abs><apply id="S7.E46.m1.2.2.1.1.1.1.1.1.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E46.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E46.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1.1.2">𝜆</ci><ci id="S7.E46.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S7.E46.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S7.E46.m1.2.2.1.1c.cmml" xref="S7.E46.m1.2.2.1"><leq id="S7.E46.m1.2.2.1.1.5.cmml" xref="S7.E46.m1.2.2.1.1.5"></leq><share href="https://arxiv.org/html/2505.20048v1#S7.E46.m1.2.2.1.1.1.cmml" id="S7.E46.m1.2.2.1.1d.cmml" xref="S7.E46.m1.2.2.1"></share><cn id="S7.E46.m1.2.2.1.1.6.cmml" type="float" xref="S7.E46.m1.2.2.1.1.6">0.99</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E46.m1.2c">\rho(\mathcal{K})=\max|\lambda_{i}|\leq 0.99.</annotation><annotation encoding="application/x-llamapun" id="S7.E46.m1.2d">italic_ρ ( caligraphic_K ) = roman_max | italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ≤ 0.99 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(46)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p3">
<p class="ltx_p" id="S7.SS2.SSS2.p3.1">This ensures that the latent dynamics are asymptotically stable, as repeated application of <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p3.1.m1.1"><semantics id="S7.SS2.SSS2.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.SSS2.p3.1.m1.1.1" xref="S7.SS2.SSS2.p3.1.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p3.1.m1.1b"><ci id="S7.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p3.1.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p3.1.m1.1c">\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p3.1.m1.1d">caligraphic_K</annotation></semantics></math> satisfies:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S7.E47">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lim_{n\to\infty}\mathcal{K}^{n}=0." class="ltx_Math" display="block" id="S7.E47.m1.1"><semantics id="S7.E47.m1.1a"><mrow id="S7.E47.m1.1.1.1" xref="S7.E47.m1.1.1.1.1.cmml"><mrow id="S7.E47.m1.1.1.1.1" xref="S7.E47.m1.1.1.1.1.cmml"><mrow id="S7.E47.m1.1.1.1.1.2" xref="S7.E47.m1.1.1.1.1.2.cmml"><munder id="S7.E47.m1.1.1.1.1.2.1" xref="S7.E47.m1.1.1.1.1.2.1.cmml"><mo id="S7.E47.m1.1.1.1.1.2.1.2" movablelimits="false" xref="S7.E47.m1.1.1.1.1.2.1.2.cmml">lim</mo><mrow id="S7.E47.m1.1.1.1.1.2.1.3" xref="S7.E47.m1.1.1.1.1.2.1.3.cmml"><mi id="S7.E47.m1.1.1.1.1.2.1.3.2" xref="S7.E47.m1.1.1.1.1.2.1.3.2.cmml">n</mi><mo id="S7.E47.m1.1.1.1.1.2.1.3.1" stretchy="false" xref="S7.E47.m1.1.1.1.1.2.1.3.1.cmml">→</mo><mi id="S7.E47.m1.1.1.1.1.2.1.3.3" mathvariant="normal" xref="S7.E47.m1.1.1.1.1.2.1.3.3.cmml">∞</mi></mrow></munder><msup id="S7.E47.m1.1.1.1.1.2.2" xref="S7.E47.m1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E47.m1.1.1.1.1.2.2.2" xref="S7.E47.m1.1.1.1.1.2.2.2.cmml">𝒦</mi><mi id="S7.E47.m1.1.1.1.1.2.2.3" xref="S7.E47.m1.1.1.1.1.2.2.3.cmml">n</mi></msup></mrow><mo id="S7.E47.m1.1.1.1.1.1" xref="S7.E47.m1.1.1.1.1.1.cmml">=</mo><mn id="S7.E47.m1.1.1.1.1.3" xref="S7.E47.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S7.E47.m1.1.1.1.2" lspace="0em" xref="S7.E47.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E47.m1.1b"><apply id="S7.E47.m1.1.1.1.1.cmml" xref="S7.E47.m1.1.1.1"><eq id="S7.E47.m1.1.1.1.1.1.cmml" xref="S7.E47.m1.1.1.1.1.1"></eq><apply id="S7.E47.m1.1.1.1.1.2.cmml" xref="S7.E47.m1.1.1.1.1.2"><apply id="S7.E47.m1.1.1.1.1.2.1.cmml" xref="S7.E47.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S7.E47.m1.1.1.1.1.2.1.1.cmml" xref="S7.E47.m1.1.1.1.1.2.1">subscript</csymbol><limit id="S7.E47.m1.1.1.1.1.2.1.2.cmml" xref="S7.E47.m1.1.1.1.1.2.1.2"></limit><apply id="S7.E47.m1.1.1.1.1.2.1.3.cmml" xref="S7.E47.m1.1.1.1.1.2.1.3"><ci id="S7.E47.m1.1.1.1.1.2.1.3.1.cmml" xref="S7.E47.m1.1.1.1.1.2.1.3.1">→</ci><ci id="S7.E47.m1.1.1.1.1.2.1.3.2.cmml" xref="S7.E47.m1.1.1.1.1.2.1.3.2">𝑛</ci><infinity id="S7.E47.m1.1.1.1.1.2.1.3.3.cmml" xref="S7.E47.m1.1.1.1.1.2.1.3.3"></infinity></apply></apply><apply id="S7.E47.m1.1.1.1.1.2.2.cmml" xref="S7.E47.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S7.E47.m1.1.1.1.1.2.2.1.cmml" xref="S7.E47.m1.1.1.1.1.2.2">superscript</csymbol><ci id="S7.E47.m1.1.1.1.1.2.2.2.cmml" xref="S7.E47.m1.1.1.1.1.2.2.2">𝒦</ci><ci id="S7.E47.m1.1.1.1.1.2.2.3.cmml" xref="S7.E47.m1.1.1.1.1.2.2.3">𝑛</ci></apply></apply><cn id="S7.E47.m1.1.1.1.1.3.cmml" type="integer" xref="S7.E47.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E47.m1.1c">\lim_{n\to\infty}\mathcal{K}^{n}=0.</annotation><annotation encoding="application/x-llamapun" id="S7.E47.m1.1d">roman_lim start_POSTSUBSCRIPT italic_n → ∞ end_POSTSUBSCRIPT caligraphic_K start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(47)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p5">
<p class="ltx_p" id="S7.SS2.SSS2.p5.1">As a result, the latent state trajectory remains bounded and avoids divergence during recursive forecasting, supporting stable and reliable predictions.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.3 </span>Energy Stability via Lyapunov Loss</h4>
<div class="ltx_para" id="S7.SS2.SSS3.p1">
<p class="ltx_p" id="S7.SS2.SSS3.p1.1">While spectral radius control limits eigenvalue magnitude, temporary growth in latent energy during training can still occur. Prediction loss alone does not penalize such undesirable latent behavior.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS3.p2">
<p class="ltx_p" id="S7.SS2.SSS3.p2.1">To further regulate latent dynamics, we introduce a Lyapunov-inspired loss function that penalizes increases in latent norm:</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S7.E48">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\mathrm{Lyapunov}}=\mathrm{ReLU}(\|z_{t+1}\|^{2}-\|z_{t}\|^{2})." class="ltx_Math" display="block" id="S7.E48.m1.1"><semantics id="S7.E48.m1.1a"><mrow id="S7.E48.m1.1.1.1" xref="S7.E48.m1.1.1.1.1.cmml"><mrow id="S7.E48.m1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.cmml"><msub id="S7.E48.m1.1.1.1.1.3" xref="S7.E48.m1.1.1.1.1.3.cmml"><mi id="S7.E48.m1.1.1.1.1.3.2" xref="S7.E48.m1.1.1.1.1.3.2.cmml">L</mi><mi id="S7.E48.m1.1.1.1.1.3.3" xref="S7.E48.m1.1.1.1.1.3.3.cmml">Lyapunov</mi></msub><mo id="S7.E48.m1.1.1.1.1.2" xref="S7.E48.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.E48.m1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.cmml"><mi id="S7.E48.m1.1.1.1.1.1.3" xref="S7.E48.m1.1.1.1.1.1.3.cmml">ReLU</mi><mo id="S7.E48.m1.1.1.1.1.1.2" xref="S7.E48.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E48.m1.1.1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.E48.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E48.m1.1.1.1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S7.E48.m1.1.1.1.1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S7.E48.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><msup id="S7.E48.m1.1.1.1.1.1.1.1.1.2" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo><msub id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">z</mi><mi id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="S7.E48.m1.1.1.1.1.1.1.1.1.2.3" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S7.E48.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.E48.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E48.m1.1.1.1.2" lspace="0em" xref="S7.E48.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E48.m1.1b"><apply id="S7.E48.m1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1"><eq id="S7.E48.m1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.2"></eq><apply id="S7.E48.m1.1.1.1.1.3.cmml" xref="S7.E48.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E48.m1.1.1.1.1.3.1.cmml" xref="S7.E48.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.E48.m1.1.1.1.1.3.2.cmml" xref="S7.E48.m1.1.1.1.1.3.2">𝐿</ci><ci id="S7.E48.m1.1.1.1.1.3.3.cmml" xref="S7.E48.m1.1.1.1.1.3.3">Lyapunov</ci></apply><apply id="S7.E48.m1.1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1"><times id="S7.E48.m1.1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.2"></times><ci id="S7.E48.m1.1.1.1.1.1.3.cmml" xref="S7.E48.m1.1.1.1.1.1.3">ReLU</ci><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1"><minus id="S7.E48.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.3"></minus><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E48.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><plus id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="S7.E48.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S7.E48.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.E48.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.2">norm</csymbol><apply id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.2">𝑧</ci><ci id="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑡</ci></apply></apply><cn id="S7.E48.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S7.E48.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E48.m1.1c">L_{\mathrm{Lyapunov}}=\mathrm{ReLU}(\|z_{t+1}\|^{2}-\|z_{t}\|^{2}).</annotation><annotation encoding="application/x-llamapun" id="S7.E48.m1.1d">italic_L start_POSTSUBSCRIPT roman_Lyapunov end_POSTSUBSCRIPT = roman_ReLU ( ∥ italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(48)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS3.p4">
<p class="ltx_p" id="S7.SS2.SSS3.p4.2">This loss encourages contractive latent dynamics by penalizing instances where <math alttext="z_{t+1}" class="ltx_Math" display="inline" id="S7.SS2.SSS3.p4.1.m1.1"><semantics id="S7.SS2.SSS3.p4.1.m1.1a"><msub id="S7.SS2.SSS3.p4.1.m1.1.1" xref="S7.SS2.SSS3.p4.1.m1.1.1.cmml"><mi id="S7.SS2.SSS3.p4.1.m1.1.1.2" xref="S7.SS2.SSS3.p4.1.m1.1.1.2.cmml">z</mi><mrow id="S7.SS2.SSS3.p4.1.m1.1.1.3" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.cmml"><mi id="S7.SS2.SSS3.p4.1.m1.1.1.3.2" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.2.cmml">t</mi><mo id="S7.SS2.SSS3.p4.1.m1.1.1.3.1" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.1.cmml">+</mo><mn id="S7.SS2.SSS3.p4.1.m1.1.1.3.3" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS3.p4.1.m1.1b"><apply id="S7.SS2.SSS3.p4.1.m1.1.1.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS3.p4.1.m1.1.1.1.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1">subscript</csymbol><ci id="S7.SS2.SSS3.p4.1.m1.1.1.2.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1.2">𝑧</ci><apply id="S7.SS2.SSS3.p4.1.m1.1.1.3.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1.3"><plus id="S7.SS2.SSS3.p4.1.m1.1.1.3.1.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.1"></plus><ci id="S7.SS2.SSS3.p4.1.m1.1.1.3.2.cmml" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.2">𝑡</ci><cn id="S7.SS2.SSS3.p4.1.m1.1.1.3.3.cmml" type="integer" xref="S7.SS2.SSS3.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS3.p4.1.m1.1c">z_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS3.p4.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> has higher energy than <math alttext="z_{t}" class="ltx_Math" display="inline" id="S7.SS2.SSS3.p4.2.m2.1"><semantics id="S7.SS2.SSS3.p4.2.m2.1a"><msub id="S7.SS2.SSS3.p4.2.m2.1.1" xref="S7.SS2.SSS3.p4.2.m2.1.1.cmml"><mi id="S7.SS2.SSS3.p4.2.m2.1.1.2" xref="S7.SS2.SSS3.p4.2.m2.1.1.2.cmml">z</mi><mi id="S7.SS2.SSS3.p4.2.m2.1.1.3" xref="S7.SS2.SSS3.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS3.p4.2.m2.1b"><apply id="S7.SS2.SSS3.p4.2.m2.1.1.cmml" xref="S7.SS2.SSS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS3.p4.2.m2.1.1.1.cmml" xref="S7.SS2.SSS3.p4.2.m2.1.1">subscript</csymbol><ci id="S7.SS2.SSS3.p4.2.m2.1.1.2.cmml" xref="S7.SS2.SSS3.p4.2.m2.1.1.2">𝑧</ci><ci id="S7.SS2.SSS3.p4.2.m2.1.1.3.cmml" xref="S7.SS2.SSS3.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS3.p4.2.m2.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS3.p4.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The use of ReLU ensures only positive differences contribute to the loss.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS3.p5">
<p class="ltx_p" id="S7.SS2.SSS3.p5.1">This energy-based regularization improves stability, prevents latent state explosion during training, and enhances robustness in noisy environments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.4 </span>Orthogonality and Numerical Stability</h4>
<div class="ltx_para" id="S7.SS2.SSS4.p1">
<p class="ltx_p" id="S7.SS2.SSS4.p1.2">In order to guarantee the well-conditioning of the Koopman operator and avoid degenerate latent projections, orthogonality of the projection matrices <math alttext="U" class="ltx_Math" display="inline" id="S7.SS2.SSS4.p1.1.m1.1"><semantics id="S7.SS2.SSS4.p1.1.m1.1a"><mi id="S7.SS2.SSS4.p1.1.m1.1.1" xref="S7.SS2.SSS4.p1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS4.p1.1.m1.1b"><ci id="S7.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S7.SS2.SSS4.p1.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS4.p1.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS4.p1.1.m1.1d">italic_U</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S7.SS2.SSS4.p1.2.m2.1"><semantics id="S7.SS2.SSS4.p1.2.m2.1a"><mi id="S7.SS2.SSS4.p1.2.m2.1.1" xref="S7.SS2.SSS4.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS4.p1.2.m2.1b"><ci id="S7.SS2.SSS4.p1.2.m2.1.1.cmml" xref="S7.SS2.SSS4.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS4.p1.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS4.p1.2.m2.1d">italic_V</annotation></semantics></math> is enforced through Householder orthogonalization (Householder QR orthogonalization):</p>
<table class="ltx_equation ltx_eqn_table" id="S7.E49">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="U^{\top}U=I,\quad V^{\top}V=I." class="ltx_Math" display="block" id="S7.E49.m1.1"><semantics id="S7.E49.m1.1a"><mrow id="S7.E49.m1.1.1.1"><mrow id="S7.E49.m1.1.1.1.1.2" xref="S7.E49.m1.1.1.1.1.3.cmml"><mrow id="S7.E49.m1.1.1.1.1.1.1" xref="S7.E49.m1.1.1.1.1.1.1.cmml"><mrow id="S7.E49.m1.1.1.1.1.1.1.2" xref="S7.E49.m1.1.1.1.1.1.1.2.cmml"><msup id="S7.E49.m1.1.1.1.1.1.1.2.2" xref="S7.E49.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S7.E49.m1.1.1.1.1.1.1.2.2.2" xref="S7.E49.m1.1.1.1.1.1.1.2.2.2.cmml">U</mi><mo id="S7.E49.m1.1.1.1.1.1.1.2.2.3" xref="S7.E49.m1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msup><mo id="S7.E49.m1.1.1.1.1.1.1.2.1" xref="S7.E49.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S7.E49.m1.1.1.1.1.1.1.2.3" xref="S7.E49.m1.1.1.1.1.1.1.2.3.cmml">U</mi></mrow><mo id="S7.E49.m1.1.1.1.1.1.1.1" xref="S7.E49.m1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S7.E49.m1.1.1.1.1.1.1.3" xref="S7.E49.m1.1.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S7.E49.m1.1.1.1.1.2.3" rspace="1.167em" xref="S7.E49.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S7.E49.m1.1.1.1.1.2.2" xref="S7.E49.m1.1.1.1.1.2.2.cmml"><mrow id="S7.E49.m1.1.1.1.1.2.2.2" xref="S7.E49.m1.1.1.1.1.2.2.2.cmml"><msup id="S7.E49.m1.1.1.1.1.2.2.2.2" xref="S7.E49.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S7.E49.m1.1.1.1.1.2.2.2.2.2" xref="S7.E49.m1.1.1.1.1.2.2.2.2.2.cmml">V</mi><mo id="S7.E49.m1.1.1.1.1.2.2.2.2.3" xref="S7.E49.m1.1.1.1.1.2.2.2.2.3.cmml">⊤</mo></msup><mo id="S7.E49.m1.1.1.1.1.2.2.2.1" xref="S7.E49.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S7.E49.m1.1.1.1.1.2.2.2.3" xref="S7.E49.m1.1.1.1.1.2.2.2.3.cmml">V</mi></mrow><mo id="S7.E49.m1.1.1.1.1.2.2.1" xref="S7.E49.m1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S7.E49.m1.1.1.1.1.2.2.3" xref="S7.E49.m1.1.1.1.1.2.2.3.cmml">I</mi></mrow></mrow><mo id="S7.E49.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.E49.m1.1b"><apply id="S7.E49.m1.1.1.1.1.3.cmml" xref="S7.E49.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.E49.m1.1.1.1.1.3a.cmml" xref="S7.E49.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S7.E49.m1.1.1.1.1.1.1.cmml" xref="S7.E49.m1.1.1.1.1.1.1"><eq id="S7.E49.m1.1.1.1.1.1.1.1.cmml" xref="S7.E49.m1.1.1.1.1.1.1.1"></eq><apply id="S7.E49.m1.1.1.1.1.1.1.2.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2"><times id="S7.E49.m1.1.1.1.1.1.1.2.1.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.1"></times><apply id="S7.E49.m1.1.1.1.1.1.1.2.2.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S7.E49.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S7.E49.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.2.2">𝑈</ci><csymbol cd="latexml" id="S7.E49.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><ci id="S7.E49.m1.1.1.1.1.1.1.2.3.cmml" xref="S7.E49.m1.1.1.1.1.1.1.2.3">𝑈</ci></apply><ci id="S7.E49.m1.1.1.1.1.1.1.3.cmml" xref="S7.E49.m1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S7.E49.m1.1.1.1.1.2.2.cmml" xref="S7.E49.m1.1.1.1.1.2.2"><eq id="S7.E49.m1.1.1.1.1.2.2.1.cmml" xref="S7.E49.m1.1.1.1.1.2.2.1"></eq><apply id="S7.E49.m1.1.1.1.1.2.2.2.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2"><times id="S7.E49.m1.1.1.1.1.2.2.2.1.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.1"></times><apply id="S7.E49.m1.1.1.1.1.2.2.2.2.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S7.E49.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S7.E49.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.2.2">𝑉</ci><csymbol cd="latexml" id="S7.E49.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.2.3">top</csymbol></apply><ci id="S7.E49.m1.1.1.1.1.2.2.2.3.cmml" xref="S7.E49.m1.1.1.1.1.2.2.2.3">𝑉</ci></apply><ci id="S7.E49.m1.1.1.1.1.2.2.3.cmml" xref="S7.E49.m1.1.1.1.1.2.2.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E49.m1.1c">U^{\top}U=I,\quad V^{\top}V=I.</annotation><annotation encoding="application/x-llamapun" id="S7.E49.m1.1d">italic_U start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_U = italic_I , italic_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_V = italic_I .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(49)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS2.SSS4.p2">
<p class="ltx_p" id="S7.SS2.SSS4.p2.1">Orthogonal matrices ensure that latent transformations remain rotation-like without amplifying or distorting latent representations.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS4.p3">
<p class="ltx_p" id="S7.SS2.SSS4.p3.1">This prevents ill-conditioning during optimization, improves numerical stability, and preserves interpretability of latent dynamics.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Koopman-Enhanced Transformer Formulation</h3>
<div class="ltx_para" id="S7.SS3.p1">
<p class="ltx_p" id="S7.SS3.p1.1">In summary, the proposed Deep Koopformer formulation combines Transformer-based encoders with stability-constrained Koopman operators, offering:</p>
</div>
<div class="ltx_para" id="S7.SS3.p2">
<ul class="ltx_itemize" id="S7.I2">
<li class="ltx_item" id="S7.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i1.p1">
<p class="ltx_p" id="S7.I2.i1.p1.1">Flexible temporal modeling via Transformer backbones (<span class="ltx_text ltx_font_typewriter" id="S7.I2.i1.p1.1.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S7.I2.i1.p1.1.2">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S7.I2.i1.p1.1.3">Informer</span>).</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i2.p1">
<p class="ltx_p" id="S7.I2.i2.p1.1">Linear latent propagation with stability via Koopman operator and spectral constraints.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i3.p1">
<p class="ltx_p" id="S7.I2.i3.p1.1">Energy regulation through Lyapunov loss to avoid latent explosion.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i4.p1">
<p class="ltx_p" id="S7.I2.i4.p1.1">Numerical robustness through orthogonalization of Koopman matrices.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS3.p3">
<p class="ltx_p" id="S7.SS3.p3.1">This framework ensures accurate, interpretable, and robust long-horizon forecasting while respecting the inherent physical properties of dynamical systems.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>Application to Noisy Dynamical Systems</h3>
<div class="ltx_para" id="S7.SS4.p1">
<p class="ltx_p" id="S7.SS4.p1.1">An important application area for Koopman-enhanced Transformer architectures is the forecasting of noisy nonlinear dynamical systems. As demonstrated in this study with synthetic signals, real-world processes often exhibit complex temporal dynamics combined with stochastic perturbations.</p>
</div>
<section class="ltx_paragraph" id="S7.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Van der Pol oscillator</h5>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p1.1">The Van der Pol oscillator is a second-order nonlinear ordinary differential equation (ODE) used to model various physical phenomena. The standard form of the Van der Pol equation is given by:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{d^{2}x}{dt^{2}}-\mu(1-x^{2})\frac{dx}{dt}+x=0" class="ltx_Math" display="block" id="S7.Ex34.m1.1"><semantics id="S7.Ex34.m1.1a"><mrow id="S7.Ex34.m1.1.1" xref="S7.Ex34.m1.1.1.cmml"><mrow id="S7.Ex34.m1.1.1.1" xref="S7.Ex34.m1.1.1.1.cmml"><mrow id="S7.Ex34.m1.1.1.1.1" xref="S7.Ex34.m1.1.1.1.1.cmml"><mfrac id="S7.Ex34.m1.1.1.1.1.3" xref="S7.Ex34.m1.1.1.1.1.3.cmml"><mrow id="S7.Ex34.m1.1.1.1.1.3.2" xref="S7.Ex34.m1.1.1.1.1.3.2.cmml"><msup id="S7.Ex34.m1.1.1.1.1.3.2.2" xref="S7.Ex34.m1.1.1.1.1.3.2.2.cmml"><mi id="S7.Ex34.m1.1.1.1.1.3.2.2.2" xref="S7.Ex34.m1.1.1.1.1.3.2.2.2.cmml">d</mi><mn id="S7.Ex34.m1.1.1.1.1.3.2.2.3" xref="S7.Ex34.m1.1.1.1.1.3.2.2.3.cmml">2</mn></msup><mo id="S7.Ex34.m1.1.1.1.1.3.2.1" xref="S7.Ex34.m1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S7.Ex34.m1.1.1.1.1.3.2.3" xref="S7.Ex34.m1.1.1.1.1.3.2.3.cmml">x</mi></mrow><mrow id="S7.Ex34.m1.1.1.1.1.3.3" xref="S7.Ex34.m1.1.1.1.1.3.3.cmml"><mi id="S7.Ex34.m1.1.1.1.1.3.3.2" xref="S7.Ex34.m1.1.1.1.1.3.3.2.cmml">d</mi><mo id="S7.Ex34.m1.1.1.1.1.3.3.1" xref="S7.Ex34.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msup id="S7.Ex34.m1.1.1.1.1.3.3.3" xref="S7.Ex34.m1.1.1.1.1.3.3.3.cmml"><mi id="S7.Ex34.m1.1.1.1.1.3.3.3.2" xref="S7.Ex34.m1.1.1.1.1.3.3.3.2.cmml">t</mi><mn id="S7.Ex34.m1.1.1.1.1.3.3.3.3" xref="S7.Ex34.m1.1.1.1.1.3.3.3.3.cmml">2</mn></msup></mrow></mfrac><mo id="S7.Ex34.m1.1.1.1.1.2" xref="S7.Ex34.m1.1.1.1.1.2.cmml">−</mo><mrow id="S7.Ex34.m1.1.1.1.1.1" xref="S7.Ex34.m1.1.1.1.1.1.cmml"><mi id="S7.Ex34.m1.1.1.1.1.1.3" xref="S7.Ex34.m1.1.1.1.1.1.3.cmml">μ</mi><mo id="S7.Ex34.m1.1.1.1.1.1.2" xref="S7.Ex34.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex34.m1.1.1.1.1.1.1.1" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex34.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex34.m1.1.1.1.1.1.1.1.1" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.cmml"><mn id="S7.Ex34.m1.1.1.1.1.1.1.1.1.2" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S7.Ex34.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S7.Ex34.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S7.Ex34.m1.1.1.1.1.1.2a" xref="S7.Ex34.m1.1.1.1.1.1.2.cmml">⁢</mo><mfrac id="S7.Ex34.m1.1.1.1.1.1.4" xref="S7.Ex34.m1.1.1.1.1.1.4.cmml"><mrow id="S7.Ex34.m1.1.1.1.1.1.4.2" xref="S7.Ex34.m1.1.1.1.1.1.4.2.cmml"><mi id="S7.Ex34.m1.1.1.1.1.1.4.2.2" xref="S7.Ex34.m1.1.1.1.1.1.4.2.2.cmml">d</mi><mo id="S7.Ex34.m1.1.1.1.1.1.4.2.1" xref="S7.Ex34.m1.1.1.1.1.1.4.2.1.cmml">⁢</mo><mi id="S7.Ex34.m1.1.1.1.1.1.4.2.3" xref="S7.Ex34.m1.1.1.1.1.1.4.2.3.cmml">x</mi></mrow><mrow id="S7.Ex34.m1.1.1.1.1.1.4.3" xref="S7.Ex34.m1.1.1.1.1.1.4.3.cmml"><mi id="S7.Ex34.m1.1.1.1.1.1.4.3.2" xref="S7.Ex34.m1.1.1.1.1.1.4.3.2.cmml">d</mi><mo id="S7.Ex34.m1.1.1.1.1.1.4.3.1" xref="S7.Ex34.m1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S7.Ex34.m1.1.1.1.1.1.4.3.3" xref="S7.Ex34.m1.1.1.1.1.1.4.3.3.cmml">t</mi></mrow></mfrac></mrow></mrow><mo id="S7.Ex34.m1.1.1.1.2" xref="S7.Ex34.m1.1.1.1.2.cmml">+</mo><mi id="S7.Ex34.m1.1.1.1.3" xref="S7.Ex34.m1.1.1.1.3.cmml">x</mi></mrow><mo id="S7.Ex34.m1.1.1.2" xref="S7.Ex34.m1.1.1.2.cmml">=</mo><mn id="S7.Ex34.m1.1.1.3" xref="S7.Ex34.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex34.m1.1b"><apply id="S7.Ex34.m1.1.1.cmml" xref="S7.Ex34.m1.1.1"><eq id="S7.Ex34.m1.1.1.2.cmml" xref="S7.Ex34.m1.1.1.2"></eq><apply id="S7.Ex34.m1.1.1.1.cmml" xref="S7.Ex34.m1.1.1.1"><plus id="S7.Ex34.m1.1.1.1.2.cmml" xref="S7.Ex34.m1.1.1.1.2"></plus><apply id="S7.Ex34.m1.1.1.1.1.cmml" xref="S7.Ex34.m1.1.1.1.1"><minus id="S7.Ex34.m1.1.1.1.1.2.cmml" xref="S7.Ex34.m1.1.1.1.1.2"></minus><apply id="S7.Ex34.m1.1.1.1.1.3.cmml" xref="S7.Ex34.m1.1.1.1.1.3"><divide id="S7.Ex34.m1.1.1.1.1.3.1.cmml" xref="S7.Ex34.m1.1.1.1.1.3"></divide><apply id="S7.Ex34.m1.1.1.1.1.3.2.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2"><times id="S7.Ex34.m1.1.1.1.1.3.2.1.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2.1"></times><apply id="S7.Ex34.m1.1.1.1.1.3.2.2.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S7.Ex34.m1.1.1.1.1.3.2.2.1.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S7.Ex34.m1.1.1.1.1.3.2.2.2.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2.2.2">𝑑</ci><cn id="S7.Ex34.m1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S7.Ex34.m1.1.1.1.1.3.2.2.3">2</cn></apply><ci id="S7.Ex34.m1.1.1.1.1.3.2.3.cmml" xref="S7.Ex34.m1.1.1.1.1.3.2.3">𝑥</ci></apply><apply id="S7.Ex34.m1.1.1.1.1.3.3.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3"><times id="S7.Ex34.m1.1.1.1.1.3.3.1.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3.1"></times><ci id="S7.Ex34.m1.1.1.1.1.3.3.2.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3.2">𝑑</ci><apply id="S7.Ex34.m1.1.1.1.1.3.3.3.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S7.Ex34.m1.1.1.1.1.3.3.3.1.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S7.Ex34.m1.1.1.1.1.3.3.3.2.cmml" xref="S7.Ex34.m1.1.1.1.1.3.3.3.2">𝑡</ci><cn id="S7.Ex34.m1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S7.Ex34.m1.1.1.1.1.3.3.3.3">2</cn></apply></apply></apply><apply id="S7.Ex34.m1.1.1.1.1.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1"><times id="S7.Ex34.m1.1.1.1.1.1.2.cmml" xref="S7.Ex34.m1.1.1.1.1.1.2"></times><ci id="S7.Ex34.m1.1.1.1.1.1.3.cmml" xref="S7.Ex34.m1.1.1.1.1.1.3">𝜇</ci><apply id="S7.Ex34.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.1.1"><minus id="S7.Ex34.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.1"></minus><cn id="S7.Ex34.m1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex34.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S7.Ex34.m1.1.1.1.1.1.4.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4"><divide id="S7.Ex34.m1.1.1.1.1.1.4.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4"></divide><apply id="S7.Ex34.m1.1.1.1.1.1.4.2.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.2"><times id="S7.Ex34.m1.1.1.1.1.1.4.2.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.2.1"></times><ci id="S7.Ex34.m1.1.1.1.1.1.4.2.2.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.2.2">𝑑</ci><ci id="S7.Ex34.m1.1.1.1.1.1.4.2.3.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.2.3">𝑥</ci></apply><apply id="S7.Ex34.m1.1.1.1.1.1.4.3.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.3"><times id="S7.Ex34.m1.1.1.1.1.1.4.3.1.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.3.1"></times><ci id="S7.Ex34.m1.1.1.1.1.1.4.3.2.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.3.2">𝑑</ci><ci id="S7.Ex34.m1.1.1.1.1.1.4.3.3.cmml" xref="S7.Ex34.m1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></apply><ci id="S7.Ex34.m1.1.1.1.3.cmml" xref="S7.Ex34.m1.1.1.1.3">𝑥</ci></apply><cn id="S7.Ex34.m1.1.1.3.cmml" type="integer" xref="S7.Ex34.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex34.m1.1c">\frac{d^{2}x}{dt^{2}}-\mu(1-x^{2})\frac{dx}{dt}+x=0</annotation><annotation encoding="application/x-llamapun" id="S7.Ex34.m1.1d">divide start_ARG italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_x end_ARG start_ARG italic_d italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - italic_μ ( 1 - italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) divide start_ARG italic_d italic_x end_ARG start_ARG italic_d italic_t end_ARG + italic_x = 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p3">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p3.1">where:</p>
<ul class="ltx_itemize" id="S7.I3">
<li class="ltx_item" id="S7.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I3.i1.p1">
<p class="ltx_p" id="S7.I3.i1.p1.1"><math alttext="x(t)" class="ltx_Math" display="inline" id="S7.I3.i1.p1.1.m1.1"><semantics id="S7.I3.i1.p1.1.m1.1a"><mrow id="S7.I3.i1.p1.1.m1.1.2" xref="S7.I3.i1.p1.1.m1.1.2.cmml"><mi id="S7.I3.i1.p1.1.m1.1.2.2" xref="S7.I3.i1.p1.1.m1.1.2.2.cmml">x</mi><mo id="S7.I3.i1.p1.1.m1.1.2.1" xref="S7.I3.i1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S7.I3.i1.p1.1.m1.1.2.3.2" xref="S7.I3.i1.p1.1.m1.1.2.cmml"><mo id="S7.I3.i1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S7.I3.i1.p1.1.m1.1.2.cmml">(</mo><mi id="S7.I3.i1.p1.1.m1.1.1" xref="S7.I3.i1.p1.1.m1.1.1.cmml">t</mi><mo id="S7.I3.i1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S7.I3.i1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I3.i1.p1.1.m1.1b"><apply id="S7.I3.i1.p1.1.m1.1.2.cmml" xref="S7.I3.i1.p1.1.m1.1.2"><times id="S7.I3.i1.p1.1.m1.1.2.1.cmml" xref="S7.I3.i1.p1.1.m1.1.2.1"></times><ci id="S7.I3.i1.p1.1.m1.1.2.2.cmml" xref="S7.I3.i1.p1.1.m1.1.2.2">𝑥</ci><ci id="S7.I3.i1.p1.1.m1.1.1.cmml" xref="S7.I3.i1.p1.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I3.i1.p1.1.m1.1c">x(t)</annotation><annotation encoding="application/x-llamapun" id="S7.I3.i1.p1.1.m1.1d">italic_x ( italic_t )</annotation></semantics></math> is the state of the system (position),</p>
</div>
</li>
<li class="ltx_item" id="S7.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I3.i2.p1">
<p class="ltx_p" id="S7.I3.i2.p1.1"><math alttext="\frac{dx}{dt}" class="ltx_Math" display="inline" id="S7.I3.i2.p1.1.m1.1"><semantics id="S7.I3.i2.p1.1.m1.1a"><mfrac id="S7.I3.i2.p1.1.m1.1.1" xref="S7.I3.i2.p1.1.m1.1.1.cmml"><mrow id="S7.I3.i2.p1.1.m1.1.1.2" xref="S7.I3.i2.p1.1.m1.1.1.2.cmml"><mi id="S7.I3.i2.p1.1.m1.1.1.2.2" xref="S7.I3.i2.p1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.I3.i2.p1.1.m1.1.1.2.1" xref="S7.I3.i2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.I3.i2.p1.1.m1.1.1.2.3" xref="S7.I3.i2.p1.1.m1.1.1.2.3.cmml">x</mi></mrow><mrow id="S7.I3.i2.p1.1.m1.1.1.3" xref="S7.I3.i2.p1.1.m1.1.1.3.cmml"><mi id="S7.I3.i2.p1.1.m1.1.1.3.2" xref="S7.I3.i2.p1.1.m1.1.1.3.2.cmml">d</mi><mo id="S7.I3.i2.p1.1.m1.1.1.3.1" xref="S7.I3.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.I3.i2.p1.1.m1.1.1.3.3" xref="S7.I3.i2.p1.1.m1.1.1.3.3.cmml">t</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S7.I3.i2.p1.1.m1.1b"><apply id="S7.I3.i2.p1.1.m1.1.1.cmml" xref="S7.I3.i2.p1.1.m1.1.1"><divide id="S7.I3.i2.p1.1.m1.1.1.1.cmml" xref="S7.I3.i2.p1.1.m1.1.1"></divide><apply id="S7.I3.i2.p1.1.m1.1.1.2.cmml" xref="S7.I3.i2.p1.1.m1.1.1.2"><times id="S7.I3.i2.p1.1.m1.1.1.2.1.cmml" xref="S7.I3.i2.p1.1.m1.1.1.2.1"></times><ci id="S7.I3.i2.p1.1.m1.1.1.2.2.cmml" xref="S7.I3.i2.p1.1.m1.1.1.2.2">𝑑</ci><ci id="S7.I3.i2.p1.1.m1.1.1.2.3.cmml" xref="S7.I3.i2.p1.1.m1.1.1.2.3">𝑥</ci></apply><apply id="S7.I3.i2.p1.1.m1.1.1.3.cmml" xref="S7.I3.i2.p1.1.m1.1.1.3"><times id="S7.I3.i2.p1.1.m1.1.1.3.1.cmml" xref="S7.I3.i2.p1.1.m1.1.1.3.1"></times><ci id="S7.I3.i2.p1.1.m1.1.1.3.2.cmml" xref="S7.I3.i2.p1.1.m1.1.1.3.2">𝑑</ci><ci id="S7.I3.i2.p1.1.m1.1.1.3.3.cmml" xref="S7.I3.i2.p1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I3.i2.p1.1.m1.1c">\frac{dx}{dt}</annotation><annotation encoding="application/x-llamapun" id="S7.I3.i2.p1.1.m1.1d">divide start_ARG italic_d italic_x end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math> is the velocity (first derivative),</p>
</div>
</li>
<li class="ltx_item" id="S7.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I3.i3.p1">
<p class="ltx_p" id="S7.I3.i3.p1.1"><math alttext="\frac{d^{2}x}{dt^{2}}" class="ltx_Math" display="inline" id="S7.I3.i3.p1.1.m1.1"><semantics id="S7.I3.i3.p1.1.m1.1a"><mfrac id="S7.I3.i3.p1.1.m1.1.1" xref="S7.I3.i3.p1.1.m1.1.1.cmml"><mrow id="S7.I3.i3.p1.1.m1.1.1.2" xref="S7.I3.i3.p1.1.m1.1.1.2.cmml"><msup id="S7.I3.i3.p1.1.m1.1.1.2.2" xref="S7.I3.i3.p1.1.m1.1.1.2.2.cmml"><mi id="S7.I3.i3.p1.1.m1.1.1.2.2.2" xref="S7.I3.i3.p1.1.m1.1.1.2.2.2.cmml">d</mi><mn id="S7.I3.i3.p1.1.m1.1.1.2.2.3" xref="S7.I3.i3.p1.1.m1.1.1.2.2.3.cmml">2</mn></msup><mo id="S7.I3.i3.p1.1.m1.1.1.2.1" xref="S7.I3.i3.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.I3.i3.p1.1.m1.1.1.2.3" xref="S7.I3.i3.p1.1.m1.1.1.2.3.cmml">x</mi></mrow><mrow id="S7.I3.i3.p1.1.m1.1.1.3" xref="S7.I3.i3.p1.1.m1.1.1.3.cmml"><mi id="S7.I3.i3.p1.1.m1.1.1.3.2" xref="S7.I3.i3.p1.1.m1.1.1.3.2.cmml">d</mi><mo id="S7.I3.i3.p1.1.m1.1.1.3.1" xref="S7.I3.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S7.I3.i3.p1.1.m1.1.1.3.3" xref="S7.I3.i3.p1.1.m1.1.1.3.3.cmml"><mi id="S7.I3.i3.p1.1.m1.1.1.3.3.2" xref="S7.I3.i3.p1.1.m1.1.1.3.3.2.cmml">t</mi><mn id="S7.I3.i3.p1.1.m1.1.1.3.3.3" xref="S7.I3.i3.p1.1.m1.1.1.3.3.3.cmml">2</mn></msup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S7.I3.i3.p1.1.m1.1b"><apply id="S7.I3.i3.p1.1.m1.1.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1"><divide id="S7.I3.i3.p1.1.m1.1.1.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1"></divide><apply id="S7.I3.i3.p1.1.m1.1.1.2.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2"><times id="S7.I3.i3.p1.1.m1.1.1.2.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2.1"></times><apply id="S7.I3.i3.p1.1.m1.1.1.2.2.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S7.I3.i3.p1.1.m1.1.1.2.2.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2.2">superscript</csymbol><ci id="S7.I3.i3.p1.1.m1.1.1.2.2.2.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2.2.2">𝑑</ci><cn id="S7.I3.i3.p1.1.m1.1.1.2.2.3.cmml" type="integer" xref="S7.I3.i3.p1.1.m1.1.1.2.2.3">2</cn></apply><ci id="S7.I3.i3.p1.1.m1.1.1.2.3.cmml" xref="S7.I3.i3.p1.1.m1.1.1.2.3">𝑥</ci></apply><apply id="S7.I3.i3.p1.1.m1.1.1.3.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3"><times id="S7.I3.i3.p1.1.m1.1.1.3.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3.1"></times><ci id="S7.I3.i3.p1.1.m1.1.1.3.2.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3.2">𝑑</ci><apply id="S7.I3.i3.p1.1.m1.1.1.3.3.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S7.I3.i3.p1.1.m1.1.1.3.3.1.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3.3">superscript</csymbol><ci id="S7.I3.i3.p1.1.m1.1.1.3.3.2.cmml" xref="S7.I3.i3.p1.1.m1.1.1.3.3.2">𝑡</ci><cn id="S7.I3.i3.p1.1.m1.1.1.3.3.3.cmml" type="integer" xref="S7.I3.i3.p1.1.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I3.i3.p1.1.m1.1c">\frac{d^{2}x}{dt^{2}}</annotation><annotation encoding="application/x-llamapun" id="S7.I3.i3.p1.1.m1.1d">divide start_ARG italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_x end_ARG start_ARG italic_d italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is the acceleration (second derivative),</p>
</div>
</li>
<li class="ltx_item" id="S7.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I3.i4.p1">
<p class="ltx_p" id="S7.I3.i4.p1.1"><math alttext="\mu" class="ltx_Math" display="inline" id="S7.I3.i4.p1.1.m1.1"><semantics id="S7.I3.i4.p1.1.m1.1a"><mi id="S7.I3.i4.p1.1.m1.1.1" xref="S7.I3.i4.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S7.I3.i4.p1.1.m1.1b"><ci id="S7.I3.i4.p1.1.m1.1.1.cmml" xref="S7.I3.i4.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I3.i4.p1.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S7.I3.i4.p1.1.m1.1d">italic_μ</annotation></semantics></math> is a nonlinearity parameter that controls the amplitude and damping of the system.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p4">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p4.3">This system can be rewritten as a set of two first-order differential equations by defining the state vector <math alttext="\mathbf{z}(t)=\begin{bmatrix}x_{1}(t)\\
x_{2}(t)\end{bmatrix}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p4.1.m1.2"><semantics id="S7.SS4.SSS0.Px1.p4.1.m1.2a"><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.2.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.cmml"><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.cmml"><mi id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.2.cmml">𝐳</mi><mo id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.3.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.cmml"><mo id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.3.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p4.1.m1.2.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.2.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.3.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.1.cmml">=</mo><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.2.cmml"><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.3.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.2.1.cmml">[</mo><mtable id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1" rowspacing="0pt" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mtr id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1a" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mtd id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1b" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1c" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mtd id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1d" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.cmml"><msub id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.3" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.3.cmml">2</mn></msub><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.4.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.cmml"><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.4.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.1" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.1.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.4.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mtd></mtr></mtable><mo id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.3.2" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p4.1.m1.2b"><apply id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3"><eq id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.1"></eq><apply id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2"><times id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.1"></times><ci id="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.3.2.2">𝐳</ci><ci id="S7.SS4.SSS0.Px1.p4.1.m1.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.2.2">𝑡</ci></apply><apply id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.3"><csymbol cd="latexml" id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.3.1">matrix</csymbol><matrix id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1"><matrixrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1a.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1"><apply id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1"><times id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><ci id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.1.1.1.1.1">𝑡</ci></apply></matrixrow><matrixrow id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1b.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1"><apply id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1"><times id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.2"></times><apply id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.3.3">2</cn></apply><ci id="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.1.m1.1.1.1.1.2.2.1.1.1">𝑡</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p4.1.m1.2c">\mathbf{z}(t)=\begin{bmatrix}x_{1}(t)\\
x_{2}(t)\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p4.1.m1.2d">bold_z ( italic_t ) = [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW end_ARG ]</annotation></semantics></math>, where <math alttext="x(t)" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p4.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p4.2.m2.1a"><mrow id="S7.SS4.SSS0.Px1.p4.2.m2.1.2" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.cmml"><mi id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.2" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.2.cmml">x</mi><mo id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.1" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.3.2" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.cmml"><mo id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p4.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.1.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p4.2.m2.1b"><apply id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.cmml" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2"><times id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.1"></times><ci id="S7.SS4.SSS0.Px1.p4.2.m2.1.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.2.2">𝑥</ci><ci id="S7.SS4.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p4.2.m2.1c">x(t)</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p4.2.m2.1d">italic_x ( italic_t )</annotation></semantics></math> is the position and <math alttext="v(t)=\frac{dx}{dt}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p4.3.m3.1"><semantics id="S7.SS4.SSS0.Px1.p4.3.m3.1a"><mrow id="S7.SS4.SSS0.Px1.p4.3.m3.1.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.cmml"><mrow id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.cmml"><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.2.cmml">v</mi><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.1" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.3.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.cmml"><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.3.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.1" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.1.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.3.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.1" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.1.cmml">=</mo><mfrac id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.cmml"><mrow id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.cmml"><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.2.cmml">d</mi><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.1" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.1.cmml">⁢</mo><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.3" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.3.cmml">x</mi></mrow><mrow id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.cmml"><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.2" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.2.cmml">d</mi><mo id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.1" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.1.cmml">⁢</mo><mi id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.3" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.3.cmml">t</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p4.3.m3.1b"><apply id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2"><eq id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.1"></eq><apply id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2"><times id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.1"></times><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.2.2">𝑣</ci><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.1">𝑡</ci></apply><apply id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3"><divide id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3"></divide><apply id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2"><times id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.1"></times><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.2">𝑑</ci><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.3.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.2.3">𝑥</ci></apply><apply id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3"><times id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.1.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.1"></times><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.2.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.2">𝑑</ci><ci id="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.3.cmml" xref="S7.SS4.SSS0.Px1.p4.3.m3.1.2.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p4.3.m3.1c">v(t)=\frac{dx}{dt}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p4.3.m3.1d">italic_v ( italic_t ) = divide start_ARG italic_d italic_x end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math> is the velocity:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p5">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{d}{dt}\begin{bmatrix}x_{1}(t)\\
x_{2}(t)\end{bmatrix}=\begin{bmatrix}x_{2}(t)\\
\mu(1-x_{1}(t)^{2})x_{2}(t)-x_{1}(t)\end{bmatrix}" class="ltx_Math" display="block" id="S7.Ex35.m1.2"><semantics id="S7.Ex35.m1.2a"><mrow id="S7.Ex35.m1.2.3" xref="S7.Ex35.m1.2.3.cmml"><mrow id="S7.Ex35.m1.2.3.2" xref="S7.Ex35.m1.2.3.2.cmml"><mfrac id="S7.Ex35.m1.2.3.2.2" xref="S7.Ex35.m1.2.3.2.2.cmml"><mi id="S7.Ex35.m1.2.3.2.2.2" xref="S7.Ex35.m1.2.3.2.2.2.cmml">d</mi><mrow id="S7.Ex35.m1.2.3.2.2.3" xref="S7.Ex35.m1.2.3.2.2.3.cmml"><mi id="S7.Ex35.m1.2.3.2.2.3.2" xref="S7.Ex35.m1.2.3.2.2.3.2.cmml">d</mi><mo id="S7.Ex35.m1.2.3.2.2.3.1" xref="S7.Ex35.m1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S7.Ex35.m1.2.3.2.2.3.3" xref="S7.Ex35.m1.2.3.2.2.3.3.cmml">t</mi></mrow></mfrac><mo id="S7.Ex35.m1.2.3.2.1" xref="S7.Ex35.m1.2.3.2.1.cmml">⁢</mo><mrow id="S7.Ex35.m1.1.1.3" xref="S7.Ex35.m1.1.1.2.cmml"><mo id="S7.Ex35.m1.1.1.3.1" xref="S7.Ex35.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S7.Ex35.m1.1.1.1.1" rowspacing="0pt" xref="S7.Ex35.m1.1.1.1.1.cmml"><mtr id="S7.Ex35.m1.1.1.1.1a" xref="S7.Ex35.m1.1.1.1.1.cmml"><mtd id="S7.Ex35.m1.1.1.1.1b" xref="S7.Ex35.m1.1.1.1.1.cmml"><mrow id="S7.Ex35.m1.1.1.1.1.1.1.1.1" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S7.Ex35.m1.1.1.1.1.1.1.1.1.2" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex35.m1.1.1.1.1.1.1.1.1.4.2" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex35.m1.1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S7.Ex35.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.1.cmml">t</mi><mo id="S7.Ex35.m1.1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S7.Ex35.m1.1.1.1.1c" xref="S7.Ex35.m1.1.1.1.1.cmml"><mtd id="S7.Ex35.m1.1.1.1.1d" xref="S7.Ex35.m1.1.1.1.1.cmml"><mrow id="S7.Ex35.m1.1.1.1.1.2.2.1.1" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.cmml"><msub id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.2" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.2.cmml">x</mi><mn id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.3" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.3.cmml">2</mn></msub><mo id="S7.Ex35.m1.1.1.1.1.2.2.1.1.2" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="S7.Ex35.m1.1.1.1.1.2.2.1.1.4.2" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.cmml"><mo id="S7.Ex35.m1.1.1.1.1.2.2.1.1.4.2.1" stretchy="false" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mi id="S7.Ex35.m1.1.1.1.1.2.2.1.1.1" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.1.cmml">t</mi><mo id="S7.Ex35.m1.1.1.1.1.2.2.1.1.4.2.2" stretchy="false" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mtd></mtr></mtable><mo id="S7.Ex35.m1.1.1.3.2" xref="S7.Ex35.m1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S7.Ex35.m1.2.3.1" xref="S7.Ex35.m1.2.3.1.cmml">=</mo><mrow id="S7.Ex35.m1.2.2.3" xref="S7.Ex35.m1.2.2.2.cmml"><mo id="S7.Ex35.m1.2.2.3.1" xref="S7.Ex35.m1.2.2.2.1.cmml">[</mo><mtable displaystyle="true" id="S7.Ex35.m1.2.2.1.1" rowspacing="0pt" xref="S7.Ex35.m1.2.2.1.1.cmml"><mtr id="S7.Ex35.m1.2.2.1.1a" xref="S7.Ex35.m1.2.2.1.1.cmml"><mtd id="S7.Ex35.m1.2.2.1.1b" xref="S7.Ex35.m1.2.2.1.1.cmml"><mrow id="S7.Ex35.m1.2.2.1.1.1.1.1.1" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.2" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.3" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S7.Ex35.m1.2.2.1.1.1.1.1.1.2" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex35.m1.2.2.1.1.1.1.1.1.4.2" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S7.Ex35.m1.2.2.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S7.Ex35.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.1.cmml">t</mi><mo id="S7.Ex35.m1.2.2.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S7.Ex35.m1.2.2.1.1c" xref="S7.Ex35.m1.2.2.1.1.cmml"><mtd id="S7.Ex35.m1.2.2.1.1d" xref="S7.Ex35.m1.2.2.1.1.cmml"><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.cmml"><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.cmml"><mi id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.3.cmml">μ</mi><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2.cmml">⁢</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.cmml"><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.2" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.cmml">(</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.cmml"><mn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.2.cmml">1</mn><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.1" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.1.cmml">−</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.cmml"><msub id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.cmml"><mi id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.2.cmml">x</mi><mn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.1" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.1.cmml">⁢</mo><msup id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.cmml"><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.2.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.cmml"><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.2.2.1" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.cmml">(</mo><mi id="S7.Ex35.m1.2.2.1.1.2.2.1.1.1" xref="S7.Ex35.m1.2.2.1.1.2.2.1.1.1.cmml">t</mi><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.2.2.2" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.cmml">)</mo></mrow><mn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.3" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2a" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2.cmml">⁢</mo><msub id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.cmml"><mi id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.2.cmml">x</mi><mn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.3.cmml">2</mn></msub><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2b" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2.cmml">⁢</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.5.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.cmml"><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.5.2.1" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.cmml">(</mo><mi id="S7.Ex35.m1.2.2.1.1.3.3.2.2.2" xref="S7.Ex35.m1.2.2.1.1.3.3.2.2.2.cmml">t</mi><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.5.2.2" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.cmml">)</mo></mrow></mrow><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.5" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.5.cmml">−</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.cmml"><msub id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.cmml"><mi id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.2.cmml">x</mi><mn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.3" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.3.cmml">1</mn></msub><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.1" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.1.cmml">⁢</mo><mrow id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.3.2" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.cmml"><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.3.2.1" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.cmml">(</mo><mi id="S7.Ex35.m1.2.2.1.1.4.4.3.3.3" xref="S7.Ex35.m1.2.2.1.1.4.4.3.3.3.cmml">t</mi><mo id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.3.2.2" stretchy="false" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><mo id="S7.Ex35.m1.2.2.3.2" xref="S7.Ex35.m1.2.2.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex35.m1.2b"><apply id="S7.Ex35.m1.2.3.cmml" xref="S7.Ex35.m1.2.3"><eq id="S7.Ex35.m1.2.3.1.cmml" xref="S7.Ex35.m1.2.3.1"></eq><apply id="S7.Ex35.m1.2.3.2.cmml" xref="S7.Ex35.m1.2.3.2"><times id="S7.Ex35.m1.2.3.2.1.cmml" xref="S7.Ex35.m1.2.3.2.1"></times><apply id="S7.Ex35.m1.2.3.2.2.cmml" xref="S7.Ex35.m1.2.3.2.2"><divide id="S7.Ex35.m1.2.3.2.2.1.cmml" xref="S7.Ex35.m1.2.3.2.2"></divide><ci id="S7.Ex35.m1.2.3.2.2.2.cmml" xref="S7.Ex35.m1.2.3.2.2.2">𝑑</ci><apply id="S7.Ex35.m1.2.3.2.2.3.cmml" xref="S7.Ex35.m1.2.3.2.2.3"><times id="S7.Ex35.m1.2.3.2.2.3.1.cmml" xref="S7.Ex35.m1.2.3.2.2.3.1"></times><ci id="S7.Ex35.m1.2.3.2.2.3.2.cmml" xref="S7.Ex35.m1.2.3.2.2.3.2">𝑑</ci><ci id="S7.Ex35.m1.2.3.2.2.3.3.cmml" xref="S7.Ex35.m1.2.3.2.2.3.3">𝑡</ci></apply></apply><apply id="S7.Ex35.m1.1.1.2.cmml" xref="S7.Ex35.m1.1.1.3"><csymbol cd="latexml" id="S7.Ex35.m1.1.1.2.1.cmml" xref="S7.Ex35.m1.1.1.3.1">matrix</csymbol><matrix id="S7.Ex35.m1.1.1.1.1.cmml" xref="S7.Ex35.m1.1.1.1.1"><matrixrow id="S7.Ex35.m1.1.1.1.1a.cmml" xref="S7.Ex35.m1.1.1.1.1"><apply id="S7.Ex35.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1"><times id="S7.Ex35.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><ci id="S7.Ex35.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex35.m1.1.1.1.1.1.1.1.1.1">𝑡</ci></apply></matrixrow><matrixrow id="S7.Ex35.m1.1.1.1.1b.cmml" xref="S7.Ex35.m1.1.1.1.1"><apply id="S7.Ex35.m1.1.1.1.1.2.2.1.1.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1"><times id="S7.Ex35.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.2"></times><apply id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.2">𝑥</ci><cn id="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.3.3">2</cn></apply><ci id="S7.Ex35.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S7.Ex35.m1.1.1.1.1.2.2.1.1.1">𝑡</ci></apply></matrixrow></matrix></apply></apply><apply id="S7.Ex35.m1.2.2.2.cmml" xref="S7.Ex35.m1.2.2.3"><csymbol cd="latexml" id="S7.Ex35.m1.2.2.2.1.cmml" xref="S7.Ex35.m1.2.2.3.1">matrix</csymbol><matrix id="S7.Ex35.m1.2.2.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1"><matrixrow id="S7.Ex35.m1.2.2.1.1a.cmml" xref="S7.Ex35.m1.2.2.1.1"><apply id="S7.Ex35.m1.2.2.1.1.1.1.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1"><times id="S7.Ex35.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S7.Ex35.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1.1.1.1.1.1">𝑡</ci></apply></matrixrow><matrixrow id="S7.Ex35.m1.2.2.1.1b.cmml" xref="S7.Ex35.m1.2.2.1.1"><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4"><minus id="S7.Ex35.m1.2.2.1.1.5.5.4.4.5.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.5"></minus><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4"><times id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.2"></times><ci id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.3.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.3">𝜇</ci><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1"><minus id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.1"></minus><cn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.2.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.2">1</cn><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3"><times id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.1"></times><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2">subscript</csymbol><ci id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.2">𝑥</ci><cn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.3.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.2.3">1</cn></apply><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3">superscript</csymbol><ci id="S7.Ex35.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S7.Ex35.m1.2.2.1.1.2.2.1.1.1">𝑡</ci><cn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.3.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4"><csymbol cd="ambiguous" id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4">subscript</csymbol><ci id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.2">𝑥</ci><cn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.3.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.4.4.3">2</cn></apply><ci id="S7.Ex35.m1.2.2.1.1.3.3.2.2.2.cmml" xref="S7.Ex35.m1.2.2.1.1.3.3.2.2.2">𝑡</ci></apply><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6"><times id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.1"></times><apply id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2"><csymbol cd="ambiguous" id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.1.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2">subscript</csymbol><ci id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.2.cmml" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.2">𝑥</ci><cn id="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.3.cmml" type="integer" xref="S7.Ex35.m1.2.2.1.1.5.5.4.4.6.2.3">1</cn></apply><ci id="S7.Ex35.m1.2.2.1.1.4.4.3.3.3.cmml" xref="S7.Ex35.m1.2.2.1.1.4.4.3.3.3">𝑡</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex35.m1.2c">\frac{d}{dt}\begin{bmatrix}x_{1}(t)\\
x_{2}(t)\end{bmatrix}=\begin{bmatrix}x_{2}(t)\\
\mu(1-x_{1}(t)^{2})x_{2}(t)-x_{1}(t)\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex35.m1.2d">divide start_ARG italic_d end_ARG start_ARG italic_d italic_t end_ARG [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW end_ARG ] = [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW start_ROW start_CELL italic_μ ( 1 - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p6">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p6.1">Thus, the system of first-order equations governing the dynamics of the Van der Pol oscillator is:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p7">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex36">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{d}{dt}\mathbf{z}(t)=\mathbf{f}(\mathbf{z}(t))," class="ltx_Math" display="block" id="S7.Ex36.m1.3"><semantics id="S7.Ex36.m1.3a"><mrow id="S7.Ex36.m1.3.3.1" xref="S7.Ex36.m1.3.3.1.1.cmml"><mrow id="S7.Ex36.m1.3.3.1.1" xref="S7.Ex36.m1.3.3.1.1.cmml"><mrow id="S7.Ex36.m1.3.3.1.1.3" xref="S7.Ex36.m1.3.3.1.1.3.cmml"><mfrac id="S7.Ex36.m1.3.3.1.1.3.2" xref="S7.Ex36.m1.3.3.1.1.3.2.cmml"><mi id="S7.Ex36.m1.3.3.1.1.3.2.2" xref="S7.Ex36.m1.3.3.1.1.3.2.2.cmml">d</mi><mrow id="S7.Ex36.m1.3.3.1.1.3.2.3" xref="S7.Ex36.m1.3.3.1.1.3.2.3.cmml"><mi id="S7.Ex36.m1.3.3.1.1.3.2.3.2" xref="S7.Ex36.m1.3.3.1.1.3.2.3.2.cmml">d</mi><mo id="S7.Ex36.m1.3.3.1.1.3.2.3.1" xref="S7.Ex36.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S7.Ex36.m1.3.3.1.1.3.2.3.3" xref="S7.Ex36.m1.3.3.1.1.3.2.3.3.cmml">t</mi></mrow></mfrac><mo id="S7.Ex36.m1.3.3.1.1.3.1" xref="S7.Ex36.m1.3.3.1.1.3.1.cmml">⁢</mo><mi id="S7.Ex36.m1.3.3.1.1.3.3" xref="S7.Ex36.m1.3.3.1.1.3.3.cmml">𝐳</mi><mo id="S7.Ex36.m1.3.3.1.1.3.1a" xref="S7.Ex36.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S7.Ex36.m1.3.3.1.1.3.4.2" xref="S7.Ex36.m1.3.3.1.1.3.cmml"><mo id="S7.Ex36.m1.3.3.1.1.3.4.2.1" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.3.cmml">(</mo><mi id="S7.Ex36.m1.1.1" xref="S7.Ex36.m1.1.1.cmml">t</mi><mo id="S7.Ex36.m1.3.3.1.1.3.4.2.2" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S7.Ex36.m1.3.3.1.1.2" xref="S7.Ex36.m1.3.3.1.1.2.cmml">=</mo><mrow id="S7.Ex36.m1.3.3.1.1.1" xref="S7.Ex36.m1.3.3.1.1.1.cmml"><mi id="S7.Ex36.m1.3.3.1.1.1.3" xref="S7.Ex36.m1.3.3.1.1.1.3.cmml">𝐟</mi><mo id="S7.Ex36.m1.3.3.1.1.1.2" xref="S7.Ex36.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex36.m1.3.3.1.1.1.1.1" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S7.Ex36.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex36.m1.3.3.1.1.1.1.1.1" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S7.Ex36.m1.3.3.1.1.1.1.1.1.2" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="S7.Ex36.m1.3.3.1.1.1.1.1.1.1" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S7.Ex36.m1.3.3.1.1.1.1.1.1.3.2" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S7.Ex36.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S7.Ex36.m1.2.2" xref="S7.Ex36.m1.2.2.cmml">t</mi><mo id="S7.Ex36.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex36.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.Ex36.m1.3.3.1.2" xref="S7.Ex36.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex36.m1.3b"><apply id="S7.Ex36.m1.3.3.1.1.cmml" xref="S7.Ex36.m1.3.3.1"><eq id="S7.Ex36.m1.3.3.1.1.2.cmml" xref="S7.Ex36.m1.3.3.1.1.2"></eq><apply id="S7.Ex36.m1.3.3.1.1.3.cmml" xref="S7.Ex36.m1.3.3.1.1.3"><times id="S7.Ex36.m1.3.3.1.1.3.1.cmml" xref="S7.Ex36.m1.3.3.1.1.3.1"></times><apply id="S7.Ex36.m1.3.3.1.1.3.2.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2"><divide id="S7.Ex36.m1.3.3.1.1.3.2.1.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2"></divide><ci id="S7.Ex36.m1.3.3.1.1.3.2.2.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2.2">𝑑</ci><apply id="S7.Ex36.m1.3.3.1.1.3.2.3.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2.3"><times id="S7.Ex36.m1.3.3.1.1.3.2.3.1.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2.3.1"></times><ci id="S7.Ex36.m1.3.3.1.1.3.2.3.2.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2.3.2">𝑑</ci><ci id="S7.Ex36.m1.3.3.1.1.3.2.3.3.cmml" xref="S7.Ex36.m1.3.3.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="S7.Ex36.m1.3.3.1.1.3.3.cmml" xref="S7.Ex36.m1.3.3.1.1.3.3">𝐳</ci><ci id="S7.Ex36.m1.1.1.cmml" xref="S7.Ex36.m1.1.1">𝑡</ci></apply><apply id="S7.Ex36.m1.3.3.1.1.1.cmml" xref="S7.Ex36.m1.3.3.1.1.1"><times id="S7.Ex36.m1.3.3.1.1.1.2.cmml" xref="S7.Ex36.m1.3.3.1.1.1.2"></times><ci id="S7.Ex36.m1.3.3.1.1.1.3.cmml" xref="S7.Ex36.m1.3.3.1.1.1.3">𝐟</ci><apply id="S7.Ex36.m1.3.3.1.1.1.1.1.1.cmml" xref="S7.Ex36.m1.3.3.1.1.1.1.1"><times id="S7.Ex36.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S7.Ex36.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S7.Ex36.m1.3.3.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex36.m1.2.2.cmml" xref="S7.Ex36.m1.2.2">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex36.m1.3c">\frac{d}{dt}\mathbf{z}(t)=\mathbf{f}(\mathbf{z}(t)),</annotation><annotation encoding="application/x-llamapun" id="S7.Ex36.m1.3d">divide start_ARG italic_d end_ARG start_ARG italic_d italic_t end_ARG bold_z ( italic_t ) = bold_f ( bold_z ( italic_t ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p7.1">where <math alttext="\mathbf{f}(\mathbf{z}(t))" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p7.1.m1.2"><semantics id="S7.SS4.SSS0.Px1.p7.1.m1.2a"><mrow id="S7.SS4.SSS0.Px1.p7.1.m1.2.2" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.cmml"><mi id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.3" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.3.cmml">𝐟</mi><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.2" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.2.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml"><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.2" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.2.cmml">𝐳</mi><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.1" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.3.2" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml"><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml">(</mo><mi id="S7.SS4.SSS0.Px1.p7.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p7.1.m1.1.1.cmml">t</mi><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.3" stretchy="false" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p7.1.m1.2b"><apply id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2"><times id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.2.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.2"></times><ci id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.3.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.3">𝐟</ci><apply id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1"><times id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.1"></times><ci id="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.2.2.1.1.1.2">𝐳</ci><ci id="S7.SS4.SSS0.Px1.p7.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p7.1.m1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p7.1.m1.2c">\mathbf{f}(\mathbf{z}(t))</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p7.1.m1.2d">bold_f ( bold_z ( italic_t ) )</annotation></semantics></math> is the nonlinear function defined as:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p8">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex37">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{f}(\mathbf{z}(t))=\begin{bmatrix}x_{2}(t)\\
\mu(1-x_{1}(t)^{2})x_{2}(t)-x_{1}(t)\end{bmatrix}." class="ltx_Math" display="block" id="S7.Ex37.m1.3"><semantics id="S7.Ex37.m1.3a"><mrow id="S7.Ex37.m1.3.3.1" xref="S7.Ex37.m1.3.3.1.1.cmml"><mrow id="S7.Ex37.m1.3.3.1.1" xref="S7.Ex37.m1.3.3.1.1.cmml"><mrow id="S7.Ex37.m1.3.3.1.1.1" xref="S7.Ex37.m1.3.3.1.1.1.cmml"><mi id="S7.Ex37.m1.3.3.1.1.1.3" xref="S7.Ex37.m1.3.3.1.1.1.3.cmml">𝐟</mi><mo id="S7.Ex37.m1.3.3.1.1.1.2" xref="S7.Ex37.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex37.m1.3.3.1.1.1.1.1" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S7.Ex37.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex37.m1.3.3.1.1.1.1.1.1" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S7.Ex37.m1.3.3.1.1.1.1.1.1.2" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="S7.Ex37.m1.3.3.1.1.1.1.1.1.1" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S7.Ex37.m1.3.3.1.1.1.1.1.1.3.2" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S7.Ex37.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S7.Ex37.m1.2.2" xref="S7.Ex37.m1.2.2.cmml">t</mi><mo id="S7.Ex37.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex37.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex37.m1.3.3.1.1.2" xref="S7.Ex37.m1.3.3.1.1.2.cmml">=</mo><mrow id="S7.Ex37.m1.1.1.3" xref="S7.Ex37.m1.1.1.2.cmml"><mo id="S7.Ex37.m1.1.1.3.1" xref="S7.Ex37.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S7.Ex37.m1.1.1.1.1" rowspacing="0pt" xref="S7.Ex37.m1.1.1.1.1.cmml"><mtr id="S7.Ex37.m1.1.1.1.1a" xref="S7.Ex37.m1.1.1.1.1.cmml"><mtd id="S7.Ex37.m1.1.1.1.1b" xref="S7.Ex37.m1.1.1.1.1.cmml"><mrow id="S7.Ex37.m1.1.1.1.1.1.1.1.1" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S7.Ex37.m1.1.1.1.1.1.1.1.1.2" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex37.m1.1.1.1.1.1.1.1.1.4.2" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex37.m1.1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S7.Ex37.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.1.cmml">t</mi><mo id="S7.Ex37.m1.1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S7.Ex37.m1.1.1.1.1c" xref="S7.Ex37.m1.1.1.1.1.cmml"><mtd id="S7.Ex37.m1.1.1.1.1d" xref="S7.Ex37.m1.1.1.1.1.cmml"><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.cmml"><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.cmml"><mi id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.3.cmml">μ</mi><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2.cmml">⁢</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.cmml"><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.2" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.cmml">(</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.cmml"><mn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.2.cmml">1</mn><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.1" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.1.cmml">−</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.cmml"><msub id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.cmml"><mi id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.2.cmml">x</mi><mn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.1" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.1.cmml">⁢</mo><msup id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.cmml"><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.2.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.cmml"><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.2.2.1" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.cmml">(</mo><mi id="S7.Ex37.m1.1.1.1.1.2.2.1.1.1" xref="S7.Ex37.m1.1.1.1.1.2.2.1.1.1.cmml">t</mi><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.2.2.2" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.cmml">)</mo></mrow><mn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.3" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2a" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2.cmml">⁢</mo><msub id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.cmml"><mi id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.2.cmml">x</mi><mn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.3.cmml">2</mn></msub><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2b" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2.cmml">⁢</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.5.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.cmml"><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.5.2.1" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.cmml">(</mo><mi id="S7.Ex37.m1.1.1.1.1.3.3.2.2.2" xref="S7.Ex37.m1.1.1.1.1.3.3.2.2.2.cmml">t</mi><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.5.2.2" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.cmml">)</mo></mrow></mrow><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.5" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.5.cmml">−</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.cmml"><msub id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.cmml"><mi id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.2.cmml">x</mi><mn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.3" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.3.cmml">1</mn></msub><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.1" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.1.cmml">⁢</mo><mrow id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.3.2" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.cmml"><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.3.2.1" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.cmml">(</mo><mi id="S7.Ex37.m1.1.1.1.1.4.4.3.3.3" xref="S7.Ex37.m1.1.1.1.1.4.4.3.3.3.cmml">t</mi><mo id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.3.2.2" stretchy="false" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><mo id="S7.Ex37.m1.1.1.3.2" xref="S7.Ex37.m1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S7.Ex37.m1.3.3.1.2" lspace="0em" xref="S7.Ex37.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex37.m1.3b"><apply id="S7.Ex37.m1.3.3.1.1.cmml" xref="S7.Ex37.m1.3.3.1"><eq id="S7.Ex37.m1.3.3.1.1.2.cmml" xref="S7.Ex37.m1.3.3.1.1.2"></eq><apply id="S7.Ex37.m1.3.3.1.1.1.cmml" xref="S7.Ex37.m1.3.3.1.1.1"><times id="S7.Ex37.m1.3.3.1.1.1.2.cmml" xref="S7.Ex37.m1.3.3.1.1.1.2"></times><ci id="S7.Ex37.m1.3.3.1.1.1.3.cmml" xref="S7.Ex37.m1.3.3.1.1.1.3">𝐟</ci><apply id="S7.Ex37.m1.3.3.1.1.1.1.1.1.cmml" xref="S7.Ex37.m1.3.3.1.1.1.1.1"><times id="S7.Ex37.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S7.Ex37.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S7.Ex37.m1.3.3.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex37.m1.2.2.cmml" xref="S7.Ex37.m1.2.2">𝑡</ci></apply></apply><apply id="S7.Ex37.m1.1.1.2.cmml" xref="S7.Ex37.m1.1.1.3"><csymbol cd="latexml" id="S7.Ex37.m1.1.1.2.1.cmml" xref="S7.Ex37.m1.1.1.3.1">matrix</csymbol><matrix id="S7.Ex37.m1.1.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1"><matrixrow id="S7.Ex37.m1.1.1.1.1a.cmml" xref="S7.Ex37.m1.1.1.1.1"><apply id="S7.Ex37.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1"><times id="S7.Ex37.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S7.Ex37.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1.1.1.1.1.1">𝑡</ci></apply></matrixrow><matrixrow id="S7.Ex37.m1.1.1.1.1b.cmml" xref="S7.Ex37.m1.1.1.1.1"><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4"><minus id="S7.Ex37.m1.1.1.1.1.5.5.4.4.5.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.5"></minus><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4"><times id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.2"></times><ci id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.3.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.3">𝜇</ci><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1"><minus id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.1"></minus><cn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.2.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.2">1</cn><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3"><times id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.1"></times><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2">subscript</csymbol><ci id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.2">𝑥</ci><cn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.3.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.2.3">1</cn></apply><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3">superscript</csymbol><ci id="S7.Ex37.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S7.Ex37.m1.1.1.1.1.2.2.1.1.1">𝑡</ci><cn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.3.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4"><csymbol cd="ambiguous" id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4">subscript</csymbol><ci id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.2">𝑥</ci><cn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.3.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.4.4.3">2</cn></apply><ci id="S7.Ex37.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S7.Ex37.m1.1.1.1.1.3.3.2.2.2">𝑡</ci></apply><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6"><times id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.1"></times><apply id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2"><csymbol cd="ambiguous" id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.1.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2">subscript</csymbol><ci id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.2.cmml" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.2">𝑥</ci><cn id="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.3.cmml" type="integer" xref="S7.Ex37.m1.1.1.1.1.5.5.4.4.6.2.3">1</cn></apply><ci id="S7.Ex37.m1.1.1.1.1.4.4.3.3.3.cmml" xref="S7.Ex37.m1.1.1.1.1.4.4.3.3.3">𝑡</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex37.m1.3c">\mathbf{f}(\mathbf{z}(t))=\begin{bmatrix}x_{2}(t)\\
\mu(1-x_{1}(t)^{2})x_{2}(t)-x_{1}(t)\end{bmatrix}.</annotation><annotation encoding="application/x-llamapun" id="S7.Ex37.m1.3d">bold_f ( bold_z ( italic_t ) ) = [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW start_ROW start_CELL italic_μ ( 1 - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t ) - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t ) end_CELL end_ROW end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p9">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p9.1">In order to simulate realistic conditions and account for measurement noise or model uncertainties, stochastic perturbations are added to the system dynamics. The discretized version of the noisy Van der Pol oscillator can be written as:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p10">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex38">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{t+1}=\mathbf{z}_{t}+\Delta t\cdot\mathbf{f}(\mathbf{z}_{t})+%
\boldsymbol{\eta}_{t}," class="ltx_Math" display="block" id="S7.Ex38.m1.1"><semantics id="S7.Ex38.m1.1a"><mrow id="S7.Ex38.m1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.cmml"><mrow id="S7.Ex38.m1.1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.cmml"><msub id="S7.Ex38.m1.1.1.1.1.3" xref="S7.Ex38.m1.1.1.1.1.3.cmml"><mi id="S7.Ex38.m1.1.1.1.1.3.2" xref="S7.Ex38.m1.1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S7.Ex38.m1.1.1.1.1.3.3" xref="S7.Ex38.m1.1.1.1.1.3.3.cmml"><mi id="S7.Ex38.m1.1.1.1.1.3.3.2" xref="S7.Ex38.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S7.Ex38.m1.1.1.1.1.3.3.1" xref="S7.Ex38.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S7.Ex38.m1.1.1.1.1.3.3.3" xref="S7.Ex38.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S7.Ex38.m1.1.1.1.1.2" xref="S7.Ex38.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.Ex38.m1.1.1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.1.cmml"><msub id="S7.Ex38.m1.1.1.1.1.1.3" xref="S7.Ex38.m1.1.1.1.1.1.3.cmml"><mi id="S7.Ex38.m1.1.1.1.1.1.3.2" xref="S7.Ex38.m1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S7.Ex38.m1.1.1.1.1.1.3.3" xref="S7.Ex38.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S7.Ex38.m1.1.1.1.1.1.2" xref="S7.Ex38.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S7.Ex38.m1.1.1.1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex38.m1.1.1.1.1.1.1.3" xref="S7.Ex38.m1.1.1.1.1.1.1.3.cmml"><mrow id="S7.Ex38.m1.1.1.1.1.1.1.3.2" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S7.Ex38.m1.1.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.2.cmml">Δ</mi><mo id="S7.Ex38.m1.1.1.1.1.1.1.3.2.1" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S7.Ex38.m1.1.1.1.1.1.1.3.2.3" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.3.cmml">t</mi></mrow><mo id="S7.Ex38.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S7.Ex38.m1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S7.Ex38.m1.1.1.1.1.1.1.3.3" xref="S7.Ex38.m1.1.1.1.1.1.1.3.3.cmml">𝐟</mi></mrow><mo id="S7.Ex38.m1.1.1.1.1.1.1.2" xref="S7.Ex38.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex38.m1.1.1.1.1.1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex38.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.Ex38.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex38.m1.1.1.1.1.1.2a" xref="S7.Ex38.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S7.Ex38.m1.1.1.1.1.1.4" xref="S7.Ex38.m1.1.1.1.1.1.4.cmml"><mi id="S7.Ex38.m1.1.1.1.1.1.4.2" xref="S7.Ex38.m1.1.1.1.1.1.4.2.cmml">𝜼</mi><mi id="S7.Ex38.m1.1.1.1.1.1.4.3" xref="S7.Ex38.m1.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow></mrow><mo id="S7.Ex38.m1.1.1.1.2" xref="S7.Ex38.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex38.m1.1b"><apply id="S7.Ex38.m1.1.1.1.1.cmml" xref="S7.Ex38.m1.1.1.1"><eq id="S7.Ex38.m1.1.1.1.1.2.cmml" xref="S7.Ex38.m1.1.1.1.1.2"></eq><apply id="S7.Ex38.m1.1.1.1.1.3.cmml" xref="S7.Ex38.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex38.m1.1.1.1.1.3.1.cmml" xref="S7.Ex38.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex38.m1.1.1.1.1.3.2.cmml" xref="S7.Ex38.m1.1.1.1.1.3.2">𝐳</ci><apply id="S7.Ex38.m1.1.1.1.1.3.3.cmml" xref="S7.Ex38.m1.1.1.1.1.3.3"><plus id="S7.Ex38.m1.1.1.1.1.3.3.1.cmml" xref="S7.Ex38.m1.1.1.1.1.3.3.1"></plus><ci id="S7.Ex38.m1.1.1.1.1.3.3.2.cmml" xref="S7.Ex38.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="S7.Ex38.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S7.Ex38.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S7.Ex38.m1.1.1.1.1.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1"><plus id="S7.Ex38.m1.1.1.1.1.1.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.2"></plus><apply id="S7.Ex38.m1.1.1.1.1.1.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex38.m1.1.1.1.1.1.3.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex38.m1.1.1.1.1.1.3.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.3.2">𝐳</ci><ci id="S7.Ex38.m1.1.1.1.1.1.3.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S7.Ex38.m1.1.1.1.1.1.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1"><times id="S7.Ex38.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.2"></times><apply id="S7.Ex38.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3"><ci id="S7.Ex38.m1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S7.Ex38.m1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2"><times id="S7.Ex38.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.1"></times><ci id="S7.Ex38.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.2">Δ</ci><ci id="S7.Ex38.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S7.Ex38.m1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.3.3">𝐟</ci></apply><apply id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S7.Ex38.m1.1.1.1.1.1.4.cmml" xref="S7.Ex38.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S7.Ex38.m1.1.1.1.1.1.4.1.cmml" xref="S7.Ex38.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S7.Ex38.m1.1.1.1.1.1.4.2.cmml" xref="S7.Ex38.m1.1.1.1.1.1.4.2">𝜼</ci><ci id="S7.Ex38.m1.1.1.1.1.1.4.3.cmml" xref="S7.Ex38.m1.1.1.1.1.1.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex38.m1.1c">\mathbf{z}_{t+1}=\mathbf{z}_{t}+\Delta t\cdot\mathbf{f}(\mathbf{z}_{t})+%
\boldsymbol{\eta}_{t},</annotation><annotation encoding="application/x-llamapun" id="S7.Ex38.m1.1d">bold_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = bold_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + roman_Δ italic_t ⋅ bold_f ( bold_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + bold_italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p11">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p11.1">where:</p>
<ul class="ltx_itemize" id="S7.I4">
<li class="ltx_item" id="S7.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I4.i1.p1">
<p class="ltx_p" id="S7.I4.i1.p1.2"><math alttext="\mathbf{z}_{t}=\begin{bmatrix}x_{1,t}\\
x_{2,t}\end{bmatrix}" class="ltx_Math" display="inline" id="S7.I4.i1.p1.1.m1.1"><semantics id="S7.I4.i1.p1.1.m1.1a"><mrow id="S7.I4.i1.p1.1.m1.1.2" xref="S7.I4.i1.p1.1.m1.1.2.cmml"><msub id="S7.I4.i1.p1.1.m1.1.2.2" xref="S7.I4.i1.p1.1.m1.1.2.2.cmml"><mi id="S7.I4.i1.p1.1.m1.1.2.2.2" xref="S7.I4.i1.p1.1.m1.1.2.2.2.cmml">𝐳</mi><mi id="S7.I4.i1.p1.1.m1.1.2.2.3" xref="S7.I4.i1.p1.1.m1.1.2.2.3.cmml">t</mi></msub><mo id="S7.I4.i1.p1.1.m1.1.2.1" xref="S7.I4.i1.p1.1.m1.1.2.1.cmml">=</mo><mrow id="S7.I4.i1.p1.1.m1.1.1.3" xref="S7.I4.i1.p1.1.m1.1.1.2.cmml"><mo id="S7.I4.i1.p1.1.m1.1.1.3.1" xref="S7.I4.i1.p1.1.m1.1.1.2.1.cmml">[</mo><mtable id="S7.I4.i1.p1.1.m1.1.1.1.1" rowspacing="0pt" xref="S7.I4.i1.p1.1.m1.1.1.1.1.cmml"><mtr id="S7.I4.i1.p1.1.m1.1.1.1.1a" xref="S7.I4.i1.p1.1.m1.1.1.1.1.cmml"><mtd id="S7.I4.i1.p1.1.m1.1.1.1.1b" xref="S7.I4.i1.p1.1.m1.1.1.1.1.cmml"><msub id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.4" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.4.cmml">x</mi><mrow id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mn id="S7.I4.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.I4.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4.1" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">,</mo><mi id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">t</mi></mrow></msub></mtd></mtr><mtr id="S7.I4.i1.p1.1.m1.1.1.1.1c" xref="S7.I4.i1.p1.1.m1.1.1.1.1.cmml"><mtd id="S7.I4.i1.p1.1.m1.1.1.1.1d" xref="S7.I4.i1.p1.1.m1.1.1.1.1.cmml"><msub id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.cmml"><mi id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.4" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.4.cmml">x</mi><mrow id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml"><mn id="S7.I4.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1" xref="S7.I4.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1.cmml">2</mn><mo id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4.1" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml">,</mo><mi id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2.cmml">t</mi></mrow></msub></mtd></mtr></mtable><mo id="S7.I4.i1.p1.1.m1.1.1.3.2" xref="S7.I4.i1.p1.1.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I4.i1.p1.1.m1.1b"><apply id="S7.I4.i1.p1.1.m1.1.2.cmml" xref="S7.I4.i1.p1.1.m1.1.2"><eq id="S7.I4.i1.p1.1.m1.1.2.1.cmml" xref="S7.I4.i1.p1.1.m1.1.2.1"></eq><apply id="S7.I4.i1.p1.1.m1.1.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S7.I4.i1.p1.1.m1.1.2.2.1.cmml" xref="S7.I4.i1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S7.I4.i1.p1.1.m1.1.2.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.2.2.2">𝐳</ci><ci id="S7.I4.i1.p1.1.m1.1.2.2.3.cmml" xref="S7.I4.i1.p1.1.m1.1.2.2.3">𝑡</ci></apply><apply id="S7.I4.i1.p1.1.m1.1.1.2.cmml" xref="S7.I4.i1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S7.I4.i1.p1.1.m1.1.1.2.1.cmml" xref="S7.I4.i1.p1.1.m1.1.1.3.1">matrix</csymbol><matrix id="S7.I4.i1.p1.1.m1.1.1.1.1.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1"><matrixrow id="S7.I4.i1.p1.1.m1.1.1.1.1a.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1"><apply id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.4">𝑥</ci><list id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4"><cn id="S7.I4.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" type="integer" xref="S7.I4.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1">1</cn><ci id="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2">𝑡</ci></list></apply></matrixrow><matrixrow id="S7.I4.i1.p1.1.m1.1.1.1.1b.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1"><apply id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.3.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2">subscript</csymbol><ci id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.4.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.4">𝑥</ci><list id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4"><cn id="S7.I4.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1.cmml" type="integer" xref="S7.I4.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1">2</cn><ci id="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2.cmml" xref="S7.I4.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2">𝑡</ci></list></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i1.p1.1.m1.1c">\mathbf{z}_{t}=\begin{bmatrix}x_{1,t}\\
x_{2,t}\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i1.p1.1.m1.1d">bold_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ]</annotation></semantics></math> is the state vector at time step <math alttext="t" class="ltx_Math" display="inline" id="S7.I4.i1.p1.2.m2.1"><semantics id="S7.I4.i1.p1.2.m2.1a"><mi id="S7.I4.i1.p1.2.m2.1.1" xref="S7.I4.i1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.I4.i1.p1.2.m2.1b"><ci id="S7.I4.i1.p1.2.m2.1.1.cmml" xref="S7.I4.i1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i1.p1.2.m2.1d">italic_t</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I4.i2.p1">
<p class="ltx_p" id="S7.I4.i2.p1.1"><math alttext="\Delta t" class="ltx_Math" display="inline" id="S7.I4.i2.p1.1.m1.1"><semantics id="S7.I4.i2.p1.1.m1.1a"><mrow id="S7.I4.i2.p1.1.m1.1.1" xref="S7.I4.i2.p1.1.m1.1.1.cmml"><mi id="S7.I4.i2.p1.1.m1.1.1.2" mathvariant="normal" xref="S7.I4.i2.p1.1.m1.1.1.2.cmml">Δ</mi><mo id="S7.I4.i2.p1.1.m1.1.1.1" xref="S7.I4.i2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S7.I4.i2.p1.1.m1.1.1.3" xref="S7.I4.i2.p1.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.I4.i2.p1.1.m1.1b"><apply id="S7.I4.i2.p1.1.m1.1.1.cmml" xref="S7.I4.i2.p1.1.m1.1.1"><times id="S7.I4.i2.p1.1.m1.1.1.1.cmml" xref="S7.I4.i2.p1.1.m1.1.1.1"></times><ci id="S7.I4.i2.p1.1.m1.1.1.2.cmml" xref="S7.I4.i2.p1.1.m1.1.1.2">Δ</ci><ci id="S7.I4.i2.p1.1.m1.1.1.3.cmml" xref="S7.I4.i2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i2.p1.1.m1.1c">\Delta t</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i2.p1.1.m1.1d">roman_Δ italic_t</annotation></semantics></math> is the discrete time step size,</p>
</div>
</li>
<li class="ltx_item" id="S7.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I4.i3.p1">
<p class="ltx_p" id="S7.I4.i3.p1.1"><math alttext="\mathbf{f}(\mathbf{z}_{t})" class="ltx_Math" display="inline" id="S7.I4.i3.p1.1.m1.1"><semantics id="S7.I4.i3.p1.1.m1.1a"><mrow id="S7.I4.i3.p1.1.m1.1.1" xref="S7.I4.i3.p1.1.m1.1.1.cmml"><mi id="S7.I4.i3.p1.1.m1.1.1.3" xref="S7.I4.i3.p1.1.m1.1.1.3.cmml">𝐟</mi><mo id="S7.I4.i3.p1.1.m1.1.1.2" xref="S7.I4.i3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S7.I4.i3.p1.1.m1.1.1.1.1" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S7.I4.i3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S7.I4.i3.p1.1.m1.1.1.1.1.1" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S7.I4.i3.p1.1.m1.1.1.1.1.1.2" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S7.I4.i3.p1.1.m1.1.1.1.1.1.3" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.I4.i3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I4.i3.p1.1.m1.1b"><apply id="S7.I4.i3.p1.1.m1.1.1.cmml" xref="S7.I4.i3.p1.1.m1.1.1"><times id="S7.I4.i3.p1.1.m1.1.1.2.cmml" xref="S7.I4.i3.p1.1.m1.1.1.2"></times><ci id="S7.I4.i3.p1.1.m1.1.1.3.cmml" xref="S7.I4.i3.p1.1.m1.1.1.3">𝐟</ci><apply id="S7.I4.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S7.I4.i3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S7.I4.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S7.I4.i3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S7.I4.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S7.I4.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S7.I4.i3.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i3.p1.1.m1.1c">\mathbf{f}(\mathbf{z}_{t})</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i3.p1.1.m1.1d">bold_f ( bold_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> represents the deterministic Van der Pol dynamics,</p>
</div>
</li>
<li class="ltx_item" id="S7.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I4.i4.p1">
<p class="ltx_p" id="S7.I4.i4.p1.2"><math alttext="\boldsymbol{\eta}_{t}\sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})" class="ltx_Math" display="inline" id="S7.I4.i4.p1.1.m1.2"><semantics id="S7.I4.i4.p1.1.m1.2a"><mrow id="S7.I4.i4.p1.1.m1.2.2" xref="S7.I4.i4.p1.1.m1.2.2.cmml"><msub id="S7.I4.i4.p1.1.m1.2.2.3" xref="S7.I4.i4.p1.1.m1.2.2.3.cmml"><mi id="S7.I4.i4.p1.1.m1.2.2.3.2" xref="S7.I4.i4.p1.1.m1.2.2.3.2.cmml">𝜼</mi><mi id="S7.I4.i4.p1.1.m1.2.2.3.3" xref="S7.I4.i4.p1.1.m1.2.2.3.3.cmml">t</mi></msub><mo id="S7.I4.i4.p1.1.m1.2.2.2" xref="S7.I4.i4.p1.1.m1.2.2.2.cmml">∼</mo><mrow id="S7.I4.i4.p1.1.m1.2.2.1" xref="S7.I4.i4.p1.1.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.I4.i4.p1.1.m1.2.2.1.3" xref="S7.I4.i4.p1.1.m1.2.2.1.3.cmml">𝒩</mi><mo id="S7.I4.i4.p1.1.m1.2.2.1.2" xref="S7.I4.i4.p1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S7.I4.i4.p1.1.m1.2.2.1.1.1" xref="S7.I4.i4.p1.1.m1.2.2.1.1.2.cmml"><mo id="S7.I4.i4.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S7.I4.i4.p1.1.m1.2.2.1.1.2.cmml">(</mo><mn id="S7.I4.i4.p1.1.m1.1.1" xref="S7.I4.i4.p1.1.m1.1.1.cmml">𝟎</mn><mo id="S7.I4.i4.p1.1.m1.2.2.1.1.1.3" xref="S7.I4.i4.p1.1.m1.2.2.1.1.2.cmml">,</mo><mrow id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.cmml"><msup id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.2" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.2.cmml">σ</mi><mn id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.3" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.1" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.3" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo id="S7.I4.i4.p1.1.m1.2.2.1.1.1.4" stretchy="false" xref="S7.I4.i4.p1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I4.i4.p1.1.m1.2b"><apply id="S7.I4.i4.p1.1.m1.2.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2"><csymbol cd="latexml" id="S7.I4.i4.p1.1.m1.2.2.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.2">similar-to</csymbol><apply id="S7.I4.i4.p1.1.m1.2.2.3.cmml" xref="S7.I4.i4.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S7.I4.i4.p1.1.m1.2.2.3.1.cmml" xref="S7.I4.i4.p1.1.m1.2.2.3">subscript</csymbol><ci id="S7.I4.i4.p1.1.m1.2.2.3.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.3.2">𝜼</ci><ci id="S7.I4.i4.p1.1.m1.2.2.3.3.cmml" xref="S7.I4.i4.p1.1.m1.2.2.3.3">𝑡</ci></apply><apply id="S7.I4.i4.p1.1.m1.2.2.1.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1"><times id="S7.I4.i4.p1.1.m1.2.2.1.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.2"></times><ci id="S7.I4.i4.p1.1.m1.2.2.1.3.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.3">𝒩</ci><interval closure="open" id="S7.I4.i4.p1.1.m1.2.2.1.1.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1"><cn id="S7.I4.i4.p1.1.m1.1.1.cmml" type="integer" xref="S7.I4.i4.p1.1.m1.1.1">0</cn><apply id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1"><times id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.1"></times><apply id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.2">𝜎</ci><cn id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S7.I4.i4.p1.1.m1.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i4.p1.1.m1.2c">\boldsymbol{\eta}_{t}\sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i4.p1.1.m1.2d">bold_italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_I )</annotation></semantics></math> is additive Gaussian noise with standard deviation <math alttext="\sigma" class="ltx_Math" display="inline" id="S7.I4.i4.p1.2.m2.1"><semantics id="S7.I4.i4.p1.2.m2.1a"><mi id="S7.I4.i4.p1.2.m2.1.1" xref="S7.I4.i4.p1.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.I4.i4.p1.2.m2.1b"><ci id="S7.I4.i4.p1.2.m2.1.1.cmml" xref="S7.I4.i4.p1.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I4.i4.p1.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.I4.i4.p1.2.m2.1d">italic_σ</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p12">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p12.2">In this work, the noise term <math alttext="\boldsymbol{\eta}_{t}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p12.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p12.1.m1.1a"><msub id="S7.SS4.SSS0.Px1.p12.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.2" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1.2.cmml">𝜼</mi><mi id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p12.1.m1.1b"><apply id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1.2">𝜼</ci><ci id="S7.SS4.SSS0.Px1.p12.1.m1.1.1.3.cmml" xref="S7.SS4.SSS0.Px1.p12.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p12.1.m1.1c">\boldsymbol{\eta}_{t}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p12.1.m1.1d">bold_italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is sampled independently at each time step with standard deviation <math alttext="\sigma=0.02" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p12.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p12.2.m2.1a"><mrow id="S7.SS4.SSS0.Px1.p12.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.2" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.2.cmml">σ</mi><mo id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.1" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.3" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p12.2.m2.1b"><apply id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.cmml" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1"><eq id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.1"></eq><ci id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.2">𝜎</ci><cn id="S7.SS4.SSS0.Px1.p12.2.m2.1.1.3.cmml" type="float" xref="S7.SS4.SSS0.Px1.p12.2.m2.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p12.2.m2.1c">\sigma=0.02</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p12.2.m2.1d">italic_σ = 0.02</annotation></semantics></math>, which introduces stochastic variability into both position and velocity.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p13">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p13.1">The parameters used for the simulation are:</p>
<ul class="ltx_itemize" id="S7.I5">
<li class="ltx_item" id="S7.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I5.i1.p1">
<p class="ltx_p" id="S7.I5.i1.p1.1"><math alttext="\mu=1.0" class="ltx_Math" display="inline" id="S7.I5.i1.p1.1.m1.1"><semantics id="S7.I5.i1.p1.1.m1.1a"><mrow id="S7.I5.i1.p1.1.m1.1.1" xref="S7.I5.i1.p1.1.m1.1.1.cmml"><mi id="S7.I5.i1.p1.1.m1.1.1.2" xref="S7.I5.i1.p1.1.m1.1.1.2.cmml">μ</mi><mo id="S7.I5.i1.p1.1.m1.1.1.1" xref="S7.I5.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I5.i1.p1.1.m1.1.1.3" xref="S7.I5.i1.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i1.p1.1.m1.1b"><apply id="S7.I5.i1.p1.1.m1.1.1.cmml" xref="S7.I5.i1.p1.1.m1.1.1"><eq id="S7.I5.i1.p1.1.m1.1.1.1.cmml" xref="S7.I5.i1.p1.1.m1.1.1.1"></eq><ci id="S7.I5.i1.p1.1.m1.1.1.2.cmml" xref="S7.I5.i1.p1.1.m1.1.1.2">𝜇</ci><cn id="S7.I5.i1.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I5.i1.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i1.p1.1.m1.1c">\mu=1.0</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i1.p1.1.m1.1d">italic_μ = 1.0</annotation></semantics></math> (nonlinearity parameter),</p>
</div>
</li>
<li class="ltx_item" id="S7.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I5.i2.p1">
<p class="ltx_p" id="S7.I5.i2.p1.1">Time step: <math alttext="dt=0.01" class="ltx_Math" display="inline" id="S7.I5.i2.p1.1.m1.1"><semantics id="S7.I5.i2.p1.1.m1.1a"><mrow id="S7.I5.i2.p1.1.m1.1.1" xref="S7.I5.i2.p1.1.m1.1.1.cmml"><mrow id="S7.I5.i2.p1.1.m1.1.1.2" xref="S7.I5.i2.p1.1.m1.1.1.2.cmml"><mi id="S7.I5.i2.p1.1.m1.1.1.2.2" xref="S7.I5.i2.p1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.I5.i2.p1.1.m1.1.1.2.1" xref="S7.I5.i2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.I5.i2.p1.1.m1.1.1.2.3" xref="S7.I5.i2.p1.1.m1.1.1.2.3.cmml">t</mi></mrow><mo id="S7.I5.i2.p1.1.m1.1.1.1" xref="S7.I5.i2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I5.i2.p1.1.m1.1.1.3" xref="S7.I5.i2.p1.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i2.p1.1.m1.1b"><apply id="S7.I5.i2.p1.1.m1.1.1.cmml" xref="S7.I5.i2.p1.1.m1.1.1"><eq id="S7.I5.i2.p1.1.m1.1.1.1.cmml" xref="S7.I5.i2.p1.1.m1.1.1.1"></eq><apply id="S7.I5.i2.p1.1.m1.1.1.2.cmml" xref="S7.I5.i2.p1.1.m1.1.1.2"><times id="S7.I5.i2.p1.1.m1.1.1.2.1.cmml" xref="S7.I5.i2.p1.1.m1.1.1.2.1"></times><ci id="S7.I5.i2.p1.1.m1.1.1.2.2.cmml" xref="S7.I5.i2.p1.1.m1.1.1.2.2">𝑑</ci><ci id="S7.I5.i2.p1.1.m1.1.1.2.3.cmml" xref="S7.I5.i2.p1.1.m1.1.1.2.3">𝑡</ci></apply><cn id="S7.I5.i2.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I5.i2.p1.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i2.p1.1.m1.1c">dt=0.01</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i2.p1.1.m1.1d">italic_d italic_t = 0.01</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I5.i3.p1">
<p class="ltx_p" id="S7.I5.i3.p1.1">Total simulation time: <math alttext="T=20.0" class="ltx_Math" display="inline" id="S7.I5.i3.p1.1.m1.1"><semantics id="S7.I5.i3.p1.1.m1.1a"><mrow id="S7.I5.i3.p1.1.m1.1.1" xref="S7.I5.i3.p1.1.m1.1.1.cmml"><mi id="S7.I5.i3.p1.1.m1.1.1.2" xref="S7.I5.i3.p1.1.m1.1.1.2.cmml">T</mi><mo id="S7.I5.i3.p1.1.m1.1.1.1" xref="S7.I5.i3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I5.i3.p1.1.m1.1.1.3" xref="S7.I5.i3.p1.1.m1.1.1.3.cmml">20.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i3.p1.1.m1.1b"><apply id="S7.I5.i3.p1.1.m1.1.1.cmml" xref="S7.I5.i3.p1.1.m1.1.1"><eq id="S7.I5.i3.p1.1.m1.1.1.1.cmml" xref="S7.I5.i3.p1.1.m1.1.1.1"></eq><ci id="S7.I5.i3.p1.1.m1.1.1.2.cmml" xref="S7.I5.i3.p1.1.m1.1.1.2">𝑇</ci><cn id="S7.I5.i3.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I5.i3.p1.1.m1.1.1.3">20.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i3.p1.1.m1.1c">T=20.0</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i3.p1.1.m1.1d">italic_T = 20.0</annotation></semantics></math> seconds,</p>
</div>
</li>
<li class="ltx_item" id="S7.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I5.i4.p1">
<p class="ltx_p" id="S7.I5.i4.p1.2">Initial conditions: <math alttext="x_{1}(0)=2.0" class="ltx_Math" display="inline" id="S7.I5.i4.p1.1.m1.1"><semantics id="S7.I5.i4.p1.1.m1.1a"><mrow id="S7.I5.i4.p1.1.m1.1.2" xref="S7.I5.i4.p1.1.m1.1.2.cmml"><mrow id="S7.I5.i4.p1.1.m1.1.2.2" xref="S7.I5.i4.p1.1.m1.1.2.2.cmml"><msub id="S7.I5.i4.p1.1.m1.1.2.2.2" xref="S7.I5.i4.p1.1.m1.1.2.2.2.cmml"><mi id="S7.I5.i4.p1.1.m1.1.2.2.2.2" xref="S7.I5.i4.p1.1.m1.1.2.2.2.2.cmml">x</mi><mn id="S7.I5.i4.p1.1.m1.1.2.2.2.3" xref="S7.I5.i4.p1.1.m1.1.2.2.2.3.cmml">1</mn></msub><mo id="S7.I5.i4.p1.1.m1.1.2.2.1" xref="S7.I5.i4.p1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S7.I5.i4.p1.1.m1.1.2.2.3.2" xref="S7.I5.i4.p1.1.m1.1.2.2.cmml"><mo id="S7.I5.i4.p1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S7.I5.i4.p1.1.m1.1.2.2.cmml">(</mo><mn id="S7.I5.i4.p1.1.m1.1.1" xref="S7.I5.i4.p1.1.m1.1.1.cmml">0</mn><mo id="S7.I5.i4.p1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S7.I5.i4.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.I5.i4.p1.1.m1.1.2.1" xref="S7.I5.i4.p1.1.m1.1.2.1.cmml">=</mo><mn id="S7.I5.i4.p1.1.m1.1.2.3" xref="S7.I5.i4.p1.1.m1.1.2.3.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i4.p1.1.m1.1b"><apply id="S7.I5.i4.p1.1.m1.1.2.cmml" xref="S7.I5.i4.p1.1.m1.1.2"><eq id="S7.I5.i4.p1.1.m1.1.2.1.cmml" xref="S7.I5.i4.p1.1.m1.1.2.1"></eq><apply id="S7.I5.i4.p1.1.m1.1.2.2.cmml" xref="S7.I5.i4.p1.1.m1.1.2.2"><times id="S7.I5.i4.p1.1.m1.1.2.2.1.cmml" xref="S7.I5.i4.p1.1.m1.1.2.2.1"></times><apply id="S7.I5.i4.p1.1.m1.1.2.2.2.cmml" xref="S7.I5.i4.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S7.I5.i4.p1.1.m1.1.2.2.2.1.cmml" xref="S7.I5.i4.p1.1.m1.1.2.2.2">subscript</csymbol><ci id="S7.I5.i4.p1.1.m1.1.2.2.2.2.cmml" xref="S7.I5.i4.p1.1.m1.1.2.2.2.2">𝑥</ci><cn id="S7.I5.i4.p1.1.m1.1.2.2.2.3.cmml" type="integer" xref="S7.I5.i4.p1.1.m1.1.2.2.2.3">1</cn></apply><cn id="S7.I5.i4.p1.1.m1.1.1.cmml" type="integer" xref="S7.I5.i4.p1.1.m1.1.1">0</cn></apply><cn id="S7.I5.i4.p1.1.m1.1.2.3.cmml" type="float" xref="S7.I5.i4.p1.1.m1.1.2.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i4.p1.1.m1.1c">x_{1}(0)=2.0</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i4.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( 0 ) = 2.0</annotation></semantics></math>, <math alttext="x_{2}(0)=0.0" class="ltx_Math" display="inline" id="S7.I5.i4.p1.2.m2.1"><semantics id="S7.I5.i4.p1.2.m2.1a"><mrow id="S7.I5.i4.p1.2.m2.1.2" xref="S7.I5.i4.p1.2.m2.1.2.cmml"><mrow id="S7.I5.i4.p1.2.m2.1.2.2" xref="S7.I5.i4.p1.2.m2.1.2.2.cmml"><msub id="S7.I5.i4.p1.2.m2.1.2.2.2" xref="S7.I5.i4.p1.2.m2.1.2.2.2.cmml"><mi id="S7.I5.i4.p1.2.m2.1.2.2.2.2" xref="S7.I5.i4.p1.2.m2.1.2.2.2.2.cmml">x</mi><mn id="S7.I5.i4.p1.2.m2.1.2.2.2.3" xref="S7.I5.i4.p1.2.m2.1.2.2.2.3.cmml">2</mn></msub><mo id="S7.I5.i4.p1.2.m2.1.2.2.1" xref="S7.I5.i4.p1.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S7.I5.i4.p1.2.m2.1.2.2.3.2" xref="S7.I5.i4.p1.2.m2.1.2.2.cmml"><mo id="S7.I5.i4.p1.2.m2.1.2.2.3.2.1" stretchy="false" xref="S7.I5.i4.p1.2.m2.1.2.2.cmml">(</mo><mn id="S7.I5.i4.p1.2.m2.1.1" xref="S7.I5.i4.p1.2.m2.1.1.cmml">0</mn><mo id="S7.I5.i4.p1.2.m2.1.2.2.3.2.2" stretchy="false" xref="S7.I5.i4.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.I5.i4.p1.2.m2.1.2.1" xref="S7.I5.i4.p1.2.m2.1.2.1.cmml">=</mo><mn id="S7.I5.i4.p1.2.m2.1.2.3" xref="S7.I5.i4.p1.2.m2.1.2.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i4.p1.2.m2.1b"><apply id="S7.I5.i4.p1.2.m2.1.2.cmml" xref="S7.I5.i4.p1.2.m2.1.2"><eq id="S7.I5.i4.p1.2.m2.1.2.1.cmml" xref="S7.I5.i4.p1.2.m2.1.2.1"></eq><apply id="S7.I5.i4.p1.2.m2.1.2.2.cmml" xref="S7.I5.i4.p1.2.m2.1.2.2"><times id="S7.I5.i4.p1.2.m2.1.2.2.1.cmml" xref="S7.I5.i4.p1.2.m2.1.2.2.1"></times><apply id="S7.I5.i4.p1.2.m2.1.2.2.2.cmml" xref="S7.I5.i4.p1.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S7.I5.i4.p1.2.m2.1.2.2.2.1.cmml" xref="S7.I5.i4.p1.2.m2.1.2.2.2">subscript</csymbol><ci id="S7.I5.i4.p1.2.m2.1.2.2.2.2.cmml" xref="S7.I5.i4.p1.2.m2.1.2.2.2.2">𝑥</ci><cn id="S7.I5.i4.p1.2.m2.1.2.2.2.3.cmml" type="integer" xref="S7.I5.i4.p1.2.m2.1.2.2.2.3">2</cn></apply><cn id="S7.I5.i4.p1.2.m2.1.1.cmml" type="integer" xref="S7.I5.i4.p1.2.m2.1.1">0</cn></apply><cn id="S7.I5.i4.p1.2.m2.1.2.3.cmml" type="float" xref="S7.I5.i4.p1.2.m2.1.2.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i4.p1.2.m2.1c">x_{2}(0)=0.0</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i4.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( 0 ) = 0.0</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I5.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I5.i5.p1">
<p class="ltx_p" id="S7.I5.i5.p1.1">Noise standard deviation: <math alttext="\sigma=0.02" class="ltx_Math" display="inline" id="S7.I5.i5.p1.1.m1.1"><semantics id="S7.I5.i5.p1.1.m1.1a"><mrow id="S7.I5.i5.p1.1.m1.1.1" xref="S7.I5.i5.p1.1.m1.1.1.cmml"><mi id="S7.I5.i5.p1.1.m1.1.1.2" xref="S7.I5.i5.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S7.I5.i5.p1.1.m1.1.1.1" xref="S7.I5.i5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I5.i5.p1.1.m1.1.1.3" xref="S7.I5.i5.p1.1.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I5.i5.p1.1.m1.1b"><apply id="S7.I5.i5.p1.1.m1.1.1.cmml" xref="S7.I5.i5.p1.1.m1.1.1"><eq id="S7.I5.i5.p1.1.m1.1.1.1.cmml" xref="S7.I5.i5.p1.1.m1.1.1.1"></eq><ci id="S7.I5.i5.p1.1.m1.1.1.2.cmml" xref="S7.I5.i5.p1.1.m1.1.1.2">𝜎</ci><cn id="S7.I5.i5.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I5.i5.p1.1.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I5.i5.p1.1.m1.1c">\sigma=0.02</annotation><annotation encoding="application/x-llamapun" id="S7.I5.i5.p1.1.m1.1d">italic_σ = 0.02</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p14">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p14.1">The system is discretized into <math alttext="N=\frac{T}{dt}=2000" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p14.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p14.1.m1.1a"><mrow id="S7.SS4.SSS0.Px1.p14.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.2" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.2.cmml">N</mi><mo id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.3.cmml">=</mo><mfrac id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.cmml"><mi id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.2" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.2.cmml">T</mi><mrow id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.cmml"><mi id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.2" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.2.cmml">d</mi><mo id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.1" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.1.cmml">⁢</mo><mi id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.3" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.3.cmml">t</mi></mrow></mfrac><mo id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.5" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.5.cmml">=</mo><mn id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.6" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.6.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p14.1.m1.1b"><apply id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1"><and id="S7.SS4.SSS0.Px1.p14.1.m1.1.1a.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1"></and><apply id="S7.SS4.SSS0.Px1.p14.1.m1.1.1b.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1"><eq id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.3.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.3"></eq><ci id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.2">𝑁</ci><apply id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4"><divide id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.1.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4"></divide><ci id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.2.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.2">𝑇</ci><apply id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3"><times id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.1.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.1"></times><ci id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.2.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.2">𝑑</ci><ci id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.3.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.3.3">𝑡</ci></apply></apply></apply><apply id="S7.SS4.SSS0.Px1.p14.1.m1.1.1c.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1"><eq id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.5.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2505.20048v1#S7.SS4.SSS0.Px1.p14.1.m1.1.1.4.cmml" id="S7.SS4.SSS0.Px1.p14.1.m1.1.1d.cmml" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1"></share><cn id="S7.SS4.SSS0.Px1.p14.1.m1.1.1.6.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p14.1.m1.1.1.6">2000</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p14.1.m1.1c">N=\frac{T}{dt}=2000</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p14.1.m1.1d">italic_N = divide start_ARG italic_T end_ARG start_ARG italic_d italic_t end_ARG = 2000</annotation></semantics></math> time steps. The Van der Pol oscillator’s noisy state trajectory is computed iteratively using the above update equation.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p15">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p15.6">The evaluation of the Deep Koopformer models focuses on forecasting the next <math alttext="H=5" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p15.1.m1.1a"><mrow id="S7.SS4.SSS0.Px1.p15.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.2" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.2.cmml">H</mi><mo id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.1" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.1.m1.1b"><apply id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1"><eq id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.1"></eq><ci id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.2">𝐻</ci><cn id="S7.SS4.SSS0.Px1.p15.1.m1.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.1.m1.1c">H=5</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.1.m1.1d">italic_H = 5</annotation></semantics></math> time steps of the system’s dynamics. The models are trained using input sequences of length <math alttext="16" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p15.2.m2.1a"><mn id="S7.SS4.SSS0.Px1.p15.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p15.2.m2.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.2.m2.1b"><cn id="S7.SS4.SSS0.Px1.p15.2.m2.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.2.m2.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.2.m2.1c">16</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.2.m2.1d">16</annotation></semantics></math> (referred to as the <span class="ltx_text ltx_font_italic" id="S7.SS4.SSS0.Px1.p15.6.1">patch length</span>), with the objective of predicting the future values of two state variables, <math alttext="x_{1}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.3.m3.1"><semantics id="S7.SS4.SSS0.Px1.p15.3.m3.1a"><msub id="S7.SS4.SSS0.Px1.p15.3.m3.1.1" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.2" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.3" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.3.m3.1b"><apply id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p15.3.m3.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.3.m3.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.3.m3.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{2}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.4.m4.1"><semantics id="S7.SS4.SSS0.Px1.p15.4.m4.1a"><msub id="S7.SS4.SSS0.Px1.p15.4.m4.1.1" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.2" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.3" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.4.m4.1b"><apply id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p15.4.m4.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.4.m4.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.4.m4.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, over the forecast horizon. The target outputs consist of <math alttext="10" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.5.m5.1"><semantics id="S7.SS4.SSS0.Px1.p15.5.m5.1a"><mn id="S7.SS4.SSS0.Px1.p15.5.m5.1.1" xref="S7.SS4.SSS0.Px1.p15.5.m5.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.5.m5.1b"><cn id="S7.SS4.SSS0.Px1.p15.5.m5.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.5.m5.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.5.m5.1c">10</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.5.m5.1d">10</annotation></semantics></math> variables, representing the forecasted values of the state variables for each of the <math alttext="5" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p15.6.m6.1"><semantics id="S7.SS4.SSS0.Px1.p15.6.m6.1a"><mn id="S7.SS4.SSS0.Px1.p15.6.m6.1.1" xref="S7.SS4.SSS0.Px1.p15.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p15.6.m6.1b"><cn id="S7.SS4.SSS0.Px1.p15.6.m6.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p15.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p15.6.m6.1c">5</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p15.6.m6.1d">5</annotation></semantics></math> time steps. These models are evaluated by comparing the predicted outputs with the ground truth, assessing both short-term accuracy and long-term stability.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p16">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p16.4">The training process is carried out with a consistent set of hyperparameters across all variants of the Deep Koopformer architecture (<span class="ltx_text ltx_font_typewriter" id="S7.SS4.SSS0.Px1.p16.4.1">PatchTST</span>, <span class="ltx_text ltx_font_typewriter" id="S7.SS4.SSS0.Px1.p16.4.2">Autoformer</span>, and <span class="ltx_text ltx_font_typewriter" id="S7.SS4.SSS0.Px1.p16.4.3">Informer</span>). The latent dimension of the model is set to <math alttext="d_{\text{model}}=16" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p16.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p16.1.m1.1a"><mrow id="S7.SS4.SSS0.Px1.p16.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.cmml"><msub id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.cmml"><mi id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.2" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.2.cmml">d</mi><mtext id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3a.cmml">model</mtext></msub><mo id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.1" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p16.1.m1.1b"><apply id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1"><eq id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.1"></eq><apply id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.1.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.2.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.2">𝑑</ci><ci id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3a.cmml" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3"><mtext id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.2.3">model</mtext></ci></apply><cn id="S7.SS4.SSS0.Px1.p16.1.m1.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p16.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p16.1.m1.1c">d_{\text{model}}=16</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p16.1.m1.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT = 16</annotation></semantics></math>, which determines the size of the internal representation of the state dynamics. The multi-head attention mechanism is configured with <math alttext="2" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p16.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p16.2.m2.1a"><mn id="S7.SS4.SSS0.Px1.p16.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p16.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p16.2.m2.1b"><cn id="S7.SS4.SSS0.Px1.p16.2.m2.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p16.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p16.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p16.2.m2.1d">2</annotation></semantics></math> attention heads, enabling the model to capture multiple dependencies in the temporal sequence. The feed-forward dimension is <math alttext="64" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p16.3.m3.1"><semantics id="S7.SS4.SSS0.Px1.p16.3.m3.1a"><mn id="S7.SS4.SSS0.Px1.p16.3.m3.1.1" xref="S7.SS4.SSS0.Px1.p16.3.m3.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p16.3.m3.1b"><cn id="S7.SS4.SSS0.Px1.p16.3.m3.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p16.3.m3.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p16.3.m3.1c">64</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p16.3.m3.1d">64</annotation></semantics></math>, which defines the size of the intermediate layer within the Transformer encoder, while the number of encoder layers is set to <math alttext="2" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p16.4.m4.1"><semantics id="S7.SS4.SSS0.Px1.p16.4.m4.1a"><mn id="S7.SS4.SSS0.Px1.p16.4.m4.1.1" xref="S7.SS4.SSS0.Px1.p16.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p16.4.m4.1b"><cn id="S7.SS4.SSS0.Px1.p16.4.m4.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p16.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p16.4.m4.1c">2</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p16.4.m4.1d">2</annotation></semantics></math>, specifying the depth of the encoder stack.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p17">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p17.2">The Adam optimizer with a learning rate of <math alttext="0.001" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p17.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p17.1.m1.1a"><mn id="S7.SS4.SSS0.Px1.p17.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p17.1.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p17.1.m1.1b"><cn id="S7.SS4.SSS0.Px1.p17.1.m1.1.1.cmml" type="float" xref="S7.SS4.SSS0.Px1.p17.1.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p17.1.m1.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p17.1.m1.1d">0.001</annotation></semantics></math> is used for gradient-based optimization. The loss function employed is the mean squared error (MSE), augmented with a stability penalty that helps ensure the preservation of latent dynamics over time. The model is trained for a total of <math alttext="1000" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p17.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p17.2.m2.1a"><mn id="S7.SS4.SSS0.Px1.p17.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p17.2.m2.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p17.2.m2.1b"><cn id="S7.SS4.SSS0.Px1.p17.2.m2.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p17.2.m2.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p17.2.m2.1c">1000</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p17.2.m2.1d">1000</annotation></semantics></math> epochs, which provides sufficient training time for the model to learn the complex temporal dependencies of the system and accurately forecast future states. The training process includes regular evaluation of the model to ensure convergence and stability in the learned dynamics.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px1.p18">
<p class="ltx_p" id="S7.SS4.SSS0.Px1.p18.2">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F7" title="Figure 7 ‣ Van der Pol oscillator ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">7</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F8" title="Figure 8 ‣ Van der Pol oscillator ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">8</span></a>, the results from the training and evaluation indicate that all variants of the Deep Koopformer architecture perform similarly well in capturing the nonlinear oscillatory behavior of the Van der Pol system. They achieve accurate forecasting of both state variables, <math alttext="x_{1}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p18.1.m1.1"><semantics id="S7.SS4.SSS0.Px1.p18.1.m1.1a"><msub id="S7.SS4.SSS0.Px1.p18.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.2" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.3" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p18.1.m1.1b"><apply id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p18.1.m1.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p18.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p18.1.m1.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p18.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{2}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px1.p18.2.m2.1"><semantics id="S7.SS4.SSS0.Px1.p18.2.m2.1a"><msub id="S7.SS4.SSS0.Px1.p18.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1.cmml"><mi id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.2" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.3" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px1.p18.2.m2.1b"><apply id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.cmml" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.1.cmml" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.2.cmml" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px1.p18.2.m2.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px1.p18.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px1.p18.2.m2.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px1.p18.2.m2.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, while maintaining stable latent dynamics. This stability is further ensured by the Koopman operator, which constrains the evolution of the latent states, and is validated through the spectral radius of the operator during training (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F8" title="Figure 8 ‣ Van der Pol oscillator ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
<figure class="ltx_figure" id="S7.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="489" id="S7.F7.g1" src="x8.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S7.F7.3.2" style="font-size:90%;">Deep Koopformer based Transformers Variants Comparison on the Van der Pol System.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S7.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="463" id="S7.F8.g1" src="x9.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S7.F8.3.2" style="font-size:90%;">Comparison of Deep Koopman Operator Stability Evolution in Variants Transformers on Van der Pol System during the training loop.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S7.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Lorenz System</h5>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p1.1">The Lorenz system is a classic example of a chaotic dynamical system originally developed to model atmospheric convection. It consists of three coupled, nonlinear ordinary differential equations (ODEs) defined as:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p2">
<table class="ltx_equationgroup ltx_eqn_table" id="S7.Ex39">
<tbody id="S7.Ex39X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{dx_{1}}{dt}" class="ltx_Math" display="inline" id="S7.Ex39X.2.1.1.m1.1"><semantics id="S7.Ex39X.2.1.1.m1.1a"><mstyle displaystyle="true" id="S7.Ex39X.2.1.1.m1.1.1" xref="S7.Ex39X.2.1.1.m1.1.1.cmml"><mfrac id="S7.Ex39X.2.1.1.m1.1.1a" xref="S7.Ex39X.2.1.1.m1.1.1.cmml"><mrow id="S7.Ex39X.2.1.1.m1.1.1.2" xref="S7.Ex39X.2.1.1.m1.1.1.2.cmml"><mi id="S7.Ex39X.2.1.1.m1.1.1.2.2" xref="S7.Ex39X.2.1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.Ex39X.2.1.1.m1.1.1.2.1" xref="S7.Ex39X.2.1.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S7.Ex39X.2.1.1.m1.1.1.2.3" xref="S7.Ex39X.2.1.1.m1.1.1.2.3.cmml"><mi id="S7.Ex39X.2.1.1.m1.1.1.2.3.2" xref="S7.Ex39X.2.1.1.m1.1.1.2.3.2.cmml">x</mi><mn id="S7.Ex39X.2.1.1.m1.1.1.2.3.3" xref="S7.Ex39X.2.1.1.m1.1.1.2.3.3.cmml">1</mn></msub></mrow><mrow id="S7.Ex39X.2.1.1.m1.1.1.3" xref="S7.Ex39X.2.1.1.m1.1.1.3.cmml"><mi id="S7.Ex39X.2.1.1.m1.1.1.3.2" xref="S7.Ex39X.2.1.1.m1.1.1.3.2.cmml">d</mi><mo id="S7.Ex39X.2.1.1.m1.1.1.3.1" xref="S7.Ex39X.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.Ex39X.2.1.1.m1.1.1.3.3" xref="S7.Ex39X.2.1.1.m1.1.1.3.3.cmml">t</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S7.Ex39X.2.1.1.m1.1b"><apply id="S7.Ex39X.2.1.1.m1.1.1.cmml" xref="S7.Ex39X.2.1.1.m1.1.1"><divide id="S7.Ex39X.2.1.1.m1.1.1.1.cmml" xref="S7.Ex39X.2.1.1.m1.1.1"></divide><apply id="S7.Ex39X.2.1.1.m1.1.1.2.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2"><times id="S7.Ex39X.2.1.1.m1.1.1.2.1.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2.1"></times><ci id="S7.Ex39X.2.1.1.m1.1.1.2.2.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2.2">𝑑</ci><apply id="S7.Ex39X.2.1.1.m1.1.1.2.3.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S7.Ex39X.2.1.1.m1.1.1.2.3.1.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S7.Ex39X.2.1.1.m1.1.1.2.3.2.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.2.3.2">𝑥</ci><cn id="S7.Ex39X.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S7.Ex39X.2.1.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S7.Ex39X.2.1.1.m1.1.1.3.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.3"><times id="S7.Ex39X.2.1.1.m1.1.1.3.1.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.3.1"></times><ci id="S7.Ex39X.2.1.1.m1.1.1.3.2.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.3.2">𝑑</ci><ci id="S7.Ex39X.2.1.1.m1.1.1.3.3.cmml" xref="S7.Ex39X.2.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39X.2.1.1.m1.1c">\displaystyle\frac{dx_{1}}{dt}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39X.2.1.1.m1.1d">divide start_ARG italic_d italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(x_{2}-x_{1})," class="ltx_Math" display="inline" id="S7.Ex39X.3.2.2.m1.1"><semantics id="S7.Ex39X.3.2.2.m1.1a"><mrow id="S7.Ex39X.3.2.2.m1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S7.Ex39X.3.2.2.m1.1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.cmml"><mi id="S7.Ex39X.3.2.2.m1.1.1.1.1.3" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S7.Ex39X.3.2.2.m1.1.1.1.1.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.Ex39X.3.2.2.m1.1.1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.3" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mn id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.Ex39X.3.2.2.m1.1.1.1.2" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex39X.3.2.2.m1.1b"><apply id="S7.Ex39X.3.2.2.m1.1.1.1.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1"><eq id="S7.Ex39X.3.2.2.m1.1.1.1.1.2.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S7.Ex39X.3.2.2.m1.1.1.1.1.3.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1"><times id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.3">𝜎</ci><apply id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1"><minus id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><cn id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><apply id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex39X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39X.3.2.2.m1.1c">\displaystyle=\sigma(x_{2}-x_{1}),</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39X.3.2.2.m1.1d">= italic_σ ( italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex39Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{dx_{2}}{dt}" class="ltx_Math" display="inline" id="S7.Ex39Xa.2.1.1.m1.1"><semantics id="S7.Ex39Xa.2.1.1.m1.1a"><mstyle displaystyle="true" id="S7.Ex39Xa.2.1.1.m1.1.1" xref="S7.Ex39Xa.2.1.1.m1.1.1.cmml"><mfrac id="S7.Ex39Xa.2.1.1.m1.1.1a" xref="S7.Ex39Xa.2.1.1.m1.1.1.cmml"><mrow id="S7.Ex39Xa.2.1.1.m1.1.1.2" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.cmml"><mi id="S7.Ex39Xa.2.1.1.m1.1.1.2.2" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.Ex39Xa.2.1.1.m1.1.1.2.1" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S7.Ex39Xa.2.1.1.m1.1.1.2.3" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3.cmml"><mi id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.2" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3.2.cmml">x</mi><mn id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.3" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3.3.cmml">2</mn></msub></mrow><mrow id="S7.Ex39Xa.2.1.1.m1.1.1.3" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.cmml"><mi id="S7.Ex39Xa.2.1.1.m1.1.1.3.2" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.2.cmml">d</mi><mo id="S7.Ex39Xa.2.1.1.m1.1.1.3.1" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.Ex39Xa.2.1.1.m1.1.1.3.3" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.3.cmml">t</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S7.Ex39Xa.2.1.1.m1.1b"><apply id="S7.Ex39Xa.2.1.1.m1.1.1.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1"><divide id="S7.Ex39Xa.2.1.1.m1.1.1.1.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1"></divide><apply id="S7.Ex39Xa.2.1.1.m1.1.1.2.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2"><times id="S7.Ex39Xa.2.1.1.m1.1.1.2.1.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.1"></times><ci id="S7.Ex39Xa.2.1.1.m1.1.1.2.2.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.2">𝑑</ci><apply id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3.2">𝑥</ci><cn id="S7.Ex39Xa.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S7.Ex39Xa.2.1.1.m1.1.1.2.3.3">2</cn></apply></apply><apply id="S7.Ex39Xa.2.1.1.m1.1.1.3.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.3"><times id="S7.Ex39Xa.2.1.1.m1.1.1.3.1.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.1"></times><ci id="S7.Ex39Xa.2.1.1.m1.1.1.3.2.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.2">𝑑</ci><ci id="S7.Ex39Xa.2.1.1.m1.1.1.3.3.cmml" xref="S7.Ex39Xa.2.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39Xa.2.1.1.m1.1c">\displaystyle\frac{dx_{2}}{dt}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39Xa.2.1.1.m1.1d">divide start_ARG italic_d italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=x_{1}(\rho-x_{3})-x_{2}," class="ltx_Math" display="inline" id="S7.Ex39Xa.3.2.2.m1.1"><semantics id="S7.Ex39Xa.3.2.2.m1.1a"><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">ρ</mi><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub></mrow><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.2.cmml">−</mo><msub id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.3" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S7.Ex39Xa.3.2.2.m1.1.1.1.2" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex39Xa.3.2.2.m1.1b"><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1"><eq id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1"><minus id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.2"></minus><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1"><times id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><minus id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝜌</ci><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">3</cn></apply></apply></apply><apply id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.2">𝑥</ci><cn id="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.Ex39Xa.3.2.2.m1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39Xa.3.2.2.m1.1c">\displaystyle=x_{1}(\rho-x_{3})-x_{2},</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39Xa.3.2.2.m1.1d">= italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_ρ - italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ) - italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex39Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{dx_{3}}{dt}" class="ltx_Math" display="inline" id="S7.Ex39Xb.2.1.1.m1.1"><semantics id="S7.Ex39Xb.2.1.1.m1.1a"><mstyle displaystyle="true" id="S7.Ex39Xb.2.1.1.m1.1.1" xref="S7.Ex39Xb.2.1.1.m1.1.1.cmml"><mfrac id="S7.Ex39Xb.2.1.1.m1.1.1a" xref="S7.Ex39Xb.2.1.1.m1.1.1.cmml"><mrow id="S7.Ex39Xb.2.1.1.m1.1.1.2" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.cmml"><mi id="S7.Ex39Xb.2.1.1.m1.1.1.2.2" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.Ex39Xb.2.1.1.m1.1.1.2.1" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S7.Ex39Xb.2.1.1.m1.1.1.2.3" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3.cmml"><mi id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.2" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3.2.cmml">x</mi><mn id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.3" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3.3.cmml">3</mn></msub></mrow><mrow id="S7.Ex39Xb.2.1.1.m1.1.1.3" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.cmml"><mi id="S7.Ex39Xb.2.1.1.m1.1.1.3.2" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.2.cmml">d</mi><mo id="S7.Ex39Xb.2.1.1.m1.1.1.3.1" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.Ex39Xb.2.1.1.m1.1.1.3.3" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.3.cmml">t</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S7.Ex39Xb.2.1.1.m1.1b"><apply id="S7.Ex39Xb.2.1.1.m1.1.1.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1"><divide id="S7.Ex39Xb.2.1.1.m1.1.1.1.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1"></divide><apply id="S7.Ex39Xb.2.1.1.m1.1.1.2.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2"><times id="S7.Ex39Xb.2.1.1.m1.1.1.2.1.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.1"></times><ci id="S7.Ex39Xb.2.1.1.m1.1.1.2.2.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.2">𝑑</ci><apply id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.1.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.2.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3.2">𝑥</ci><cn id="S7.Ex39Xb.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S7.Ex39Xb.2.1.1.m1.1.1.2.3.3">3</cn></apply></apply><apply id="S7.Ex39Xb.2.1.1.m1.1.1.3.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.3"><times id="S7.Ex39Xb.2.1.1.m1.1.1.3.1.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.1"></times><ci id="S7.Ex39Xb.2.1.1.m1.1.1.3.2.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.2">𝑑</ci><ci id="S7.Ex39Xb.2.1.1.m1.1.1.3.3.cmml" xref="S7.Ex39Xb.2.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39Xb.2.1.1.m1.1c">\displaystyle\frac{dx_{3}}{dt}</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39Xb.2.1.1.m1.1d">divide start_ARG italic_d italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_ARG start_ARG italic_d italic_t end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=x_{1}x_{2}-\beta x_{3}," class="ltx_Math" display="inline" id="S7.Ex39Xb.3.2.2.m1.1"><semantics id="S7.Ex39Xb.3.2.2.m1.1a"><mrow id="S7.Ex39Xb.3.2.2.m1.1.1.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.cmml"><mrow id="S7.Ex39Xb.3.2.2.m1.1.1.1.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.cmml"><mi id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.cmml"><msub id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.cmml"><mi id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.2.cmml">x</mi><mn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.3.cmml">1</mn></msub><mo id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.cmml"><mi id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.2.cmml">x</mi><mn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.3.cmml">2</mn></msub></mrow><mo id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.1.cmml">−</mo><mrow id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.2.cmml">β</mi><mo id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.1" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.cmml"><mi id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.3" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.3.cmml">3</mn></msub></mrow></mrow></mrow><mo id="S7.Ex39Xb.3.2.2.m1.1.1.1.2" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex39Xb.3.2.2.m1.1b"><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1"><eq id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3"><minus id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.1"></minus><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2"><times id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.1"></times><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.2">𝑥</ci><cn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.2.3">1</cn></apply><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.2">𝑥</ci><cn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.2.3.3">2</cn></apply></apply><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3"><times id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.1"></times><ci id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.1.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.2.cmml" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.2">𝑥</ci><cn id="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S7.Ex39Xb.3.2.2.m1.1.1.1.1.3.3.3.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex39Xb.3.2.2.m1.1c">\displaystyle=x_{1}x_{2}-\beta x_{3},</annotation><annotation encoding="application/x-llamapun" id="S7.Ex39Xb.3.2.2.m1.1d">= italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_β italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p3">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p3.1">where:</p>
<ul class="ltx_itemize" id="S7.I6">
<li class="ltx_item" id="S7.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I6.i1.p1">
<p class="ltx_p" id="S7.I6.i1.p1.4"><math alttext="x_{1}(t)" class="ltx_Math" display="inline" id="S7.I6.i1.p1.1.m1.1"><semantics id="S7.I6.i1.p1.1.m1.1a"><mrow id="S7.I6.i1.p1.1.m1.1.2" xref="S7.I6.i1.p1.1.m1.1.2.cmml"><msub id="S7.I6.i1.p1.1.m1.1.2.2" xref="S7.I6.i1.p1.1.m1.1.2.2.cmml"><mi id="S7.I6.i1.p1.1.m1.1.2.2.2" xref="S7.I6.i1.p1.1.m1.1.2.2.2.cmml">x</mi><mn id="S7.I6.i1.p1.1.m1.1.2.2.3" xref="S7.I6.i1.p1.1.m1.1.2.2.3.cmml">1</mn></msub><mo id="S7.I6.i1.p1.1.m1.1.2.1" xref="S7.I6.i1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S7.I6.i1.p1.1.m1.1.2.3.2" xref="S7.I6.i1.p1.1.m1.1.2.cmml"><mo id="S7.I6.i1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S7.I6.i1.p1.1.m1.1.2.cmml">(</mo><mi id="S7.I6.i1.p1.1.m1.1.1" xref="S7.I6.i1.p1.1.m1.1.1.cmml">t</mi><mo id="S7.I6.i1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S7.I6.i1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I6.i1.p1.1.m1.1b"><apply id="S7.I6.i1.p1.1.m1.1.2.cmml" xref="S7.I6.i1.p1.1.m1.1.2"><times id="S7.I6.i1.p1.1.m1.1.2.1.cmml" xref="S7.I6.i1.p1.1.m1.1.2.1"></times><apply id="S7.I6.i1.p1.1.m1.1.2.2.cmml" xref="S7.I6.i1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S7.I6.i1.p1.1.m1.1.2.2.1.cmml" xref="S7.I6.i1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S7.I6.i1.p1.1.m1.1.2.2.2.cmml" xref="S7.I6.i1.p1.1.m1.1.2.2.2">𝑥</ci><cn id="S7.I6.i1.p1.1.m1.1.2.2.3.cmml" type="integer" xref="S7.I6.i1.p1.1.m1.1.2.2.3">1</cn></apply><ci id="S7.I6.i1.p1.1.m1.1.1.cmml" xref="S7.I6.i1.p1.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i1.p1.1.m1.1c">x_{1}(t)</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i1.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math>, <math alttext="x_{2}(t)" class="ltx_Math" display="inline" id="S7.I6.i1.p1.2.m2.1"><semantics id="S7.I6.i1.p1.2.m2.1a"><mrow id="S7.I6.i1.p1.2.m2.1.2" xref="S7.I6.i1.p1.2.m2.1.2.cmml"><msub id="S7.I6.i1.p1.2.m2.1.2.2" xref="S7.I6.i1.p1.2.m2.1.2.2.cmml"><mi id="S7.I6.i1.p1.2.m2.1.2.2.2" xref="S7.I6.i1.p1.2.m2.1.2.2.2.cmml">x</mi><mn id="S7.I6.i1.p1.2.m2.1.2.2.3" xref="S7.I6.i1.p1.2.m2.1.2.2.3.cmml">2</mn></msub><mo id="S7.I6.i1.p1.2.m2.1.2.1" xref="S7.I6.i1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S7.I6.i1.p1.2.m2.1.2.3.2" xref="S7.I6.i1.p1.2.m2.1.2.cmml"><mo id="S7.I6.i1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S7.I6.i1.p1.2.m2.1.2.cmml">(</mo><mi id="S7.I6.i1.p1.2.m2.1.1" xref="S7.I6.i1.p1.2.m2.1.1.cmml">t</mi><mo id="S7.I6.i1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S7.I6.i1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I6.i1.p1.2.m2.1b"><apply id="S7.I6.i1.p1.2.m2.1.2.cmml" xref="S7.I6.i1.p1.2.m2.1.2"><times id="S7.I6.i1.p1.2.m2.1.2.1.cmml" xref="S7.I6.i1.p1.2.m2.1.2.1"></times><apply id="S7.I6.i1.p1.2.m2.1.2.2.cmml" xref="S7.I6.i1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S7.I6.i1.p1.2.m2.1.2.2.1.cmml" xref="S7.I6.i1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S7.I6.i1.p1.2.m2.1.2.2.2.cmml" xref="S7.I6.i1.p1.2.m2.1.2.2.2">𝑥</ci><cn id="S7.I6.i1.p1.2.m2.1.2.2.3.cmml" type="integer" xref="S7.I6.i1.p1.2.m2.1.2.2.3">2</cn></apply><ci id="S7.I6.i1.p1.2.m2.1.1.cmml" xref="S7.I6.i1.p1.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i1.p1.2.m2.1c">x_{2}(t)</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math>, and <math alttext="x_{3}(t)" class="ltx_Math" display="inline" id="S7.I6.i1.p1.3.m3.1"><semantics id="S7.I6.i1.p1.3.m3.1a"><mrow id="S7.I6.i1.p1.3.m3.1.2" xref="S7.I6.i1.p1.3.m3.1.2.cmml"><msub id="S7.I6.i1.p1.3.m3.1.2.2" xref="S7.I6.i1.p1.3.m3.1.2.2.cmml"><mi id="S7.I6.i1.p1.3.m3.1.2.2.2" xref="S7.I6.i1.p1.3.m3.1.2.2.2.cmml">x</mi><mn id="S7.I6.i1.p1.3.m3.1.2.2.3" xref="S7.I6.i1.p1.3.m3.1.2.2.3.cmml">3</mn></msub><mo id="S7.I6.i1.p1.3.m3.1.2.1" xref="S7.I6.i1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S7.I6.i1.p1.3.m3.1.2.3.2" xref="S7.I6.i1.p1.3.m3.1.2.cmml"><mo id="S7.I6.i1.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S7.I6.i1.p1.3.m3.1.2.cmml">(</mo><mi id="S7.I6.i1.p1.3.m3.1.1" xref="S7.I6.i1.p1.3.m3.1.1.cmml">t</mi><mo id="S7.I6.i1.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S7.I6.i1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I6.i1.p1.3.m3.1b"><apply id="S7.I6.i1.p1.3.m3.1.2.cmml" xref="S7.I6.i1.p1.3.m3.1.2"><times id="S7.I6.i1.p1.3.m3.1.2.1.cmml" xref="S7.I6.i1.p1.3.m3.1.2.1"></times><apply id="S7.I6.i1.p1.3.m3.1.2.2.cmml" xref="S7.I6.i1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S7.I6.i1.p1.3.m3.1.2.2.1.cmml" xref="S7.I6.i1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S7.I6.i1.p1.3.m3.1.2.2.2.cmml" xref="S7.I6.i1.p1.3.m3.1.2.2.2">𝑥</ci><cn id="S7.I6.i1.p1.3.m3.1.2.2.3.cmml" type="integer" xref="S7.I6.i1.p1.3.m3.1.2.2.3">3</cn></apply><ci id="S7.I6.i1.p1.3.m3.1.1.cmml" xref="S7.I6.i1.p1.3.m3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i1.p1.3.m3.1c">x_{3}(t)</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> represent the state variables at time <math alttext="t" class="ltx_Math" display="inline" id="S7.I6.i1.p1.4.m4.1"><semantics id="S7.I6.i1.p1.4.m4.1a"><mi id="S7.I6.i1.p1.4.m4.1.1" xref="S7.I6.i1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.I6.i1.p1.4.m4.1b"><ci id="S7.I6.i1.p1.4.m4.1.1.cmml" xref="S7.I6.i1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i1.p1.4.m4.1d">italic_t</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I6.i2.p1">
<p class="ltx_p" id="S7.I6.i2.p1.1"><math alttext="\sigma" class="ltx_Math" display="inline" id="S7.I6.i2.p1.1.m1.1"><semantics id="S7.I6.i2.p1.1.m1.1a"><mi id="S7.I6.i2.p1.1.m1.1.1" xref="S7.I6.i2.p1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.I6.i2.p1.1.m1.1b"><ci id="S7.I6.i2.p1.1.m1.1.1.cmml" xref="S7.I6.i2.p1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i2.p1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i2.p1.1.m1.1d">italic_σ</annotation></semantics></math> is the Prandtl number and controls the rate of convection,</p>
</div>
</li>
<li class="ltx_item" id="S7.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I6.i3.p1">
<p class="ltx_p" id="S7.I6.i3.p1.1"><math alttext="\rho" class="ltx_Math" display="inline" id="S7.I6.i3.p1.1.m1.1"><semantics id="S7.I6.i3.p1.1.m1.1a"><mi id="S7.I6.i3.p1.1.m1.1.1" xref="S7.I6.i3.p1.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S7.I6.i3.p1.1.m1.1b"><ci id="S7.I6.i3.p1.1.m1.1.1.cmml" xref="S7.I6.i3.p1.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i3.p1.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i3.p1.1.m1.1d">italic_ρ</annotation></semantics></math> is the Rayleigh number and governs the temperature difference,</p>
</div>
</li>
<li class="ltx_item" id="S7.I6.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I6.i4.p1">
<p class="ltx_p" id="S7.I6.i4.p1.1"><math alttext="\beta" class="ltx_Math" display="inline" id="S7.I6.i4.p1.1.m1.1"><semantics id="S7.I6.i4.p1.1.m1.1a"><mi id="S7.I6.i4.p1.1.m1.1.1" xref="S7.I6.i4.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S7.I6.i4.p1.1.m1.1b"><ci id="S7.I6.i4.p1.1.m1.1.1.cmml" xref="S7.I6.i4.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I6.i4.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S7.I6.i4.p1.1.m1.1d">italic_β</annotation></semantics></math> is a geometric factor related to the aspect ratio of the convection cells.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p4">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p4.1">To simulate more realistic conditions, stochastic noise is added to the deterministic Lorenz dynamics. The discretized and noisy Lorenz system is defined as:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p5">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex40">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{t+1}=\mathbf{x}_{t}+\Delta t\cdot\mathbf{g}(\mathbf{x}_{t})+%
\boldsymbol{\eta}_{t}," class="ltx_Math" display="block" id="S7.Ex40.m1.1"><semantics id="S7.Ex40.m1.1a"><mrow id="S7.Ex40.m1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.cmml"><mrow id="S7.Ex40.m1.1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.cmml"><msub id="S7.Ex40.m1.1.1.1.1.3" xref="S7.Ex40.m1.1.1.1.1.3.cmml"><mi id="S7.Ex40.m1.1.1.1.1.3.2" xref="S7.Ex40.m1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S7.Ex40.m1.1.1.1.1.3.3" xref="S7.Ex40.m1.1.1.1.1.3.3.cmml"><mi id="S7.Ex40.m1.1.1.1.1.3.3.2" xref="S7.Ex40.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S7.Ex40.m1.1.1.1.1.3.3.1" xref="S7.Ex40.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S7.Ex40.m1.1.1.1.1.3.3.3" xref="S7.Ex40.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S7.Ex40.m1.1.1.1.1.2" xref="S7.Ex40.m1.1.1.1.1.2.cmml">=</mo><mrow id="S7.Ex40.m1.1.1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.1.cmml"><msub id="S7.Ex40.m1.1.1.1.1.1.3" xref="S7.Ex40.m1.1.1.1.1.1.3.cmml"><mi id="S7.Ex40.m1.1.1.1.1.1.3.2" xref="S7.Ex40.m1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S7.Ex40.m1.1.1.1.1.1.3.3" xref="S7.Ex40.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S7.Ex40.m1.1.1.1.1.1.2" xref="S7.Ex40.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S7.Ex40.m1.1.1.1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex40.m1.1.1.1.1.1.1.3" xref="S7.Ex40.m1.1.1.1.1.1.1.3.cmml"><mrow id="S7.Ex40.m1.1.1.1.1.1.1.3.2" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S7.Ex40.m1.1.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.2.cmml">Δ</mi><mo id="S7.Ex40.m1.1.1.1.1.1.1.3.2.1" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S7.Ex40.m1.1.1.1.1.1.1.3.2.3" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.3.cmml">t</mi></mrow><mo id="S7.Ex40.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S7.Ex40.m1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S7.Ex40.m1.1.1.1.1.1.1.3.3" xref="S7.Ex40.m1.1.1.1.1.1.1.3.3.cmml">𝐠</mi></mrow><mo id="S7.Ex40.m1.1.1.1.1.1.1.2" xref="S7.Ex40.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex40.m1.1.1.1.1.1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.Ex40.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.Ex40.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex40.m1.1.1.1.1.1.2a" xref="S7.Ex40.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S7.Ex40.m1.1.1.1.1.1.4" xref="S7.Ex40.m1.1.1.1.1.1.4.cmml"><mi id="S7.Ex40.m1.1.1.1.1.1.4.2" xref="S7.Ex40.m1.1.1.1.1.1.4.2.cmml">𝜼</mi><mi id="S7.Ex40.m1.1.1.1.1.1.4.3" xref="S7.Ex40.m1.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow></mrow><mo id="S7.Ex40.m1.1.1.1.2" xref="S7.Ex40.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex40.m1.1b"><apply id="S7.Ex40.m1.1.1.1.1.cmml" xref="S7.Ex40.m1.1.1.1"><eq id="S7.Ex40.m1.1.1.1.1.2.cmml" xref="S7.Ex40.m1.1.1.1.1.2"></eq><apply id="S7.Ex40.m1.1.1.1.1.3.cmml" xref="S7.Ex40.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex40.m1.1.1.1.1.3.1.cmml" xref="S7.Ex40.m1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex40.m1.1.1.1.1.3.2.cmml" xref="S7.Ex40.m1.1.1.1.1.3.2">𝐱</ci><apply id="S7.Ex40.m1.1.1.1.1.3.3.cmml" xref="S7.Ex40.m1.1.1.1.1.3.3"><plus id="S7.Ex40.m1.1.1.1.1.3.3.1.cmml" xref="S7.Ex40.m1.1.1.1.1.3.3.1"></plus><ci id="S7.Ex40.m1.1.1.1.1.3.3.2.cmml" xref="S7.Ex40.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="S7.Ex40.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S7.Ex40.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S7.Ex40.m1.1.1.1.1.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1"><plus id="S7.Ex40.m1.1.1.1.1.1.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.2"></plus><apply id="S7.Ex40.m1.1.1.1.1.1.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex40.m1.1.1.1.1.1.3.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex40.m1.1.1.1.1.1.3.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.3.2">𝐱</ci><ci id="S7.Ex40.m1.1.1.1.1.1.3.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S7.Ex40.m1.1.1.1.1.1.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1"><times id="S7.Ex40.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.2"></times><apply id="S7.Ex40.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3"><ci id="S7.Ex40.m1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S7.Ex40.m1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2"><times id="S7.Ex40.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.1"></times><ci id="S7.Ex40.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.2">Δ</ci><ci id="S7.Ex40.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S7.Ex40.m1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.3.3">𝐠</ci></apply><apply id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S7.Ex40.m1.1.1.1.1.1.4.cmml" xref="S7.Ex40.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S7.Ex40.m1.1.1.1.1.1.4.1.cmml" xref="S7.Ex40.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S7.Ex40.m1.1.1.1.1.1.4.2.cmml" xref="S7.Ex40.m1.1.1.1.1.1.4.2">𝜼</ci><ci id="S7.Ex40.m1.1.1.1.1.1.4.3.cmml" xref="S7.Ex40.m1.1.1.1.1.1.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex40.m1.1c">\mathbf{x}_{t+1}=\mathbf{x}_{t}+\Delta t\cdot\mathbf{g}(\mathbf{x}_{t})+%
\boldsymbol{\eta}_{t},</annotation><annotation encoding="application/x-llamapun" id="S7.Ex40.m1.1d">bold_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + roman_Δ italic_t ⋅ bold_g ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + bold_italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p6">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p6.1">where:</p>
<ul class="ltx_itemize" id="S7.I7">
<li class="ltx_item" id="S7.I7.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I7.i1.p1">
<p class="ltx_p" id="S7.I7.i1.p1.2"><math alttext="\mathbf{x}_{t}=\begin{bmatrix}x_{1,t}\\
x_{2,t}\\
x_{3,t}\end{bmatrix}" class="ltx_Math" display="inline" id="S7.I7.i1.p1.1.m1.1"><semantics id="S7.I7.i1.p1.1.m1.1a"><mrow id="S7.I7.i1.p1.1.m1.1.2" xref="S7.I7.i1.p1.1.m1.1.2.cmml"><msub id="S7.I7.i1.p1.1.m1.1.2.2" xref="S7.I7.i1.p1.1.m1.1.2.2.cmml"><mi id="S7.I7.i1.p1.1.m1.1.2.2.2" xref="S7.I7.i1.p1.1.m1.1.2.2.2.cmml">𝐱</mi><mi id="S7.I7.i1.p1.1.m1.1.2.2.3" xref="S7.I7.i1.p1.1.m1.1.2.2.3.cmml">t</mi></msub><mo id="S7.I7.i1.p1.1.m1.1.2.1" xref="S7.I7.i1.p1.1.m1.1.2.1.cmml">=</mo><mrow id="S7.I7.i1.p1.1.m1.1.1.3" xref="S7.I7.i1.p1.1.m1.1.1.2.cmml"><mo id="S7.I7.i1.p1.1.m1.1.1.3.1" xref="S7.I7.i1.p1.1.m1.1.1.2.1.cmml">[</mo><mtable id="S7.I7.i1.p1.1.m1.1.1.1.1" rowspacing="0pt" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><mtr id="S7.I7.i1.p1.1.m1.1.1.1.1a" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><mtd id="S7.I7.i1.p1.1.m1.1.1.1.1b" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><msub id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.4.cmml">x</mi><mrow id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mn id="S7.I7.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">,</mo><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">t</mi></mrow></msub></mtd></mtr><mtr id="S7.I7.i1.p1.1.m1.1.1.1.1c" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><mtd id="S7.I7.i1.p1.1.m1.1.1.1.1d" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><msub id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.cmml"><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.4.cmml">x</mi><mrow id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml"><mn id="S7.I7.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1.cmml">2</mn><mo id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml">,</mo><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2.cmml">t</mi></mrow></msub></mtd></mtr><mtr id="S7.I7.i1.p1.1.m1.1.1.1.1e" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><mtd id="S7.I7.i1.p1.1.m1.1.1.1.1f" xref="S7.I7.i1.p1.1.m1.1.1.1.1.cmml"><msub id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.cmml"><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.4.cmml">x</mi><mrow id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.4" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.3.cmml"><mn id="S7.I7.i1.p1.1.m1.1.1.1.1.5.5.1.1.1.1.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.5.5.1.1.1.1.1.cmml">3</mn><mo id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.4.1" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.3.cmml">,</mo><mi id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.2" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.2.cmml">t</mi></mrow></msub></mtd></mtr></mtable><mo id="S7.I7.i1.p1.1.m1.1.1.3.2" xref="S7.I7.i1.p1.1.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I7.i1.p1.1.m1.1b"><apply id="S7.I7.i1.p1.1.m1.1.2.cmml" xref="S7.I7.i1.p1.1.m1.1.2"><eq id="S7.I7.i1.p1.1.m1.1.2.1.cmml" xref="S7.I7.i1.p1.1.m1.1.2.1"></eq><apply id="S7.I7.i1.p1.1.m1.1.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S7.I7.i1.p1.1.m1.1.2.2.1.cmml" xref="S7.I7.i1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S7.I7.i1.p1.1.m1.1.2.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.2.2.2">𝐱</ci><ci id="S7.I7.i1.p1.1.m1.1.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.2.2.3">𝑡</ci></apply><apply id="S7.I7.i1.p1.1.m1.1.1.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S7.I7.i1.p1.1.m1.1.1.2.1.cmml" xref="S7.I7.i1.p1.1.m1.1.1.3.1">matrix</csymbol><matrix id="S7.I7.i1.p1.1.m1.1.1.1.1.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1"><matrixrow id="S7.I7.i1.p1.1.m1.1.1.1.1a.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1"><apply id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.4">𝑥</ci><list id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.4"><cn id="S7.I7.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" type="integer" xref="S7.I7.i1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1">1</cn><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.2.2.2.2.2.2.2">𝑡</ci></list></apply></matrixrow><matrixrow id="S7.I7.i1.p1.1.m1.1.1.1.1b.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1"><apply id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2">subscript</csymbol><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.4.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.4">𝑥</ci><list id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.4"><cn id="S7.I7.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1.cmml" type="integer" xref="S7.I7.i1.p1.1.m1.1.1.1.1.3.3.1.1.1.1.1">2</cn><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.4.4.2.2.2.2.2">𝑡</ci></list></apply></matrixrow><matrixrow id="S7.I7.i1.p1.1.m1.1.1.1.1c.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1"><apply id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2"><csymbol cd="ambiguous" id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2">subscript</csymbol><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.4.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.4">𝑥</ci><list id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.3.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.4"><cn id="S7.I7.i1.p1.1.m1.1.1.1.1.5.5.1.1.1.1.1.cmml" type="integer" xref="S7.I7.i1.p1.1.m1.1.1.1.1.5.5.1.1.1.1.1">3</cn><ci id="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.2.cmml" xref="S7.I7.i1.p1.1.m1.1.1.1.1.6.6.2.2.2.2.2">𝑡</ci></list></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I7.i1.p1.1.m1.1c">\mathbf{x}_{t}=\begin{bmatrix}x_{1,t}\\
x_{2,t}\\
x_{3,t}\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S7.I7.i1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ start_ARG start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 2 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 3 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ]</annotation></semantics></math> is the state vector at time step <math alttext="t" class="ltx_Math" display="inline" id="S7.I7.i1.p1.2.m2.1"><semantics id="S7.I7.i1.p1.2.m2.1a"><mi id="S7.I7.i1.p1.2.m2.1.1" xref="S7.I7.i1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.I7.i1.p1.2.m2.1b"><ci id="S7.I7.i1.p1.2.m2.1.1.cmml" xref="S7.I7.i1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.I7.i1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.I7.i1.p1.2.m2.1d">italic_t</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I7.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I7.i2.p1">
<p class="ltx_p" id="S7.I7.i2.p1.1"><math alttext="\Delta t" class="ltx_Math" display="inline" id="S7.I7.i2.p1.1.m1.1"><semantics id="S7.I7.i2.p1.1.m1.1a"><mrow id="S7.I7.i2.p1.1.m1.1.1" xref="S7.I7.i2.p1.1.m1.1.1.cmml"><mi id="S7.I7.i2.p1.1.m1.1.1.2" mathvariant="normal" xref="S7.I7.i2.p1.1.m1.1.1.2.cmml">Δ</mi><mo id="S7.I7.i2.p1.1.m1.1.1.1" xref="S7.I7.i2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S7.I7.i2.p1.1.m1.1.1.3" xref="S7.I7.i2.p1.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.I7.i2.p1.1.m1.1b"><apply id="S7.I7.i2.p1.1.m1.1.1.cmml" xref="S7.I7.i2.p1.1.m1.1.1"><times id="S7.I7.i2.p1.1.m1.1.1.1.cmml" xref="S7.I7.i2.p1.1.m1.1.1.1"></times><ci id="S7.I7.i2.p1.1.m1.1.1.2.cmml" xref="S7.I7.i2.p1.1.m1.1.1.2">Δ</ci><ci id="S7.I7.i2.p1.1.m1.1.1.3.cmml" xref="S7.I7.i2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I7.i2.p1.1.m1.1c">\Delta t</annotation><annotation encoding="application/x-llamapun" id="S7.I7.i2.p1.1.m1.1d">roman_Δ italic_t</annotation></semantics></math> is the time step size,</p>
</div>
</li>
<li class="ltx_item" id="S7.I7.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I7.i3.p1">
<p class="ltx_p" id="S7.I7.i3.p1.1"><math alttext="\mathbf{g}(\mathbf{x}_{t})" class="ltx_Math" display="inline" id="S7.I7.i3.p1.1.m1.1"><semantics id="S7.I7.i3.p1.1.m1.1a"><mrow id="S7.I7.i3.p1.1.m1.1.1" xref="S7.I7.i3.p1.1.m1.1.1.cmml"><mi id="S7.I7.i3.p1.1.m1.1.1.3" xref="S7.I7.i3.p1.1.m1.1.1.3.cmml">𝐠</mi><mo id="S7.I7.i3.p1.1.m1.1.1.2" xref="S7.I7.i3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S7.I7.i3.p1.1.m1.1.1.1.1" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S7.I7.i3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S7.I7.i3.p1.1.m1.1.1.1.1.1" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S7.I7.i3.p1.1.m1.1.1.1.1.1.2" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S7.I7.i3.p1.1.m1.1.1.1.1.1.3" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.I7.i3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I7.i3.p1.1.m1.1b"><apply id="S7.I7.i3.p1.1.m1.1.1.cmml" xref="S7.I7.i3.p1.1.m1.1.1"><times id="S7.I7.i3.p1.1.m1.1.1.2.cmml" xref="S7.I7.i3.p1.1.m1.1.1.2"></times><ci id="S7.I7.i3.p1.1.m1.1.1.3.cmml" xref="S7.I7.i3.p1.1.m1.1.1.3">𝐠</ci><apply id="S7.I7.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S7.I7.i3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S7.I7.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S7.I7.i3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S7.I7.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.2">𝐱</ci><ci id="S7.I7.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S7.I7.i3.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I7.i3.p1.1.m1.1c">\mathbf{g}(\mathbf{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="S7.I7.i3.p1.1.m1.1d">bold_g ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> represents the deterministic Lorenz dynamics,</p>
</div>
</li>
<li class="ltx_item" id="S7.I7.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I7.i4.p1">
<p class="ltx_p" id="S7.I7.i4.p1.1"><math alttext="\boldsymbol{\eta}_{t}\sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})" class="ltx_Math" display="inline" id="S7.I7.i4.p1.1.m1.2"><semantics id="S7.I7.i4.p1.1.m1.2a"><mrow id="S7.I7.i4.p1.1.m1.2.2" xref="S7.I7.i4.p1.1.m1.2.2.cmml"><msub id="S7.I7.i4.p1.1.m1.2.2.3" xref="S7.I7.i4.p1.1.m1.2.2.3.cmml"><mi id="S7.I7.i4.p1.1.m1.2.2.3.2" xref="S7.I7.i4.p1.1.m1.2.2.3.2.cmml">𝜼</mi><mi id="S7.I7.i4.p1.1.m1.2.2.3.3" xref="S7.I7.i4.p1.1.m1.2.2.3.3.cmml">t</mi></msub><mo id="S7.I7.i4.p1.1.m1.2.2.2" xref="S7.I7.i4.p1.1.m1.2.2.2.cmml">∼</mo><mrow id="S7.I7.i4.p1.1.m1.2.2.1" xref="S7.I7.i4.p1.1.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.I7.i4.p1.1.m1.2.2.1.3" xref="S7.I7.i4.p1.1.m1.2.2.1.3.cmml">𝒩</mi><mo id="S7.I7.i4.p1.1.m1.2.2.1.2" xref="S7.I7.i4.p1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S7.I7.i4.p1.1.m1.2.2.1.1.1" xref="S7.I7.i4.p1.1.m1.2.2.1.1.2.cmml"><mo id="S7.I7.i4.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S7.I7.i4.p1.1.m1.2.2.1.1.2.cmml">(</mo><mn id="S7.I7.i4.p1.1.m1.1.1" xref="S7.I7.i4.p1.1.m1.1.1.cmml">𝟎</mn><mo id="S7.I7.i4.p1.1.m1.2.2.1.1.1.3" xref="S7.I7.i4.p1.1.m1.2.2.1.1.2.cmml">,</mo><mrow id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.cmml"><msup id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.2" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.2.cmml">σ</mi><mn id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.3" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.1" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.3" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo id="S7.I7.i4.p1.1.m1.2.2.1.1.1.4" stretchy="false" xref="S7.I7.i4.p1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.I7.i4.p1.1.m1.2b"><apply id="S7.I7.i4.p1.1.m1.2.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2"><csymbol cd="latexml" id="S7.I7.i4.p1.1.m1.2.2.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.2">similar-to</csymbol><apply id="S7.I7.i4.p1.1.m1.2.2.3.cmml" xref="S7.I7.i4.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S7.I7.i4.p1.1.m1.2.2.3.1.cmml" xref="S7.I7.i4.p1.1.m1.2.2.3">subscript</csymbol><ci id="S7.I7.i4.p1.1.m1.2.2.3.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.3.2">𝜼</ci><ci id="S7.I7.i4.p1.1.m1.2.2.3.3.cmml" xref="S7.I7.i4.p1.1.m1.2.2.3.3">𝑡</ci></apply><apply id="S7.I7.i4.p1.1.m1.2.2.1.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1"><times id="S7.I7.i4.p1.1.m1.2.2.1.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.2"></times><ci id="S7.I7.i4.p1.1.m1.2.2.1.3.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.3">𝒩</ci><interval closure="open" id="S7.I7.i4.p1.1.m1.2.2.1.1.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1"><cn id="S7.I7.i4.p1.1.m1.1.1.cmml" type="integer" xref="S7.I7.i4.p1.1.m1.1.1">0</cn><apply id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1"><times id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.1"></times><apply id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.2">𝜎</ci><cn id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.2.3">2</cn></apply><ci id="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S7.I7.i4.p1.1.m1.2.2.1.1.1.1.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I7.i4.p1.1.m1.2c">\boldsymbol{\eta}_{t}\sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S7.I7.i4.p1.1.m1.2d">bold_italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_I )</annotation></semantics></math> is an additive Gaussian noise term.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p7">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p7.1">The deterministic dynamics <math alttext="\mathbf{g}(\mathbf{x}_{t})" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p7.1.m1.1"><semantics id="S7.SS4.SSS0.Px2.p7.1.m1.1a"><mrow id="S7.SS4.SSS0.Px2.p7.1.m1.1.1" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.3" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.3.cmml">𝐠</mi><mo id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.2" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.2.cmml">⁢</mo><mrow id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.cmml"><mo id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.2" stretchy="false" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.2" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.3" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.3" stretchy="false" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p7.1.m1.1b"><apply id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1"><times id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.2"></times><ci id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.3.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.3">𝐠</ci><apply id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.2">𝐱</ci><ci id="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.3.cmml" xref="S7.SS4.SSS0.Px2.p7.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p7.1.m1.1c">\mathbf{g}(\mathbf{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p7.1.m1.1d">bold_g ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> are explicitly given by:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p8">
<table class="ltx_equation ltx_eqn_table" id="S7.Ex41">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{g}(\mathbf{x}_{t})=\begin{bmatrix}\sigma(x_{2,t}-x_{1,t})\\
x_{1,t}(\rho-x_{3,t})-x_{2,t}\\
x_{1,t}x_{2,t}-\beta x_{3,t}\end{bmatrix}." class="ltx_Math" display="block" id="S7.Ex41.m1.2"><semantics id="S7.Ex41.m1.2a"><mrow id="S7.Ex41.m1.2.2.1" xref="S7.Ex41.m1.2.2.1.1.cmml"><mrow id="S7.Ex41.m1.2.2.1.1" xref="S7.Ex41.m1.2.2.1.1.cmml"><mrow id="S7.Ex41.m1.2.2.1.1.1" xref="S7.Ex41.m1.2.2.1.1.1.cmml"><mi id="S7.Ex41.m1.2.2.1.1.1.3" xref="S7.Ex41.m1.2.2.1.1.1.3.cmml">𝐠</mi><mo id="S7.Ex41.m1.2.2.1.1.1.2" xref="S7.Ex41.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S7.Ex41.m1.2.2.1.1.1.1.1" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S7.Ex41.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S7.Ex41.m1.2.2.1.1.1.1.1.1" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S7.Ex41.m1.2.2.1.1.1.1.1.1.2" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S7.Ex41.m1.2.2.1.1.1.1.1.1.3" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.Ex41.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex41.m1.2.2.1.1.2" xref="S7.Ex41.m1.2.2.1.1.2.cmml">=</mo><mrow id="S7.Ex41.m1.1.1.3" xref="S7.Ex41.m1.1.1.2.cmml"><mo id="S7.Ex41.m1.1.1.3.1" xref="S7.Ex41.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S7.Ex41.m1.1.1.1.1" rowspacing="0pt" xref="S7.Ex41.m1.1.1.1.1.cmml"><mtr id="S7.Ex41.m1.1.1.1.1a" xref="S7.Ex41.m1.1.1.1.1.cmml"><mtd id="S7.Ex41.m1.1.1.1.1b" xref="S7.Ex41.m1.1.1.1.1.cmml"><mrow id="S7.Ex41.m1.1.1.1.1.5.5.5.5" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.cmml"><mi id="S7.Ex41.m1.1.1.1.1.5.5.5.5.7" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.7.cmml">σ</mi><mo id="S7.Ex41.m1.1.1.1.1.5.5.5.5.6" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.6.cmml">⁢</mo><mrow id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.cmml"><mo id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.2" stretchy="false" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.cmml">(</mo><mrow id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.cmml"><msub id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.cmml"><mi id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.2" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex41.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">2</mn><mo id="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.4.1" xref="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.1" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.1.cmml">−</mo><msub id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.cmml"><mi id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.2" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.4" xref="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.3.3.3.3.3.1.1" xref="S7.Ex41.m1.1.1.1.1.3.3.3.3.3.1.1.cmml">1</mn><mo id="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.4.1" xref="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.2" xref="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.3" stretchy="false" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S7.Ex41.m1.1.1.1.1c" xref="S7.Ex41.m1.1.1.1.1.cmml"><mtd id="S7.Ex41.m1.1.1.1.1d" xref="S7.Ex41.m1.1.1.1.1.cmml"><mrow id="S7.Ex41.m1.1.1.1.1.12.12.7.7" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.cmml"><mrow id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.cmml"><msub id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.cmml"><mi id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.2" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.4" xref="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.6.6.1.1.1.1.1" xref="S7.Ex41.m1.1.1.1.1.6.6.1.1.1.1.1.cmml">1</mn><mo id="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.4.1" xref="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.2" xref="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.2" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.2.cmml">⁢</mo><mrow id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.cmml"><mo id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.2" stretchy="false" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.cmml">(</mo><mrow id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.cmml"><mi id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.2" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.2.cmml">ρ</mi><mo id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.1" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.1.cmml">−</mo><msub id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.cmml"><mi id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.2" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.4" xref="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.8.8.3.3.3.1.1" xref="S7.Ex41.m1.1.1.1.1.8.8.3.3.3.1.1.cmml">3</mn><mo id="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.4.1" xref="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.2" xref="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.3" stretchy="false" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.Ex41.m1.1.1.1.1.12.12.7.7.8" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.8.cmml">−</mo><msub id="S7.Ex41.m1.1.1.1.1.12.12.7.7.9" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.cmml"><mi id="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.2" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.4" xref="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.10.10.5.5.5.1.1" xref="S7.Ex41.m1.1.1.1.1.10.10.5.5.5.1.1.cmml">2</mn><mo id="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.4.1" xref="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.2" xref="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.2.cmml">t</mi></mrow></msub></mrow></mtd></mtr><mtr id="S7.Ex41.m1.1.1.1.1e" xref="S7.Ex41.m1.1.1.1.1.cmml"><mtd id="S7.Ex41.m1.1.1.1.1f" xref="S7.Ex41.m1.1.1.1.1.cmml"><mrow id="S7.Ex41.m1.1.1.1.1.18.18.6.6" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.cmml"><mrow id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.cmml"><msub id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.cmml"><mi id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.4" xref="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.13.13.1.1.1.1.1" xref="S7.Ex41.m1.1.1.1.1.13.13.1.1.1.1.1.cmml">1</mn><mo id="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.4.1" xref="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.2" xref="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.1" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.1.cmml">⁢</mo><msub id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.cmml"><mi id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.4" xref="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.15.15.3.3.3.1.1" xref="S7.Ex41.m1.1.1.1.1.15.15.3.3.3.1.1.cmml">2</mn><mo id="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.4.1" xref="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.2" xref="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S7.Ex41.m1.1.1.1.1.18.18.6.6.7" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.7.cmml">−</mo><mrow id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.cmml"><mi id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.2.cmml">β</mi><mo id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.1" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.1.cmml">⁢</mo><msub id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.cmml"><mi id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.2.cmml">x</mi><mrow id="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.4" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.3.cmml"><mn id="S7.Ex41.m1.1.1.1.1.17.17.5.5.5.1.1" xref="S7.Ex41.m1.1.1.1.1.17.17.5.5.5.1.1.cmml">3</mn><mo id="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.4.1" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.3.cmml">,</mo><mi id="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.2" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.2.cmml">t</mi></mrow></msub></mrow></mrow></mtd></mtr></mtable><mo id="S7.Ex41.m1.1.1.3.2" xref="S7.Ex41.m1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S7.Ex41.m1.2.2.1.2" lspace="0em" xref="S7.Ex41.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex41.m1.2b"><apply id="S7.Ex41.m1.2.2.1.1.cmml" xref="S7.Ex41.m1.2.2.1"><eq id="S7.Ex41.m1.2.2.1.1.2.cmml" xref="S7.Ex41.m1.2.2.1.1.2"></eq><apply id="S7.Ex41.m1.2.2.1.1.1.cmml" xref="S7.Ex41.m1.2.2.1.1.1"><times id="S7.Ex41.m1.2.2.1.1.1.2.cmml" xref="S7.Ex41.m1.2.2.1.1.1.2"></times><ci id="S7.Ex41.m1.2.2.1.1.1.3.cmml" xref="S7.Ex41.m1.2.2.1.1.1.3">𝐠</ci><apply id="S7.Ex41.m1.2.2.1.1.1.1.1.1.cmml" xref="S7.Ex41.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex41.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.Ex41.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex41.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.2">𝐱</ci><ci id="S7.Ex41.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S7.Ex41.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S7.Ex41.m1.1.1.2.cmml" xref="S7.Ex41.m1.1.1.3"><csymbol cd="latexml" id="S7.Ex41.m1.1.1.2.1.cmml" xref="S7.Ex41.m1.1.1.3.1">matrix</csymbol><matrix id="S7.Ex41.m1.1.1.1.1.cmml" xref="S7.Ex41.m1.1.1.1.1"><matrixrow id="S7.Ex41.m1.1.1.1.1a.cmml" xref="S7.Ex41.m1.1.1.1.1"><apply id="S7.Ex41.m1.1.1.1.1.5.5.5.5.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5"><times id="S7.Ex41.m1.1.1.1.1.5.5.5.5.6.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.6"></times><ci id="S7.Ex41.m1.1.1.1.1.5.5.5.5.7.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.7">𝜎</ci><apply id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1"><minus id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.1.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.1"></minus><apply id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.1.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.2.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.4"><cn id="S7.Ex41.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.1.1.1.1.1.1.1">2</cn><ci id="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.2.2.2.2.2.2.2">𝑡</ci></list></apply><apply id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.1.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.2.cmml" xref="S7.Ex41.m1.1.1.1.1.5.5.5.5.5.1.1.3.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.4"><cn id="S7.Ex41.m1.1.1.1.1.3.3.3.3.3.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.3.3.3.3.3.1.1">1</cn><ci id="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.4.4.4.4.4.2.2">𝑡</ci></list></apply></apply></apply></matrixrow><matrixrow id="S7.Ex41.m1.1.1.1.1b.cmml" xref="S7.Ex41.m1.1.1.1.1"><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7"><minus id="S7.Ex41.m1.1.1.1.1.12.12.7.7.8.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.8"></minus><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7"><times id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.2.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.2"></times><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.1.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.2.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.3.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.4"><cn id="S7.Ex41.m1.1.1.1.1.6.6.1.1.1.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.6.6.1.1.1.1.1">1</cn><ci id="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.7.7.2.2.2.2.2">𝑡</ci></list></apply><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1"><minus id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.1.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.1"></minus><ci id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.2.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.2">𝜌</ci><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.1.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.2.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.7.1.1.1.3.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.4"><cn id="S7.Ex41.m1.1.1.1.1.8.8.3.3.3.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.8.8.3.3.3.1.1">3</cn><ci id="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.9.9.4.4.4.2.2">𝑡</ci></list></apply></apply></apply><apply id="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.9"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.1.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.9">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.2.cmml" xref="S7.Ex41.m1.1.1.1.1.12.12.7.7.9.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.4"><cn id="S7.Ex41.m1.1.1.1.1.10.10.5.5.5.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.10.10.5.5.5.1.1">2</cn><ci id="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.11.11.6.6.6.2.2">𝑡</ci></list></apply></apply></matrixrow><matrixrow id="S7.Ex41.m1.1.1.1.1c.cmml" xref="S7.Ex41.m1.1.1.1.1"><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6"><minus id="S7.Ex41.m1.1.1.1.1.18.18.6.6.7.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.7"></minus><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8"><times id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.1.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.1"></times><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.1.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.2.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.4"><cn id="S7.Ex41.m1.1.1.1.1.13.13.1.1.1.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.13.13.1.1.1.1.1">1</cn><ci id="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.14.14.2.2.2.2.2">𝑡</ci></list></apply><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.1.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.8.3.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.4"><cn id="S7.Ex41.m1.1.1.1.1.15.15.3.3.3.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.15.15.3.3.3.1.1">2</cn><ci id="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.16.16.4.4.4.2.2">𝑡</ci></list></apply></apply><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9"><times id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.1.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.1"></times><ci id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.2">𝛽</ci><apply id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3"><csymbol cd="ambiguous" id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.1.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3">subscript</csymbol><ci id="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.9.3.2">𝑥</ci><list id="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.3.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.4"><cn id="S7.Ex41.m1.1.1.1.1.17.17.5.5.5.1.1.cmml" type="integer" xref="S7.Ex41.m1.1.1.1.1.17.17.5.5.5.1.1">3</cn><ci id="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.2.cmml" xref="S7.Ex41.m1.1.1.1.1.18.18.6.6.6.2.2">𝑡</ci></list></apply></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex41.m1.2c">\mathbf{g}(\mathbf{x}_{t})=\begin{bmatrix}\sigma(x_{2,t}-x_{1,t})\\
x_{1,t}(\rho-x_{3,t})-x_{2,t}\\
x_{1,t}x_{2,t}-\beta x_{3,t}\end{bmatrix}.</annotation><annotation encoding="application/x-llamapun" id="S7.Ex41.m1.2d">bold_g ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = [ start_ARG start_ROW start_CELL italic_σ ( italic_x start_POSTSUBSCRIPT 2 , italic_t end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT 1 , italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 , italic_t end_POSTSUBSCRIPT ( italic_ρ - italic_x start_POSTSUBSCRIPT 3 , italic_t end_POSTSUBSCRIPT ) - italic_x start_POSTSUBSCRIPT 2 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT 1 , italic_t end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 2 , italic_t end_POSTSUBSCRIPT - italic_β italic_x start_POSTSUBSCRIPT 3 , italic_t end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p9">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p9.1">The parameters used for the Lorenz simulation are:</p>
<ul class="ltx_itemize" id="S7.I8">
<li class="ltx_item" id="S7.I8.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i1.p1">
<p class="ltx_p" id="S7.I8.i1.p1.1"><math alttext="\sigma=10.0" class="ltx_Math" display="inline" id="S7.I8.i1.p1.1.m1.1"><semantics id="S7.I8.i1.p1.1.m1.1a"><mrow id="S7.I8.i1.p1.1.m1.1.1" xref="S7.I8.i1.p1.1.m1.1.1.cmml"><mi id="S7.I8.i1.p1.1.m1.1.1.2" xref="S7.I8.i1.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S7.I8.i1.p1.1.m1.1.1.1" xref="S7.I8.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I8.i1.p1.1.m1.1.1.3" xref="S7.I8.i1.p1.1.m1.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i1.p1.1.m1.1b"><apply id="S7.I8.i1.p1.1.m1.1.1.cmml" xref="S7.I8.i1.p1.1.m1.1.1"><eq id="S7.I8.i1.p1.1.m1.1.1.1.cmml" xref="S7.I8.i1.p1.1.m1.1.1.1"></eq><ci id="S7.I8.i1.p1.1.m1.1.1.2.cmml" xref="S7.I8.i1.p1.1.m1.1.1.2">𝜎</ci><cn id="S7.I8.i1.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I8.i1.p1.1.m1.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i1.p1.1.m1.1c">\sigma=10.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i1.p1.1.m1.1d">italic_σ = 10.0</annotation></semantics></math> (Prandtl number),</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i2.p1">
<p class="ltx_p" id="S7.I8.i2.p1.1"><math alttext="\rho=28.0" class="ltx_Math" display="inline" id="S7.I8.i2.p1.1.m1.1"><semantics id="S7.I8.i2.p1.1.m1.1a"><mrow id="S7.I8.i2.p1.1.m1.1.1" xref="S7.I8.i2.p1.1.m1.1.1.cmml"><mi id="S7.I8.i2.p1.1.m1.1.1.2" xref="S7.I8.i2.p1.1.m1.1.1.2.cmml">ρ</mi><mo id="S7.I8.i2.p1.1.m1.1.1.1" xref="S7.I8.i2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I8.i2.p1.1.m1.1.1.3" xref="S7.I8.i2.p1.1.m1.1.1.3.cmml">28.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i2.p1.1.m1.1b"><apply id="S7.I8.i2.p1.1.m1.1.1.cmml" xref="S7.I8.i2.p1.1.m1.1.1"><eq id="S7.I8.i2.p1.1.m1.1.1.1.cmml" xref="S7.I8.i2.p1.1.m1.1.1.1"></eq><ci id="S7.I8.i2.p1.1.m1.1.1.2.cmml" xref="S7.I8.i2.p1.1.m1.1.1.2">𝜌</ci><cn id="S7.I8.i2.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I8.i2.p1.1.m1.1.1.3">28.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i2.p1.1.m1.1c">\rho=28.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i2.p1.1.m1.1d">italic_ρ = 28.0</annotation></semantics></math> (Rayleigh number),</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i3.p1">
<p class="ltx_p" id="S7.I8.i3.p1.1"><math alttext="\beta=\frac{8}{3}" class="ltx_Math" display="inline" id="S7.I8.i3.p1.1.m1.1"><semantics id="S7.I8.i3.p1.1.m1.1a"><mrow id="S7.I8.i3.p1.1.m1.1.1" xref="S7.I8.i3.p1.1.m1.1.1.cmml"><mi id="S7.I8.i3.p1.1.m1.1.1.2" xref="S7.I8.i3.p1.1.m1.1.1.2.cmml">β</mi><mo id="S7.I8.i3.p1.1.m1.1.1.1" xref="S7.I8.i3.p1.1.m1.1.1.1.cmml">=</mo><mfrac id="S7.I8.i3.p1.1.m1.1.1.3" xref="S7.I8.i3.p1.1.m1.1.1.3.cmml"><mn id="S7.I8.i3.p1.1.m1.1.1.3.2" xref="S7.I8.i3.p1.1.m1.1.1.3.2.cmml">8</mn><mn id="S7.I8.i3.p1.1.m1.1.1.3.3" xref="S7.I8.i3.p1.1.m1.1.1.3.3.cmml">3</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i3.p1.1.m1.1b"><apply id="S7.I8.i3.p1.1.m1.1.1.cmml" xref="S7.I8.i3.p1.1.m1.1.1"><eq id="S7.I8.i3.p1.1.m1.1.1.1.cmml" xref="S7.I8.i3.p1.1.m1.1.1.1"></eq><ci id="S7.I8.i3.p1.1.m1.1.1.2.cmml" xref="S7.I8.i3.p1.1.m1.1.1.2">𝛽</ci><apply id="S7.I8.i3.p1.1.m1.1.1.3.cmml" xref="S7.I8.i3.p1.1.m1.1.1.3"><divide id="S7.I8.i3.p1.1.m1.1.1.3.1.cmml" xref="S7.I8.i3.p1.1.m1.1.1.3"></divide><cn id="S7.I8.i3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S7.I8.i3.p1.1.m1.1.1.3.2">8</cn><cn id="S7.I8.i3.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S7.I8.i3.p1.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i3.p1.1.m1.1c">\beta=\frac{8}{3}</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i3.p1.1.m1.1d">italic_β = divide start_ARG 8 end_ARG start_ARG 3 end_ARG</annotation></semantics></math> (geometric factor),</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i4.p1">
<p class="ltx_p" id="S7.I8.i4.p1.1">Time step: <math alttext="dt=0.01" class="ltx_Math" display="inline" id="S7.I8.i4.p1.1.m1.1"><semantics id="S7.I8.i4.p1.1.m1.1a"><mrow id="S7.I8.i4.p1.1.m1.1.1" xref="S7.I8.i4.p1.1.m1.1.1.cmml"><mrow id="S7.I8.i4.p1.1.m1.1.1.2" xref="S7.I8.i4.p1.1.m1.1.1.2.cmml"><mi id="S7.I8.i4.p1.1.m1.1.1.2.2" xref="S7.I8.i4.p1.1.m1.1.1.2.2.cmml">d</mi><mo id="S7.I8.i4.p1.1.m1.1.1.2.1" xref="S7.I8.i4.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.I8.i4.p1.1.m1.1.1.2.3" xref="S7.I8.i4.p1.1.m1.1.1.2.3.cmml">t</mi></mrow><mo id="S7.I8.i4.p1.1.m1.1.1.1" xref="S7.I8.i4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I8.i4.p1.1.m1.1.1.3" xref="S7.I8.i4.p1.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i4.p1.1.m1.1b"><apply id="S7.I8.i4.p1.1.m1.1.1.cmml" xref="S7.I8.i4.p1.1.m1.1.1"><eq id="S7.I8.i4.p1.1.m1.1.1.1.cmml" xref="S7.I8.i4.p1.1.m1.1.1.1"></eq><apply id="S7.I8.i4.p1.1.m1.1.1.2.cmml" xref="S7.I8.i4.p1.1.m1.1.1.2"><times id="S7.I8.i4.p1.1.m1.1.1.2.1.cmml" xref="S7.I8.i4.p1.1.m1.1.1.2.1"></times><ci id="S7.I8.i4.p1.1.m1.1.1.2.2.cmml" xref="S7.I8.i4.p1.1.m1.1.1.2.2">𝑑</ci><ci id="S7.I8.i4.p1.1.m1.1.1.2.3.cmml" xref="S7.I8.i4.p1.1.m1.1.1.2.3">𝑡</ci></apply><cn id="S7.I8.i4.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I8.i4.p1.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i4.p1.1.m1.1c">dt=0.01</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i4.p1.1.m1.1d">italic_d italic_t = 0.01</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i5.p1">
<p class="ltx_p" id="S7.I8.i5.p1.1">Total simulation time: <math alttext="T=20.0" class="ltx_Math" display="inline" id="S7.I8.i5.p1.1.m1.1"><semantics id="S7.I8.i5.p1.1.m1.1a"><mrow id="S7.I8.i5.p1.1.m1.1.1" xref="S7.I8.i5.p1.1.m1.1.1.cmml"><mi id="S7.I8.i5.p1.1.m1.1.1.2" xref="S7.I8.i5.p1.1.m1.1.1.2.cmml">T</mi><mo id="S7.I8.i5.p1.1.m1.1.1.1" xref="S7.I8.i5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I8.i5.p1.1.m1.1.1.3" xref="S7.I8.i5.p1.1.m1.1.1.3.cmml">20.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i5.p1.1.m1.1b"><apply id="S7.I8.i5.p1.1.m1.1.1.cmml" xref="S7.I8.i5.p1.1.m1.1.1"><eq id="S7.I8.i5.p1.1.m1.1.1.1.cmml" xref="S7.I8.i5.p1.1.m1.1.1.1"></eq><ci id="S7.I8.i5.p1.1.m1.1.1.2.cmml" xref="S7.I8.i5.p1.1.m1.1.1.2">𝑇</ci><cn id="S7.I8.i5.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I8.i5.p1.1.m1.1.1.3">20.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i5.p1.1.m1.1c">T=20.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i5.p1.1.m1.1d">italic_T = 20.0</annotation></semantics></math> seconds,</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i6.p1">
<p class="ltx_p" id="S7.I8.i6.p1.3">Initial conditions: <math alttext="x_{1}(0)=1.0" class="ltx_Math" display="inline" id="S7.I8.i6.p1.1.m1.1"><semantics id="S7.I8.i6.p1.1.m1.1a"><mrow id="S7.I8.i6.p1.1.m1.1.2" xref="S7.I8.i6.p1.1.m1.1.2.cmml"><mrow id="S7.I8.i6.p1.1.m1.1.2.2" xref="S7.I8.i6.p1.1.m1.1.2.2.cmml"><msub id="S7.I8.i6.p1.1.m1.1.2.2.2" xref="S7.I8.i6.p1.1.m1.1.2.2.2.cmml"><mi id="S7.I8.i6.p1.1.m1.1.2.2.2.2" xref="S7.I8.i6.p1.1.m1.1.2.2.2.2.cmml">x</mi><mn id="S7.I8.i6.p1.1.m1.1.2.2.2.3" xref="S7.I8.i6.p1.1.m1.1.2.2.2.3.cmml">1</mn></msub><mo id="S7.I8.i6.p1.1.m1.1.2.2.1" xref="S7.I8.i6.p1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S7.I8.i6.p1.1.m1.1.2.2.3.2" xref="S7.I8.i6.p1.1.m1.1.2.2.cmml"><mo id="S7.I8.i6.p1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S7.I8.i6.p1.1.m1.1.2.2.cmml">(</mo><mn id="S7.I8.i6.p1.1.m1.1.1" xref="S7.I8.i6.p1.1.m1.1.1.cmml">0</mn><mo id="S7.I8.i6.p1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S7.I8.i6.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.I8.i6.p1.1.m1.1.2.1" xref="S7.I8.i6.p1.1.m1.1.2.1.cmml">=</mo><mn id="S7.I8.i6.p1.1.m1.1.2.3" xref="S7.I8.i6.p1.1.m1.1.2.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i6.p1.1.m1.1b"><apply id="S7.I8.i6.p1.1.m1.1.2.cmml" xref="S7.I8.i6.p1.1.m1.1.2"><eq id="S7.I8.i6.p1.1.m1.1.2.1.cmml" xref="S7.I8.i6.p1.1.m1.1.2.1"></eq><apply id="S7.I8.i6.p1.1.m1.1.2.2.cmml" xref="S7.I8.i6.p1.1.m1.1.2.2"><times id="S7.I8.i6.p1.1.m1.1.2.2.1.cmml" xref="S7.I8.i6.p1.1.m1.1.2.2.1"></times><apply id="S7.I8.i6.p1.1.m1.1.2.2.2.cmml" xref="S7.I8.i6.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S7.I8.i6.p1.1.m1.1.2.2.2.1.cmml" xref="S7.I8.i6.p1.1.m1.1.2.2.2">subscript</csymbol><ci id="S7.I8.i6.p1.1.m1.1.2.2.2.2.cmml" xref="S7.I8.i6.p1.1.m1.1.2.2.2.2">𝑥</ci><cn id="S7.I8.i6.p1.1.m1.1.2.2.2.3.cmml" type="integer" xref="S7.I8.i6.p1.1.m1.1.2.2.2.3">1</cn></apply><cn id="S7.I8.i6.p1.1.m1.1.1.cmml" type="integer" xref="S7.I8.i6.p1.1.m1.1.1">0</cn></apply><cn id="S7.I8.i6.p1.1.m1.1.2.3.cmml" type="float" xref="S7.I8.i6.p1.1.m1.1.2.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i6.p1.1.m1.1c">x_{1}(0)=1.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i6.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( 0 ) = 1.0</annotation></semantics></math>, <math alttext="x_{2}(0)=1.0" class="ltx_Math" display="inline" id="S7.I8.i6.p1.2.m2.1"><semantics id="S7.I8.i6.p1.2.m2.1a"><mrow id="S7.I8.i6.p1.2.m2.1.2" xref="S7.I8.i6.p1.2.m2.1.2.cmml"><mrow id="S7.I8.i6.p1.2.m2.1.2.2" xref="S7.I8.i6.p1.2.m2.1.2.2.cmml"><msub id="S7.I8.i6.p1.2.m2.1.2.2.2" xref="S7.I8.i6.p1.2.m2.1.2.2.2.cmml"><mi id="S7.I8.i6.p1.2.m2.1.2.2.2.2" xref="S7.I8.i6.p1.2.m2.1.2.2.2.2.cmml">x</mi><mn id="S7.I8.i6.p1.2.m2.1.2.2.2.3" xref="S7.I8.i6.p1.2.m2.1.2.2.2.3.cmml">2</mn></msub><mo id="S7.I8.i6.p1.2.m2.1.2.2.1" xref="S7.I8.i6.p1.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S7.I8.i6.p1.2.m2.1.2.2.3.2" xref="S7.I8.i6.p1.2.m2.1.2.2.cmml"><mo id="S7.I8.i6.p1.2.m2.1.2.2.3.2.1" stretchy="false" xref="S7.I8.i6.p1.2.m2.1.2.2.cmml">(</mo><mn id="S7.I8.i6.p1.2.m2.1.1" xref="S7.I8.i6.p1.2.m2.1.1.cmml">0</mn><mo id="S7.I8.i6.p1.2.m2.1.2.2.3.2.2" stretchy="false" xref="S7.I8.i6.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.I8.i6.p1.2.m2.1.2.1" xref="S7.I8.i6.p1.2.m2.1.2.1.cmml">=</mo><mn id="S7.I8.i6.p1.2.m2.1.2.3" xref="S7.I8.i6.p1.2.m2.1.2.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i6.p1.2.m2.1b"><apply id="S7.I8.i6.p1.2.m2.1.2.cmml" xref="S7.I8.i6.p1.2.m2.1.2"><eq id="S7.I8.i6.p1.2.m2.1.2.1.cmml" xref="S7.I8.i6.p1.2.m2.1.2.1"></eq><apply id="S7.I8.i6.p1.2.m2.1.2.2.cmml" xref="S7.I8.i6.p1.2.m2.1.2.2"><times id="S7.I8.i6.p1.2.m2.1.2.2.1.cmml" xref="S7.I8.i6.p1.2.m2.1.2.2.1"></times><apply id="S7.I8.i6.p1.2.m2.1.2.2.2.cmml" xref="S7.I8.i6.p1.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S7.I8.i6.p1.2.m2.1.2.2.2.1.cmml" xref="S7.I8.i6.p1.2.m2.1.2.2.2">subscript</csymbol><ci id="S7.I8.i6.p1.2.m2.1.2.2.2.2.cmml" xref="S7.I8.i6.p1.2.m2.1.2.2.2.2">𝑥</ci><cn id="S7.I8.i6.p1.2.m2.1.2.2.2.3.cmml" type="integer" xref="S7.I8.i6.p1.2.m2.1.2.2.2.3">2</cn></apply><cn id="S7.I8.i6.p1.2.m2.1.1.cmml" type="integer" xref="S7.I8.i6.p1.2.m2.1.1">0</cn></apply><cn id="S7.I8.i6.p1.2.m2.1.2.3.cmml" type="float" xref="S7.I8.i6.p1.2.m2.1.2.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i6.p1.2.m2.1c">x_{2}(0)=1.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i6.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( 0 ) = 1.0</annotation></semantics></math>, <math alttext="x_{3}(0)=1.0" class="ltx_Math" display="inline" id="S7.I8.i6.p1.3.m3.1"><semantics id="S7.I8.i6.p1.3.m3.1a"><mrow id="S7.I8.i6.p1.3.m3.1.2" xref="S7.I8.i6.p1.3.m3.1.2.cmml"><mrow id="S7.I8.i6.p1.3.m3.1.2.2" xref="S7.I8.i6.p1.3.m3.1.2.2.cmml"><msub id="S7.I8.i6.p1.3.m3.1.2.2.2" xref="S7.I8.i6.p1.3.m3.1.2.2.2.cmml"><mi id="S7.I8.i6.p1.3.m3.1.2.2.2.2" xref="S7.I8.i6.p1.3.m3.1.2.2.2.2.cmml">x</mi><mn id="S7.I8.i6.p1.3.m3.1.2.2.2.3" xref="S7.I8.i6.p1.3.m3.1.2.2.2.3.cmml">3</mn></msub><mo id="S7.I8.i6.p1.3.m3.1.2.2.1" xref="S7.I8.i6.p1.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S7.I8.i6.p1.3.m3.1.2.2.3.2" xref="S7.I8.i6.p1.3.m3.1.2.2.cmml"><mo id="S7.I8.i6.p1.3.m3.1.2.2.3.2.1" stretchy="false" xref="S7.I8.i6.p1.3.m3.1.2.2.cmml">(</mo><mn id="S7.I8.i6.p1.3.m3.1.1" xref="S7.I8.i6.p1.3.m3.1.1.cmml">0</mn><mo id="S7.I8.i6.p1.3.m3.1.2.2.3.2.2" stretchy="false" xref="S7.I8.i6.p1.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.I8.i6.p1.3.m3.1.2.1" xref="S7.I8.i6.p1.3.m3.1.2.1.cmml">=</mo><mn id="S7.I8.i6.p1.3.m3.1.2.3" xref="S7.I8.i6.p1.3.m3.1.2.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i6.p1.3.m3.1b"><apply id="S7.I8.i6.p1.3.m3.1.2.cmml" xref="S7.I8.i6.p1.3.m3.1.2"><eq id="S7.I8.i6.p1.3.m3.1.2.1.cmml" xref="S7.I8.i6.p1.3.m3.1.2.1"></eq><apply id="S7.I8.i6.p1.3.m3.1.2.2.cmml" xref="S7.I8.i6.p1.3.m3.1.2.2"><times id="S7.I8.i6.p1.3.m3.1.2.2.1.cmml" xref="S7.I8.i6.p1.3.m3.1.2.2.1"></times><apply id="S7.I8.i6.p1.3.m3.1.2.2.2.cmml" xref="S7.I8.i6.p1.3.m3.1.2.2.2"><csymbol cd="ambiguous" id="S7.I8.i6.p1.3.m3.1.2.2.2.1.cmml" xref="S7.I8.i6.p1.3.m3.1.2.2.2">subscript</csymbol><ci id="S7.I8.i6.p1.3.m3.1.2.2.2.2.cmml" xref="S7.I8.i6.p1.3.m3.1.2.2.2.2">𝑥</ci><cn id="S7.I8.i6.p1.3.m3.1.2.2.2.3.cmml" type="integer" xref="S7.I8.i6.p1.3.m3.1.2.2.2.3">3</cn></apply><cn id="S7.I8.i6.p1.3.m3.1.1.cmml" type="integer" xref="S7.I8.i6.p1.3.m3.1.1">0</cn></apply><cn id="S7.I8.i6.p1.3.m3.1.2.3.cmml" type="float" xref="S7.I8.i6.p1.3.m3.1.2.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i6.p1.3.m3.1c">x_{3}(0)=1.0</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i6.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( 0 ) = 1.0</annotation></semantics></math>,</p>
</div>
</li>
<li class="ltx_item" id="S7.I8.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I8.i7.p1">
<p class="ltx_p" id="S7.I8.i7.p1.1">Noise standard deviation: <math alttext="\sigma=0.5" class="ltx_Math" display="inline" id="S7.I8.i7.p1.1.m1.1"><semantics id="S7.I8.i7.p1.1.m1.1a"><mrow id="S7.I8.i7.p1.1.m1.1.1" xref="S7.I8.i7.p1.1.m1.1.1.cmml"><mi id="S7.I8.i7.p1.1.m1.1.1.2" xref="S7.I8.i7.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S7.I8.i7.p1.1.m1.1.1.1" xref="S7.I8.i7.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.I8.i7.p1.1.m1.1.1.3" xref="S7.I8.i7.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.I8.i7.p1.1.m1.1b"><apply id="S7.I8.i7.p1.1.m1.1.1.cmml" xref="S7.I8.i7.p1.1.m1.1.1"><eq id="S7.I8.i7.p1.1.m1.1.1.1.cmml" xref="S7.I8.i7.p1.1.m1.1.1.1"></eq><ci id="S7.I8.i7.p1.1.m1.1.1.2.cmml" xref="S7.I8.i7.p1.1.m1.1.1.2">𝜎</ci><cn id="S7.I8.i7.p1.1.m1.1.1.3.cmml" type="float" xref="S7.I8.i7.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I8.i7.p1.1.m1.1c">\sigma=0.5</annotation><annotation encoding="application/x-llamapun" id="S7.I8.i7.p1.1.m1.1d">italic_σ = 0.5</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p10">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p10.1">The system is discretized into <math alttext="N=\frac{T}{dt}=2000" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p10.1.m1.1"><semantics id="S7.SS4.SSS0.Px2.p10.1.m1.1a"><mrow id="S7.SS4.SSS0.Px2.p10.1.m1.1.1" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.2" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.2.cmml">N</mi><mo id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.3" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.3.cmml">=</mo><mfrac id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.cmml"><mi id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.2" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.2.cmml">T</mi><mrow id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.cmml"><mi id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.2" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.2.cmml">d</mi><mo id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.1" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.1.cmml">⁢</mo><mi id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.3" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.3.cmml">t</mi></mrow></mfrac><mo id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.5" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.5.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.6" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.6.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p10.1.m1.1b"><apply id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1"><and id="S7.SS4.SSS0.Px2.p10.1.m1.1.1a.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1"></and><apply id="S7.SS4.SSS0.Px2.p10.1.m1.1.1b.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1"><eq id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.3.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.3"></eq><ci id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.2">𝑁</ci><apply id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4"><divide id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.1.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4"></divide><ci id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.2.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.2">𝑇</ci><apply id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3"><times id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.1.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.1"></times><ci id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.2.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.2">𝑑</ci><ci id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.3.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.3.3">𝑡</ci></apply></apply></apply><apply id="S7.SS4.SSS0.Px2.p10.1.m1.1.1c.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1"><eq id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.5.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2505.20048v1#S7.SS4.SSS0.Px2.p10.1.m1.1.1.4.cmml" id="S7.SS4.SSS0.Px2.p10.1.m1.1.1d.cmml" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1"></share><cn id="S7.SS4.SSS0.Px2.p10.1.m1.1.1.6.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p10.1.m1.1.1.6">2000</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p10.1.m1.1c">N=\frac{T}{dt}=2000</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p10.1.m1.1d">italic_N = divide start_ARG italic_T end_ARG start_ARG italic_d italic_t end_ARG = 2000</annotation></semantics></math> time steps. The noisy trajectory is simulated by applying the above update equations iteratively with Gaussian noise added at each step to reflect random perturbations in the system.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p11">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p11.12">The training of the Deep Koopformer <span class="ltx_text ltx_font_typewriter" id="S7.SS4.SSS0.Px2.p11.12.1">PatchTST</span> Minimal backbone was conducted using patch length <math alttext="200" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.1.m1.1"><semantics id="S7.SS4.SSS0.Px2.p11.1.m1.1a"><mn id="S7.SS4.SSS0.Px2.p11.1.m1.1.1" xref="S7.SS4.SSS0.Px2.p11.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.1.m1.1b"><cn id="S7.SS4.SSS0.Px2.p11.1.m1.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.1.m1.1c">200</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.1.m1.1d">200</annotation></semantics></math>, with horizon of <math alttext="H=5" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.2.m2.1"><semantics id="S7.SS4.SSS0.Px2.p11.2.m2.1a"><mrow id="S7.SS4.SSS0.Px2.p11.2.m2.1.1" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.2" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.2.cmml">H</mi><mo id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.1" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.3" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.2.m2.1b"><apply id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1"><eq id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.1"></eq><ci id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.2">𝐻</ci><cn id="S7.SS4.SSS0.Px2.p11.2.m2.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.2.m2.1c">H=5</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.2.m2.1d">italic_H = 5</annotation></semantics></math> future time steps. The target outputs consist of <math alttext="15" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.3.m3.1"><semantics id="S7.SS4.SSS0.Px2.p11.3.m3.1a"><mn id="S7.SS4.SSS0.Px2.p11.3.m3.1.1" xref="S7.SS4.SSS0.Px2.p11.3.m3.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.3.m3.1b"><cn id="S7.SS4.SSS0.Px2.p11.3.m3.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.3.m3.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.3.m3.1c">15</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.3.m3.1d">15</annotation></semantics></math> variables, corresponding to the predicted values of the system’s three state variables (<math alttext="x_{1}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.4.m4.1"><semantics id="S7.SS4.SSS0.Px2.p11.4.m4.1a"><msub id="S7.SS4.SSS0.Px2.p11.4.m4.1.1" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.2" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.3" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.4.m4.1b"><apply id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p11.4.m4.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.4.m4.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.4.m4.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x_{2}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.5.m5.1"><semantics id="S7.SS4.SSS0.Px2.p11.5.m5.1a"><msub id="S7.SS4.SSS0.Px2.p11.5.m5.1.1" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.2" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.3" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.5.m5.1b"><apply id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p11.5.m5.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.5.m5.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.5.m5.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x_{3}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.6.m6.1"><semantics id="S7.SS4.SSS0.Px2.p11.6.m6.1a"><msub id="S7.SS4.SSS0.Px2.p11.6.m6.1.1" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.2" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.3" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.6.m6.1b"><apply id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p11.6.m6.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.6.m6.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.6.m6.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>) over the forecast horizon. The models were trained with a consistent set of hyperparameters: the latent dimension <math alttext="d_{\text{model}}=16" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.7.m7.1"><semantics id="S7.SS4.SSS0.Px2.p11.7.m7.1a"><mrow id="S7.SS4.SSS0.Px2.p11.7.m7.1.1" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.cmml"><msub id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.cmml"><mi id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.2" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.2.cmml">d</mi><mtext id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3a.cmml">model</mtext></msub><mo id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.1" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.3" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.7.m7.1b"><apply id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1"><eq id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.1"></eq><apply id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.1.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.2.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.2">𝑑</ci><ci id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3a.cmml" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3"><mtext id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3.cmml" mathsize="70%" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.2.3">model</mtext></ci></apply><cn id="S7.SS4.SSS0.Px2.p11.7.m7.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.7.m7.1c">d_{\text{model}}=16</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.7.m7.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT = 16</annotation></semantics></math>, <math alttext="2" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.8.m8.1"><semantics id="S7.SS4.SSS0.Px2.p11.8.m8.1a"><mn id="S7.SS4.SSS0.Px2.p11.8.m8.1.1" xref="S7.SS4.SSS0.Px2.p11.8.m8.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.8.m8.1b"><cn id="S7.SS4.SSS0.Px2.p11.8.m8.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.8.m8.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.8.m8.1c">2</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.8.m8.1d">2</annotation></semantics></math> attention heads, a feed-forward dimension of <math alttext="64" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.9.m9.1"><semantics id="S7.SS4.SSS0.Px2.p11.9.m9.1a"><mn id="S7.SS4.SSS0.Px2.p11.9.m9.1.1" xref="S7.SS4.SSS0.Px2.p11.9.m9.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.9.m9.1b"><cn id="S7.SS4.SSS0.Px2.p11.9.m9.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.9.m9.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.9.m9.1c">64</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.9.m9.1d">64</annotation></semantics></math>, and <math alttext="2" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.10.m10.1"><semantics id="S7.SS4.SSS0.Px2.p11.10.m10.1a"><mn id="S7.SS4.SSS0.Px2.p11.10.m10.1.1" xref="S7.SS4.SSS0.Px2.p11.10.m10.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.10.m10.1b"><cn id="S7.SS4.SSS0.Px2.p11.10.m10.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.10.m10.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.10.m10.1c">2</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.10.m10.1d">2</annotation></semantics></math> encoder layers. The Adam optimizer with a learning rate of <math alttext="0.001" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.11.m11.1"><semantics id="S7.SS4.SSS0.Px2.p11.11.m11.1a"><mn id="S7.SS4.SSS0.Px2.p11.11.m11.1.1" xref="S7.SS4.SSS0.Px2.p11.11.m11.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.11.m11.1b"><cn id="S7.SS4.SSS0.Px2.p11.11.m11.1.1.cmml" type="float" xref="S7.SS4.SSS0.Px2.p11.11.m11.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.11.m11.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.11.m11.1d">0.001</annotation></semantics></math> was used for optimization, while the loss function was a combination of MSE and a stability penalty term based on the Lyapunov criterion. The model was trained for a total of <math alttext="3000" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p11.12.m12.1"><semantics id="S7.SS4.SSS0.Px2.p11.12.m12.1a"><mn id="S7.SS4.SSS0.Px2.p11.12.m12.1.1" xref="S7.SS4.SSS0.Px2.p11.12.m12.1.1.cmml">3000</mn><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p11.12.m12.1b"><cn id="S7.SS4.SSS0.Px2.p11.12.m12.1.1.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p11.12.m12.1.1">3000</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p11.12.m12.1c">3000</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p11.12.m12.1d">3000</annotation></semantics></math> epochs to ensure thorough learning of the temporal dynamics.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p12">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p12.6">The results shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F9" title="Figure 9 ‣ Lorenz System ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">9</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F10" title="Figure 10 ‣ Lorenz System ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">10</span></a> highlight the performance of the Deep Koopformer with <span class="ltx_text ltx_font_typewriter" id="S7.SS4.SSS0.Px2.p12.6.1">PatchTST</span> Minimal backbone in predicting the dynamics of the Lorenz system. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F9" title="Figure 9 ‣ Lorenz System ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">9</span></a>, the model effectively captures the oscillatory behavior of all three state variables (<math alttext="x_{1}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.1.m1.1"><semantics id="S7.SS4.SSS0.Px2.p12.1.m1.1a"><msub id="S7.SS4.SSS0.Px2.p12.1.m1.1.1" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.2" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.3" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.1.m1.1b"><apply id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.1.m1.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.1.m1.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x_{2}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.2.m2.1"><semantics id="S7.SS4.SSS0.Px2.p12.2.m2.1a"><msub id="S7.SS4.SSS0.Px2.p12.2.m2.1.1" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.2" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.3" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.2.m2.1b"><apply id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.2.m2.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.2.m2.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.2.m2.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="x_{3}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.3.m3.1"><semantics id="S7.SS4.SSS0.Px2.p12.3.m3.1a"><msub id="S7.SS4.SSS0.Px2.p12.3.m3.1.1" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.2" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.3" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.3.m3.1b"><apply id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.3.m3.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.3.m3.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.3.m3.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>), with predicted values closely following the true values across the entire time series. The blue lines represent the true values, while the orange dashed lines represent the predicted values. The prediction results for <math alttext="x_{1}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.4.m4.1"><semantics id="S7.SS4.SSS0.Px2.p12.4.m4.1a"><msub id="S7.SS4.SSS0.Px2.p12.4.m4.1.1" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.2" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.3" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.4.m4.1b"><apply id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.4.m4.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.4.m4.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.4.m4.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x_{2}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.5.m5.1"><semantics id="S7.SS4.SSS0.Px2.p12.5.m5.1a"><msub id="S7.SS4.SSS0.Px2.p12.5.m5.1.1" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.2" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.3" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.5.m5.1b"><apply id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.5.m5.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.5.m5.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.5.m5.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="x_{3}" class="ltx_Math" display="inline" id="S7.SS4.SSS0.Px2.p12.6.m6.1"><semantics id="S7.SS4.SSS0.Px2.p12.6.m6.1a"><msub id="S7.SS4.SSS0.Px2.p12.6.m6.1.1" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.2" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1.2.cmml">x</mi><mn id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.3" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS0.Px2.p12.6.m6.1b"><apply id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1"><csymbol cd="ambiguous" id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.1.cmml" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1">subscript</csymbol><ci id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.2.cmml" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1.2">𝑥</ci><cn id="S7.SS4.SSS0.Px2.p12.6.m6.1.1.3.cmml" type="integer" xref="S7.SS4.SSS0.Px2.p12.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS0.Px2.p12.6.m6.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS0.Px2.p12.6.m6.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> demonstrate the model’s capability to replicate the nonlinear dynamics of the system.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS0.Px2.p13">
<p class="ltx_p" id="S7.SS4.SSS0.Px2.p13.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20048v1#S7.F10" title="Figure 10 ‣ Lorenz System ‣ 7.4 Application to Noisy Dynamical Systems ‣ 7 Outlook: Toward Koopman-Enhanced Transformer Architectures ‣ Synthetic Time Series Forecasting with Transformer Architectures: Extensive Simulation Benchmarks"><span class="ltx_text ltx_ref_tag">10</span></a>, the evolution of the Koopman operator’s spectral radius is plotted over the course of training. The plot indicates that the model achieves stability in the latent space as the training progresses, with the maximum eigenvalue gradually increasing and stabilizing after the initial training steps. This stability is crucial for ensuring the model’s robustness in long-term forecasting, confirming that the Koopman operator enforces stable latent dynamics throughout the training process.</p>
</div>
<figure class="ltx_figure" id="S7.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="657" id="S7.F9.g1" src="x10.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F9.3.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S7.F9.4.2" style="font-size:90%;">Deep Koopformer <span class="ltx_text ltx_font_typewriter" id="S7.F9.4.2.1">PatchTST</span>prediction on Lorenz Dynamical System</span></figcaption>
</figure>
<figure class="ltx_figure" id="S7.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="S7.F10.g1" src="x11.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F10.3.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="S7.F10.4.2" style="font-size:90%;">Deep Koopman Operator Stability Evolution with <span class="ltx_text ltx_font_typewriter" id="S7.F10.4.2.1">PatchTST</span> backbone during the training loop</span></figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">This study presents a unified empirical investigation of Transformer-based model families for univariate time series forecasting under both clean and noisy signal conditions. We benchmark three prominent architectures—<span class="ltx_text ltx_font_typewriter" id="S8.p1.1.1">Autoformer</span>, <span class="ltx_text ltx_font_typewriter" id="S8.p1.1.2">Informer</span>, and <span class="ltx_text ltx_font_typewriter" id="S8.p1.1.3">PatchTST</span> —each implemented in three variants: <span class="ltx_text ltx_font_italic" id="S8.p1.1.4">Minimal</span>, <span class="ltx_text ltx_font_italic" id="S8.p1.1.5">Standard</span>, and <span class="ltx_text ltx_font_italic" id="S8.p1.1.6">Full</span>, representing increasing levels of architectural complexity.</p>
</div>
<div class="ltx_para" id="S8.p2">
<p class="ltx_p" id="S8.p2.1">Across 10 synthetic signals and 5<math alttext="\times" class="ltx_Math" display="inline" id="S8.p2.1.m1.1"><semantics id="S8.p2.1.m1.1a"><mo id="S8.p2.1.m1.1.1" xref="S8.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S8.p2.1.m1.1b"><times id="S8.p2.1.m1.1.1.cmml" xref="S8.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S8.p2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S8.p2.1.m1.1d">×</annotation></semantics></math>5 configurations of patch lengths and forecast horizons, we conduct 750 experiments per noise regime, totaling 1500 evaluations for each model family. This dual-setting analysis (clean + noisy) enables robust insights into the forecasting capabilities, stability, and noise resilience of each architecture.</p>
</div>
<div class="ltx_para" id="S8.p3">
<p class="ltx_p" id="S8.p3.1"><span class="ltx_text ltx_font_typewriter" id="S8.p3.1.1">PatchTST</span> Standard emerges as the most consistent and robust variant across both clean and noisy environments. It delivers low RMSE and MAE even under signal perturbations, demonstrating resilience in long-horizon, non-stationary, and noisy conditions while remaining computationally efficient. Patch-based attention with learned temporal embeddings proves highly effective.</p>
</div>
<div class="ltx_para" id="S8.p4">
<p class="ltx_p" id="S8.p4.1"><span class="ltx_text ltx_font_typewriter" id="S8.p4.1.1">Autoformer</span> Minimal and <span class="ltx_text ltx_font_typewriter" id="S8.p4.1.2">Autoformer</span> Standard maintain competitive accuracy, particularly in clean, short-to-medium horizon tasks. Their performance is bolstered by trend-seasonal decomposition, which imparts stability and interpretability. Notably, <span class="ltx_text ltx_font_typewriter" id="S8.p4.1.3">Autoformer</span> continues to outperform in noisy settings—confirming its structural advantage in capturing underlying signal trends even amidst distortion.</p>
</div>
<div class="ltx_para" id="S8.p5">
<p class="ltx_p" id="S8.p5.1"><span class="ltx_text ltx_font_typewriter" id="S8.p5.1.1">Informer</span> Standard and <span class="ltx_text ltx_font_typewriter" id="S8.p5.1.2">Informer</span> Full exhibit clear performance degradation under noise. While sparse attention offers scalability, it leads to unstable forecasts, especially at longer horizons and with larger patch sizes. <span class="ltx_text ltx_font_typewriter" id="S8.p5.1.3">Informer</span> struggles most with noisy inputs, indicating its limited generalization in structured low-noise or high-variance time series.</p>
</div>
<div class="ltx_para" id="S8.p6">
<p class="ltx_p" id="S8.p6.1">For all three model families, performance is sensitive to both forecast horizon and patch length. Optimal results are generally found with patch lengths in the range of 12–16 and forecast horizons of 2–6. Increasing patch size beyond this range does not reliably improve accuracy and may induce overfitting, particularly in clean settings.</p>
</div>
<div class="ltx_para" id="S8.p7">
<p class="ltx_p" id="S8.p7.1">To advance beyond these autoregressive and encoder-decoder designs, we further introduced the Koopman-enhanced Transformer architecture (<span class="ltx_text ltx_font_italic" id="S8.p7.1.1">Koopformer</span>). By integrating Koopman operator theory to model linear latent state evolution, Koopformer provides a hybrid framework that unifies deep sequence modeling with dynamical systems theory. Empirical results on nonlinear and chaotic systems, including the noisy Van der Pol oscillator and Lorenz attractor, demonstrate that Koopformer variants can effectively capture nonlinear oscillations and chaotic trajectories with improved stability and interpretability.</p>
</div>
<div class="ltx_para" id="S8.p8">
<p class="ltx_p" id="S8.p8.1">In conclusion, encoder-only models such as <span class="ltx_text ltx_font_typewriter" id="S8.p8.1.1">PatchTST</span> Standard offer the best trade-off between forecasting accuracy, robustness, and scalability across noise regimes. Trend decomposition of <span class="ltx_text ltx_font_typewriter" id="S8.p8.1.2">Autoformer</span> remains beneficial under distortion, while <span class="ltx_text ltx_font_typewriter" id="S8.p8.1.3">Informer</span> is less suited to structured and noisy time series. Koopman-enhanced Transformer expands the design space, offering a promising hybrid approach for interpretable and stable forecasting of nonlinear dynamical systems. Future work will explore extending Koopman enahnced Transformer to multivariate and real-world datasets, and integrating advanced operator learning and interpretability mechanisms to further enhance robustness and scientific insight.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_typewriter" id="alg1.4.2">PatchTST</span> Full Forecasting Procedure</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> Patch sequence <math alttext="\mathbf{x}\in\mathbb{R}^{B\times P\times 1}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">𝐱</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">∈</mo><msup id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml"><mi id="alg1.l1.m1.1.1.3.3.2" xref="alg1.l1.m1.1.1.3.3.2.cmml">B</mi><mo id="alg1.l1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l1.m1.1.1.3.3.1.cmml">×</mo><mi id="alg1.l1.m1.1.1.3.3.3" xref="alg1.l1.m1.1.1.3.3.3.cmml">P</mi><mo id="alg1.l1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg1.l1.m1.1.1.3.3.1.cmml">×</mo><mn id="alg1.l1.m1.1.1.3.3.4" xref="alg1.l1.m1.1.1.3.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><in id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></in><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐱</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3">superscript</csymbol><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">ℝ</ci><apply id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3"><times id="alg1.l1.m1.1.1.3.3.1.cmml" xref="alg1.l1.m1.1.1.3.3.1"></times><ci id="alg1.l1.m1.1.1.3.3.2.cmml" xref="alg1.l1.m1.1.1.3.3.2">𝐵</ci><ci id="alg1.l1.m1.1.1.3.3.3.cmml" xref="alg1.l1.m1.1.1.3.3.3">𝑃</ci><cn id="alg1.l1.m1.1.1.3.3.4.cmml" type="integer" xref="alg1.l1.m1.1.1.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{x}\in\mathbb{R}^{B\times P\times 1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>; forecast horizon <math alttext="H" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_H</annotation></semantics></math>; model dimension <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">d</mi><mtext id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑑</ci><ci id="alg1.l1.m3.1.1.3a.cmml" xref="alg1.l1.m3.1.1.3"><mtext id="alg1.l1.m3.1.1.3.cmml" mathsize="70%" xref="alg1.l1.m3.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> Forecast <math alttext="\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mover accent="true" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">𝐲</mi><mo id="alg1.l2.m1.1.1.2.1" xref="alg1.l2.m1.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">∈</mo><msup id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml"><mi id="alg1.l2.m1.1.1.3.3.2" xref="alg1.l2.m1.1.1.3.3.2.cmml">B</mi><mo id="alg1.l2.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l2.m1.1.1.3.3.1.cmml">×</mo><mi id="alg1.l2.m1.1.1.3.3.3" xref="alg1.l2.m1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><in id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></in><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><ci id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2.1">^</ci><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝐲</ci></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3">superscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">ℝ</ci><apply id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3"><times id="alg1.l2.m1.1.1.3.3.1.cmml" xref="alg1.l2.m1.1.1.3.3.1"></times><ci id="alg1.l2.m1.1.1.3.3.2.cmml" xref="alg1.l2.m1.1.1.3.3.2">𝐵</ci><ci id="alg1.l2.m1.1.1.3.3.3.cmml" xref="alg1.l2.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">over^ start_ARG bold_y end_ARG ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">Step 1: Encoder Input Projection and Positional Encoding</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex42">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{enc}}=\mathbf{x}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{B\times P\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex42.m1.2"><semantics id="A0.Ex42.m1.2a"><mrow id="A0.Ex42.m1.2.3" xref="A0.Ex42.m1.2.3.cmml"><msup id="A0.Ex42.m1.2.3.2" xref="A0.Ex42.m1.2.3.2.cmml"><mi id="A0.Ex42.m1.2.3.2.2" xref="A0.Ex42.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex42.m1.2.3.2.3" xref="A0.Ex42.m1.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex42.m1.2.3.3" xref="A0.Ex42.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex42.m1.2.3.4" xref="A0.Ex42.m1.2.3.4.cmml"><mrow id="A0.Ex42.m1.2.3.4.2" xref="A0.Ex42.m1.2.3.4.2.cmml"><mi id="A0.Ex42.m1.2.3.4.2.2" xref="A0.Ex42.m1.2.3.4.2.2.cmml">𝐱</mi><mo id="A0.Ex42.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex42.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex42.m1.2.3.4.2.3" xref="A0.Ex42.m1.2.3.4.2.3.cmml"><mi id="A0.Ex42.m1.2.3.4.2.3.2.2" xref="A0.Ex42.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex42.m1.2.3.4.2.3.2.3" xref="A0.Ex42.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex42.m1.1.1.1.3" xref="A0.Ex42.m1.2.3.4.2.3.cmml"><mo id="A0.Ex42.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex42.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex42.m1.1.1.1.1" xref="A0.Ex42.m1.1.1.1.1.cmml">e</mi><mo id="A0.Ex42.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex42.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex42.m1.2.3.4.1" xref="A0.Ex42.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex42.m1.2.3.4.3" xref="A0.Ex42.m1.2.3.4.3.cmml"><mtext id="A0.Ex42.m1.2.3.4.3.2" xref="A0.Ex42.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex42.m1.2.2.1.3" xref="A0.Ex42.m1.2.3.4.3.cmml"><mo id="A0.Ex42.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex42.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex42.m1.2.2.1.1" xref="A0.Ex42.m1.2.2.1.1.cmml">e</mi><mo id="A0.Ex42.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex42.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex42.m1.2.3.5" xref="A0.Ex42.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex42.m1.2.3.6" xref="A0.Ex42.m1.2.3.6.cmml"><mi id="A0.Ex42.m1.2.3.6.2" xref="A0.Ex42.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex42.m1.2.3.6.3" xref="A0.Ex42.m1.2.3.6.3.cmml"><mi id="A0.Ex42.m1.2.3.6.3.2" xref="A0.Ex42.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex42.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex42.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex42.m1.2.3.6.3.3" xref="A0.Ex42.m1.2.3.6.3.3.cmml">P</mi><mo id="A0.Ex42.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex42.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex42.m1.2.3.6.3.4" xref="A0.Ex42.m1.2.3.6.3.4.cmml"><mi id="A0.Ex42.m1.2.3.6.3.4.2" xref="A0.Ex42.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex42.m1.2.3.6.3.4.3" xref="A0.Ex42.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex42.m1.2b"><apply id="A0.Ex42.m1.2.3.cmml" xref="A0.Ex42.m1.2.3"><and id="A0.Ex42.m1.2.3a.cmml" xref="A0.Ex42.m1.2.3"></and><apply id="A0.Ex42.m1.2.3b.cmml" xref="A0.Ex42.m1.2.3"><eq id="A0.Ex42.m1.2.3.3.cmml" xref="A0.Ex42.m1.2.3.3"></eq><apply id="A0.Ex42.m1.2.3.2.cmml" xref="A0.Ex42.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.2.1.cmml" xref="A0.Ex42.m1.2.3.2">superscript</csymbol><ci id="A0.Ex42.m1.2.3.2.2.cmml" xref="A0.Ex42.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex42.m1.2.3.2.3a.cmml" xref="A0.Ex42.m1.2.3.2.3"><mtext id="A0.Ex42.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex42.m1.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex42.m1.2.3.4.cmml" xref="A0.Ex42.m1.2.3.4"><plus id="A0.Ex42.m1.2.3.4.1.cmml" xref="A0.Ex42.m1.2.3.4.1"></plus><apply id="A0.Ex42.m1.2.3.4.2.cmml" xref="A0.Ex42.m1.2.3.4.2"><ci id="A0.Ex42.m1.2.3.4.2.1.cmml" xref="A0.Ex42.m1.2.3.4.2.1">⋅</ci><ci id="A0.Ex42.m1.2.3.4.2.2.cmml" xref="A0.Ex42.m1.2.3.4.2.2">𝐱</ci><apply id="A0.Ex42.m1.2.3.4.2.3.cmml" xref="A0.Ex42.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.4.2.3.1.cmml" xref="A0.Ex42.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex42.m1.2.3.4.2.3.2.cmml" xref="A0.Ex42.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex42.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex42.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex42.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex42.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex42.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex42.m1.1.1.1.1.cmml" xref="A0.Ex42.m1.1.1.1.1">𝑒</ci></apply></apply><apply id="A0.Ex42.m1.2.3.4.3.cmml" xref="A0.Ex42.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.4.3.1.cmml" xref="A0.Ex42.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex42.m1.2.3.4.3.2a.cmml" xref="A0.Ex42.m1.2.3.4.3.2"><mtext id="A0.Ex42.m1.2.3.4.3.2.cmml" xref="A0.Ex42.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex42.m1.2.2.1.1.cmml" xref="A0.Ex42.m1.2.2.1.1">𝑒</ci></apply></apply></apply><apply id="A0.Ex42.m1.2.3c.cmml" xref="A0.Ex42.m1.2.3"><in id="A0.Ex42.m1.2.3.5.cmml" xref="A0.Ex42.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex42.m1.2.3.4.cmml" id="A0.Ex42.m1.2.3d.cmml" xref="A0.Ex42.m1.2.3"></share><apply id="A0.Ex42.m1.2.3.6.cmml" xref="A0.Ex42.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.6.1.cmml" xref="A0.Ex42.m1.2.3.6">superscript</csymbol><ci id="A0.Ex42.m1.2.3.6.2.cmml" xref="A0.Ex42.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex42.m1.2.3.6.3.cmml" xref="A0.Ex42.m1.2.3.6.3"><times id="A0.Ex42.m1.2.3.6.3.1.cmml" xref="A0.Ex42.m1.2.3.6.3.1"></times><ci id="A0.Ex42.m1.2.3.6.3.2.cmml" xref="A0.Ex42.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex42.m1.2.3.6.3.3.cmml" xref="A0.Ex42.m1.2.3.6.3.3">𝑃</ci><apply id="A0.Ex42.m1.2.3.6.3.4.cmml" xref="A0.Ex42.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex42.m1.2.3.6.3.4.1.cmml" xref="A0.Ex42.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex42.m1.2.3.6.3.4.2.cmml" xref="A0.Ex42.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex42.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex42.m1.2.3.6.3.4.3"><mtext id="A0.Ex42.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex42.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex42.m1.2c">\mathbf{Z}^{\text{enc}}=\mathbf{x}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{B\times P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex42.m1.2d">bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT = bold_x ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l4.2">Step 2: Transformer Encoder Layers</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l5.2">for</span> each encoder layer <math alttext="\ell=1,\dots,L" class="ltx_Math" display="inline" id="alg1.l5.m1.3"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.4" xref="alg1.l5.m1.3.4.cmml"><mi id="alg1.l5.m1.3.4.2" mathvariant="normal" xref="alg1.l5.m1.3.4.2.cmml">ℓ</mi><mo id="alg1.l5.m1.3.4.1" xref="alg1.l5.m1.3.4.1.cmml">=</mo><mrow id="alg1.l5.m1.3.4.3.2" xref="alg1.l5.m1.3.4.3.1.cmml"><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">1</mn><mo id="alg1.l5.m1.3.4.3.2.1" xref="alg1.l5.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.2.2" mathvariant="normal" xref="alg1.l5.m1.2.2.cmml">…</mi><mo id="alg1.l5.m1.3.4.3.2.2" xref="alg1.l5.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.4.cmml" xref="alg1.l5.m1.3.4"><eq id="alg1.l5.m1.3.4.1.cmml" xref="alg1.l5.m1.3.4.1"></eq><ci id="alg1.l5.m1.3.4.2.cmml" xref="alg1.l5.m1.3.4.2">ℓ</ci><list id="alg1.l5.m1.3.4.3.1.cmml" xref="alg1.l5.m1.3.4.3.2"><cn id="alg1.l5.m1.1.1.cmml" type="integer" xref="alg1.l5.m1.1.1">1</cn><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">…</ci><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">\ell=1,\dots,L</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.3d">roman_ℓ = 1 , … , italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     Compute attention heads:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex43">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q}_{\ell},\quad K=\mathbf{Z}^{\text{%
enc}}\cdot\mathbf{W}^{K}_{\ell},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}%
^{V}_{\ell}" class="ltx_Math" display="block" id="A0.Ex43.m1.2"><semantics id="A0.Ex43.m1.2a"><mrow id="A0.Ex43.m1.2.2.2" xref="A0.Ex43.m1.2.2.3.cmml"><mrow id="A0.Ex43.m1.1.1.1.1" xref="A0.Ex43.m1.1.1.1.1.cmml"><mi id="A0.Ex43.m1.1.1.1.1.2" xref="A0.Ex43.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex43.m1.1.1.1.1.1" xref="A0.Ex43.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex43.m1.1.1.1.1.3" xref="A0.Ex43.m1.1.1.1.1.3.cmml"><msup id="A0.Ex43.m1.1.1.1.1.3.2" xref="A0.Ex43.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex43.m1.1.1.1.1.3.2.2" xref="A0.Ex43.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex43.m1.1.1.1.1.3.2.3" xref="A0.Ex43.m1.1.1.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex43.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex43.m1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="A0.Ex43.m1.1.1.1.1.3.3" xref="A0.Ex43.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex43.m1.1.1.1.1.3.3.2.2" xref="A0.Ex43.m1.1.1.1.1.3.3.2.2.cmml">𝐖</mi><mi id="A0.Ex43.m1.1.1.1.1.3.3.3" mathvariant="normal" xref="A0.Ex43.m1.1.1.1.1.3.3.3.cmml">ℓ</mi><mi id="A0.Ex43.m1.1.1.1.1.3.3.2.3" xref="A0.Ex43.m1.1.1.1.1.3.3.2.3.cmml">Q</mi></msubsup></mrow></mrow><mo id="A0.Ex43.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex43.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex43.m1.2.2.2.2.2" xref="A0.Ex43.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex43.m1.2.2.2.2.1.1" xref="A0.Ex43.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex43.m1.2.2.2.2.1.1.2" xref="A0.Ex43.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex43.m1.2.2.2.2.1.1.1" xref="A0.Ex43.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex43.m1.2.2.2.2.1.1.3" xref="A0.Ex43.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex43.m1.2.2.2.2.1.1.3.2" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex43.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex43.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex43.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex43.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msubsup id="A0.Ex43.m1.2.2.2.2.1.1.3.3" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.2" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.2.cmml">𝐖</mi><mi id="A0.Ex43.m1.2.2.2.2.1.1.3.3.3" mathvariant="normal" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.3.cmml">ℓ</mi><mi id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.3" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.3.cmml">K</mi></msubsup></mrow></mrow><mo id="A0.Ex43.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex43.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex43.m1.2.2.2.2.2.2" xref="A0.Ex43.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex43.m1.2.2.2.2.2.2.2" xref="A0.Ex43.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex43.m1.2.2.2.2.2.2.1" xref="A0.Ex43.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex43.m1.2.2.2.2.2.2.3" xref="A0.Ex43.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex43.m1.2.2.2.2.2.2.3.2" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex43.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex43.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex43.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex43.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msubsup id="A0.Ex43.m1.2.2.2.2.2.2.3.3" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.2" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.2.cmml">𝐖</mi><mi id="A0.Ex43.m1.2.2.2.2.2.2.3.3.3" mathvariant="normal" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.3.cmml">ℓ</mi><mi id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.3" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.3.cmml">V</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex43.m1.2b"><apply id="A0.Ex43.m1.2.2.3.cmml" xref="A0.Ex43.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.3a.cmml" xref="A0.Ex43.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex43.m1.1.1.1.1.cmml" xref="A0.Ex43.m1.1.1.1.1"><eq id="A0.Ex43.m1.1.1.1.1.1.cmml" xref="A0.Ex43.m1.1.1.1.1.1"></eq><ci id="A0.Ex43.m1.1.1.1.1.2.cmml" xref="A0.Ex43.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex43.m1.1.1.1.1.3.cmml" xref="A0.Ex43.m1.1.1.1.1.3"><ci id="A0.Ex43.m1.1.1.1.1.3.1.cmml" xref="A0.Ex43.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex43.m1.1.1.1.1.3.2.cmml" xref="A0.Ex43.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex43.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex43.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex43.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex43.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex43.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex43.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex43.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex43.m1.1.1.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex43.m1.1.1.1.1.3.3.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3">subscript</csymbol><apply id="A0.Ex43.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.1.1.1.1.3.3.2.1.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex43.m1.1.1.1.1.3.3.2.2.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3.2.2">𝐖</ci><ci id="A0.Ex43.m1.1.1.1.1.3.3.2.3.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3.2.3">𝑄</ci></apply><ci id="A0.Ex43.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex43.m1.1.1.1.1.3.3.3">ℓ</ci></apply></apply></apply><apply id="A0.Ex43.m1.2.2.2.2.3.cmml" xref="A0.Ex43.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.3a.cmml" xref="A0.Ex43.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex43.m1.2.2.2.2.1.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1"><eq id="A0.Ex43.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex43.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex43.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3"><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex43.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.2">𝐙</ci><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex43.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex43.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex43.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3">subscript</csymbol><apply id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.2">𝐖</ci><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.3.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.2.3">𝐾</ci></apply><ci id="A0.Ex43.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex43.m1.2.2.2.2.1.1.3.3.3">ℓ</ci></apply></apply></apply><apply id="A0.Ex43.m1.2.2.2.2.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2"><eq id="A0.Ex43.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex43.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex43.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3"><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex43.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.2">𝐙</ci><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex43.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex43.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex43.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3">subscript</csymbol><apply id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.2.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.2">𝐖</ci><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.2.3">𝑉</ci></apply><ci id="A0.Ex43.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex43.m1.2.2.2.2.2.2.3.3.3">ℓ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex43.m1.2c">Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q}_{\ell},\quad K=\mathbf{Z}^{\text{%
enc}}\cdot\mathbf{W}^{K}_{\ell},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}%
^{V}_{\ell}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex43.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT , italic_K = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT , italic_V = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex44">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{head}_{i}=\text{Softmax}\left(\frac{Q_{i}K_{i}^{\top}}{\sqrt{d_{\text{%
model}}/h}}\right)V_{i}" class="ltx_Math" display="block" id="A0.Ex44.m1.1"><semantics id="A0.Ex44.m1.1a"><mrow id="A0.Ex44.m1.1.2" xref="A0.Ex44.m1.1.2.cmml"><msub id="A0.Ex44.m1.1.2.2" xref="A0.Ex44.m1.1.2.2.cmml"><mtext id="A0.Ex44.m1.1.2.2.2" xref="A0.Ex44.m1.1.2.2.2a.cmml">head</mtext><mi id="A0.Ex44.m1.1.2.2.3" xref="A0.Ex44.m1.1.2.2.3.cmml">i</mi></msub><mo id="A0.Ex44.m1.1.2.1" xref="A0.Ex44.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex44.m1.1.2.3" xref="A0.Ex44.m1.1.2.3.cmml"><mtext id="A0.Ex44.m1.1.2.3.2" xref="A0.Ex44.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex44.m1.1.2.3.1" xref="A0.Ex44.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex44.m1.1.2.3.3.2" xref="A0.Ex44.m1.1.1.cmml"><mo id="A0.Ex44.m1.1.2.3.3.2.1" xref="A0.Ex44.m1.1.1.cmml">(</mo><mfrac id="A0.Ex44.m1.1.1" xref="A0.Ex44.m1.1.1.cmml"><mrow id="A0.Ex44.m1.1.1.2" xref="A0.Ex44.m1.1.1.2.cmml"><msub id="A0.Ex44.m1.1.1.2.2" xref="A0.Ex44.m1.1.1.2.2.cmml"><mi id="A0.Ex44.m1.1.1.2.2.2" xref="A0.Ex44.m1.1.1.2.2.2.cmml">Q</mi><mi id="A0.Ex44.m1.1.1.2.2.3" xref="A0.Ex44.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="A0.Ex44.m1.1.1.2.1" xref="A0.Ex44.m1.1.1.2.1.cmml">⁢</mo><msubsup id="A0.Ex44.m1.1.1.2.3" xref="A0.Ex44.m1.1.1.2.3.cmml"><mi id="A0.Ex44.m1.1.1.2.3.2.2" xref="A0.Ex44.m1.1.1.2.3.2.2.cmml">K</mi><mi id="A0.Ex44.m1.1.1.2.3.2.3" xref="A0.Ex44.m1.1.1.2.3.2.3.cmml">i</mi><mo id="A0.Ex44.m1.1.1.2.3.3" xref="A0.Ex44.m1.1.1.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="A0.Ex44.m1.1.1.3" xref="A0.Ex44.m1.1.1.3.cmml"><mrow id="A0.Ex44.m1.1.1.3.2" xref="A0.Ex44.m1.1.1.3.2.cmml"><msub id="A0.Ex44.m1.1.1.3.2.2" xref="A0.Ex44.m1.1.1.3.2.2.cmml"><mi id="A0.Ex44.m1.1.1.3.2.2.2" xref="A0.Ex44.m1.1.1.3.2.2.2.cmml">d</mi><mtext id="A0.Ex44.m1.1.1.3.2.2.3" xref="A0.Ex44.m1.1.1.3.2.2.3a.cmml">model</mtext></msub><mo id="A0.Ex44.m1.1.1.3.2.1" xref="A0.Ex44.m1.1.1.3.2.1.cmml">/</mo><mi id="A0.Ex44.m1.1.1.3.2.3" xref="A0.Ex44.m1.1.1.3.2.3.cmml">h</mi></mrow></msqrt></mfrac><mo id="A0.Ex44.m1.1.2.3.3.2.2" xref="A0.Ex44.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex44.m1.1.2.3.1a" xref="A0.Ex44.m1.1.2.3.1.cmml">⁢</mo><msub id="A0.Ex44.m1.1.2.3.4" xref="A0.Ex44.m1.1.2.3.4.cmml"><mi id="A0.Ex44.m1.1.2.3.4.2" xref="A0.Ex44.m1.1.2.3.4.2.cmml">V</mi><mi id="A0.Ex44.m1.1.2.3.4.3" xref="A0.Ex44.m1.1.2.3.4.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex44.m1.1b"><apply id="A0.Ex44.m1.1.2.cmml" xref="A0.Ex44.m1.1.2"><eq id="A0.Ex44.m1.1.2.1.cmml" xref="A0.Ex44.m1.1.2.1"></eq><apply id="A0.Ex44.m1.1.2.2.cmml" xref="A0.Ex44.m1.1.2.2"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.2.2.1.cmml" xref="A0.Ex44.m1.1.2.2">subscript</csymbol><ci id="A0.Ex44.m1.1.2.2.2a.cmml" xref="A0.Ex44.m1.1.2.2.2"><mtext id="A0.Ex44.m1.1.2.2.2.cmml" xref="A0.Ex44.m1.1.2.2.2">head</mtext></ci><ci id="A0.Ex44.m1.1.2.2.3.cmml" xref="A0.Ex44.m1.1.2.2.3">𝑖</ci></apply><apply id="A0.Ex44.m1.1.2.3.cmml" xref="A0.Ex44.m1.1.2.3"><times id="A0.Ex44.m1.1.2.3.1.cmml" xref="A0.Ex44.m1.1.2.3.1"></times><ci id="A0.Ex44.m1.1.2.3.2a.cmml" xref="A0.Ex44.m1.1.2.3.2"><mtext id="A0.Ex44.m1.1.2.3.2.cmml" xref="A0.Ex44.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex44.m1.1.1.cmml" xref="A0.Ex44.m1.1.2.3.3.2"><divide id="A0.Ex44.m1.1.1.1.cmml" xref="A0.Ex44.m1.1.2.3.3.2"></divide><apply id="A0.Ex44.m1.1.1.2.cmml" xref="A0.Ex44.m1.1.1.2"><times id="A0.Ex44.m1.1.1.2.1.cmml" xref="A0.Ex44.m1.1.1.2.1"></times><apply id="A0.Ex44.m1.1.1.2.2.cmml" xref="A0.Ex44.m1.1.1.2.2"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.1.2.2.1.cmml" xref="A0.Ex44.m1.1.1.2.2">subscript</csymbol><ci id="A0.Ex44.m1.1.1.2.2.2.cmml" xref="A0.Ex44.m1.1.1.2.2.2">𝑄</ci><ci id="A0.Ex44.m1.1.1.2.2.3.cmml" xref="A0.Ex44.m1.1.1.2.2.3">𝑖</ci></apply><apply id="A0.Ex44.m1.1.1.2.3.cmml" xref="A0.Ex44.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.1.2.3.1.cmml" xref="A0.Ex44.m1.1.1.2.3">superscript</csymbol><apply id="A0.Ex44.m1.1.1.2.3.2.cmml" xref="A0.Ex44.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.1.2.3.2.1.cmml" xref="A0.Ex44.m1.1.1.2.3">subscript</csymbol><ci id="A0.Ex44.m1.1.1.2.3.2.2.cmml" xref="A0.Ex44.m1.1.1.2.3.2.2">𝐾</ci><ci id="A0.Ex44.m1.1.1.2.3.2.3.cmml" xref="A0.Ex44.m1.1.1.2.3.2.3">𝑖</ci></apply><csymbol cd="latexml" id="A0.Ex44.m1.1.1.2.3.3.cmml" xref="A0.Ex44.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex44.m1.1.1.3.cmml" xref="A0.Ex44.m1.1.1.3"><root id="A0.Ex44.m1.1.1.3a.cmml" xref="A0.Ex44.m1.1.1.3"></root><apply id="A0.Ex44.m1.1.1.3.2.cmml" xref="A0.Ex44.m1.1.1.3.2"><divide id="A0.Ex44.m1.1.1.3.2.1.cmml" xref="A0.Ex44.m1.1.1.3.2.1"></divide><apply id="A0.Ex44.m1.1.1.3.2.2.cmml" xref="A0.Ex44.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.1.3.2.2.1.cmml" xref="A0.Ex44.m1.1.1.3.2.2">subscript</csymbol><ci id="A0.Ex44.m1.1.1.3.2.2.2.cmml" xref="A0.Ex44.m1.1.1.3.2.2.2">𝑑</ci><ci id="A0.Ex44.m1.1.1.3.2.2.3a.cmml" xref="A0.Ex44.m1.1.1.3.2.2.3"><mtext id="A0.Ex44.m1.1.1.3.2.2.3.cmml" mathsize="70%" xref="A0.Ex44.m1.1.1.3.2.2.3">model</mtext></ci></apply><ci id="A0.Ex44.m1.1.1.3.2.3.cmml" xref="A0.Ex44.m1.1.1.3.2.3">ℎ</ci></apply></apply></apply><apply id="A0.Ex44.m1.1.2.3.4.cmml" xref="A0.Ex44.m1.1.2.3.4"><csymbol cd="ambiguous" id="A0.Ex44.m1.1.2.3.4.1.cmml" xref="A0.Ex44.m1.1.2.3.4">subscript</csymbol><ci id="A0.Ex44.m1.1.2.3.4.2.cmml" xref="A0.Ex44.m1.1.2.3.4.2">𝑉</ci><ci id="A0.Ex44.m1.1.2.3.4.3.cmml" xref="A0.Ex44.m1.1.2.3.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex44.m1.1c">\text{head}_{i}=\text{Softmax}\left(\frac{Q_{i}K_{i}^{\top}}{\sqrt{d_{\text{%
model}}/h}}\right)V_{i}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex44.m1.1d">head start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT / italic_h end_ARG end_ARG ) italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex45">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MHAttn}=\text{Concat}(\text{head}_{1},\dots,\text{head}_{h})\cdot\mathbf%
{W}^{O}_{\ell}" class="ltx_Math" display="block" id="A0.Ex45.m1.3"><semantics id="A0.Ex45.m1.3a"><mrow id="A0.Ex45.m1.3.3" xref="A0.Ex45.m1.3.3.cmml"><mtext id="A0.Ex45.m1.3.3.4" xref="A0.Ex45.m1.3.3.4a.cmml">MHAttn</mtext><mo id="A0.Ex45.m1.3.3.3" xref="A0.Ex45.m1.3.3.3.cmml">=</mo><mrow id="A0.Ex45.m1.3.3.2" xref="A0.Ex45.m1.3.3.2.cmml"><mrow id="A0.Ex45.m1.3.3.2.2" xref="A0.Ex45.m1.3.3.2.2.cmml"><mtext id="A0.Ex45.m1.3.3.2.2.4" xref="A0.Ex45.m1.3.3.2.2.4a.cmml">Concat</mtext><mo id="A0.Ex45.m1.3.3.2.2.3" xref="A0.Ex45.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="A0.Ex45.m1.3.3.2.2.2.2" xref="A0.Ex45.m1.3.3.2.2.2.3.cmml"><mo id="A0.Ex45.m1.3.3.2.2.2.2.3" stretchy="false" xref="A0.Ex45.m1.3.3.2.2.2.3.cmml">(</mo><msub id="A0.Ex45.m1.2.2.1.1.1.1.1" xref="A0.Ex45.m1.2.2.1.1.1.1.1.cmml"><mtext id="A0.Ex45.m1.2.2.1.1.1.1.1.2" xref="A0.Ex45.m1.2.2.1.1.1.1.1.2a.cmml">head</mtext><mn id="A0.Ex45.m1.2.2.1.1.1.1.1.3" xref="A0.Ex45.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A0.Ex45.m1.3.3.2.2.2.2.4" xref="A0.Ex45.m1.3.3.2.2.2.3.cmml">,</mo><mi id="A0.Ex45.m1.1.1" mathvariant="normal" xref="A0.Ex45.m1.1.1.cmml">…</mi><mo id="A0.Ex45.m1.3.3.2.2.2.2.5" xref="A0.Ex45.m1.3.3.2.2.2.3.cmml">,</mo><msub id="A0.Ex45.m1.3.3.2.2.2.2.2" xref="A0.Ex45.m1.3.3.2.2.2.2.2.cmml"><mtext id="A0.Ex45.m1.3.3.2.2.2.2.2.2" xref="A0.Ex45.m1.3.3.2.2.2.2.2.2a.cmml">head</mtext><mi id="A0.Ex45.m1.3.3.2.2.2.2.2.3" xref="A0.Ex45.m1.3.3.2.2.2.2.2.3.cmml">h</mi></msub><mo id="A0.Ex45.m1.3.3.2.2.2.2.6" rspace="0.055em" stretchy="false" xref="A0.Ex45.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A0.Ex45.m1.3.3.2.3" rspace="0.222em" xref="A0.Ex45.m1.3.3.2.3.cmml">⋅</mo><msubsup id="A0.Ex45.m1.3.3.2.4" xref="A0.Ex45.m1.3.3.2.4.cmml"><mi id="A0.Ex45.m1.3.3.2.4.2.2" xref="A0.Ex45.m1.3.3.2.4.2.2.cmml">𝐖</mi><mi id="A0.Ex45.m1.3.3.2.4.3" mathvariant="normal" xref="A0.Ex45.m1.3.3.2.4.3.cmml">ℓ</mi><mi id="A0.Ex45.m1.3.3.2.4.2.3" xref="A0.Ex45.m1.3.3.2.4.2.3.cmml">O</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex45.m1.3b"><apply id="A0.Ex45.m1.3.3.cmml" xref="A0.Ex45.m1.3.3"><eq id="A0.Ex45.m1.3.3.3.cmml" xref="A0.Ex45.m1.3.3.3"></eq><ci id="A0.Ex45.m1.3.3.4a.cmml" xref="A0.Ex45.m1.3.3.4"><mtext id="A0.Ex45.m1.3.3.4.cmml" xref="A0.Ex45.m1.3.3.4">MHAttn</mtext></ci><apply id="A0.Ex45.m1.3.3.2.cmml" xref="A0.Ex45.m1.3.3.2"><ci id="A0.Ex45.m1.3.3.2.3.cmml" xref="A0.Ex45.m1.3.3.2.3">⋅</ci><apply id="A0.Ex45.m1.3.3.2.2.cmml" xref="A0.Ex45.m1.3.3.2.2"><times id="A0.Ex45.m1.3.3.2.2.3.cmml" xref="A0.Ex45.m1.3.3.2.2.3"></times><ci id="A0.Ex45.m1.3.3.2.2.4a.cmml" xref="A0.Ex45.m1.3.3.2.2.4"><mtext id="A0.Ex45.m1.3.3.2.2.4.cmml" xref="A0.Ex45.m1.3.3.2.2.4">Concat</mtext></ci><vector id="A0.Ex45.m1.3.3.2.2.2.3.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2"><apply id="A0.Ex45.m1.2.2.1.1.1.1.1.cmml" xref="A0.Ex45.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex45.m1.2.2.1.1.1.1.1.1.cmml" xref="A0.Ex45.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A0.Ex45.m1.2.2.1.1.1.1.1.2a.cmml" xref="A0.Ex45.m1.2.2.1.1.1.1.1.2"><mtext id="A0.Ex45.m1.2.2.1.1.1.1.1.2.cmml" xref="A0.Ex45.m1.2.2.1.1.1.1.1.2">head</mtext></ci><cn id="A0.Ex45.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="A0.Ex45.m1.2.2.1.1.1.1.1.3">1</cn></apply><ci id="A0.Ex45.m1.1.1.cmml" xref="A0.Ex45.m1.1.1">…</ci><apply id="A0.Ex45.m1.3.3.2.2.2.2.2.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex45.m1.3.3.2.2.2.2.2.1.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="A0.Ex45.m1.3.3.2.2.2.2.2.2a.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2.2.2"><mtext id="A0.Ex45.m1.3.3.2.2.2.2.2.2.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2.2.2">head</mtext></ci><ci id="A0.Ex45.m1.3.3.2.2.2.2.2.3.cmml" xref="A0.Ex45.m1.3.3.2.2.2.2.2.3">ℎ</ci></apply></vector></apply><apply id="A0.Ex45.m1.3.3.2.4.cmml" xref="A0.Ex45.m1.3.3.2.4"><csymbol cd="ambiguous" id="A0.Ex45.m1.3.3.2.4.1.cmml" xref="A0.Ex45.m1.3.3.2.4">subscript</csymbol><apply id="A0.Ex45.m1.3.3.2.4.2.cmml" xref="A0.Ex45.m1.3.3.2.4"><csymbol cd="ambiguous" id="A0.Ex45.m1.3.3.2.4.2.1.cmml" xref="A0.Ex45.m1.3.3.2.4">superscript</csymbol><ci id="A0.Ex45.m1.3.3.2.4.2.2.cmml" xref="A0.Ex45.m1.3.3.2.4.2.2">𝐖</ci><ci id="A0.Ex45.m1.3.3.2.4.2.3.cmml" xref="A0.Ex45.m1.3.3.2.4.2.3">𝑂</ci></apply><ci id="A0.Ex45.m1.3.3.2.4.3.cmml" xref="A0.Ex45.m1.3.3.2.4.3">ℓ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex45.m1.3c">\text{MHAttn}=\text{Concat}(\text{head}_{1},\dots,\text{head}_{h})\cdot\mathbf%
{W}^{O}_{\ell}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex45.m1.3d">MHAttn = Concat ( head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , head start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ⋅ bold_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     Apply residual connection and layer normalization:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex46">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{enc}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{enc}}+%
\text{MHAttn})" class="ltx_Math" display="block" id="A0.Ex46.m1.1"><semantics id="A0.Ex46.m1.1a"><mrow id="A0.Ex46.m1.1.1" xref="A0.Ex46.m1.1.1.cmml"><msup id="A0.Ex46.m1.1.1.3" xref="A0.Ex46.m1.1.1.3.cmml"><mi id="A0.Ex46.m1.1.1.3.2" xref="A0.Ex46.m1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex46.m1.1.1.3.3" xref="A0.Ex46.m1.1.1.3.3a.cmml">enc</mtext></msup><mo id="A0.Ex46.m1.1.1.2" stretchy="false" xref="A0.Ex46.m1.1.1.2.cmml">←</mo><mrow id="A0.Ex46.m1.1.1.1" xref="A0.Ex46.m1.1.1.1.cmml"><mtext id="A0.Ex46.m1.1.1.1.3" xref="A0.Ex46.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="A0.Ex46.m1.1.1.1.2" xref="A0.Ex46.m1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex46.m1.1.1.1.1.1" xref="A0.Ex46.m1.1.1.1.1.1.1.cmml"><mo id="A0.Ex46.m1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex46.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A0.Ex46.m1.1.1.1.1.1.1" xref="A0.Ex46.m1.1.1.1.1.1.1.cmml"><msup id="A0.Ex46.m1.1.1.1.1.1.1.2" xref="A0.Ex46.m1.1.1.1.1.1.1.2.cmml"><mi id="A0.Ex46.m1.1.1.1.1.1.1.2.2" xref="A0.Ex46.m1.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mtext id="A0.Ex46.m1.1.1.1.1.1.1.2.3" xref="A0.Ex46.m1.1.1.1.1.1.1.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex46.m1.1.1.1.1.1.1.1" xref="A0.Ex46.m1.1.1.1.1.1.1.1.cmml">+</mo><mtext id="A0.Ex46.m1.1.1.1.1.1.1.3" xref="A0.Ex46.m1.1.1.1.1.1.1.3a.cmml">MHAttn</mtext></mrow><mo id="A0.Ex46.m1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex46.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex46.m1.1b"><apply id="A0.Ex46.m1.1.1.cmml" xref="A0.Ex46.m1.1.1"><ci id="A0.Ex46.m1.1.1.2.cmml" xref="A0.Ex46.m1.1.1.2">←</ci><apply id="A0.Ex46.m1.1.1.3.cmml" xref="A0.Ex46.m1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex46.m1.1.1.3.1.cmml" xref="A0.Ex46.m1.1.1.3">superscript</csymbol><ci id="A0.Ex46.m1.1.1.3.2.cmml" xref="A0.Ex46.m1.1.1.3.2">𝐙</ci><ci id="A0.Ex46.m1.1.1.3.3a.cmml" xref="A0.Ex46.m1.1.1.3.3"><mtext id="A0.Ex46.m1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex46.m1.1.1.3.3">enc</mtext></ci></apply><apply id="A0.Ex46.m1.1.1.1.cmml" xref="A0.Ex46.m1.1.1.1"><times id="A0.Ex46.m1.1.1.1.2.cmml" xref="A0.Ex46.m1.1.1.1.2"></times><ci id="A0.Ex46.m1.1.1.1.3a.cmml" xref="A0.Ex46.m1.1.1.1.3"><mtext id="A0.Ex46.m1.1.1.1.3.cmml" xref="A0.Ex46.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="A0.Ex46.m1.1.1.1.1.1.1.cmml" xref="A0.Ex46.m1.1.1.1.1.1"><plus id="A0.Ex46.m1.1.1.1.1.1.1.1.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.1"></plus><apply id="A0.Ex46.m1.1.1.1.1.1.1.2.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex46.m1.1.1.1.1.1.1.2.1.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A0.Ex46.m1.1.1.1.1.1.1.2.2.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.2.2">𝐙</ci><ci id="A0.Ex46.m1.1.1.1.1.1.1.2.3a.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.2.3"><mtext id="A0.Ex46.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex46.m1.1.1.1.1.1.1.2.3">enc</mtext></ci></apply><ci id="A0.Ex46.m1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.3"><mtext id="A0.Ex46.m1.1.1.1.1.1.1.3.cmml" xref="A0.Ex46.m1.1.1.1.1.1.1.3">MHAttn</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex46.m1.1c">\mathbf{Z}^{\text{enc}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{enc}}+%
\text{MHAttn})</annotation><annotation encoding="application/x-llamapun" id="A0.Ex46.m1.1d">bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ← LayerNorm ( bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT + MHAttn )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     Apply feedforward and second residual block:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex47">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{enc}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{enc}}+%
\text{FFN}(\mathbf{Z}^{\text{enc}}))" class="ltx_Math" display="block" id="A0.Ex47.m1.1"><semantics id="A0.Ex47.m1.1a"><mrow id="A0.Ex47.m1.1.1" xref="A0.Ex47.m1.1.1.cmml"><msup id="A0.Ex47.m1.1.1.3" xref="A0.Ex47.m1.1.1.3.cmml"><mi id="A0.Ex47.m1.1.1.3.2" xref="A0.Ex47.m1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex47.m1.1.1.3.3" xref="A0.Ex47.m1.1.1.3.3a.cmml">enc</mtext></msup><mo id="A0.Ex47.m1.1.1.2" stretchy="false" xref="A0.Ex47.m1.1.1.2.cmml">←</mo><mrow id="A0.Ex47.m1.1.1.1" xref="A0.Ex47.m1.1.1.1.cmml"><mtext id="A0.Ex47.m1.1.1.1.3" xref="A0.Ex47.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="A0.Ex47.m1.1.1.1.2" xref="A0.Ex47.m1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex47.m1.1.1.1.1.1" xref="A0.Ex47.m1.1.1.1.1.1.1.cmml"><mo id="A0.Ex47.m1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex47.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A0.Ex47.m1.1.1.1.1.1.1" xref="A0.Ex47.m1.1.1.1.1.1.1.cmml"><msup id="A0.Ex47.m1.1.1.1.1.1.1.3" xref="A0.Ex47.m1.1.1.1.1.1.1.3.cmml"><mi id="A0.Ex47.m1.1.1.1.1.1.1.3.2" xref="A0.Ex47.m1.1.1.1.1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex47.m1.1.1.1.1.1.1.3.3" xref="A0.Ex47.m1.1.1.1.1.1.1.3.3a.cmml">enc</mtext></msup><mo id="A0.Ex47.m1.1.1.1.1.1.1.2" xref="A0.Ex47.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A0.Ex47.m1.1.1.1.1.1.1.1" xref="A0.Ex47.m1.1.1.1.1.1.1.1.cmml"><mtext id="A0.Ex47.m1.1.1.1.1.1.1.1.3" xref="A0.Ex47.m1.1.1.1.1.1.1.1.3a.cmml">FFN</mtext><mo id="A0.Ex47.m1.1.1.1.1.1.1.1.2" xref="A0.Ex47.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐙</mi><mtext id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">enc</mtext></msup><mo id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A0.Ex47.m1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex47.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex47.m1.1b"><apply id="A0.Ex47.m1.1.1.cmml" xref="A0.Ex47.m1.1.1"><ci id="A0.Ex47.m1.1.1.2.cmml" xref="A0.Ex47.m1.1.1.2">←</ci><apply id="A0.Ex47.m1.1.1.3.cmml" xref="A0.Ex47.m1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex47.m1.1.1.3.1.cmml" xref="A0.Ex47.m1.1.1.3">superscript</csymbol><ci id="A0.Ex47.m1.1.1.3.2.cmml" xref="A0.Ex47.m1.1.1.3.2">𝐙</ci><ci id="A0.Ex47.m1.1.1.3.3a.cmml" xref="A0.Ex47.m1.1.1.3.3"><mtext id="A0.Ex47.m1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex47.m1.1.1.3.3">enc</mtext></ci></apply><apply id="A0.Ex47.m1.1.1.1.cmml" xref="A0.Ex47.m1.1.1.1"><times id="A0.Ex47.m1.1.1.1.2.cmml" xref="A0.Ex47.m1.1.1.1.2"></times><ci id="A0.Ex47.m1.1.1.1.3a.cmml" xref="A0.Ex47.m1.1.1.1.3"><mtext id="A0.Ex47.m1.1.1.1.3.cmml" xref="A0.Ex47.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="A0.Ex47.m1.1.1.1.1.1.1.cmml" xref="A0.Ex47.m1.1.1.1.1.1"><plus id="A0.Ex47.m1.1.1.1.1.1.1.2.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.2"></plus><apply id="A0.Ex47.m1.1.1.1.1.1.1.3.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex47.m1.1.1.1.1.1.1.3.1.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A0.Ex47.m1.1.1.1.1.1.1.3.2.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.3.2">𝐙</ci><ci id="A0.Ex47.m1.1.1.1.1.1.1.3.3a.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.3.3"><mtext id="A0.Ex47.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex47.m1.1.1.1.1.1.1.3.3">enc</mtext></ci></apply><apply id="A0.Ex47.m1.1.1.1.1.1.1.1.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1"><times id="A0.Ex47.m1.1.1.1.1.1.1.1.2.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.2"></times><ci id="A0.Ex47.m1.1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.3"><mtext id="A0.Ex47.m1.1.1.1.1.1.1.1.3.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.3">FFN</mtext></ci><apply id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.2">𝐙</ci><ci id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="A0.Ex47.m1.1.1.1.1.1.1.1.1.1.1.3">enc</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex47.m1.1c">\mathbf{Z}^{\text{enc}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{enc}}+%
\text{FFN}(\mathbf{Z}^{\text{enc}}))</annotation><annotation encoding="application/x-llamapun" id="A0.Ex47.m1.1d">bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ← LayerNorm ( bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT + FFN ( bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>Encoder output: <math alttext="\mathbf{H}^{\text{enc}}=\mathbf{Z}^{\text{enc}}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msup id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">𝐇</mi><mtext id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3a.cmml">enc</mtext></msup><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">=</mo><msup id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">𝐙</mi><mtext id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3a.cmml">enc</mtext></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></eq><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝐇</ci><ci id="alg1.l10.m1.1.1.2.3a.cmml" xref="alg1.l10.m1.1.1.2.3"><mtext id="alg1.l10.m1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l10.m1.1.1.2.3">enc</mtext></ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">superscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝐙</ci><ci id="alg1.l10.m1.1.1.3.3a.cmml" xref="alg1.l10.m1.1.1.3.3"><mtext id="alg1.l10.m1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l10.m1.1.1.3.3">enc</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathbf{H}^{\text{enc}}=\mathbf{Z}^{\text{enc}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l11.2">Step 3: Decoder Input Construction and Projection</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>Repeat the final time step <math alttext="H" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_H</annotation></semantics></math> times:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex48">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}^{\text{rep}}=\text{Repeat}(\mathbf{x}_{:,-1,:},H)\in\mathbb{R}^{B%
\times H\times 1}" class="ltx_Math" display="block" id="A0.Ex48.m1.5"><semantics id="A0.Ex48.m1.5a"><mrow id="A0.Ex48.m1.5.5" xref="A0.Ex48.m1.5.5.cmml"><msup id="A0.Ex48.m1.5.5.3" xref="A0.Ex48.m1.5.5.3.cmml"><mi id="A0.Ex48.m1.5.5.3.2" xref="A0.Ex48.m1.5.5.3.2.cmml">𝐱</mi><mtext id="A0.Ex48.m1.5.5.3.3" xref="A0.Ex48.m1.5.5.3.3a.cmml">rep</mtext></msup><mo id="A0.Ex48.m1.5.5.4" xref="A0.Ex48.m1.5.5.4.cmml">=</mo><mrow id="A0.Ex48.m1.5.5.1" xref="A0.Ex48.m1.5.5.1.cmml"><mtext id="A0.Ex48.m1.5.5.1.3" xref="A0.Ex48.m1.5.5.1.3a.cmml">Repeat</mtext><mo id="A0.Ex48.m1.5.5.1.2" xref="A0.Ex48.m1.5.5.1.2.cmml">⁢</mo><mrow id="A0.Ex48.m1.5.5.1.1.1" xref="A0.Ex48.m1.5.5.1.1.2.cmml"><mo id="A0.Ex48.m1.5.5.1.1.1.2" stretchy="false" xref="A0.Ex48.m1.5.5.1.1.2.cmml">(</mo><msub id="A0.Ex48.m1.5.5.1.1.1.1" xref="A0.Ex48.m1.5.5.1.1.1.1.cmml"><mi id="A0.Ex48.m1.5.5.1.1.1.1.2" xref="A0.Ex48.m1.5.5.1.1.1.1.2.cmml">𝐱</mi><mrow id="A0.Ex48.m1.3.3.3.3" xref="A0.Ex48.m1.3.3.3.4.cmml"><mo id="A0.Ex48.m1.1.1.1.1" rspace="0em" xref="A0.Ex48.m1.1.1.1.1.cmml">:</mo><mo id="A0.Ex48.m1.3.3.3.3.2" xref="A0.Ex48.m1.3.3.3.4.cmml">,</mo><mrow id="A0.Ex48.m1.3.3.3.3.1" xref="A0.Ex48.m1.3.3.3.3.1.cmml"><mo id="A0.Ex48.m1.3.3.3.3.1a" xref="A0.Ex48.m1.3.3.3.3.1.cmml">−</mo><mn id="A0.Ex48.m1.3.3.3.3.1.2" xref="A0.Ex48.m1.3.3.3.3.1.2.cmml">1</mn></mrow><mo id="A0.Ex48.m1.3.3.3.3.3" xref="A0.Ex48.m1.3.3.3.4.cmml">,</mo><mo id="A0.Ex48.m1.2.2.2.2" xref="A0.Ex48.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="A0.Ex48.m1.5.5.1.1.1.3" xref="A0.Ex48.m1.5.5.1.1.2.cmml">,</mo><mi id="A0.Ex48.m1.4.4" xref="A0.Ex48.m1.4.4.cmml">H</mi><mo id="A0.Ex48.m1.5.5.1.1.1.4" stretchy="false" xref="A0.Ex48.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A0.Ex48.m1.5.5.5" xref="A0.Ex48.m1.5.5.5.cmml">∈</mo><msup id="A0.Ex48.m1.5.5.6" xref="A0.Ex48.m1.5.5.6.cmml"><mi id="A0.Ex48.m1.5.5.6.2" xref="A0.Ex48.m1.5.5.6.2.cmml">ℝ</mi><mrow id="A0.Ex48.m1.5.5.6.3" xref="A0.Ex48.m1.5.5.6.3.cmml"><mi id="A0.Ex48.m1.5.5.6.3.2" xref="A0.Ex48.m1.5.5.6.3.2.cmml">B</mi><mo id="A0.Ex48.m1.5.5.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex48.m1.5.5.6.3.1.cmml">×</mo><mi id="A0.Ex48.m1.5.5.6.3.3" xref="A0.Ex48.m1.5.5.6.3.3.cmml">H</mi><mo id="A0.Ex48.m1.5.5.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex48.m1.5.5.6.3.1.cmml">×</mo><mn id="A0.Ex48.m1.5.5.6.3.4" xref="A0.Ex48.m1.5.5.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex48.m1.5b"><apply id="A0.Ex48.m1.5.5.cmml" xref="A0.Ex48.m1.5.5"><and id="A0.Ex48.m1.5.5a.cmml" xref="A0.Ex48.m1.5.5"></and><apply id="A0.Ex48.m1.5.5b.cmml" xref="A0.Ex48.m1.5.5"><eq id="A0.Ex48.m1.5.5.4.cmml" xref="A0.Ex48.m1.5.5.4"></eq><apply id="A0.Ex48.m1.5.5.3.cmml" xref="A0.Ex48.m1.5.5.3"><csymbol cd="ambiguous" id="A0.Ex48.m1.5.5.3.1.cmml" xref="A0.Ex48.m1.5.5.3">superscript</csymbol><ci id="A0.Ex48.m1.5.5.3.2.cmml" xref="A0.Ex48.m1.5.5.3.2">𝐱</ci><ci id="A0.Ex48.m1.5.5.3.3a.cmml" xref="A0.Ex48.m1.5.5.3.3"><mtext id="A0.Ex48.m1.5.5.3.3.cmml" mathsize="70%" xref="A0.Ex48.m1.5.5.3.3">rep</mtext></ci></apply><apply id="A0.Ex48.m1.5.5.1.cmml" xref="A0.Ex48.m1.5.5.1"><times id="A0.Ex48.m1.5.5.1.2.cmml" xref="A0.Ex48.m1.5.5.1.2"></times><ci id="A0.Ex48.m1.5.5.1.3a.cmml" xref="A0.Ex48.m1.5.5.1.3"><mtext id="A0.Ex48.m1.5.5.1.3.cmml" xref="A0.Ex48.m1.5.5.1.3">Repeat</mtext></ci><interval closure="open" id="A0.Ex48.m1.5.5.1.1.2.cmml" xref="A0.Ex48.m1.5.5.1.1.1"><apply id="A0.Ex48.m1.5.5.1.1.1.1.cmml" xref="A0.Ex48.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex48.m1.5.5.1.1.1.1.1.cmml" xref="A0.Ex48.m1.5.5.1.1.1.1">subscript</csymbol><ci id="A0.Ex48.m1.5.5.1.1.1.1.2.cmml" xref="A0.Ex48.m1.5.5.1.1.1.1.2">𝐱</ci><list id="A0.Ex48.m1.3.3.3.4.cmml" xref="A0.Ex48.m1.3.3.3.3"><ci id="A0.Ex48.m1.1.1.1.1.cmml" xref="A0.Ex48.m1.1.1.1.1">:</ci><apply id="A0.Ex48.m1.3.3.3.3.1.cmml" xref="A0.Ex48.m1.3.3.3.3.1"><minus id="A0.Ex48.m1.3.3.3.3.1.1.cmml" xref="A0.Ex48.m1.3.3.3.3.1"></minus><cn id="A0.Ex48.m1.3.3.3.3.1.2.cmml" type="integer" xref="A0.Ex48.m1.3.3.3.3.1.2">1</cn></apply><ci id="A0.Ex48.m1.2.2.2.2.cmml" xref="A0.Ex48.m1.2.2.2.2">:</ci></list></apply><ci id="A0.Ex48.m1.4.4.cmml" xref="A0.Ex48.m1.4.4">𝐻</ci></interval></apply></apply><apply id="A0.Ex48.m1.5.5c.cmml" xref="A0.Ex48.m1.5.5"><in id="A0.Ex48.m1.5.5.5.cmml" xref="A0.Ex48.m1.5.5.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex48.m1.5.5.1.cmml" id="A0.Ex48.m1.5.5d.cmml" xref="A0.Ex48.m1.5.5"></share><apply id="A0.Ex48.m1.5.5.6.cmml" xref="A0.Ex48.m1.5.5.6"><csymbol cd="ambiguous" id="A0.Ex48.m1.5.5.6.1.cmml" xref="A0.Ex48.m1.5.5.6">superscript</csymbol><ci id="A0.Ex48.m1.5.5.6.2.cmml" xref="A0.Ex48.m1.5.5.6.2">ℝ</ci><apply id="A0.Ex48.m1.5.5.6.3.cmml" xref="A0.Ex48.m1.5.5.6.3"><times id="A0.Ex48.m1.5.5.6.3.1.cmml" xref="A0.Ex48.m1.5.5.6.3.1"></times><ci id="A0.Ex48.m1.5.5.6.3.2.cmml" xref="A0.Ex48.m1.5.5.6.3.2">𝐵</ci><ci id="A0.Ex48.m1.5.5.6.3.3.cmml" xref="A0.Ex48.m1.5.5.6.3.3">𝐻</ci><cn id="A0.Ex48.m1.5.5.6.3.4.cmml" type="integer" xref="A0.Ex48.m1.5.5.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex48.m1.5c">\mathbf{x}^{\text{rep}}=\text{Repeat}(\mathbf{x}_{:,-1,:},H)\in\mathbb{R}^{B%
\times H\times 1}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex48.m1.5d">bold_x start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT = Repeat ( bold_x start_POSTSUBSCRIPT : , - 1 , : end_POSTSUBSCRIPT , italic_H ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>Project and encode with positional embedding:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex49">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}=\mathbf{x}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text%
{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex49.m1.2"><semantics id="A0.Ex49.m1.2a"><mrow id="A0.Ex49.m1.2.3" xref="A0.Ex49.m1.2.3.cmml"><msup id="A0.Ex49.m1.2.3.2" xref="A0.Ex49.m1.2.3.2.cmml"><mi id="A0.Ex49.m1.2.3.2.2" xref="A0.Ex49.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex49.m1.2.3.2.3" xref="A0.Ex49.m1.2.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex49.m1.2.3.3" xref="A0.Ex49.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex49.m1.2.3.4" xref="A0.Ex49.m1.2.3.4.cmml"><mrow id="A0.Ex49.m1.2.3.4.2" xref="A0.Ex49.m1.2.3.4.2.cmml"><msup id="A0.Ex49.m1.2.3.4.2.2" xref="A0.Ex49.m1.2.3.4.2.2.cmml"><mi id="A0.Ex49.m1.2.3.4.2.2.2" xref="A0.Ex49.m1.2.3.4.2.2.2.cmml">𝐱</mi><mtext id="A0.Ex49.m1.2.3.4.2.2.3" xref="A0.Ex49.m1.2.3.4.2.2.3a.cmml">rep</mtext></msup><mo id="A0.Ex49.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex49.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex49.m1.2.3.4.2.3" xref="A0.Ex49.m1.2.3.4.2.3.cmml"><mi id="A0.Ex49.m1.2.3.4.2.3.2.2" xref="A0.Ex49.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex49.m1.2.3.4.2.3.2.3" xref="A0.Ex49.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex49.m1.1.1.1.3" xref="A0.Ex49.m1.2.3.4.2.3.cmml"><mo id="A0.Ex49.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex49.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex49.m1.1.1.1.1" xref="A0.Ex49.m1.1.1.1.1.cmml">d</mi><mo id="A0.Ex49.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex49.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex49.m1.2.3.4.1" xref="A0.Ex49.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex49.m1.2.3.4.3" xref="A0.Ex49.m1.2.3.4.3.cmml"><mtext id="A0.Ex49.m1.2.3.4.3.2" xref="A0.Ex49.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex49.m1.2.2.1.3" xref="A0.Ex49.m1.2.3.4.3.cmml"><mo id="A0.Ex49.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex49.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex49.m1.2.2.1.1" xref="A0.Ex49.m1.2.2.1.1.cmml">d</mi><mo id="A0.Ex49.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex49.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex49.m1.2.3.5" xref="A0.Ex49.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex49.m1.2.3.6" xref="A0.Ex49.m1.2.3.6.cmml"><mi id="A0.Ex49.m1.2.3.6.2" xref="A0.Ex49.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex49.m1.2.3.6.3" xref="A0.Ex49.m1.2.3.6.3.cmml"><mi id="A0.Ex49.m1.2.3.6.3.2" xref="A0.Ex49.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex49.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex49.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex49.m1.2.3.6.3.3" xref="A0.Ex49.m1.2.3.6.3.3.cmml">H</mi><mo id="A0.Ex49.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex49.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex49.m1.2.3.6.3.4" xref="A0.Ex49.m1.2.3.6.3.4.cmml"><mi id="A0.Ex49.m1.2.3.6.3.4.2" xref="A0.Ex49.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex49.m1.2.3.6.3.4.3" xref="A0.Ex49.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex49.m1.2b"><apply id="A0.Ex49.m1.2.3.cmml" xref="A0.Ex49.m1.2.3"><and id="A0.Ex49.m1.2.3a.cmml" xref="A0.Ex49.m1.2.3"></and><apply id="A0.Ex49.m1.2.3b.cmml" xref="A0.Ex49.m1.2.3"><eq id="A0.Ex49.m1.2.3.3.cmml" xref="A0.Ex49.m1.2.3.3"></eq><apply id="A0.Ex49.m1.2.3.2.cmml" xref="A0.Ex49.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.2.1.cmml" xref="A0.Ex49.m1.2.3.2">superscript</csymbol><ci id="A0.Ex49.m1.2.3.2.2.cmml" xref="A0.Ex49.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex49.m1.2.3.2.3a.cmml" xref="A0.Ex49.m1.2.3.2.3"><mtext id="A0.Ex49.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex49.m1.2.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex49.m1.2.3.4.cmml" xref="A0.Ex49.m1.2.3.4"><plus id="A0.Ex49.m1.2.3.4.1.cmml" xref="A0.Ex49.m1.2.3.4.1"></plus><apply id="A0.Ex49.m1.2.3.4.2.cmml" xref="A0.Ex49.m1.2.3.4.2"><ci id="A0.Ex49.m1.2.3.4.2.1.cmml" xref="A0.Ex49.m1.2.3.4.2.1">⋅</ci><apply id="A0.Ex49.m1.2.3.4.2.2.cmml" xref="A0.Ex49.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.4.2.2.1.cmml" xref="A0.Ex49.m1.2.3.4.2.2">superscript</csymbol><ci id="A0.Ex49.m1.2.3.4.2.2.2.cmml" xref="A0.Ex49.m1.2.3.4.2.2.2">𝐱</ci><ci id="A0.Ex49.m1.2.3.4.2.2.3a.cmml" xref="A0.Ex49.m1.2.3.4.2.2.3"><mtext id="A0.Ex49.m1.2.3.4.2.2.3.cmml" mathsize="70%" xref="A0.Ex49.m1.2.3.4.2.2.3">rep</mtext></ci></apply><apply id="A0.Ex49.m1.2.3.4.2.3.cmml" xref="A0.Ex49.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.4.2.3.1.cmml" xref="A0.Ex49.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex49.m1.2.3.4.2.3.2.cmml" xref="A0.Ex49.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex49.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex49.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex49.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex49.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex49.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex49.m1.1.1.1.1.cmml" xref="A0.Ex49.m1.1.1.1.1">𝑑</ci></apply></apply><apply id="A0.Ex49.m1.2.3.4.3.cmml" xref="A0.Ex49.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.4.3.1.cmml" xref="A0.Ex49.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex49.m1.2.3.4.3.2a.cmml" xref="A0.Ex49.m1.2.3.4.3.2"><mtext id="A0.Ex49.m1.2.3.4.3.2.cmml" xref="A0.Ex49.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex49.m1.2.2.1.1.cmml" xref="A0.Ex49.m1.2.2.1.1">𝑑</ci></apply></apply></apply><apply id="A0.Ex49.m1.2.3c.cmml" xref="A0.Ex49.m1.2.3"><in id="A0.Ex49.m1.2.3.5.cmml" xref="A0.Ex49.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex49.m1.2.3.4.cmml" id="A0.Ex49.m1.2.3d.cmml" xref="A0.Ex49.m1.2.3"></share><apply id="A0.Ex49.m1.2.3.6.cmml" xref="A0.Ex49.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.6.1.cmml" xref="A0.Ex49.m1.2.3.6">superscript</csymbol><ci id="A0.Ex49.m1.2.3.6.2.cmml" xref="A0.Ex49.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex49.m1.2.3.6.3.cmml" xref="A0.Ex49.m1.2.3.6.3"><times id="A0.Ex49.m1.2.3.6.3.1.cmml" xref="A0.Ex49.m1.2.3.6.3.1"></times><ci id="A0.Ex49.m1.2.3.6.3.2.cmml" xref="A0.Ex49.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex49.m1.2.3.6.3.3.cmml" xref="A0.Ex49.m1.2.3.6.3.3">𝐻</ci><apply id="A0.Ex49.m1.2.3.6.3.4.cmml" xref="A0.Ex49.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex49.m1.2.3.6.3.4.1.cmml" xref="A0.Ex49.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex49.m1.2.3.6.3.4.2.cmml" xref="A0.Ex49.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex49.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex49.m1.2.3.6.3.4.3"><mtext id="A0.Ex49.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex49.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex49.m1.2c">\mathbf{Z}^{\text{dec}}=\mathbf{x}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text%
{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex49.m1.2d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT = bold_x start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l14.2">Step 4: Transformer Decoder Layer</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>Compute self-attention on decoder input:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex50">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\quad K=\mathbf{Z}^{\text{dec%
}}\cdot\mathbf{W}^{K_{d}},\quad V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{V_{d}}" class="ltx_Math" display="block" id="A0.Ex50.m1.2"><semantics id="A0.Ex50.m1.2a"><mrow id="A0.Ex50.m1.2.2.2" xref="A0.Ex50.m1.2.2.3.cmml"><mrow id="A0.Ex50.m1.1.1.1.1" xref="A0.Ex50.m1.1.1.1.1.cmml"><mi id="A0.Ex50.m1.1.1.1.1.2" xref="A0.Ex50.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex50.m1.1.1.1.1.1" xref="A0.Ex50.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex50.m1.1.1.1.1.3" xref="A0.Ex50.m1.1.1.1.1.3.cmml"><msup id="A0.Ex50.m1.1.1.1.1.3.2" xref="A0.Ex50.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex50.m1.1.1.1.1.3.2.2" xref="A0.Ex50.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex50.m1.1.1.1.1.3.2.3" xref="A0.Ex50.m1.1.1.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex50.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex50.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex50.m1.1.1.1.1.3.3" xref="A0.Ex50.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex50.m1.1.1.1.1.3.3.2" xref="A0.Ex50.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex50.m1.1.1.1.1.3.3.3" xref="A0.Ex50.m1.1.1.1.1.3.3.3.cmml"><mi id="A0.Ex50.m1.1.1.1.1.3.3.3.2" xref="A0.Ex50.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="A0.Ex50.m1.1.1.1.1.3.3.3.3" xref="A0.Ex50.m1.1.1.1.1.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow><mo id="A0.Ex50.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex50.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex50.m1.2.2.2.2.2" xref="A0.Ex50.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex50.m1.2.2.2.2.1.1" xref="A0.Ex50.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex50.m1.2.2.2.2.1.1.2" xref="A0.Ex50.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex50.m1.2.2.2.2.1.1.1" xref="A0.Ex50.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex50.m1.2.2.2.2.1.1.3" xref="A0.Ex50.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex50.m1.2.2.2.2.1.1.3.2" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex50.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex50.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex50.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex50.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex50.m1.2.2.2.2.1.1.3.3" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex50.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.2" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.2.cmml">K</mi><mi id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.3" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow><mo id="A0.Ex50.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex50.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex50.m1.2.2.2.2.2.2" xref="A0.Ex50.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex50.m1.2.2.2.2.2.2.2" xref="A0.Ex50.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex50.m1.2.2.2.2.2.2.1" xref="A0.Ex50.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex50.m1.2.2.2.2.2.2.3" xref="A0.Ex50.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex50.m1.2.2.2.2.2.2.3.2" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex50.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex50.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex50.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex50.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex50.m1.2.2.2.2.2.2.3.3" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex50.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><msub id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.2" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.2.cmml">V</mi><mi id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.3" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex50.m1.2b"><apply id="A0.Ex50.m1.2.2.3.cmml" xref="A0.Ex50.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.3a.cmml" xref="A0.Ex50.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex50.m1.1.1.1.1.cmml" xref="A0.Ex50.m1.1.1.1.1"><eq id="A0.Ex50.m1.1.1.1.1.1.cmml" xref="A0.Ex50.m1.1.1.1.1.1"></eq><ci id="A0.Ex50.m1.1.1.1.1.2.cmml" xref="A0.Ex50.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex50.m1.1.1.1.1.3.cmml" xref="A0.Ex50.m1.1.1.1.1.3"><ci id="A0.Ex50.m1.1.1.1.1.3.1.cmml" xref="A0.Ex50.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex50.m1.1.1.1.1.3.2.cmml" xref="A0.Ex50.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex50.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex50.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex50.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex50.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex50.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex50.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex50.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex50.m1.1.1.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex50.m1.1.1.1.1.3.3.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex50.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3.2">𝐖</ci><apply id="A0.Ex50.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.1.1.1.1.3.3.3.1.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex50.m1.1.1.1.1.3.3.3.2.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="A0.Ex50.m1.1.1.1.1.3.3.3.3.cmml" xref="A0.Ex50.m1.1.1.1.1.3.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A0.Ex50.m1.2.2.2.2.3.cmml" xref="A0.Ex50.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.3a.cmml" xref="A0.Ex50.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex50.m1.2.2.2.2.1.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1"><eq id="A0.Ex50.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex50.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex50.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3"><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex50.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.2">𝐙</ci><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex50.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex50.m1.2.2.2.2.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex50.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><apply id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.2">𝐾</ci><ci id="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.1.1.3.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A0.Ex50.m1.2.2.2.2.2.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2"><eq id="A0.Ex50.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex50.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex50.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3"><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex50.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.2">𝐙</ci><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex50.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex50.m1.2.2.2.2.2.2.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex50.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><apply id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.2">𝑉</ci><ci id="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="A0.Ex50.m1.2.2.2.2.2.2.3.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex50.m1.2c">Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\quad K=\mathbf{Z}^{\text{dec%
}}\cdot\mathbf{W}^{K_{d}},\quad V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{V_{d}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex50.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_K = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_V = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex51">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SelfAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V" class="ltx_Math" display="block" id="A0.Ex51.m1.1"><semantics id="A0.Ex51.m1.1a"><mrow id="A0.Ex51.m1.1.2" xref="A0.Ex51.m1.1.2.cmml"><mtext id="A0.Ex51.m1.1.2.2" xref="A0.Ex51.m1.1.2.2a.cmml">SelfAttn</mtext><mo id="A0.Ex51.m1.1.2.1" xref="A0.Ex51.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex51.m1.1.2.3" xref="A0.Ex51.m1.1.2.3.cmml"><mtext id="A0.Ex51.m1.1.2.3.2" xref="A0.Ex51.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex51.m1.1.2.3.1" xref="A0.Ex51.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex51.m1.1.2.3.3.2" xref="A0.Ex51.m1.1.1.cmml"><mo id="A0.Ex51.m1.1.2.3.3.2.1" xref="A0.Ex51.m1.1.1.cmml">(</mo><mfrac id="A0.Ex51.m1.1.1" xref="A0.Ex51.m1.1.1.cmml"><mrow id="A0.Ex51.m1.1.1.2" xref="A0.Ex51.m1.1.1.2.cmml"><mi id="A0.Ex51.m1.1.1.2.2" xref="A0.Ex51.m1.1.1.2.2.cmml">Q</mi><mo id="A0.Ex51.m1.1.1.2.1" xref="A0.Ex51.m1.1.1.2.1.cmml">⁢</mo><msup id="A0.Ex51.m1.1.1.2.3" xref="A0.Ex51.m1.1.1.2.3.cmml"><mi id="A0.Ex51.m1.1.1.2.3.2" xref="A0.Ex51.m1.1.1.2.3.2.cmml">K</mi><mo id="A0.Ex51.m1.1.1.2.3.3" xref="A0.Ex51.m1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex51.m1.1.1.3" xref="A0.Ex51.m1.1.1.3.cmml"><msub id="A0.Ex51.m1.1.1.3.2" xref="A0.Ex51.m1.1.1.3.2.cmml"><mi id="A0.Ex51.m1.1.1.3.2.2" xref="A0.Ex51.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex51.m1.1.1.3.2.3" xref="A0.Ex51.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex51.m1.1.2.3.3.2.2" xref="A0.Ex51.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex51.m1.1.2.3.1a" xref="A0.Ex51.m1.1.2.3.1.cmml">⁢</mo><mi id="A0.Ex51.m1.1.2.3.4" xref="A0.Ex51.m1.1.2.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex51.m1.1b"><apply id="A0.Ex51.m1.1.2.cmml" xref="A0.Ex51.m1.1.2"><eq id="A0.Ex51.m1.1.2.1.cmml" xref="A0.Ex51.m1.1.2.1"></eq><ci id="A0.Ex51.m1.1.2.2a.cmml" xref="A0.Ex51.m1.1.2.2"><mtext id="A0.Ex51.m1.1.2.2.cmml" xref="A0.Ex51.m1.1.2.2">SelfAttn</mtext></ci><apply id="A0.Ex51.m1.1.2.3.cmml" xref="A0.Ex51.m1.1.2.3"><times id="A0.Ex51.m1.1.2.3.1.cmml" xref="A0.Ex51.m1.1.2.3.1"></times><ci id="A0.Ex51.m1.1.2.3.2a.cmml" xref="A0.Ex51.m1.1.2.3.2"><mtext id="A0.Ex51.m1.1.2.3.2.cmml" xref="A0.Ex51.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex51.m1.1.1.cmml" xref="A0.Ex51.m1.1.2.3.3.2"><divide id="A0.Ex51.m1.1.1.1.cmml" xref="A0.Ex51.m1.1.2.3.3.2"></divide><apply id="A0.Ex51.m1.1.1.2.cmml" xref="A0.Ex51.m1.1.1.2"><times id="A0.Ex51.m1.1.1.2.1.cmml" xref="A0.Ex51.m1.1.1.2.1"></times><ci id="A0.Ex51.m1.1.1.2.2.cmml" xref="A0.Ex51.m1.1.1.2.2">𝑄</ci><apply id="A0.Ex51.m1.1.1.2.3.cmml" xref="A0.Ex51.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex51.m1.1.1.2.3.1.cmml" xref="A0.Ex51.m1.1.1.2.3">superscript</csymbol><ci id="A0.Ex51.m1.1.1.2.3.2.cmml" xref="A0.Ex51.m1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex51.m1.1.1.2.3.3.cmml" xref="A0.Ex51.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex51.m1.1.1.3.cmml" xref="A0.Ex51.m1.1.1.3"><root id="A0.Ex51.m1.1.1.3a.cmml" xref="A0.Ex51.m1.1.1.3"></root><apply id="A0.Ex51.m1.1.1.3.2.cmml" xref="A0.Ex51.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex51.m1.1.1.3.2.1.cmml" xref="A0.Ex51.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex51.m1.1.1.3.2.2.cmml" xref="A0.Ex51.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex51.m1.1.1.3.2.3a.cmml" xref="A0.Ex51.m1.1.1.3.2.3"><mtext id="A0.Ex51.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex51.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex51.m1.1.2.3.4.cmml" xref="A0.Ex51.m1.1.2.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex51.m1.1c">\text{SelfAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex51.m1.1d">SelfAttn = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>Compute encoder-decoder cross-attention:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex52">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}" class="ltx_Math" display="block" id="A0.Ex52.m1.2"><semantics id="A0.Ex52.m1.2a"><mrow id="A0.Ex52.m1.2.2.2" xref="A0.Ex52.m1.2.2.3.cmml"><mrow id="A0.Ex52.m1.1.1.1.1" xref="A0.Ex52.m1.1.1.1.1.cmml"><mi id="A0.Ex52.m1.1.1.1.1.2" xref="A0.Ex52.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex52.m1.1.1.1.1.1" xref="A0.Ex52.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex52.m1.1.1.1.1.3" xref="A0.Ex52.m1.1.1.1.1.3.cmml"><msup id="A0.Ex52.m1.1.1.1.1.3.2" xref="A0.Ex52.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex52.m1.1.1.1.1.3.2.2" xref="A0.Ex52.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex52.m1.1.1.1.1.3.2.3" xref="A0.Ex52.m1.1.1.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex52.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex52.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex52.m1.1.1.1.1.3.3" xref="A0.Ex52.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex52.m1.1.1.1.1.3.3.2" xref="A0.Ex52.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex52.m1.1.1.1.1.3.3.3" xref="A0.Ex52.m1.1.1.1.1.3.3.3.cmml"><mi id="A0.Ex52.m1.1.1.1.1.3.3.3.2" xref="A0.Ex52.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="A0.Ex52.m1.1.1.1.1.3.3.3.3" xref="A0.Ex52.m1.1.1.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex52.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex52.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex52.m1.2.2.2.2.2" xref="A0.Ex52.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex52.m1.2.2.2.2.1.1" xref="A0.Ex52.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex52.m1.2.2.2.2.1.1.2" xref="A0.Ex52.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex52.m1.2.2.2.2.1.1.1" xref="A0.Ex52.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex52.m1.2.2.2.2.1.1.3" xref="A0.Ex52.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex52.m1.2.2.2.2.1.1.3.2" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex52.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex52.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex52.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex52.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex52.m1.2.2.2.2.1.1.3.3" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex52.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.2" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.2.cmml">K</mi><mi id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.3" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex52.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex52.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex52.m1.2.2.2.2.2.2" xref="A0.Ex52.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex52.m1.2.2.2.2.2.2.2" xref="A0.Ex52.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex52.m1.2.2.2.2.2.2.1" xref="A0.Ex52.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex52.m1.2.2.2.2.2.2.3" xref="A0.Ex52.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex52.m1.2.2.2.2.2.2.3.2" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex52.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex52.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex52.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex52.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex52.m1.2.2.2.2.2.2.3.3" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex52.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><msub id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.2" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.2.cmml">V</mi><mi id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.3" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex52.m1.2b"><apply id="A0.Ex52.m1.2.2.3.cmml" xref="A0.Ex52.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.3a.cmml" xref="A0.Ex52.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex52.m1.1.1.1.1.cmml" xref="A0.Ex52.m1.1.1.1.1"><eq id="A0.Ex52.m1.1.1.1.1.1.cmml" xref="A0.Ex52.m1.1.1.1.1.1"></eq><ci id="A0.Ex52.m1.1.1.1.1.2.cmml" xref="A0.Ex52.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex52.m1.1.1.1.1.3.cmml" xref="A0.Ex52.m1.1.1.1.1.3"><ci id="A0.Ex52.m1.1.1.1.1.3.1.cmml" xref="A0.Ex52.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex52.m1.1.1.1.1.3.2.cmml" xref="A0.Ex52.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex52.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex52.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex52.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex52.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex52.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex52.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex52.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex52.m1.1.1.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex52.m1.1.1.1.1.3.3.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex52.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3.2">𝐖</ci><apply id="A0.Ex52.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.1.1.1.1.3.3.3.1.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex52.m1.1.1.1.1.3.3.3.2.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="A0.Ex52.m1.1.1.1.1.3.3.3.3.cmml" xref="A0.Ex52.m1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex52.m1.2.2.2.2.3.cmml" xref="A0.Ex52.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.3a.cmml" xref="A0.Ex52.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex52.m1.2.2.2.2.1.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1"><eq id="A0.Ex52.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex52.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex52.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3"><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex52.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.2">𝐇</ci><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex52.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex52.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex52.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><apply id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.2">𝐾</ci><ci id="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex52.m1.2.2.2.2.2.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2"><eq id="A0.Ex52.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex52.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex52.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3"><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex52.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.2">𝐇</ci><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex52.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex52.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex52.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><apply id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.2">𝑉</ci><ci id="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="A0.Ex52.m1.2.2.2.2.2.2.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex52.m1.2c">Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex52.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_K = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_V = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex53">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V" class="ltx_Math" display="block" id="A0.Ex53.m1.1"><semantics id="A0.Ex53.m1.1a"><mrow id="A0.Ex53.m1.1.2" xref="A0.Ex53.m1.1.2.cmml"><mtext id="A0.Ex53.m1.1.2.2" xref="A0.Ex53.m1.1.2.2a.cmml">CrossAttn</mtext><mo id="A0.Ex53.m1.1.2.1" xref="A0.Ex53.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex53.m1.1.2.3" xref="A0.Ex53.m1.1.2.3.cmml"><mtext id="A0.Ex53.m1.1.2.3.2" xref="A0.Ex53.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex53.m1.1.2.3.1" xref="A0.Ex53.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex53.m1.1.2.3.3.2" xref="A0.Ex53.m1.1.1.cmml"><mo id="A0.Ex53.m1.1.2.3.3.2.1" xref="A0.Ex53.m1.1.1.cmml">(</mo><mfrac id="A0.Ex53.m1.1.1" xref="A0.Ex53.m1.1.1.cmml"><mrow id="A0.Ex53.m1.1.1.2" xref="A0.Ex53.m1.1.1.2.cmml"><mi id="A0.Ex53.m1.1.1.2.2" xref="A0.Ex53.m1.1.1.2.2.cmml">Q</mi><mo id="A0.Ex53.m1.1.1.2.1" xref="A0.Ex53.m1.1.1.2.1.cmml">⁢</mo><msup id="A0.Ex53.m1.1.1.2.3" xref="A0.Ex53.m1.1.1.2.3.cmml"><mi id="A0.Ex53.m1.1.1.2.3.2" xref="A0.Ex53.m1.1.1.2.3.2.cmml">K</mi><mo id="A0.Ex53.m1.1.1.2.3.3" xref="A0.Ex53.m1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex53.m1.1.1.3" xref="A0.Ex53.m1.1.1.3.cmml"><msub id="A0.Ex53.m1.1.1.3.2" xref="A0.Ex53.m1.1.1.3.2.cmml"><mi id="A0.Ex53.m1.1.1.3.2.2" xref="A0.Ex53.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex53.m1.1.1.3.2.3" xref="A0.Ex53.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex53.m1.1.2.3.3.2.2" xref="A0.Ex53.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex53.m1.1.2.3.1a" xref="A0.Ex53.m1.1.2.3.1.cmml">⁢</mo><mi id="A0.Ex53.m1.1.2.3.4" xref="A0.Ex53.m1.1.2.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex53.m1.1b"><apply id="A0.Ex53.m1.1.2.cmml" xref="A0.Ex53.m1.1.2"><eq id="A0.Ex53.m1.1.2.1.cmml" xref="A0.Ex53.m1.1.2.1"></eq><ci id="A0.Ex53.m1.1.2.2a.cmml" xref="A0.Ex53.m1.1.2.2"><mtext id="A0.Ex53.m1.1.2.2.cmml" xref="A0.Ex53.m1.1.2.2">CrossAttn</mtext></ci><apply id="A0.Ex53.m1.1.2.3.cmml" xref="A0.Ex53.m1.1.2.3"><times id="A0.Ex53.m1.1.2.3.1.cmml" xref="A0.Ex53.m1.1.2.3.1"></times><ci id="A0.Ex53.m1.1.2.3.2a.cmml" xref="A0.Ex53.m1.1.2.3.2"><mtext id="A0.Ex53.m1.1.2.3.2.cmml" xref="A0.Ex53.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex53.m1.1.1.cmml" xref="A0.Ex53.m1.1.2.3.3.2"><divide id="A0.Ex53.m1.1.1.1.cmml" xref="A0.Ex53.m1.1.2.3.3.2"></divide><apply id="A0.Ex53.m1.1.1.2.cmml" xref="A0.Ex53.m1.1.1.2"><times id="A0.Ex53.m1.1.1.2.1.cmml" xref="A0.Ex53.m1.1.1.2.1"></times><ci id="A0.Ex53.m1.1.1.2.2.cmml" xref="A0.Ex53.m1.1.1.2.2">𝑄</ci><apply id="A0.Ex53.m1.1.1.2.3.cmml" xref="A0.Ex53.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex53.m1.1.1.2.3.1.cmml" xref="A0.Ex53.m1.1.1.2.3">superscript</csymbol><ci id="A0.Ex53.m1.1.1.2.3.2.cmml" xref="A0.Ex53.m1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex53.m1.1.1.2.3.3.cmml" xref="A0.Ex53.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex53.m1.1.1.3.cmml" xref="A0.Ex53.m1.1.1.3"><root id="A0.Ex53.m1.1.1.3a.cmml" xref="A0.Ex53.m1.1.1.3"></root><apply id="A0.Ex53.m1.1.1.3.2.cmml" xref="A0.Ex53.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex53.m1.1.1.3.2.1.cmml" xref="A0.Ex53.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex53.m1.1.1.3.2.2.cmml" xref="A0.Ex53.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex53.m1.1.1.3.2.3a.cmml" xref="A0.Ex53.m1.1.1.3.2.3"><mtext id="A0.Ex53.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex53.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex53.m1.1.2.3.4.cmml" xref="A0.Ex53.m1.1.2.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex53.m1.1c">\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex53.m1.1d">CrossAttn = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>Apply decoder residual blocks:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex54">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{SelfAttn})" class="ltx_Math" display="block" id="A0.Ex54.m1.1"><semantics id="A0.Ex54.m1.1a"><mrow id="A0.Ex54.m1.1.1" xref="A0.Ex54.m1.1.1.cmml"><msup id="A0.Ex54.m1.1.1.3" xref="A0.Ex54.m1.1.1.3.cmml"><mi id="A0.Ex54.m1.1.1.3.2" xref="A0.Ex54.m1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex54.m1.1.1.3.3" xref="A0.Ex54.m1.1.1.3.3a.cmml">dec</mtext></msup><mo id="A0.Ex54.m1.1.1.2" stretchy="false" xref="A0.Ex54.m1.1.1.2.cmml">←</mo><mrow id="A0.Ex54.m1.1.1.1" xref="A0.Ex54.m1.1.1.1.cmml"><mtext id="A0.Ex54.m1.1.1.1.3" xref="A0.Ex54.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="A0.Ex54.m1.1.1.1.2" xref="A0.Ex54.m1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex54.m1.1.1.1.1.1" xref="A0.Ex54.m1.1.1.1.1.1.1.cmml"><mo id="A0.Ex54.m1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex54.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A0.Ex54.m1.1.1.1.1.1.1" xref="A0.Ex54.m1.1.1.1.1.1.1.cmml"><msup id="A0.Ex54.m1.1.1.1.1.1.1.2" xref="A0.Ex54.m1.1.1.1.1.1.1.2.cmml"><mi id="A0.Ex54.m1.1.1.1.1.1.1.2.2" xref="A0.Ex54.m1.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mtext id="A0.Ex54.m1.1.1.1.1.1.1.2.3" xref="A0.Ex54.m1.1.1.1.1.1.1.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex54.m1.1.1.1.1.1.1.1" xref="A0.Ex54.m1.1.1.1.1.1.1.1.cmml">+</mo><mtext id="A0.Ex54.m1.1.1.1.1.1.1.3" xref="A0.Ex54.m1.1.1.1.1.1.1.3a.cmml">SelfAttn</mtext></mrow><mo id="A0.Ex54.m1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex54.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex54.m1.1b"><apply id="A0.Ex54.m1.1.1.cmml" xref="A0.Ex54.m1.1.1"><ci id="A0.Ex54.m1.1.1.2.cmml" xref="A0.Ex54.m1.1.1.2">←</ci><apply id="A0.Ex54.m1.1.1.3.cmml" xref="A0.Ex54.m1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex54.m1.1.1.3.1.cmml" xref="A0.Ex54.m1.1.1.3">superscript</csymbol><ci id="A0.Ex54.m1.1.1.3.2.cmml" xref="A0.Ex54.m1.1.1.3.2">𝐙</ci><ci id="A0.Ex54.m1.1.1.3.3a.cmml" xref="A0.Ex54.m1.1.1.3.3"><mtext id="A0.Ex54.m1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex54.m1.1.1.3.3">dec</mtext></ci></apply><apply id="A0.Ex54.m1.1.1.1.cmml" xref="A0.Ex54.m1.1.1.1"><times id="A0.Ex54.m1.1.1.1.2.cmml" xref="A0.Ex54.m1.1.1.1.2"></times><ci id="A0.Ex54.m1.1.1.1.3a.cmml" xref="A0.Ex54.m1.1.1.1.3"><mtext id="A0.Ex54.m1.1.1.1.3.cmml" xref="A0.Ex54.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="A0.Ex54.m1.1.1.1.1.1.1.cmml" xref="A0.Ex54.m1.1.1.1.1.1"><plus id="A0.Ex54.m1.1.1.1.1.1.1.1.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.1"></plus><apply id="A0.Ex54.m1.1.1.1.1.1.1.2.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex54.m1.1.1.1.1.1.1.2.1.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A0.Ex54.m1.1.1.1.1.1.1.2.2.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.2.2">𝐙</ci><ci id="A0.Ex54.m1.1.1.1.1.1.1.2.3a.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.2.3"><mtext id="A0.Ex54.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex54.m1.1.1.1.1.1.1.2.3">dec</mtext></ci></apply><ci id="A0.Ex54.m1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.3"><mtext id="A0.Ex54.m1.1.1.1.1.1.1.3.cmml" xref="A0.Ex54.m1.1.1.1.1.1.1.3">SelfAttn</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex54.m1.1c">\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{SelfAttn})</annotation><annotation encoding="application/x-llamapun" id="A0.Ex54.m1.1d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ← LayerNorm ( bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT + SelfAttn )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex55">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{CrossAttn})" class="ltx_Math" display="block" id="A0.Ex55.m1.1"><semantics id="A0.Ex55.m1.1a"><mrow id="A0.Ex55.m1.1.1" xref="A0.Ex55.m1.1.1.cmml"><msup id="A0.Ex55.m1.1.1.3" xref="A0.Ex55.m1.1.1.3.cmml"><mi id="A0.Ex55.m1.1.1.3.2" xref="A0.Ex55.m1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex55.m1.1.1.3.3" xref="A0.Ex55.m1.1.1.3.3a.cmml">dec</mtext></msup><mo id="A0.Ex55.m1.1.1.2" stretchy="false" xref="A0.Ex55.m1.1.1.2.cmml">←</mo><mrow id="A0.Ex55.m1.1.1.1" xref="A0.Ex55.m1.1.1.1.cmml"><mtext id="A0.Ex55.m1.1.1.1.3" xref="A0.Ex55.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="A0.Ex55.m1.1.1.1.2" xref="A0.Ex55.m1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex55.m1.1.1.1.1.1" xref="A0.Ex55.m1.1.1.1.1.1.1.cmml"><mo id="A0.Ex55.m1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex55.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A0.Ex55.m1.1.1.1.1.1.1" xref="A0.Ex55.m1.1.1.1.1.1.1.cmml"><msup id="A0.Ex55.m1.1.1.1.1.1.1.2" xref="A0.Ex55.m1.1.1.1.1.1.1.2.cmml"><mi id="A0.Ex55.m1.1.1.1.1.1.1.2.2" xref="A0.Ex55.m1.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mtext id="A0.Ex55.m1.1.1.1.1.1.1.2.3" xref="A0.Ex55.m1.1.1.1.1.1.1.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex55.m1.1.1.1.1.1.1.1" xref="A0.Ex55.m1.1.1.1.1.1.1.1.cmml">+</mo><mtext id="A0.Ex55.m1.1.1.1.1.1.1.3" xref="A0.Ex55.m1.1.1.1.1.1.1.3a.cmml">CrossAttn</mtext></mrow><mo id="A0.Ex55.m1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex55.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex55.m1.1b"><apply id="A0.Ex55.m1.1.1.cmml" xref="A0.Ex55.m1.1.1"><ci id="A0.Ex55.m1.1.1.2.cmml" xref="A0.Ex55.m1.1.1.2">←</ci><apply id="A0.Ex55.m1.1.1.3.cmml" xref="A0.Ex55.m1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex55.m1.1.1.3.1.cmml" xref="A0.Ex55.m1.1.1.3">superscript</csymbol><ci id="A0.Ex55.m1.1.1.3.2.cmml" xref="A0.Ex55.m1.1.1.3.2">𝐙</ci><ci id="A0.Ex55.m1.1.1.3.3a.cmml" xref="A0.Ex55.m1.1.1.3.3"><mtext id="A0.Ex55.m1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex55.m1.1.1.3.3">dec</mtext></ci></apply><apply id="A0.Ex55.m1.1.1.1.cmml" xref="A0.Ex55.m1.1.1.1"><times id="A0.Ex55.m1.1.1.1.2.cmml" xref="A0.Ex55.m1.1.1.1.2"></times><ci id="A0.Ex55.m1.1.1.1.3a.cmml" xref="A0.Ex55.m1.1.1.1.3"><mtext id="A0.Ex55.m1.1.1.1.3.cmml" xref="A0.Ex55.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="A0.Ex55.m1.1.1.1.1.1.1.cmml" xref="A0.Ex55.m1.1.1.1.1.1"><plus id="A0.Ex55.m1.1.1.1.1.1.1.1.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.1"></plus><apply id="A0.Ex55.m1.1.1.1.1.1.1.2.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex55.m1.1.1.1.1.1.1.2.1.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A0.Ex55.m1.1.1.1.1.1.1.2.2.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.2.2">𝐙</ci><ci id="A0.Ex55.m1.1.1.1.1.1.1.2.3a.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.2.3"><mtext id="A0.Ex55.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex55.m1.1.1.1.1.1.1.2.3">dec</mtext></ci></apply><ci id="A0.Ex55.m1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.3"><mtext id="A0.Ex55.m1.1.1.1.1.1.1.3.cmml" xref="A0.Ex55.m1.1.1.1.1.1.1.3">CrossAttn</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex55.m1.1c">\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{CrossAttn})</annotation><annotation encoding="application/x-llamapun" id="A0.Ex55.m1.1d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ← LayerNorm ( bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT + CrossAttn )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex56">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{FFN}(\mathbf{Z}^{\text{dec}}))" class="ltx_Math" display="block" id="A0.Ex56.m1.1"><semantics id="A0.Ex56.m1.1a"><mrow id="A0.Ex56.m1.1.1" xref="A0.Ex56.m1.1.1.cmml"><msup id="A0.Ex56.m1.1.1.3" xref="A0.Ex56.m1.1.1.3.cmml"><mi id="A0.Ex56.m1.1.1.3.2" xref="A0.Ex56.m1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex56.m1.1.1.3.3" xref="A0.Ex56.m1.1.1.3.3a.cmml">dec</mtext></msup><mo id="A0.Ex56.m1.1.1.2" stretchy="false" xref="A0.Ex56.m1.1.1.2.cmml">←</mo><mrow id="A0.Ex56.m1.1.1.1" xref="A0.Ex56.m1.1.1.1.cmml"><mtext id="A0.Ex56.m1.1.1.1.3" xref="A0.Ex56.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="A0.Ex56.m1.1.1.1.2" xref="A0.Ex56.m1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex56.m1.1.1.1.1.1" xref="A0.Ex56.m1.1.1.1.1.1.1.cmml"><mo id="A0.Ex56.m1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex56.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A0.Ex56.m1.1.1.1.1.1.1" xref="A0.Ex56.m1.1.1.1.1.1.1.cmml"><msup id="A0.Ex56.m1.1.1.1.1.1.1.3" xref="A0.Ex56.m1.1.1.1.1.1.1.3.cmml"><mi id="A0.Ex56.m1.1.1.1.1.1.1.3.2" xref="A0.Ex56.m1.1.1.1.1.1.1.3.2.cmml">𝐙</mi><mtext id="A0.Ex56.m1.1.1.1.1.1.1.3.3" xref="A0.Ex56.m1.1.1.1.1.1.1.3.3a.cmml">dec</mtext></msup><mo id="A0.Ex56.m1.1.1.1.1.1.1.2" xref="A0.Ex56.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A0.Ex56.m1.1.1.1.1.1.1.1" xref="A0.Ex56.m1.1.1.1.1.1.1.1.cmml"><mtext id="A0.Ex56.m1.1.1.1.1.1.1.1.3" xref="A0.Ex56.m1.1.1.1.1.1.1.1.3a.cmml">FFN</mtext><mo id="A0.Ex56.m1.1.1.1.1.1.1.1.2" xref="A0.Ex56.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐙</mi><mtext id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">dec</mtext></msup><mo id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A0.Ex56.m1.1.1.1.1.1.3" stretchy="false" xref="A0.Ex56.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex56.m1.1b"><apply id="A0.Ex56.m1.1.1.cmml" xref="A0.Ex56.m1.1.1"><ci id="A0.Ex56.m1.1.1.2.cmml" xref="A0.Ex56.m1.1.1.2">←</ci><apply id="A0.Ex56.m1.1.1.3.cmml" xref="A0.Ex56.m1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex56.m1.1.1.3.1.cmml" xref="A0.Ex56.m1.1.1.3">superscript</csymbol><ci id="A0.Ex56.m1.1.1.3.2.cmml" xref="A0.Ex56.m1.1.1.3.2">𝐙</ci><ci id="A0.Ex56.m1.1.1.3.3a.cmml" xref="A0.Ex56.m1.1.1.3.3"><mtext id="A0.Ex56.m1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex56.m1.1.1.3.3">dec</mtext></ci></apply><apply id="A0.Ex56.m1.1.1.1.cmml" xref="A0.Ex56.m1.1.1.1"><times id="A0.Ex56.m1.1.1.1.2.cmml" xref="A0.Ex56.m1.1.1.1.2"></times><ci id="A0.Ex56.m1.1.1.1.3a.cmml" xref="A0.Ex56.m1.1.1.1.3"><mtext id="A0.Ex56.m1.1.1.1.3.cmml" xref="A0.Ex56.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="A0.Ex56.m1.1.1.1.1.1.1.cmml" xref="A0.Ex56.m1.1.1.1.1.1"><plus id="A0.Ex56.m1.1.1.1.1.1.1.2.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.2"></plus><apply id="A0.Ex56.m1.1.1.1.1.1.1.3.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A0.Ex56.m1.1.1.1.1.1.1.3.1.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A0.Ex56.m1.1.1.1.1.1.1.3.2.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.3.2">𝐙</ci><ci id="A0.Ex56.m1.1.1.1.1.1.1.3.3a.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.3.3"><mtext id="A0.Ex56.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="A0.Ex56.m1.1.1.1.1.1.1.3.3">dec</mtext></ci></apply><apply id="A0.Ex56.m1.1.1.1.1.1.1.1.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1"><times id="A0.Ex56.m1.1.1.1.1.1.1.1.2.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.2"></times><ci id="A0.Ex56.m1.1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.3"><mtext id="A0.Ex56.m1.1.1.1.1.1.1.1.3.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.3">FFN</mtext></ci><apply id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.2">𝐙</ci><ci id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="A0.Ex56.m1.1.1.1.1.1.1.1.1.1.1.3">dec</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex56.m1.1c">\mathbf{Z}^{\text{dec}}\leftarrow\text{LayerNorm}(\mathbf{Z}^{\text{dec}}+%
\text{FFN}(\mathbf{Z}^{\text{dec}}))</annotation><annotation encoding="application/x-llamapun" id="A0.Ex56.m1.1d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ← LayerNorm ( bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT + FFN ( bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l18.2">Step 5: Output Projection</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex57">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}_{o}\in\mathbb{R}^{B%
\times H\times 1}" class="ltx_Math" display="block" id="A0.Ex57.m1.1"><semantics id="A0.Ex57.m1.1a"><mrow id="A0.Ex57.m1.1.1" xref="A0.Ex57.m1.1.1.cmml"><mover accent="true" id="A0.Ex57.m1.1.1.2" xref="A0.Ex57.m1.1.1.2.cmml"><mi id="A0.Ex57.m1.1.1.2.2" xref="A0.Ex57.m1.1.1.2.2.cmml">𝐲</mi><mo id="A0.Ex57.m1.1.1.2.1" xref="A0.Ex57.m1.1.1.2.1.cmml">^</mo></mover><mo id="A0.Ex57.m1.1.1.3" xref="A0.Ex57.m1.1.1.3.cmml">=</mo><mrow id="A0.Ex57.m1.1.1.4" xref="A0.Ex57.m1.1.1.4.cmml"><msup id="A0.Ex57.m1.1.1.4.2" xref="A0.Ex57.m1.1.1.4.2.cmml"><mi id="A0.Ex57.m1.1.1.4.2.2" xref="A0.Ex57.m1.1.1.4.2.2.cmml">𝐙</mi><mtext id="A0.Ex57.m1.1.1.4.2.3" xref="A0.Ex57.m1.1.1.4.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex57.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex57.m1.1.1.4.1.cmml">⋅</mo><msub id="A0.Ex57.m1.1.1.4.3" xref="A0.Ex57.m1.1.1.4.3.cmml"><mi id="A0.Ex57.m1.1.1.4.3.2" xref="A0.Ex57.m1.1.1.4.3.2.cmml">𝐖</mi><mi id="A0.Ex57.m1.1.1.4.3.3" xref="A0.Ex57.m1.1.1.4.3.3.cmml">o</mi></msub></mrow><mo id="A0.Ex57.m1.1.1.5" xref="A0.Ex57.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex57.m1.1.1.6" xref="A0.Ex57.m1.1.1.6.cmml"><mi id="A0.Ex57.m1.1.1.6.2" xref="A0.Ex57.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex57.m1.1.1.6.3" xref="A0.Ex57.m1.1.1.6.3.cmml"><mi id="A0.Ex57.m1.1.1.6.3.2" xref="A0.Ex57.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex57.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex57.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex57.m1.1.1.6.3.3" xref="A0.Ex57.m1.1.1.6.3.3.cmml">H</mi><mo id="A0.Ex57.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex57.m1.1.1.6.3.1.cmml">×</mo><mn id="A0.Ex57.m1.1.1.6.3.4" xref="A0.Ex57.m1.1.1.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex57.m1.1b"><apply id="A0.Ex57.m1.1.1.cmml" xref="A0.Ex57.m1.1.1"><and id="A0.Ex57.m1.1.1a.cmml" xref="A0.Ex57.m1.1.1"></and><apply id="A0.Ex57.m1.1.1b.cmml" xref="A0.Ex57.m1.1.1"><eq id="A0.Ex57.m1.1.1.3.cmml" xref="A0.Ex57.m1.1.1.3"></eq><apply id="A0.Ex57.m1.1.1.2.cmml" xref="A0.Ex57.m1.1.1.2"><ci id="A0.Ex57.m1.1.1.2.1.cmml" xref="A0.Ex57.m1.1.1.2.1">^</ci><ci id="A0.Ex57.m1.1.1.2.2.cmml" xref="A0.Ex57.m1.1.1.2.2">𝐲</ci></apply><apply id="A0.Ex57.m1.1.1.4.cmml" xref="A0.Ex57.m1.1.1.4"><ci id="A0.Ex57.m1.1.1.4.1.cmml" xref="A0.Ex57.m1.1.1.4.1">⋅</ci><apply id="A0.Ex57.m1.1.1.4.2.cmml" xref="A0.Ex57.m1.1.1.4.2"><csymbol cd="ambiguous" id="A0.Ex57.m1.1.1.4.2.1.cmml" xref="A0.Ex57.m1.1.1.4.2">superscript</csymbol><ci id="A0.Ex57.m1.1.1.4.2.2.cmml" xref="A0.Ex57.m1.1.1.4.2.2">𝐙</ci><ci id="A0.Ex57.m1.1.1.4.2.3a.cmml" xref="A0.Ex57.m1.1.1.4.2.3"><mtext id="A0.Ex57.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A0.Ex57.m1.1.1.4.2.3">dec</mtext></ci></apply><apply id="A0.Ex57.m1.1.1.4.3.cmml" xref="A0.Ex57.m1.1.1.4.3"><csymbol cd="ambiguous" id="A0.Ex57.m1.1.1.4.3.1.cmml" xref="A0.Ex57.m1.1.1.4.3">subscript</csymbol><ci id="A0.Ex57.m1.1.1.4.3.2.cmml" xref="A0.Ex57.m1.1.1.4.3.2">𝐖</ci><ci id="A0.Ex57.m1.1.1.4.3.3.cmml" xref="A0.Ex57.m1.1.1.4.3.3">𝑜</ci></apply></apply></apply><apply id="A0.Ex57.m1.1.1c.cmml" xref="A0.Ex57.m1.1.1"><in id="A0.Ex57.m1.1.1.5.cmml" xref="A0.Ex57.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex57.m1.1.1.4.cmml" id="A0.Ex57.m1.1.1d.cmml" xref="A0.Ex57.m1.1.1"></share><apply id="A0.Ex57.m1.1.1.6.cmml" xref="A0.Ex57.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex57.m1.1.1.6.1.cmml" xref="A0.Ex57.m1.1.1.6">superscript</csymbol><ci id="A0.Ex57.m1.1.1.6.2.cmml" xref="A0.Ex57.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex57.m1.1.1.6.3.cmml" xref="A0.Ex57.m1.1.1.6.3"><times id="A0.Ex57.m1.1.1.6.3.1.cmml" xref="A0.Ex57.m1.1.1.6.3.1"></times><ci id="A0.Ex57.m1.1.1.6.3.2.cmml" xref="A0.Ex57.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex57.m1.1.1.6.3.3.cmml" xref="A0.Ex57.m1.1.1.6.3.3">𝐻</ci><cn id="A0.Ex57.m1.1.1.6.3.4.cmml" type="integer" xref="A0.Ex57.m1.1.1.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex57.m1.1c">\hat{\mathbf{y}}=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}_{o}\in\mathbb{R}^{B%
\times H\times 1}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex57.m1.1d">over^ start_ARG bold_y end_ARG = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l19.2">return</span> <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mover accent="true" id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">𝐲</mi><mo id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">^</ci><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math> reshaped to <math alttext="\mathbb{R}^{B\times H}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><msup id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mi id="alg1.l19.m2.1.1.2" xref="alg1.l19.m2.1.1.2.cmml">ℝ</mi><mrow id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml"><mi id="alg1.l19.m2.1.1.3.2" xref="alg1.l19.m2.1.1.3.2.cmml">B</mi><mo id="alg1.l19.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l19.m2.1.1.3.1.cmml">×</mo><mi id="alg1.l19.m2.1.1.3.3" xref="alg1.l19.m2.1.1.3.3.cmml">H</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">superscript</csymbol><ci id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1.2">ℝ</ci><apply id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3"><times id="alg1.l19.m2.1.1.3.1.cmml" xref="alg1.l19.m2.1.1.3.1"></times><ci id="alg1.l19.m2.1.1.3.2.cmml" xref="alg1.l19.m2.1.1.3.2">𝐵</ci><ci id="alg1.l19.m2.1.1.3.3.cmml" xref="alg1.l19.m2.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.3.1.1">Algorithm 2</span> </span> Full <span class="ltx_text ltx_font_typewriter" id="alg2.4.2">Informer</span>  Forecasting Procedure with ProbSparse Attention</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.5">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l1.2">Input:</span> Input sequence <math alttext="\mathbf{x}\in\mathbb{R}^{B\times P\times 1}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">𝐱</mi><mo id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml">∈</mo><msup id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml"><mi id="alg2.l1.m1.1.1.3.2" xref="alg2.l1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.l1.m1.1.1.3.3" xref="alg2.l1.m1.1.1.3.3.cmml"><mi id="alg2.l1.m1.1.1.3.3.2" xref="alg2.l1.m1.1.1.3.3.2.cmml">B</mi><mo id="alg2.l1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l1.m1.1.1.3.3.1.cmml">×</mo><mi id="alg2.l1.m1.1.1.3.3.3" xref="alg2.l1.m1.1.1.3.3.3.cmml">P</mi><mo id="alg2.l1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg2.l1.m1.1.1.3.3.1.cmml">×</mo><mn id="alg2.l1.m1.1.1.3.3.4" xref="alg2.l1.m1.1.1.3.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><in id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1"></in><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝐱</ci><apply id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.3.1.cmml" xref="alg2.l1.m1.1.1.3">superscript</csymbol><ci id="alg2.l1.m1.1.1.3.2.cmml" xref="alg2.l1.m1.1.1.3.2">ℝ</ci><apply id="alg2.l1.m1.1.1.3.3.cmml" xref="alg2.l1.m1.1.1.3.3"><times id="alg2.l1.m1.1.1.3.3.1.cmml" xref="alg2.l1.m1.1.1.3.3.1"></times><ci id="alg2.l1.m1.1.1.3.3.2.cmml" xref="alg2.l1.m1.1.1.3.3.2">𝐵</ci><ci id="alg2.l1.m1.1.1.3.3.3.cmml" xref="alg2.l1.m1.1.1.3.3.3">𝑃</ci><cn id="alg2.l1.m1.1.1.3.3.4.cmml" type="integer" xref="alg2.l1.m1.1.1.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathbf{x}\in\mathbb{R}^{B\times P\times 1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, forecast horizon <math alttext="H" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_H</annotation></semantics></math>, model dimension <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><msub id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">d</mi><mtext id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1">subscript</csymbol><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">𝑑</ci><ci id="alg2.l1.m3.1.1.3a.cmml" xref="alg2.l1.m3.1.1.3"><mtext id="alg2.l1.m3.1.1.3.cmml" mathsize="70%" xref="alg2.l1.m3.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l2.2">Output:</span> Forecast sequence <math alttext="\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mover accent="true" id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml"><mi id="alg2.l2.m1.1.1.2.2" xref="alg2.l2.m1.1.1.2.2.cmml">𝐲</mi><mo id="alg2.l2.m1.1.1.2.1" xref="alg2.l2.m1.1.1.2.1.cmml">^</mo></mover><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><msup id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml"><mi id="alg2.l2.m1.1.1.3.3.2" xref="alg2.l2.m1.1.1.3.3.2.cmml">B</mi><mo id="alg2.l2.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l2.m1.1.1.3.3.1.cmml">×</mo><mi id="alg2.l2.m1.1.1.3.3.3" xref="alg2.l2.m1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2"><ci id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2.1">^</ci><ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">𝐲</ci></apply><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">superscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">ℝ</ci><apply id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3"><times id="alg2.l2.m1.1.1.3.3.1.cmml" xref="alg2.l2.m1.1.1.3.3.1"></times><ci id="alg2.l2.m1.1.1.3.3.2.cmml" xref="alg2.l2.m1.1.1.3.3.2">𝐵</ci><ci id="alg2.l2.m1.1.1.3.3.3.cmml" xref="alg2.l2.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">over^ start_ARG bold_y end_ARG ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l3.2">Step 1: Encoder Projection and Positional Encoding</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex58">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{enc}}=\mathbf{x}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{B\times P\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex58.m1.2"><semantics id="A0.Ex58.m1.2a"><mrow id="A0.Ex58.m1.2.3" xref="A0.Ex58.m1.2.3.cmml"><msup id="A0.Ex58.m1.2.3.2" xref="A0.Ex58.m1.2.3.2.cmml"><mi id="A0.Ex58.m1.2.3.2.2" xref="A0.Ex58.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex58.m1.2.3.2.3" xref="A0.Ex58.m1.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex58.m1.2.3.3" xref="A0.Ex58.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex58.m1.2.3.4" xref="A0.Ex58.m1.2.3.4.cmml"><mrow id="A0.Ex58.m1.2.3.4.2" xref="A0.Ex58.m1.2.3.4.2.cmml"><mi id="A0.Ex58.m1.2.3.4.2.2" xref="A0.Ex58.m1.2.3.4.2.2.cmml">𝐱</mi><mo id="A0.Ex58.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex58.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex58.m1.2.3.4.2.3" xref="A0.Ex58.m1.2.3.4.2.3.cmml"><mi id="A0.Ex58.m1.2.3.4.2.3.2.2" xref="A0.Ex58.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex58.m1.2.3.4.2.3.2.3" xref="A0.Ex58.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex58.m1.1.1.1.3" xref="A0.Ex58.m1.2.3.4.2.3.cmml"><mo id="A0.Ex58.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex58.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex58.m1.1.1.1.1" xref="A0.Ex58.m1.1.1.1.1.cmml">e</mi><mo id="A0.Ex58.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex58.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex58.m1.2.3.4.1" xref="A0.Ex58.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex58.m1.2.3.4.3" xref="A0.Ex58.m1.2.3.4.3.cmml"><mtext id="A0.Ex58.m1.2.3.4.3.2" xref="A0.Ex58.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex58.m1.2.2.1.3" xref="A0.Ex58.m1.2.3.4.3.cmml"><mo id="A0.Ex58.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex58.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex58.m1.2.2.1.1" xref="A0.Ex58.m1.2.2.1.1.cmml">e</mi><mo id="A0.Ex58.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex58.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex58.m1.2.3.5" xref="A0.Ex58.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex58.m1.2.3.6" xref="A0.Ex58.m1.2.3.6.cmml"><mi id="A0.Ex58.m1.2.3.6.2" xref="A0.Ex58.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex58.m1.2.3.6.3" xref="A0.Ex58.m1.2.3.6.3.cmml"><mi id="A0.Ex58.m1.2.3.6.3.2" xref="A0.Ex58.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex58.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex58.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex58.m1.2.3.6.3.3" xref="A0.Ex58.m1.2.3.6.3.3.cmml">P</mi><mo id="A0.Ex58.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex58.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex58.m1.2.3.6.3.4" xref="A0.Ex58.m1.2.3.6.3.4.cmml"><mi id="A0.Ex58.m1.2.3.6.3.4.2" xref="A0.Ex58.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex58.m1.2.3.6.3.4.3" xref="A0.Ex58.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex58.m1.2b"><apply id="A0.Ex58.m1.2.3.cmml" xref="A0.Ex58.m1.2.3"><and id="A0.Ex58.m1.2.3a.cmml" xref="A0.Ex58.m1.2.3"></and><apply id="A0.Ex58.m1.2.3b.cmml" xref="A0.Ex58.m1.2.3"><eq id="A0.Ex58.m1.2.3.3.cmml" xref="A0.Ex58.m1.2.3.3"></eq><apply id="A0.Ex58.m1.2.3.2.cmml" xref="A0.Ex58.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.2.1.cmml" xref="A0.Ex58.m1.2.3.2">superscript</csymbol><ci id="A0.Ex58.m1.2.3.2.2.cmml" xref="A0.Ex58.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex58.m1.2.3.2.3a.cmml" xref="A0.Ex58.m1.2.3.2.3"><mtext id="A0.Ex58.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex58.m1.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex58.m1.2.3.4.cmml" xref="A0.Ex58.m1.2.3.4"><plus id="A0.Ex58.m1.2.3.4.1.cmml" xref="A0.Ex58.m1.2.3.4.1"></plus><apply id="A0.Ex58.m1.2.3.4.2.cmml" xref="A0.Ex58.m1.2.3.4.2"><ci id="A0.Ex58.m1.2.3.4.2.1.cmml" xref="A0.Ex58.m1.2.3.4.2.1">⋅</ci><ci id="A0.Ex58.m1.2.3.4.2.2.cmml" xref="A0.Ex58.m1.2.3.4.2.2">𝐱</ci><apply id="A0.Ex58.m1.2.3.4.2.3.cmml" xref="A0.Ex58.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.4.2.3.1.cmml" xref="A0.Ex58.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex58.m1.2.3.4.2.3.2.cmml" xref="A0.Ex58.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex58.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex58.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex58.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex58.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex58.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex58.m1.1.1.1.1.cmml" xref="A0.Ex58.m1.1.1.1.1">𝑒</ci></apply></apply><apply id="A0.Ex58.m1.2.3.4.3.cmml" xref="A0.Ex58.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.4.3.1.cmml" xref="A0.Ex58.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex58.m1.2.3.4.3.2a.cmml" xref="A0.Ex58.m1.2.3.4.3.2"><mtext id="A0.Ex58.m1.2.3.4.3.2.cmml" xref="A0.Ex58.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex58.m1.2.2.1.1.cmml" xref="A0.Ex58.m1.2.2.1.1">𝑒</ci></apply></apply></apply><apply id="A0.Ex58.m1.2.3c.cmml" xref="A0.Ex58.m1.2.3"><in id="A0.Ex58.m1.2.3.5.cmml" xref="A0.Ex58.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex58.m1.2.3.4.cmml" id="A0.Ex58.m1.2.3d.cmml" xref="A0.Ex58.m1.2.3"></share><apply id="A0.Ex58.m1.2.3.6.cmml" xref="A0.Ex58.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.6.1.cmml" xref="A0.Ex58.m1.2.3.6">superscript</csymbol><ci id="A0.Ex58.m1.2.3.6.2.cmml" xref="A0.Ex58.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex58.m1.2.3.6.3.cmml" xref="A0.Ex58.m1.2.3.6.3"><times id="A0.Ex58.m1.2.3.6.3.1.cmml" xref="A0.Ex58.m1.2.3.6.3.1"></times><ci id="A0.Ex58.m1.2.3.6.3.2.cmml" xref="A0.Ex58.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex58.m1.2.3.6.3.3.cmml" xref="A0.Ex58.m1.2.3.6.3.3">𝑃</ci><apply id="A0.Ex58.m1.2.3.6.3.4.cmml" xref="A0.Ex58.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex58.m1.2.3.6.3.4.1.cmml" xref="A0.Ex58.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex58.m1.2.3.6.3.4.2.cmml" xref="A0.Ex58.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex58.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex58.m1.2.3.6.3.4.3"><mtext id="A0.Ex58.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex58.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex58.m1.2c">\mathbf{Z}^{\text{enc}}=\mathbf{x}\cdot\mathbf{W}_{e}^{(e)}+\text{PE}^{(e)}\in%
\mathbb{R}^{B\times P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex58.m1.2d">bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT = bold_x ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l4.2">Step 2: ProbSparse Transformer Encoder</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l5.2">for</span> each encoder layer <span class="ltx_text ltx_font_bold" id="alg2.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>     Compute attention triplets:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex59">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q},\quad K=\mathbf{Z}^{\text{enc}}%
\cdot\mathbf{W}^{K},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{V}" class="ltx_Math" display="block" id="A0.Ex59.m1.2"><semantics id="A0.Ex59.m1.2a"><mrow id="A0.Ex59.m1.2.2.2" xref="A0.Ex59.m1.2.2.3.cmml"><mrow id="A0.Ex59.m1.1.1.1.1" xref="A0.Ex59.m1.1.1.1.1.cmml"><mi id="A0.Ex59.m1.1.1.1.1.2" xref="A0.Ex59.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex59.m1.1.1.1.1.1" xref="A0.Ex59.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex59.m1.1.1.1.1.3" xref="A0.Ex59.m1.1.1.1.1.3.cmml"><msup id="A0.Ex59.m1.1.1.1.1.3.2" xref="A0.Ex59.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex59.m1.1.1.1.1.3.2.2" xref="A0.Ex59.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex59.m1.1.1.1.1.3.2.3" xref="A0.Ex59.m1.1.1.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex59.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex59.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex59.m1.1.1.1.1.3.3" xref="A0.Ex59.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex59.m1.1.1.1.1.3.3.2" xref="A0.Ex59.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><mi id="A0.Ex59.m1.1.1.1.1.3.3.3" xref="A0.Ex59.m1.1.1.1.1.3.3.3.cmml">Q</mi></msup></mrow></mrow><mo id="A0.Ex59.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex59.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex59.m1.2.2.2.2.2" xref="A0.Ex59.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex59.m1.2.2.2.2.1.1" xref="A0.Ex59.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex59.m1.2.2.2.2.1.1.2" xref="A0.Ex59.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex59.m1.2.2.2.2.1.1.1" xref="A0.Ex59.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex59.m1.2.2.2.2.1.1.3" xref="A0.Ex59.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex59.m1.2.2.2.2.1.1.3.2" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex59.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex59.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex59.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex59.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex59.m1.2.2.2.2.1.1.3.3" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex59.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><mi id="A0.Ex59.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3.3.cmml">K</mi></msup></mrow></mrow><mo id="A0.Ex59.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex59.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex59.m1.2.2.2.2.2.2" xref="A0.Ex59.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex59.m1.2.2.2.2.2.2.2" xref="A0.Ex59.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex59.m1.2.2.2.2.2.2.1" xref="A0.Ex59.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex59.m1.2.2.2.2.2.2.3" xref="A0.Ex59.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex59.m1.2.2.2.2.2.2.3.2" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex59.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex59.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex59.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex59.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex59.m1.2.2.2.2.2.2.3.3" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex59.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><mi id="A0.Ex59.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3.3.cmml">V</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex59.m1.2b"><apply id="A0.Ex59.m1.2.2.3.cmml" xref="A0.Ex59.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.3a.cmml" xref="A0.Ex59.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex59.m1.1.1.1.1.cmml" xref="A0.Ex59.m1.1.1.1.1"><eq id="A0.Ex59.m1.1.1.1.1.1.cmml" xref="A0.Ex59.m1.1.1.1.1.1"></eq><ci id="A0.Ex59.m1.1.1.1.1.2.cmml" xref="A0.Ex59.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex59.m1.1.1.1.1.3.cmml" xref="A0.Ex59.m1.1.1.1.1.3"><ci id="A0.Ex59.m1.1.1.1.1.3.1.cmml" xref="A0.Ex59.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex59.m1.1.1.1.1.3.2.cmml" xref="A0.Ex59.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex59.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex59.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex59.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex59.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex59.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex59.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex59.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex59.m1.1.1.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex59.m1.1.1.1.1.3.3.cmml" xref="A0.Ex59.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex59.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex59.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex59.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex59.m1.1.1.1.1.3.3.2">𝐖</ci><ci id="A0.Ex59.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex59.m1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply><apply id="A0.Ex59.m1.2.2.2.2.3.cmml" xref="A0.Ex59.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.2.2.3a.cmml" xref="A0.Ex59.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex59.m1.2.2.2.2.1.1.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1"><eq id="A0.Ex59.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex59.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex59.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3"><ci id="A0.Ex59.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex59.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex59.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.2">𝐙</ci><ci id="A0.Ex59.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex59.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex59.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex59.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex59.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><ci id="A0.Ex59.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex59.m1.2.2.2.2.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="A0.Ex59.m1.2.2.2.2.2.2.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2"><eq id="A0.Ex59.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex59.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex59.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3"><ci id="A0.Ex59.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex59.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex59.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.2">𝐙</ci><ci id="A0.Ex59.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex59.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex59.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex59.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex59.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex59.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><ci id="A0.Ex59.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex59.m1.2.2.2.2.2.2.3.3.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex59.m1.2c">Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q},\quad K=\mathbf{Z}^{\text{enc}}%
\cdot\mathbf{W}^{K},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{V}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex59.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_K = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>     Compute sparsity score for each <math alttext="q_{i}" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><msub id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">q</mi><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝑞</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex60">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M(q_{i})=\max_{j}\left(\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}\right%
)-\frac{1}{P}\sum_{j=1}^{P}\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}" class="ltx_Math" display="block" id="A0.Ex60.m1.3"><semantics id="A0.Ex60.m1.3a"><mrow id="A0.Ex60.m1.3.3" xref="A0.Ex60.m1.3.3.cmml"><mrow id="A0.Ex60.m1.2.2.1" xref="A0.Ex60.m1.2.2.1.cmml"><mi id="A0.Ex60.m1.2.2.1.3" xref="A0.Ex60.m1.2.2.1.3.cmml">M</mi><mo id="A0.Ex60.m1.2.2.1.2" xref="A0.Ex60.m1.2.2.1.2.cmml">⁢</mo><mrow id="A0.Ex60.m1.2.2.1.1.1" xref="A0.Ex60.m1.2.2.1.1.1.1.cmml"><mo id="A0.Ex60.m1.2.2.1.1.1.2" stretchy="false" xref="A0.Ex60.m1.2.2.1.1.1.1.cmml">(</mo><msub id="A0.Ex60.m1.2.2.1.1.1.1" xref="A0.Ex60.m1.2.2.1.1.1.1.cmml"><mi id="A0.Ex60.m1.2.2.1.1.1.1.2" xref="A0.Ex60.m1.2.2.1.1.1.1.2.cmml">q</mi><mi id="A0.Ex60.m1.2.2.1.1.1.1.3" xref="A0.Ex60.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="A0.Ex60.m1.2.2.1.1.1.3" stretchy="false" xref="A0.Ex60.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A0.Ex60.m1.3.3.3" xref="A0.Ex60.m1.3.3.3.cmml">=</mo><mrow id="A0.Ex60.m1.3.3.2" xref="A0.Ex60.m1.3.3.2.cmml"><mrow id="A0.Ex60.m1.3.3.2.1.1" xref="A0.Ex60.m1.3.3.2.1.2.cmml"><munder id="A0.Ex60.m1.3.3.2.1.1.1" xref="A0.Ex60.m1.3.3.2.1.1.1.cmml"><mi id="A0.Ex60.m1.3.3.2.1.1.1.2" xref="A0.Ex60.m1.3.3.2.1.1.1.2.cmml">max</mi><mi id="A0.Ex60.m1.3.3.2.1.1.1.3" xref="A0.Ex60.m1.3.3.2.1.1.1.3.cmml">j</mi></munder><mo id="A0.Ex60.m1.3.3.2.1.1a" xref="A0.Ex60.m1.3.3.2.1.2.cmml">⁡</mo><mrow id="A0.Ex60.m1.3.3.2.1.1.2" xref="A0.Ex60.m1.3.3.2.1.2.cmml"><mo id="A0.Ex60.m1.3.3.2.1.1.2.1" xref="A0.Ex60.m1.3.3.2.1.2.cmml">(</mo><mfrac id="A0.Ex60.m1.1.1" xref="A0.Ex60.m1.1.1.cmml"><mrow id="A0.Ex60.m1.1.1.2" xref="A0.Ex60.m1.1.1.2.cmml"><msub id="A0.Ex60.m1.1.1.2.2" xref="A0.Ex60.m1.1.1.2.2.cmml"><mi id="A0.Ex60.m1.1.1.2.2.2" xref="A0.Ex60.m1.1.1.2.2.2.cmml">q</mi><mi id="A0.Ex60.m1.1.1.2.2.3" xref="A0.Ex60.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="A0.Ex60.m1.1.1.2.1" xref="A0.Ex60.m1.1.1.2.1.cmml">⁢</mo><msubsup id="A0.Ex60.m1.1.1.2.3" xref="A0.Ex60.m1.1.1.2.3.cmml"><mi id="A0.Ex60.m1.1.1.2.3.2.2" xref="A0.Ex60.m1.1.1.2.3.2.2.cmml">k</mi><mi id="A0.Ex60.m1.1.1.2.3.2.3" xref="A0.Ex60.m1.1.1.2.3.2.3.cmml">j</mi><mo id="A0.Ex60.m1.1.1.2.3.3" xref="A0.Ex60.m1.1.1.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="A0.Ex60.m1.1.1.3" xref="A0.Ex60.m1.1.1.3.cmml"><msub id="A0.Ex60.m1.1.1.3.2" xref="A0.Ex60.m1.1.1.3.2.cmml"><mi id="A0.Ex60.m1.1.1.3.2.2" xref="A0.Ex60.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex60.m1.1.1.3.2.3" xref="A0.Ex60.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex60.m1.3.3.2.1.1.2.2" xref="A0.Ex60.m1.3.3.2.1.2.cmml">)</mo></mrow></mrow><mo id="A0.Ex60.m1.3.3.2.2" xref="A0.Ex60.m1.3.3.2.2.cmml">−</mo><mrow id="A0.Ex60.m1.3.3.2.3" xref="A0.Ex60.m1.3.3.2.3.cmml"><mfrac id="A0.Ex60.m1.3.3.2.3.2" xref="A0.Ex60.m1.3.3.2.3.2.cmml"><mn id="A0.Ex60.m1.3.3.2.3.2.2" xref="A0.Ex60.m1.3.3.2.3.2.2.cmml">1</mn><mi id="A0.Ex60.m1.3.3.2.3.2.3" xref="A0.Ex60.m1.3.3.2.3.2.3.cmml">P</mi></mfrac><mo id="A0.Ex60.m1.3.3.2.3.1" xref="A0.Ex60.m1.3.3.2.3.1.cmml">⁢</mo><mrow id="A0.Ex60.m1.3.3.2.3.3" xref="A0.Ex60.m1.3.3.2.3.3.cmml"><munderover id="A0.Ex60.m1.3.3.2.3.3.1" xref="A0.Ex60.m1.3.3.2.3.3.1.cmml"><mo id="A0.Ex60.m1.3.3.2.3.3.1.2.2" movablelimits="false" xref="A0.Ex60.m1.3.3.2.3.3.1.2.2.cmml">∑</mo><mrow id="A0.Ex60.m1.3.3.2.3.3.1.2.3" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.cmml"><mi id="A0.Ex60.m1.3.3.2.3.3.1.2.3.2" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.2.cmml">j</mi><mo id="A0.Ex60.m1.3.3.2.3.3.1.2.3.1" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.1.cmml">=</mo><mn id="A0.Ex60.m1.3.3.2.3.3.1.2.3.3" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A0.Ex60.m1.3.3.2.3.3.1.3" xref="A0.Ex60.m1.3.3.2.3.3.1.3.cmml">P</mi></munderover><mfrac id="A0.Ex60.m1.3.3.2.3.3.2" xref="A0.Ex60.m1.3.3.2.3.3.2.cmml"><mrow id="A0.Ex60.m1.3.3.2.3.3.2.2" xref="A0.Ex60.m1.3.3.2.3.3.2.2.cmml"><msub id="A0.Ex60.m1.3.3.2.3.3.2.2.2" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2.cmml"><mi id="A0.Ex60.m1.3.3.2.3.3.2.2.2.2" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2.2.cmml">q</mi><mi id="A0.Ex60.m1.3.3.2.3.3.2.2.2.3" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2.3.cmml">i</mi></msub><mo id="A0.Ex60.m1.3.3.2.3.3.2.2.1" xref="A0.Ex60.m1.3.3.2.3.3.2.2.1.cmml">⁢</mo><msubsup id="A0.Ex60.m1.3.3.2.3.3.2.2.3" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.cmml"><mi id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.2" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.2.cmml">k</mi><mi id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.3" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.3.cmml">j</mi><mo id="A0.Ex60.m1.3.3.2.3.3.2.2.3.3" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="A0.Ex60.m1.3.3.2.3.3.2.3" xref="A0.Ex60.m1.3.3.2.3.3.2.3.cmml"><msub id="A0.Ex60.m1.3.3.2.3.3.2.3.2" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.cmml"><mi id="A0.Ex60.m1.3.3.2.3.3.2.3.2.2" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.2.cmml">d</mi><mtext id="A0.Ex60.m1.3.3.2.3.3.2.3.2.3" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex60.m1.3b"><apply id="A0.Ex60.m1.3.3.cmml" xref="A0.Ex60.m1.3.3"><eq id="A0.Ex60.m1.3.3.3.cmml" xref="A0.Ex60.m1.3.3.3"></eq><apply id="A0.Ex60.m1.2.2.1.cmml" xref="A0.Ex60.m1.2.2.1"><times id="A0.Ex60.m1.2.2.1.2.cmml" xref="A0.Ex60.m1.2.2.1.2"></times><ci id="A0.Ex60.m1.2.2.1.3.cmml" xref="A0.Ex60.m1.2.2.1.3">𝑀</ci><apply id="A0.Ex60.m1.2.2.1.1.1.1.cmml" xref="A0.Ex60.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A0.Ex60.m1.2.2.1.1.1.1.1.cmml" xref="A0.Ex60.m1.2.2.1.1.1">subscript</csymbol><ci id="A0.Ex60.m1.2.2.1.1.1.1.2.cmml" xref="A0.Ex60.m1.2.2.1.1.1.1.2">𝑞</ci><ci id="A0.Ex60.m1.2.2.1.1.1.1.3.cmml" xref="A0.Ex60.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A0.Ex60.m1.3.3.2.cmml" xref="A0.Ex60.m1.3.3.2"><minus id="A0.Ex60.m1.3.3.2.2.cmml" xref="A0.Ex60.m1.3.3.2.2"></minus><apply id="A0.Ex60.m1.3.3.2.1.2.cmml" xref="A0.Ex60.m1.3.3.2.1.1"><apply id="A0.Ex60.m1.3.3.2.1.1.1.cmml" xref="A0.Ex60.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.1.1.1.1.cmml" xref="A0.Ex60.m1.3.3.2.1.1.1">subscript</csymbol><max id="A0.Ex60.m1.3.3.2.1.1.1.2.cmml" xref="A0.Ex60.m1.3.3.2.1.1.1.2"></max><ci id="A0.Ex60.m1.3.3.2.1.1.1.3.cmml" xref="A0.Ex60.m1.3.3.2.1.1.1.3">𝑗</ci></apply><apply id="A0.Ex60.m1.1.1.cmml" xref="A0.Ex60.m1.1.1"><divide id="A0.Ex60.m1.1.1.1.cmml" xref="A0.Ex60.m1.1.1"></divide><apply id="A0.Ex60.m1.1.1.2.cmml" xref="A0.Ex60.m1.1.1.2"><times id="A0.Ex60.m1.1.1.2.1.cmml" xref="A0.Ex60.m1.1.1.2.1"></times><apply id="A0.Ex60.m1.1.1.2.2.cmml" xref="A0.Ex60.m1.1.1.2.2"><csymbol cd="ambiguous" id="A0.Ex60.m1.1.1.2.2.1.cmml" xref="A0.Ex60.m1.1.1.2.2">subscript</csymbol><ci id="A0.Ex60.m1.1.1.2.2.2.cmml" xref="A0.Ex60.m1.1.1.2.2.2">𝑞</ci><ci id="A0.Ex60.m1.1.1.2.2.3.cmml" xref="A0.Ex60.m1.1.1.2.2.3">𝑖</ci></apply><apply id="A0.Ex60.m1.1.1.2.3.cmml" xref="A0.Ex60.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex60.m1.1.1.2.3.1.cmml" xref="A0.Ex60.m1.1.1.2.3">superscript</csymbol><apply id="A0.Ex60.m1.1.1.2.3.2.cmml" xref="A0.Ex60.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex60.m1.1.1.2.3.2.1.cmml" xref="A0.Ex60.m1.1.1.2.3">subscript</csymbol><ci id="A0.Ex60.m1.1.1.2.3.2.2.cmml" xref="A0.Ex60.m1.1.1.2.3.2.2">𝑘</ci><ci id="A0.Ex60.m1.1.1.2.3.2.3.cmml" xref="A0.Ex60.m1.1.1.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A0.Ex60.m1.1.1.2.3.3.cmml" xref="A0.Ex60.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex60.m1.1.1.3.cmml" xref="A0.Ex60.m1.1.1.3"><root id="A0.Ex60.m1.1.1.3a.cmml" xref="A0.Ex60.m1.1.1.3"></root><apply id="A0.Ex60.m1.1.1.3.2.cmml" xref="A0.Ex60.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex60.m1.1.1.3.2.1.cmml" xref="A0.Ex60.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex60.m1.1.1.3.2.2.cmml" xref="A0.Ex60.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex60.m1.1.1.3.2.3a.cmml" xref="A0.Ex60.m1.1.1.3.2.3"><mtext id="A0.Ex60.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex60.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply></apply><apply id="A0.Ex60.m1.3.3.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3"><times id="A0.Ex60.m1.3.3.2.3.1.cmml" xref="A0.Ex60.m1.3.3.2.3.1"></times><apply id="A0.Ex60.m1.3.3.2.3.2.cmml" xref="A0.Ex60.m1.3.3.2.3.2"><divide id="A0.Ex60.m1.3.3.2.3.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.2"></divide><cn id="A0.Ex60.m1.3.3.2.3.2.2.cmml" type="integer" xref="A0.Ex60.m1.3.3.2.3.2.2">1</cn><ci id="A0.Ex60.m1.3.3.2.3.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.2.3">𝑃</ci></apply><apply id="A0.Ex60.m1.3.3.2.3.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3"><apply id="A0.Ex60.m1.3.3.2.3.3.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.1.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1">superscript</csymbol><apply id="A0.Ex60.m1.3.3.2.3.3.1.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.1.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1">subscript</csymbol><sum id="A0.Ex60.m1.3.3.2.3.3.1.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1.2.2"></sum><apply id="A0.Ex60.m1.3.3.2.3.3.1.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3"><eq id="A0.Ex60.m1.3.3.2.3.3.1.2.3.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.1"></eq><ci id="A0.Ex60.m1.3.3.2.3.3.1.2.3.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.2">𝑗</ci><cn id="A0.Ex60.m1.3.3.2.3.3.1.2.3.3.cmml" type="integer" xref="A0.Ex60.m1.3.3.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="A0.Ex60.m1.3.3.2.3.3.1.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.1.3">𝑃</ci></apply><apply id="A0.Ex60.m1.3.3.2.3.3.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2"><divide id="A0.Ex60.m1.3.3.2.3.3.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2"></divide><apply id="A0.Ex60.m1.3.3.2.3.3.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2"><times id="A0.Ex60.m1.3.3.2.3.3.2.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.1"></times><apply id="A0.Ex60.m1.3.3.2.3.3.2.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.2.2.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2">subscript</csymbol><ci id="A0.Ex60.m1.3.3.2.3.3.2.2.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2.2">𝑞</ci><ci id="A0.Ex60.m1.3.3.2.3.3.2.2.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.2.3">𝑖</ci></apply><apply id="A0.Ex60.m1.3.3.2.3.3.2.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.2.2.3.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3">superscript</csymbol><apply id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3">subscript</csymbol><ci id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.2">𝑘</ci><ci id="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.2.3">𝑗</ci></apply><csymbol cd="latexml" id="A0.Ex60.m1.3.3.2.3.3.2.2.3.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex60.m1.3.3.2.3.3.2.3.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3"><root id="A0.Ex60.m1.3.3.2.3.3.2.3a.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3"></root><apply id="A0.Ex60.m1.3.3.2.3.3.2.3.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2"><csymbol cd="ambiguous" id="A0.Ex60.m1.3.3.2.3.3.2.3.2.1.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2">subscript</csymbol><ci id="A0.Ex60.m1.3.3.2.3.3.2.3.2.2.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.2">𝑑</ci><ci id="A0.Ex60.m1.3.3.2.3.3.2.3.2.3a.cmml" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.3"><mtext id="A0.Ex60.m1.3.3.2.3.3.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex60.m1.3.3.2.3.3.2.3.2.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex60.m1.3c">M(q_{i})=\max_{j}\left(\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}\right%
)-\frac{1}{P}\sum_{j=1}^{P}\frac{q_{i}k_{j}^{\top}}{\sqrt{d_{\text{model}}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex60.m1.3d">italic_M ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = roman_max start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) - divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>     Select top-<math alttext="u" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_u</annotation></semantics></math> queries (<math alttext="u=c\log P" class="ltx_Math" display="inline" id="alg2.l8.m2.1"><semantics id="alg2.l8.m2.1a"><mrow id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml"><mi id="alg2.l8.m2.1.1.2" xref="alg2.l8.m2.1.1.2.cmml">u</mi><mo id="alg2.l8.m2.1.1.1" xref="alg2.l8.m2.1.1.1.cmml">=</mo><mrow id="alg2.l8.m2.1.1.3" xref="alg2.l8.m2.1.1.3.cmml"><mi id="alg2.l8.m2.1.1.3.2" xref="alg2.l8.m2.1.1.3.2.cmml">c</mi><mo id="alg2.l8.m2.1.1.3.1" lspace="0.167em" xref="alg2.l8.m2.1.1.3.1.cmml">⁢</mo><mrow id="alg2.l8.m2.1.1.3.3" xref="alg2.l8.m2.1.1.3.3.cmml"><mi id="alg2.l8.m2.1.1.3.3.1" xref="alg2.l8.m2.1.1.3.3.1.cmml">log</mi><mo id="alg2.l8.m2.1.1.3.3a" lspace="0.167em" xref="alg2.l8.m2.1.1.3.3.cmml">⁡</mo><mi id="alg2.l8.m2.1.1.3.3.2" xref="alg2.l8.m2.1.1.3.3.2.cmml">P</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><apply id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1"><eq id="alg2.l8.m2.1.1.1.cmml" xref="alg2.l8.m2.1.1.1"></eq><ci id="alg2.l8.m2.1.1.2.cmml" xref="alg2.l8.m2.1.1.2">𝑢</ci><apply id="alg2.l8.m2.1.1.3.cmml" xref="alg2.l8.m2.1.1.3"><times id="alg2.l8.m2.1.1.3.1.cmml" xref="alg2.l8.m2.1.1.3.1"></times><ci id="alg2.l8.m2.1.1.3.2.cmml" xref="alg2.l8.m2.1.1.3.2">𝑐</ci><apply id="alg2.l8.m2.1.1.3.3.cmml" xref="alg2.l8.m2.1.1.3.3"><log id="alg2.l8.m2.1.1.3.3.1.cmml" xref="alg2.l8.m2.1.1.3.3.1"></log><ci id="alg2.l8.m2.1.1.3.3.2.cmml" xref="alg2.l8.m2.1.1.3.3.2">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">u=c\log P</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m2.1d">italic_u = italic_c roman_log italic_P</annotation></semantics></math>) based on <math alttext="M(q_{i})" class="ltx_Math" display="inline" id="alg2.l8.m3.1"><semantics id="alg2.l8.m3.1a"><mrow id="alg2.l8.m3.1.1" xref="alg2.l8.m3.1.1.cmml"><mi id="alg2.l8.m3.1.1.3" xref="alg2.l8.m3.1.1.3.cmml">M</mi><mo id="alg2.l8.m3.1.1.2" xref="alg2.l8.m3.1.1.2.cmml">⁢</mo><mrow id="alg2.l8.m3.1.1.1.1" xref="alg2.l8.m3.1.1.1.1.1.cmml"><mo id="alg2.l8.m3.1.1.1.1.2" stretchy="false" xref="alg2.l8.m3.1.1.1.1.1.cmml">(</mo><msub id="alg2.l8.m3.1.1.1.1.1" xref="alg2.l8.m3.1.1.1.1.1.cmml"><mi id="alg2.l8.m3.1.1.1.1.1.2" xref="alg2.l8.m3.1.1.1.1.1.2.cmml">q</mi><mi id="alg2.l8.m3.1.1.1.1.1.3" xref="alg2.l8.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l8.m3.1.1.1.1.3" stretchy="false" xref="alg2.l8.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m3.1b"><apply id="alg2.l8.m3.1.1.cmml" xref="alg2.l8.m3.1.1"><times id="alg2.l8.m3.1.1.2.cmml" xref="alg2.l8.m3.1.1.2"></times><ci id="alg2.l8.m3.1.1.3.cmml" xref="alg2.l8.m3.1.1.3">𝑀</ci><apply id="alg2.l8.m3.1.1.1.1.1.cmml" xref="alg2.l8.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m3.1.1.1.1.1.1.cmml" xref="alg2.l8.m3.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m3.1.1.1.1.1.2.cmml" xref="alg2.l8.m3.1.1.1.1.1.2">𝑞</ci><ci id="alg2.l8.m3.1.1.1.1.1.3.cmml" xref="alg2.l8.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m3.1c">M(q_{i})</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m3.1d">italic_M ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>     For top-<math alttext="u" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_u</annotation></semantics></math> queries, compute full attention:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex61">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attn}(q_{i},K,V)=\text{Softmax}\left(\frac{q_{i}K^{\top}}{\sqrt{d_{\text%
{model}}}}\right)V" class="ltx_Math" display="block" id="A0.Ex61.m1.4"><semantics id="A0.Ex61.m1.4a"><mrow id="A0.Ex61.m1.4.4" xref="A0.Ex61.m1.4.4.cmml"><mrow id="A0.Ex61.m1.4.4.1" xref="A0.Ex61.m1.4.4.1.cmml"><mtext id="A0.Ex61.m1.4.4.1.3" xref="A0.Ex61.m1.4.4.1.3a.cmml">Attn</mtext><mo id="A0.Ex61.m1.4.4.1.2" xref="A0.Ex61.m1.4.4.1.2.cmml">⁢</mo><mrow id="A0.Ex61.m1.4.4.1.1.1" xref="A0.Ex61.m1.4.4.1.1.2.cmml"><mo id="A0.Ex61.m1.4.4.1.1.1.2" stretchy="false" xref="A0.Ex61.m1.4.4.1.1.2.cmml">(</mo><msub id="A0.Ex61.m1.4.4.1.1.1.1" xref="A0.Ex61.m1.4.4.1.1.1.1.cmml"><mi id="A0.Ex61.m1.4.4.1.1.1.1.2" xref="A0.Ex61.m1.4.4.1.1.1.1.2.cmml">q</mi><mi id="A0.Ex61.m1.4.4.1.1.1.1.3" xref="A0.Ex61.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="A0.Ex61.m1.4.4.1.1.1.3" xref="A0.Ex61.m1.4.4.1.1.2.cmml">,</mo><mi id="A0.Ex61.m1.1.1" xref="A0.Ex61.m1.1.1.cmml">K</mi><mo id="A0.Ex61.m1.4.4.1.1.1.4" xref="A0.Ex61.m1.4.4.1.1.2.cmml">,</mo><mi id="A0.Ex61.m1.2.2" xref="A0.Ex61.m1.2.2.cmml">V</mi><mo id="A0.Ex61.m1.4.4.1.1.1.5" stretchy="false" xref="A0.Ex61.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A0.Ex61.m1.4.4.2" xref="A0.Ex61.m1.4.4.2.cmml">=</mo><mrow id="A0.Ex61.m1.4.4.3" xref="A0.Ex61.m1.4.4.3.cmml"><mtext id="A0.Ex61.m1.4.4.3.2" xref="A0.Ex61.m1.4.4.3.2a.cmml">Softmax</mtext><mo id="A0.Ex61.m1.4.4.3.1" xref="A0.Ex61.m1.4.4.3.1.cmml">⁢</mo><mrow id="A0.Ex61.m1.4.4.3.3.2" xref="A0.Ex61.m1.3.3.cmml"><mo id="A0.Ex61.m1.4.4.3.3.2.1" xref="A0.Ex61.m1.3.3.cmml">(</mo><mfrac id="A0.Ex61.m1.3.3" xref="A0.Ex61.m1.3.3.cmml"><mrow id="A0.Ex61.m1.3.3.2" xref="A0.Ex61.m1.3.3.2.cmml"><msub id="A0.Ex61.m1.3.3.2.2" xref="A0.Ex61.m1.3.3.2.2.cmml"><mi id="A0.Ex61.m1.3.3.2.2.2" xref="A0.Ex61.m1.3.3.2.2.2.cmml">q</mi><mi id="A0.Ex61.m1.3.3.2.2.3" xref="A0.Ex61.m1.3.3.2.2.3.cmml">i</mi></msub><mo id="A0.Ex61.m1.3.3.2.1" xref="A0.Ex61.m1.3.3.2.1.cmml">⁢</mo><msup id="A0.Ex61.m1.3.3.2.3" xref="A0.Ex61.m1.3.3.2.3.cmml"><mi id="A0.Ex61.m1.3.3.2.3.2" xref="A0.Ex61.m1.3.3.2.3.2.cmml">K</mi><mo id="A0.Ex61.m1.3.3.2.3.3" xref="A0.Ex61.m1.3.3.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex61.m1.3.3.3" xref="A0.Ex61.m1.3.3.3.cmml"><msub id="A0.Ex61.m1.3.3.3.2" xref="A0.Ex61.m1.3.3.3.2.cmml"><mi id="A0.Ex61.m1.3.3.3.2.2" xref="A0.Ex61.m1.3.3.3.2.2.cmml">d</mi><mtext id="A0.Ex61.m1.3.3.3.2.3" xref="A0.Ex61.m1.3.3.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex61.m1.4.4.3.3.2.2" xref="A0.Ex61.m1.3.3.cmml">)</mo></mrow><mo id="A0.Ex61.m1.4.4.3.1a" xref="A0.Ex61.m1.4.4.3.1.cmml">⁢</mo><mi id="A0.Ex61.m1.4.4.3.4" xref="A0.Ex61.m1.4.4.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex61.m1.4b"><apply id="A0.Ex61.m1.4.4.cmml" xref="A0.Ex61.m1.4.4"><eq id="A0.Ex61.m1.4.4.2.cmml" xref="A0.Ex61.m1.4.4.2"></eq><apply id="A0.Ex61.m1.4.4.1.cmml" xref="A0.Ex61.m1.4.4.1"><times id="A0.Ex61.m1.4.4.1.2.cmml" xref="A0.Ex61.m1.4.4.1.2"></times><ci id="A0.Ex61.m1.4.4.1.3a.cmml" xref="A0.Ex61.m1.4.4.1.3"><mtext id="A0.Ex61.m1.4.4.1.3.cmml" xref="A0.Ex61.m1.4.4.1.3">Attn</mtext></ci><vector id="A0.Ex61.m1.4.4.1.1.2.cmml" xref="A0.Ex61.m1.4.4.1.1.1"><apply id="A0.Ex61.m1.4.4.1.1.1.1.cmml" xref="A0.Ex61.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex61.m1.4.4.1.1.1.1.1.cmml" xref="A0.Ex61.m1.4.4.1.1.1.1">subscript</csymbol><ci id="A0.Ex61.m1.4.4.1.1.1.1.2.cmml" xref="A0.Ex61.m1.4.4.1.1.1.1.2">𝑞</ci><ci id="A0.Ex61.m1.4.4.1.1.1.1.3.cmml" xref="A0.Ex61.m1.4.4.1.1.1.1.3">𝑖</ci></apply><ci id="A0.Ex61.m1.1.1.cmml" xref="A0.Ex61.m1.1.1">𝐾</ci><ci id="A0.Ex61.m1.2.2.cmml" xref="A0.Ex61.m1.2.2">𝑉</ci></vector></apply><apply id="A0.Ex61.m1.4.4.3.cmml" xref="A0.Ex61.m1.4.4.3"><times id="A0.Ex61.m1.4.4.3.1.cmml" xref="A0.Ex61.m1.4.4.3.1"></times><ci id="A0.Ex61.m1.4.4.3.2a.cmml" xref="A0.Ex61.m1.4.4.3.2"><mtext id="A0.Ex61.m1.4.4.3.2.cmml" xref="A0.Ex61.m1.4.4.3.2">Softmax</mtext></ci><apply id="A0.Ex61.m1.3.3.cmml" xref="A0.Ex61.m1.4.4.3.3.2"><divide id="A0.Ex61.m1.3.3.1.cmml" xref="A0.Ex61.m1.4.4.3.3.2"></divide><apply id="A0.Ex61.m1.3.3.2.cmml" xref="A0.Ex61.m1.3.3.2"><times id="A0.Ex61.m1.3.3.2.1.cmml" xref="A0.Ex61.m1.3.3.2.1"></times><apply id="A0.Ex61.m1.3.3.2.2.cmml" xref="A0.Ex61.m1.3.3.2.2"><csymbol cd="ambiguous" id="A0.Ex61.m1.3.3.2.2.1.cmml" xref="A0.Ex61.m1.3.3.2.2">subscript</csymbol><ci id="A0.Ex61.m1.3.3.2.2.2.cmml" xref="A0.Ex61.m1.3.3.2.2.2">𝑞</ci><ci id="A0.Ex61.m1.3.3.2.2.3.cmml" xref="A0.Ex61.m1.3.3.2.2.3">𝑖</ci></apply><apply id="A0.Ex61.m1.3.3.2.3.cmml" xref="A0.Ex61.m1.3.3.2.3"><csymbol cd="ambiguous" id="A0.Ex61.m1.3.3.2.3.1.cmml" xref="A0.Ex61.m1.3.3.2.3">superscript</csymbol><ci id="A0.Ex61.m1.3.3.2.3.2.cmml" xref="A0.Ex61.m1.3.3.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex61.m1.3.3.2.3.3.cmml" xref="A0.Ex61.m1.3.3.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex61.m1.3.3.3.cmml" xref="A0.Ex61.m1.3.3.3"><root id="A0.Ex61.m1.3.3.3a.cmml" xref="A0.Ex61.m1.3.3.3"></root><apply id="A0.Ex61.m1.3.3.3.2.cmml" xref="A0.Ex61.m1.3.3.3.2"><csymbol cd="ambiguous" id="A0.Ex61.m1.3.3.3.2.1.cmml" xref="A0.Ex61.m1.3.3.3.2">subscript</csymbol><ci id="A0.Ex61.m1.3.3.3.2.2.cmml" xref="A0.Ex61.m1.3.3.3.2.2">𝑑</ci><ci id="A0.Ex61.m1.3.3.3.2.3a.cmml" xref="A0.Ex61.m1.3.3.3.2.3"><mtext id="A0.Ex61.m1.3.3.3.2.3.cmml" mathsize="70%" xref="A0.Ex61.m1.3.3.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex61.m1.4.4.3.4.cmml" xref="A0.Ex61.m1.4.4.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex61.m1.4c">\text{Attn}(q_{i},K,V)=\text{Softmax}\left(\frac{q_{i}K^{\top}}{\sqrt{d_{\text%
{model}}}}\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex61.m1.4d">Attn ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K , italic_V ) = Softmax ( divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>     For other queries, use top-<math alttext="u" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_u</annotation></semantics></math> keys (sparse approximation)

</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>     Apply feedforward layers and residual connections

</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l12.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l12.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span>Let encoder output: <math alttext="\mathbf{H}^{\text{enc}}\in\mathbb{R}^{B\times P\times d_{\text{model}}}" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msup id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.2.2" xref="alg2.l13.m1.1.1.2.2.cmml">𝐇</mi><mtext id="alg2.l13.m1.1.1.2.3" xref="alg2.l13.m1.1.1.2.3a.cmml">enc</mtext></msup><mo id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">∈</mo><msup id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"><mi id="alg2.l13.m1.1.1.3.2" xref="alg2.l13.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.l13.m1.1.1.3.3" xref="alg2.l13.m1.1.1.3.3.cmml"><mi id="alg2.l13.m1.1.1.3.3.2" xref="alg2.l13.m1.1.1.3.3.2.cmml">B</mi><mo id="alg2.l13.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l13.m1.1.1.3.3.1.cmml">×</mo><mi id="alg2.l13.m1.1.1.3.3.3" xref="alg2.l13.m1.1.1.3.3.3.cmml">P</mi><mo id="alg2.l13.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg2.l13.m1.1.1.3.3.1.cmml">×</mo><msub id="alg2.l13.m1.1.1.3.3.4" xref="alg2.l13.m1.1.1.3.3.4.cmml"><mi id="alg2.l13.m1.1.1.3.3.4.2" xref="alg2.l13.m1.1.1.3.3.4.2.cmml">d</mi><mtext id="alg2.l13.m1.1.1.3.3.4.3" xref="alg2.l13.m1.1.1.3.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><in id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"></in><apply id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.2">superscript</csymbol><ci id="alg2.l13.m1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.2.2">𝐇</ci><ci id="alg2.l13.m1.1.1.2.3a.cmml" xref="alg2.l13.m1.1.1.2.3"><mtext id="alg2.l13.m1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l13.m1.1.1.2.3">enc</mtext></ci></apply><apply id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.3">superscript</csymbol><ci id="alg2.l13.m1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.3.2">ℝ</ci><apply id="alg2.l13.m1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.3.3"><times id="alg2.l13.m1.1.1.3.3.1.cmml" xref="alg2.l13.m1.1.1.3.3.1"></times><ci id="alg2.l13.m1.1.1.3.3.2.cmml" xref="alg2.l13.m1.1.1.3.3.2">𝐵</ci><ci id="alg2.l13.m1.1.1.3.3.3.cmml" xref="alg2.l13.m1.1.1.3.3.3">𝑃</ci><apply id="alg2.l13.m1.1.1.3.3.4.cmml" xref="alg2.l13.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.3.3.4.1.cmml" xref="alg2.l13.m1.1.1.3.3.4">subscript</csymbol><ci id="alg2.l13.m1.1.1.3.3.4.2.cmml" xref="alg2.l13.m1.1.1.3.3.4.2">𝑑</ci><ci id="alg2.l13.m1.1.1.3.3.4.3a.cmml" xref="alg2.l13.m1.1.1.3.3.4.3"><mtext id="alg2.l13.m1.1.1.3.3.4.3.cmml" mathsize="50%" xref="alg2.l13.m1.1.1.3.3.4.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\mathbf{H}^{\text{enc}}\in\mathbb{R}^{B\times P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l14.2">Step 3: Decoder Initialization</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">15:</span></span>Repeat last input value <math alttext="H" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">italic_H</annotation></semantics></math> times:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex62">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}^{\text{rep}}=\text{Repeat}(\mathbf{x}_{:,-1,:},H)\in\mathbb{R}^{B%
\times H\times 1}" class="ltx_Math" display="block" id="A0.Ex62.m1.5"><semantics id="A0.Ex62.m1.5a"><mrow id="A0.Ex62.m1.5.5" xref="A0.Ex62.m1.5.5.cmml"><msup id="A0.Ex62.m1.5.5.3" xref="A0.Ex62.m1.5.5.3.cmml"><mi id="A0.Ex62.m1.5.5.3.2" xref="A0.Ex62.m1.5.5.3.2.cmml">𝐱</mi><mtext id="A0.Ex62.m1.5.5.3.3" xref="A0.Ex62.m1.5.5.3.3a.cmml">rep</mtext></msup><mo id="A0.Ex62.m1.5.5.4" xref="A0.Ex62.m1.5.5.4.cmml">=</mo><mrow id="A0.Ex62.m1.5.5.1" xref="A0.Ex62.m1.5.5.1.cmml"><mtext id="A0.Ex62.m1.5.5.1.3" xref="A0.Ex62.m1.5.5.1.3a.cmml">Repeat</mtext><mo id="A0.Ex62.m1.5.5.1.2" xref="A0.Ex62.m1.5.5.1.2.cmml">⁢</mo><mrow id="A0.Ex62.m1.5.5.1.1.1" xref="A0.Ex62.m1.5.5.1.1.2.cmml"><mo id="A0.Ex62.m1.5.5.1.1.1.2" stretchy="false" xref="A0.Ex62.m1.5.5.1.1.2.cmml">(</mo><msub id="A0.Ex62.m1.5.5.1.1.1.1" xref="A0.Ex62.m1.5.5.1.1.1.1.cmml"><mi id="A0.Ex62.m1.5.5.1.1.1.1.2" xref="A0.Ex62.m1.5.5.1.1.1.1.2.cmml">𝐱</mi><mrow id="A0.Ex62.m1.3.3.3.3" xref="A0.Ex62.m1.3.3.3.4.cmml"><mo id="A0.Ex62.m1.1.1.1.1" rspace="0em" xref="A0.Ex62.m1.1.1.1.1.cmml">:</mo><mo id="A0.Ex62.m1.3.3.3.3.2" xref="A0.Ex62.m1.3.3.3.4.cmml">,</mo><mrow id="A0.Ex62.m1.3.3.3.3.1" xref="A0.Ex62.m1.3.3.3.3.1.cmml"><mo id="A0.Ex62.m1.3.3.3.3.1a" xref="A0.Ex62.m1.3.3.3.3.1.cmml">−</mo><mn id="A0.Ex62.m1.3.3.3.3.1.2" xref="A0.Ex62.m1.3.3.3.3.1.2.cmml">1</mn></mrow><mo id="A0.Ex62.m1.3.3.3.3.3" xref="A0.Ex62.m1.3.3.3.4.cmml">,</mo><mo id="A0.Ex62.m1.2.2.2.2" xref="A0.Ex62.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="A0.Ex62.m1.5.5.1.1.1.3" xref="A0.Ex62.m1.5.5.1.1.2.cmml">,</mo><mi id="A0.Ex62.m1.4.4" xref="A0.Ex62.m1.4.4.cmml">H</mi><mo id="A0.Ex62.m1.5.5.1.1.1.4" stretchy="false" xref="A0.Ex62.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A0.Ex62.m1.5.5.5" xref="A0.Ex62.m1.5.5.5.cmml">∈</mo><msup id="A0.Ex62.m1.5.5.6" xref="A0.Ex62.m1.5.5.6.cmml"><mi id="A0.Ex62.m1.5.5.6.2" xref="A0.Ex62.m1.5.5.6.2.cmml">ℝ</mi><mrow id="A0.Ex62.m1.5.5.6.3" xref="A0.Ex62.m1.5.5.6.3.cmml"><mi id="A0.Ex62.m1.5.5.6.3.2" xref="A0.Ex62.m1.5.5.6.3.2.cmml">B</mi><mo id="A0.Ex62.m1.5.5.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex62.m1.5.5.6.3.1.cmml">×</mo><mi id="A0.Ex62.m1.5.5.6.3.3" xref="A0.Ex62.m1.5.5.6.3.3.cmml">H</mi><mo id="A0.Ex62.m1.5.5.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex62.m1.5.5.6.3.1.cmml">×</mo><mn id="A0.Ex62.m1.5.5.6.3.4" xref="A0.Ex62.m1.5.5.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex62.m1.5b"><apply id="A0.Ex62.m1.5.5.cmml" xref="A0.Ex62.m1.5.5"><and id="A0.Ex62.m1.5.5a.cmml" xref="A0.Ex62.m1.5.5"></and><apply id="A0.Ex62.m1.5.5b.cmml" xref="A0.Ex62.m1.5.5"><eq id="A0.Ex62.m1.5.5.4.cmml" xref="A0.Ex62.m1.5.5.4"></eq><apply id="A0.Ex62.m1.5.5.3.cmml" xref="A0.Ex62.m1.5.5.3"><csymbol cd="ambiguous" id="A0.Ex62.m1.5.5.3.1.cmml" xref="A0.Ex62.m1.5.5.3">superscript</csymbol><ci id="A0.Ex62.m1.5.5.3.2.cmml" xref="A0.Ex62.m1.5.5.3.2">𝐱</ci><ci id="A0.Ex62.m1.5.5.3.3a.cmml" xref="A0.Ex62.m1.5.5.3.3"><mtext id="A0.Ex62.m1.5.5.3.3.cmml" mathsize="70%" xref="A0.Ex62.m1.5.5.3.3">rep</mtext></ci></apply><apply id="A0.Ex62.m1.5.5.1.cmml" xref="A0.Ex62.m1.5.5.1"><times id="A0.Ex62.m1.5.5.1.2.cmml" xref="A0.Ex62.m1.5.5.1.2"></times><ci id="A0.Ex62.m1.5.5.1.3a.cmml" xref="A0.Ex62.m1.5.5.1.3"><mtext id="A0.Ex62.m1.5.5.1.3.cmml" xref="A0.Ex62.m1.5.5.1.3">Repeat</mtext></ci><interval closure="open" id="A0.Ex62.m1.5.5.1.1.2.cmml" xref="A0.Ex62.m1.5.5.1.1.1"><apply id="A0.Ex62.m1.5.5.1.1.1.1.cmml" xref="A0.Ex62.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A0.Ex62.m1.5.5.1.1.1.1.1.cmml" xref="A0.Ex62.m1.5.5.1.1.1.1">subscript</csymbol><ci id="A0.Ex62.m1.5.5.1.1.1.1.2.cmml" xref="A0.Ex62.m1.5.5.1.1.1.1.2">𝐱</ci><list id="A0.Ex62.m1.3.3.3.4.cmml" xref="A0.Ex62.m1.3.3.3.3"><ci id="A0.Ex62.m1.1.1.1.1.cmml" xref="A0.Ex62.m1.1.1.1.1">:</ci><apply id="A0.Ex62.m1.3.3.3.3.1.cmml" xref="A0.Ex62.m1.3.3.3.3.1"><minus id="A0.Ex62.m1.3.3.3.3.1.1.cmml" xref="A0.Ex62.m1.3.3.3.3.1"></minus><cn id="A0.Ex62.m1.3.3.3.3.1.2.cmml" type="integer" xref="A0.Ex62.m1.3.3.3.3.1.2">1</cn></apply><ci id="A0.Ex62.m1.2.2.2.2.cmml" xref="A0.Ex62.m1.2.2.2.2">:</ci></list></apply><ci id="A0.Ex62.m1.4.4.cmml" xref="A0.Ex62.m1.4.4">𝐻</ci></interval></apply></apply><apply id="A0.Ex62.m1.5.5c.cmml" xref="A0.Ex62.m1.5.5"><in id="A0.Ex62.m1.5.5.5.cmml" xref="A0.Ex62.m1.5.5.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex62.m1.5.5.1.cmml" id="A0.Ex62.m1.5.5d.cmml" xref="A0.Ex62.m1.5.5"></share><apply id="A0.Ex62.m1.5.5.6.cmml" xref="A0.Ex62.m1.5.5.6"><csymbol cd="ambiguous" id="A0.Ex62.m1.5.5.6.1.cmml" xref="A0.Ex62.m1.5.5.6">superscript</csymbol><ci id="A0.Ex62.m1.5.5.6.2.cmml" xref="A0.Ex62.m1.5.5.6.2">ℝ</ci><apply id="A0.Ex62.m1.5.5.6.3.cmml" xref="A0.Ex62.m1.5.5.6.3"><times id="A0.Ex62.m1.5.5.6.3.1.cmml" xref="A0.Ex62.m1.5.5.6.3.1"></times><ci id="A0.Ex62.m1.5.5.6.3.2.cmml" xref="A0.Ex62.m1.5.5.6.3.2">𝐵</ci><ci id="A0.Ex62.m1.5.5.6.3.3.cmml" xref="A0.Ex62.m1.5.5.6.3.3">𝐻</ci><cn id="A0.Ex62.m1.5.5.6.3.4.cmml" type="integer" xref="A0.Ex62.m1.5.5.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex62.m1.5c">\mathbf{x}^{\text{rep}}=\text{Repeat}(\mathbf{x}_{:,-1,:},H)\in\mathbb{R}^{B%
\times H\times 1}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex62.m1.5d">bold_x start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT = Repeat ( bold_x start_POSTSUBSCRIPT : , - 1 , : end_POSTSUBSCRIPT , italic_H ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l16.1.1.1" style="font-size:80%;">16:</span></span>Project and add positional encoding:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex63">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}=\mathbf{x}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text%
{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex63.m1.2"><semantics id="A0.Ex63.m1.2a"><mrow id="A0.Ex63.m1.2.3" xref="A0.Ex63.m1.2.3.cmml"><msup id="A0.Ex63.m1.2.3.2" xref="A0.Ex63.m1.2.3.2.cmml"><mi id="A0.Ex63.m1.2.3.2.2" xref="A0.Ex63.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex63.m1.2.3.2.3" xref="A0.Ex63.m1.2.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex63.m1.2.3.3" xref="A0.Ex63.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex63.m1.2.3.4" xref="A0.Ex63.m1.2.3.4.cmml"><mrow id="A0.Ex63.m1.2.3.4.2" xref="A0.Ex63.m1.2.3.4.2.cmml"><msup id="A0.Ex63.m1.2.3.4.2.2" xref="A0.Ex63.m1.2.3.4.2.2.cmml"><mi id="A0.Ex63.m1.2.3.4.2.2.2" xref="A0.Ex63.m1.2.3.4.2.2.2.cmml">𝐱</mi><mtext id="A0.Ex63.m1.2.3.4.2.2.3" xref="A0.Ex63.m1.2.3.4.2.2.3a.cmml">rep</mtext></msup><mo id="A0.Ex63.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex63.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex63.m1.2.3.4.2.3" xref="A0.Ex63.m1.2.3.4.2.3.cmml"><mi id="A0.Ex63.m1.2.3.4.2.3.2.2" xref="A0.Ex63.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex63.m1.2.3.4.2.3.2.3" xref="A0.Ex63.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex63.m1.1.1.1.3" xref="A0.Ex63.m1.2.3.4.2.3.cmml"><mo id="A0.Ex63.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex63.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex63.m1.1.1.1.1" xref="A0.Ex63.m1.1.1.1.1.cmml">d</mi><mo id="A0.Ex63.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex63.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex63.m1.2.3.4.1" xref="A0.Ex63.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex63.m1.2.3.4.3" xref="A0.Ex63.m1.2.3.4.3.cmml"><mtext id="A0.Ex63.m1.2.3.4.3.2" xref="A0.Ex63.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex63.m1.2.2.1.3" xref="A0.Ex63.m1.2.3.4.3.cmml"><mo id="A0.Ex63.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex63.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex63.m1.2.2.1.1" xref="A0.Ex63.m1.2.2.1.1.cmml">d</mi><mo id="A0.Ex63.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex63.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex63.m1.2.3.5" xref="A0.Ex63.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex63.m1.2.3.6" xref="A0.Ex63.m1.2.3.6.cmml"><mi id="A0.Ex63.m1.2.3.6.2" xref="A0.Ex63.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex63.m1.2.3.6.3" xref="A0.Ex63.m1.2.3.6.3.cmml"><mi id="A0.Ex63.m1.2.3.6.3.2" xref="A0.Ex63.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex63.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex63.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex63.m1.2.3.6.3.3" xref="A0.Ex63.m1.2.3.6.3.3.cmml">H</mi><mo id="A0.Ex63.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex63.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex63.m1.2.3.6.3.4" xref="A0.Ex63.m1.2.3.6.3.4.cmml"><mi id="A0.Ex63.m1.2.3.6.3.4.2" xref="A0.Ex63.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex63.m1.2.3.6.3.4.3" xref="A0.Ex63.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex63.m1.2b"><apply id="A0.Ex63.m1.2.3.cmml" xref="A0.Ex63.m1.2.3"><and id="A0.Ex63.m1.2.3a.cmml" xref="A0.Ex63.m1.2.3"></and><apply id="A0.Ex63.m1.2.3b.cmml" xref="A0.Ex63.m1.2.3"><eq id="A0.Ex63.m1.2.3.3.cmml" xref="A0.Ex63.m1.2.3.3"></eq><apply id="A0.Ex63.m1.2.3.2.cmml" xref="A0.Ex63.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.2.1.cmml" xref="A0.Ex63.m1.2.3.2">superscript</csymbol><ci id="A0.Ex63.m1.2.3.2.2.cmml" xref="A0.Ex63.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex63.m1.2.3.2.3a.cmml" xref="A0.Ex63.m1.2.3.2.3"><mtext id="A0.Ex63.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex63.m1.2.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex63.m1.2.3.4.cmml" xref="A0.Ex63.m1.2.3.4"><plus id="A0.Ex63.m1.2.3.4.1.cmml" xref="A0.Ex63.m1.2.3.4.1"></plus><apply id="A0.Ex63.m1.2.3.4.2.cmml" xref="A0.Ex63.m1.2.3.4.2"><ci id="A0.Ex63.m1.2.3.4.2.1.cmml" xref="A0.Ex63.m1.2.3.4.2.1">⋅</ci><apply id="A0.Ex63.m1.2.3.4.2.2.cmml" xref="A0.Ex63.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.4.2.2.1.cmml" xref="A0.Ex63.m1.2.3.4.2.2">superscript</csymbol><ci id="A0.Ex63.m1.2.3.4.2.2.2.cmml" xref="A0.Ex63.m1.2.3.4.2.2.2">𝐱</ci><ci id="A0.Ex63.m1.2.3.4.2.2.3a.cmml" xref="A0.Ex63.m1.2.3.4.2.2.3"><mtext id="A0.Ex63.m1.2.3.4.2.2.3.cmml" mathsize="70%" xref="A0.Ex63.m1.2.3.4.2.2.3">rep</mtext></ci></apply><apply id="A0.Ex63.m1.2.3.4.2.3.cmml" xref="A0.Ex63.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.4.2.3.1.cmml" xref="A0.Ex63.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex63.m1.2.3.4.2.3.2.cmml" xref="A0.Ex63.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex63.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex63.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex63.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex63.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex63.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex63.m1.1.1.1.1.cmml" xref="A0.Ex63.m1.1.1.1.1">𝑑</ci></apply></apply><apply id="A0.Ex63.m1.2.3.4.3.cmml" xref="A0.Ex63.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.4.3.1.cmml" xref="A0.Ex63.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex63.m1.2.3.4.3.2a.cmml" xref="A0.Ex63.m1.2.3.4.3.2"><mtext id="A0.Ex63.m1.2.3.4.3.2.cmml" xref="A0.Ex63.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex63.m1.2.2.1.1.cmml" xref="A0.Ex63.m1.2.2.1.1">𝑑</ci></apply></apply></apply><apply id="A0.Ex63.m1.2.3c.cmml" xref="A0.Ex63.m1.2.3"><in id="A0.Ex63.m1.2.3.5.cmml" xref="A0.Ex63.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex63.m1.2.3.4.cmml" id="A0.Ex63.m1.2.3d.cmml" xref="A0.Ex63.m1.2.3"></share><apply id="A0.Ex63.m1.2.3.6.cmml" xref="A0.Ex63.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.6.1.cmml" xref="A0.Ex63.m1.2.3.6">superscript</csymbol><ci id="A0.Ex63.m1.2.3.6.2.cmml" xref="A0.Ex63.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex63.m1.2.3.6.3.cmml" xref="A0.Ex63.m1.2.3.6.3"><times id="A0.Ex63.m1.2.3.6.3.1.cmml" xref="A0.Ex63.m1.2.3.6.3.1"></times><ci id="A0.Ex63.m1.2.3.6.3.2.cmml" xref="A0.Ex63.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex63.m1.2.3.6.3.3.cmml" xref="A0.Ex63.m1.2.3.6.3.3">𝐻</ci><apply id="A0.Ex63.m1.2.3.6.3.4.cmml" xref="A0.Ex63.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex63.m1.2.3.6.3.4.1.cmml" xref="A0.Ex63.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex63.m1.2.3.6.3.4.2.cmml" xref="A0.Ex63.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex63.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex63.m1.2.3.6.3.4.3"><mtext id="A0.Ex63.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex63.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex63.m1.2c">\mathbf{Z}^{\text{dec}}=\mathbf{x}^{\text{rep}}\cdot\mathbf{W}_{e}^{(d)}+\text%
{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex63.m1.2d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT = bold_x start_POSTSUPERSCRIPT rep end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l17.2">Step 4: ProbSparse Transformer Decoder</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l18.2">for</span> each decoder layer <span class="ltx_text ltx_font_bold" id="alg2.l18.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l19.1.1.1" style="font-size:80%;">19:</span></span>     Compute self-attention using ProbSparse:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex64">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\quad K=\mathbf{Z}^{\text{dec%
}}\cdot\mathbf{W}^{K_{d}},\quad V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{V_{d}}" class="ltx_Math" display="block" id="A0.Ex64.m1.2"><semantics id="A0.Ex64.m1.2a"><mrow id="A0.Ex64.m1.2.2.2" xref="A0.Ex64.m1.2.2.3.cmml"><mrow id="A0.Ex64.m1.1.1.1.1" xref="A0.Ex64.m1.1.1.1.1.cmml"><mi id="A0.Ex64.m1.1.1.1.1.2" xref="A0.Ex64.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex64.m1.1.1.1.1.1" xref="A0.Ex64.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex64.m1.1.1.1.1.3" xref="A0.Ex64.m1.1.1.1.1.3.cmml"><msup id="A0.Ex64.m1.1.1.1.1.3.2" xref="A0.Ex64.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex64.m1.1.1.1.1.3.2.2" xref="A0.Ex64.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex64.m1.1.1.1.1.3.2.3" xref="A0.Ex64.m1.1.1.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex64.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex64.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex64.m1.1.1.1.1.3.3" xref="A0.Ex64.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex64.m1.1.1.1.1.3.3.2" xref="A0.Ex64.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex64.m1.1.1.1.1.3.3.3" xref="A0.Ex64.m1.1.1.1.1.3.3.3.cmml"><mi id="A0.Ex64.m1.1.1.1.1.3.3.3.2" xref="A0.Ex64.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="A0.Ex64.m1.1.1.1.1.3.3.3.3" xref="A0.Ex64.m1.1.1.1.1.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow><mo id="A0.Ex64.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex64.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex64.m1.2.2.2.2.2" xref="A0.Ex64.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex64.m1.2.2.2.2.1.1" xref="A0.Ex64.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex64.m1.2.2.2.2.1.1.2" xref="A0.Ex64.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex64.m1.2.2.2.2.1.1.1" xref="A0.Ex64.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex64.m1.2.2.2.2.1.1.3" xref="A0.Ex64.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex64.m1.2.2.2.2.1.1.3.2" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex64.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex64.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex64.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex64.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex64.m1.2.2.2.2.1.1.3.3" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex64.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.2" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.2.cmml">K</mi><mi id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.3" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow><mo id="A0.Ex64.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex64.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex64.m1.2.2.2.2.2.2" xref="A0.Ex64.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex64.m1.2.2.2.2.2.2.2" xref="A0.Ex64.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex64.m1.2.2.2.2.2.2.1" xref="A0.Ex64.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex64.m1.2.2.2.2.2.2.3" xref="A0.Ex64.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex64.m1.2.2.2.2.2.2.3.2" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex64.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex64.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex64.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex64.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex64.m1.2.2.2.2.2.2.3.3" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex64.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><msub id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.2" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.2.cmml">V</mi><mi id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.3" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.3.cmml">d</mi></msub></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex64.m1.2b"><apply id="A0.Ex64.m1.2.2.3.cmml" xref="A0.Ex64.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.3a.cmml" xref="A0.Ex64.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex64.m1.1.1.1.1.cmml" xref="A0.Ex64.m1.1.1.1.1"><eq id="A0.Ex64.m1.1.1.1.1.1.cmml" xref="A0.Ex64.m1.1.1.1.1.1"></eq><ci id="A0.Ex64.m1.1.1.1.1.2.cmml" xref="A0.Ex64.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex64.m1.1.1.1.1.3.cmml" xref="A0.Ex64.m1.1.1.1.1.3"><ci id="A0.Ex64.m1.1.1.1.1.3.1.cmml" xref="A0.Ex64.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex64.m1.1.1.1.1.3.2.cmml" xref="A0.Ex64.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex64.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex64.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex64.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex64.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex64.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex64.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex64.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex64.m1.1.1.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex64.m1.1.1.1.1.3.3.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex64.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3.2">𝐖</ci><apply id="A0.Ex64.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.1.1.1.1.3.3.3.1.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex64.m1.1.1.1.1.3.3.3.2.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="A0.Ex64.m1.1.1.1.1.3.3.3.3.cmml" xref="A0.Ex64.m1.1.1.1.1.3.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A0.Ex64.m1.2.2.2.2.3.cmml" xref="A0.Ex64.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.3a.cmml" xref="A0.Ex64.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex64.m1.2.2.2.2.1.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1"><eq id="A0.Ex64.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex64.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex64.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3"><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex64.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.2">𝐙</ci><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex64.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex64.m1.2.2.2.2.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex64.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><apply id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.2">𝐾</ci><ci id="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.1.1.3.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A0.Ex64.m1.2.2.2.2.2.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2"><eq id="A0.Ex64.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex64.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex64.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3"><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex64.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.2">𝐙</ci><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex64.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex64.m1.2.2.2.2.2.2.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex64.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><apply id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.2">𝑉</ci><ci id="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="A0.Ex64.m1.2.2.2.2.2.2.3.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex64.m1.2c">Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\quad K=\mathbf{Z}^{\text{dec%
}}\cdot\mathbf{W}^{K_{d}},\quad V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{V_{d}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex64.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_K = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_V = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex65">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SelfAttn}=\text{SparseAttention}(Q,K,V)" class="ltx_Math" display="block" id="A0.Ex65.m1.3"><semantics id="A0.Ex65.m1.3a"><mrow id="A0.Ex65.m1.3.4" xref="A0.Ex65.m1.3.4.cmml"><mtext id="A0.Ex65.m1.3.4.2" xref="A0.Ex65.m1.3.4.2a.cmml">SelfAttn</mtext><mo id="A0.Ex65.m1.3.4.1" xref="A0.Ex65.m1.3.4.1.cmml">=</mo><mrow id="A0.Ex65.m1.3.4.3" xref="A0.Ex65.m1.3.4.3.cmml"><mtext id="A0.Ex65.m1.3.4.3.2" xref="A0.Ex65.m1.3.4.3.2a.cmml">SparseAttention</mtext><mo id="A0.Ex65.m1.3.4.3.1" xref="A0.Ex65.m1.3.4.3.1.cmml">⁢</mo><mrow id="A0.Ex65.m1.3.4.3.3.2" xref="A0.Ex65.m1.3.4.3.3.1.cmml"><mo id="A0.Ex65.m1.3.4.3.3.2.1" stretchy="false" xref="A0.Ex65.m1.3.4.3.3.1.cmml">(</mo><mi id="A0.Ex65.m1.1.1" xref="A0.Ex65.m1.1.1.cmml">Q</mi><mo id="A0.Ex65.m1.3.4.3.3.2.2" xref="A0.Ex65.m1.3.4.3.3.1.cmml">,</mo><mi id="A0.Ex65.m1.2.2" xref="A0.Ex65.m1.2.2.cmml">K</mi><mo id="A0.Ex65.m1.3.4.3.3.2.3" xref="A0.Ex65.m1.3.4.3.3.1.cmml">,</mo><mi id="A0.Ex65.m1.3.3" xref="A0.Ex65.m1.3.3.cmml">V</mi><mo id="A0.Ex65.m1.3.4.3.3.2.4" stretchy="false" xref="A0.Ex65.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex65.m1.3b"><apply id="A0.Ex65.m1.3.4.cmml" xref="A0.Ex65.m1.3.4"><eq id="A0.Ex65.m1.3.4.1.cmml" xref="A0.Ex65.m1.3.4.1"></eq><ci id="A0.Ex65.m1.3.4.2a.cmml" xref="A0.Ex65.m1.3.4.2"><mtext id="A0.Ex65.m1.3.4.2.cmml" xref="A0.Ex65.m1.3.4.2">SelfAttn</mtext></ci><apply id="A0.Ex65.m1.3.4.3.cmml" xref="A0.Ex65.m1.3.4.3"><times id="A0.Ex65.m1.3.4.3.1.cmml" xref="A0.Ex65.m1.3.4.3.1"></times><ci id="A0.Ex65.m1.3.4.3.2a.cmml" xref="A0.Ex65.m1.3.4.3.2"><mtext id="A0.Ex65.m1.3.4.3.2.cmml" xref="A0.Ex65.m1.3.4.3.2">SparseAttention</mtext></ci><vector id="A0.Ex65.m1.3.4.3.3.1.cmml" xref="A0.Ex65.m1.3.4.3.3.2"><ci id="A0.Ex65.m1.1.1.cmml" xref="A0.Ex65.m1.1.1">𝑄</ci><ci id="A0.Ex65.m1.2.2.cmml" xref="A0.Ex65.m1.2.2">𝐾</ci><ci id="A0.Ex65.m1.3.3.cmml" xref="A0.Ex65.m1.3.3">𝑉</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex65.m1.3c">\text{SelfAttn}=\text{SparseAttention}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="A0.Ex65.m1.3d">SelfAttn = SparseAttention ( italic_Q , italic_K , italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l20.1.1.1" style="font-size:80%;">20:</span></span>     Compute cross-attention with encoder output:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex66">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}" class="ltx_Math" display="block" id="A0.Ex66.m1.2"><semantics id="A0.Ex66.m1.2a"><mrow id="A0.Ex66.m1.2.2.2" xref="A0.Ex66.m1.2.2.3.cmml"><mrow id="A0.Ex66.m1.1.1.1.1" xref="A0.Ex66.m1.1.1.1.1.cmml"><mi id="A0.Ex66.m1.1.1.1.1.2" xref="A0.Ex66.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex66.m1.1.1.1.1.1" xref="A0.Ex66.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex66.m1.1.1.1.1.3" xref="A0.Ex66.m1.1.1.1.1.3.cmml"><msup id="A0.Ex66.m1.1.1.1.1.3.2" xref="A0.Ex66.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex66.m1.1.1.1.1.3.2.2" xref="A0.Ex66.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex66.m1.1.1.1.1.3.2.3" xref="A0.Ex66.m1.1.1.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex66.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex66.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex66.m1.1.1.1.1.3.3" xref="A0.Ex66.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex66.m1.1.1.1.1.3.3.2" xref="A0.Ex66.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex66.m1.1.1.1.1.3.3.3" xref="A0.Ex66.m1.1.1.1.1.3.3.3.cmml"><mi id="A0.Ex66.m1.1.1.1.1.3.3.3.2" xref="A0.Ex66.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="A0.Ex66.m1.1.1.1.1.3.3.3.3" xref="A0.Ex66.m1.1.1.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex66.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex66.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex66.m1.2.2.2.2.2" xref="A0.Ex66.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex66.m1.2.2.2.2.1.1" xref="A0.Ex66.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex66.m1.2.2.2.2.1.1.2" xref="A0.Ex66.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex66.m1.2.2.2.2.1.1.1" xref="A0.Ex66.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex66.m1.2.2.2.2.1.1.3" xref="A0.Ex66.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex66.m1.2.2.2.2.1.1.3.2" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex66.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex66.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex66.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex66.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex66.m1.2.2.2.2.1.1.3.3" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex66.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.2" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.2.cmml">K</mi><mi id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.3" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex66.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex66.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex66.m1.2.2.2.2.2.2" xref="A0.Ex66.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex66.m1.2.2.2.2.2.2.2" xref="A0.Ex66.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex66.m1.2.2.2.2.2.2.1" xref="A0.Ex66.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex66.m1.2.2.2.2.2.2.3" xref="A0.Ex66.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex66.m1.2.2.2.2.2.2.3.2" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex66.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex66.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex66.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex66.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex66.m1.2.2.2.2.2.2.3.3" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex66.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><msub id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.2" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.2.cmml">V</mi><mi id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.3" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex66.m1.2b"><apply id="A0.Ex66.m1.2.2.3.cmml" xref="A0.Ex66.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.3a.cmml" xref="A0.Ex66.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex66.m1.1.1.1.1.cmml" xref="A0.Ex66.m1.1.1.1.1"><eq id="A0.Ex66.m1.1.1.1.1.1.cmml" xref="A0.Ex66.m1.1.1.1.1.1"></eq><ci id="A0.Ex66.m1.1.1.1.1.2.cmml" xref="A0.Ex66.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex66.m1.1.1.1.1.3.cmml" xref="A0.Ex66.m1.1.1.1.1.3"><ci id="A0.Ex66.m1.1.1.1.1.3.1.cmml" xref="A0.Ex66.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex66.m1.1.1.1.1.3.2.cmml" xref="A0.Ex66.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex66.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex66.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex66.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex66.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex66.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex66.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex66.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex66.m1.1.1.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex66.m1.1.1.1.1.3.3.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex66.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3.2">𝐖</ci><apply id="A0.Ex66.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.1.1.1.1.3.3.3.1.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex66.m1.1.1.1.1.3.3.3.2.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="A0.Ex66.m1.1.1.1.1.3.3.3.3.cmml" xref="A0.Ex66.m1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex66.m1.2.2.2.2.3.cmml" xref="A0.Ex66.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.3a.cmml" xref="A0.Ex66.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex66.m1.2.2.2.2.1.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1"><eq id="A0.Ex66.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex66.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex66.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3"><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex66.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.2">𝐇</ci><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex66.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex66.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex66.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><apply id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.2">𝐾</ci><ci id="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex66.m1.2.2.2.2.2.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2"><eq id="A0.Ex66.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex66.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex66.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3"><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex66.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.2">𝐇</ci><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex66.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex66.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex66.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><apply id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.2">𝑉</ci><ci id="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="A0.Ex66.m1.2.2.2.2.2.2.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex66.m1.2c">Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex66.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_K = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_V = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex67">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V" class="ltx_Math" display="block" id="A0.Ex67.m1.1"><semantics id="A0.Ex67.m1.1a"><mrow id="A0.Ex67.m1.1.2" xref="A0.Ex67.m1.1.2.cmml"><mtext id="A0.Ex67.m1.1.2.2" xref="A0.Ex67.m1.1.2.2a.cmml">CrossAttn</mtext><mo id="A0.Ex67.m1.1.2.1" xref="A0.Ex67.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex67.m1.1.2.3" xref="A0.Ex67.m1.1.2.3.cmml"><mtext id="A0.Ex67.m1.1.2.3.2" xref="A0.Ex67.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex67.m1.1.2.3.1" xref="A0.Ex67.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex67.m1.1.2.3.3.2" xref="A0.Ex67.m1.1.1.cmml"><mo id="A0.Ex67.m1.1.2.3.3.2.1" xref="A0.Ex67.m1.1.1.cmml">(</mo><mfrac id="A0.Ex67.m1.1.1" xref="A0.Ex67.m1.1.1.cmml"><mrow id="A0.Ex67.m1.1.1.2" xref="A0.Ex67.m1.1.1.2.cmml"><mi id="A0.Ex67.m1.1.1.2.2" xref="A0.Ex67.m1.1.1.2.2.cmml">Q</mi><mo id="A0.Ex67.m1.1.1.2.1" xref="A0.Ex67.m1.1.1.2.1.cmml">⁢</mo><msup id="A0.Ex67.m1.1.1.2.3" xref="A0.Ex67.m1.1.1.2.3.cmml"><mi id="A0.Ex67.m1.1.1.2.3.2" xref="A0.Ex67.m1.1.1.2.3.2.cmml">K</mi><mo id="A0.Ex67.m1.1.1.2.3.3" xref="A0.Ex67.m1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex67.m1.1.1.3" xref="A0.Ex67.m1.1.1.3.cmml"><msub id="A0.Ex67.m1.1.1.3.2" xref="A0.Ex67.m1.1.1.3.2.cmml"><mi id="A0.Ex67.m1.1.1.3.2.2" xref="A0.Ex67.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex67.m1.1.1.3.2.3" xref="A0.Ex67.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex67.m1.1.2.3.3.2.2" xref="A0.Ex67.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex67.m1.1.2.3.1a" xref="A0.Ex67.m1.1.2.3.1.cmml">⁢</mo><mi id="A0.Ex67.m1.1.2.3.4" xref="A0.Ex67.m1.1.2.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex67.m1.1b"><apply id="A0.Ex67.m1.1.2.cmml" xref="A0.Ex67.m1.1.2"><eq id="A0.Ex67.m1.1.2.1.cmml" xref="A0.Ex67.m1.1.2.1"></eq><ci id="A0.Ex67.m1.1.2.2a.cmml" xref="A0.Ex67.m1.1.2.2"><mtext id="A0.Ex67.m1.1.2.2.cmml" xref="A0.Ex67.m1.1.2.2">CrossAttn</mtext></ci><apply id="A0.Ex67.m1.1.2.3.cmml" xref="A0.Ex67.m1.1.2.3"><times id="A0.Ex67.m1.1.2.3.1.cmml" xref="A0.Ex67.m1.1.2.3.1"></times><ci id="A0.Ex67.m1.1.2.3.2a.cmml" xref="A0.Ex67.m1.1.2.3.2"><mtext id="A0.Ex67.m1.1.2.3.2.cmml" xref="A0.Ex67.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex67.m1.1.1.cmml" xref="A0.Ex67.m1.1.2.3.3.2"><divide id="A0.Ex67.m1.1.1.1.cmml" xref="A0.Ex67.m1.1.2.3.3.2"></divide><apply id="A0.Ex67.m1.1.1.2.cmml" xref="A0.Ex67.m1.1.1.2"><times id="A0.Ex67.m1.1.1.2.1.cmml" xref="A0.Ex67.m1.1.1.2.1"></times><ci id="A0.Ex67.m1.1.1.2.2.cmml" xref="A0.Ex67.m1.1.1.2.2">𝑄</ci><apply id="A0.Ex67.m1.1.1.2.3.cmml" xref="A0.Ex67.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex67.m1.1.1.2.3.1.cmml" xref="A0.Ex67.m1.1.1.2.3">superscript</csymbol><ci id="A0.Ex67.m1.1.1.2.3.2.cmml" xref="A0.Ex67.m1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex67.m1.1.1.2.3.3.cmml" xref="A0.Ex67.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex67.m1.1.1.3.cmml" xref="A0.Ex67.m1.1.1.3"><root id="A0.Ex67.m1.1.1.3a.cmml" xref="A0.Ex67.m1.1.1.3"></root><apply id="A0.Ex67.m1.1.1.3.2.cmml" xref="A0.Ex67.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex67.m1.1.1.3.2.1.cmml" xref="A0.Ex67.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex67.m1.1.1.3.2.2.cmml" xref="A0.Ex67.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex67.m1.1.1.3.2.3a.cmml" xref="A0.Ex67.m1.1.1.3.2.3"><mtext id="A0.Ex67.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex67.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex67.m1.1.2.3.4.cmml" xref="A0.Ex67.m1.1.2.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex67.m1.1c">\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex67.m1.1d">CrossAttn = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l21.1.1.1" style="font-size:80%;">21:</span></span>     Apply residual and feedforward layers

</div>
<div class="ltx_listingline" id="alg2.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l22.1.1.1" style="font-size:80%;">22:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l22.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l22.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l23.1.1.1" style="font-size:80%;">23:</span></span>Let decoder output: <math alttext="\mathbf{H}^{\text{dec}}\in\mathbb{R}^{B\times H\times d_{\text{model}}}" class="ltx_Math" display="inline" id="alg2.l23.m1.1"><semantics id="alg2.l23.m1.1a"><mrow id="alg2.l23.m1.1.1" xref="alg2.l23.m1.1.1.cmml"><msup id="alg2.l23.m1.1.1.2" xref="alg2.l23.m1.1.1.2.cmml"><mi id="alg2.l23.m1.1.1.2.2" xref="alg2.l23.m1.1.1.2.2.cmml">𝐇</mi><mtext id="alg2.l23.m1.1.1.2.3" xref="alg2.l23.m1.1.1.2.3a.cmml">dec</mtext></msup><mo id="alg2.l23.m1.1.1.1" xref="alg2.l23.m1.1.1.1.cmml">∈</mo><msup id="alg2.l23.m1.1.1.3" xref="alg2.l23.m1.1.1.3.cmml"><mi id="alg2.l23.m1.1.1.3.2" xref="alg2.l23.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg2.l23.m1.1.1.3.3" xref="alg2.l23.m1.1.1.3.3.cmml"><mi id="alg2.l23.m1.1.1.3.3.2" xref="alg2.l23.m1.1.1.3.3.2.cmml">B</mi><mo id="alg2.l23.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l23.m1.1.1.3.3.1.cmml">×</mo><mi id="alg2.l23.m1.1.1.3.3.3" xref="alg2.l23.m1.1.1.3.3.3.cmml">H</mi><mo id="alg2.l23.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg2.l23.m1.1.1.3.3.1.cmml">×</mo><msub id="alg2.l23.m1.1.1.3.3.4" xref="alg2.l23.m1.1.1.3.3.4.cmml"><mi id="alg2.l23.m1.1.1.3.3.4.2" xref="alg2.l23.m1.1.1.3.3.4.2.cmml">d</mi><mtext id="alg2.l23.m1.1.1.3.3.4.3" xref="alg2.l23.m1.1.1.3.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l23.m1.1b"><apply id="alg2.l23.m1.1.1.cmml" xref="alg2.l23.m1.1.1"><in id="alg2.l23.m1.1.1.1.cmml" xref="alg2.l23.m1.1.1.1"></in><apply id="alg2.l23.m1.1.1.2.cmml" xref="alg2.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l23.m1.1.1.2.1.cmml" xref="alg2.l23.m1.1.1.2">superscript</csymbol><ci id="alg2.l23.m1.1.1.2.2.cmml" xref="alg2.l23.m1.1.1.2.2">𝐇</ci><ci id="alg2.l23.m1.1.1.2.3a.cmml" xref="alg2.l23.m1.1.1.2.3"><mtext id="alg2.l23.m1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l23.m1.1.1.2.3">dec</mtext></ci></apply><apply id="alg2.l23.m1.1.1.3.cmml" xref="alg2.l23.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l23.m1.1.1.3.1.cmml" xref="alg2.l23.m1.1.1.3">superscript</csymbol><ci id="alg2.l23.m1.1.1.3.2.cmml" xref="alg2.l23.m1.1.1.3.2">ℝ</ci><apply id="alg2.l23.m1.1.1.3.3.cmml" xref="alg2.l23.m1.1.1.3.3"><times id="alg2.l23.m1.1.1.3.3.1.cmml" xref="alg2.l23.m1.1.1.3.3.1"></times><ci id="alg2.l23.m1.1.1.3.3.2.cmml" xref="alg2.l23.m1.1.1.3.3.2">𝐵</ci><ci id="alg2.l23.m1.1.1.3.3.3.cmml" xref="alg2.l23.m1.1.1.3.3.3">𝐻</ci><apply id="alg2.l23.m1.1.1.3.3.4.cmml" xref="alg2.l23.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg2.l23.m1.1.1.3.3.4.1.cmml" xref="alg2.l23.m1.1.1.3.3.4">subscript</csymbol><ci id="alg2.l23.m1.1.1.3.3.4.2.cmml" xref="alg2.l23.m1.1.1.3.3.4.2">𝑑</ci><ci id="alg2.l23.m1.1.1.3.3.4.3a.cmml" xref="alg2.l23.m1.1.1.3.3.4.3"><mtext id="alg2.l23.m1.1.1.3.3.4.3.cmml" mathsize="50%" xref="alg2.l23.m1.1.1.3.3.4.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.m1.1c">\mathbf{H}^{\text{dec}}\in\mathbb{R}^{B\times H\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l23.m1.1d">bold_H start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l24.1.1.1" style="font-size:80%;">24:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l24.2">Step 5: Output Projection</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex68">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}=\mathbf{H}^{\text{dec}}\cdot\mathbf{W}_{o}\in\mathbb{R}^{B%
\times H\times 1}" class="ltx_Math" display="block" id="A0.Ex68.m1.1"><semantics id="A0.Ex68.m1.1a"><mrow id="A0.Ex68.m1.1.1" xref="A0.Ex68.m1.1.1.cmml"><mover accent="true" id="A0.Ex68.m1.1.1.2" xref="A0.Ex68.m1.1.1.2.cmml"><mi id="A0.Ex68.m1.1.1.2.2" xref="A0.Ex68.m1.1.1.2.2.cmml">𝐲</mi><mo id="A0.Ex68.m1.1.1.2.1" xref="A0.Ex68.m1.1.1.2.1.cmml">^</mo></mover><mo id="A0.Ex68.m1.1.1.3" xref="A0.Ex68.m1.1.1.3.cmml">=</mo><mrow id="A0.Ex68.m1.1.1.4" xref="A0.Ex68.m1.1.1.4.cmml"><msup id="A0.Ex68.m1.1.1.4.2" xref="A0.Ex68.m1.1.1.4.2.cmml"><mi id="A0.Ex68.m1.1.1.4.2.2" xref="A0.Ex68.m1.1.1.4.2.2.cmml">𝐇</mi><mtext id="A0.Ex68.m1.1.1.4.2.3" xref="A0.Ex68.m1.1.1.4.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex68.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex68.m1.1.1.4.1.cmml">⋅</mo><msub id="A0.Ex68.m1.1.1.4.3" xref="A0.Ex68.m1.1.1.4.3.cmml"><mi id="A0.Ex68.m1.1.1.4.3.2" xref="A0.Ex68.m1.1.1.4.3.2.cmml">𝐖</mi><mi id="A0.Ex68.m1.1.1.4.3.3" xref="A0.Ex68.m1.1.1.4.3.3.cmml">o</mi></msub></mrow><mo id="A0.Ex68.m1.1.1.5" xref="A0.Ex68.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex68.m1.1.1.6" xref="A0.Ex68.m1.1.1.6.cmml"><mi id="A0.Ex68.m1.1.1.6.2" xref="A0.Ex68.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex68.m1.1.1.6.3" xref="A0.Ex68.m1.1.1.6.3.cmml"><mi id="A0.Ex68.m1.1.1.6.3.2" xref="A0.Ex68.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex68.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex68.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex68.m1.1.1.6.3.3" xref="A0.Ex68.m1.1.1.6.3.3.cmml">H</mi><mo id="A0.Ex68.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex68.m1.1.1.6.3.1.cmml">×</mo><mn id="A0.Ex68.m1.1.1.6.3.4" xref="A0.Ex68.m1.1.1.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex68.m1.1b"><apply id="A0.Ex68.m1.1.1.cmml" xref="A0.Ex68.m1.1.1"><and id="A0.Ex68.m1.1.1a.cmml" xref="A0.Ex68.m1.1.1"></and><apply id="A0.Ex68.m1.1.1b.cmml" xref="A0.Ex68.m1.1.1"><eq id="A0.Ex68.m1.1.1.3.cmml" xref="A0.Ex68.m1.1.1.3"></eq><apply id="A0.Ex68.m1.1.1.2.cmml" xref="A0.Ex68.m1.1.1.2"><ci id="A0.Ex68.m1.1.1.2.1.cmml" xref="A0.Ex68.m1.1.1.2.1">^</ci><ci id="A0.Ex68.m1.1.1.2.2.cmml" xref="A0.Ex68.m1.1.1.2.2">𝐲</ci></apply><apply id="A0.Ex68.m1.1.1.4.cmml" xref="A0.Ex68.m1.1.1.4"><ci id="A0.Ex68.m1.1.1.4.1.cmml" xref="A0.Ex68.m1.1.1.4.1">⋅</ci><apply id="A0.Ex68.m1.1.1.4.2.cmml" xref="A0.Ex68.m1.1.1.4.2"><csymbol cd="ambiguous" id="A0.Ex68.m1.1.1.4.2.1.cmml" xref="A0.Ex68.m1.1.1.4.2">superscript</csymbol><ci id="A0.Ex68.m1.1.1.4.2.2.cmml" xref="A0.Ex68.m1.1.1.4.2.2">𝐇</ci><ci id="A0.Ex68.m1.1.1.4.2.3a.cmml" xref="A0.Ex68.m1.1.1.4.2.3"><mtext id="A0.Ex68.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A0.Ex68.m1.1.1.4.2.3">dec</mtext></ci></apply><apply id="A0.Ex68.m1.1.1.4.3.cmml" xref="A0.Ex68.m1.1.1.4.3"><csymbol cd="ambiguous" id="A0.Ex68.m1.1.1.4.3.1.cmml" xref="A0.Ex68.m1.1.1.4.3">subscript</csymbol><ci id="A0.Ex68.m1.1.1.4.3.2.cmml" xref="A0.Ex68.m1.1.1.4.3.2">𝐖</ci><ci id="A0.Ex68.m1.1.1.4.3.3.cmml" xref="A0.Ex68.m1.1.1.4.3.3">𝑜</ci></apply></apply></apply><apply id="A0.Ex68.m1.1.1c.cmml" xref="A0.Ex68.m1.1.1"><in id="A0.Ex68.m1.1.1.5.cmml" xref="A0.Ex68.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex68.m1.1.1.4.cmml" id="A0.Ex68.m1.1.1d.cmml" xref="A0.Ex68.m1.1.1"></share><apply id="A0.Ex68.m1.1.1.6.cmml" xref="A0.Ex68.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex68.m1.1.1.6.1.cmml" xref="A0.Ex68.m1.1.1.6">superscript</csymbol><ci id="A0.Ex68.m1.1.1.6.2.cmml" xref="A0.Ex68.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex68.m1.1.1.6.3.cmml" xref="A0.Ex68.m1.1.1.6.3"><times id="A0.Ex68.m1.1.1.6.3.1.cmml" xref="A0.Ex68.m1.1.1.6.3.1"></times><ci id="A0.Ex68.m1.1.1.6.3.2.cmml" xref="A0.Ex68.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex68.m1.1.1.6.3.3.cmml" xref="A0.Ex68.m1.1.1.6.3.3">𝐻</ci><cn id="A0.Ex68.m1.1.1.6.3.4.cmml" type="integer" xref="A0.Ex68.m1.1.1.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex68.m1.1c">\hat{\mathbf{y}}=\mathbf{H}^{\text{dec}}\cdot\mathbf{W}_{o}\in\mathbb{R}^{B%
\times H\times 1}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex68.m1.1d">over^ start_ARG bold_y end_ARG = bold_H start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l25.1.1.1" style="font-size:80%;">25:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l25.2">return</span> <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="alg2.l25.m1.1"><semantics id="alg2.l25.m1.1a"><mover accent="true" id="alg2.l25.m1.1.1" xref="alg2.l25.m1.1.1.cmml"><mi id="alg2.l25.m1.1.1.2" xref="alg2.l25.m1.1.1.2.cmml">𝐲</mi><mo id="alg2.l25.m1.1.1.1" xref="alg2.l25.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.l25.m1.1b"><apply id="alg2.l25.m1.1.1.cmml" xref="alg2.l25.m1.1.1"><ci id="alg2.l25.m1.1.1.1.cmml" xref="alg2.l25.m1.1.1.1">^</ci><ci id="alg2.l25.m1.1.1.2.cmml" xref="alg2.l25.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.m1.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l25.m1.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math> (squeezed to shape <math alttext="\mathbb{R}^{B\times H}" class="ltx_Math" display="inline" id="alg2.l25.m2.1"><semantics id="alg2.l25.m2.1a"><msup id="alg2.l25.m2.1.1" xref="alg2.l25.m2.1.1.cmml"><mi id="alg2.l25.m2.1.1.2" xref="alg2.l25.m2.1.1.2.cmml">ℝ</mi><mrow id="alg2.l25.m2.1.1.3" xref="alg2.l25.m2.1.1.3.cmml"><mi id="alg2.l25.m2.1.1.3.2" xref="alg2.l25.m2.1.1.3.2.cmml">B</mi><mo id="alg2.l25.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l25.m2.1.1.3.1.cmml">×</mo><mi id="alg2.l25.m2.1.1.3.3" xref="alg2.l25.m2.1.1.3.3.cmml">H</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l25.m2.1b"><apply id="alg2.l25.m2.1.1.cmml" xref="alg2.l25.m2.1.1"><csymbol cd="ambiguous" id="alg2.l25.m2.1.1.1.cmml" xref="alg2.l25.m2.1.1">superscript</csymbol><ci id="alg2.l25.m2.1.1.2.cmml" xref="alg2.l25.m2.1.1.2">ℝ</ci><apply id="alg2.l25.m2.1.1.3.cmml" xref="alg2.l25.m2.1.1.3"><times id="alg2.l25.m2.1.1.3.1.cmml" xref="alg2.l25.m2.1.1.3.1"></times><ci id="alg2.l25.m2.1.1.3.2.cmml" xref="alg2.l25.m2.1.1.3.2">𝐵</ci><ci id="alg2.l25.m2.1.1.3.3.cmml" xref="alg2.l25.m2.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.m2.1c">\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="alg2.l25.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>)

</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.3.1.1">Algorithm 3</span> </span> Full <span class="ltx_text ltx_font_typewriter" id="alg3.4.2">Autoformer</span> Forecasting Procedure</figcaption>
<div class="ltx_listing ltx_listing" id="alg3.5">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l1.2">Input:</span> Sequence <math alttext="\mathbf{x}\in\mathbb{R}^{B\times P\times 1}" class="ltx_Math" display="inline" id="alg3.l1.m1.1"><semantics id="alg3.l1.m1.1a"><mrow id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><mi id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">𝐱</mi><mo id="alg3.l1.m1.1.1.1" xref="alg3.l1.m1.1.1.1.cmml">∈</mo><msup id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3.cmml"><mi id="alg3.l1.m1.1.1.3.2" xref="alg3.l1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg3.l1.m1.1.1.3.3" xref="alg3.l1.m1.1.1.3.3.cmml"><mi id="alg3.l1.m1.1.1.3.3.2" xref="alg3.l1.m1.1.1.3.3.2.cmml">B</mi><mo id="alg3.l1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg3.l1.m1.1.1.3.3.1.cmml">×</mo><mi id="alg3.l1.m1.1.1.3.3.3" xref="alg3.l1.m1.1.1.3.3.3.cmml">P</mi><mo id="alg3.l1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg3.l1.m1.1.1.3.3.1.cmml">×</mo><mn id="alg3.l1.m1.1.1.3.3.4" xref="alg3.l1.m1.1.1.3.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><in id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1"></in><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">𝐱</ci><apply id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.3.1.cmml" xref="alg3.l1.m1.1.1.3">superscript</csymbol><ci id="alg3.l1.m1.1.1.3.2.cmml" xref="alg3.l1.m1.1.1.3.2">ℝ</ci><apply id="alg3.l1.m1.1.1.3.3.cmml" xref="alg3.l1.m1.1.1.3.3"><times id="alg3.l1.m1.1.1.3.3.1.cmml" xref="alg3.l1.m1.1.1.3.3.1"></times><ci id="alg3.l1.m1.1.1.3.3.2.cmml" xref="alg3.l1.m1.1.1.3.3.2">𝐵</ci><ci id="alg3.l1.m1.1.1.3.3.3.cmml" xref="alg3.l1.m1.1.1.3.3.3">𝑃</ci><cn id="alg3.l1.m1.1.1.3.3.4.cmml" type="integer" xref="alg3.l1.m1.1.1.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">\mathbf{x}\in\mathbb{R}^{B\times P\times 1}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, forecast horizon <math alttext="H" class="ltx_Math" display="inline" id="alg3.l1.m2.1"><semantics id="alg3.l1.m2.1a"><mi id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><ci id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m2.1d">italic_H</annotation></semantics></math>, model dimension <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="alg3.l1.m3.1"><semantics id="alg3.l1.m3.1a"><msub id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml"><mi id="alg3.l1.m3.1.1.2" xref="alg3.l1.m3.1.1.2.cmml">d</mi><mtext id="alg3.l1.m3.1.1.3" xref="alg3.l1.m3.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><apply id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1"><csymbol cd="ambiguous" id="alg3.l1.m3.1.1.1.cmml" xref="alg3.l1.m3.1.1">subscript</csymbol><ci id="alg3.l1.m3.1.1.2.cmml" xref="alg3.l1.m3.1.1.2">𝑑</ci><ci id="alg3.l1.m3.1.1.3a.cmml" xref="alg3.l1.m3.1.1.3"><mtext id="alg3.l1.m3.1.1.3.cmml" mathsize="70%" xref="alg3.l1.m3.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m3.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l2.2">Output:</span> Forecast <math alttext="\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mover accent="true" id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml"><mi id="alg3.l2.m1.1.1.2.2" xref="alg3.l2.m1.1.1.2.2.cmml">𝐲</mi><mo id="alg3.l2.m1.1.1.2.1" xref="alg3.l2.m1.1.1.2.1.cmml">^</mo></mover><mo id="alg3.l2.m1.1.1.1" xref="alg3.l2.m1.1.1.1.cmml">∈</mo><msup id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml"><mi id="alg3.l2.m1.1.1.3.2" xref="alg3.l2.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg3.l2.m1.1.1.3.3" xref="alg3.l2.m1.1.1.3.3.cmml"><mi id="alg3.l2.m1.1.1.3.3.2" xref="alg3.l2.m1.1.1.3.3.2.cmml">B</mi><mo id="alg3.l2.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg3.l2.m1.1.1.3.3.1.cmml">×</mo><mi id="alg3.l2.m1.1.1.3.3.3" xref="alg3.l2.m1.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><in id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1"></in><apply id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2"><ci id="alg3.l2.m1.1.1.2.1.cmml" xref="alg3.l2.m1.1.1.2.1">^</ci><ci id="alg3.l2.m1.1.1.2.2.cmml" xref="alg3.l2.m1.1.1.2.2">𝐲</ci></apply><apply id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.1.cmml" xref="alg3.l2.m1.1.1.3">superscript</csymbol><ci id="alg3.l2.m1.1.1.3.2.cmml" xref="alg3.l2.m1.1.1.3.2">ℝ</ci><apply id="alg3.l2.m1.1.1.3.3.cmml" xref="alg3.l2.m1.1.1.3.3"><times id="alg3.l2.m1.1.1.3.3.1.cmml" xref="alg3.l2.m1.1.1.3.3.1"></times><ci id="alg3.l2.m1.1.1.3.3.2.cmml" xref="alg3.l2.m1.1.1.3.3.2">𝐵</ci><ci id="alg3.l2.m1.1.1.3.3.3.cmml" xref="alg3.l2.m1.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">\hat{\mathbf{y}}\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">over^ start_ARG bold_y end_ARG ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l3.2">Step 1: Series Decomposition</span>
</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l4.1.1.1" style="font-size:80%;">4:</span></span>Apply moving average of kernel size <math alttext="k" class="ltx_Math" display="inline" id="alg3.l4.m1.1"><semantics id="alg3.l4.m1.1a"><mi id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><ci id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.1d">italic_k</annotation></semantics></math>:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex69">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}^{\text{trend}}=\text{MA}_{k}(\mathbf{x}),\quad\mathbf{x}^{\text{%
seasonal}}=\mathbf{x}-\mathbf{x}^{\text{trend}}" class="ltx_Math" display="block" id="A0.Ex69.m1.3"><semantics id="A0.Ex69.m1.3a"><mrow id="A0.Ex69.m1.3.3.2" xref="A0.Ex69.m1.3.3.3.cmml"><mrow id="A0.Ex69.m1.2.2.1.1" xref="A0.Ex69.m1.2.2.1.1.cmml"><msup id="A0.Ex69.m1.2.2.1.1.2" xref="A0.Ex69.m1.2.2.1.1.2.cmml"><mi id="A0.Ex69.m1.2.2.1.1.2.2" xref="A0.Ex69.m1.2.2.1.1.2.2.cmml">𝐱</mi><mtext id="A0.Ex69.m1.2.2.1.1.2.3" xref="A0.Ex69.m1.2.2.1.1.2.3a.cmml">trend</mtext></msup><mo id="A0.Ex69.m1.2.2.1.1.1" xref="A0.Ex69.m1.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex69.m1.2.2.1.1.3" xref="A0.Ex69.m1.2.2.1.1.3.cmml"><msub id="A0.Ex69.m1.2.2.1.1.3.2" xref="A0.Ex69.m1.2.2.1.1.3.2.cmml"><mtext id="A0.Ex69.m1.2.2.1.1.3.2.2" xref="A0.Ex69.m1.2.2.1.1.3.2.2a.cmml">MA</mtext><mi id="A0.Ex69.m1.2.2.1.1.3.2.3" xref="A0.Ex69.m1.2.2.1.1.3.2.3.cmml">k</mi></msub><mo id="A0.Ex69.m1.2.2.1.1.3.1" xref="A0.Ex69.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A0.Ex69.m1.2.2.1.1.3.3.2" xref="A0.Ex69.m1.2.2.1.1.3.cmml"><mo id="A0.Ex69.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="A0.Ex69.m1.2.2.1.1.3.cmml">(</mo><mi id="A0.Ex69.m1.1.1" xref="A0.Ex69.m1.1.1.cmml">𝐱</mi><mo id="A0.Ex69.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="A0.Ex69.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A0.Ex69.m1.3.3.2.3" rspace="1.167em" xref="A0.Ex69.m1.3.3.3a.cmml">,</mo><mrow id="A0.Ex69.m1.3.3.2.2" xref="A0.Ex69.m1.3.3.2.2.cmml"><msup id="A0.Ex69.m1.3.3.2.2.2" xref="A0.Ex69.m1.3.3.2.2.2.cmml"><mi id="A0.Ex69.m1.3.3.2.2.2.2" xref="A0.Ex69.m1.3.3.2.2.2.2.cmml">𝐱</mi><mtext id="A0.Ex69.m1.3.3.2.2.2.3" xref="A0.Ex69.m1.3.3.2.2.2.3a.cmml">seasonal</mtext></msup><mo id="A0.Ex69.m1.3.3.2.2.1" xref="A0.Ex69.m1.3.3.2.2.1.cmml">=</mo><mrow id="A0.Ex69.m1.3.3.2.2.3" xref="A0.Ex69.m1.3.3.2.2.3.cmml"><mi id="A0.Ex69.m1.3.3.2.2.3.2" xref="A0.Ex69.m1.3.3.2.2.3.2.cmml">𝐱</mi><mo id="A0.Ex69.m1.3.3.2.2.3.1" xref="A0.Ex69.m1.3.3.2.2.3.1.cmml">−</mo><msup id="A0.Ex69.m1.3.3.2.2.3.3" xref="A0.Ex69.m1.3.3.2.2.3.3.cmml"><mi id="A0.Ex69.m1.3.3.2.2.3.3.2" xref="A0.Ex69.m1.3.3.2.2.3.3.2.cmml">𝐱</mi><mtext id="A0.Ex69.m1.3.3.2.2.3.3.3" xref="A0.Ex69.m1.3.3.2.2.3.3.3a.cmml">trend</mtext></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex69.m1.3b"><apply id="A0.Ex69.m1.3.3.3.cmml" xref="A0.Ex69.m1.3.3.2"><csymbol cd="ambiguous" id="A0.Ex69.m1.3.3.3a.cmml" xref="A0.Ex69.m1.3.3.2.3">formulae-sequence</csymbol><apply id="A0.Ex69.m1.2.2.1.1.cmml" xref="A0.Ex69.m1.2.2.1.1"><eq id="A0.Ex69.m1.2.2.1.1.1.cmml" xref="A0.Ex69.m1.2.2.1.1.1"></eq><apply id="A0.Ex69.m1.2.2.1.1.2.cmml" xref="A0.Ex69.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A0.Ex69.m1.2.2.1.1.2.1.cmml" xref="A0.Ex69.m1.2.2.1.1.2">superscript</csymbol><ci id="A0.Ex69.m1.2.2.1.1.2.2.cmml" xref="A0.Ex69.m1.2.2.1.1.2.2">𝐱</ci><ci id="A0.Ex69.m1.2.2.1.1.2.3a.cmml" xref="A0.Ex69.m1.2.2.1.1.2.3"><mtext id="A0.Ex69.m1.2.2.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex69.m1.2.2.1.1.2.3">trend</mtext></ci></apply><apply id="A0.Ex69.m1.2.2.1.1.3.cmml" xref="A0.Ex69.m1.2.2.1.1.3"><times id="A0.Ex69.m1.2.2.1.1.3.1.cmml" xref="A0.Ex69.m1.2.2.1.1.3.1"></times><apply id="A0.Ex69.m1.2.2.1.1.3.2.cmml" xref="A0.Ex69.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex69.m1.2.2.1.1.3.2.1.cmml" xref="A0.Ex69.m1.2.2.1.1.3.2">subscript</csymbol><ci id="A0.Ex69.m1.2.2.1.1.3.2.2a.cmml" xref="A0.Ex69.m1.2.2.1.1.3.2.2"><mtext id="A0.Ex69.m1.2.2.1.1.3.2.2.cmml" xref="A0.Ex69.m1.2.2.1.1.3.2.2">MA</mtext></ci><ci id="A0.Ex69.m1.2.2.1.1.3.2.3.cmml" xref="A0.Ex69.m1.2.2.1.1.3.2.3">𝑘</ci></apply><ci id="A0.Ex69.m1.1.1.cmml" xref="A0.Ex69.m1.1.1">𝐱</ci></apply></apply><apply id="A0.Ex69.m1.3.3.2.2.cmml" xref="A0.Ex69.m1.3.3.2.2"><eq id="A0.Ex69.m1.3.3.2.2.1.cmml" xref="A0.Ex69.m1.3.3.2.2.1"></eq><apply id="A0.Ex69.m1.3.3.2.2.2.cmml" xref="A0.Ex69.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A0.Ex69.m1.3.3.2.2.2.1.cmml" xref="A0.Ex69.m1.3.3.2.2.2">superscript</csymbol><ci id="A0.Ex69.m1.3.3.2.2.2.2.cmml" xref="A0.Ex69.m1.3.3.2.2.2.2">𝐱</ci><ci id="A0.Ex69.m1.3.3.2.2.2.3a.cmml" xref="A0.Ex69.m1.3.3.2.2.2.3"><mtext id="A0.Ex69.m1.3.3.2.2.2.3.cmml" mathsize="70%" xref="A0.Ex69.m1.3.3.2.2.2.3">seasonal</mtext></ci></apply><apply id="A0.Ex69.m1.3.3.2.2.3.cmml" xref="A0.Ex69.m1.3.3.2.2.3"><minus id="A0.Ex69.m1.3.3.2.2.3.1.cmml" xref="A0.Ex69.m1.3.3.2.2.3.1"></minus><ci id="A0.Ex69.m1.3.3.2.2.3.2.cmml" xref="A0.Ex69.m1.3.3.2.2.3.2">𝐱</ci><apply id="A0.Ex69.m1.3.3.2.2.3.3.cmml" xref="A0.Ex69.m1.3.3.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex69.m1.3.3.2.2.3.3.1.cmml" xref="A0.Ex69.m1.3.3.2.2.3.3">superscript</csymbol><ci id="A0.Ex69.m1.3.3.2.2.3.3.2.cmml" xref="A0.Ex69.m1.3.3.2.2.3.3.2">𝐱</ci><ci id="A0.Ex69.m1.3.3.2.2.3.3.3a.cmml" xref="A0.Ex69.m1.3.3.2.2.3.3.3"><mtext id="A0.Ex69.m1.3.3.2.2.3.3.3.cmml" mathsize="70%" xref="A0.Ex69.m1.3.3.2.2.3.3.3">trend</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex69.m1.3c">\mathbf{x}^{\text{trend}}=\text{MA}_{k}(\mathbf{x}),\quad\mathbf{x}^{\text{%
seasonal}}=\mathbf{x}-\mathbf{x}^{\text{trend}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex69.m1.3d">bold_x start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT = MA start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_x ) , bold_x start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT = bold_x - bold_x start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l5.2">Step 2: Encoder Path</span>
</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l6.1.1.1" style="font-size:80%;">6:</span></span>Project seasonal input:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex70">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{enc}}=\mathbf{x}^{\text{seasonal}}\cdot\mathbf{W}_{e}^{(e)}+%
\text{PE}^{(e)}\in\mathbb{R}^{B\times P\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex70.m1.2"><semantics id="A0.Ex70.m1.2a"><mrow id="A0.Ex70.m1.2.3" xref="A0.Ex70.m1.2.3.cmml"><msup id="A0.Ex70.m1.2.3.2" xref="A0.Ex70.m1.2.3.2.cmml"><mi id="A0.Ex70.m1.2.3.2.2" xref="A0.Ex70.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex70.m1.2.3.2.3" xref="A0.Ex70.m1.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex70.m1.2.3.3" xref="A0.Ex70.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex70.m1.2.3.4" xref="A0.Ex70.m1.2.3.4.cmml"><mrow id="A0.Ex70.m1.2.3.4.2" xref="A0.Ex70.m1.2.3.4.2.cmml"><msup id="A0.Ex70.m1.2.3.4.2.2" xref="A0.Ex70.m1.2.3.4.2.2.cmml"><mi id="A0.Ex70.m1.2.3.4.2.2.2" xref="A0.Ex70.m1.2.3.4.2.2.2.cmml">𝐱</mi><mtext id="A0.Ex70.m1.2.3.4.2.2.3" xref="A0.Ex70.m1.2.3.4.2.2.3a.cmml">seasonal</mtext></msup><mo id="A0.Ex70.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex70.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex70.m1.2.3.4.2.3" xref="A0.Ex70.m1.2.3.4.2.3.cmml"><mi id="A0.Ex70.m1.2.3.4.2.3.2.2" xref="A0.Ex70.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex70.m1.2.3.4.2.3.2.3" xref="A0.Ex70.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex70.m1.1.1.1.3" xref="A0.Ex70.m1.2.3.4.2.3.cmml"><mo id="A0.Ex70.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex70.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex70.m1.1.1.1.1" xref="A0.Ex70.m1.1.1.1.1.cmml">e</mi><mo id="A0.Ex70.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex70.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex70.m1.2.3.4.1" xref="A0.Ex70.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex70.m1.2.3.4.3" xref="A0.Ex70.m1.2.3.4.3.cmml"><mtext id="A0.Ex70.m1.2.3.4.3.2" xref="A0.Ex70.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex70.m1.2.2.1.3" xref="A0.Ex70.m1.2.3.4.3.cmml"><mo id="A0.Ex70.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex70.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex70.m1.2.2.1.1" xref="A0.Ex70.m1.2.2.1.1.cmml">e</mi><mo id="A0.Ex70.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex70.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex70.m1.2.3.5" xref="A0.Ex70.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex70.m1.2.3.6" xref="A0.Ex70.m1.2.3.6.cmml"><mi id="A0.Ex70.m1.2.3.6.2" xref="A0.Ex70.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex70.m1.2.3.6.3" xref="A0.Ex70.m1.2.3.6.3.cmml"><mi id="A0.Ex70.m1.2.3.6.3.2" xref="A0.Ex70.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex70.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex70.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex70.m1.2.3.6.3.3" xref="A0.Ex70.m1.2.3.6.3.3.cmml">P</mi><mo id="A0.Ex70.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex70.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex70.m1.2.3.6.3.4" xref="A0.Ex70.m1.2.3.6.3.4.cmml"><mi id="A0.Ex70.m1.2.3.6.3.4.2" xref="A0.Ex70.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex70.m1.2.3.6.3.4.3" xref="A0.Ex70.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex70.m1.2b"><apply id="A0.Ex70.m1.2.3.cmml" xref="A0.Ex70.m1.2.3"><and id="A0.Ex70.m1.2.3a.cmml" xref="A0.Ex70.m1.2.3"></and><apply id="A0.Ex70.m1.2.3b.cmml" xref="A0.Ex70.m1.2.3"><eq id="A0.Ex70.m1.2.3.3.cmml" xref="A0.Ex70.m1.2.3.3"></eq><apply id="A0.Ex70.m1.2.3.2.cmml" xref="A0.Ex70.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.2.1.cmml" xref="A0.Ex70.m1.2.3.2">superscript</csymbol><ci id="A0.Ex70.m1.2.3.2.2.cmml" xref="A0.Ex70.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex70.m1.2.3.2.3a.cmml" xref="A0.Ex70.m1.2.3.2.3"><mtext id="A0.Ex70.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex70.m1.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex70.m1.2.3.4.cmml" xref="A0.Ex70.m1.2.3.4"><plus id="A0.Ex70.m1.2.3.4.1.cmml" xref="A0.Ex70.m1.2.3.4.1"></plus><apply id="A0.Ex70.m1.2.3.4.2.cmml" xref="A0.Ex70.m1.2.3.4.2"><ci id="A0.Ex70.m1.2.3.4.2.1.cmml" xref="A0.Ex70.m1.2.3.4.2.1">⋅</ci><apply id="A0.Ex70.m1.2.3.4.2.2.cmml" xref="A0.Ex70.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.4.2.2.1.cmml" xref="A0.Ex70.m1.2.3.4.2.2">superscript</csymbol><ci id="A0.Ex70.m1.2.3.4.2.2.2.cmml" xref="A0.Ex70.m1.2.3.4.2.2.2">𝐱</ci><ci id="A0.Ex70.m1.2.3.4.2.2.3a.cmml" xref="A0.Ex70.m1.2.3.4.2.2.3"><mtext id="A0.Ex70.m1.2.3.4.2.2.3.cmml" mathsize="70%" xref="A0.Ex70.m1.2.3.4.2.2.3">seasonal</mtext></ci></apply><apply id="A0.Ex70.m1.2.3.4.2.3.cmml" xref="A0.Ex70.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.4.2.3.1.cmml" xref="A0.Ex70.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex70.m1.2.3.4.2.3.2.cmml" xref="A0.Ex70.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex70.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex70.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex70.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex70.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex70.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex70.m1.1.1.1.1.cmml" xref="A0.Ex70.m1.1.1.1.1">𝑒</ci></apply></apply><apply id="A0.Ex70.m1.2.3.4.3.cmml" xref="A0.Ex70.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.4.3.1.cmml" xref="A0.Ex70.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex70.m1.2.3.4.3.2a.cmml" xref="A0.Ex70.m1.2.3.4.3.2"><mtext id="A0.Ex70.m1.2.3.4.3.2.cmml" xref="A0.Ex70.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex70.m1.2.2.1.1.cmml" xref="A0.Ex70.m1.2.2.1.1">𝑒</ci></apply></apply></apply><apply id="A0.Ex70.m1.2.3c.cmml" xref="A0.Ex70.m1.2.3"><in id="A0.Ex70.m1.2.3.5.cmml" xref="A0.Ex70.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex70.m1.2.3.4.cmml" id="A0.Ex70.m1.2.3d.cmml" xref="A0.Ex70.m1.2.3"></share><apply id="A0.Ex70.m1.2.3.6.cmml" xref="A0.Ex70.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.6.1.cmml" xref="A0.Ex70.m1.2.3.6">superscript</csymbol><ci id="A0.Ex70.m1.2.3.6.2.cmml" xref="A0.Ex70.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex70.m1.2.3.6.3.cmml" xref="A0.Ex70.m1.2.3.6.3"><times id="A0.Ex70.m1.2.3.6.3.1.cmml" xref="A0.Ex70.m1.2.3.6.3.1"></times><ci id="A0.Ex70.m1.2.3.6.3.2.cmml" xref="A0.Ex70.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex70.m1.2.3.6.3.3.cmml" xref="A0.Ex70.m1.2.3.6.3.3">𝑃</ci><apply id="A0.Ex70.m1.2.3.6.3.4.cmml" xref="A0.Ex70.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex70.m1.2.3.6.3.4.1.cmml" xref="A0.Ex70.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex70.m1.2.3.6.3.4.2.cmml" xref="A0.Ex70.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex70.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex70.m1.2.3.6.3.4.3"><mtext id="A0.Ex70.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex70.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex70.m1.2c">\mathbf{Z}^{\text{enc}}=\mathbf{x}^{\text{seasonal}}\cdot\mathbf{W}_{e}^{(e)}+%
\text{PE}^{(e)}\in\mathbb{R}^{B\times P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex70.m1.2d">bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT = bold_x start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_e ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l7.1.1.1" style="font-size:80%;">7:</span></span>Apply <math alttext="L" class="ltx_Math" display="inline" id="alg3.l7.m1.1"><semantics id="alg3.l7.m1.1a"><mi id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><ci id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m1.1d">italic_L</annotation></semantics></math> encoder layers (self-attention + FFN + residual + norm). For each layer:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex71">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q},\quad K=\mathbf{Z}^{\text{enc}}%
\cdot\mathbf{W}^{K},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{V}" class="ltx_Math" display="block" id="A0.Ex71.m1.2"><semantics id="A0.Ex71.m1.2a"><mrow id="A0.Ex71.m1.2.2.2" xref="A0.Ex71.m1.2.2.3.cmml"><mrow id="A0.Ex71.m1.1.1.1.1" xref="A0.Ex71.m1.1.1.1.1.cmml"><mi id="A0.Ex71.m1.1.1.1.1.2" xref="A0.Ex71.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex71.m1.1.1.1.1.1" xref="A0.Ex71.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex71.m1.1.1.1.1.3" xref="A0.Ex71.m1.1.1.1.1.3.cmml"><msup id="A0.Ex71.m1.1.1.1.1.3.2" xref="A0.Ex71.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex71.m1.1.1.1.1.3.2.2" xref="A0.Ex71.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex71.m1.1.1.1.1.3.2.3" xref="A0.Ex71.m1.1.1.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex71.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex71.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex71.m1.1.1.1.1.3.3" xref="A0.Ex71.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex71.m1.1.1.1.1.3.3.2" xref="A0.Ex71.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><mi id="A0.Ex71.m1.1.1.1.1.3.3.3" xref="A0.Ex71.m1.1.1.1.1.3.3.3.cmml">Q</mi></msup></mrow></mrow><mo id="A0.Ex71.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex71.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex71.m1.2.2.2.2.2" xref="A0.Ex71.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex71.m1.2.2.2.2.1.1" xref="A0.Ex71.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex71.m1.2.2.2.2.1.1.2" xref="A0.Ex71.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex71.m1.2.2.2.2.1.1.1" xref="A0.Ex71.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex71.m1.2.2.2.2.1.1.3" xref="A0.Ex71.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex71.m1.2.2.2.2.1.1.3.2" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex71.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex71.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex71.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex71.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex71.m1.2.2.2.2.1.1.3.3" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex71.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><mi id="A0.Ex71.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3.3.cmml">K</mi></msup></mrow></mrow><mo id="A0.Ex71.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex71.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex71.m1.2.2.2.2.2.2" xref="A0.Ex71.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex71.m1.2.2.2.2.2.2.2" xref="A0.Ex71.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex71.m1.2.2.2.2.2.2.1" xref="A0.Ex71.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex71.m1.2.2.2.2.2.2.3" xref="A0.Ex71.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex71.m1.2.2.2.2.2.2.3.2" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex71.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex71.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex71.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex71.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex71.m1.2.2.2.2.2.2.3.3" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex71.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><mi id="A0.Ex71.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3.3.cmml">V</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex71.m1.2b"><apply id="A0.Ex71.m1.2.2.3.cmml" xref="A0.Ex71.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.3a.cmml" xref="A0.Ex71.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex71.m1.1.1.1.1.cmml" xref="A0.Ex71.m1.1.1.1.1"><eq id="A0.Ex71.m1.1.1.1.1.1.cmml" xref="A0.Ex71.m1.1.1.1.1.1"></eq><ci id="A0.Ex71.m1.1.1.1.1.2.cmml" xref="A0.Ex71.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex71.m1.1.1.1.1.3.cmml" xref="A0.Ex71.m1.1.1.1.1.3"><ci id="A0.Ex71.m1.1.1.1.1.3.1.cmml" xref="A0.Ex71.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex71.m1.1.1.1.1.3.2.cmml" xref="A0.Ex71.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex71.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex71.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex71.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex71.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex71.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex71.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex71.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex71.m1.1.1.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex71.m1.1.1.1.1.3.3.cmml" xref="A0.Ex71.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex71.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex71.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex71.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex71.m1.1.1.1.1.3.3.2">𝐖</ci><ci id="A0.Ex71.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex71.m1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply><apply id="A0.Ex71.m1.2.2.2.2.3.cmml" xref="A0.Ex71.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.2.2.3a.cmml" xref="A0.Ex71.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex71.m1.2.2.2.2.1.1.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1"><eq id="A0.Ex71.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex71.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex71.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3"><ci id="A0.Ex71.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex71.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex71.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.2">𝐙</ci><ci id="A0.Ex71.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex71.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex71.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex71.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex71.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><ci id="A0.Ex71.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex71.m1.2.2.2.2.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="A0.Ex71.m1.2.2.2.2.2.2.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2"><eq id="A0.Ex71.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex71.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex71.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3"><ci id="A0.Ex71.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex71.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex71.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.2">𝐙</ci><ci id="A0.Ex71.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex71.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex71.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex71.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex71.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex71.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><ci id="A0.Ex71.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex71.m1.2.2.2.2.2.2.3.3.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex71.m1.2c">Q=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{Q},\quad K=\mathbf{Z}^{\text{enc}}%
\cdot\mathbf{W}^{K},\quad V=\mathbf{Z}^{\text{enc}}\cdot\mathbf{W}^{V}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex71.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_K = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V = bold_Z start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex72">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SelfAttn}(Q,K,V)=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{%
model}}}}\right)V" class="ltx_Math" display="block" id="A0.Ex72.m1.4"><semantics id="A0.Ex72.m1.4a"><mrow id="A0.Ex72.m1.4.5" xref="A0.Ex72.m1.4.5.cmml"><mrow id="A0.Ex72.m1.4.5.2" xref="A0.Ex72.m1.4.5.2.cmml"><mtext id="A0.Ex72.m1.4.5.2.2" xref="A0.Ex72.m1.4.5.2.2a.cmml">SelfAttn</mtext><mo id="A0.Ex72.m1.4.5.2.1" xref="A0.Ex72.m1.4.5.2.1.cmml">⁢</mo><mrow id="A0.Ex72.m1.4.5.2.3.2" xref="A0.Ex72.m1.4.5.2.3.1.cmml"><mo id="A0.Ex72.m1.4.5.2.3.2.1" stretchy="false" xref="A0.Ex72.m1.4.5.2.3.1.cmml">(</mo><mi id="A0.Ex72.m1.1.1" xref="A0.Ex72.m1.1.1.cmml">Q</mi><mo id="A0.Ex72.m1.4.5.2.3.2.2" xref="A0.Ex72.m1.4.5.2.3.1.cmml">,</mo><mi id="A0.Ex72.m1.2.2" xref="A0.Ex72.m1.2.2.cmml">K</mi><mo id="A0.Ex72.m1.4.5.2.3.2.3" xref="A0.Ex72.m1.4.5.2.3.1.cmml">,</mo><mi id="A0.Ex72.m1.3.3" xref="A0.Ex72.m1.3.3.cmml">V</mi><mo id="A0.Ex72.m1.4.5.2.3.2.4" stretchy="false" xref="A0.Ex72.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A0.Ex72.m1.4.5.1" xref="A0.Ex72.m1.4.5.1.cmml">=</mo><mrow id="A0.Ex72.m1.4.5.3" xref="A0.Ex72.m1.4.5.3.cmml"><mtext id="A0.Ex72.m1.4.5.3.2" xref="A0.Ex72.m1.4.5.3.2a.cmml">Softmax</mtext><mo id="A0.Ex72.m1.4.5.3.1" xref="A0.Ex72.m1.4.5.3.1.cmml">⁢</mo><mrow id="A0.Ex72.m1.4.5.3.3.2" xref="A0.Ex72.m1.4.4.cmml"><mo id="A0.Ex72.m1.4.5.3.3.2.1" xref="A0.Ex72.m1.4.4.cmml">(</mo><mfrac id="A0.Ex72.m1.4.4" xref="A0.Ex72.m1.4.4.cmml"><mrow id="A0.Ex72.m1.4.4.2" xref="A0.Ex72.m1.4.4.2.cmml"><mi id="A0.Ex72.m1.4.4.2.2" xref="A0.Ex72.m1.4.4.2.2.cmml">Q</mi><mo id="A0.Ex72.m1.4.4.2.1" xref="A0.Ex72.m1.4.4.2.1.cmml">⁢</mo><msup id="A0.Ex72.m1.4.4.2.3" xref="A0.Ex72.m1.4.4.2.3.cmml"><mi id="A0.Ex72.m1.4.4.2.3.2" xref="A0.Ex72.m1.4.4.2.3.2.cmml">K</mi><mo id="A0.Ex72.m1.4.4.2.3.3" xref="A0.Ex72.m1.4.4.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex72.m1.4.4.3" xref="A0.Ex72.m1.4.4.3.cmml"><msub id="A0.Ex72.m1.4.4.3.2" xref="A0.Ex72.m1.4.4.3.2.cmml"><mi id="A0.Ex72.m1.4.4.3.2.2" xref="A0.Ex72.m1.4.4.3.2.2.cmml">d</mi><mtext id="A0.Ex72.m1.4.4.3.2.3" xref="A0.Ex72.m1.4.4.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex72.m1.4.5.3.3.2.2" xref="A0.Ex72.m1.4.4.cmml">)</mo></mrow><mo id="A0.Ex72.m1.4.5.3.1a" xref="A0.Ex72.m1.4.5.3.1.cmml">⁢</mo><mi id="A0.Ex72.m1.4.5.3.4" xref="A0.Ex72.m1.4.5.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex72.m1.4b"><apply id="A0.Ex72.m1.4.5.cmml" xref="A0.Ex72.m1.4.5"><eq id="A0.Ex72.m1.4.5.1.cmml" xref="A0.Ex72.m1.4.5.1"></eq><apply id="A0.Ex72.m1.4.5.2.cmml" xref="A0.Ex72.m1.4.5.2"><times id="A0.Ex72.m1.4.5.2.1.cmml" xref="A0.Ex72.m1.4.5.2.1"></times><ci id="A0.Ex72.m1.4.5.2.2a.cmml" xref="A0.Ex72.m1.4.5.2.2"><mtext id="A0.Ex72.m1.4.5.2.2.cmml" xref="A0.Ex72.m1.4.5.2.2">SelfAttn</mtext></ci><vector id="A0.Ex72.m1.4.5.2.3.1.cmml" xref="A0.Ex72.m1.4.5.2.3.2"><ci id="A0.Ex72.m1.1.1.cmml" xref="A0.Ex72.m1.1.1">𝑄</ci><ci id="A0.Ex72.m1.2.2.cmml" xref="A0.Ex72.m1.2.2">𝐾</ci><ci id="A0.Ex72.m1.3.3.cmml" xref="A0.Ex72.m1.3.3">𝑉</ci></vector></apply><apply id="A0.Ex72.m1.4.5.3.cmml" xref="A0.Ex72.m1.4.5.3"><times id="A0.Ex72.m1.4.5.3.1.cmml" xref="A0.Ex72.m1.4.5.3.1"></times><ci id="A0.Ex72.m1.4.5.3.2a.cmml" xref="A0.Ex72.m1.4.5.3.2"><mtext id="A0.Ex72.m1.4.5.3.2.cmml" xref="A0.Ex72.m1.4.5.3.2">Softmax</mtext></ci><apply id="A0.Ex72.m1.4.4.cmml" xref="A0.Ex72.m1.4.5.3.3.2"><divide id="A0.Ex72.m1.4.4.1.cmml" xref="A0.Ex72.m1.4.5.3.3.2"></divide><apply id="A0.Ex72.m1.4.4.2.cmml" xref="A0.Ex72.m1.4.4.2"><times id="A0.Ex72.m1.4.4.2.1.cmml" xref="A0.Ex72.m1.4.4.2.1"></times><ci id="A0.Ex72.m1.4.4.2.2.cmml" xref="A0.Ex72.m1.4.4.2.2">𝑄</ci><apply id="A0.Ex72.m1.4.4.2.3.cmml" xref="A0.Ex72.m1.4.4.2.3"><csymbol cd="ambiguous" id="A0.Ex72.m1.4.4.2.3.1.cmml" xref="A0.Ex72.m1.4.4.2.3">superscript</csymbol><ci id="A0.Ex72.m1.4.4.2.3.2.cmml" xref="A0.Ex72.m1.4.4.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex72.m1.4.4.2.3.3.cmml" xref="A0.Ex72.m1.4.4.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex72.m1.4.4.3.cmml" xref="A0.Ex72.m1.4.4.3"><root id="A0.Ex72.m1.4.4.3a.cmml" xref="A0.Ex72.m1.4.4.3"></root><apply id="A0.Ex72.m1.4.4.3.2.cmml" xref="A0.Ex72.m1.4.4.3.2"><csymbol cd="ambiguous" id="A0.Ex72.m1.4.4.3.2.1.cmml" xref="A0.Ex72.m1.4.4.3.2">subscript</csymbol><ci id="A0.Ex72.m1.4.4.3.2.2.cmml" xref="A0.Ex72.m1.4.4.3.2.2">𝑑</ci><ci id="A0.Ex72.m1.4.4.3.2.3a.cmml" xref="A0.Ex72.m1.4.4.3.2.3"><mtext id="A0.Ex72.m1.4.4.3.2.3.cmml" mathsize="70%" xref="A0.Ex72.m1.4.4.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex72.m1.4.5.3.4.cmml" xref="A0.Ex72.m1.4.5.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex72.m1.4c">\text{SelfAttn}(Q,K,V)=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{%
model}}}}\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex72.m1.4d">SelfAttn ( italic_Q , italic_K , italic_V ) = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l8.1.1.1" style="font-size:80%;">8:</span></span>Let encoder output: <math alttext="\mathbf{H}^{\text{enc}}\in\mathbb{R}^{B\times P\times d_{\text{model}}}" class="ltx_Math" display="inline" id="alg3.l8.m1.1"><semantics id="alg3.l8.m1.1a"><mrow id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml"><msup id="alg3.l8.m1.1.1.2" xref="alg3.l8.m1.1.1.2.cmml"><mi id="alg3.l8.m1.1.1.2.2" xref="alg3.l8.m1.1.1.2.2.cmml">𝐇</mi><mtext id="alg3.l8.m1.1.1.2.3" xref="alg3.l8.m1.1.1.2.3a.cmml">enc</mtext></msup><mo id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml">∈</mo><msup id="alg3.l8.m1.1.1.3" xref="alg3.l8.m1.1.1.3.cmml"><mi id="alg3.l8.m1.1.1.3.2" xref="alg3.l8.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg3.l8.m1.1.1.3.3" xref="alg3.l8.m1.1.1.3.3.cmml"><mi id="alg3.l8.m1.1.1.3.3.2" xref="alg3.l8.m1.1.1.3.3.2.cmml">B</mi><mo id="alg3.l8.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg3.l8.m1.1.1.3.3.1.cmml">×</mo><mi id="alg3.l8.m1.1.1.3.3.3" xref="alg3.l8.m1.1.1.3.3.3.cmml">P</mi><mo id="alg3.l8.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg3.l8.m1.1.1.3.3.1.cmml">×</mo><msub id="alg3.l8.m1.1.1.3.3.4" xref="alg3.l8.m1.1.1.3.3.4.cmml"><mi id="alg3.l8.m1.1.1.3.3.4.2" xref="alg3.l8.m1.1.1.3.3.4.2.cmml">d</mi><mtext id="alg3.l8.m1.1.1.3.3.4.3" xref="alg3.l8.m1.1.1.3.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><apply id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1"><in id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1"></in><apply id="alg3.l8.m1.1.1.2.cmml" xref="alg3.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.2.1.cmml" xref="alg3.l8.m1.1.1.2">superscript</csymbol><ci id="alg3.l8.m1.1.1.2.2.cmml" xref="alg3.l8.m1.1.1.2.2">𝐇</ci><ci id="alg3.l8.m1.1.1.2.3a.cmml" xref="alg3.l8.m1.1.1.2.3"><mtext id="alg3.l8.m1.1.1.2.3.cmml" mathsize="70%" xref="alg3.l8.m1.1.1.2.3">enc</mtext></ci></apply><apply id="alg3.l8.m1.1.1.3.cmml" xref="alg3.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.3.1.cmml" xref="alg3.l8.m1.1.1.3">superscript</csymbol><ci id="alg3.l8.m1.1.1.3.2.cmml" xref="alg3.l8.m1.1.1.3.2">ℝ</ci><apply id="alg3.l8.m1.1.1.3.3.cmml" xref="alg3.l8.m1.1.1.3.3"><times id="alg3.l8.m1.1.1.3.3.1.cmml" xref="alg3.l8.m1.1.1.3.3.1"></times><ci id="alg3.l8.m1.1.1.3.3.2.cmml" xref="alg3.l8.m1.1.1.3.3.2">𝐵</ci><ci id="alg3.l8.m1.1.1.3.3.3.cmml" xref="alg3.l8.m1.1.1.3.3.3">𝑃</ci><apply id="alg3.l8.m1.1.1.3.3.4.cmml" xref="alg3.l8.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.3.3.4.1.cmml" xref="alg3.l8.m1.1.1.3.3.4">subscript</csymbol><ci id="alg3.l8.m1.1.1.3.3.4.2.cmml" xref="alg3.l8.m1.1.1.3.3.4.2">𝑑</ci><ci id="alg3.l8.m1.1.1.3.3.4.3a.cmml" xref="alg3.l8.m1.1.1.3.3.4.3"><mtext id="alg3.l8.m1.1.1.3.3.4.3.cmml" mathsize="50%" xref="alg3.l8.m1.1.1.3.3.4.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">\mathbf{H}^{\text{enc}}\in\mathbb{R}^{B\times P\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l8.m1.1d">bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_P × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l9.2">Step 3: Decoder Initialization</span>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l10.1.1.1" style="font-size:80%;">10:</span></span>Zero initialize seasonal decoder input:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex73">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}^{\text{dec}}_{0}=\mathbf{0}\in\mathbb{R}^{B\times H\times 1}" class="ltx_Math" display="block" id="A0.Ex73.m1.1"><semantics id="A0.Ex73.m1.1a"><mrow id="A0.Ex73.m1.1.1" xref="A0.Ex73.m1.1.1.cmml"><msubsup id="A0.Ex73.m1.1.1.2" xref="A0.Ex73.m1.1.1.2.cmml"><mi id="A0.Ex73.m1.1.1.2.2.2" xref="A0.Ex73.m1.1.1.2.2.2.cmml">𝐳</mi><mn id="A0.Ex73.m1.1.1.2.3" xref="A0.Ex73.m1.1.1.2.3.cmml">0</mn><mtext id="A0.Ex73.m1.1.1.2.2.3" xref="A0.Ex73.m1.1.1.2.2.3a.cmml">dec</mtext></msubsup><mo id="A0.Ex73.m1.1.1.3" xref="A0.Ex73.m1.1.1.3.cmml">=</mo><mn id="A0.Ex73.m1.1.1.4" xref="A0.Ex73.m1.1.1.4.cmml">𝟎</mn><mo id="A0.Ex73.m1.1.1.5" xref="A0.Ex73.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex73.m1.1.1.6" xref="A0.Ex73.m1.1.1.6.cmml"><mi id="A0.Ex73.m1.1.1.6.2" xref="A0.Ex73.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex73.m1.1.1.6.3" xref="A0.Ex73.m1.1.1.6.3.cmml"><mi id="A0.Ex73.m1.1.1.6.3.2" xref="A0.Ex73.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex73.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex73.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex73.m1.1.1.6.3.3" xref="A0.Ex73.m1.1.1.6.3.3.cmml">H</mi><mo id="A0.Ex73.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex73.m1.1.1.6.3.1.cmml">×</mo><mn id="A0.Ex73.m1.1.1.6.3.4" xref="A0.Ex73.m1.1.1.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex73.m1.1b"><apply id="A0.Ex73.m1.1.1.cmml" xref="A0.Ex73.m1.1.1"><and id="A0.Ex73.m1.1.1a.cmml" xref="A0.Ex73.m1.1.1"></and><apply id="A0.Ex73.m1.1.1b.cmml" xref="A0.Ex73.m1.1.1"><eq id="A0.Ex73.m1.1.1.3.cmml" xref="A0.Ex73.m1.1.1.3"></eq><apply id="A0.Ex73.m1.1.1.2.cmml" xref="A0.Ex73.m1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex73.m1.1.1.2.1.cmml" xref="A0.Ex73.m1.1.1.2">subscript</csymbol><apply id="A0.Ex73.m1.1.1.2.2.cmml" xref="A0.Ex73.m1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex73.m1.1.1.2.2.1.cmml" xref="A0.Ex73.m1.1.1.2">superscript</csymbol><ci id="A0.Ex73.m1.1.1.2.2.2.cmml" xref="A0.Ex73.m1.1.1.2.2.2">𝐳</ci><ci id="A0.Ex73.m1.1.1.2.2.3a.cmml" xref="A0.Ex73.m1.1.1.2.2.3"><mtext id="A0.Ex73.m1.1.1.2.2.3.cmml" mathsize="70%" xref="A0.Ex73.m1.1.1.2.2.3">dec</mtext></ci></apply><cn id="A0.Ex73.m1.1.1.2.3.cmml" type="integer" xref="A0.Ex73.m1.1.1.2.3">0</cn></apply><cn id="A0.Ex73.m1.1.1.4.cmml" type="integer" xref="A0.Ex73.m1.1.1.4">0</cn></apply><apply id="A0.Ex73.m1.1.1c.cmml" xref="A0.Ex73.m1.1.1"><in id="A0.Ex73.m1.1.1.5.cmml" xref="A0.Ex73.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex73.m1.1.1.4.cmml" id="A0.Ex73.m1.1.1d.cmml" xref="A0.Ex73.m1.1.1"></share><apply id="A0.Ex73.m1.1.1.6.cmml" xref="A0.Ex73.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex73.m1.1.1.6.1.cmml" xref="A0.Ex73.m1.1.1.6">superscript</csymbol><ci id="A0.Ex73.m1.1.1.6.2.cmml" xref="A0.Ex73.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex73.m1.1.1.6.3.cmml" xref="A0.Ex73.m1.1.1.6.3"><times id="A0.Ex73.m1.1.1.6.3.1.cmml" xref="A0.Ex73.m1.1.1.6.3.1"></times><ci id="A0.Ex73.m1.1.1.6.3.2.cmml" xref="A0.Ex73.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex73.m1.1.1.6.3.3.cmml" xref="A0.Ex73.m1.1.1.6.3.3">𝐻</ci><cn id="A0.Ex73.m1.1.1.6.3.4.cmml" type="integer" xref="A0.Ex73.m1.1.1.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex73.m1.1c">\mathbf{z}^{\text{dec}}_{0}=\mathbf{0}\in\mathbb{R}^{B\times H\times 1}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex73.m1.1d">bold_z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_0 ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l11.1.1.1" style="font-size:80%;">11:</span></span>Project decoder input:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex74">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}^{\text{dec}}=\mathbf{z}^{\text{dec}}_{0}\cdot\mathbf{W}_{e}^{(d)}+%
\text{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}" class="ltx_Math" display="block" id="A0.Ex74.m1.2"><semantics id="A0.Ex74.m1.2a"><mrow id="A0.Ex74.m1.2.3" xref="A0.Ex74.m1.2.3.cmml"><msup id="A0.Ex74.m1.2.3.2" xref="A0.Ex74.m1.2.3.2.cmml"><mi id="A0.Ex74.m1.2.3.2.2" xref="A0.Ex74.m1.2.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex74.m1.2.3.2.3" xref="A0.Ex74.m1.2.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex74.m1.2.3.3" xref="A0.Ex74.m1.2.3.3.cmml">=</mo><mrow id="A0.Ex74.m1.2.3.4" xref="A0.Ex74.m1.2.3.4.cmml"><mrow id="A0.Ex74.m1.2.3.4.2" xref="A0.Ex74.m1.2.3.4.2.cmml"><msubsup id="A0.Ex74.m1.2.3.4.2.2" xref="A0.Ex74.m1.2.3.4.2.2.cmml"><mi id="A0.Ex74.m1.2.3.4.2.2.2.2" xref="A0.Ex74.m1.2.3.4.2.2.2.2.cmml">𝐳</mi><mn id="A0.Ex74.m1.2.3.4.2.2.3" xref="A0.Ex74.m1.2.3.4.2.2.3.cmml">0</mn><mtext id="A0.Ex74.m1.2.3.4.2.2.2.3" xref="A0.Ex74.m1.2.3.4.2.2.2.3a.cmml">dec</mtext></msubsup><mo id="A0.Ex74.m1.2.3.4.2.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex74.m1.2.3.4.2.1.cmml">⋅</mo><msubsup id="A0.Ex74.m1.2.3.4.2.3" xref="A0.Ex74.m1.2.3.4.2.3.cmml"><mi id="A0.Ex74.m1.2.3.4.2.3.2.2" xref="A0.Ex74.m1.2.3.4.2.3.2.2.cmml">𝐖</mi><mi id="A0.Ex74.m1.2.3.4.2.3.2.3" xref="A0.Ex74.m1.2.3.4.2.3.2.3.cmml">e</mi><mrow id="A0.Ex74.m1.1.1.1.3" xref="A0.Ex74.m1.2.3.4.2.3.cmml"><mo id="A0.Ex74.m1.1.1.1.3.1" stretchy="false" xref="A0.Ex74.m1.2.3.4.2.3.cmml">(</mo><mi id="A0.Ex74.m1.1.1.1.1" xref="A0.Ex74.m1.1.1.1.1.cmml">d</mi><mo id="A0.Ex74.m1.1.1.1.3.2" stretchy="false" xref="A0.Ex74.m1.2.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A0.Ex74.m1.2.3.4.1" xref="A0.Ex74.m1.2.3.4.1.cmml">+</mo><msup id="A0.Ex74.m1.2.3.4.3" xref="A0.Ex74.m1.2.3.4.3.cmml"><mtext id="A0.Ex74.m1.2.3.4.3.2" xref="A0.Ex74.m1.2.3.4.3.2a.cmml">PE</mtext><mrow id="A0.Ex74.m1.2.2.1.3" xref="A0.Ex74.m1.2.3.4.3.cmml"><mo id="A0.Ex74.m1.2.2.1.3.1" stretchy="false" xref="A0.Ex74.m1.2.3.4.3.cmml">(</mo><mi id="A0.Ex74.m1.2.2.1.1" xref="A0.Ex74.m1.2.2.1.1.cmml">d</mi><mo id="A0.Ex74.m1.2.2.1.3.2" stretchy="false" xref="A0.Ex74.m1.2.3.4.3.cmml">)</mo></mrow></msup></mrow><mo id="A0.Ex74.m1.2.3.5" xref="A0.Ex74.m1.2.3.5.cmml">∈</mo><msup id="A0.Ex74.m1.2.3.6" xref="A0.Ex74.m1.2.3.6.cmml"><mi id="A0.Ex74.m1.2.3.6.2" xref="A0.Ex74.m1.2.3.6.2.cmml">ℝ</mi><mrow id="A0.Ex74.m1.2.3.6.3" xref="A0.Ex74.m1.2.3.6.3.cmml"><mi id="A0.Ex74.m1.2.3.6.3.2" xref="A0.Ex74.m1.2.3.6.3.2.cmml">B</mi><mo id="A0.Ex74.m1.2.3.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex74.m1.2.3.6.3.1.cmml">×</mo><mi id="A0.Ex74.m1.2.3.6.3.3" xref="A0.Ex74.m1.2.3.6.3.3.cmml">H</mi><mo id="A0.Ex74.m1.2.3.6.3.1a" lspace="0.222em" rspace="0.222em" xref="A0.Ex74.m1.2.3.6.3.1.cmml">×</mo><msub id="A0.Ex74.m1.2.3.6.3.4" xref="A0.Ex74.m1.2.3.6.3.4.cmml"><mi id="A0.Ex74.m1.2.3.6.3.4.2" xref="A0.Ex74.m1.2.3.6.3.4.2.cmml">d</mi><mtext id="A0.Ex74.m1.2.3.6.3.4.3" xref="A0.Ex74.m1.2.3.6.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex74.m1.2b"><apply id="A0.Ex74.m1.2.3.cmml" xref="A0.Ex74.m1.2.3"><and id="A0.Ex74.m1.2.3a.cmml" xref="A0.Ex74.m1.2.3"></and><apply id="A0.Ex74.m1.2.3b.cmml" xref="A0.Ex74.m1.2.3"><eq id="A0.Ex74.m1.2.3.3.cmml" xref="A0.Ex74.m1.2.3.3"></eq><apply id="A0.Ex74.m1.2.3.2.cmml" xref="A0.Ex74.m1.2.3.2"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.2.1.cmml" xref="A0.Ex74.m1.2.3.2">superscript</csymbol><ci id="A0.Ex74.m1.2.3.2.2.cmml" xref="A0.Ex74.m1.2.3.2.2">𝐙</ci><ci id="A0.Ex74.m1.2.3.2.3a.cmml" xref="A0.Ex74.m1.2.3.2.3"><mtext id="A0.Ex74.m1.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex74.m1.2.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex74.m1.2.3.4.cmml" xref="A0.Ex74.m1.2.3.4"><plus id="A0.Ex74.m1.2.3.4.1.cmml" xref="A0.Ex74.m1.2.3.4.1"></plus><apply id="A0.Ex74.m1.2.3.4.2.cmml" xref="A0.Ex74.m1.2.3.4.2"><ci id="A0.Ex74.m1.2.3.4.2.1.cmml" xref="A0.Ex74.m1.2.3.4.2.1">⋅</ci><apply id="A0.Ex74.m1.2.3.4.2.2.cmml" xref="A0.Ex74.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.4.2.2.1.cmml" xref="A0.Ex74.m1.2.3.4.2.2">subscript</csymbol><apply id="A0.Ex74.m1.2.3.4.2.2.2.cmml" xref="A0.Ex74.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.4.2.2.2.1.cmml" xref="A0.Ex74.m1.2.3.4.2.2">superscript</csymbol><ci id="A0.Ex74.m1.2.3.4.2.2.2.2.cmml" xref="A0.Ex74.m1.2.3.4.2.2.2.2">𝐳</ci><ci id="A0.Ex74.m1.2.3.4.2.2.2.3a.cmml" xref="A0.Ex74.m1.2.3.4.2.2.2.3"><mtext id="A0.Ex74.m1.2.3.4.2.2.2.3.cmml" mathsize="70%" xref="A0.Ex74.m1.2.3.4.2.2.2.3">dec</mtext></ci></apply><cn id="A0.Ex74.m1.2.3.4.2.2.3.cmml" type="integer" xref="A0.Ex74.m1.2.3.4.2.2.3">0</cn></apply><apply id="A0.Ex74.m1.2.3.4.2.3.cmml" xref="A0.Ex74.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.4.2.3.1.cmml" xref="A0.Ex74.m1.2.3.4.2.3">superscript</csymbol><apply id="A0.Ex74.m1.2.3.4.2.3.2.cmml" xref="A0.Ex74.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.4.2.3.2.1.cmml" xref="A0.Ex74.m1.2.3.4.2.3">subscript</csymbol><ci id="A0.Ex74.m1.2.3.4.2.3.2.2.cmml" xref="A0.Ex74.m1.2.3.4.2.3.2.2">𝐖</ci><ci id="A0.Ex74.m1.2.3.4.2.3.2.3.cmml" xref="A0.Ex74.m1.2.3.4.2.3.2.3">𝑒</ci></apply><ci id="A0.Ex74.m1.1.1.1.1.cmml" xref="A0.Ex74.m1.1.1.1.1">𝑑</ci></apply></apply><apply id="A0.Ex74.m1.2.3.4.3.cmml" xref="A0.Ex74.m1.2.3.4.3"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.4.3.1.cmml" xref="A0.Ex74.m1.2.3.4.3">superscript</csymbol><ci id="A0.Ex74.m1.2.3.4.3.2a.cmml" xref="A0.Ex74.m1.2.3.4.3.2"><mtext id="A0.Ex74.m1.2.3.4.3.2.cmml" xref="A0.Ex74.m1.2.3.4.3.2">PE</mtext></ci><ci id="A0.Ex74.m1.2.2.1.1.cmml" xref="A0.Ex74.m1.2.2.1.1">𝑑</ci></apply></apply></apply><apply id="A0.Ex74.m1.2.3c.cmml" xref="A0.Ex74.m1.2.3"><in id="A0.Ex74.m1.2.3.5.cmml" xref="A0.Ex74.m1.2.3.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex74.m1.2.3.4.cmml" id="A0.Ex74.m1.2.3d.cmml" xref="A0.Ex74.m1.2.3"></share><apply id="A0.Ex74.m1.2.3.6.cmml" xref="A0.Ex74.m1.2.3.6"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.6.1.cmml" xref="A0.Ex74.m1.2.3.6">superscript</csymbol><ci id="A0.Ex74.m1.2.3.6.2.cmml" xref="A0.Ex74.m1.2.3.6.2">ℝ</ci><apply id="A0.Ex74.m1.2.3.6.3.cmml" xref="A0.Ex74.m1.2.3.6.3"><times id="A0.Ex74.m1.2.3.6.3.1.cmml" xref="A0.Ex74.m1.2.3.6.3.1"></times><ci id="A0.Ex74.m1.2.3.6.3.2.cmml" xref="A0.Ex74.m1.2.3.6.3.2">𝐵</ci><ci id="A0.Ex74.m1.2.3.6.3.3.cmml" xref="A0.Ex74.m1.2.3.6.3.3">𝐻</ci><apply id="A0.Ex74.m1.2.3.6.3.4.cmml" xref="A0.Ex74.m1.2.3.6.3.4"><csymbol cd="ambiguous" id="A0.Ex74.m1.2.3.6.3.4.1.cmml" xref="A0.Ex74.m1.2.3.6.3.4">subscript</csymbol><ci id="A0.Ex74.m1.2.3.6.3.4.2.cmml" xref="A0.Ex74.m1.2.3.6.3.4.2">𝑑</ci><ci id="A0.Ex74.m1.2.3.6.3.4.3a.cmml" xref="A0.Ex74.m1.2.3.6.3.4.3"><mtext id="A0.Ex74.m1.2.3.6.3.4.3.cmml" mathsize="50%" xref="A0.Ex74.m1.2.3.6.3.4.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex74.m1.2c">\mathbf{Z}^{\text{dec}}=\mathbf{z}^{\text{dec}}_{0}\cdot\mathbf{W}_{e}^{(d)}+%
\text{PE}^{(d)}\in\mathbb{R}^{B\times H\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex74.m1.2d">bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT = bold_z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT + PE start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l12.2">Step 4: Transformer Decoder</span>
</div>
<div class="ltx_listingline" id="alg3.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l13.2">for</span> each decoder layer <span class="ltx_text ltx_font_bold" id="alg3.l13.3">do</span>
</div>
<div class="ltx_listingline" id="alg3.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l14.1.1.1" style="font-size:80%;">14:</span></span>     <span class="ltx_text ltx_font_italic" id="alg3.l14.2">(a) Self-Attention:</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex75">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=K=V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\mathbf{W}^{K_{d}},%
\mathbf{W}^{V_{d}}" class="ltx_Math" display="block" id="A0.Ex75.m1.2"><semantics id="A0.Ex75.m1.2a"><mrow id="A0.Ex75.m1.2.2.2" xref="A0.Ex75.m1.2.2.3.cmml"><mrow id="A0.Ex75.m1.1.1.1.1" xref="A0.Ex75.m1.1.1.1.1.cmml"><mi id="A0.Ex75.m1.1.1.1.1.2" xref="A0.Ex75.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex75.m1.1.1.1.1.3" xref="A0.Ex75.m1.1.1.1.1.3.cmml">=</mo><mi id="A0.Ex75.m1.1.1.1.1.4" xref="A0.Ex75.m1.1.1.1.1.4.cmml">K</mi><mo id="A0.Ex75.m1.1.1.1.1.5" xref="A0.Ex75.m1.1.1.1.1.5.cmml">=</mo><mi id="A0.Ex75.m1.1.1.1.1.6" xref="A0.Ex75.m1.1.1.1.1.6.cmml">V</mi><mo id="A0.Ex75.m1.1.1.1.1.7" xref="A0.Ex75.m1.1.1.1.1.7.cmml">=</mo><mrow id="A0.Ex75.m1.1.1.1.1.8" xref="A0.Ex75.m1.1.1.1.1.8.cmml"><msup id="A0.Ex75.m1.1.1.1.1.8.2" xref="A0.Ex75.m1.1.1.1.1.8.2.cmml"><mi id="A0.Ex75.m1.1.1.1.1.8.2.2" xref="A0.Ex75.m1.1.1.1.1.8.2.2.cmml">𝐙</mi><mtext id="A0.Ex75.m1.1.1.1.1.8.2.3" xref="A0.Ex75.m1.1.1.1.1.8.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex75.m1.1.1.1.1.8.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex75.m1.1.1.1.1.8.1.cmml">⋅</mo><msup id="A0.Ex75.m1.1.1.1.1.8.3" xref="A0.Ex75.m1.1.1.1.1.8.3.cmml"><mi id="A0.Ex75.m1.1.1.1.1.8.3.2" xref="A0.Ex75.m1.1.1.1.1.8.3.2.cmml">𝐖</mi><msub id="A0.Ex75.m1.1.1.1.1.8.3.3" xref="A0.Ex75.m1.1.1.1.1.8.3.3.cmml"><mi id="A0.Ex75.m1.1.1.1.1.8.3.3.2" xref="A0.Ex75.m1.1.1.1.1.8.3.3.2.cmml">Q</mi><mi id="A0.Ex75.m1.1.1.1.1.8.3.3.3" xref="A0.Ex75.m1.1.1.1.1.8.3.3.3.cmml">d</mi></msub></msup></mrow></mrow><mo id="A0.Ex75.m1.2.2.2.3" xref="A0.Ex75.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex75.m1.2.2.2.2.2" xref="A0.Ex75.m1.2.2.2.2.3.cmml"><msup id="A0.Ex75.m1.2.2.2.2.1.1" xref="A0.Ex75.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex75.m1.2.2.2.2.1.1.2" xref="A0.Ex75.m1.2.2.2.2.1.1.2.cmml">𝐖</mi><msub id="A0.Ex75.m1.2.2.2.2.1.1.3" xref="A0.Ex75.m1.2.2.2.2.1.1.3.cmml"><mi id="A0.Ex75.m1.2.2.2.2.1.1.3.2" xref="A0.Ex75.m1.2.2.2.2.1.1.3.2.cmml">K</mi><mi id="A0.Ex75.m1.2.2.2.2.1.1.3.3" xref="A0.Ex75.m1.2.2.2.2.1.1.3.3.cmml">d</mi></msub></msup><mo id="A0.Ex75.m1.2.2.2.2.2.3" xref="A0.Ex75.m1.2.2.2.2.3.cmml">,</mo><msup id="A0.Ex75.m1.2.2.2.2.2.2" xref="A0.Ex75.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex75.m1.2.2.2.2.2.2.2" xref="A0.Ex75.m1.2.2.2.2.2.2.2.cmml">𝐖</mi><msub id="A0.Ex75.m1.2.2.2.2.2.2.3" xref="A0.Ex75.m1.2.2.2.2.2.2.3.cmml"><mi id="A0.Ex75.m1.2.2.2.2.2.2.3.2" xref="A0.Ex75.m1.2.2.2.2.2.2.3.2.cmml">V</mi><mi id="A0.Ex75.m1.2.2.2.2.2.2.3.3" xref="A0.Ex75.m1.2.2.2.2.2.2.3.3.cmml">d</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex75.m1.2b"><apply id="A0.Ex75.m1.2.2.3.cmml" xref="A0.Ex75.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex75.m1.2.2.3a.cmml" xref="A0.Ex75.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex75.m1.1.1.1.1.cmml" xref="A0.Ex75.m1.1.1.1.1"><and id="A0.Ex75.m1.1.1.1.1a.cmml" xref="A0.Ex75.m1.1.1.1.1"></and><apply id="A0.Ex75.m1.1.1.1.1b.cmml" xref="A0.Ex75.m1.1.1.1.1"><eq id="A0.Ex75.m1.1.1.1.1.3.cmml" xref="A0.Ex75.m1.1.1.1.1.3"></eq><ci id="A0.Ex75.m1.1.1.1.1.2.cmml" xref="A0.Ex75.m1.1.1.1.1.2">𝑄</ci><ci id="A0.Ex75.m1.1.1.1.1.4.cmml" xref="A0.Ex75.m1.1.1.1.1.4">𝐾</ci></apply><apply id="A0.Ex75.m1.1.1.1.1c.cmml" xref="A0.Ex75.m1.1.1.1.1"><eq id="A0.Ex75.m1.1.1.1.1.5.cmml" xref="A0.Ex75.m1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2505.20048v1#A0.Ex75.m1.1.1.1.1.4.cmml" id="A0.Ex75.m1.1.1.1.1d.cmml" xref="A0.Ex75.m1.1.1.1.1"></share><ci id="A0.Ex75.m1.1.1.1.1.6.cmml" xref="A0.Ex75.m1.1.1.1.1.6">𝑉</ci></apply><apply id="A0.Ex75.m1.1.1.1.1e.cmml" xref="A0.Ex75.m1.1.1.1.1"><eq id="A0.Ex75.m1.1.1.1.1.7.cmml" xref="A0.Ex75.m1.1.1.1.1.7"></eq><share href="https://arxiv.org/html/2505.20048v1#A0.Ex75.m1.1.1.1.1.6.cmml" id="A0.Ex75.m1.1.1.1.1f.cmml" xref="A0.Ex75.m1.1.1.1.1"></share><apply id="A0.Ex75.m1.1.1.1.1.8.cmml" xref="A0.Ex75.m1.1.1.1.1.8"><ci id="A0.Ex75.m1.1.1.1.1.8.1.cmml" xref="A0.Ex75.m1.1.1.1.1.8.1">⋅</ci><apply id="A0.Ex75.m1.1.1.1.1.8.2.cmml" xref="A0.Ex75.m1.1.1.1.1.8.2"><csymbol cd="ambiguous" id="A0.Ex75.m1.1.1.1.1.8.2.1.cmml" xref="A0.Ex75.m1.1.1.1.1.8.2">superscript</csymbol><ci id="A0.Ex75.m1.1.1.1.1.8.2.2.cmml" xref="A0.Ex75.m1.1.1.1.1.8.2.2">𝐙</ci><ci id="A0.Ex75.m1.1.1.1.1.8.2.3a.cmml" xref="A0.Ex75.m1.1.1.1.1.8.2.3"><mtext id="A0.Ex75.m1.1.1.1.1.8.2.3.cmml" mathsize="70%" xref="A0.Ex75.m1.1.1.1.1.8.2.3">dec</mtext></ci></apply><apply id="A0.Ex75.m1.1.1.1.1.8.3.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3"><csymbol cd="ambiguous" id="A0.Ex75.m1.1.1.1.1.8.3.1.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3">superscript</csymbol><ci id="A0.Ex75.m1.1.1.1.1.8.3.2.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3.2">𝐖</ci><apply id="A0.Ex75.m1.1.1.1.1.8.3.3.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3.3"><csymbol cd="ambiguous" id="A0.Ex75.m1.1.1.1.1.8.3.3.1.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3.3">subscript</csymbol><ci id="A0.Ex75.m1.1.1.1.1.8.3.3.2.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3.3.2">𝑄</ci><ci id="A0.Ex75.m1.1.1.1.1.8.3.3.3.cmml" xref="A0.Ex75.m1.1.1.1.1.8.3.3.3">𝑑</ci></apply></apply></apply></apply></apply><list id="A0.Ex75.m1.2.2.2.2.3.cmml" xref="A0.Ex75.m1.2.2.2.2.2"><apply id="A0.Ex75.m1.2.2.2.2.1.1.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A0.Ex75.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1">superscript</csymbol><ci id="A0.Ex75.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1.2">𝐖</ci><apply id="A0.Ex75.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A0.Ex75.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A0.Ex75.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1.3.2">𝐾</ci><ci id="A0.Ex75.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex75.m1.2.2.2.2.1.1.3.3">𝑑</ci></apply></apply><apply id="A0.Ex75.m1.2.2.2.2.2.2.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex75.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2">superscript</csymbol><ci id="A0.Ex75.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2.2">𝐖</ci><apply id="A0.Ex75.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A0.Ex75.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="A0.Ex75.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2.3.2">𝑉</ci><ci id="A0.Ex75.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex75.m1.2.2.2.2.2.2.3.3">𝑑</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex75.m1.2c">Q=K=V=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{d}},\mathbf{W}^{K_{d}},%
\mathbf{W}^{V_{d}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex75.m1.2d">italic_Q = italic_K = italic_V = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex76">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SelfAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V" class="ltx_Math" display="block" id="A0.Ex76.m1.1"><semantics id="A0.Ex76.m1.1a"><mrow id="A0.Ex76.m1.1.2" xref="A0.Ex76.m1.1.2.cmml"><mtext id="A0.Ex76.m1.1.2.2" xref="A0.Ex76.m1.1.2.2a.cmml">SelfAttn</mtext><mo id="A0.Ex76.m1.1.2.1" xref="A0.Ex76.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex76.m1.1.2.3" xref="A0.Ex76.m1.1.2.3.cmml"><mtext id="A0.Ex76.m1.1.2.3.2" xref="A0.Ex76.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex76.m1.1.2.3.1" xref="A0.Ex76.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex76.m1.1.2.3.3.2" xref="A0.Ex76.m1.1.1.cmml"><mo id="A0.Ex76.m1.1.2.3.3.2.1" xref="A0.Ex76.m1.1.1.cmml">(</mo><mfrac id="A0.Ex76.m1.1.1" xref="A0.Ex76.m1.1.1.cmml"><mrow id="A0.Ex76.m1.1.1.2" xref="A0.Ex76.m1.1.1.2.cmml"><mi id="A0.Ex76.m1.1.1.2.2" xref="A0.Ex76.m1.1.1.2.2.cmml">Q</mi><mo id="A0.Ex76.m1.1.1.2.1" xref="A0.Ex76.m1.1.1.2.1.cmml">⁢</mo><msup id="A0.Ex76.m1.1.1.2.3" xref="A0.Ex76.m1.1.1.2.3.cmml"><mi id="A0.Ex76.m1.1.1.2.3.2" xref="A0.Ex76.m1.1.1.2.3.2.cmml">K</mi><mo id="A0.Ex76.m1.1.1.2.3.3" xref="A0.Ex76.m1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex76.m1.1.1.3" xref="A0.Ex76.m1.1.1.3.cmml"><msub id="A0.Ex76.m1.1.1.3.2" xref="A0.Ex76.m1.1.1.3.2.cmml"><mi id="A0.Ex76.m1.1.1.3.2.2" xref="A0.Ex76.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex76.m1.1.1.3.2.3" xref="A0.Ex76.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex76.m1.1.2.3.3.2.2" xref="A0.Ex76.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex76.m1.1.2.3.1a" xref="A0.Ex76.m1.1.2.3.1.cmml">⁢</mo><mi id="A0.Ex76.m1.1.2.3.4" xref="A0.Ex76.m1.1.2.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex76.m1.1b"><apply id="A0.Ex76.m1.1.2.cmml" xref="A0.Ex76.m1.1.2"><eq id="A0.Ex76.m1.1.2.1.cmml" xref="A0.Ex76.m1.1.2.1"></eq><ci id="A0.Ex76.m1.1.2.2a.cmml" xref="A0.Ex76.m1.1.2.2"><mtext id="A0.Ex76.m1.1.2.2.cmml" xref="A0.Ex76.m1.1.2.2">SelfAttn</mtext></ci><apply id="A0.Ex76.m1.1.2.3.cmml" xref="A0.Ex76.m1.1.2.3"><times id="A0.Ex76.m1.1.2.3.1.cmml" xref="A0.Ex76.m1.1.2.3.1"></times><ci id="A0.Ex76.m1.1.2.3.2a.cmml" xref="A0.Ex76.m1.1.2.3.2"><mtext id="A0.Ex76.m1.1.2.3.2.cmml" xref="A0.Ex76.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex76.m1.1.1.cmml" xref="A0.Ex76.m1.1.2.3.3.2"><divide id="A0.Ex76.m1.1.1.1.cmml" xref="A0.Ex76.m1.1.2.3.3.2"></divide><apply id="A0.Ex76.m1.1.1.2.cmml" xref="A0.Ex76.m1.1.1.2"><times id="A0.Ex76.m1.1.1.2.1.cmml" xref="A0.Ex76.m1.1.1.2.1"></times><ci id="A0.Ex76.m1.1.1.2.2.cmml" xref="A0.Ex76.m1.1.1.2.2">𝑄</ci><apply id="A0.Ex76.m1.1.1.2.3.cmml" xref="A0.Ex76.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex76.m1.1.1.2.3.1.cmml" xref="A0.Ex76.m1.1.1.2.3">superscript</csymbol><ci id="A0.Ex76.m1.1.1.2.3.2.cmml" xref="A0.Ex76.m1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex76.m1.1.1.2.3.3.cmml" xref="A0.Ex76.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex76.m1.1.1.3.cmml" xref="A0.Ex76.m1.1.1.3"><root id="A0.Ex76.m1.1.1.3a.cmml" xref="A0.Ex76.m1.1.1.3"></root><apply id="A0.Ex76.m1.1.1.3.2.cmml" xref="A0.Ex76.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex76.m1.1.1.3.2.1.cmml" xref="A0.Ex76.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex76.m1.1.1.3.2.2.cmml" xref="A0.Ex76.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex76.m1.1.1.3.2.3a.cmml" xref="A0.Ex76.m1.1.1.3.2.3"><mtext id="A0.Ex76.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex76.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex76.m1.1.2.3.4.cmml" xref="A0.Ex76.m1.1.2.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex76.m1.1c">\text{SelfAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex76.m1.1d">SelfAttn = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l15.1.1.1" style="font-size:80%;">15:</span></span>     <span class="ltx_text ltx_font_italic" id="alg3.l15.2">(b) Cross-Attention:</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex77">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}" class="ltx_Math" display="block" id="A0.Ex77.m1.2"><semantics id="A0.Ex77.m1.2a"><mrow id="A0.Ex77.m1.2.2.2" xref="A0.Ex77.m1.2.2.3.cmml"><mrow id="A0.Ex77.m1.1.1.1.1" xref="A0.Ex77.m1.1.1.1.1.cmml"><mi id="A0.Ex77.m1.1.1.1.1.2" xref="A0.Ex77.m1.1.1.1.1.2.cmml">Q</mi><mo id="A0.Ex77.m1.1.1.1.1.1" xref="A0.Ex77.m1.1.1.1.1.1.cmml">=</mo><mrow id="A0.Ex77.m1.1.1.1.1.3" xref="A0.Ex77.m1.1.1.1.1.3.cmml"><msup id="A0.Ex77.m1.1.1.1.1.3.2" xref="A0.Ex77.m1.1.1.1.1.3.2.cmml"><mi id="A0.Ex77.m1.1.1.1.1.3.2.2" xref="A0.Ex77.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mtext id="A0.Ex77.m1.1.1.1.1.3.2.3" xref="A0.Ex77.m1.1.1.1.1.3.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex77.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex77.m1.1.1.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex77.m1.1.1.1.1.3.3" xref="A0.Ex77.m1.1.1.1.1.3.3.cmml"><mi id="A0.Ex77.m1.1.1.1.1.3.3.2" xref="A0.Ex77.m1.1.1.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex77.m1.1.1.1.1.3.3.3" xref="A0.Ex77.m1.1.1.1.1.3.3.3.cmml"><mi id="A0.Ex77.m1.1.1.1.1.3.3.3.2" xref="A0.Ex77.m1.1.1.1.1.3.3.3.2.cmml">Q</mi><mi id="A0.Ex77.m1.1.1.1.1.3.3.3.3" xref="A0.Ex77.m1.1.1.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex77.m1.2.2.2.3" rspace="1.167em" xref="A0.Ex77.m1.2.2.3a.cmml">,</mo><mrow id="A0.Ex77.m1.2.2.2.2.2" xref="A0.Ex77.m1.2.2.2.2.3.cmml"><mrow id="A0.Ex77.m1.2.2.2.2.1.1" xref="A0.Ex77.m1.2.2.2.2.1.1.cmml"><mi id="A0.Ex77.m1.2.2.2.2.1.1.2" xref="A0.Ex77.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="A0.Ex77.m1.2.2.2.2.1.1.1" xref="A0.Ex77.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="A0.Ex77.m1.2.2.2.2.1.1.3" xref="A0.Ex77.m1.2.2.2.2.1.1.3.cmml"><msup id="A0.Ex77.m1.2.2.2.2.1.1.3.2" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.cmml"><mi id="A0.Ex77.m1.2.2.2.2.1.1.3.2.2" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex77.m1.2.2.2.2.1.1.3.2.3" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex77.m1.2.2.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex77.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><msup id="A0.Ex77.m1.2.2.2.2.1.1.3.3" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A0.Ex77.m1.2.2.2.2.1.1.3.3.2" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.2.cmml">𝐖</mi><msub id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.2" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.2.cmml">K</mi><mi id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.3" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><mo id="A0.Ex77.m1.2.2.2.2.2.3" rspace="1.167em" xref="A0.Ex77.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A0.Ex77.m1.2.2.2.2.2.2" xref="A0.Ex77.m1.2.2.2.2.2.2.cmml"><mi id="A0.Ex77.m1.2.2.2.2.2.2.2" xref="A0.Ex77.m1.2.2.2.2.2.2.2.cmml">V</mi><mo id="A0.Ex77.m1.2.2.2.2.2.2.1" xref="A0.Ex77.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A0.Ex77.m1.2.2.2.2.2.2.3" xref="A0.Ex77.m1.2.2.2.2.2.2.3.cmml"><msup id="A0.Ex77.m1.2.2.2.2.2.2.3.2" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.cmml"><mi id="A0.Ex77.m1.2.2.2.2.2.2.3.2.2" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.2.cmml">𝐇</mi><mtext id="A0.Ex77.m1.2.2.2.2.2.2.3.2.3" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.3a.cmml">enc</mtext></msup><mo id="A0.Ex77.m1.2.2.2.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex77.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><msup id="A0.Ex77.m1.2.2.2.2.2.2.3.3" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A0.Ex77.m1.2.2.2.2.2.2.3.3.2" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.2.cmml">𝐖</mi><msub id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.2" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.2.cmml">V</mi><mi id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.3" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.3.cmml">c</mi></msub></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex77.m1.2b"><apply id="A0.Ex77.m1.2.2.3.cmml" xref="A0.Ex77.m1.2.2.2"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.3a.cmml" xref="A0.Ex77.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex77.m1.1.1.1.1.cmml" xref="A0.Ex77.m1.1.1.1.1"><eq id="A0.Ex77.m1.1.1.1.1.1.cmml" xref="A0.Ex77.m1.1.1.1.1.1"></eq><ci id="A0.Ex77.m1.1.1.1.1.2.cmml" xref="A0.Ex77.m1.1.1.1.1.2">𝑄</ci><apply id="A0.Ex77.m1.1.1.1.1.3.cmml" xref="A0.Ex77.m1.1.1.1.1.3"><ci id="A0.Ex77.m1.1.1.1.1.3.1.cmml" xref="A0.Ex77.m1.1.1.1.1.3.1">⋅</ci><apply id="A0.Ex77.m1.1.1.1.1.3.2.cmml" xref="A0.Ex77.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex77.m1.1.1.1.1.3.2.1.cmml" xref="A0.Ex77.m1.1.1.1.1.3.2">superscript</csymbol><ci id="A0.Ex77.m1.1.1.1.1.3.2.2.cmml" xref="A0.Ex77.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="A0.Ex77.m1.1.1.1.1.3.2.3a.cmml" xref="A0.Ex77.m1.1.1.1.1.3.2.3"><mtext id="A0.Ex77.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex77.m1.1.1.1.1.3.2.3">dec</mtext></ci></apply><apply id="A0.Ex77.m1.1.1.1.1.3.3.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.1.1.1.1.3.3.1.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A0.Ex77.m1.1.1.1.1.3.3.2.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3.2">𝐖</ci><apply id="A0.Ex77.m1.1.1.1.1.3.3.3.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.1.1.1.1.3.3.3.1.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex77.m1.1.1.1.1.3.3.3.2.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3.3.2">𝑄</ci><ci id="A0.Ex77.m1.1.1.1.1.3.3.3.3.cmml" xref="A0.Ex77.m1.1.1.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex77.m1.2.2.2.2.3.cmml" xref="A0.Ex77.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.3a.cmml" xref="A0.Ex77.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A0.Ex77.m1.2.2.2.2.1.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1"><eq id="A0.Ex77.m1.2.2.2.2.1.1.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.1"></eq><ci id="A0.Ex77.m1.2.2.2.2.1.1.2.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.2">𝐾</ci><apply id="A0.Ex77.m1.2.2.2.2.1.1.3.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3"><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="A0.Ex77.m1.2.2.2.2.1.1.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.1.1.3.2.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.2.2.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.2">𝐇</ci><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.2.3a.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.3"><mtext id="A0.Ex77.m1.2.2.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex77.m1.2.2.2.2.1.1.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex77.m1.2.2.2.2.1.1.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3">superscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.2">𝐖</ci><apply id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.2">𝐾</ci><ci id="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="A0.Ex77.m1.2.2.2.2.2.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2"><eq id="A0.Ex77.m1.2.2.2.2.2.2.1.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.1"></eq><ci id="A0.Ex77.m1.2.2.2.2.2.2.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.2">𝑉</ci><apply id="A0.Ex77.m1.2.2.2.2.2.2.3.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3"><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="A0.Ex77.m1.2.2.2.2.2.2.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.2.2.3.2.1.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2">superscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.2.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.2">𝐇</ci><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.2.3a.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.3"><mtext id="A0.Ex77.m1.2.2.2.2.2.2.3.2.3.cmml" mathsize="70%" xref="A0.Ex77.m1.2.2.2.2.2.2.3.2.3">enc</mtext></ci></apply><apply id="A0.Ex77.m1.2.2.2.2.2.2.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.2">𝐖</ci><apply id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.2">𝑉</ci><ci id="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="A0.Ex77.m1.2.2.2.2.2.2.3.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex77.m1.2c">Q=\mathbf{Z}^{\text{dec}}\cdot\mathbf{W}^{Q_{c}},\quad K=\mathbf{H}^{\text{enc%
}}\cdot\mathbf{W}^{K_{c}},\quad V=\mathbf{H}^{\text{enc}}\cdot\mathbf{W}^{V_{c}}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex77.m1.2d">italic_Q = bold_Z start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_K = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_V = bold_H start_POSTSUPERSCRIPT enc end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex78">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V" class="ltx_Math" display="block" id="A0.Ex78.m1.1"><semantics id="A0.Ex78.m1.1a"><mrow id="A0.Ex78.m1.1.2" xref="A0.Ex78.m1.1.2.cmml"><mtext id="A0.Ex78.m1.1.2.2" xref="A0.Ex78.m1.1.2.2a.cmml">CrossAttn</mtext><mo id="A0.Ex78.m1.1.2.1" xref="A0.Ex78.m1.1.2.1.cmml">=</mo><mrow id="A0.Ex78.m1.1.2.3" xref="A0.Ex78.m1.1.2.3.cmml"><mtext id="A0.Ex78.m1.1.2.3.2" xref="A0.Ex78.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="A0.Ex78.m1.1.2.3.1" xref="A0.Ex78.m1.1.2.3.1.cmml">⁢</mo><mrow id="A0.Ex78.m1.1.2.3.3.2" xref="A0.Ex78.m1.1.1.cmml"><mo id="A0.Ex78.m1.1.2.3.3.2.1" xref="A0.Ex78.m1.1.1.cmml">(</mo><mfrac id="A0.Ex78.m1.1.1" xref="A0.Ex78.m1.1.1.cmml"><mrow id="A0.Ex78.m1.1.1.2" xref="A0.Ex78.m1.1.1.2.cmml"><mi id="A0.Ex78.m1.1.1.2.2" xref="A0.Ex78.m1.1.1.2.2.cmml">Q</mi><mo id="A0.Ex78.m1.1.1.2.1" xref="A0.Ex78.m1.1.1.2.1.cmml">⁢</mo><msup id="A0.Ex78.m1.1.1.2.3" xref="A0.Ex78.m1.1.1.2.3.cmml"><mi id="A0.Ex78.m1.1.1.2.3.2" xref="A0.Ex78.m1.1.1.2.3.2.cmml">K</mi><mo id="A0.Ex78.m1.1.1.2.3.3" xref="A0.Ex78.m1.1.1.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="A0.Ex78.m1.1.1.3" xref="A0.Ex78.m1.1.1.3.cmml"><msub id="A0.Ex78.m1.1.1.3.2" xref="A0.Ex78.m1.1.1.3.2.cmml"><mi id="A0.Ex78.m1.1.1.3.2.2" xref="A0.Ex78.m1.1.1.3.2.2.cmml">d</mi><mtext id="A0.Ex78.m1.1.1.3.2.3" xref="A0.Ex78.m1.1.1.3.2.3a.cmml">model</mtext></msub></msqrt></mfrac><mo id="A0.Ex78.m1.1.2.3.3.2.2" xref="A0.Ex78.m1.1.1.cmml">)</mo></mrow><mo id="A0.Ex78.m1.1.2.3.1a" xref="A0.Ex78.m1.1.2.3.1.cmml">⁢</mo><mi id="A0.Ex78.m1.1.2.3.4" xref="A0.Ex78.m1.1.2.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex78.m1.1b"><apply id="A0.Ex78.m1.1.2.cmml" xref="A0.Ex78.m1.1.2"><eq id="A0.Ex78.m1.1.2.1.cmml" xref="A0.Ex78.m1.1.2.1"></eq><ci id="A0.Ex78.m1.1.2.2a.cmml" xref="A0.Ex78.m1.1.2.2"><mtext id="A0.Ex78.m1.1.2.2.cmml" xref="A0.Ex78.m1.1.2.2">CrossAttn</mtext></ci><apply id="A0.Ex78.m1.1.2.3.cmml" xref="A0.Ex78.m1.1.2.3"><times id="A0.Ex78.m1.1.2.3.1.cmml" xref="A0.Ex78.m1.1.2.3.1"></times><ci id="A0.Ex78.m1.1.2.3.2a.cmml" xref="A0.Ex78.m1.1.2.3.2"><mtext id="A0.Ex78.m1.1.2.3.2.cmml" xref="A0.Ex78.m1.1.2.3.2">Softmax</mtext></ci><apply id="A0.Ex78.m1.1.1.cmml" xref="A0.Ex78.m1.1.2.3.3.2"><divide id="A0.Ex78.m1.1.1.1.cmml" xref="A0.Ex78.m1.1.2.3.3.2"></divide><apply id="A0.Ex78.m1.1.1.2.cmml" xref="A0.Ex78.m1.1.1.2"><times id="A0.Ex78.m1.1.1.2.1.cmml" xref="A0.Ex78.m1.1.1.2.1"></times><ci id="A0.Ex78.m1.1.1.2.2.cmml" xref="A0.Ex78.m1.1.1.2.2">𝑄</ci><apply id="A0.Ex78.m1.1.1.2.3.cmml" xref="A0.Ex78.m1.1.1.2.3"><csymbol cd="ambiguous" id="A0.Ex78.m1.1.1.2.3.1.cmml" xref="A0.Ex78.m1.1.1.2.3">superscript</csymbol><ci id="A0.Ex78.m1.1.1.2.3.2.cmml" xref="A0.Ex78.m1.1.1.2.3.2">𝐾</ci><csymbol cd="latexml" id="A0.Ex78.m1.1.1.2.3.3.cmml" xref="A0.Ex78.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="A0.Ex78.m1.1.1.3.cmml" xref="A0.Ex78.m1.1.1.3"><root id="A0.Ex78.m1.1.1.3a.cmml" xref="A0.Ex78.m1.1.1.3"></root><apply id="A0.Ex78.m1.1.1.3.2.cmml" xref="A0.Ex78.m1.1.1.3.2"><csymbol cd="ambiguous" id="A0.Ex78.m1.1.1.3.2.1.cmml" xref="A0.Ex78.m1.1.1.3.2">subscript</csymbol><ci id="A0.Ex78.m1.1.1.3.2.2.cmml" xref="A0.Ex78.m1.1.1.3.2.2">𝑑</ci><ci id="A0.Ex78.m1.1.1.3.2.3a.cmml" xref="A0.Ex78.m1.1.1.3.2.3"><mtext id="A0.Ex78.m1.1.1.3.2.3.cmml" mathsize="70%" xref="A0.Ex78.m1.1.1.3.2.3">model</mtext></ci></apply></apply></apply><ci id="A0.Ex78.m1.1.2.3.4.cmml" xref="A0.Ex78.m1.1.2.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex78.m1.1c">\text{CrossAttn}=\text{Softmax}\left(\frac{QK^{\top}}{\sqrt{d_{\text{model}}}}%
\right)V</annotation><annotation encoding="application/x-llamapun" id="A0.Ex78.m1.1d">CrossAttn = Softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l16.1.1.1" style="font-size:80%;">16:</span></span>     Apply FFN, residuals, and normalization

</div>
<div class="ltx_listingline" id="alg3.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l17.2">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l17.3">for</span>
</div>
<div class="ltx_listingline" id="alg3.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l18.1.1.1" style="font-size:80%;">18:</span></span>Let decoder output: <math alttext="\mathbf{H}^{\text{dec}}\in\mathbb{R}^{B\times H\times d_{\text{model}}}" class="ltx_Math" display="inline" id="alg3.l18.m1.1"><semantics id="alg3.l18.m1.1a"><mrow id="alg3.l18.m1.1.1" xref="alg3.l18.m1.1.1.cmml"><msup id="alg3.l18.m1.1.1.2" xref="alg3.l18.m1.1.1.2.cmml"><mi id="alg3.l18.m1.1.1.2.2" xref="alg3.l18.m1.1.1.2.2.cmml">𝐇</mi><mtext id="alg3.l18.m1.1.1.2.3" xref="alg3.l18.m1.1.1.2.3a.cmml">dec</mtext></msup><mo id="alg3.l18.m1.1.1.1" xref="alg3.l18.m1.1.1.1.cmml">∈</mo><msup id="alg3.l18.m1.1.1.3" xref="alg3.l18.m1.1.1.3.cmml"><mi id="alg3.l18.m1.1.1.3.2" xref="alg3.l18.m1.1.1.3.2.cmml">ℝ</mi><mrow id="alg3.l18.m1.1.1.3.3" xref="alg3.l18.m1.1.1.3.3.cmml"><mi id="alg3.l18.m1.1.1.3.3.2" xref="alg3.l18.m1.1.1.3.3.2.cmml">B</mi><mo id="alg3.l18.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg3.l18.m1.1.1.3.3.1.cmml">×</mo><mi id="alg3.l18.m1.1.1.3.3.3" xref="alg3.l18.m1.1.1.3.3.3.cmml">H</mi><mo id="alg3.l18.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="alg3.l18.m1.1.1.3.3.1.cmml">×</mo><msub id="alg3.l18.m1.1.1.3.3.4" xref="alg3.l18.m1.1.1.3.3.4.cmml"><mi id="alg3.l18.m1.1.1.3.3.4.2" xref="alg3.l18.m1.1.1.3.3.4.2.cmml">d</mi><mtext id="alg3.l18.m1.1.1.3.3.4.3" xref="alg3.l18.m1.1.1.3.3.4.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l18.m1.1b"><apply id="alg3.l18.m1.1.1.cmml" xref="alg3.l18.m1.1.1"><in id="alg3.l18.m1.1.1.1.cmml" xref="alg3.l18.m1.1.1.1"></in><apply id="alg3.l18.m1.1.1.2.cmml" xref="alg3.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l18.m1.1.1.2.1.cmml" xref="alg3.l18.m1.1.1.2">superscript</csymbol><ci id="alg3.l18.m1.1.1.2.2.cmml" xref="alg3.l18.m1.1.1.2.2">𝐇</ci><ci id="alg3.l18.m1.1.1.2.3a.cmml" xref="alg3.l18.m1.1.1.2.3"><mtext id="alg3.l18.m1.1.1.2.3.cmml" mathsize="70%" xref="alg3.l18.m1.1.1.2.3">dec</mtext></ci></apply><apply id="alg3.l18.m1.1.1.3.cmml" xref="alg3.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l18.m1.1.1.3.1.cmml" xref="alg3.l18.m1.1.1.3">superscript</csymbol><ci id="alg3.l18.m1.1.1.3.2.cmml" xref="alg3.l18.m1.1.1.3.2">ℝ</ci><apply id="alg3.l18.m1.1.1.3.3.cmml" xref="alg3.l18.m1.1.1.3.3"><times id="alg3.l18.m1.1.1.3.3.1.cmml" xref="alg3.l18.m1.1.1.3.3.1"></times><ci id="alg3.l18.m1.1.1.3.3.2.cmml" xref="alg3.l18.m1.1.1.3.3.2">𝐵</ci><ci id="alg3.l18.m1.1.1.3.3.3.cmml" xref="alg3.l18.m1.1.1.3.3.3">𝐻</ci><apply id="alg3.l18.m1.1.1.3.3.4.cmml" xref="alg3.l18.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg3.l18.m1.1.1.3.3.4.1.cmml" xref="alg3.l18.m1.1.1.3.3.4">subscript</csymbol><ci id="alg3.l18.m1.1.1.3.3.4.2.cmml" xref="alg3.l18.m1.1.1.3.3.4.2">𝑑</ci><ci id="alg3.l18.m1.1.1.3.3.4.3a.cmml" xref="alg3.l18.m1.1.1.3.3.4.3"><mtext id="alg3.l18.m1.1.1.3.3.4.3.cmml" mathsize="50%" xref="alg3.l18.m1.1.1.3.3.4.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.m1.1c">\mathbf{H}^{\text{dec}}\in\mathbb{R}^{B\times H\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l18.m1.1d">bold_H start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l19.2">Step 5: Forecast Projection</span>
</div>
<div class="ltx_listingline" id="alg3.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l20.1.1.1" style="font-size:80%;">20:</span></span>Forecast seasonal output:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex79">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}^{\text{seasonal}}=\mathbf{H}^{\text{dec}}\cdot\mathbf{W}_{o}%
\in\mathbb{R}^{B\times H}" class="ltx_Math" display="block" id="A0.Ex79.m1.1"><semantics id="A0.Ex79.m1.1a"><mrow id="A0.Ex79.m1.1.1" xref="A0.Ex79.m1.1.1.cmml"><msup id="A0.Ex79.m1.1.1.2" xref="A0.Ex79.m1.1.1.2.cmml"><mover accent="true" id="A0.Ex79.m1.1.1.2.2" xref="A0.Ex79.m1.1.1.2.2.cmml"><mi id="A0.Ex79.m1.1.1.2.2.2" xref="A0.Ex79.m1.1.1.2.2.2.cmml">𝐲</mi><mo id="A0.Ex79.m1.1.1.2.2.1" xref="A0.Ex79.m1.1.1.2.2.1.cmml">^</mo></mover><mtext id="A0.Ex79.m1.1.1.2.3" xref="A0.Ex79.m1.1.1.2.3a.cmml">seasonal</mtext></msup><mo id="A0.Ex79.m1.1.1.3" xref="A0.Ex79.m1.1.1.3.cmml">=</mo><mrow id="A0.Ex79.m1.1.1.4" xref="A0.Ex79.m1.1.1.4.cmml"><msup id="A0.Ex79.m1.1.1.4.2" xref="A0.Ex79.m1.1.1.4.2.cmml"><mi id="A0.Ex79.m1.1.1.4.2.2" xref="A0.Ex79.m1.1.1.4.2.2.cmml">𝐇</mi><mtext id="A0.Ex79.m1.1.1.4.2.3" xref="A0.Ex79.m1.1.1.4.2.3a.cmml">dec</mtext></msup><mo id="A0.Ex79.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex79.m1.1.1.4.1.cmml">⋅</mo><msub id="A0.Ex79.m1.1.1.4.3" xref="A0.Ex79.m1.1.1.4.3.cmml"><mi id="A0.Ex79.m1.1.1.4.3.2" xref="A0.Ex79.m1.1.1.4.3.2.cmml">𝐖</mi><mi id="A0.Ex79.m1.1.1.4.3.3" xref="A0.Ex79.m1.1.1.4.3.3.cmml">o</mi></msub></mrow><mo id="A0.Ex79.m1.1.1.5" xref="A0.Ex79.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex79.m1.1.1.6" xref="A0.Ex79.m1.1.1.6.cmml"><mi id="A0.Ex79.m1.1.1.6.2" xref="A0.Ex79.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex79.m1.1.1.6.3" xref="A0.Ex79.m1.1.1.6.3.cmml"><mi id="A0.Ex79.m1.1.1.6.3.2" xref="A0.Ex79.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex79.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex79.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex79.m1.1.1.6.3.3" xref="A0.Ex79.m1.1.1.6.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex79.m1.1b"><apply id="A0.Ex79.m1.1.1.cmml" xref="A0.Ex79.m1.1.1"><and id="A0.Ex79.m1.1.1a.cmml" xref="A0.Ex79.m1.1.1"></and><apply id="A0.Ex79.m1.1.1b.cmml" xref="A0.Ex79.m1.1.1"><eq id="A0.Ex79.m1.1.1.3.cmml" xref="A0.Ex79.m1.1.1.3"></eq><apply id="A0.Ex79.m1.1.1.2.cmml" xref="A0.Ex79.m1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex79.m1.1.1.2.1.cmml" xref="A0.Ex79.m1.1.1.2">superscript</csymbol><apply id="A0.Ex79.m1.1.1.2.2.cmml" xref="A0.Ex79.m1.1.1.2.2"><ci id="A0.Ex79.m1.1.1.2.2.1.cmml" xref="A0.Ex79.m1.1.1.2.2.1">^</ci><ci id="A0.Ex79.m1.1.1.2.2.2.cmml" xref="A0.Ex79.m1.1.1.2.2.2">𝐲</ci></apply><ci id="A0.Ex79.m1.1.1.2.3a.cmml" xref="A0.Ex79.m1.1.1.2.3"><mtext id="A0.Ex79.m1.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex79.m1.1.1.2.3">seasonal</mtext></ci></apply><apply id="A0.Ex79.m1.1.1.4.cmml" xref="A0.Ex79.m1.1.1.4"><ci id="A0.Ex79.m1.1.1.4.1.cmml" xref="A0.Ex79.m1.1.1.4.1">⋅</ci><apply id="A0.Ex79.m1.1.1.4.2.cmml" xref="A0.Ex79.m1.1.1.4.2"><csymbol cd="ambiguous" id="A0.Ex79.m1.1.1.4.2.1.cmml" xref="A0.Ex79.m1.1.1.4.2">superscript</csymbol><ci id="A0.Ex79.m1.1.1.4.2.2.cmml" xref="A0.Ex79.m1.1.1.4.2.2">𝐇</ci><ci id="A0.Ex79.m1.1.1.4.2.3a.cmml" xref="A0.Ex79.m1.1.1.4.2.3"><mtext id="A0.Ex79.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A0.Ex79.m1.1.1.4.2.3">dec</mtext></ci></apply><apply id="A0.Ex79.m1.1.1.4.3.cmml" xref="A0.Ex79.m1.1.1.4.3"><csymbol cd="ambiguous" id="A0.Ex79.m1.1.1.4.3.1.cmml" xref="A0.Ex79.m1.1.1.4.3">subscript</csymbol><ci id="A0.Ex79.m1.1.1.4.3.2.cmml" xref="A0.Ex79.m1.1.1.4.3.2">𝐖</ci><ci id="A0.Ex79.m1.1.1.4.3.3.cmml" xref="A0.Ex79.m1.1.1.4.3.3">𝑜</ci></apply></apply></apply><apply id="A0.Ex79.m1.1.1c.cmml" xref="A0.Ex79.m1.1.1"><in id="A0.Ex79.m1.1.1.5.cmml" xref="A0.Ex79.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex79.m1.1.1.4.cmml" id="A0.Ex79.m1.1.1d.cmml" xref="A0.Ex79.m1.1.1"></share><apply id="A0.Ex79.m1.1.1.6.cmml" xref="A0.Ex79.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex79.m1.1.1.6.1.cmml" xref="A0.Ex79.m1.1.1.6">superscript</csymbol><ci id="A0.Ex79.m1.1.1.6.2.cmml" xref="A0.Ex79.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex79.m1.1.1.6.3.cmml" xref="A0.Ex79.m1.1.1.6.3"><times id="A0.Ex79.m1.1.1.6.3.1.cmml" xref="A0.Ex79.m1.1.1.6.3.1"></times><ci id="A0.Ex79.m1.1.1.6.3.2.cmml" xref="A0.Ex79.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex79.m1.1.1.6.3.3.cmml" xref="A0.Ex79.m1.1.1.6.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex79.m1.1c">\hat{\mathbf{y}}^{\text{seasonal}}=\mathbf{H}^{\text{dec}}\cdot\mathbf{W}_{o}%
\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex79.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT = bold_H start_POSTSUPERSCRIPT dec end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l21.1.1.1" style="font-size:80%;">21:</span></span>Forecast trend output:

<table class="ltx_equation ltx_eqn_table" id="A0.Ex80">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}^{\text{trend}}=\mathbf{x}^{\text{trend}}\cdot\mathbf{W}_{t}%
\in\mathbb{R}^{B\times H}" class="ltx_Math" display="block" id="A0.Ex80.m1.1"><semantics id="A0.Ex80.m1.1a"><mrow id="A0.Ex80.m1.1.1" xref="A0.Ex80.m1.1.1.cmml"><msup id="A0.Ex80.m1.1.1.2" xref="A0.Ex80.m1.1.1.2.cmml"><mover accent="true" id="A0.Ex80.m1.1.1.2.2" xref="A0.Ex80.m1.1.1.2.2.cmml"><mi id="A0.Ex80.m1.1.1.2.2.2" xref="A0.Ex80.m1.1.1.2.2.2.cmml">𝐲</mi><mo id="A0.Ex80.m1.1.1.2.2.1" xref="A0.Ex80.m1.1.1.2.2.1.cmml">^</mo></mover><mtext id="A0.Ex80.m1.1.1.2.3" xref="A0.Ex80.m1.1.1.2.3a.cmml">trend</mtext></msup><mo id="A0.Ex80.m1.1.1.3" xref="A0.Ex80.m1.1.1.3.cmml">=</mo><mrow id="A0.Ex80.m1.1.1.4" xref="A0.Ex80.m1.1.1.4.cmml"><msup id="A0.Ex80.m1.1.1.4.2" xref="A0.Ex80.m1.1.1.4.2.cmml"><mi id="A0.Ex80.m1.1.1.4.2.2" xref="A0.Ex80.m1.1.1.4.2.2.cmml">𝐱</mi><mtext id="A0.Ex80.m1.1.1.4.2.3" xref="A0.Ex80.m1.1.1.4.2.3a.cmml">trend</mtext></msup><mo id="A0.Ex80.m1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex80.m1.1.1.4.1.cmml">⋅</mo><msub id="A0.Ex80.m1.1.1.4.3" xref="A0.Ex80.m1.1.1.4.3.cmml"><mi id="A0.Ex80.m1.1.1.4.3.2" xref="A0.Ex80.m1.1.1.4.3.2.cmml">𝐖</mi><mi id="A0.Ex80.m1.1.1.4.3.3" xref="A0.Ex80.m1.1.1.4.3.3.cmml">t</mi></msub></mrow><mo id="A0.Ex80.m1.1.1.5" xref="A0.Ex80.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex80.m1.1.1.6" xref="A0.Ex80.m1.1.1.6.cmml"><mi id="A0.Ex80.m1.1.1.6.2" xref="A0.Ex80.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex80.m1.1.1.6.3" xref="A0.Ex80.m1.1.1.6.3.cmml"><mi id="A0.Ex80.m1.1.1.6.3.2" xref="A0.Ex80.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex80.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex80.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex80.m1.1.1.6.3.3" xref="A0.Ex80.m1.1.1.6.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex80.m1.1b"><apply id="A0.Ex80.m1.1.1.cmml" xref="A0.Ex80.m1.1.1"><and id="A0.Ex80.m1.1.1a.cmml" xref="A0.Ex80.m1.1.1"></and><apply id="A0.Ex80.m1.1.1b.cmml" xref="A0.Ex80.m1.1.1"><eq id="A0.Ex80.m1.1.1.3.cmml" xref="A0.Ex80.m1.1.1.3"></eq><apply id="A0.Ex80.m1.1.1.2.cmml" xref="A0.Ex80.m1.1.1.2"><csymbol cd="ambiguous" id="A0.Ex80.m1.1.1.2.1.cmml" xref="A0.Ex80.m1.1.1.2">superscript</csymbol><apply id="A0.Ex80.m1.1.1.2.2.cmml" xref="A0.Ex80.m1.1.1.2.2"><ci id="A0.Ex80.m1.1.1.2.2.1.cmml" xref="A0.Ex80.m1.1.1.2.2.1">^</ci><ci id="A0.Ex80.m1.1.1.2.2.2.cmml" xref="A0.Ex80.m1.1.1.2.2.2">𝐲</ci></apply><ci id="A0.Ex80.m1.1.1.2.3a.cmml" xref="A0.Ex80.m1.1.1.2.3"><mtext id="A0.Ex80.m1.1.1.2.3.cmml" mathsize="70%" xref="A0.Ex80.m1.1.1.2.3">trend</mtext></ci></apply><apply id="A0.Ex80.m1.1.1.4.cmml" xref="A0.Ex80.m1.1.1.4"><ci id="A0.Ex80.m1.1.1.4.1.cmml" xref="A0.Ex80.m1.1.1.4.1">⋅</ci><apply id="A0.Ex80.m1.1.1.4.2.cmml" xref="A0.Ex80.m1.1.1.4.2"><csymbol cd="ambiguous" id="A0.Ex80.m1.1.1.4.2.1.cmml" xref="A0.Ex80.m1.1.1.4.2">superscript</csymbol><ci id="A0.Ex80.m1.1.1.4.2.2.cmml" xref="A0.Ex80.m1.1.1.4.2.2">𝐱</ci><ci id="A0.Ex80.m1.1.1.4.2.3a.cmml" xref="A0.Ex80.m1.1.1.4.2.3"><mtext id="A0.Ex80.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A0.Ex80.m1.1.1.4.2.3">trend</mtext></ci></apply><apply id="A0.Ex80.m1.1.1.4.3.cmml" xref="A0.Ex80.m1.1.1.4.3"><csymbol cd="ambiguous" id="A0.Ex80.m1.1.1.4.3.1.cmml" xref="A0.Ex80.m1.1.1.4.3">subscript</csymbol><ci id="A0.Ex80.m1.1.1.4.3.2.cmml" xref="A0.Ex80.m1.1.1.4.3.2">𝐖</ci><ci id="A0.Ex80.m1.1.1.4.3.3.cmml" xref="A0.Ex80.m1.1.1.4.3.3">𝑡</ci></apply></apply></apply><apply id="A0.Ex80.m1.1.1c.cmml" xref="A0.Ex80.m1.1.1"><in id="A0.Ex80.m1.1.1.5.cmml" xref="A0.Ex80.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex80.m1.1.1.4.cmml" id="A0.Ex80.m1.1.1d.cmml" xref="A0.Ex80.m1.1.1"></share><apply id="A0.Ex80.m1.1.1.6.cmml" xref="A0.Ex80.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex80.m1.1.1.6.1.cmml" xref="A0.Ex80.m1.1.1.6">superscript</csymbol><ci id="A0.Ex80.m1.1.1.6.2.cmml" xref="A0.Ex80.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex80.m1.1.1.6.3.cmml" xref="A0.Ex80.m1.1.1.6.3"><times id="A0.Ex80.m1.1.1.6.3.1.cmml" xref="A0.Ex80.m1.1.1.6.3.1"></times><ci id="A0.Ex80.m1.1.1.6.3.2.cmml" xref="A0.Ex80.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex80.m1.1.1.6.3.3.cmml" xref="A0.Ex80.m1.1.1.6.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex80.m1.1c">\hat{\mathbf{y}}^{\text{trend}}=\mathbf{x}^{\text{trend}}\cdot\mathbf{W}_{t}%
\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex80.m1.1d">over^ start_ARG bold_y end_ARG start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT = bold_x start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT ⋅ bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l22.1.1.1" style="font-size:80%;">22:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l22.2">Step 6: Final Output</span>
<table class="ltx_equation ltx_eqn_table" id="A0.Ex81">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{y}}=\hat{\mathbf{y}}^{\text{seasonal}}+\hat{\mathbf{y}}^{\text{%
trend}}\in\mathbb{R}^{B\times H}" class="ltx_Math" display="block" id="A0.Ex81.m1.1"><semantics id="A0.Ex81.m1.1a"><mrow id="A0.Ex81.m1.1.1" xref="A0.Ex81.m1.1.1.cmml"><mover accent="true" id="A0.Ex81.m1.1.1.2" xref="A0.Ex81.m1.1.1.2.cmml"><mi id="A0.Ex81.m1.1.1.2.2" xref="A0.Ex81.m1.1.1.2.2.cmml">𝐲</mi><mo id="A0.Ex81.m1.1.1.2.1" xref="A0.Ex81.m1.1.1.2.1.cmml">^</mo></mover><mo id="A0.Ex81.m1.1.1.3" xref="A0.Ex81.m1.1.1.3.cmml">=</mo><mrow id="A0.Ex81.m1.1.1.4" xref="A0.Ex81.m1.1.1.4.cmml"><msup id="A0.Ex81.m1.1.1.4.2" xref="A0.Ex81.m1.1.1.4.2.cmml"><mover accent="true" id="A0.Ex81.m1.1.1.4.2.2" xref="A0.Ex81.m1.1.1.4.2.2.cmml"><mi id="A0.Ex81.m1.1.1.4.2.2.2" xref="A0.Ex81.m1.1.1.4.2.2.2.cmml">𝐲</mi><mo id="A0.Ex81.m1.1.1.4.2.2.1" xref="A0.Ex81.m1.1.1.4.2.2.1.cmml">^</mo></mover><mtext id="A0.Ex81.m1.1.1.4.2.3" xref="A0.Ex81.m1.1.1.4.2.3a.cmml">seasonal</mtext></msup><mo id="A0.Ex81.m1.1.1.4.1" xref="A0.Ex81.m1.1.1.4.1.cmml">+</mo><msup id="A0.Ex81.m1.1.1.4.3" xref="A0.Ex81.m1.1.1.4.3.cmml"><mover accent="true" id="A0.Ex81.m1.1.1.4.3.2" xref="A0.Ex81.m1.1.1.4.3.2.cmml"><mi id="A0.Ex81.m1.1.1.4.3.2.2" xref="A0.Ex81.m1.1.1.4.3.2.2.cmml">𝐲</mi><mo id="A0.Ex81.m1.1.1.4.3.2.1" xref="A0.Ex81.m1.1.1.4.3.2.1.cmml">^</mo></mover><mtext id="A0.Ex81.m1.1.1.4.3.3" xref="A0.Ex81.m1.1.1.4.3.3a.cmml">trend</mtext></msup></mrow><mo id="A0.Ex81.m1.1.1.5" xref="A0.Ex81.m1.1.1.5.cmml">∈</mo><msup id="A0.Ex81.m1.1.1.6" xref="A0.Ex81.m1.1.1.6.cmml"><mi id="A0.Ex81.m1.1.1.6.2" xref="A0.Ex81.m1.1.1.6.2.cmml">ℝ</mi><mrow id="A0.Ex81.m1.1.1.6.3" xref="A0.Ex81.m1.1.1.6.3.cmml"><mi id="A0.Ex81.m1.1.1.6.3.2" xref="A0.Ex81.m1.1.1.6.3.2.cmml">B</mi><mo id="A0.Ex81.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A0.Ex81.m1.1.1.6.3.1.cmml">×</mo><mi id="A0.Ex81.m1.1.1.6.3.3" xref="A0.Ex81.m1.1.1.6.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A0.Ex81.m1.1b"><apply id="A0.Ex81.m1.1.1.cmml" xref="A0.Ex81.m1.1.1"><and id="A0.Ex81.m1.1.1a.cmml" xref="A0.Ex81.m1.1.1"></and><apply id="A0.Ex81.m1.1.1b.cmml" xref="A0.Ex81.m1.1.1"><eq id="A0.Ex81.m1.1.1.3.cmml" xref="A0.Ex81.m1.1.1.3"></eq><apply id="A0.Ex81.m1.1.1.2.cmml" xref="A0.Ex81.m1.1.1.2"><ci id="A0.Ex81.m1.1.1.2.1.cmml" xref="A0.Ex81.m1.1.1.2.1">^</ci><ci id="A0.Ex81.m1.1.1.2.2.cmml" xref="A0.Ex81.m1.1.1.2.2">𝐲</ci></apply><apply id="A0.Ex81.m1.1.1.4.cmml" xref="A0.Ex81.m1.1.1.4"><plus id="A0.Ex81.m1.1.1.4.1.cmml" xref="A0.Ex81.m1.1.1.4.1"></plus><apply id="A0.Ex81.m1.1.1.4.2.cmml" xref="A0.Ex81.m1.1.1.4.2"><csymbol cd="ambiguous" id="A0.Ex81.m1.1.1.4.2.1.cmml" xref="A0.Ex81.m1.1.1.4.2">superscript</csymbol><apply id="A0.Ex81.m1.1.1.4.2.2.cmml" xref="A0.Ex81.m1.1.1.4.2.2"><ci id="A0.Ex81.m1.1.1.4.2.2.1.cmml" xref="A0.Ex81.m1.1.1.4.2.2.1">^</ci><ci id="A0.Ex81.m1.1.1.4.2.2.2.cmml" xref="A0.Ex81.m1.1.1.4.2.2.2">𝐲</ci></apply><ci id="A0.Ex81.m1.1.1.4.2.3a.cmml" xref="A0.Ex81.m1.1.1.4.2.3"><mtext id="A0.Ex81.m1.1.1.4.2.3.cmml" mathsize="70%" xref="A0.Ex81.m1.1.1.4.2.3">seasonal</mtext></ci></apply><apply id="A0.Ex81.m1.1.1.4.3.cmml" xref="A0.Ex81.m1.1.1.4.3"><csymbol cd="ambiguous" id="A0.Ex81.m1.1.1.4.3.1.cmml" xref="A0.Ex81.m1.1.1.4.3">superscript</csymbol><apply id="A0.Ex81.m1.1.1.4.3.2.cmml" xref="A0.Ex81.m1.1.1.4.3.2"><ci id="A0.Ex81.m1.1.1.4.3.2.1.cmml" xref="A0.Ex81.m1.1.1.4.3.2.1">^</ci><ci id="A0.Ex81.m1.1.1.4.3.2.2.cmml" xref="A0.Ex81.m1.1.1.4.3.2.2">𝐲</ci></apply><ci id="A0.Ex81.m1.1.1.4.3.3a.cmml" xref="A0.Ex81.m1.1.1.4.3.3"><mtext id="A0.Ex81.m1.1.1.4.3.3.cmml" mathsize="70%" xref="A0.Ex81.m1.1.1.4.3.3">trend</mtext></ci></apply></apply></apply><apply id="A0.Ex81.m1.1.1c.cmml" xref="A0.Ex81.m1.1.1"><in id="A0.Ex81.m1.1.1.5.cmml" xref="A0.Ex81.m1.1.1.5"></in><share href="https://arxiv.org/html/2505.20048v1#A0.Ex81.m1.1.1.4.cmml" id="A0.Ex81.m1.1.1d.cmml" xref="A0.Ex81.m1.1.1"></share><apply id="A0.Ex81.m1.1.1.6.cmml" xref="A0.Ex81.m1.1.1.6"><csymbol cd="ambiguous" id="A0.Ex81.m1.1.1.6.1.cmml" xref="A0.Ex81.m1.1.1.6">superscript</csymbol><ci id="A0.Ex81.m1.1.1.6.2.cmml" xref="A0.Ex81.m1.1.1.6.2">ℝ</ci><apply id="A0.Ex81.m1.1.1.6.3.cmml" xref="A0.Ex81.m1.1.1.6.3"><times id="A0.Ex81.m1.1.1.6.3.1.cmml" xref="A0.Ex81.m1.1.1.6.3.1"></times><ci id="A0.Ex81.m1.1.1.6.3.2.cmml" xref="A0.Ex81.m1.1.1.6.3.2">𝐵</ci><ci id="A0.Ex81.m1.1.1.6.3.3.cmml" xref="A0.Ex81.m1.1.1.6.3.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A0.Ex81.m1.1c">\hat{\mathbf{y}}=\hat{\mathbf{y}}^{\text{seasonal}}+\hat{\mathbf{y}}^{\text{%
trend}}\in\mathbb{R}^{B\times H}</annotation><annotation encoding="application/x-llamapun" id="A0.Ex81.m1.1d">over^ start_ARG bold_y end_ARG = over^ start_ARG bold_y end_ARG start_POSTSUPERSCRIPT seasonal end_POSTSUPERSCRIPT + over^ start_ARG bold_y end_ARG start_POSTSUPERSCRIPT trend end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l23.1.1.1" style="font-size:80%;">23:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l23.2">return</span> <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="alg3.l23.m1.1"><semantics id="alg3.l23.m1.1a"><mover accent="true" id="alg3.l23.m1.1.1" xref="alg3.l23.m1.1.1.cmml"><mi id="alg3.l23.m1.1.1.2" xref="alg3.l23.m1.1.1.2.cmml">𝐲</mi><mo id="alg3.l23.m1.1.1.1" xref="alg3.l23.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg3.l23.m1.1b"><apply id="alg3.l23.m1.1.1.cmml" xref="alg3.l23.m1.1.1"><ci id="alg3.l23.m1.1.1.1.cmml" xref="alg3.l23.m1.1.1.1">^</ci><ci id="alg3.l23.m1.1.1.2.cmml" xref="alg3.l23.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l23.m1.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l23.m1.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. Forootani, D. E. Aliabadi, and D. Thraen, “Climate aware deep neural
networks (cadnn) for wind power simulation,” <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">arXiv preprint
arXiv:2412.12160</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
F. M. Alvarez, A. Troncoso, J. C. Riquelme, and J. S. A. Ruiz, “Energy time
series forecasting based on pattern sequence similarity,” <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">IEEE
Transactions on Knowledge and Data Engineering</span>, vol. 23, no. 8,
pp. 1230–1243, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Dingli and K. S. Fournier, “Financial time series forecasting-a deep
learning approach,” <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">International Journal of Machine Learning and
Computing</span>, vol. 7, no. 5, pp. 118–122, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. Wang, Y. Lin, Y. Jia, J. Sun, and Z. Yang, “Unveiling the multi-dimensional
spatio-temporal fusion transformer (mdstft): A revolutionary deep learning
framework for enhanced multi-variate time series forecasting,” <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">IEEE
Access</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
K. Yan, C. Long, H. Wu, and Z. Wen, “Multi-resolution expansion of analysis in
time-frequency domain for time series forecasting,” <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">IEEE Transactions
on Knowledge and Data Engineering</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. Tascikaraoglu, B. M. Sanandaji, G. Chicco, V. Cocina, F. Spertino,
O. Erdinc, N. G. Paterakis, and J. P. Catalão, “Compressive spatio-temporal
forecasting of meteorological quantities and photovoltaic power,” <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">IEEE
Transactions on Sustainable Energy</span>, vol. 7, no. 3, pp. 1295–1305, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
K. Benidis, S. S. Rangapuram, V. Flunkert, Y. Wang, D. Maddix, C. Turkmen,
J. Gasthaus, M. Bohlke-Schneider, D. Salinas, L. Stella, <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">et al.</span>, “Deep
learning for time series forecasting: Tutorial and literature survey,” <span class="ltx_text ltx_font_italic" id="bib.bib7.2.2">ACM Computing Surveys</span>, vol. 55, no. 6, pp. 1–36, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
P. Hewage, A. Behera, M. Trovati, E. Pereira, M. Ghahremani, F. Palmieri, and
Y. Liu, “Temporal convolutional neural (tcn) network for an effective
weather forecasting using time-series data from the local weather station,”
<span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Soft Computing</span>, vol. 24, pp. 16453–16482, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. Bryan and Z. Stefan, “Time-series forecasting with deep learning: a
survey,” <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Phil. Trans. R. Soc. A</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
J. F. Torres, D. Hadjout, A. Sebaa, F. Martínez-Álvarez, and
A. Troncoso, “Deep learning for time series forecasting: a survey,” <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Big Data</span>, vol. 9, no. 1, pp. 3–21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
P. Lara-Benítez, M. Carranza-García, and J. C. Riquelme, “An
experimental review on deep learning architectures for time series
forecasting,” <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">International Journal of Neural Systems</span>, vol. 31,
no. 03, p. 2130001, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
K. S. Kalyan, A. Rajasekharan, and S. Sangeetha, “Ammus: A survey of
transformer-based pretrained models in natural language processing,” <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2108.05542</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
L. Kaiser, and I. Polosukhin, “Attention is all you need,” in <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Advances
in Neural Information Processing Systems</span>, vol. 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. Khan, M. Naseer, M. Hayat, S. W. Zamir, F. S. Khan, and M. Shah,
“Transformers in vision: A survey,” <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">ACM Computing Surveys (CSUR)</span>,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Karita, N. Chen, T. Hayashi, T. Hori, H. Inaguma, Z. Jiang, M. Someki,
N. E. Y. Soplin, R. Yamamoto, X. Wang, <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">et al.</span>, “A comparative study on
transformer vs rnn in speech applications,” in <span class="ltx_text ltx_font_italic" id="bib.bib15.2.2">IEEE Automatic Speech
Recognition and Understanding Workshop (ASRU)</span>, pp. 449–456, IEEE, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Q. Wen, T. Zhou, C. Zhang, W. Chen, Z. Ma, J. Yan, and L. Sun, “Transformers
in time series: A survey,” <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2202.07125</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Q. Fournier, G. M. Caron, and D. Aloise, “A practical survey on faster and
lighter transformers,” <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">ACM Computing Surveys</span>, vol. 55, no. 14s,
pp. 1–40, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
C. Zhu, W. Ping, C. Xiao, M. Shoeybi, T. Goldstein, A. Anandkumar, and
B. Catanzaro, “Long-short transformer: Efficient transformers for language
and vision,” <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Advances in neural information processing systems</span>,
vol. 34, pp. 17723–17736, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
H. Zhou, S. Zhang, J. Peng, S. Zhang, J. Li, H. Xiong, and W. Zhang,
“Informer: Beyond efficient transformer for long sequence time-series
forecasting,” in <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">The Thirty-Fifth AAAI Conference on Artificial
Intelligence</span>, vol. 35, pp. 11106–11115, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Wu, J. Xu, J. Wang, and M. Long, “Autoformer: Decomposition transformers
with Auto-Correlation for long-term series forecasting,” in <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Advances
in Neural Information Processing Systems</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
T. Zhou, Z. Ma, Q. Wen, X. Wang, L. Sun, and R. Jin, “FEDformer: Frequency
enhanced decomposed transformer for long-term series forecasting,” in <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Proc. 39th International Conference on Machine Learning</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
S. Liu, H. Yu, C. Liao, J. Li, W. Lin, A. X. Liu, and S. Dustdar, “Pyraformer:
Low-complexity pyramidal attention for long-range time series modeling and
forecasting,” in <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</span>,
2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
A. Zeng, M. Chen, L. Zhang, and Q. Xu, “Are transformers effective for time
series forecasting?,” <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2205.13504</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Nie, N. H. Nguyen, P. Sinthong, and J. Kalagnanam, “A time series is worth
64 words: Long-term forecasting with transformers,” <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">arXiv preprint
arXiv:2211.14730</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai,
T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, J. Uszkoreit,
and N. Houlsby, “An image is worth 16x16 words: Transformers for image
recognition at scale,” in <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">International Conference on Learning
Representations</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
A. Baevski, Y. Zhou, A. Mohamed, and M. Auli, “wav2vec 2.0: A framework for
self-supervised learning of speech representations,” <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Advances in Neural
Information Processing Systems</span>, vol. 33, pp. 12449–12460, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Y. Zheng, Q. Liu, E. Chen, Y. Ge, and J. L. Zhao, “Time series classification
using multi-channels deep convolutional neural networks,” in <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">International conference on web-age information management</span>, pp. 298–310,
Springer, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
B. Lusch, J. N. Kutz, and S. L. Brunton, “Deep learning for universal linear
embeddings of nonlinear dynamics,” <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Nature Communications</span>, vol. 9,
p. 4950, Nov. 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
E. Yeung, S. Kundu, and N. Hodas, “Learning deep neural network
representations for Koopman operators of nonlinear dynamical systems,” in
<span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">2019 American Control Conference (ACC)</span>, pp. 4832–4839, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
N. Takeishi, Y. Kawahara, and T. Yairi, “Learning Koopman invariant
subspaces for dynamic mode decomposition,” in <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Advances in Neural
Information Processing Systems</span> (I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, eds.), vol. 30,
Curran Associates, Inc., 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
J. Drgoňa, A. Tuor, S. Vasisht, and D. Vrabie, “Dissipative deep neural
dynamical systems,” <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">IEEE Open Journal of Control Systems</span>, vol. 1,
pp. 100–112, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
E. Skomski, S. Vasisht, C. Wight, A. Tuor, J. Drgoňa, and D. Vrabie,
“Constrained block nonlinear neural dynamical models,” in <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">2021
American Control Conference (ACC)</span>, pp. 3993–4000, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
J. Drgona, S. Mukherjee, J. Zhang, F. Liu, and M. Halappanavar, “On the
stochastic stability of deep markov models,” in <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Advances in Neural
Information Processing Systems</span> (M. Ranzato, A. Beygelzimer, Y. Dauphin,
P. Liang, and J. W. Vaughan, eds.), vol. 34, pp. 24033–24047, Curran
Associates, Inc., 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
B. Lusch, J. N. Kutz, and S. L. Brunton, “Deep learning for universal linear
embeddings of nonlinear dynamics,” <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Nature communications</span>, vol. 9,
no. 1, p. 4950, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
N. Takeishi, Y. Kawahara, and T. Yairi, “Learning koopman invariant subspaces
for dynamic mode decomposition,” <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Advances in neural information
processing systems</span>, vol. 30, 2017.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon May 26 14:24:22 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
