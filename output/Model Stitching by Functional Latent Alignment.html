<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Model Stitching by Functional Latent Alignment</title>
<!--Generated on Mon May 26 15:41:04 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.20142v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S1" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Model Stitching</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.SS1" title="In 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.SS2" title="In 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Adversarial Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.SS3" title="In 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Functional Latent Alignment (FuLA)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS1" title="In 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model Stitching under Adversarial Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS2" title="In 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Stitching under Shortcuts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS3" title="In 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Cross Layer Stitching</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S4" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S5" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A1" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A1.SS1" title="In Appendix A Experimental Setup ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Baseline Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A1.SS2" title="In Appendix A Experimental Setup ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Stitching Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A2" title="In Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Full Results on Additional Architectures</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A2.SS1" title="In Appendix B Full Results on Additional Architectures ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Model Stitching under Adversarial Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A2.SS2" title="In Appendix B Full Results on Additional Architectures ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Model Stitching under Shortcuts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A2.SS3" title="In Appendix B Full Results on Additional Architectures ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Model Stitching on a Subset of Classes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A2.SS4" title="In Appendix B Full Results on Additional Architectures ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Cross Layer Stitching</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Model Stitching by Functional Latent Alignment</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ioannis Athanasiadis  Anmar Karmush  Michael Felsberg
<br class="ltx_break"/>Linköping University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{firstname.lastname}@liu.se
<br class="ltx_break"/></span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Evaluating functional similarity involves quantifying the degree to which independently trained neural networks learn functionally similar representations. Reliably inferring the functional similarity of these networks remains an open problem with far-reaching implications for AI. Model stitching has emerged as a promising paradigm, where an optimal affine transformation aligns two models to solve a task, with the stitched model serving as a proxy for functional similarity. In this work, we draw inspiration from the knowledge distillation literature and propose Functional Latent Alignment (FuLA) as a novel optimality condition for model stitching. We revisit previously explored functional similarity testbeds and introduce a new one, based on which FuLA emerges as an overall more reliable method of functional similarity. Specifically, our experiments in (a) adversarial training, (b) shortcut training and, (c) cross-layer stitching, reveal that FuLA is less prone to artifacts tied to training on task cues while achieving non-trivial alignments that are missed by stitch-level matching.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Deep neural networks lie at the forefront of modern AI, driving significant advances across various domains ranging from computer vision <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib24" title="">24</a>]</cite> and natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib31" title="">31</a>]</cite> to healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib14" title="">14</a>]</cite>. Their success is attributed to their ability to learn meaningful representations of the data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib7" title="">7</a>]</cite> which capture their abstract relationships <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib45" title="">45</a>]</cite>. Understanding the emergence of these representations constitutes an important problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib23" title="">23</a>]</cite> from both scientific and applied perspectives <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib12" title="">12</a>]</cite>. One approach to gaining insight into learned representations is to compare the similarity of internal representations of different models. In the literature, such similarities generally fall into two categories: representational or functional similarity. In this work, we focus on the latter and address the problem of evaluating functional similarity. We adopt a functional consistency view: functionally similar networks should exhibit similarity in their internal transformations leading to the output.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="192" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.38.19.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.36.18" style="font-size:90%;">Conceptual visualization for different degrees of functional alignment. The <math alttext="f_{3}\circ f_{2}\circ f_{1}" class="ltx_Math" display="inline" id="S1.F1.19.1.m1.1"><semantics id="S1.F1.19.1.m1.1b"><mrow id="S1.F1.19.1.m1.1.1" xref="S1.F1.19.1.m1.1.1.cmml"><msub id="S1.F1.19.1.m1.1.1.2" xref="S1.F1.19.1.m1.1.1.2.cmml"><mi id="S1.F1.19.1.m1.1.1.2.2" xref="S1.F1.19.1.m1.1.1.2.2.cmml">f</mi><mn id="S1.F1.19.1.m1.1.1.2.3" xref="S1.F1.19.1.m1.1.1.2.3.cmml">3</mn></msub><mo id="S1.F1.19.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.F1.19.1.m1.1.1.1.cmml">∘</mo><msub id="S1.F1.19.1.m1.1.1.3" xref="S1.F1.19.1.m1.1.1.3.cmml"><mi id="S1.F1.19.1.m1.1.1.3.2" xref="S1.F1.19.1.m1.1.1.3.2.cmml">f</mi><mn id="S1.F1.19.1.m1.1.1.3.3" xref="S1.F1.19.1.m1.1.1.3.3.cmml">2</mn></msub><mo id="S1.F1.19.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S1.F1.19.1.m1.1.1.1.cmml">∘</mo><msub id="S1.F1.19.1.m1.1.1.4" xref="S1.F1.19.1.m1.1.1.4.cmml"><mi id="S1.F1.19.1.m1.1.1.4.2" xref="S1.F1.19.1.m1.1.1.4.2.cmml">f</mi><mn id="S1.F1.19.1.m1.1.1.4.3" xref="S1.F1.19.1.m1.1.1.4.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.19.1.m1.1c"><apply id="S1.F1.19.1.m1.1.1.cmml" xref="S1.F1.19.1.m1.1.1"><compose id="S1.F1.19.1.m1.1.1.1.cmml" xref="S1.F1.19.1.m1.1.1.1"></compose><apply id="S1.F1.19.1.m1.1.1.2.cmml" xref="S1.F1.19.1.m1.1.1.2"><csymbol cd="ambiguous" id="S1.F1.19.1.m1.1.1.2.1.cmml" xref="S1.F1.19.1.m1.1.1.2">subscript</csymbol><ci id="S1.F1.19.1.m1.1.1.2.2.cmml" xref="S1.F1.19.1.m1.1.1.2.2">𝑓</ci><cn id="S1.F1.19.1.m1.1.1.2.3.cmml" type="integer" xref="S1.F1.19.1.m1.1.1.2.3">3</cn></apply><apply id="S1.F1.19.1.m1.1.1.3.cmml" xref="S1.F1.19.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.F1.19.1.m1.1.1.3.1.cmml" xref="S1.F1.19.1.m1.1.1.3">subscript</csymbol><ci id="S1.F1.19.1.m1.1.1.3.2.cmml" xref="S1.F1.19.1.m1.1.1.3.2">𝑓</ci><cn id="S1.F1.19.1.m1.1.1.3.3.cmml" type="integer" xref="S1.F1.19.1.m1.1.1.3.3">2</cn></apply><apply id="S1.F1.19.1.m1.1.1.4.cmml" xref="S1.F1.19.1.m1.1.1.4"><csymbol cd="ambiguous" id="S1.F1.19.1.m1.1.1.4.1.cmml" xref="S1.F1.19.1.m1.1.1.4">subscript</csymbol><ci id="S1.F1.19.1.m1.1.1.4.2.cmml" xref="S1.F1.19.1.m1.1.1.4.2">𝑓</ci><cn id="S1.F1.19.1.m1.1.1.4.3.cmml" type="integer" xref="S1.F1.19.1.m1.1.1.4.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.19.1.m1.1d">f_{3}\circ f_{2}\circ f_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.19.1.m1.1e">italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is composition of functions mapping the input domain <math alttext="\bm{Z}" class="ltx_Math" display="inline" id="S1.F1.20.2.m2.1"><semantics id="S1.F1.20.2.m2.1b"><mi id="S1.F1.20.2.m2.1.1" xref="S1.F1.20.2.m2.1.1.cmml">𝒁</mi><annotation-xml encoding="MathML-Content" id="S1.F1.20.2.m2.1c"><ci id="S1.F1.20.2.m2.1.1.cmml" xref="S1.F1.20.2.m2.1.1">𝒁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.20.2.m2.1d">\bm{Z}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.20.2.m2.1e">bold_italic_Z</annotation></semantics></math> into the output domain <math alttext="\bm{Y}" class="ltx_Math" display="inline" id="S1.F1.21.3.m3.1"><semantics id="S1.F1.21.3.m3.1b"><mi id="S1.F1.21.3.m3.1.1" xref="S1.F1.21.3.m3.1.1.cmml">𝒀</mi><annotation-xml encoding="MathML-Content" id="S1.F1.21.3.m3.1c"><ci id="S1.F1.21.3.m3.1.1.cmml" xref="S1.F1.21.3.m3.1.1">𝒀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.21.3.m3.1d">\bm{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.21.3.m3.1e">bold_italic_Y</annotation></semantics></math> through two intermediate domains <math alttext="A_{1}" class="ltx_Math" display="inline" id="S1.F1.22.4.m4.1"><semantics id="S1.F1.22.4.m4.1b"><msub id="S1.F1.22.4.m4.1.1" xref="S1.F1.22.4.m4.1.1.cmml"><mi id="S1.F1.22.4.m4.1.1.2" xref="S1.F1.22.4.m4.1.1.2.cmml">A</mi><mn id="S1.F1.22.4.m4.1.1.3" xref="S1.F1.22.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.22.4.m4.1c"><apply id="S1.F1.22.4.m4.1.1.cmml" xref="S1.F1.22.4.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.22.4.m4.1.1.1.cmml" xref="S1.F1.22.4.m4.1.1">subscript</csymbol><ci id="S1.F1.22.4.m4.1.1.2.cmml" xref="S1.F1.22.4.m4.1.1.2">𝐴</ci><cn id="S1.F1.22.4.m4.1.1.3.cmml" type="integer" xref="S1.F1.22.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.22.4.m4.1d">A_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.22.4.m4.1e">italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="A_{2}" class="ltx_Math" display="inline" id="S1.F1.23.5.m5.1"><semantics id="S1.F1.23.5.m5.1b"><msub id="S1.F1.23.5.m5.1.1" xref="S1.F1.23.5.m5.1.1.cmml"><mi id="S1.F1.23.5.m5.1.1.2" xref="S1.F1.23.5.m5.1.1.2.cmml">A</mi><mn id="S1.F1.23.5.m5.1.1.3" xref="S1.F1.23.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.23.5.m5.1c"><apply id="S1.F1.23.5.m5.1.1.cmml" xref="S1.F1.23.5.m5.1.1"><csymbol cd="ambiguous" id="S1.F1.23.5.m5.1.1.1.cmml" xref="S1.F1.23.5.m5.1.1">subscript</csymbol><ci id="S1.F1.23.5.m5.1.1.2.cmml" xref="S1.F1.23.5.m5.1.1.2">𝐴</ci><cn id="S1.F1.23.5.m5.1.1.3.cmml" type="integer" xref="S1.F1.23.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.23.5.m5.1d">A_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.23.5.m5.1e">italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="T_{1}" class="ltx_Math" display="inline" id="S1.F1.24.6.m6.1"><semantics id="S1.F1.24.6.m6.1b"><msub id="S1.F1.24.6.m6.1.1" xref="S1.F1.24.6.m6.1.1.cmml"><mi id="S1.F1.24.6.m6.1.1.2" xref="S1.F1.24.6.m6.1.1.2.cmml">T</mi><mn id="S1.F1.24.6.m6.1.1.3" xref="S1.F1.24.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.24.6.m6.1c"><apply id="S1.F1.24.6.m6.1.1.cmml" xref="S1.F1.24.6.m6.1.1"><csymbol cd="ambiguous" id="S1.F1.24.6.m6.1.1.1.cmml" xref="S1.F1.24.6.m6.1.1">subscript</csymbol><ci id="S1.F1.24.6.m6.1.1.2.cmml" xref="S1.F1.24.6.m6.1.1.2">𝑇</ci><cn id="S1.F1.24.6.m6.1.1.3.cmml" type="integer" xref="S1.F1.24.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.24.6.m6.1d">T_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.24.6.m6.1e">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="T_{2}" class="ltx_Math" display="inline" id="S1.F1.25.7.m7.1"><semantics id="S1.F1.25.7.m7.1b"><msub id="S1.F1.25.7.m7.1.1" xref="S1.F1.25.7.m7.1.1.cmml"><mi id="S1.F1.25.7.m7.1.1.2" xref="S1.F1.25.7.m7.1.1.2.cmml">T</mi><mn id="S1.F1.25.7.m7.1.1.3" xref="S1.F1.25.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.25.7.m7.1c"><apply id="S1.F1.25.7.m7.1.1.cmml" xref="S1.F1.25.7.m7.1.1"><csymbol cd="ambiguous" id="S1.F1.25.7.m7.1.1.1.cmml" xref="S1.F1.25.7.m7.1.1">subscript</csymbol><ci id="S1.F1.25.7.m7.1.1.2.cmml" xref="S1.F1.25.7.m7.1.1.2">𝑇</ci><cn id="S1.F1.25.7.m7.1.1.3.cmml" type="integer" xref="S1.F1.25.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.25.7.m7.1d">T_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.25.7.m7.1e">italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{3}" class="ltx_Math" display="inline" id="S1.F1.26.8.m8.1"><semantics id="S1.F1.26.8.m8.1b"><msub id="S1.F1.26.8.m8.1.1" xref="S1.F1.26.8.m8.1.1.cmml"><mi id="S1.F1.26.8.m8.1.1.2" xref="S1.F1.26.8.m8.1.1.2.cmml">T</mi><mn id="S1.F1.26.8.m8.1.1.3" xref="S1.F1.26.8.m8.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.26.8.m8.1c"><apply id="S1.F1.26.8.m8.1.1.cmml" xref="S1.F1.26.8.m8.1.1"><csymbol cd="ambiguous" id="S1.F1.26.8.m8.1.1.1.cmml" xref="S1.F1.26.8.m8.1.1">subscript</csymbol><ci id="S1.F1.26.8.m8.1.1.2.cmml" xref="S1.F1.26.8.m8.1.1.2">𝑇</ci><cn id="S1.F1.26.8.m8.1.1.3.cmml" type="integer" xref="S1.F1.26.8.m8.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.26.8.m8.1d">T_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.26.8.m8.1e">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> be three different transformations, mapping domain <math alttext="\bm{X}" class="ltx_Math" display="inline" id="S1.F1.27.9.m9.1"><semantics id="S1.F1.27.9.m9.1b"><mi id="S1.F1.27.9.m9.1.1" xref="S1.F1.27.9.m9.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S1.F1.27.9.m9.1c"><ci id="S1.F1.27.9.m9.1.1.cmml" xref="S1.F1.27.9.m9.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.27.9.m9.1d">\bm{X}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.27.9.m9.1e">bold_italic_X</annotation></semantics></math> to <math alttext="\bm{Z}" class="ltx_Math" display="inline" id="S1.F1.28.10.m10.1"><semantics id="S1.F1.28.10.m10.1b"><mi id="S1.F1.28.10.m10.1.1" xref="S1.F1.28.10.m10.1.1.cmml">𝒁</mi><annotation-xml encoding="MathML-Content" id="S1.F1.28.10.m10.1c"><ci id="S1.F1.28.10.m10.1.1.cmml" xref="S1.F1.28.10.m10.1.1">𝒁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.28.10.m10.1d">\bm{Z}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.28.10.m10.1e">bold_italic_Z</annotation></semantics></math>, that only differ in how they map the subdomain <math alttext="\bm{X}^{(2)}" class="ltx_Math" display="inline" id="S1.F1.29.11.m11.1"><semantics id="S1.F1.29.11.m11.1b"><msup id="S1.F1.29.11.m11.1.2" xref="S1.F1.29.11.m11.1.2.cmml"><mi id="S1.F1.29.11.m11.1.2.2" xref="S1.F1.29.11.m11.1.2.2.cmml">𝑿</mi><mrow id="S1.F1.29.11.m11.1.1.1.3" xref="S1.F1.29.11.m11.1.2.cmml"><mo id="S1.F1.29.11.m11.1.1.1.3.1" stretchy="false" xref="S1.F1.29.11.m11.1.2.cmml">(</mo><mn id="S1.F1.29.11.m11.1.1.1.1" xref="S1.F1.29.11.m11.1.1.1.1.cmml">2</mn><mo id="S1.F1.29.11.m11.1.1.1.3.2" stretchy="false" xref="S1.F1.29.11.m11.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S1.F1.29.11.m11.1c"><apply id="S1.F1.29.11.m11.1.2.cmml" xref="S1.F1.29.11.m11.1.2"><csymbol cd="ambiguous" id="S1.F1.29.11.m11.1.2.1.cmml" xref="S1.F1.29.11.m11.1.2">superscript</csymbol><ci id="S1.F1.29.11.m11.1.2.2.cmml" xref="S1.F1.29.11.m11.1.2.2">𝑿</ci><cn id="S1.F1.29.11.m11.1.1.1.1.cmml" type="integer" xref="S1.F1.29.11.m11.1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.29.11.m11.1d">\bm{X}^{(2)}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.29.11.m11.1e">bold_italic_X start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="{\bm{Z}^{(2)}}^{\prime}" class="ltx_Math" display="inline" id="S1.F1.30.12.m12.1"><semantics id="S1.F1.30.12.m12.1b"><mmultiscripts id="S1.F1.30.12.m12.1.2" xref="S1.F1.30.12.m12.1.2.cmml"><mi id="S1.F1.30.12.m12.1.2.2.2" xref="S1.F1.30.12.m12.1.2.2.2.cmml">𝒁</mi><mrow id="S1.F1.30.12.m12.1.2b" xref="S1.F1.30.12.m12.1.2.cmml"></mrow><mrow id="S1.F1.30.12.m12.1.1.1.3" xref="S1.F1.30.12.m12.1.2.cmml"><mo id="S1.F1.30.12.m12.1.1.1.3.1" stretchy="false" xref="S1.F1.30.12.m12.1.2.cmml">(</mo><mn id="S1.F1.30.12.m12.1.1.1.1" xref="S1.F1.30.12.m12.1.1.1.1.cmml">2</mn><mo id="S1.F1.30.12.m12.1.1.1.3.2" stretchy="false" xref="S1.F1.30.12.m12.1.2.cmml">)</mo></mrow><mrow id="S1.F1.30.12.m12.1.2c" xref="S1.F1.30.12.m12.1.2.cmml"></mrow><mo id="S1.F1.30.12.m12.1.2.3" xref="S1.F1.30.12.m12.1.2.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S1.F1.30.12.m12.1c"><apply id="S1.F1.30.12.m12.1.2.cmml" xref="S1.F1.30.12.m12.1.2"><csymbol cd="ambiguous" id="S1.F1.30.12.m12.1.2.1.cmml" xref="S1.F1.30.12.m12.1.2">superscript</csymbol><apply id="S1.F1.30.12.m12.1.2.2.cmml" xref="S1.F1.30.12.m12.1.2"><csymbol cd="ambiguous" id="S1.F1.30.12.m12.1.2.2.1.cmml" xref="S1.F1.30.12.m12.1.2">superscript</csymbol><ci id="S1.F1.30.12.m12.1.2.2.2.cmml" xref="S1.F1.30.12.m12.1.2.2.2">𝒁</ci><cn id="S1.F1.30.12.m12.1.1.1.1.cmml" type="integer" xref="S1.F1.30.12.m12.1.1.1.1">2</cn></apply><ci id="S1.F1.30.12.m12.1.2.3.cmml" xref="S1.F1.30.12.m12.1.2.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.30.12.m12.1d">{\bm{Z}^{(2)}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.30.12.m12.1e">bold_italic_Z start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="{\bm{Z}^{(2)}}^{\prime\prime}" class="ltx_Math" display="inline" id="S1.F1.31.13.m13.1"><semantics id="S1.F1.31.13.m13.1b"><mmultiscripts id="S1.F1.31.13.m13.1.2" xref="S1.F1.31.13.m13.1.2.cmml"><mi id="S1.F1.31.13.m13.1.2.2.2" xref="S1.F1.31.13.m13.1.2.2.2.cmml">𝒁</mi><mrow id="S1.F1.31.13.m13.1.2b" xref="S1.F1.31.13.m13.1.2.cmml"></mrow><mrow id="S1.F1.31.13.m13.1.1.1.3" xref="S1.F1.31.13.m13.1.2.cmml"><mo id="S1.F1.31.13.m13.1.1.1.3.1" stretchy="false" xref="S1.F1.31.13.m13.1.2.cmml">(</mo><mn id="S1.F1.31.13.m13.1.1.1.1" xref="S1.F1.31.13.m13.1.1.1.1.cmml">2</mn><mo id="S1.F1.31.13.m13.1.1.1.3.2" stretchy="false" xref="S1.F1.31.13.m13.1.2.cmml">)</mo></mrow><mrow id="S1.F1.31.13.m13.1.2c" xref="S1.F1.31.13.m13.1.2.cmml"></mrow><mo id="S1.F1.31.13.m13.1.2.3" xref="S1.F1.31.13.m13.1.2.3.cmml">′′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S1.F1.31.13.m13.1c"><apply id="S1.F1.31.13.m13.1.2.cmml" xref="S1.F1.31.13.m13.1.2"><csymbol cd="ambiguous" id="S1.F1.31.13.m13.1.2.1.cmml" xref="S1.F1.31.13.m13.1.2">superscript</csymbol><apply id="S1.F1.31.13.m13.1.2.2.cmml" xref="S1.F1.31.13.m13.1.2"><csymbol cd="ambiguous" id="S1.F1.31.13.m13.1.2.2.1.cmml" xref="S1.F1.31.13.m13.1.2">superscript</csymbol><ci id="S1.F1.31.13.m13.1.2.2.2.cmml" xref="S1.F1.31.13.m13.1.2.2.2">𝒁</ci><cn id="S1.F1.31.13.m13.1.1.1.1.cmml" type="integer" xref="S1.F1.31.13.m13.1.1.1.1">2</cn></apply><ci id="S1.F1.31.13.m13.1.2.3.cmml" xref="S1.F1.31.13.m13.1.2.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.31.13.m13.1d">{\bm{Z}^{(2)}}^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.31.13.m13.1e">bold_italic_Z start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\bm{Z}^{(2)}}^{\prime\prime\prime}" class="ltx_Math" display="inline" id="S1.F1.32.14.m14.1"><semantics id="S1.F1.32.14.m14.1b"><mmultiscripts id="S1.F1.32.14.m14.1.2" xref="S1.F1.32.14.m14.1.2.cmml"><mi id="S1.F1.32.14.m14.1.2.2.2" xref="S1.F1.32.14.m14.1.2.2.2.cmml">𝒁</mi><mrow id="S1.F1.32.14.m14.1.2b" xref="S1.F1.32.14.m14.1.2.cmml"></mrow><mrow id="S1.F1.32.14.m14.1.1.1.3" xref="S1.F1.32.14.m14.1.2.cmml"><mo id="S1.F1.32.14.m14.1.1.1.3.1" stretchy="false" xref="S1.F1.32.14.m14.1.2.cmml">(</mo><mn id="S1.F1.32.14.m14.1.1.1.1" xref="S1.F1.32.14.m14.1.1.1.1.cmml">2</mn><mo id="S1.F1.32.14.m14.1.1.1.3.2" stretchy="false" xref="S1.F1.32.14.m14.1.2.cmml">)</mo></mrow><mrow id="S1.F1.32.14.m14.1.2c" xref="S1.F1.32.14.m14.1.2.cmml"></mrow><mo id="S1.F1.32.14.m14.1.2.3" xref="S1.F1.32.14.m14.1.2.3.cmml">′′′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S1.F1.32.14.m14.1c"><apply id="S1.F1.32.14.m14.1.2.cmml" xref="S1.F1.32.14.m14.1.2"><csymbol cd="ambiguous" id="S1.F1.32.14.m14.1.2.1.cmml" xref="S1.F1.32.14.m14.1.2">superscript</csymbol><apply id="S1.F1.32.14.m14.1.2.2.cmml" xref="S1.F1.32.14.m14.1.2"><csymbol cd="ambiguous" id="S1.F1.32.14.m14.1.2.2.1.cmml" xref="S1.F1.32.14.m14.1.2">superscript</csymbol><ci id="S1.F1.32.14.m14.1.2.2.2.cmml" xref="S1.F1.32.14.m14.1.2.2.2">𝒁</ci><cn id="S1.F1.32.14.m14.1.1.1.1.cmml" type="integer" xref="S1.F1.32.14.m14.1.1.1.1">2</cn></apply><ci id="S1.F1.32.14.m14.1.2.3.cmml" xref="S1.F1.32.14.m14.1.2.3">′′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.32.14.m14.1d">{\bm{Z}^{(2)}}^{\prime\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.32.14.m14.1e">bold_italic_Z start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT ′ ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> respectively – each equidistant from <math alttext="\bm{Z}_{2}" class="ltx_Math" display="inline" id="S1.F1.33.15.m15.1"><semantics id="S1.F1.33.15.m15.1b"><msub id="S1.F1.33.15.m15.1.1" xref="S1.F1.33.15.m15.1.1.cmml"><mi id="S1.F1.33.15.m15.1.1.2" xref="S1.F1.33.15.m15.1.1.2.cmml">𝒁</mi><mn id="S1.F1.33.15.m15.1.1.3" xref="S1.F1.33.15.m15.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.33.15.m15.1c"><apply id="S1.F1.33.15.m15.1.1.cmml" xref="S1.F1.33.15.m15.1.1"><csymbol cd="ambiguous" id="S1.F1.33.15.m15.1.1.1.cmml" xref="S1.F1.33.15.m15.1.1">subscript</csymbol><ci id="S1.F1.33.15.m15.1.1.2.cmml" xref="S1.F1.33.15.m15.1.1.2">𝒁</ci><cn id="S1.F1.33.15.m15.1.1.3.cmml" type="integer" xref="S1.F1.33.15.m15.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.33.15.m15.1d">\bm{Z}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.33.15.m15.1e">bold_italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Under the DM, all three transformations are treated as equivalent. In contrast, the task-oriented objectives regards <math alttext="T_{1}" class="ltx_Math" display="inline" id="S1.F1.34.16.m16.1"><semantics id="S1.F1.34.16.m16.1b"><msub id="S1.F1.34.16.m16.1.1" xref="S1.F1.34.16.m16.1.1.cmml"><mi id="S1.F1.34.16.m16.1.1.2" xref="S1.F1.34.16.m16.1.1.2.cmml">T</mi><mn id="S1.F1.34.16.m16.1.1.3" xref="S1.F1.34.16.m16.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.34.16.m16.1c"><apply id="S1.F1.34.16.m16.1.1.cmml" xref="S1.F1.34.16.m16.1.1"><csymbol cd="ambiguous" id="S1.F1.34.16.m16.1.1.1.cmml" xref="S1.F1.34.16.m16.1.1">subscript</csymbol><ci id="S1.F1.34.16.m16.1.1.2.cmml" xref="S1.F1.34.16.m16.1.1.2">𝑇</ci><cn id="S1.F1.34.16.m16.1.1.3.cmml" type="integer" xref="S1.F1.34.16.m16.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.34.16.m16.1d">T_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.34.16.m16.1e">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> as the least optimal, while considering <math alttext="T_{2}" class="ltx_Math" display="inline" id="S1.F1.35.17.m17.1"><semantics id="S1.F1.35.17.m17.1b"><msub id="S1.F1.35.17.m17.1.1" xref="S1.F1.35.17.m17.1.1.cmml"><mi id="S1.F1.35.17.m17.1.1.2" xref="S1.F1.35.17.m17.1.1.2.cmml">T</mi><mn id="S1.F1.35.17.m17.1.1.3" xref="S1.F1.35.17.m17.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.35.17.m17.1c"><apply id="S1.F1.35.17.m17.1.1.cmml" xref="S1.F1.35.17.m17.1.1"><csymbol cd="ambiguous" id="S1.F1.35.17.m17.1.1.1.cmml" xref="S1.F1.35.17.m17.1.1">subscript</csymbol><ci id="S1.F1.35.17.m17.1.1.2.cmml" xref="S1.F1.35.17.m17.1.1.2">𝑇</ci><cn id="S1.F1.35.17.m17.1.1.3.cmml" type="integer" xref="S1.F1.35.17.m17.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.35.17.m17.1d">T_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.35.17.m17.1e">italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{3}" class="ltx_Math" display="inline" id="S1.F1.36.18.m18.1"><semantics id="S1.F1.36.18.m18.1b"><msub id="S1.F1.36.18.m18.1.1" xref="S1.F1.36.18.m18.1.1.cmml"><mi id="S1.F1.36.18.m18.1.1.2" xref="S1.F1.36.18.m18.1.1.2.cmml">T</mi><mn id="S1.F1.36.18.m18.1.1.3" xref="S1.F1.36.18.m18.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.36.18.m18.1c"><apply id="S1.F1.36.18.m18.1.1.cmml" xref="S1.F1.36.18.m18.1.1"><csymbol cd="ambiguous" id="S1.F1.36.18.m18.1.1.1.cmml" xref="S1.F1.36.18.m18.1.1">subscript</csymbol><ci id="S1.F1.36.18.m18.1.1.2.cmml" xref="S1.F1.36.18.m18.1.1.2">𝑇</ci><cn id="S1.F1.36.18.m18.1.1.3.cmml" type="integer" xref="S1.F1.36.18.m18.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.36.18.m18.1d">T_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.36.18.m18.1e">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> equally performant, since they both preserve the input–output relationship of the composition.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A plethora of representational similarity metrics have been proposed such as projection weighted Canonical Correlation Analysis (PWCCA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib33" title="">33</a>]</cite>, Singular Vector Canonical Correlation Analysis (SVCCA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib33" title="">33</a>]</cite> and the wide-spread Centered Kernel Alignment (CKA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib23" title="">23</a>]</cite>. These structure-based metrics measure correlation between geometric structures in activation spaces of independently trained models given the same data. Although they have been frequently used in the literature to extract relevant insights such as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib36" title="">36</a>]</cite>, they have also been criticized for overestimating similarity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib21" title="">21</a>]</cite> due to spurious feature correlations, as well as for being agnostic to the functional behavior <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib10" title="">10</a>]</cite> and invariance properties <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib35" title="">35</a>]</cite> of the model.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Model stitching <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite> is a prominent paradigm for evaluating the functional similarity of neural networks. In contrast to the structure-based metrics, the similarity is grounded on whether the representations of one model can be linearly aligned to those of another one in such a way that a functional property of interest (e.g., accuracy) is maintained. In practice, this is realized by freezing the two halves of these neural networks and connecting them by a trainable affine transformation which is responsible for aligning the models.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Although less popular than the structure-based metrics, model stitching has been used to draw insights <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite>, such as demonstrating that non-robust and robust models are functionally similar with respect to clean accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite>. However, recent works questioned the reliability of model stitching under the commonly used setting - task loss matching (TLM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib40" title="">40</a>]</cite>. In response to that, direct matching (DM), linearly connecting neural networks by minimizing the representation distance at the stitching level - was advocated as a more reliable alternative for evaluating similarity.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this work, we take a fresh look at model stitching and argue that a reliable functional similarity metric should reflect the degree of functional comparability between two models trained under different settings, where trivial solutions may not exist (e.g., different datasets and/or different training recipes). In this context, the affine transformation used for representation alignment should
both (i) effectively propagate functionally relevant information and (ii) avoid compensating for functional discrepancies between the models.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.2">Based on these two criteria, we hypothesize that the DM is at risk of violating (i) as it does not account for the functional nuances of the layers following the stitching (e.g., <math alttext="T_{1}" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><msub id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml"><mi id="S1.p6.1.m1.1.1.2" xref="S1.p6.1.m1.1.1.2.cmml">T</mi><mn id="S1.p6.1.m1.1.1.3" xref="S1.p6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p6.1.m1.1.1.1.cmml" xref="S1.p6.1.m1.1.1">subscript</csymbol><ci id="S1.p6.1.m1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.2">𝑇</ci><cn id="S1.p6.1.m1.1.1.3.cmml" type="integer" xref="S1.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">T_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> transformation in Fig <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>). Conversely, the TLM might fail in regards to (ii) by exploiting irregularities in the decision process of the model to achieve optimal task performance (e.g., <math alttext="T_{3}" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><msub id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml"><mi id="S1.p6.2.m2.1.1.2" xref="S1.p6.2.m2.1.1.2.cmml">T</mi><mn id="S1.p6.2.m2.1.1.3" xref="S1.p6.2.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><apply id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p6.2.m2.1.1.1.cmml" xref="S1.p6.2.m2.1.1">subscript</csymbol><ci id="S1.p6.2.m2.1.1.2.cmml" xref="S1.p6.2.m2.1.1.2">𝑇</ci><cn id="S1.p6.2.m2.1.1.3.cmml" type="integer" xref="S1.p6.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">T_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> transformation in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Towards developing model stitching that better fits the needs of functional similarity evaluation, we draw inspiration from the work conducted by <cite class="ltx_cite ltx_citemacro_citet">Liu et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib27" title="">27</a>]</cite> in which the notion of function-consistency was employed for Knowledge Distillation (KD). We propose model stitching by Functional Latent Alignment (FuLA) as a novel setting for functional similarity evaluation in which the affine transformation minimizes not only the feature representations at the stitching level (i.e., DM) but also at the layers following it (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.F2" title="Figure 2 ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">2</span></a>). Given that the alignment transformation is the only trainable layer in model stitching, functional consistency can be achieved by simply aligning the latent feature representations. Additionally, under FuLA only the representations between the stitching and the penultimate layer are aligned, that is, ignoring the output level cues. The motivation behind this choice was to avoid exploiting irregularities in the decision boundary through leakage of task-specific information during the alignment. Concretely our contributions are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose FuLA as a novel setting for model stitching under which function-consistent alignment is realized to infer the functional similarity of two neural networks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We show that task-based stitching can fabricate alignment by overfitting on the task.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Through targeted experiments, we demonstrate that FuLA is less prone to these pitfalls and captures non-trivial alignments missed by direct matching, making it a more reliable metric for functional similarity.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Model Stitching</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="394" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">The proposed model stitching by FuLA in relation to other model stitching settings. In the example of the figure, stitching is performed at the second layers between identical architectures.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we introduce the notation and provide an overview of the components that form the basis of our experimental setup, finally we introduce FuLA as a model stitching setting.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Notation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.12">We follow the notation used by <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite>. Let <math alttext="f_{w}:\mathcal{X}\to\mathcal{Y}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><msub id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2.2" xref="S2.SS1.p1.1.m1.1.1.2.2.cmml">f</mi><mi id="S2.SS1.p1.1.m1.1.1.2.3" xref="S2.SS1.p1.1.m1.1.1.2.3.cmml">w</mi></msub><mo id="S2.SS1.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">𝒳</mi><mo id="S2.SS1.p1.1.m1.1.1.3.1" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><ci id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1">:</ci><apply id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2.2">𝑓</ci><ci id="S2.SS1.p1.1.m1.1.1.2.3.cmml" xref="S2.SS1.p1.1.m1.1.1.2.3">𝑤</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><ci id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.1">→</ci><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">𝒳</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">f_{w}:\mathcal{X}\to\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT : caligraphic_X → caligraphic_Y</annotation></semantics></math> be a feedforward neural network with <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_m</annotation></semantics></math> layers, parameterized by <math alttext="w" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_w</annotation></semantics></math> and realized as the composition <math alttext="f=f_{m}\circ\cdots\circ f_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">f</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml"><msub id="S2.SS1.p1.4.m4.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.3.2.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3.2.2" xref="S2.SS1.p1.4.m4.1.1.3.2.2.cmml">f</mi><mi id="S2.SS1.p1.4.m4.1.1.3.2.3" xref="S2.SS1.p1.4.m4.1.1.3.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.4.m4.1.1.3.1.cmml">∘</mo><mi id="S2.SS1.p1.4.m4.1.1.3.3" mathvariant="normal" xref="S2.SS1.p1.4.m4.1.1.3.3.cmml">⋯</mi><mo id="S2.SS1.p1.4.m4.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.4.m4.1.1.3.1.cmml">∘</mo><msub id="S2.SS1.p1.4.m4.1.1.3.4" xref="S2.SS1.p1.4.m4.1.1.3.4.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3.4.2" xref="S2.SS1.p1.4.m4.1.1.3.4.2.cmml">f</mi><mn id="S2.SS1.p1.4.m4.1.1.3.4.3" xref="S2.SS1.p1.4.m4.1.1.3.4.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><eq id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></eq><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑓</ci><apply id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3"><compose id="S2.SS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3.1"></compose><apply id="S2.SS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.3.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.3.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2.2">𝑓</ci><ci id="S2.SS1.p1.4.m4.1.1.3.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2.3">𝑚</ci></apply><ci id="S2.SS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3.3">⋯</ci><apply id="S2.SS1.p1.4.m4.1.1.3.4.cmml" xref="S2.SS1.p1.4.m4.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.3.4.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3.4">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.3.4.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.4.2">𝑓</ci><cn id="S2.SS1.p1.4.m4.1.1.3.4.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.3.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">f=f_{m}\circ\cdots\circ f_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_f = italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∘ ⋯ ∘ italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, where each <math alttext="f_{i}:\mathcal{A}_{f,i-1}\to\mathcal{A}_{f,i}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.4"><semantics id="S2.SS1.p1.5.m5.4a"><mrow id="S2.SS1.p1.5.m5.4.5" xref="S2.SS1.p1.5.m5.4.5.cmml"><msub id="S2.SS1.p1.5.m5.4.5.2" xref="S2.SS1.p1.5.m5.4.5.2.cmml"><mi id="S2.SS1.p1.5.m5.4.5.2.2" xref="S2.SS1.p1.5.m5.4.5.2.2.cmml">f</mi><mi id="S2.SS1.p1.5.m5.4.5.2.3" xref="S2.SS1.p1.5.m5.4.5.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.5.m5.4.5.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p1.5.m5.4.5.1.cmml">:</mo><mrow id="S2.SS1.p1.5.m5.4.5.3" xref="S2.SS1.p1.5.m5.4.5.3.cmml"><msub id="S2.SS1.p1.5.m5.4.5.3.2" xref="S2.SS1.p1.5.m5.4.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.4.5.3.2.2" xref="S2.SS1.p1.5.m5.4.5.3.2.2.cmml">𝒜</mi><mrow id="S2.SS1.p1.5.m5.2.2.2.2" xref="S2.SS1.p1.5.m5.2.2.2.3.cmml"><mi id="S2.SS1.p1.5.m5.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.cmml">f</mi><mo id="S2.SS1.p1.5.m5.2.2.2.2.2" xref="S2.SS1.p1.5.m5.2.2.2.3.cmml">,</mo><mrow id="S2.SS1.p1.5.m5.2.2.2.2.1" xref="S2.SS1.p1.5.m5.2.2.2.2.1.cmml"><mi id="S2.SS1.p1.5.m5.2.2.2.2.1.2" xref="S2.SS1.p1.5.m5.2.2.2.2.1.2.cmml">i</mi><mo id="S2.SS1.p1.5.m5.2.2.2.2.1.1" xref="S2.SS1.p1.5.m5.2.2.2.2.1.1.cmml">−</mo><mn id="S2.SS1.p1.5.m5.2.2.2.2.1.3" xref="S2.SS1.p1.5.m5.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.SS1.p1.5.m5.4.5.3.1" stretchy="false" xref="S2.SS1.p1.5.m5.4.5.3.1.cmml">→</mo><msub id="S2.SS1.p1.5.m5.4.5.3.3" xref="S2.SS1.p1.5.m5.4.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.4.5.3.3.2" xref="S2.SS1.p1.5.m5.4.5.3.3.2.cmml">𝒜</mi><mrow id="S2.SS1.p1.5.m5.4.4.2.4" xref="S2.SS1.p1.5.m5.4.4.2.3.cmml"><mi id="S2.SS1.p1.5.m5.3.3.1.1" xref="S2.SS1.p1.5.m5.3.3.1.1.cmml">f</mi><mo id="S2.SS1.p1.5.m5.4.4.2.4.1" xref="S2.SS1.p1.5.m5.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p1.5.m5.4.4.2.2" xref="S2.SS1.p1.5.m5.4.4.2.2.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.4b"><apply id="S2.SS1.p1.5.m5.4.5.cmml" xref="S2.SS1.p1.5.m5.4.5"><ci id="S2.SS1.p1.5.m5.4.5.1.cmml" xref="S2.SS1.p1.5.m5.4.5.1">:</ci><apply id="S2.SS1.p1.5.m5.4.5.2.cmml" xref="S2.SS1.p1.5.m5.4.5.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.5.2.1.cmml" xref="S2.SS1.p1.5.m5.4.5.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.5.2.2.cmml" xref="S2.SS1.p1.5.m5.4.5.2.2">𝑓</ci><ci id="S2.SS1.p1.5.m5.4.5.2.3.cmml" xref="S2.SS1.p1.5.m5.4.5.2.3">𝑖</ci></apply><apply id="S2.SS1.p1.5.m5.4.5.3.cmml" xref="S2.SS1.p1.5.m5.4.5.3"><ci id="S2.SS1.p1.5.m5.4.5.3.1.cmml" xref="S2.SS1.p1.5.m5.4.5.3.1">→</ci><apply id="S2.SS1.p1.5.m5.4.5.3.2.cmml" xref="S2.SS1.p1.5.m5.4.5.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.5.3.2.1.cmml" xref="S2.SS1.p1.5.m5.4.5.3.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.5.3.2.2.cmml" xref="S2.SS1.p1.5.m5.4.5.3.2.2">𝒜</ci><list id="S2.SS1.p1.5.m5.2.2.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.2.2"><ci id="S2.SS1.p1.5.m5.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1">𝑓</ci><apply id="S2.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.2.2.1"><minus id="S2.SS1.p1.5.m5.2.2.2.2.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.2.2.1.1"></minus><ci id="S2.SS1.p1.5.m5.2.2.2.2.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.2.2.1.2">𝑖</ci><cn id="S2.SS1.p1.5.m5.2.2.2.2.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S2.SS1.p1.5.m5.4.5.3.3.cmml" xref="S2.SS1.p1.5.m5.4.5.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.5.3.3.1.cmml" xref="S2.SS1.p1.5.m5.4.5.3.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.5.3.3.2.cmml" xref="S2.SS1.p1.5.m5.4.5.3.3.2">𝒜</ci><list id="S2.SS1.p1.5.m5.4.4.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.2.4"><ci id="S2.SS1.p1.5.m5.3.3.1.1.cmml" xref="S2.SS1.p1.5.m5.3.3.1.1">𝑓</ci><ci id="S2.SS1.p1.5.m5.4.4.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.2.2">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.4c">f_{i}:\mathcal{A}_{f,i-1}\to\mathcal{A}_{f,i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.4d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : caligraphic_A start_POSTSUBSCRIPT italic_f , italic_i - 1 end_POSTSUBSCRIPT → caligraphic_A start_POSTSUBSCRIPT italic_f , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> maps the activation space of the <math alttext="(i\!-\!1)^{\text{th}}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msup id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mrow id="S2.SS1.p1.6.m6.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.6.m6.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml">i</mi><mo id="S2.SS1.p1.6.m6.1.1.1.1.1.1" lspace="0.052em" rspace="0.052em" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml">−</mo><mn id="S2.SS1.p1.6.m6.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow><mtext id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1"><minus id="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1"></minus><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2">𝑖</ci><cn id="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.6.m6.1.1.3a.cmml" xref="S2.SS1.p1.6.m6.1.1.3"><mtext id="S2.SS1.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p1.6.m6.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">(i\!-\!1)^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">( italic_i - 1 ) start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> to that of the <math alttext="i^{\text{th}}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><msup id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">i</mi><mtext id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝑖</ci><ci id="S2.SS1.p1.7.m7.1.1.3a.cmml" xref="S2.SS1.p1.7.m7.1.1.3"><mtext id="S2.SS1.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p1.7.m7.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">i^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_i start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="\mathcal{A}_{f,0}=\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.2"><semantics id="S2.SS1.p1.8.m8.2a"><mrow id="S2.SS1.p1.8.m8.2.3" xref="S2.SS1.p1.8.m8.2.3.cmml"><msub id="S2.SS1.p1.8.m8.2.3.2" xref="S2.SS1.p1.8.m8.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.2.3.2.2" xref="S2.SS1.p1.8.m8.2.3.2.2.cmml">𝒜</mi><mrow id="S2.SS1.p1.8.m8.2.2.2.4" xref="S2.SS1.p1.8.m8.2.2.2.3.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.cmml">f</mi><mo id="S2.SS1.p1.8.m8.2.2.2.4.1" xref="S2.SS1.p1.8.m8.2.2.2.3.cmml">,</mo><mn id="S2.SS1.p1.8.m8.2.2.2.2" xref="S2.SS1.p1.8.m8.2.2.2.2.cmml">0</mn></mrow></msub><mo id="S2.SS1.p1.8.m8.2.3.1" xref="S2.SS1.p1.8.m8.2.3.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.2.3.3" xref="S2.SS1.p1.8.m8.2.3.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.2b"><apply id="S2.SS1.p1.8.m8.2.3.cmml" xref="S2.SS1.p1.8.m8.2.3"><eq id="S2.SS1.p1.8.m8.2.3.1.cmml" xref="S2.SS1.p1.8.m8.2.3.1"></eq><apply id="S2.SS1.p1.8.m8.2.3.2.cmml" xref="S2.SS1.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.2.3.2.1.cmml" xref="S2.SS1.p1.8.m8.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.2.3.2.2.cmml" xref="S2.SS1.p1.8.m8.2.3.2.2">𝒜</ci><list id="S2.SS1.p1.8.m8.2.2.2.3.cmml" xref="S2.SS1.p1.8.m8.2.2.2.4"><ci id="S2.SS1.p1.8.m8.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1">𝑓</ci><cn id="S2.SS1.p1.8.m8.2.2.2.2.cmml" type="integer" xref="S2.SS1.p1.8.m8.2.2.2.2">0</cn></list></apply><ci id="S2.SS1.p1.8.m8.2.3.3.cmml" xref="S2.SS1.p1.8.m8.2.3.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.2c">\mathcal{A}_{f,0}=\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.2d">caligraphic_A start_POSTSUBSCRIPT italic_f , 0 end_POSTSUBSCRIPT = caligraphic_X</annotation></semantics></math>. For notational simplicity, we omit the explicit dependence on <math alttext="w" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_w</annotation></semantics></math> when clear from context. We define the partial compositions <math alttext="f_{&gt;i}=f_{m}\circ\cdots f_{i+1}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><msub id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2.2" xref="S2.SS1.p1.10.m10.1.1.2.2.cmml">f</mi><mrow id="S2.SS1.p1.10.m10.1.1.2.3" xref="S2.SS1.p1.10.m10.1.1.2.3.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2.3.2" xref="S2.SS1.p1.10.m10.1.1.2.3.2.cmml"></mi><mo id="S2.SS1.p1.10.m10.1.1.2.3.1" xref="S2.SS1.p1.10.m10.1.1.2.3.1.cmml">&gt;</mo><mi id="S2.SS1.p1.10.m10.1.1.2.3.3" xref="S2.SS1.p1.10.m10.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS1.p1.10.m10.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml"><mrow id="S2.SS1.p1.10.m10.1.1.3.2" xref="S2.SS1.p1.10.m10.1.1.3.2.cmml"><msub id="S2.SS1.p1.10.m10.1.1.3.2.2" xref="S2.SS1.p1.10.m10.1.1.3.2.2.cmml"><mi id="S2.SS1.p1.10.m10.1.1.3.2.2.2" xref="S2.SS1.p1.10.m10.1.1.3.2.2.2.cmml">f</mi><mi id="S2.SS1.p1.10.m10.1.1.3.2.2.3" xref="S2.SS1.p1.10.m10.1.1.3.2.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.10.m10.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.10.m10.1.1.3.2.1.cmml">∘</mo><mi id="S2.SS1.p1.10.m10.1.1.3.2.3" mathvariant="normal" xref="S2.SS1.p1.10.m10.1.1.3.2.3.cmml">⋯</mi></mrow><mo id="S2.SS1.p1.10.m10.1.1.3.1" xref="S2.SS1.p1.10.m10.1.1.3.1.cmml">⁢</mo><msub id="S2.SS1.p1.10.m10.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.3.3.cmml"><mi id="S2.SS1.p1.10.m10.1.1.3.3.2" xref="S2.SS1.p1.10.m10.1.1.3.3.2.cmml">f</mi><mrow id="S2.SS1.p1.10.m10.1.1.3.3.3" xref="S2.SS1.p1.10.m10.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.10.m10.1.1.3.3.3.2" xref="S2.SS1.p1.10.m10.1.1.3.3.3.2.cmml">i</mi><mo id="S2.SS1.p1.10.m10.1.1.3.3.3.1" xref="S2.SS1.p1.10.m10.1.1.3.3.3.1.cmml">+</mo><mn id="S2.SS1.p1.10.m10.1.1.3.3.3.3" xref="S2.SS1.p1.10.m10.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><eq id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1"></eq><apply id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2.2">𝑓</ci><apply id="S2.SS1.p1.10.m10.1.1.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3"><gt id="S2.SS1.p1.10.m10.1.1.2.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3.1"></gt><csymbol cd="latexml" id="S2.SS1.p1.10.m10.1.1.2.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3.2">absent</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3"><times id="S2.SS1.p1.10.m10.1.1.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3.1"></times><apply id="S2.SS1.p1.10.m10.1.1.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2"><compose id="S2.SS1.p1.10.m10.1.1.3.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.1"></compose><apply id="S2.SS1.p1.10.m10.1.1.3.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.3.2.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.3.2.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.2.2">𝑓</ci><ci id="S2.SS1.p1.10.m10.1.1.3.2.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.2.3">𝑚</ci></apply><ci id="S2.SS1.p1.10.m10.1.1.3.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2.3">⋯</ci></apply><apply id="S2.SS1.p1.10.m10.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.3.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.3.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3.2">𝑓</ci><apply id="S2.SS1.p1.10.m10.1.1.3.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3.3"><plus id="S2.SS1.p1.10.m10.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3.3.1"></plus><ci id="S2.SS1.p1.10.m10.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3.3.2">𝑖</ci><cn id="S2.SS1.p1.10.m10.1.1.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.10.m10.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">f_{&gt;i}=f_{m}\circ\cdots f_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">italic_f start_POSTSUBSCRIPT &gt; italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∘ ⋯ italic_f start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\leq i}=f_{i}\circ\cdots f_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mrow id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><msub id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2.2" xref="S2.SS1.p1.11.m11.1.1.2.2.cmml">f</mi><mrow id="S2.SS1.p1.11.m11.1.1.2.3" xref="S2.SS1.p1.11.m11.1.1.2.3.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2.3.2" xref="S2.SS1.p1.11.m11.1.1.2.3.2.cmml"></mi><mo id="S2.SS1.p1.11.m11.1.1.2.3.1" xref="S2.SS1.p1.11.m11.1.1.2.3.1.cmml">≤</mo><mi id="S2.SS1.p1.11.m11.1.1.2.3.3" xref="S2.SS1.p1.11.m11.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS1.p1.11.m11.1.1.1" xref="S2.SS1.p1.11.m11.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml"><mrow id="S2.SS1.p1.11.m11.1.1.3.2" xref="S2.SS1.p1.11.m11.1.1.3.2.cmml"><msub id="S2.SS1.p1.11.m11.1.1.3.2.2" xref="S2.SS1.p1.11.m11.1.1.3.2.2.cmml"><mi id="S2.SS1.p1.11.m11.1.1.3.2.2.2" xref="S2.SS1.p1.11.m11.1.1.3.2.2.2.cmml">f</mi><mi id="S2.SS1.p1.11.m11.1.1.3.2.2.3" xref="S2.SS1.p1.11.m11.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.11.m11.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.11.m11.1.1.3.2.1.cmml">∘</mo><mi id="S2.SS1.p1.11.m11.1.1.3.2.3" mathvariant="normal" xref="S2.SS1.p1.11.m11.1.1.3.2.3.cmml">⋯</mi></mrow><mo id="S2.SS1.p1.11.m11.1.1.3.1" xref="S2.SS1.p1.11.m11.1.1.3.1.cmml">⁢</mo><msub id="S2.SS1.p1.11.m11.1.1.3.3" xref="S2.SS1.p1.11.m11.1.1.3.3.cmml"><mi id="S2.SS1.p1.11.m11.1.1.3.3.2" xref="S2.SS1.p1.11.m11.1.1.3.3.2.cmml">f</mi><mn id="S2.SS1.p1.11.m11.1.1.3.3.3" xref="S2.SS1.p1.11.m11.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><eq id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1"></eq><apply id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2.2">𝑓</ci><apply id="S2.SS1.p1.11.m11.1.1.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3"><leq id="S2.SS1.p1.11.m11.1.1.2.3.1.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3.1"></leq><csymbol cd="latexml" id="S2.SS1.p1.11.m11.1.1.2.3.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3.2">absent</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.3.3.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3"><times id="S2.SS1.p1.11.m11.1.1.3.1.cmml" xref="S2.SS1.p1.11.m11.1.1.3.1"></times><apply id="S2.SS1.p1.11.m11.1.1.3.2.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2"><compose id="S2.SS1.p1.11.m11.1.1.3.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.1"></compose><apply id="S2.SS1.p1.11.m11.1.1.3.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.3.2.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.3.2.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.2.2">𝑓</ci><ci id="S2.SS1.p1.11.m11.1.1.3.2.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.11.m11.1.1.3.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3.2.3">⋯</ci></apply><apply id="S2.SS1.p1.11.m11.1.1.3.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.3.3.1.cmml" xref="S2.SS1.p1.11.m11.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.3.3.2.cmml" xref="S2.SS1.p1.11.m11.1.1.3.3.2">𝑓</ci><cn id="S2.SS1.p1.11.m11.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p1.11.m11.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">f_{\leq i}=f_{i}\circ\cdots f_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∘ ⋯ italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="f=f_{&gt;i}\circ f_{\leq i}" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml">f</mi><mo id="S2.SS1.p1.12.m12.1.1.1" xref="S2.SS1.p1.12.m12.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml"><msub id="S2.SS1.p1.12.m12.1.1.3.2" xref="S2.SS1.p1.12.m12.1.1.3.2.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.2.2" xref="S2.SS1.p1.12.m12.1.1.3.2.2.cmml">f</mi><mrow id="S2.SS1.p1.12.m12.1.1.3.2.3" xref="S2.SS1.p1.12.m12.1.1.3.2.3.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.2.3.2" xref="S2.SS1.p1.12.m12.1.1.3.2.3.2.cmml"></mi><mo id="S2.SS1.p1.12.m12.1.1.3.2.3.1" xref="S2.SS1.p1.12.m12.1.1.3.2.3.1.cmml">&gt;</mo><mi id="S2.SS1.p1.12.m12.1.1.3.2.3.3" xref="S2.SS1.p1.12.m12.1.1.3.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS1.p1.12.m12.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.12.m12.1.1.3.1.cmml">∘</mo><msub id="S2.SS1.p1.12.m12.1.1.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.3.2" xref="S2.SS1.p1.12.m12.1.1.3.3.2.cmml">f</mi><mrow id="S2.SS1.p1.12.m12.1.1.3.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.3.3.2" xref="S2.SS1.p1.12.m12.1.1.3.3.3.2.cmml"></mi><mo id="S2.SS1.p1.12.m12.1.1.3.3.3.1" xref="S2.SS1.p1.12.m12.1.1.3.3.3.1.cmml">≤</mo><mi id="S2.SS1.p1.12.m12.1.1.3.3.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><eq id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1.1"></eq><ci id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2">𝑓</ci><apply id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3"><compose id="S2.SS1.p1.12.m12.1.1.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.1"></compose><apply id="S2.SS1.p1.12.m12.1.1.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.3.2.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.2.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2.2">𝑓</ci><apply id="S2.SS1.p1.12.m12.1.1.3.2.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2.3"><gt id="S2.SS1.p1.12.m12.1.1.3.2.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2.3.1"></gt><csymbol cd="latexml" id="S2.SS1.p1.12.m12.1.1.3.2.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2.3.2">absent</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.2.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p1.12.m12.1.1.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.3.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3.2">𝑓</ci><apply id="S2.SS1.p1.12.m12.1.1.3.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3.3"><leq id="S2.SS1.p1.12.m12.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3.3.1"></leq><csymbol cd="latexml" id="S2.SS1.p1.12.m12.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3.3.2">absent</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.3.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">f=f_{&gt;i}\circ f_{\leq i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">italic_f = italic_f start_POSTSUBSCRIPT &gt; italic_i end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.22">Given two neural networks <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_f</annotation></semantics></math> and <math alttext="g" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_g</annotation></semantics></math> with <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_m</annotation></semantics></math> and <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_k</annotation></semantics></math> layers, respectively, model stitching aims to quantify the extent to which <math alttext="g_{&gt;j}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><msub id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">g</mi><mrow id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml"><mi id="S2.SS1.p2.5.m5.1.1.3.2" xref="S2.SS1.p2.5.m5.1.1.3.2.cmml"></mi><mo id="S2.SS1.p2.5.m5.1.1.3.1" xref="S2.SS1.p2.5.m5.1.1.3.1.cmml">&gt;</mo><mi id="S2.SS1.p2.5.m5.1.1.3.3" xref="S2.SS1.p2.5.m5.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">𝑔</ci><apply id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3"><gt id="S2.SS1.p2.5.m5.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.1.1.3.1"></gt><csymbol cd="latexml" id="S2.SS1.p2.5.m5.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.1.1.3.2">absent</csymbol><ci id="S2.SS1.p2.5.m5.1.1.3.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">g_{&gt;j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can replicate the functionality of <math alttext="g" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><mi id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_g</annotation></semantics></math> when given as input the <math alttext="\mathcal{A}_{f,i}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.2"><semantics id="S2.SS1.p2.7.m7.2a"><msub id="S2.SS1.p2.7.m7.2.3" xref="S2.SS1.p2.7.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.7.m7.2.3.2" xref="S2.SS1.p2.7.m7.2.3.2.cmml">𝒜</mi><mrow id="S2.SS1.p2.7.m7.2.2.2.4" xref="S2.SS1.p2.7.m7.2.2.2.3.cmml"><mi id="S2.SS1.p2.7.m7.1.1.1.1" xref="S2.SS1.p2.7.m7.1.1.1.1.cmml">f</mi><mo id="S2.SS1.p2.7.m7.2.2.2.4.1" xref="S2.SS1.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p2.7.m7.2.2.2.2" xref="S2.SS1.p2.7.m7.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.2b"><apply id="S2.SS1.p2.7.m7.2.3.cmml" xref="S2.SS1.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.2.3.1.cmml" xref="S2.SS1.p2.7.m7.2.3">subscript</csymbol><ci id="S2.SS1.p2.7.m7.2.3.2.cmml" xref="S2.SS1.p2.7.m7.2.3.2">𝒜</ci><list id="S2.SS1.p2.7.m7.2.2.2.3.cmml" xref="S2.SS1.p2.7.m7.2.2.2.4"><ci id="S2.SS1.p2.7.m7.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1.1.1">𝑓</ci><ci id="S2.SS1.p2.7.m7.2.2.2.2.cmml" xref="S2.SS1.p2.7.m7.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.2c">\mathcal{A}_{f,i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.2d">caligraphic_A start_POSTSUBSCRIPT italic_f , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="i\in[m]" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><mrow id="S2.SS1.p2.8.m8.1.2" xref="S2.SS1.p2.8.m8.1.2.cmml"><mi id="S2.SS1.p2.8.m8.1.2.2" xref="S2.SS1.p2.8.m8.1.2.2.cmml">i</mi><mo id="S2.SS1.p2.8.m8.1.2.1" xref="S2.SS1.p2.8.m8.1.2.1.cmml">∈</mo><mrow id="S2.SS1.p2.8.m8.1.2.3.2" xref="S2.SS1.p2.8.m8.1.2.3.1.cmml"><mo id="S2.SS1.p2.8.m8.1.2.3.2.1" stretchy="false" xref="S2.SS1.p2.8.m8.1.2.3.1.1.cmml">[</mo><mi id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml">m</mi><mo id="S2.SS1.p2.8.m8.1.2.3.2.2" stretchy="false" xref="S2.SS1.p2.8.m8.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.2.cmml" xref="S2.SS1.p2.8.m8.1.2"><in id="S2.SS1.p2.8.m8.1.2.1.cmml" xref="S2.SS1.p2.8.m8.1.2.1"></in><ci id="S2.SS1.p2.8.m8.1.2.2.cmml" xref="S2.SS1.p2.8.m8.1.2.2">𝑖</ci><apply id="S2.SS1.p2.8.m8.1.2.3.1.cmml" xref="S2.SS1.p2.8.m8.1.2.3.2"><csymbol cd="latexml" id="S2.SS1.p2.8.m8.1.2.3.1.1.cmml" xref="S2.SS1.p2.8.m8.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">i\in[m]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">italic_i ∈ [ italic_m ]</annotation></semantics></math> and <math alttext="j\in[k]" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m9.1"><semantics id="S2.SS1.p2.9.m9.1a"><mrow id="S2.SS1.p2.9.m9.1.2" xref="S2.SS1.p2.9.m9.1.2.cmml"><mi id="S2.SS1.p2.9.m9.1.2.2" xref="S2.SS1.p2.9.m9.1.2.2.cmml">j</mi><mo id="S2.SS1.p2.9.m9.1.2.1" xref="S2.SS1.p2.9.m9.1.2.1.cmml">∈</mo><mrow id="S2.SS1.p2.9.m9.1.2.3.2" xref="S2.SS1.p2.9.m9.1.2.3.1.cmml"><mo id="S2.SS1.p2.9.m9.1.2.3.2.1" stretchy="false" xref="S2.SS1.p2.9.m9.1.2.3.1.1.cmml">[</mo><mi id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml">k</mi><mo id="S2.SS1.p2.9.m9.1.2.3.2.2" stretchy="false" xref="S2.SS1.p2.9.m9.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.2.cmml" xref="S2.SS1.p2.9.m9.1.2"><in id="S2.SS1.p2.9.m9.1.2.1.cmml" xref="S2.SS1.p2.9.m9.1.2.1"></in><ci id="S2.SS1.p2.9.m9.1.2.2.cmml" xref="S2.SS1.p2.9.m9.1.2.2">𝑗</ci><apply id="S2.SS1.p2.9.m9.1.2.3.1.cmml" xref="S2.SS1.p2.9.m9.1.2.3.2"><csymbol cd="latexml" id="S2.SS1.p2.9.m9.1.2.3.1.1.cmml" xref="S2.SS1.p2.9.m9.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">j\in[k]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m9.1d">italic_j ∈ [ italic_k ]</annotation></semantics></math>. Formally, the stitched model is constructed as <math alttext="h=g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m10.1"><semantics id="S2.SS1.p2.10.m10.1a"><mrow id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2" xref="S2.SS1.p2.10.m10.1.1.2.cmml">h</mi><mo id="S2.SS1.p2.10.m10.1.1.1" xref="S2.SS1.p2.10.m10.1.1.1.cmml">=</mo><mrow id="S2.SS1.p2.10.m10.1.1.3" xref="S2.SS1.p2.10.m10.1.1.3.cmml"><msub id="S2.SS1.p2.10.m10.1.1.3.2" xref="S2.SS1.p2.10.m10.1.1.3.2.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.2.2" xref="S2.SS1.p2.10.m10.1.1.3.2.2.cmml">g</mi><mrow id="S2.SS1.p2.10.m10.1.1.3.2.3" xref="S2.SS1.p2.10.m10.1.1.3.2.3.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.2.3.2" xref="S2.SS1.p2.10.m10.1.1.3.2.3.2.cmml"></mi><mo id="S2.SS1.p2.10.m10.1.1.3.2.3.1" xref="S2.SS1.p2.10.m10.1.1.3.2.3.1.cmml">&gt;</mo><mi id="S2.SS1.p2.10.m10.1.1.3.2.3.3" xref="S2.SS1.p2.10.m10.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS1.p2.10.m10.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.10.m10.1.1.3.1.cmml">∘</mo><msub id="S2.SS1.p2.10.m10.1.1.3.3" xref="S2.SS1.p2.10.m10.1.1.3.3.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.3.2" xref="S2.SS1.p2.10.m10.1.1.3.3.2.cmml">T</mi><mi id="S2.SS1.p2.10.m10.1.1.3.3.3" xref="S2.SS1.p2.10.m10.1.1.3.3.3.cmml">θ</mi></msub><mo id="S2.SS1.p2.10.m10.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.10.m10.1.1.3.1.cmml">∘</mo><msub id="S2.SS1.p2.10.m10.1.1.3.4" xref="S2.SS1.p2.10.m10.1.1.3.4.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.4.2" xref="S2.SS1.p2.10.m10.1.1.3.4.2.cmml">f</mi><mrow id="S2.SS1.p2.10.m10.1.1.3.4.3" xref="S2.SS1.p2.10.m10.1.1.3.4.3.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.4.3.2" xref="S2.SS1.p2.10.m10.1.1.3.4.3.2.cmml"></mi><mo id="S2.SS1.p2.10.m10.1.1.3.4.3.1" xref="S2.SS1.p2.10.m10.1.1.3.4.3.1.cmml">≤</mo><mi id="S2.SS1.p2.10.m10.1.1.3.4.3.3" xref="S2.SS1.p2.10.m10.1.1.3.4.3.3.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><apply id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1"><eq id="S2.SS1.p2.10.m10.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1.1"></eq><ci id="S2.SS1.p2.10.m10.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2">ℎ</ci><apply id="S2.SS1.p2.10.m10.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3"><compose id="S2.SS1.p2.10.m10.1.1.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.1"></compose><apply id="S2.SS1.p2.10.m10.1.1.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.3.2.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.2.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2.2">𝑔</ci><apply id="S2.SS1.p2.10.m10.1.1.3.2.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2.3"><gt id="S2.SS1.p2.10.m10.1.1.3.2.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2.3.1"></gt><csymbol cd="latexml" id="S2.SS1.p2.10.m10.1.1.3.2.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2.3.2">absent</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.2.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS1.p2.10.m10.1.1.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.3.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.3.2">𝑇</ci><ci id="S2.SS1.p2.10.m10.1.1.3.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.3.3">𝜃</ci></apply><apply id="S2.SS1.p2.10.m10.1.1.3.4.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.3.4.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.4.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4.2">𝑓</ci><apply id="S2.SS1.p2.10.m10.1.1.3.4.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4.3"><leq id="S2.SS1.p2.10.m10.1.1.3.4.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4.3.1"></leq><csymbol cd="latexml" id="S2.SS1.p2.10.m10.1.1.3.4.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4.3.2">absent</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.4.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.4.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">h=g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m10.1d">italic_h = italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT ∘ italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Here the <math alttext="T_{\theta}:\mathcal{A}_{f,i}\to\mathcal{A}_{g,j}" class="ltx_Math" display="inline" id="S2.SS1.p2.11.m11.4"><semantics id="S2.SS1.p2.11.m11.4a"><mrow id="S2.SS1.p2.11.m11.4.5" xref="S2.SS1.p2.11.m11.4.5.cmml"><msub id="S2.SS1.p2.11.m11.4.5.2" xref="S2.SS1.p2.11.m11.4.5.2.cmml"><mi id="S2.SS1.p2.11.m11.4.5.2.2" xref="S2.SS1.p2.11.m11.4.5.2.2.cmml">T</mi><mi id="S2.SS1.p2.11.m11.4.5.2.3" xref="S2.SS1.p2.11.m11.4.5.2.3.cmml">θ</mi></msub><mo id="S2.SS1.p2.11.m11.4.5.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p2.11.m11.4.5.1.cmml">:</mo><mrow id="S2.SS1.p2.11.m11.4.5.3" xref="S2.SS1.p2.11.m11.4.5.3.cmml"><msub id="S2.SS1.p2.11.m11.4.5.3.2" xref="S2.SS1.p2.11.m11.4.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.11.m11.4.5.3.2.2" xref="S2.SS1.p2.11.m11.4.5.3.2.2.cmml">𝒜</mi><mrow id="S2.SS1.p2.11.m11.2.2.2.4" xref="S2.SS1.p2.11.m11.2.2.2.3.cmml"><mi id="S2.SS1.p2.11.m11.1.1.1.1" xref="S2.SS1.p2.11.m11.1.1.1.1.cmml">f</mi><mo id="S2.SS1.p2.11.m11.2.2.2.4.1" xref="S2.SS1.p2.11.m11.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p2.11.m11.2.2.2.2" xref="S2.SS1.p2.11.m11.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S2.SS1.p2.11.m11.4.5.3.1" stretchy="false" xref="S2.SS1.p2.11.m11.4.5.3.1.cmml">→</mo><msub id="S2.SS1.p2.11.m11.4.5.3.3" xref="S2.SS1.p2.11.m11.4.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.11.m11.4.5.3.3.2" xref="S2.SS1.p2.11.m11.4.5.3.3.2.cmml">𝒜</mi><mrow id="S2.SS1.p2.11.m11.4.4.2.4" xref="S2.SS1.p2.11.m11.4.4.2.3.cmml"><mi id="S2.SS1.p2.11.m11.3.3.1.1" xref="S2.SS1.p2.11.m11.3.3.1.1.cmml">g</mi><mo id="S2.SS1.p2.11.m11.4.4.2.4.1" xref="S2.SS1.p2.11.m11.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p2.11.m11.4.4.2.2" xref="S2.SS1.p2.11.m11.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m11.4b"><apply id="S2.SS1.p2.11.m11.4.5.cmml" xref="S2.SS1.p2.11.m11.4.5"><ci id="S2.SS1.p2.11.m11.4.5.1.cmml" xref="S2.SS1.p2.11.m11.4.5.1">:</ci><apply id="S2.SS1.p2.11.m11.4.5.2.cmml" xref="S2.SS1.p2.11.m11.4.5.2"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.4.5.2.1.cmml" xref="S2.SS1.p2.11.m11.4.5.2">subscript</csymbol><ci id="S2.SS1.p2.11.m11.4.5.2.2.cmml" xref="S2.SS1.p2.11.m11.4.5.2.2">𝑇</ci><ci id="S2.SS1.p2.11.m11.4.5.2.3.cmml" xref="S2.SS1.p2.11.m11.4.5.2.3">𝜃</ci></apply><apply id="S2.SS1.p2.11.m11.4.5.3.cmml" xref="S2.SS1.p2.11.m11.4.5.3"><ci id="S2.SS1.p2.11.m11.4.5.3.1.cmml" xref="S2.SS1.p2.11.m11.4.5.3.1">→</ci><apply id="S2.SS1.p2.11.m11.4.5.3.2.cmml" xref="S2.SS1.p2.11.m11.4.5.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.4.5.3.2.1.cmml" xref="S2.SS1.p2.11.m11.4.5.3.2">subscript</csymbol><ci id="S2.SS1.p2.11.m11.4.5.3.2.2.cmml" xref="S2.SS1.p2.11.m11.4.5.3.2.2">𝒜</ci><list id="S2.SS1.p2.11.m11.2.2.2.3.cmml" xref="S2.SS1.p2.11.m11.2.2.2.4"><ci id="S2.SS1.p2.11.m11.1.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1.1.1">𝑓</ci><ci id="S2.SS1.p2.11.m11.2.2.2.2.cmml" xref="S2.SS1.p2.11.m11.2.2.2.2">𝑖</ci></list></apply><apply id="S2.SS1.p2.11.m11.4.5.3.3.cmml" xref="S2.SS1.p2.11.m11.4.5.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.4.5.3.3.1.cmml" xref="S2.SS1.p2.11.m11.4.5.3.3">subscript</csymbol><ci id="S2.SS1.p2.11.m11.4.5.3.3.2.cmml" xref="S2.SS1.p2.11.m11.4.5.3.3.2">𝒜</ci><list id="S2.SS1.p2.11.m11.4.4.2.3.cmml" xref="S2.SS1.p2.11.m11.4.4.2.4"><ci id="S2.SS1.p2.11.m11.3.3.1.1.cmml" xref="S2.SS1.p2.11.m11.3.3.1.1">𝑔</ci><ci id="S2.SS1.p2.11.m11.4.4.2.2.cmml" xref="S2.SS1.p2.11.m11.4.4.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m11.4c">T_{\theta}:\mathcal{A}_{f,i}\to\mathcal{A}_{g,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.11.m11.4d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : caligraphic_A start_POSTSUBSCRIPT italic_f , italic_i end_POSTSUBSCRIPT → caligraphic_A start_POSTSUBSCRIPT italic_g , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is referred to as stitching layer, and we refer to <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p2.12.m12.1"><semantics id="S2.SS1.p2.12.m12.1a"><mi id="S2.SS1.p2.12.m12.1.1" xref="S2.SS1.p2.12.m12.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m12.1b"><ci id="S2.SS1.p2.12.m12.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m12.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.12.m12.1d">italic_f</annotation></semantics></math> and <math alttext="g" class="ltx_Math" display="inline" id="S2.SS1.p2.13.m13.1"><semantics id="S2.SS1.p2.13.m13.1a"><mi id="S2.SS1.p2.13.m13.1.1" xref="S2.SS1.p2.13.m13.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.13.m13.1b"><ci id="S2.SS1.p2.13.m13.1.1.cmml" xref="S2.SS1.p2.13.m13.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.13.m13.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.13.m13.1d">italic_g</annotation></semantics></math> as front and end models, respectively. In practice, the optimal <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p2.14.m14.1"><semantics id="S2.SS1.p2.14.m14.1a"><msub id="S2.SS1.p2.14.m14.1.1" xref="S2.SS1.p2.14.m14.1.1.cmml"><mi id="S2.SS1.p2.14.m14.1.1.2" xref="S2.SS1.p2.14.m14.1.1.2.cmml">T</mi><mi id="S2.SS1.p2.14.m14.1.1.3" xref="S2.SS1.p2.14.m14.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.14.m14.1b"><apply id="S2.SS1.p2.14.m14.1.1.cmml" xref="S2.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.14.m14.1.1.1.cmml" xref="S2.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="S2.SS1.p2.14.m14.1.1.2.cmml" xref="S2.SS1.p2.14.m14.1.1.2">𝑇</ci><ci id="S2.SS1.p2.14.m14.1.1.3.cmml" xref="S2.SS1.p2.14.m14.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.14.m14.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.14.m14.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, under a relevant optimality criterion, is selected from a suitable family of transformations <math alttext="S" class="ltx_Math" display="inline" id="S2.SS1.p2.15.m15.1"><semantics id="S2.SS1.p2.15.m15.1a"><mi id="S2.SS1.p2.15.m15.1.1" xref="S2.SS1.p2.15.m15.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.15.m15.1b"><ci id="S2.SS1.p2.15.m15.1.1.cmml" xref="S2.SS1.p2.15.m15.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.15.m15.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.15.m15.1d">italic_S</annotation></semantics></math>, while <math alttext="g" class="ltx_Math" display="inline" id="S2.SS1.p2.16.m16.1"><semantics id="S2.SS1.p2.16.m16.1a"><mi id="S2.SS1.p2.16.m16.1.1" xref="S2.SS1.p2.16.m16.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.16.m16.1b"><ci id="S2.SS1.p2.16.m16.1.1.cmml" xref="S2.SS1.p2.16.m16.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.16.m16.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.16.m16.1d">italic_g</annotation></semantics></math> and <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p2.17.m17.1"><semantics id="S2.SS1.p2.17.m17.1a"><mi id="S2.SS1.p2.17.m17.1.1" xref="S2.SS1.p2.17.m17.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.17.m17.1b"><ci id="S2.SS1.p2.17.m17.1.1.cmml" xref="S2.SS1.p2.17.m17.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.17.m17.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.17.m17.1d">italic_f</annotation></semantics></math> are kept fixed. Given the nature of the problem, the transformation <math alttext="T_{\theta}\in S" class="ltx_Math" display="inline" id="S2.SS1.p2.18.m18.1"><semantics id="S2.SS1.p2.18.m18.1a"><mrow id="S2.SS1.p2.18.m18.1.1" xref="S2.SS1.p2.18.m18.1.1.cmml"><msub id="S2.SS1.p2.18.m18.1.1.2" xref="S2.SS1.p2.18.m18.1.1.2.cmml"><mi id="S2.SS1.p2.18.m18.1.1.2.2" xref="S2.SS1.p2.18.m18.1.1.2.2.cmml">T</mi><mi id="S2.SS1.p2.18.m18.1.1.2.3" xref="S2.SS1.p2.18.m18.1.1.2.3.cmml">θ</mi></msub><mo id="S2.SS1.p2.18.m18.1.1.1" xref="S2.SS1.p2.18.m18.1.1.1.cmml">∈</mo><mi id="S2.SS1.p2.18.m18.1.1.3" xref="S2.SS1.p2.18.m18.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.18.m18.1b"><apply id="S2.SS1.p2.18.m18.1.1.cmml" xref="S2.SS1.p2.18.m18.1.1"><in id="S2.SS1.p2.18.m18.1.1.1.cmml" xref="S2.SS1.p2.18.m18.1.1.1"></in><apply id="S2.SS1.p2.18.m18.1.1.2.cmml" xref="S2.SS1.p2.18.m18.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.18.m18.1.1.2.1.cmml" xref="S2.SS1.p2.18.m18.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.18.m18.1.1.2.2.cmml" xref="S2.SS1.p2.18.m18.1.1.2.2">𝑇</ci><ci id="S2.SS1.p2.18.m18.1.1.2.3.cmml" xref="S2.SS1.p2.18.m18.1.1.2.3">𝜃</ci></apply><ci id="S2.SS1.p2.18.m18.1.1.3.cmml" xref="S2.SS1.p2.18.m18.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.18.m18.1c">T_{\theta}\in S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.18.m18.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∈ italic_S</annotation></semantics></math> needs to be sufficiently flexible to allow non-trivial mappings while ensuring that the capacity of the <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p2.19.m19.1"><semantics id="S2.SS1.p2.19.m19.1a"><mi id="S2.SS1.p2.19.m19.1.1" xref="S2.SS1.p2.19.m19.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.19.m19.1b"><ci id="S2.SS1.p2.19.m19.1.1.cmml" xref="S2.SS1.p2.19.m19.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.19.m19.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.19.m19.1d">italic_h</annotation></semantics></math> does not exceed that of the combined partial networks <math alttext="g_{&gt;j}" class="ltx_Math" display="inline" id="S2.SS1.p2.20.m20.1"><semantics id="S2.SS1.p2.20.m20.1a"><msub id="S2.SS1.p2.20.m20.1.1" xref="S2.SS1.p2.20.m20.1.1.cmml"><mi id="S2.SS1.p2.20.m20.1.1.2" xref="S2.SS1.p2.20.m20.1.1.2.cmml">g</mi><mrow id="S2.SS1.p2.20.m20.1.1.3" xref="S2.SS1.p2.20.m20.1.1.3.cmml"><mi id="S2.SS1.p2.20.m20.1.1.3.2" xref="S2.SS1.p2.20.m20.1.1.3.2.cmml"></mi><mo id="S2.SS1.p2.20.m20.1.1.3.1" xref="S2.SS1.p2.20.m20.1.1.3.1.cmml">&gt;</mo><mi id="S2.SS1.p2.20.m20.1.1.3.3" xref="S2.SS1.p2.20.m20.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.20.m20.1b"><apply id="S2.SS1.p2.20.m20.1.1.cmml" xref="S2.SS1.p2.20.m20.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.20.m20.1.1.1.cmml" xref="S2.SS1.p2.20.m20.1.1">subscript</csymbol><ci id="S2.SS1.p2.20.m20.1.1.2.cmml" xref="S2.SS1.p2.20.m20.1.1.2">𝑔</ci><apply id="S2.SS1.p2.20.m20.1.1.3.cmml" xref="S2.SS1.p2.20.m20.1.1.3"><gt id="S2.SS1.p2.20.m20.1.1.3.1.cmml" xref="S2.SS1.p2.20.m20.1.1.3.1"></gt><csymbol cd="latexml" id="S2.SS1.p2.20.m20.1.1.3.2.cmml" xref="S2.SS1.p2.20.m20.1.1.3.2">absent</csymbol><ci id="S2.SS1.p2.20.m20.1.1.3.3.cmml" xref="S2.SS1.p2.20.m20.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.20.m20.1c">g_{&gt;j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.20.m20.1d">italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\leq i}" class="ltx_Math" display="inline" id="S2.SS1.p2.21.m21.1"><semantics id="S2.SS1.p2.21.m21.1a"><msub id="S2.SS1.p2.21.m21.1.1" xref="S2.SS1.p2.21.m21.1.1.cmml"><mi id="S2.SS1.p2.21.m21.1.1.2" xref="S2.SS1.p2.21.m21.1.1.2.cmml">f</mi><mrow id="S2.SS1.p2.21.m21.1.1.3" xref="S2.SS1.p2.21.m21.1.1.3.cmml"><mi id="S2.SS1.p2.21.m21.1.1.3.2" xref="S2.SS1.p2.21.m21.1.1.3.2.cmml"></mi><mo id="S2.SS1.p2.21.m21.1.1.3.1" xref="S2.SS1.p2.21.m21.1.1.3.1.cmml">≤</mo><mi id="S2.SS1.p2.21.m21.1.1.3.3" xref="S2.SS1.p2.21.m21.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.21.m21.1b"><apply id="S2.SS1.p2.21.m21.1.1.cmml" xref="S2.SS1.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.21.m21.1.1.1.cmml" xref="S2.SS1.p2.21.m21.1.1">subscript</csymbol><ci id="S2.SS1.p2.21.m21.1.1.2.cmml" xref="S2.SS1.p2.21.m21.1.1.2">𝑓</ci><apply id="S2.SS1.p2.21.m21.1.1.3.cmml" xref="S2.SS1.p2.21.m21.1.1.3"><leq id="S2.SS1.p2.21.m21.1.1.3.1.cmml" xref="S2.SS1.p2.21.m21.1.1.3.1"></leq><csymbol cd="latexml" id="S2.SS1.p2.21.m21.1.1.3.2.cmml" xref="S2.SS1.p2.21.m21.1.1.3.2">absent</csymbol><ci id="S2.SS1.p2.21.m21.1.1.3.3.cmml" xref="S2.SS1.p2.21.m21.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.21.m21.1c">f_{\leq i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.21.m21.1d">italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The family <math alttext="S" class="ltx_Math" display="inline" id="S2.SS1.p2.22.m22.1"><semantics id="S2.SS1.p2.22.m22.1a"><mi id="S2.SS1.p2.22.m22.1.1" xref="S2.SS1.p2.22.m22.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.22.m22.1b"><ci id="S2.SS1.p2.22.m22.1.1.cmml" xref="S2.SS1.p2.22.m22.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.22.m22.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.22.m22.1d">italic_S</annotation></semantics></math> of affine transformations is considered in the literature to satisfy these requirements <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.9">We assume access to two datasets, <math alttext="D_{\text{train}}=\{(x_{i},y_{i})\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><msub id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml"><mi id="S2.SS1.p3.1.m1.1.1.3.2" xref="S2.SS1.p3.1.m1.1.1.3.2.cmml">D</mi><mtext id="S2.SS1.p3.1.m1.1.1.3.3" xref="S2.SS1.p3.1.m1.1.1.3.3a.cmml">train</mtext></msub><mo id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml"><mrow id="S2.SS1.p3.1.m1.1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.4" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p3.1.m1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.3.2" xref="S2.SS1.p3.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p3.1.m1.1.1.1.1.3.1" xref="S2.SS1.p3.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p3.1.m1.1.1.1.1.3.3" xref="S2.SS1.p3.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p3.1.m1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><eq id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2"></eq><apply id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.p3.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.3.2.cmml" xref="S2.SS1.p3.1.m1.1.1.3.2">𝐷</ci><ci id="S2.SS1.p3.1.m1.1.1.3.3a.cmml" xref="S2.SS1.p3.1.m1.1.1.3.3"><mtext id="S2.SS1.p3.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.p3.1.m1.1.1.3.3">train</mtext></ci></apply><apply id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS1.p3.1.m1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1">subscript</csymbol><set id="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2"><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.3"><eq id="S2.SS1.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.3.1"></eq><ci id="S2.SS1.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p3.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p3.1.m1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">D_{\text{train}}=\{(x_{i},y_{i})\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="D_{\text{test}}=\{(x_{i},y_{i})\}_{i=1}^{c}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mrow id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><msub id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml"><mi id="S2.SS1.p3.2.m2.1.1.3.2" xref="S2.SS1.p3.2.m2.1.1.3.2.cmml">D</mi><mtext id="S2.SS1.p3.2.m2.1.1.3.3" xref="S2.SS1.p3.2.m2.1.1.3.3a.cmml">test</mtext></msub><mo id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p3.2.m2.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.cmml"><mrow id="S2.SS1.p3.2.m2.1.1.1.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p3.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.4" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS1.p3.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p3.2.m2.1.1.1.1.3" xref="S2.SS1.p3.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.2.m2.1.1.1.1.3.2" xref="S2.SS1.p3.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p3.2.m2.1.1.1.1.3.1" xref="S2.SS1.p3.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p3.2.m2.1.1.1.1.3.3" xref="S2.SS1.p3.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p3.2.m2.1.1.1.3" xref="S2.SS1.p3.2.m2.1.1.1.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><eq id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2"></eq><apply id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.3.1.cmml" xref="S2.SS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.3.2.cmml" xref="S2.SS1.p3.2.m2.1.1.3.2">𝐷</ci><ci id="S2.SS1.p3.2.m2.1.1.3.3a.cmml" xref="S2.SS1.p3.2.m2.1.1.3.3"><mtext id="S2.SS1.p3.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.p3.2.m2.1.1.3.3">test</mtext></ci></apply><apply id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS1.p3.2.m2.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1">subscript</csymbol><set id="S2.SS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2"><apply id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.3"><eq id="S2.SS1.p3.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS1.p3.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p3.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p3.2.m2.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">D_{\text{test}}=\{(x_{i},y_{i})\}_{i=1}^{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>, drawn from the underlying distributions <math alttext="p(x,y)" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.2"><semantics id="S2.SS1.p3.3.m3.2a"><mrow id="S2.SS1.p3.3.m3.2.3" xref="S2.SS1.p3.3.m3.2.3.cmml"><mi id="S2.SS1.p3.3.m3.2.3.2" xref="S2.SS1.p3.3.m3.2.3.2.cmml">p</mi><mo id="S2.SS1.p3.3.m3.2.3.1" xref="S2.SS1.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p3.3.m3.2.3.3.2" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml"><mo id="S2.SS1.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">x</mi><mo id="S2.SS1.p3.3.m3.2.3.3.2.2" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p3.3.m3.2.2" xref="S2.SS1.p3.3.m3.2.2.cmml">y</mi><mo id="S2.SS1.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S2.SS1.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.2b"><apply id="S2.SS1.p3.3.m3.2.3.cmml" xref="S2.SS1.p3.3.m3.2.3"><times id="S2.SS1.p3.3.m3.2.3.1.cmml" xref="S2.SS1.p3.3.m3.2.3.1"></times><ci id="S2.SS1.p3.3.m3.2.3.2.cmml" xref="S2.SS1.p3.3.m3.2.3.2">𝑝</ci><interval closure="open" id="S2.SS1.p3.3.m3.2.3.3.1.cmml" xref="S2.SS1.p3.3.m3.2.3.3.2"><ci id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝑥</ci><ci id="S2.SS1.p3.3.m3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.2c">p(x,y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.2d">italic_p ( italic_x , italic_y )</annotation></semantics></math> and <math alttext="q(x,y)" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.2"><semantics id="S2.SS1.p3.4.m4.2a"><mrow id="S2.SS1.p3.4.m4.2.3" xref="S2.SS1.p3.4.m4.2.3.cmml"><mi id="S2.SS1.p3.4.m4.2.3.2" xref="S2.SS1.p3.4.m4.2.3.2.cmml">q</mi><mo id="S2.SS1.p3.4.m4.2.3.1" xref="S2.SS1.p3.4.m4.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p3.4.m4.2.3.3.2" xref="S2.SS1.p3.4.m4.2.3.3.1.cmml"><mo id="S2.SS1.p3.4.m4.2.3.3.2.1" stretchy="false" xref="S2.SS1.p3.4.m4.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">x</mi><mo id="S2.SS1.p3.4.m4.2.3.3.2.2" xref="S2.SS1.p3.4.m4.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p3.4.m4.2.2" xref="S2.SS1.p3.4.m4.2.2.cmml">y</mi><mo id="S2.SS1.p3.4.m4.2.3.3.2.3" stretchy="false" xref="S2.SS1.p3.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.2b"><apply id="S2.SS1.p3.4.m4.2.3.cmml" xref="S2.SS1.p3.4.m4.2.3"><times id="S2.SS1.p3.4.m4.2.3.1.cmml" xref="S2.SS1.p3.4.m4.2.3.1"></times><ci id="S2.SS1.p3.4.m4.2.3.2.cmml" xref="S2.SS1.p3.4.m4.2.3.2">𝑞</ci><interval closure="open" id="S2.SS1.p3.4.m4.2.3.3.1.cmml" xref="S2.SS1.p3.4.m4.2.3.3.2"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝑥</ci><ci id="S2.SS1.p3.4.m4.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.2c">q(x,y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.2d">italic_q ( italic_x , italic_y )</annotation></semantics></math>, respectively. The distributions <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><mi id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><ci id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">italic_p</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.1"><semantics id="S2.SS1.p3.6.m6.1a"><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">italic_q</annotation></semantics></math> may be identical or distinct. The <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m7.1"><semantics id="S2.SS1.p3.7.m7.1a"><msub id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.2" xref="S2.SS1.p3.7.m7.1.1.2.cmml">T</mi><mi id="S2.SS1.p3.7.m7.1.1.3" xref="S2.SS1.p3.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.2">𝑇</ci><ci id="S2.SS1.p3.7.m7.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m7.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is optimized using <math alttext="D_{\text{train}}" class="ltx_Math" display="inline" id="S2.SS1.p3.8.m8.1"><semantics id="S2.SS1.p3.8.m8.1a"><msub id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml"><mi id="S2.SS1.p3.8.m8.1.1.2" xref="S2.SS1.p3.8.m8.1.1.2.cmml">D</mi><mtext id="S2.SS1.p3.8.m8.1.1.3" xref="S2.SS1.p3.8.m8.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><apply id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.8.m8.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p3.8.m8.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.2">𝐷</ci><ci id="S2.SS1.p3.8.m8.1.1.3a.cmml" xref="S2.SS1.p3.8.m8.1.1.3"><mtext id="S2.SS1.p3.8.m8.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p3.8.m8.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">D_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.8.m8.1d">italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>, while the functional similarity is evaluated on the <math alttext="D_{\text{test}}" class="ltx_Math" display="inline" id="S2.SS1.p3.9.m9.1"><semantics id="S2.SS1.p3.9.m9.1a"><msub id="S2.SS1.p3.9.m9.1.1" xref="S2.SS1.p3.9.m9.1.1.cmml"><mi id="S2.SS1.p3.9.m9.1.1.2" xref="S2.SS1.p3.9.m9.1.1.2.cmml">D</mi><mtext id="S2.SS1.p3.9.m9.1.1.3" xref="S2.SS1.p3.9.m9.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m9.1b"><apply id="S2.SS1.p3.9.m9.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.9.m9.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p3.9.m9.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1.2">𝐷</ci><ci id="S2.SS1.p3.9.m9.1.1.3a.cmml" xref="S2.SS1.p3.9.m9.1.1.3"><mtext id="S2.SS1.p3.9.m9.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p3.9.m9.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m9.1c">D_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.9.m9.1d">italic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p4.1.1">Soft label matching (SLM):</span> Under SLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite>, the output of the end model is used as soft label and the <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><msub id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.2.cmml">T</mi><mi id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2">𝑇</ci><ci id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is obtained as:</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x,y)}[\mathcal{L_{\text{SLM}}%
}\left(\left(g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}\right)(x),g(x)\right)],%
\text{ with $L_{\text{SLM}}:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}$.}" class="ltx_Math" display="block" id="S2.E1.m1.6"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.2.cmml"><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><munder accentunder="true" id="S2.E1.m1.6.6.1.1.3" xref="S2.E1.m1.6.6.1.1.3.cmml"><mtext id="S2.E1.m1.6.6.1.1.3.2" xref="S2.E1.m1.6.6.1.1.3.2a.cmml">arg min</mtext><mo id="S2.E1.m1.6.6.1.1.3.1" xref="S2.E1.m1.6.6.1.1.3.1.cmml">𝜃</mo></munder><mo id="S2.E1.m1.6.6.1.1.2" lspace="0.170em" xref="S2.E1.m1.6.6.1.1.2.cmml">⁢</mo><msub id="S2.E1.m1.6.6.1.1.4" xref="S2.E1.m1.6.6.1.1.4.cmml"><mi id="S2.E1.m1.6.6.1.1.4.2" xref="S2.E1.m1.6.6.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E1.m1.3.3.2" xref="S2.E1.m1.3.3.2.cmml"><mi id="S2.E1.m1.3.3.2.4" xref="S2.E1.m1.3.3.2.4.cmml">p</mi><mo id="S2.E1.m1.3.3.2.3" xref="S2.E1.m1.3.3.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.2.5.2" xref="S2.E1.m1.3.3.2.5.1.cmml"><mo id="S2.E1.m1.3.3.2.5.2.1" stretchy="false" xref="S2.E1.m1.3.3.2.5.1.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">x</mi><mo id="S2.E1.m1.3.3.2.5.2.2" xref="S2.E1.m1.3.3.2.5.1.cmml">,</mo><mi id="S2.E1.m1.3.3.2.2" xref="S2.E1.m1.3.3.2.2.cmml">y</mi><mo id="S2.E1.m1.3.3.2.5.2.3" stretchy="false" xref="S2.E1.m1.3.3.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E1.m1.6.6.1.1.2a" xref="S2.E1.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.2.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.1.4" xref="S2.E1.m1.6.6.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6.1.1.1.1.1.4.2" xref="S2.E1.m1.6.6.1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S2.E1.m1.6.6.1.1.1.1.1.4.3" xref="S2.E1.m1.6.6.1.1.1.1.1.4.3a.cmml">SLM</mtext></msub><mo id="S2.E1.m1.6.6.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">&gt;</mo><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">f</mi><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml"></mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">≤</mo><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">x</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.4" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2.cmml">g</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.1" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">x</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1.2.2.5" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.2" xref="S2.E1.m1.6.6.2.cmml">,</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1c.cmml"><mtext id="S2.E1.m1.1.1.1a" xref="S2.E1.m1.1.1.1c.cmml"> with </mtext><mrow id="S2.E1.m1.1.1.1.m1.1.1" xref="S2.E1.m1.1.1.1.m1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.m1.1.1.2" xref="S2.E1.m1.1.1.1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.m1.1.1.2.2" xref="S2.E1.m1.1.1.1.m1.1.1.2.2.cmml">L</mi><mtext id="S2.E1.m1.1.1.1.m1.1.1.2.3" xref="S2.E1.m1.1.1.1.m1.1.1.2.3.cmml">SLM</mtext></msub><mo id="S2.E1.m1.1.1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.1.1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.E1.m1.1.1.1.m1.1.1.3" xref="S2.E1.m1.1.1.1.m1.1.1.3.cmml"><mrow id="S2.E1.m1.1.1.1.m1.1.1.3.2" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.m1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.2.cmml">𝒴</mi><mo id="S2.E1.m1.1.1.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.m1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.3.cmml">𝒴</mi></mrow><mo id="S2.E1.m1.1.1.1.m1.1.1.3.1" stretchy="false" xref="S2.E1.m1.1.1.1.m1.1.1.3.1.cmml">→</mo><mi id="S2.E1.m1.1.1.1.m1.1.1.3.3" xref="S2.E1.m1.1.1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><mtext id="S2.E1.m1.1.1.1b" xref="S2.E1.m1.1.1.1c.cmml">.</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><list id="S2.E1.m1.6.6.2.cmml" xref="S2.E1.m1.6.6.1"><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1.1"><times id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2"></times><apply id="S2.E1.m1.6.6.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.3"><ci id="S2.E1.m1.6.6.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.3.1">𝜃</ci><ci id="S2.E1.m1.6.6.1.1.3.2a.cmml" xref="S2.E1.m1.6.6.1.1.3.2"><mtext id="S2.E1.m1.6.6.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.3.2">arg min</mtext></ci></apply><apply id="S2.E1.m1.6.6.1.1.4.cmml" xref="S2.E1.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.4.1.cmml" xref="S2.E1.m1.6.6.1.1.4">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.4.2.cmml" xref="S2.E1.m1.6.6.1.1.4.2">𝔼</ci><apply id="S2.E1.m1.3.3.2.cmml" xref="S2.E1.m1.3.3.2"><times id="S2.E1.m1.3.3.2.3.cmml" xref="S2.E1.m1.3.3.2.3"></times><ci id="S2.E1.m1.3.3.2.4.cmml" xref="S2.E1.m1.3.3.2.4">𝑝</ci><interval closure="open" id="S2.E1.m1.3.3.2.5.1.cmml" xref="S2.E1.m1.3.3.2.5.2"><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑥</ci><ci id="S2.E1.m1.3.3.2.2.cmml" xref="S2.E1.m1.3.3.2.2">𝑦</ci></interval></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.6.6.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1"><times id="S2.E1.m1.6.6.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.3"></times><apply id="S2.E1.m1.6.6.1.1.1.1.1.4.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.4.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.4.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E1.m1.6.6.1.1.1.1.1.4.3a.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.4.3"><mtext id="S2.E1.m1.6.6.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E1.m1.6.6.1.1.1.1.1.4.3">SLM</mtext></ci></apply><interval closure="open" id="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2"><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1"><compose id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"></compose><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3"><gt id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></gt><csymbol cd="latexml" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑓</ci><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3"><leq id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.1"></leq><csymbol cd="latexml" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.2">absent</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑥</ci></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2"><times id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.1"></times><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2">𝑔</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝑥</ci></apply></interval></apply></apply></apply><ci id="S2.E1.m1.1.1.1c.cmml" xref="S2.E1.m1.1.1.1"><mrow id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><mtext id="S2.E1.m1.1.1.1a.cmml" xref="S2.E1.m1.1.1.1"> with </mtext><mrow id="S2.E1.m1.1.1.1.m1.1.1.cmml" xref="S2.E1.m1.1.1.1.m1.1.1"><msub id="S2.E1.m1.1.1.1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.2"><mi id="S2.E1.m1.1.1.1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.2.2">L</mi><mtext id="S2.E1.m1.1.1.1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.2.3">SLM</mtext></msub><mo id="S2.E1.m1.1.1.1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.1">:</mo><mrow id="S2.E1.m1.1.1.1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3"><mrow id="S2.E1.m1.1.1.1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.m1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.2">𝒴</mi><mo id="S2.E1.m1.1.1.1.m1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.1">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.m1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3.2.3">𝒴</mi></mrow><mo id="S2.E1.m1.1.1.1.m1.1.1.3.1.cmml" stretchy="false" xref="S2.E1.m1.1.1.1.m1.1.1.3.1">→</mo><mi id="S2.E1.m1.1.1.1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.m1.1.1.3.3">ℝ</mi></mrow></mrow><mtext id="S2.E1.m1.1.1.1b.cmml" xref="S2.E1.m1.1.1.1">.</mtext></mrow></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x,y)}[\mathcal{L_{\text{SLM}}%
}\left(\left(g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}\right)(x),g(x)\right)],%
\text{ with $L_{\text{SLM}}:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}$.}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">underitalic_θ start_ARG arg min end_ARG blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x , italic_y ) end_POSTSUBSCRIPT [ caligraphic_L start_POSTSUBSCRIPT SLM end_POSTSUBSCRIPT ( ( italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT ∘ italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT ) ( italic_x ) , italic_g ( italic_x ) ) ] , with italic_L start_POSTSUBSCRIPT SLM end_POSTSUBSCRIPT : caligraphic_Y × caligraphic_Y → blackboard_R .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p6.1.1">Task loss matching (TLM) <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><cite class="ltx_cite ltx_citemacro_citet">Csiszárik et al. <span class="ltx_text ltx_font_medium" id="footnote1.5.1.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a><span class="ltx_text ltx_font_medium" id="footnote1.6.2.2.1">]</span></cite><span class="ltx_text ltx_font_medium" id="footnote1.7"> use the term TLM interchangeably to refer to both TLM and SLM, and argue that these two settings lead to highly correlated results. However, in our work, we find that TLM and SLM can behave differently under certain key stitching settings, and therefore, we distinguish between them.</span></span></span></span>:</span> Under the TLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite>, <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.1"><semantics id="S2.SS1.p6.1.m1.1a"><msub id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml"><mi id="S2.SS1.p6.1.m1.1.1.2" xref="S2.SS1.p6.1.m1.1.1.2.cmml">T</mi><mi id="S2.SS1.p6.1.m1.1.1.3" xref="S2.SS1.p6.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><apply id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.1.m1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p6.1.m1.1.1.2.cmml" xref="S2.SS1.p6.1.m1.1.1.2">𝑇</ci><ci id="S2.SS1.p6.1.m1.1.1.3.cmml" xref="S2.SS1.p6.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is found as:</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x,y)}[\mathcal{L_{\text{TLM}}%
}\left(\left(g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}\right)(x),y\right)],\text{%
 with $L_{\text{TLM}}:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}$}." class="ltx_Math" display="block" id="S2.E2.m1.6"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6.1"><mrow id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.2.cmml"><mrow id="S2.E2.m1.6.6.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.cmml"><munder accentunder="true" id="S2.E2.m1.6.6.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.3.cmml"><mtext id="S2.E2.m1.6.6.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.3.2a.cmml">arg min</mtext><mo id="S2.E2.m1.6.6.1.1.1.1.3.1" xref="S2.E2.m1.6.6.1.1.1.1.3.1.cmml">𝜃</mo></munder><mo id="S2.E2.m1.6.6.1.1.1.1.2" lspace="0.170em" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E2.m1.6.6.1.1.1.1.4" xref="S2.E2.m1.6.6.1.1.1.1.4.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.4.2" xref="S2.E2.m1.6.6.1.1.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E2.m1.3.3.2" xref="S2.E2.m1.3.3.2.cmml"><mi id="S2.E2.m1.3.3.2.4" xref="S2.E2.m1.3.3.2.4.cmml">p</mi><mo id="S2.E2.m1.3.3.2.3" xref="S2.E2.m1.3.3.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.2.5.2" xref="S2.E2.m1.3.3.2.5.1.cmml"><mo id="S2.E2.m1.3.3.2.5.2.1" stretchy="false" xref="S2.E2.m1.3.3.2.5.1.cmml">(</mo><mi id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml">x</mi><mo id="S2.E2.m1.3.3.2.5.2.2" xref="S2.E2.m1.3.3.2.5.1.cmml">,</mo><mi id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.2.cmml">y</mi><mo id="S2.E2.m1.3.3.2.5.2.3" stretchy="false" xref="S2.E2.m1.3.3.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E2.m1.6.6.1.1.1.1.2a" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3a.cmml">TLM</mtext></msub><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">&gt;</mo><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">f</mi><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml"></mi><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">≤</mo><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">x</mi><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">y</mi><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.cmml">,</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1b.cmml"><mtext id="S2.E2.m1.1.1.1a" xref="S2.E2.m1.1.1.1b.cmml"> with </mtext><mrow id="S2.E2.m1.1.1.1.m1.1.1" xref="S2.E2.m1.1.1.1.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.m1.1.1.2" xref="S2.E2.m1.1.1.1.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.m1.1.1.2.2" xref="S2.E2.m1.1.1.1.m1.1.1.2.2.cmml">L</mi><mtext id="S2.E2.m1.1.1.1.m1.1.1.2.3" xref="S2.E2.m1.1.1.1.m1.1.1.2.3.cmml">TLM</mtext></msub><mo id="S2.E2.m1.1.1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.1.1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.E2.m1.1.1.1.m1.1.1.3" xref="S2.E2.m1.1.1.1.m1.1.1.3.cmml"><mrow id="S2.E2.m1.1.1.1.m1.1.1.3.2" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.2.cmml">𝒴</mi><mo id="S2.E2.m1.1.1.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.3.cmml">𝒴</mi></mrow><mo id="S2.E2.m1.1.1.1.m1.1.1.3.1" stretchy="false" xref="S2.E2.m1.1.1.1.m1.1.1.3.1.cmml">→</mo><mi id="S2.E2.m1.1.1.1.m1.1.1.3.3" xref="S2.E2.m1.1.1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><list id="S2.E2.m1.6.6.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1"><apply id="S2.E2.m1.6.6.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3"><ci id="S2.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3.1">𝜃</ci><ci id="S2.E2.m1.6.6.1.1.1.1.3.2a.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3.2"><mtext id="S2.E2.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3.2">arg min</mtext></ci></apply><apply id="S2.E2.m1.6.6.1.1.1.1.4.cmml" xref="S2.E2.m1.6.6.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.4.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.4.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.4.2">𝔼</ci><apply id="S2.E2.m1.3.3.2.cmml" xref="S2.E2.m1.3.3.2"><times id="S2.E2.m1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3"></times><ci id="S2.E2.m1.3.3.2.4.cmml" xref="S2.E2.m1.3.3.2.4">𝑝</ci><interval closure="open" id="S2.E2.m1.3.3.2.5.1.cmml" xref="S2.E2.m1.3.3.2.5.2"><ci id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1">𝑥</ci><ci id="S2.E2.m1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2">𝑦</ci></interval></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3"><mtext id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.3">TLM</mtext></ci></apply><interval closure="open" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><compose id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></compose><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><gt id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></gt><csymbol cd="latexml" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑓</ci><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3"><leq id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1"></leq><csymbol cd="latexml" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2">absent</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝑥</ci></apply><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝑦</ci></interval></apply></apply></apply><ci id="S2.E2.m1.1.1.1b.cmml" xref="S2.E2.m1.1.1.1"><mrow id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><mtext id="S2.E2.m1.1.1.1a.cmml" xref="S2.E2.m1.1.1.1"> with </mtext><mrow id="S2.E2.m1.1.1.1.m1.1.1.cmml" xref="S2.E2.m1.1.1.1.m1.1.1"><msub id="S2.E2.m1.1.1.1.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.2"><mi id="S2.E2.m1.1.1.1.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.2.2">L</mi><mtext id="S2.E2.m1.1.1.1.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.2.3">TLM</mtext></msub><mo id="S2.E2.m1.1.1.1.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.1">:</mo><mrow id="S2.E2.m1.1.1.1.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3"><mrow id="S2.E2.m1.1.1.1.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.2">𝒴</mi><mo id="S2.E2.m1.1.1.1.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.1">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3.2.3">𝒴</mi></mrow><mo id="S2.E2.m1.1.1.1.m1.1.1.3.1.cmml" stretchy="false" xref="S2.E2.m1.1.1.1.m1.1.1.3.1">→</mo><mi id="S2.E2.m1.1.1.1.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.m1.1.1.3.3">ℝ</mi></mrow></mrow></mrow></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x,y)}[\mathcal{L_{\text{TLM}}%
}\left(\left(g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}\right)(x),y\right)],\text{%
 with $L_{\text{TLM}}:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}$}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.6d">underitalic_θ start_ARG arg min end_ARG blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x , italic_y ) end_POSTSUBSCRIPT [ caligraphic_L start_POSTSUBSCRIPT TLM end_POSTSUBSCRIPT ( ( italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT ∘ italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT ) ( italic_x ) , italic_y ) ] , with italic_L start_POSTSUBSCRIPT TLM end_POSTSUBSCRIPT : caligraphic_Y × caligraphic_Y → blackboard_R .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p8">
<p class="ltx_p" id="S2.SS1.p8.2">For example, in the classification setting we considered, both <math alttext="L_{\text{SLM}}" class="ltx_Math" display="inline" id="S2.SS1.p8.1.m1.1"><semantics id="S2.SS1.p8.1.m1.1a"><msub id="S2.SS1.p8.1.m1.1.1" xref="S2.SS1.p8.1.m1.1.1.cmml"><mi id="S2.SS1.p8.1.m1.1.1.2" xref="S2.SS1.p8.1.m1.1.1.2.cmml">L</mi><mtext id="S2.SS1.p8.1.m1.1.1.3" xref="S2.SS1.p8.1.m1.1.1.3a.cmml">SLM</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p8.1.m1.1b"><apply id="S2.SS1.p8.1.m1.1.1.cmml" xref="S2.SS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p8.1.m1.1.1.1.cmml" xref="S2.SS1.p8.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p8.1.m1.1.1.2.cmml" xref="S2.SS1.p8.1.m1.1.1.2">𝐿</ci><ci id="S2.SS1.p8.1.m1.1.1.3a.cmml" xref="S2.SS1.p8.1.m1.1.1.3"><mtext id="S2.SS1.p8.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p8.1.m1.1.1.3">SLM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p8.1.m1.1c">L_{\text{SLM}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p8.1.m1.1d">italic_L start_POSTSUBSCRIPT SLM end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="L_{\text{TLM}}" class="ltx_Math" display="inline" id="S2.SS1.p8.2.m2.1"><semantics id="S2.SS1.p8.2.m2.1a"><msub id="S2.SS1.p8.2.m2.1.1" xref="S2.SS1.p8.2.m2.1.1.cmml"><mi id="S2.SS1.p8.2.m2.1.1.2" xref="S2.SS1.p8.2.m2.1.1.2.cmml">L</mi><mtext id="S2.SS1.p8.2.m2.1.1.3" xref="S2.SS1.p8.2.m2.1.1.3a.cmml">TLM</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p8.2.m2.1b"><apply id="S2.SS1.p8.2.m2.1.1.cmml" xref="S2.SS1.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p8.2.m2.1.1.1.cmml" xref="S2.SS1.p8.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p8.2.m2.1.1.2.cmml" xref="S2.SS1.p8.2.m2.1.1.2">𝐿</ci><ci id="S2.SS1.p8.2.m2.1.1.3a.cmml" xref="S2.SS1.p8.2.m2.1.1.3"><mtext id="S2.SS1.p8.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p8.2.m2.1.1.3">TLM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p8.2.m2.1c">L_{\text{TLM}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p8.2.m2.1d">italic_L start_POSTSUBSCRIPT TLM end_POSTSUBSCRIPT</annotation></semantics></math> are the cross-entropy losses between the output of the stitched model and the soft labels (from the end model) and the ground-truth (hard) labels, respectively.</p>
</div>
<div class="ltx_para" id="S2.SS1.p9">
<p class="ltx_p" id="S2.SS1.p9.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p9.1.1">Direct matching (DM):</span> Under the DM, the objective for the <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p9.1.m1.1"><semantics id="S2.SS1.p9.1.m1.1a"><msub id="S2.SS1.p9.1.m1.1.1" xref="S2.SS1.p9.1.m1.1.1.cmml"><mi id="S2.SS1.p9.1.m1.1.1.2" xref="S2.SS1.p9.1.m1.1.1.2.cmml">T</mi><mi id="S2.SS1.p9.1.m1.1.1.3" xref="S2.SS1.p9.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p9.1.m1.1b"><apply id="S2.SS1.p9.1.m1.1.1.cmml" xref="S2.SS1.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p9.1.m1.1.1.1.cmml" xref="S2.SS1.p9.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p9.1.m1.1.1.2.cmml" xref="S2.SS1.p9.1.m1.1.1.2">𝑇</ci><ci id="S2.SS1.p9.1.m1.1.1.3.cmml" xref="S2.SS1.p9.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p9.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p9.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is task-agnostic and is defined as:</p>
</div>
<div class="ltx_para" id="S2.SS1.p10">
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x)}\left[||\left(T_{\theta}%
\circ f_{\leq i}\right)(x)-g_{\leq j}(x)||_{F}\right]," class="ltx_Math" display="block" id="S2.E3.m1.4"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4.1" xref="S2.E3.m1.4.4.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1" xref="S2.E3.m1.4.4.1.1.cmml"><munder accentunder="true" id="S2.E3.m1.4.4.1.1.3" xref="S2.E3.m1.4.4.1.1.3.cmml"><mtext id="S2.E3.m1.4.4.1.1.3.2" xref="S2.E3.m1.4.4.1.1.3.2a.cmml">arg min</mtext><mo id="S2.E3.m1.4.4.1.1.3.1" xref="S2.E3.m1.4.4.1.1.3.1.cmml">𝜃</mo></munder><mo id="S2.E3.m1.4.4.1.1.2" lspace="0.170em" xref="S2.E3.m1.4.4.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.4.4.1.1.4" xref="S2.E3.m1.4.4.1.1.4.cmml"><mi id="S2.E3.m1.4.4.1.1.4.2" xref="S2.E3.m1.4.4.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">p</mi><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">x</mi><mo id="S2.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E3.m1.4.4.1.1.2a" xref="S2.E3.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.2.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.2.1.cmml">[</mo><msub id="S2.E3.m1.4.4.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">x</mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><msub id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">g</mi><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml"></mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1.cmml">≤</mo><mi id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">x</mi><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S2.E3.m1.4.4.1.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.1.1.3.cmml">F</mi></msub><mo id="S2.E3.m1.4.4.1.1.1.1.3" xref="S2.E3.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E3.m1.4.4.1.2" xref="S2.E3.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.1.1.cmml" xref="S2.E3.m1.4.4.1"><times id="S2.E3.m1.4.4.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.2"></times><apply id="S2.E3.m1.4.4.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.3"><ci id="S2.E3.m1.4.4.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.3.1">𝜃</ci><ci id="S2.E3.m1.4.4.1.1.3.2a.cmml" xref="S2.E3.m1.4.4.1.1.3.2"><mtext id="S2.E3.m1.4.4.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2">arg min</mtext></ci></apply><apply id="S2.E3.m1.4.4.1.1.4.cmml" xref="S2.E3.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.4.1.cmml" xref="S2.E3.m1.4.4.1.1.4">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.4.2.cmml" xref="S2.E3.m1.4.4.1.1.4.2">𝔼</ci><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝑝</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="S2.E3.m1.4.4.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><compose id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"></compose><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><leq id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑥</ci></apply><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3"><times id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">𝑔</ci><apply id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3"><leq id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1"></leq><csymbol cd="latexml" id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2">absent</csymbol><ci id="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑥</ci></apply></apply></apply><ci id="S2.E3.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.1.1.1.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x)}\left[||\left(T_{\theta}%
\circ f_{\leq i}\right)(x)-g_{\leq j}(x)||_{F}\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.4d">underitalic_θ start_ARG arg min end_ARG blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x ) end_POSTSUBSCRIPT [ | | ( italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT ) ( italic_x ) - italic_g start_POSTSUBSCRIPT ≤ italic_j end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p10.1">As discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite>, under DM, there exists a closed-form solution for <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p10.1.m1.1"><semantics id="S2.SS1.p10.1.m1.1a"><msub id="S2.SS1.p10.1.m1.1.1" xref="S2.SS1.p10.1.m1.1.1.cmml"><mi id="S2.SS1.p10.1.m1.1.1.2" xref="S2.SS1.p10.1.m1.1.1.2.cmml">T</mi><mi id="S2.SS1.p10.1.m1.1.1.3" xref="S2.SS1.p10.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p10.1.m1.1b"><apply id="S2.SS1.p10.1.m1.1.1.cmml" xref="S2.SS1.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p10.1.m1.1.1.1.cmml" xref="S2.SS1.p10.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p10.1.m1.1.1.2.cmml" xref="S2.SS1.p10.1.m1.1.1.2">𝑇</ci><ci id="S2.SS1.p10.1.m1.1.1.3.cmml" xref="S2.SS1.p10.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p10.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p10.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, making it well-suited for initialization prior to further fine-tuning under SLM or TLM. Moreover, model stitching, under DM, has recently been advocated as a more reliable alternative to TLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite>, in light of the seemingly counterintuitive behavior related to the directionality of functional similarity in model stitching.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Adversarial Training</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Adversarial Training (AT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib29" title="">29</a>]</cite> is widely regarded as the most effective method for improving model robustness against worst-case perturbations, referred to as adversarial examples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib26" title="">26</a>]</cite>. Functional similarity between non-robust and robust models was investigated under TLM in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite> using the AT strategy proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib29" title="">29</a>]</cite>. In this case, the training objective for the neural network <math alttext="f_{w}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">f</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑓</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">f_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> becomes:</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{w}{\text{arg min}}\,\mathbb{E}_{p(x,y)}\left[(1-\alpha)\mathcal{L}(f%
_{w}(x),y)+\alpha\max_{\delta\in\mathcal{B}(x,\epsilon)}\mathcal{L}(f_{w}(%
\mathbf{x}+\delta),y)\right]," class="ltx_Math" display="block" id="S2.E4.m1.8"><semantics id="S2.E4.m1.8a"><mrow id="S2.E4.m1.8.8.1" xref="S2.E4.m1.8.8.1.1.cmml"><mrow id="S2.E4.m1.8.8.1.1" xref="S2.E4.m1.8.8.1.1.cmml"><munder accentunder="true" id="S2.E4.m1.8.8.1.1.3" xref="S2.E4.m1.8.8.1.1.3.cmml"><mtext id="S2.E4.m1.8.8.1.1.3.2" xref="S2.E4.m1.8.8.1.1.3.2a.cmml">arg min</mtext><mo id="S2.E4.m1.8.8.1.1.3.1" xref="S2.E4.m1.8.8.1.1.3.1.cmml">𝑤</mo></munder><mo id="S2.E4.m1.8.8.1.1.2" lspace="0.170em" xref="S2.E4.m1.8.8.1.1.2.cmml">⁢</mo><msub id="S2.E4.m1.8.8.1.1.4" xref="S2.E4.m1.8.8.1.1.4.cmml"><mi id="S2.E4.m1.8.8.1.1.4.2" xref="S2.E4.m1.8.8.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E4.m1.2.2.2" xref="S2.E4.m1.2.2.2.cmml"><mi id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.4.cmml">p</mi><mo id="S2.E4.m1.2.2.2.3" xref="S2.E4.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.2.5.2" xref="S2.E4.m1.2.2.2.5.1.cmml"><mo id="S2.E4.m1.2.2.2.5.2.1" stretchy="false" xref="S2.E4.m1.2.2.2.5.1.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">x</mi><mo id="S2.E4.m1.2.2.2.5.2.2" xref="S2.E4.m1.2.2.2.5.1.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">y</mi><mo id="S2.E4.m1.2.2.2.5.2.3" stretchy="false" xref="S2.E4.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E4.m1.8.8.1.1.2a" xref="S2.E4.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.2.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.2" xref="S2.E4.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.8.8.1.1.1.1.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.2.cmml"><mrow id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.3" xref="S2.E4.m1.8.8.1.1.1.1.1.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.8.8.1.1.1.1.1.2.4" xref="S2.E4.m1.8.8.1.1.1.1.1.2.4.cmml">ℒ</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.3a" xref="S2.E4.m1.8.8.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.cmml"><msub id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.2" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.2.cmml">f</mi><mi id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.3" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.3.cmml">w</mi></msub><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.3.2" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.cmml">(</mo><mi id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml">x</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.3.2.2" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml">,</mo><mi id="S2.E4.m1.6.6" xref="S2.E4.m1.6.6.cmml">y</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.4" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.4" xref="S2.E4.m1.8.8.1.1.1.1.1.4.cmml">+</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.3.cmml">α</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.2" lspace="0.167em" xref="S2.E4.m1.8.8.1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3.4" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.cmml"><munder id="S2.E4.m1.8.8.1.1.1.1.1.3.4.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.cmml"><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.2.cmml">max</mi><mrow id="S2.E4.m1.4.4.2" xref="S2.E4.m1.4.4.2.cmml"><mi id="S2.E4.m1.4.4.2.4" xref="S2.E4.m1.4.4.2.4.cmml">δ</mi><mo id="S2.E4.m1.4.4.2.3" xref="S2.E4.m1.4.4.2.3.cmml">∈</mo><mrow id="S2.E4.m1.4.4.2.5" xref="S2.E4.m1.4.4.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.4.4.2.5.2" xref="S2.E4.m1.4.4.2.5.2.cmml">ℬ</mi><mo id="S2.E4.m1.4.4.2.5.1" xref="S2.E4.m1.4.4.2.5.1.cmml">⁢</mo><mrow id="S2.E4.m1.4.4.2.5.3.2" xref="S2.E4.m1.4.4.2.5.3.1.cmml"><mo id="S2.E4.m1.4.4.2.5.3.2.1" stretchy="false" xref="S2.E4.m1.4.4.2.5.3.1.cmml">(</mo><mi id="S2.E4.m1.3.3.1.1" xref="S2.E4.m1.3.3.1.1.cmml">x</mi><mo id="S2.E4.m1.4.4.2.5.3.2.2" xref="S2.E4.m1.4.4.2.5.3.1.cmml">,</mo><mi id="S2.E4.m1.4.4.2.2" xref="S2.E4.m1.4.4.2.2.cmml">ϵ</mi><mo id="S2.E4.m1.4.4.2.5.3.2.3" stretchy="false" xref="S2.E4.m1.4.4.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></munder><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.4a" lspace="0.167em" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.8.8.1.1.1.1.1.3.4.2" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.2.cmml">ℒ</mi></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.2a" xref="S2.E4.m1.8.8.1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.2.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.2" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.2.cmml">(</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.cmml"><msub id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.2" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.2.cmml">f</mi><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.3.cmml">w</mi></msub><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.1" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml">δ</mi></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.3" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.2.cmml">,</mo><mi id="S2.E4.m1.7.7" xref="S2.E4.m1.7.7.cmml">y</mi><mo id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.4" stretchy="false" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.8.8.1.1.1.1.3" xref="S2.E4.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.8.8.1.2" xref="S2.E4.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.8b"><apply id="S2.E4.m1.8.8.1.1.cmml" xref="S2.E4.m1.8.8.1"><times id="S2.E4.m1.8.8.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.2"></times><apply id="S2.E4.m1.8.8.1.1.3.cmml" xref="S2.E4.m1.8.8.1.1.3"><ci id="S2.E4.m1.8.8.1.1.3.1.cmml" xref="S2.E4.m1.8.8.1.1.3.1">𝑤</ci><ci id="S2.E4.m1.8.8.1.1.3.2a.cmml" xref="S2.E4.m1.8.8.1.1.3.2"><mtext id="S2.E4.m1.8.8.1.1.3.2.cmml" xref="S2.E4.m1.8.8.1.1.3.2">arg min</mtext></ci></apply><apply id="S2.E4.m1.8.8.1.1.4.cmml" xref="S2.E4.m1.8.8.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.8.8.1.1.4.1.cmml" xref="S2.E4.m1.8.8.1.1.4">subscript</csymbol><ci id="S2.E4.m1.8.8.1.1.4.2.cmml" xref="S2.E4.m1.8.8.1.1.4.2">𝔼</ci><apply id="S2.E4.m1.2.2.2.cmml" xref="S2.E4.m1.2.2.2"><times id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.3"></times><ci id="S2.E4.m1.2.2.2.4.cmml" xref="S2.E4.m1.2.2.2.4">𝑝</ci><interval closure="open" id="S2.E4.m1.2.2.2.5.1.cmml" xref="S2.E4.m1.2.2.2.5.2"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑥</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑦</ci></interval></apply></apply><apply id="S2.E4.m1.8.8.1.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.8.8.1.1.1.2.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.8.8.1.1.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1"><plus id="S2.E4.m1.8.8.1.1.1.1.1.4.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.4"></plus><apply id="S2.E4.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2"><times id="S2.E4.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.3"></times><apply id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1"><minus id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><ci id="S2.E4.m1.8.8.1.1.1.1.1.2.4.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.4">ℒ</ci><interval closure="open" id="S2.E4.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1"><apply id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1"><times id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.1"></times><apply id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.2">𝑓</ci><ci id="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.2.2.1.1.2.3">𝑤</ci></apply><ci id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5">𝑥</ci></apply><ci id="S2.E4.m1.6.6.cmml" xref="S2.E4.m1.6.6">𝑦</ci></interval></apply><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3"><times id="S2.E4.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.2"></times><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.3">𝛼</ci><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.4.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4"><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.1"><csymbol cd="ambiguous" id="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.1">subscript</csymbol><max id="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.1.2"></max><apply id="S2.E4.m1.4.4.2.cmml" xref="S2.E4.m1.4.4.2"><in id="S2.E4.m1.4.4.2.3.cmml" xref="S2.E4.m1.4.4.2.3"></in><ci id="S2.E4.m1.4.4.2.4.cmml" xref="S2.E4.m1.4.4.2.4">𝛿</ci><apply id="S2.E4.m1.4.4.2.5.cmml" xref="S2.E4.m1.4.4.2.5"><times id="S2.E4.m1.4.4.2.5.1.cmml" xref="S2.E4.m1.4.4.2.5.1"></times><ci id="S2.E4.m1.4.4.2.5.2.cmml" xref="S2.E4.m1.4.4.2.5.2">ℬ</ci><interval closure="open" id="S2.E4.m1.4.4.2.5.3.1.cmml" xref="S2.E4.m1.4.4.2.5.3.2"><ci id="S2.E4.m1.3.3.1.1.cmml" xref="S2.E4.m1.3.3.1.1">𝑥</ci><ci id="S2.E4.m1.4.4.2.2.cmml" xref="S2.E4.m1.4.4.2.2">italic-ϵ</ci></interval></apply></apply></apply><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.4.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.4.2">ℒ</ci></apply><interval closure="open" id="S2.E4.m1.8.8.1.1.1.1.1.3.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1"><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1"><times id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.2"></times><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.2">𝑓</ci><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.3.3">𝑤</ci></apply><apply id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1"><plus id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.1"></plus><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.8.8.1.1.1.1.1.3.1.1.1.1.1.1.3">𝛿</ci></apply></apply><ci id="S2.E4.m1.7.7.cmml" xref="S2.E4.m1.7.7">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.8c">\underset{w}{\text{arg min}}\,\mathbb{E}_{p(x,y)}\left[(1-\alpha)\mathcal{L}(f%
_{w}(x),y)+\alpha\max_{\delta\in\mathcal{B}(x,\epsilon)}\mathcal{L}(f_{w}(%
\mathbf{x}+\delta),y)\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.8d">underitalic_w start_ARG arg min end_ARG blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x , italic_y ) end_POSTSUBSCRIPT [ ( 1 - italic_α ) caligraphic_L ( italic_f start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_x ) , italic_y ) + italic_α roman_max start_POSTSUBSCRIPT italic_δ ∈ caligraphic_B ( italic_x , italic_ϵ ) end_POSTSUBSCRIPT caligraphic_L ( italic_f start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( bold_x + italic_δ ) , italic_y ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.6">where the parameter <math alttext="\alpha\in[0,1]" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.2"><semantics id="S2.SS2.p3.1.m1.2a"><mrow id="S2.SS2.p3.1.m1.2.3" xref="S2.SS2.p3.1.m1.2.3.cmml"><mi id="S2.SS2.p3.1.m1.2.3.2" xref="S2.SS2.p3.1.m1.2.3.2.cmml">α</mi><mo id="S2.SS2.p3.1.m1.2.3.1" xref="S2.SS2.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p3.1.m1.2.3.3.2" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml"><mo id="S2.SS2.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="S2.SS2.p3.1.m1.2.3.3.2.2" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p3.1.m1.2.2" xref="S2.SS2.p3.1.m1.2.2.cmml">1</mn><mo id="S2.SS2.p3.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.2b"><apply id="S2.SS2.p3.1.m1.2.3.cmml" xref="S2.SS2.p3.1.m1.2.3"><in id="S2.SS2.p3.1.m1.2.3.1.cmml" xref="S2.SS2.p3.1.m1.2.3.1"></in><ci id="S2.SS2.p3.1.m1.2.3.2.cmml" xref="S2.SS2.p3.1.m1.2.3.2">𝛼</ci><interval closure="closed" id="S2.SS2.p3.1.m1.2.3.3.1.cmml" xref="S2.SS2.p3.1.m1.2.3.3.2"><cn id="S2.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S2.SS2.p3.1.m1.1.1">0</cn><cn id="S2.SS2.p3.1.m1.2.2.cmml" type="integer" xref="S2.SS2.p3.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.2c">\alpha\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.2d">italic_α ∈ [ 0 , 1 ]</annotation></semantics></math> controls the proportion of adversarial samples, <math alttext="\mathcal{B}(x,\epsilon)" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.2"><semantics id="S2.SS2.p3.2.m2.2a"><mrow id="S2.SS2.p3.2.m2.2.3" xref="S2.SS2.p3.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.2.m2.2.3.2" xref="S2.SS2.p3.2.m2.2.3.2.cmml">ℬ</mi><mo id="S2.SS2.p3.2.m2.2.3.1" xref="S2.SS2.p3.2.m2.2.3.1.cmml">⁢</mo><mrow id="S2.SS2.p3.2.m2.2.3.3.2" xref="S2.SS2.p3.2.m2.2.3.3.1.cmml"><mo id="S2.SS2.p3.2.m2.2.3.3.2.1" stretchy="false" xref="S2.SS2.p3.2.m2.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">x</mi><mo id="S2.SS2.p3.2.m2.2.3.3.2.2" xref="S2.SS2.p3.2.m2.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p3.2.m2.2.2" xref="S2.SS2.p3.2.m2.2.2.cmml">ϵ</mi><mo id="S2.SS2.p3.2.m2.2.3.3.2.3" stretchy="false" xref="S2.SS2.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.2b"><apply id="S2.SS2.p3.2.m2.2.3.cmml" xref="S2.SS2.p3.2.m2.2.3"><times id="S2.SS2.p3.2.m2.2.3.1.cmml" xref="S2.SS2.p3.2.m2.2.3.1"></times><ci id="S2.SS2.p3.2.m2.2.3.2.cmml" xref="S2.SS2.p3.2.m2.2.3.2">ℬ</ci><interval closure="open" id="S2.SS2.p3.2.m2.2.3.3.1.cmml" xref="S2.SS2.p3.2.m2.2.3.3.2"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑥</ci><ci id="S2.SS2.p3.2.m2.2.2.cmml" xref="S2.SS2.p3.2.m2.2.2">italic-ϵ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.2c">\mathcal{B}(x,\epsilon)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.2d">caligraphic_B ( italic_x , italic_ϵ )</annotation></semantics></math> denotes the <math alttext="\ell_{\infty}" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.1"><semantics id="S2.SS2.p3.3.m3.1a"><msub id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" mathvariant="normal" xref="S2.SS2.p3.3.m3.1.1.2.cmml">ℓ</mi><mi id="S2.SS2.p3.3.m3.1.1.3" mathvariant="normal" xref="S2.SS2.p3.3.m3.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">ℓ</ci><infinity id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\ell_{\infty}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">roman_ℓ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math>-ball of radius <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m4.1"><semantics id="S2.SS2.p3.4.m4.1a"><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m4.1d">italic_ϵ</annotation></semantics></math> and <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S2.SS2.p3.5.m5.1"><semantics id="S2.SS2.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.5.m5.1d">caligraphic_L</annotation></semantics></math> the loss used to train the benign model <math alttext="f_{w}" class="ltx_Math" display="inline" id="S2.SS2.p3.6.m6.1"><semantics id="S2.SS2.p3.6.m6.1a"><msub id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml"><mi id="S2.SS2.p3.6.m6.1.1.2" xref="S2.SS2.p3.6.m6.1.1.2.cmml">f</mi><mi id="S2.SS2.p3.6.m6.1.1.3" xref="S2.SS2.p3.6.m6.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><apply id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.1.1.2.cmml" xref="S2.SS2.p3.6.m6.1.1.2">𝑓</ci><ci id="S2.SS2.p3.6.m6.1.1.3.cmml" xref="S2.SS2.p3.6.m6.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">f_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math>. In this study, we revisit functional similarity of robust and non-robust model through the lens of functional alignment.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Functional Latent Alignment (FuLA)</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.2">When evaluating functional similarity under model stitching, it is widely accepted that the family of transformations used to connect the two models, must be of low capacity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib25" title="">25</a>]</cite>, to ensure that it does not compensate for potential misalignment while solving the optimization objective. In our work, we expand upon this notion and argue that it is the synergy between the transformation family and the optimization objective that must adhere to the qualities expected of a functional similarity metric. Our view is that functional similarity should reflect the extent to which two models share their underlying functional properties when transforming input into output. In this regard, the existing model stitching settings, for functional similarity, do not account for (miss)alignment in the internal processes of the models, which can impair their reliability as metrics. To this end, we propose model stitching by FuLA where the stitched model is explicitly optimized for internal functional alignment in a task-agnostic manner. An overview of the method and its relation to existing stitching settings in provided in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.F2" title="Figure 2 ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">2</span></a>. In particular, under FuLA, the alignment transformation <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">T</mi><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑇</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> of the stitched model <math alttext="h=g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mrow id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">h</mi><mo id="S2.SS3.p1.2.m2.1.1.1" xref="S2.SS3.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml"><msub id="S2.SS3.p1.2.m2.1.1.3.2" xref="S2.SS3.p1.2.m2.1.1.3.2.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3.2.2" xref="S2.SS3.p1.2.m2.1.1.3.2.2.cmml">g</mi><mrow id="S2.SS3.p1.2.m2.1.1.3.2.3" xref="S2.SS3.p1.2.m2.1.1.3.2.3.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3.2.3.2" xref="S2.SS3.p1.2.m2.1.1.3.2.3.2.cmml"></mi><mo id="S2.SS3.p1.2.m2.1.1.3.2.3.1" xref="S2.SS3.p1.2.m2.1.1.3.2.3.1.cmml">&gt;</mo><mi id="S2.SS3.p1.2.m2.1.1.3.2.3.3" xref="S2.SS3.p1.2.m2.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS3.p1.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.2.m2.1.1.3.1.cmml">∘</mo><msub id="S2.SS3.p1.2.m2.1.1.3.3" xref="S2.SS3.p1.2.m2.1.1.3.3.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3.3.2" xref="S2.SS3.p1.2.m2.1.1.3.3.2.cmml">T</mi><mi id="S2.SS3.p1.2.m2.1.1.3.3.3" xref="S2.SS3.p1.2.m2.1.1.3.3.3.cmml">θ</mi></msub><mo id="S2.SS3.p1.2.m2.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.2.m2.1.1.3.1.cmml">∘</mo><msub id="S2.SS3.p1.2.m2.1.1.3.4" xref="S2.SS3.p1.2.m2.1.1.3.4.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3.4.2" xref="S2.SS3.p1.2.m2.1.1.3.4.2.cmml">f</mi><mrow id="S2.SS3.p1.2.m2.1.1.3.4.3" xref="S2.SS3.p1.2.m2.1.1.3.4.3.cmml"><mi id="S2.SS3.p1.2.m2.1.1.3.4.3.2" xref="S2.SS3.p1.2.m2.1.1.3.4.3.2.cmml"></mi><mo id="S2.SS3.p1.2.m2.1.1.3.4.3.1" xref="S2.SS3.p1.2.m2.1.1.3.4.3.1.cmml">≤</mo><mi id="S2.SS3.p1.2.m2.1.1.3.4.3.3" xref="S2.SS3.p1.2.m2.1.1.3.4.3.3.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><eq id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1"></eq><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">ℎ</ci><apply id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3"><compose id="S2.SS3.p1.2.m2.1.1.3.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.1"></compose><apply id="S2.SS3.p1.2.m2.1.1.3.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.3.2.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.3.2.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2.2">𝑔</ci><apply id="S2.SS3.p1.2.m2.1.1.3.2.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2.3"><gt id="S2.SS3.p1.2.m2.1.1.3.2.3.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2.3.1"></gt><csymbol cd="latexml" id="S2.SS3.p1.2.m2.1.1.3.2.3.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2.3.2">absent</csymbol><ci id="S2.SS3.p1.2.m2.1.1.3.2.3.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS3.p1.2.m2.1.1.3.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.3.2">𝑇</ci><ci id="S2.SS3.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.3.3">𝜃</ci></apply><apply id="S2.SS3.p1.2.m2.1.1.3.4.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.3.4.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.3.4.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4.2">𝑓</ci><apply id="S2.SS3.p1.2.m2.1.1.3.4.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4.3"><leq id="S2.SS3.p1.2.m2.1.1.3.4.3.1.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4.3.1"></leq><csymbol cd="latexml" id="S2.SS3.p1.2.m2.1.1.3.4.3.2.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4.3.2">absent</csymbol><ci id="S2.SS3.p1.2.m2.1.1.3.4.3.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3.4.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">h=g_{&gt;j}\circ T_{\theta}\circ f_{\leq i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_h = italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT ∘ italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is found as:</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x)}\left[C_{j}\underbrace{%
\frac{||\left(T_{\theta}\circ f_{\leq i}\right)(x)-g_{\leq j}(x)||_{F}}{||g_{%
\leq j}(x)||_{F}}}_{\text{$L^{j}_{\text{Hint}}$}}+\sum\limits_{l=j+1}^{k}C_{l}%
\underbrace{\frac{||g_{\leq l}(\left(T_{\theta}\circ f_{\leq i}\right)(x))-g_{%
\leq l}(x)||_{F}}{||g_{\leq l}(x)||_{F}}}_{\text{$L^{l}_{\text{Hint}}$}}\right]," class="ltx_Math" display="block" id="S2.E5.m1.14"><semantics id="S2.E5.m1.14a"><mrow id="S2.E5.m1.14.14.1" xref="S2.E5.m1.14.14.1.1.cmml"><mrow id="S2.E5.m1.14.14.1.1" xref="S2.E5.m1.14.14.1.1.cmml"><munder accentunder="true" id="S2.E5.m1.14.14.1.1.3" xref="S2.E5.m1.14.14.1.1.3.cmml"><mtext id="S2.E5.m1.14.14.1.1.3.2" xref="S2.E5.m1.14.14.1.1.3.2a.cmml">arg min</mtext><mo id="S2.E5.m1.14.14.1.1.3.1" xref="S2.E5.m1.14.14.1.1.3.1.cmml">𝜃</mo></munder><mo id="S2.E5.m1.14.14.1.1.2" lspace="0.170em" xref="S2.E5.m1.14.14.1.1.2.cmml">⁢</mo><msub id="S2.E5.m1.14.14.1.1.4" xref="S2.E5.m1.14.14.1.1.4.cmml"><mi id="S2.E5.m1.14.14.1.1.4.2" xref="S2.E5.m1.14.14.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E5.m1.3.3.1" xref="S2.E5.m1.3.3.1.cmml"><mi id="S2.E5.m1.3.3.1.3" xref="S2.E5.m1.3.3.1.3.cmml">p</mi><mo id="S2.E5.m1.3.3.1.2" xref="S2.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.4.2" xref="S2.E5.m1.3.3.1.cmml"><mo id="S2.E5.m1.3.3.1.4.2.1" stretchy="false" xref="S2.E5.m1.3.3.1.cmml">(</mo><mi id="S2.E5.m1.3.3.1.1" xref="S2.E5.m1.3.3.1.1.cmml">x</mi><mo id="S2.E5.m1.3.3.1.4.2.2" stretchy="false" xref="S2.E5.m1.3.3.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E5.m1.14.14.1.1.2a" xref="S2.E5.m1.14.14.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.14.14.1.1.1.1" xref="S2.E5.m1.14.14.1.1.1.2.cmml"><mo id="S2.E5.m1.14.14.1.1.1.1.2" xref="S2.E5.m1.14.14.1.1.1.2.1.cmml">[</mo><mrow id="S2.E5.m1.14.14.1.1.1.1.1" xref="S2.E5.m1.14.14.1.1.1.1.1.cmml"><mrow id="S2.E5.m1.14.14.1.1.1.1.1.2" xref="S2.E5.m1.14.14.1.1.1.1.1.2.cmml"><msub id="S2.E5.m1.14.14.1.1.1.1.1.2.2" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2.cmml"><mi id="S2.E5.m1.14.14.1.1.1.1.1.2.2.2" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2.2.cmml">C</mi><mi id="S2.E5.m1.14.14.1.1.1.1.1.2.2.3" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S2.E5.m1.14.14.1.1.1.1.1.2.1" xref="S2.E5.m1.14.14.1.1.1.1.1.2.1.cmml">⁢</mo><munder id="S2.E5.m1.14.14.1.1.1.1.1.2.3" xref="S2.E5.m1.14.14.1.1.1.1.1.2.3.cmml"><munder accentunder="true" id="S2.E5.m1.8.8" xref="S2.E5.m1.8.8.cmml"><mfrac id="S2.E5.m1.8.8.5" xref="S2.E5.m1.8.8.5.cmml"><msub id="S2.E5.m1.6.6.3.3.3" xref="S2.E5.m1.6.6.3.3.3.cmml"><mrow id="S2.E5.m1.6.6.3.3.3.3.1" xref="S2.E5.m1.6.6.3.3.3.3.2.cmml"><mo id="S2.E5.m1.6.6.3.3.3.3.1.2" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.2.1.cmml">‖</mo><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.cmml"><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.cmml"><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.1.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.cmml"><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.cmml">(</mo><mi id="S2.E5.m1.4.4.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.cmml">x</mi><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.2.cmml">−</mo><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.cmml"><msub id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.cmml"><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.2.cmml">g</mi><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.cmml"><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.2.cmml"></mi><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.1.cmml">≤</mo><mi id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.3" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.3.1" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S2.E5.m1.6.6.3.3.3.3.1.1.3.3.2" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.cmml"><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.3.3.2.1" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.cmml">(</mo><mi id="S2.E5.m1.5.5.2.2.2.2" xref="S2.E5.m1.5.5.2.2.2.2.cmml">x</mi><mo id="S2.E5.m1.6.6.3.3.3.3.1.1.3.3.2.2" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.6.6.3.3.3.3.1.3" stretchy="false" xref="S2.E5.m1.6.6.3.3.3.3.2.1.cmml">‖</mo></mrow><mi id="S2.E5.m1.6.6.3.3.3.5" xref="S2.E5.m1.6.6.3.3.3.5.cmml">F</mi></msub><msub id="S2.E5.m1.8.8.5.5.5" xref="S2.E5.m1.8.8.5.5.5.cmml"><mrow id="S2.E5.m1.8.8.5.5.5.2.1" xref="S2.E5.m1.8.8.5.5.5.2.2.cmml"><mo id="S2.E5.m1.8.8.5.5.5.2.1.2" stretchy="false" xref="S2.E5.m1.8.8.5.5.5.2.2.1.cmml">‖</mo><mrow id="S2.E5.m1.8.8.5.5.5.2.1.1" xref="S2.E5.m1.8.8.5.5.5.2.1.1.cmml"><msub id="S2.E5.m1.8.8.5.5.5.2.1.1.2" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.cmml"><mi id="S2.E5.m1.8.8.5.5.5.2.1.1.2.2" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.2.cmml">g</mi><mrow id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.cmml"><mi id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.2" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.2.cmml"></mi><mo id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.1" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.1.cmml">≤</mo><mi id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.3" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E5.m1.8.8.5.5.5.2.1.1.1" xref="S2.E5.m1.8.8.5.5.5.2.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.8.8.5.5.5.2.1.1.3.2" xref="S2.E5.m1.8.8.5.5.5.2.1.1.cmml"><mo id="S2.E5.m1.8.8.5.5.5.2.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.8.8.5.5.5.2.1.1.cmml">(</mo><mi id="S2.E5.m1.7.7.4.4.4.1" xref="S2.E5.m1.7.7.4.4.4.1.cmml">x</mi><mo id="S2.E5.m1.8.8.5.5.5.2.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.8.8.5.5.5.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.8.8.5.5.5.2.1.3" stretchy="false" xref="S2.E5.m1.8.8.5.5.5.2.2.1.cmml">‖</mo></mrow><mi id="S2.E5.m1.8.8.5.5.5.4" xref="S2.E5.m1.8.8.5.5.5.4.cmml">F</mi></msub></mfrac><mo id="S2.E5.m1.8.8.6" xref="S2.E5.m1.8.8.6.cmml">⏟</mo></munder><msubsup id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.3.2.cmml">L</mi><mtext id="S2.E5.m1.1.1.1.4" mathsize="98%" xref="S2.E5.m1.1.1.1.4a.cmml">Hint</mtext><mi id="S2.E5.m1.1.1.1.3.3" mathsize="98%" xref="S2.E5.m1.1.1.1.3.3.cmml">j</mi></msubsup></munder></mrow><mo id="S2.E5.m1.14.14.1.1.1.1.1.1" rspace="0.055em" xref="S2.E5.m1.14.14.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E5.m1.14.14.1.1.1.1.1.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.cmml"><munderover id="S2.E5.m1.14.14.1.1.1.1.1.3.1" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.cmml"><mo id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.2" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.2.cmml">l</mi><mo id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.1" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mrow id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.cmml"><mi id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.2" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.2.cmml">j</mi><mo id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.1" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.1.cmml">+</mo><mn id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.E5.m1.14.14.1.1.1.1.1.3.1.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.3.cmml">k</mi></munderover><mrow id="S2.E5.m1.14.14.1.1.1.1.1.3.2" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.cmml"><msub id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.2" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.2.cmml">C</mi><mi id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.3.cmml">l</mi></msub><mo id="S2.E5.m1.14.14.1.1.1.1.1.3.2.1" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.1.cmml">⁢</mo><munder id="S2.E5.m1.14.14.1.1.1.1.1.3.2.3" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.3.cmml"><munder accentunder="true" id="S2.E5.m1.13.13" xref="S2.E5.m1.13.13.cmml"><mfrac id="S2.E5.m1.13.13.5" xref="S2.E5.m1.13.13.5.cmml"><msub id="S2.E5.m1.11.11.3.3.3" xref="S2.E5.m1.11.11.3.3.3.cmml"><mrow id="S2.E5.m1.11.11.3.3.3.3.1" xref="S2.E5.m1.11.11.3.3.3.3.2.cmml"><mo id="S2.E5.m1.11.11.3.3.3.3.1.2" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.2.1.cmml">‖</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.cmml"><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.cmml"><msub id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.2.cmml">g</mi><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.2.cmml"></mi><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.1.cmml">≤</mo><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.3.cmml">l</mi></mrow></msub><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">≤</mo><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.9.9.1.1.1.1" xref="S2.E5.m1.9.9.1.1.1.1.cmml">x</mi><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.2.cmml">−</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.cmml"><msub id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.2.cmml">g</mi><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.cmml"><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.2.cmml"></mi><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.1.cmml">≤</mo><mi id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.3" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.3.cmml">l</mi></mrow></msub><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.3.1" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S2.E5.m1.11.11.3.3.3.3.1.1.3.3.2" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.cmml"><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.3.3.2.1" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.cmml">(</mo><mi id="S2.E5.m1.10.10.2.2.2.2" xref="S2.E5.m1.10.10.2.2.2.2.cmml">x</mi><mo id="S2.E5.m1.11.11.3.3.3.3.1.1.3.3.2.2" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.11.11.3.3.3.3.1.3" stretchy="false" xref="S2.E5.m1.11.11.3.3.3.3.2.1.cmml">‖</mo></mrow><mi id="S2.E5.m1.11.11.3.3.3.5" xref="S2.E5.m1.11.11.3.3.3.5.cmml">F</mi></msub><msub id="S2.E5.m1.13.13.5.5.5" xref="S2.E5.m1.13.13.5.5.5.cmml"><mrow id="S2.E5.m1.13.13.5.5.5.2.1" xref="S2.E5.m1.13.13.5.5.5.2.2.cmml"><mo id="S2.E5.m1.13.13.5.5.5.2.1.2" stretchy="false" xref="S2.E5.m1.13.13.5.5.5.2.2.1.cmml">‖</mo><mrow id="S2.E5.m1.13.13.5.5.5.2.1.1" xref="S2.E5.m1.13.13.5.5.5.2.1.1.cmml"><msub id="S2.E5.m1.13.13.5.5.5.2.1.1.2" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.cmml"><mi id="S2.E5.m1.13.13.5.5.5.2.1.1.2.2" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.2.cmml">g</mi><mrow id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.cmml"><mi id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.2" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.2.cmml"></mi><mo id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.1" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.1.cmml">≤</mo><mi id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.3" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.3.cmml">l</mi></mrow></msub><mo id="S2.E5.m1.13.13.5.5.5.2.1.1.1" xref="S2.E5.m1.13.13.5.5.5.2.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.13.13.5.5.5.2.1.1.3.2" xref="S2.E5.m1.13.13.5.5.5.2.1.1.cmml"><mo id="S2.E5.m1.13.13.5.5.5.2.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.13.13.5.5.5.2.1.1.cmml">(</mo><mi id="S2.E5.m1.12.12.4.4.4.1" xref="S2.E5.m1.12.12.4.4.4.1.cmml">x</mi><mo id="S2.E5.m1.13.13.5.5.5.2.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.13.13.5.5.5.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.13.13.5.5.5.2.1.3" stretchy="false" xref="S2.E5.m1.13.13.5.5.5.2.2.1.cmml">‖</mo></mrow><mi id="S2.E5.m1.13.13.5.5.5.4" xref="S2.E5.m1.13.13.5.5.5.4.cmml">F</mi></msub></mfrac><mo id="S2.E5.m1.13.13.6" xref="S2.E5.m1.13.13.6.cmml">⏟</mo></munder><msubsup id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.3.2" xref="S2.E5.m1.2.2.1.3.2.cmml">L</mi><mtext id="S2.E5.m1.2.2.1.4" mathsize="98%" xref="S2.E5.m1.2.2.1.4a.cmml">Hint</mtext><mi id="S2.E5.m1.2.2.1.3.3" mathsize="98%" xref="S2.E5.m1.2.2.1.3.3.cmml">l</mi></msubsup></munder></mrow></mrow></mrow><mo id="S2.E5.m1.14.14.1.1.1.1.3" xref="S2.E5.m1.14.14.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E5.m1.14.14.1.2" xref="S2.E5.m1.14.14.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.14b"><apply id="S2.E5.m1.14.14.1.1.cmml" xref="S2.E5.m1.14.14.1"><times id="S2.E5.m1.14.14.1.1.2.cmml" xref="S2.E5.m1.14.14.1.1.2"></times><apply id="S2.E5.m1.14.14.1.1.3.cmml" xref="S2.E5.m1.14.14.1.1.3"><ci id="S2.E5.m1.14.14.1.1.3.1.cmml" xref="S2.E5.m1.14.14.1.1.3.1">𝜃</ci><ci id="S2.E5.m1.14.14.1.1.3.2a.cmml" xref="S2.E5.m1.14.14.1.1.3.2"><mtext id="S2.E5.m1.14.14.1.1.3.2.cmml" xref="S2.E5.m1.14.14.1.1.3.2">arg min</mtext></ci></apply><apply id="S2.E5.m1.14.14.1.1.4.cmml" xref="S2.E5.m1.14.14.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.4.1.cmml" xref="S2.E5.m1.14.14.1.1.4">subscript</csymbol><ci id="S2.E5.m1.14.14.1.1.4.2.cmml" xref="S2.E5.m1.14.14.1.1.4.2">𝔼</ci><apply id="S2.E5.m1.3.3.1.cmml" xref="S2.E5.m1.3.3.1"><times id="S2.E5.m1.3.3.1.2.cmml" xref="S2.E5.m1.3.3.1.2"></times><ci id="S2.E5.m1.3.3.1.3.cmml" xref="S2.E5.m1.3.3.1.3">𝑝</ci><ci id="S2.E5.m1.3.3.1.1.cmml" xref="S2.E5.m1.3.3.1.1">𝑥</ci></apply></apply><apply id="S2.E5.m1.14.14.1.1.1.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.14.14.1.1.1.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5.m1.14.14.1.1.1.1.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1"><plus id="S2.E5.m1.14.14.1.1.1.1.1.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.1"></plus><apply id="S2.E5.m1.14.14.1.1.1.1.1.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2"><times id="S2.E5.m1.14.14.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.1"></times><apply id="S2.E5.m1.14.14.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.2.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E5.m1.14.14.1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2.2">𝐶</ci><ci id="S2.E5.m1.14.14.1.1.1.1.1.2.2.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.E5.m1.14.14.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.2.3.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.2.3">subscript</csymbol><apply id="S2.E5.m1.8.8.cmml" xref="S2.E5.m1.8.8"><ci id="S2.E5.m1.8.8.6.cmml" xref="S2.E5.m1.8.8.6">⏟</ci><apply id="S2.E5.m1.8.8.5.cmml" xref="S2.E5.m1.8.8.5"><divide id="S2.E5.m1.8.8.5.6.cmml" xref="S2.E5.m1.8.8.5"></divide><apply id="S2.E5.m1.6.6.3.3.3.cmml" xref="S2.E5.m1.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.3.3.3.4.cmml" xref="S2.E5.m1.6.6.3.3.3">subscript</csymbol><apply id="S2.E5.m1.6.6.3.3.3.3.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1"><csymbol cd="latexml" id="S2.E5.m1.6.6.3.3.3.3.2.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.2">norm</csymbol><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1"><minus id="S2.E5.m1.6.6.3.3.3.3.1.1.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.2"></minus><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1"><times id="S2.E5.m1.6.6.3.3.3.3.1.1.1.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.2"></times><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1"><compose id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.1"></compose><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3"><leq id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E5.m1.4.4.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1">𝑥</ci></apply><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3"><times id="S2.E5.m1.6.6.3.3.3.3.1.1.3.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.1"></times><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.2">𝑔</ci><apply id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3"><leq id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.1.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.2.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.2">absent</csymbol><ci id="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.3.cmml" xref="S2.E5.m1.6.6.3.3.3.3.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E5.m1.5.5.2.2.2.2.cmml" xref="S2.E5.m1.5.5.2.2.2.2">𝑥</ci></apply></apply></apply><ci id="S2.E5.m1.6.6.3.3.3.5.cmml" xref="S2.E5.m1.6.6.3.3.3.5">𝐹</ci></apply><apply id="S2.E5.m1.8.8.5.5.5.cmml" xref="S2.E5.m1.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.E5.m1.8.8.5.5.5.3.cmml" xref="S2.E5.m1.8.8.5.5.5">subscript</csymbol><apply id="S2.E5.m1.8.8.5.5.5.2.2.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1"><csymbol cd="latexml" id="S2.E5.m1.8.8.5.5.5.2.2.1.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.2">norm</csymbol><apply id="S2.E5.m1.8.8.5.5.5.2.1.1.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1"><times id="S2.E5.m1.8.8.5.5.5.2.1.1.1.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.1"></times><apply id="S2.E5.m1.8.8.5.5.5.2.1.1.2.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.8.8.5.5.5.2.1.1.2.1.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2">subscript</csymbol><ci id="S2.E5.m1.8.8.5.5.5.2.1.1.2.2.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.2">𝑔</ci><apply id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3"><leq id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.1.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.2.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.2">absent</csymbol><ci id="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.3.cmml" xref="S2.E5.m1.8.8.5.5.5.2.1.1.2.3.3">𝑗</ci></apply></apply><ci id="S2.E5.m1.7.7.4.4.4.1.cmml" xref="S2.E5.m1.7.7.4.4.4.1">𝑥</ci></apply></apply><ci id="S2.E5.m1.8.8.5.5.5.4.cmml" xref="S2.E5.m1.8.8.5.5.5.4">𝐹</ci></apply></apply></apply><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1">subscript</csymbol><apply id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1">superscript</csymbol><ci id="S2.E5.m1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.3.2">𝐿</ci><ci id="S2.E5.m1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.3.3">𝑗</ci></apply><ci id="S2.E5.m1.1.1.1.4a.cmml" xref="S2.E5.m1.1.1.1.4"><mtext id="S2.E5.m1.1.1.1.4.cmml" mathsize="49%" xref="S2.E5.m1.1.1.1.4">Hint</mtext></ci></apply></apply></apply><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3"><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.3.1.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.2"></sum><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3"><eq id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.2">𝑙</ci><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3"><plus id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.1"></plus><ci id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.2">𝑗</ci><cn id="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.3.cmml" type="integer" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.E5.m1.14.14.1.1.1.1.1.3.1.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.1.3">𝑘</ci></apply><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2"><times id="S2.E5.m1.14.14.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.1"></times><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.2">𝐶</ci><ci id="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.2.3">𝑙</ci></apply><apply id="S2.E5.m1.14.14.1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.14.14.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E5.m1.14.14.1.1.1.1.1.3.2.3">subscript</csymbol><apply id="S2.E5.m1.13.13.cmml" xref="S2.E5.m1.13.13"><ci id="S2.E5.m1.13.13.6.cmml" xref="S2.E5.m1.13.13.6">⏟</ci><apply id="S2.E5.m1.13.13.5.cmml" xref="S2.E5.m1.13.13.5"><divide id="S2.E5.m1.13.13.5.6.cmml" xref="S2.E5.m1.13.13.5"></divide><apply id="S2.E5.m1.11.11.3.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.11.11.3.3.3.4.cmml" xref="S2.E5.m1.11.11.3.3.3">subscript</csymbol><apply id="S2.E5.m1.11.11.3.3.3.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1"><csymbol cd="latexml" id="S2.E5.m1.11.11.3.3.3.3.2.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.2">norm</csymbol><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1"><minus id="S2.E5.m1.11.11.3.3.3.3.1.1.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.2"></minus><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1"><times id="S2.E5.m1.11.11.3.3.3.3.1.1.1.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.2"></times><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.2">𝑔</ci><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3"><leq id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.2">absent</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.3.3.3">𝑙</ci></apply></apply><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1"><times id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1"><compose id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.1"></compose><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3"><leq id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E5.m1.9.9.1.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1">𝑥</ci></apply></apply><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3"><times id="S2.E5.m1.11.11.3.3.3.3.1.1.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.1"></times><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.2">𝑔</ci><apply id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3"><leq id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.1.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.2.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.2">absent</csymbol><ci id="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.3.cmml" xref="S2.E5.m1.11.11.3.3.3.3.1.1.3.2.3.3">𝑙</ci></apply></apply><ci id="S2.E5.m1.10.10.2.2.2.2.cmml" xref="S2.E5.m1.10.10.2.2.2.2">𝑥</ci></apply></apply></apply><ci id="S2.E5.m1.11.11.3.3.3.5.cmml" xref="S2.E5.m1.11.11.3.3.3.5">𝐹</ci></apply><apply id="S2.E5.m1.13.13.5.5.5.cmml" xref="S2.E5.m1.13.13.5.5.5"><csymbol cd="ambiguous" id="S2.E5.m1.13.13.5.5.5.3.cmml" xref="S2.E5.m1.13.13.5.5.5">subscript</csymbol><apply id="S2.E5.m1.13.13.5.5.5.2.2.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1"><csymbol cd="latexml" id="S2.E5.m1.13.13.5.5.5.2.2.1.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.2">norm</csymbol><apply id="S2.E5.m1.13.13.5.5.5.2.1.1.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1"><times id="S2.E5.m1.13.13.5.5.5.2.1.1.1.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.1"></times><apply id="S2.E5.m1.13.13.5.5.5.2.1.1.2.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.13.13.5.5.5.2.1.1.2.1.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2">subscript</csymbol><ci id="S2.E5.m1.13.13.5.5.5.2.1.1.2.2.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.2">𝑔</ci><apply id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3"><leq id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.1.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.1"></leq><csymbol cd="latexml" id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.2.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.2">absent</csymbol><ci id="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.3.cmml" xref="S2.E5.m1.13.13.5.5.5.2.1.1.2.3.3">𝑙</ci></apply></apply><ci id="S2.E5.m1.12.12.4.4.4.1.cmml" xref="S2.E5.m1.12.12.4.4.4.1">𝑥</ci></apply></apply><ci id="S2.E5.m1.13.13.5.5.5.4.cmml" xref="S2.E5.m1.13.13.5.5.5.4">𝐹</ci></apply></apply></apply><apply id="S2.E5.m1.2.2.1.cmml" xref="S2.E5.m1.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1">subscript</csymbol><apply id="S2.E5.m1.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.3.1.cmml" xref="S2.E5.m1.2.2.1">superscript</csymbol><ci id="S2.E5.m1.2.2.1.3.2.cmml" xref="S2.E5.m1.2.2.1.3.2">𝐿</ci><ci id="S2.E5.m1.2.2.1.3.3.cmml" xref="S2.E5.m1.2.2.1.3.3">𝑙</ci></apply><ci id="S2.E5.m1.2.2.1.4a.cmml" xref="S2.E5.m1.2.2.1.4"><mtext id="S2.E5.m1.2.2.1.4.cmml" mathsize="49%" xref="S2.E5.m1.2.2.1.4">Hint</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.14c">\underset{\theta}{\text{arg min}}\,\mathbb{E}_{p(x)}\left[C_{j}\underbrace{%
\frac{||\left(T_{\theta}\circ f_{\leq i}\right)(x)-g_{\leq j}(x)||_{F}}{||g_{%
\leq j}(x)||_{F}}}_{\text{$L^{j}_{\text{Hint}}$}}+\sum\limits_{l=j+1}^{k}C_{l}%
\underbrace{\frac{||g_{\leq l}(\left(T_{\theta}\circ f_{\leq i}\right)(x))-g_{%
\leq l}(x)||_{F}}{||g_{\leq l}(x)||_{F}}}_{\text{$L^{l}_{\text{Hint}}$}}\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.14d">underitalic_θ start_ARG arg min end_ARG blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x ) end_POSTSUBSCRIPT [ italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT under⏟ start_ARG divide start_ARG | | ( italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT ) ( italic_x ) - italic_g start_POSTSUBSCRIPT ≤ italic_j end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG start_ARG | | italic_g start_POSTSUBSCRIPT ≤ italic_j end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG end_ARG start_POSTSUBSCRIPT italic_L start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hint end_POSTSUBSCRIPT end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_l = italic_j + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT under⏟ start_ARG divide start_ARG | | italic_g start_POSTSUBSCRIPT ≤ italic_l end_POSTSUBSCRIPT ( ( italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∘ italic_f start_POSTSUBSCRIPT ≤ italic_i end_POSTSUBSCRIPT ) ( italic_x ) ) - italic_g start_POSTSUBSCRIPT ≤ italic_l end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG start_ARG | | italic_g start_POSTSUBSCRIPT ≤ italic_l end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT end_ARG end_ARG start_POSTSUBSCRIPT italic_L start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hint end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.13">where <math alttext="C\in\{c\in\mathbb{R}^{k+1-j}:c_{l}\geq 0,\sum\limits_{l=1}^{k+1-j}c_{l}=1\}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.2"><semantics id="S2.SS3.p3.1.m1.2a"><mrow id="S2.SS3.p3.1.m1.2.2" xref="S2.SS3.p3.1.m1.2.2.cmml"><mi id="S2.SS3.p3.1.m1.2.2.4" xref="S2.SS3.p3.1.m1.2.2.4.cmml">C</mi><mo id="S2.SS3.p3.1.m1.2.2.3" xref="S2.SS3.p3.1.m1.2.2.3.cmml">∈</mo><mrow id="S2.SS3.p3.1.m1.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.3.cmml"><mo id="S2.SS3.p3.1.m1.2.2.2.2.3" stretchy="false" xref="S2.SS3.p3.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S2.SS3.p3.1.m1.1.1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.SS3.p3.1.m1.1.1.1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p3.1.m1.1.1.1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p3.1.m1.1.1.1.1.1.3.2" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.cmml"><mrow id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.cmml"><mi id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.2" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.2.cmml">k</mi><mo id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.1" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.1.cmml">+</mo><mn id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.3" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.3.cmml">1</mn></mrow><mo id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.1" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.3" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msup></mrow><mo id="S2.SS3.p3.1.m1.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S2.SS3.p3.1.m1.2.2.2.3.1.cmml">:</mo><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.3.cmml"><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.cmml"><msub id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.cmml"><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.2.cmml">c</mi><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.3.cmml">l</mi></msub><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.1.cmml">≥</mo><mn id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.3.cmml">0</mn></mrow><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.3" rspace="0em" xref="S2.SS3.p3.1.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.cmml"><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.cmml"><munderover id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.cmml"><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.2" movablelimits="false" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.2.cmml">∑</mo><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.cmml"><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.2.cmml">l</mi><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.1.cmml">=</mo><mn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.cmml"><mrow id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.cmml"><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.2.cmml">k</mi><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.1.cmml">+</mo><mn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.3.cmml">1</mn></mrow><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.1.cmml">−</mo><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.3.cmml">j</mi></mrow></munderover><msub id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.2" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.2.cmml">c</mi><mi id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.3.cmml">l</mi></msub></mrow><mo id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.1" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.3" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.3.cmml">1</mn></mrow></mrow><mo id="S2.SS3.p3.1.m1.2.2.2.2.5" stretchy="false" xref="S2.SS3.p3.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.2b"><apply id="S2.SS3.p3.1.m1.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2"><in id="S2.SS3.p3.1.m1.2.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.3"></in><ci id="S2.SS3.p3.1.m1.2.2.4.cmml" xref="S2.SS3.p3.1.m1.2.2.4">𝐶</ci><apply id="S2.SS3.p3.1.m1.2.2.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2"><csymbol cd="latexml" id="S2.SS3.p3.1.m1.2.2.2.3.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S2.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1"><in id="S2.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.1"></in><ci id="S2.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.2">𝑐</ci><apply id="S2.SS3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.2">ℝ</ci><apply id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3"><minus id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.1"></minus><apply id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2"><plus id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.1"></plus><ci id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.2">𝑘</ci><cn id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.2.3">1</cn></apply><ci id="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.2.2.2.3a.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1"><geq id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.1"></geq><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.2">𝑐</ci><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.2.3">𝑙</ci></apply><cn id="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.2.2.2.2.2.1.1.3">0</cn></apply><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2"><eq id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.1"></eq><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2"><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1">superscript</csymbol><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1">subscript</csymbol><sum id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.2"></sum><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3"><eq id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.1"></eq><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.2">𝑙</ci><cn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.2.3.3">1</cn></apply></apply><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3"><minus id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.1"></minus><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2"><plus id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.1"></plus><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.2">𝑘</ci><cn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.2.3">1</cn></apply><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.1.3.3">𝑗</ci></apply></apply><apply id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.2">𝑐</ci><ci id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.2.2.3">𝑙</ci></apply></apply><cn id="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.2.2.2.2.2.2.2.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.2c">C\in\{c\in\mathbb{R}^{k+1-j}:c_{l}\geq 0,\sum\limits_{l=1}^{k+1-j}c_{l}=1\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.2d">italic_C ∈ { italic_c ∈ blackboard_R start_POSTSUPERSCRIPT italic_k + 1 - italic_j end_POSTSUPERSCRIPT : italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ≥ 0 , ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k + 1 - italic_j end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = 1 }</annotation></semantics></math> defines a weighted average that controls the relative contribution of each term. We use uniform weighting as the default option. Additionally, we divide by the target’s norm to account for potential differences in scale between feature activations at different depths. We refer to these terms as Hints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib39" title="">39</a>]</cite>, denoted as <math alttext="L^{t}_{\text{Hint}}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><msubsup id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2.2" xref="S2.SS3.p3.2.m2.1.1.2.2.cmml">L</mi><mtext id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3a.cmml">Hint</mtext><mi id="S2.SS3.p3.2.m2.1.1.2.3" xref="S2.SS3.p3.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.2.1.cmml" xref="S2.SS3.p3.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.2.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2.2">𝐿</ci><ci id="S2.SS3.p3.2.m2.1.1.2.3.cmml" xref="S2.SS3.p3.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p3.2.m2.1.1.3a.cmml" xref="S2.SS3.p3.2.m2.1.1.3"><mtext id="S2.SS3.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.2.m2.1.1.3">Hint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">L^{t}_{\text{Hint}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_L start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hint end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><mi id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_t</annotation></semantics></math> indicates the depth. Note that for <math alttext="t=j" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><mrow id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">t</mi><mo id="S2.SS3.p3.4.m4.1.1.1" xref="S2.SS3.p3.4.m4.1.1.1.cmml">=</mo><mi id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><eq id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1.1"></eq><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">𝑡</ci><ci id="S2.SS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">t=j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_t = italic_j</annotation></semantics></math>, the structural Hint <math alttext="L^{j}_{\text{Hint}}" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m5.1"><semantics id="S2.SS3.p3.5.m5.1a"><msubsup id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml"><mi id="S2.SS3.p3.5.m5.1.1.2.2" xref="S2.SS3.p3.5.m5.1.1.2.2.cmml">L</mi><mtext id="S2.SS3.p3.5.m5.1.1.3" xref="S2.SS3.p3.5.m5.1.1.3a.cmml">Hint</mtext><mi id="S2.SS3.p3.5.m5.1.1.2.3" xref="S2.SS3.p3.5.m5.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><apply id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m5.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1">subscript</csymbol><apply id="S2.SS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m5.1.1.2.1.cmml" xref="S2.SS3.p3.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.p3.5.m5.1.1.2.2.cmml" xref="S2.SS3.p3.5.m5.1.1.2.2">𝐿</ci><ci id="S2.SS3.p3.5.m5.1.1.2.3.cmml" xref="S2.SS3.p3.5.m5.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.p3.5.m5.1.1.3a.cmml" xref="S2.SS3.p3.5.m5.1.1.3"><mtext id="S2.SS3.p3.5.m5.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.5.m5.1.1.3">Hint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">L^{j}_{\text{Hint}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m5.1d">italic_L start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hint end_POSTSUBSCRIPT</annotation></semantics></math> corresponds (up to scale) to the direct matching objective defined in Eq (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E3" title="In 2.1 Notation ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>), while the functional Hints <math alttext="L^{l}_{\text{Hint}}" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m6.1"><semantics id="S2.SS3.p3.6.m6.1a"><msubsup id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml"><mi id="S2.SS3.p3.6.m6.1.1.2.2" xref="S2.SS3.p3.6.m6.1.1.2.2.cmml">L</mi><mtext id="S2.SS3.p3.6.m6.1.1.3" xref="S2.SS3.p3.6.m6.1.1.3a.cmml">Hint</mtext><mi id="S2.SS3.p3.6.m6.1.1.2.3" xref="S2.SS3.p3.6.m6.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><apply id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m6.1.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">subscript</csymbol><apply id="S2.SS3.p3.6.m6.1.1.2.cmml" xref="S2.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m6.1.1.2.1.cmml" xref="S2.SS3.p3.6.m6.1.1">superscript</csymbol><ci id="S2.SS3.p3.6.m6.1.1.2.2.cmml" xref="S2.SS3.p3.6.m6.1.1.2.2">𝐿</ci><ci id="S2.SS3.p3.6.m6.1.1.2.3.cmml" xref="S2.SS3.p3.6.m6.1.1.2.3">𝑙</ci></apply><ci id="S2.SS3.p3.6.m6.1.1.3a.cmml" xref="S2.SS3.p3.6.m6.1.1.3"><mtext id="S2.SS3.p3.6.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.6.m6.1.1.3">Hint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">L^{l}_{\text{Hint}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m6.1d">italic_L start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Hint end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="t=l\geq j+1" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m7.1"><semantics id="S2.SS3.p3.7.m7.1a"><mrow id="S2.SS3.p3.7.m7.1.1" xref="S2.SS3.p3.7.m7.1.1.cmml"><mi id="S2.SS3.p3.7.m7.1.1.2" xref="S2.SS3.p3.7.m7.1.1.2.cmml">t</mi><mo id="S2.SS3.p3.7.m7.1.1.3" xref="S2.SS3.p3.7.m7.1.1.3.cmml">=</mo><mi id="S2.SS3.p3.7.m7.1.1.4" xref="S2.SS3.p3.7.m7.1.1.4.cmml">l</mi><mo id="S2.SS3.p3.7.m7.1.1.5" xref="S2.SS3.p3.7.m7.1.1.5.cmml">≥</mo><mrow id="S2.SS3.p3.7.m7.1.1.6" xref="S2.SS3.p3.7.m7.1.1.6.cmml"><mi id="S2.SS3.p3.7.m7.1.1.6.2" xref="S2.SS3.p3.7.m7.1.1.6.2.cmml">j</mi><mo id="S2.SS3.p3.7.m7.1.1.6.1" xref="S2.SS3.p3.7.m7.1.1.6.1.cmml">+</mo><mn id="S2.SS3.p3.7.m7.1.1.6.3" xref="S2.SS3.p3.7.m7.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m7.1b"><apply id="S2.SS3.p3.7.m7.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1"><and id="S2.SS3.p3.7.m7.1.1a.cmml" xref="S2.SS3.p3.7.m7.1.1"></and><apply id="S2.SS3.p3.7.m7.1.1b.cmml" xref="S2.SS3.p3.7.m7.1.1"><eq id="S2.SS3.p3.7.m7.1.1.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3"></eq><ci id="S2.SS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2">𝑡</ci><ci id="S2.SS3.p3.7.m7.1.1.4.cmml" xref="S2.SS3.p3.7.m7.1.1.4">𝑙</ci></apply><apply id="S2.SS3.p3.7.m7.1.1c.cmml" xref="S2.SS3.p3.7.m7.1.1"><geq id="S2.SS3.p3.7.m7.1.1.5.cmml" xref="S2.SS3.p3.7.m7.1.1.5"></geq><share href="https://arxiv.org/html/2505.20142v1#S2.SS3.p3.7.m7.1.1.4.cmml" id="S2.SS3.p3.7.m7.1.1d.cmml" xref="S2.SS3.p3.7.m7.1.1"></share><apply id="S2.SS3.p3.7.m7.1.1.6.cmml" xref="S2.SS3.p3.7.m7.1.1.6"><plus id="S2.SS3.p3.7.m7.1.1.6.1.cmml" xref="S2.SS3.p3.7.m7.1.1.6.1"></plus><ci id="S2.SS3.p3.7.m7.1.1.6.2.cmml" xref="S2.SS3.p3.7.m7.1.1.6.2">𝑗</ci><cn id="S2.SS3.p3.7.m7.1.1.6.3.cmml" type="integer" xref="S2.SS3.p3.7.m7.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m7.1c">t=l\geq j+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m7.1d">italic_t = italic_l ≥ italic_j + 1</annotation></semantics></math> realize function alignment. Namely, the transformation <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p3.8.m8.1"><semantics id="S2.SS3.p3.8.m8.1a"><msub id="S2.SS3.p3.8.m8.1.1" xref="S2.SS3.p3.8.m8.1.1.cmml"><mi id="S2.SS3.p3.8.m8.1.1.2" xref="S2.SS3.p3.8.m8.1.1.2.cmml">T</mi><mi id="S2.SS3.p3.8.m8.1.1.3" xref="S2.SS3.p3.8.m8.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m8.1b"><apply id="S2.SS3.p3.8.m8.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m8.1.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p3.8.m8.1.1.2.cmml" xref="S2.SS3.p3.8.m8.1.1.2">𝑇</ci><ci id="S2.SS3.p3.8.m8.1.1.3.cmml" xref="S2.SS3.p3.8.m8.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m8.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.8.m8.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is trained to map the <math alttext="A_{f,i}" class="ltx_Math" display="inline" id="S2.SS3.p3.9.m9.2"><semantics id="S2.SS3.p3.9.m9.2a"><msub id="S2.SS3.p3.9.m9.2.3" xref="S2.SS3.p3.9.m9.2.3.cmml"><mi id="S2.SS3.p3.9.m9.2.3.2" xref="S2.SS3.p3.9.m9.2.3.2.cmml">A</mi><mrow id="S2.SS3.p3.9.m9.2.2.2.4" xref="S2.SS3.p3.9.m9.2.2.2.3.cmml"><mi id="S2.SS3.p3.9.m9.1.1.1.1" xref="S2.SS3.p3.9.m9.1.1.1.1.cmml">f</mi><mo id="S2.SS3.p3.9.m9.2.2.2.4.1" xref="S2.SS3.p3.9.m9.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p3.9.m9.2.2.2.2" xref="S2.SS3.p3.9.m9.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m9.2b"><apply id="S2.SS3.p3.9.m9.2.3.cmml" xref="S2.SS3.p3.9.m9.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.9.m9.2.3.1.cmml" xref="S2.SS3.p3.9.m9.2.3">subscript</csymbol><ci id="S2.SS3.p3.9.m9.2.3.2.cmml" xref="S2.SS3.p3.9.m9.2.3.2">𝐴</ci><list id="S2.SS3.p3.9.m9.2.2.2.3.cmml" xref="S2.SS3.p3.9.m9.2.2.2.4"><ci id="S2.SS3.p3.9.m9.1.1.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1.1.1">𝑓</ci><ci id="S2.SS3.p3.9.m9.2.2.2.2.cmml" xref="S2.SS3.p3.9.m9.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m9.2c">A_{f,i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.9.m9.2d">italic_A start_POSTSUBSCRIPT italic_f , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="A_{h,i}" class="ltx_Math" display="inline" id="S2.SS3.p3.10.m10.2"><semantics id="S2.SS3.p3.10.m10.2a"><msub id="S2.SS3.p3.10.m10.2.3" xref="S2.SS3.p3.10.m10.2.3.cmml"><mi id="S2.SS3.p3.10.m10.2.3.2" xref="S2.SS3.p3.10.m10.2.3.2.cmml">A</mi><mrow id="S2.SS3.p3.10.m10.2.2.2.4" xref="S2.SS3.p3.10.m10.2.2.2.3.cmml"><mi id="S2.SS3.p3.10.m10.1.1.1.1" xref="S2.SS3.p3.10.m10.1.1.1.1.cmml">h</mi><mo id="S2.SS3.p3.10.m10.2.2.2.4.1" xref="S2.SS3.p3.10.m10.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p3.10.m10.2.2.2.2" xref="S2.SS3.p3.10.m10.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m10.2b"><apply id="S2.SS3.p3.10.m10.2.3.cmml" xref="S2.SS3.p3.10.m10.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m10.2.3.1.cmml" xref="S2.SS3.p3.10.m10.2.3">subscript</csymbol><ci id="S2.SS3.p3.10.m10.2.3.2.cmml" xref="S2.SS3.p3.10.m10.2.3.2">𝐴</ci><list id="S2.SS3.p3.10.m10.2.2.2.3.cmml" xref="S2.SS3.p3.10.m10.2.2.2.4"><ci id="S2.SS3.p3.10.m10.1.1.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1.1.1">ℎ</ci><ci id="S2.SS3.p3.10.m10.2.2.2.2.cmml" xref="S2.SS3.p3.10.m10.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m10.2c">A_{h,i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.10.m10.2d">italic_A start_POSTSUBSCRIPT italic_h , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> such that the latter is interpreted by <math alttext="g_{&gt;j}" class="ltx_Math" display="inline" id="S2.SS3.p3.11.m11.1"><semantics id="S2.SS3.p3.11.m11.1a"><msub id="S2.SS3.p3.11.m11.1.1" xref="S2.SS3.p3.11.m11.1.1.cmml"><mi id="S2.SS3.p3.11.m11.1.1.2" xref="S2.SS3.p3.11.m11.1.1.2.cmml">g</mi><mrow id="S2.SS3.p3.11.m11.1.1.3" xref="S2.SS3.p3.11.m11.1.1.3.cmml"><mi id="S2.SS3.p3.11.m11.1.1.3.2" xref="S2.SS3.p3.11.m11.1.1.3.2.cmml"></mi><mo id="S2.SS3.p3.11.m11.1.1.3.1" xref="S2.SS3.p3.11.m11.1.1.3.1.cmml">&gt;</mo><mi id="S2.SS3.p3.11.m11.1.1.3.3" xref="S2.SS3.p3.11.m11.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.11.m11.1b"><apply id="S2.SS3.p3.11.m11.1.1.cmml" xref="S2.SS3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.11.m11.1.1.1.cmml" xref="S2.SS3.p3.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.p3.11.m11.1.1.2.cmml" xref="S2.SS3.p3.11.m11.1.1.2">𝑔</ci><apply id="S2.SS3.p3.11.m11.1.1.3.cmml" xref="S2.SS3.p3.11.m11.1.1.3"><gt id="S2.SS3.p3.11.m11.1.1.3.1.cmml" xref="S2.SS3.p3.11.m11.1.1.3.1"></gt><csymbol cd="latexml" id="S2.SS3.p3.11.m11.1.1.3.2.cmml" xref="S2.SS3.p3.11.m11.1.1.3.2">absent</csymbol><ci id="S2.SS3.p3.11.m11.1.1.3.3.cmml" xref="S2.SS3.p3.11.m11.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.11.m11.1c">g_{&gt;j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.11.m11.1d">italic_g start_POSTSUBSCRIPT &gt; italic_j end_POSTSUBSCRIPT</annotation></semantics></math> similarly to its native input <math alttext="A_{g,j}" class="ltx_Math" display="inline" id="S2.SS3.p3.12.m12.2"><semantics id="S2.SS3.p3.12.m12.2a"><msub id="S2.SS3.p3.12.m12.2.3" xref="S2.SS3.p3.12.m12.2.3.cmml"><mi id="S2.SS3.p3.12.m12.2.3.2" xref="S2.SS3.p3.12.m12.2.3.2.cmml">A</mi><mrow id="S2.SS3.p3.12.m12.2.2.2.4" xref="S2.SS3.p3.12.m12.2.2.2.3.cmml"><mi id="S2.SS3.p3.12.m12.1.1.1.1" xref="S2.SS3.p3.12.m12.1.1.1.1.cmml">g</mi><mo id="S2.SS3.p3.12.m12.2.2.2.4.1" xref="S2.SS3.p3.12.m12.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p3.12.m12.2.2.2.2" xref="S2.SS3.p3.12.m12.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.12.m12.2b"><apply id="S2.SS3.p3.12.m12.2.3.cmml" xref="S2.SS3.p3.12.m12.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.12.m12.2.3.1.cmml" xref="S2.SS3.p3.12.m12.2.3">subscript</csymbol><ci id="S2.SS3.p3.12.m12.2.3.2.cmml" xref="S2.SS3.p3.12.m12.2.3.2">𝐴</ci><list id="S2.SS3.p3.12.m12.2.2.2.3.cmml" xref="S2.SS3.p3.12.m12.2.2.2.4"><ci id="S2.SS3.p3.12.m12.1.1.1.1.cmml" xref="S2.SS3.p3.12.m12.1.1.1.1">𝑔</ci><ci id="S2.SS3.p3.12.m12.2.2.2.2.cmml" xref="S2.SS3.p3.12.m12.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.12.m12.2c">A_{g,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.12.m12.2d">italic_A start_POSTSUBSCRIPT italic_g , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> originating from <math alttext="g_{\leq j}" class="ltx_Math" display="inline" id="S2.SS3.p3.13.m13.1"><semantics id="S2.SS3.p3.13.m13.1a"><msub id="S2.SS3.p3.13.m13.1.1" xref="S2.SS3.p3.13.m13.1.1.cmml"><mi id="S2.SS3.p3.13.m13.1.1.2" xref="S2.SS3.p3.13.m13.1.1.2.cmml">g</mi><mrow id="S2.SS3.p3.13.m13.1.1.3" xref="S2.SS3.p3.13.m13.1.1.3.cmml"><mi id="S2.SS3.p3.13.m13.1.1.3.2" xref="S2.SS3.p3.13.m13.1.1.3.2.cmml"></mi><mo id="S2.SS3.p3.13.m13.1.1.3.1" xref="S2.SS3.p3.13.m13.1.1.3.1.cmml">≤</mo><mi id="S2.SS3.p3.13.m13.1.1.3.3" xref="S2.SS3.p3.13.m13.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.13.m13.1b"><apply id="S2.SS3.p3.13.m13.1.1.cmml" xref="S2.SS3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.13.m13.1.1.1.cmml" xref="S2.SS3.p3.13.m13.1.1">subscript</csymbol><ci id="S2.SS3.p3.13.m13.1.1.2.cmml" xref="S2.SS3.p3.13.m13.1.1.2">𝑔</ci><apply id="S2.SS3.p3.13.m13.1.1.3.cmml" xref="S2.SS3.p3.13.m13.1.1.3"><leq id="S2.SS3.p3.13.m13.1.1.3.1.cmml" xref="S2.SS3.p3.13.m13.1.1.3.1"></leq><csymbol cd="latexml" id="S2.SS3.p3.13.m13.1.1.3.2.cmml" xref="S2.SS3.p3.13.m13.1.1.3.2">absent</csymbol><ci id="S2.SS3.p3.13.m13.1.1.3.3.cmml" xref="S2.SS3.p3.13.m13.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.13.m13.1c">g_{\leq j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.13.m13.1d">italic_g start_POSTSUBSCRIPT ≤ italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We hypothesize that commonly used model stitching settings, often employed as proxies for assessing functional similarity, may be unreliable for this purpose. Since ground truth for functional similarity is inherently unavailable, we design a series of controlled experiments to expose the limitations of existing approaches and evaluate how FuLA compares against them.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">Experimental setting:</span> We consider image classification networks and conduct our experiments using CIFAR-10 and a low-resolution version of ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib11" title="">11</a>]</cite>, from which we randomly sampled 10 classes. Throughout the paper, we use the ResNet18 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib18" title="">18</a>]</cite> architecture as our trained front and end models. We perform stitching at the first convolutional layer and at each residual residual block. In the supplementary material, we provide additional implementation details and results on more architectures, where the conclusions of our paper remain unchanged.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.3"><span class="ltx_text ltx_font_bold" id="S3.p3.3.1">Training of stitching layer:</span> When training the stitching layer <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">T</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑇</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> we follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite> and model it as a <math alttext="1\times 1" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mn id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">1</mn><mo id="S3.p3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p3.2.m2.1.1.1.cmml">×</mo><mn id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><times id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></times><cn id="S3.p3.2.m2.1.1.2.cmml" type="integer" xref="S3.p3.2.m2.1.1.2">1</cn><cn id="S3.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">1 × 1</annotation></semantics></math> convolutional layer with bias. The front and end models are frozen where only their running batch statistics (RS) are updated. The stitching layer is initialized by linearizing the DM objective in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E3" title="In 2.1 Notation ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>), then solved using the Moore-Penrose pseudoinverse with <math alttext="100" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mn id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><cn id="S3.p3.3.m3.1.1.cmml" type="integer" xref="S3.p3.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">100</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">100</annotation></semantics></math> training samples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">The stitching plot:</span> When stitching corresponding layers (i.e., <math alttext="i=j" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">i</mi><mo id="S3.p4.1.m1.1.1.1" xref="S3.p4.1.m1.1.1.1.cmml">=</mo><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><eq id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1"></eq><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑖</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">i=j</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_i = italic_j</annotation></semantics></math>), we use the stitching plot <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite>, where the y-axis represents a relevant performance metric and the x-axis denotes the depth of the front layer composition. The end points correspond to the baseline end and front models.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="126" id="S3.F3.g1" src="x3.png" width="166"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">DM in practice.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.2"><span class="ltx_text ltx_font_bold" id="S3.p5.2.1">Implementing DM as Hint:</span> To better understand how different optimization settings in model stitching impact functional similarity evaluation, we focus on the relevant aspects of this comparison. Based on our analysis, we found that DM, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite>, may be unfairly underperforming compared to SLM and TLM due to two key factors: (i) using fewer samples to learn <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><msub id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">T</mi><mi id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">𝑇</ci><ci id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and (ii) not accounting for the running batch statistics of the training set, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F3" title="Figure 3 ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>. We address this by learning the <math alttext="T_{\theta}" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><msub id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">T</mi><mi id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝑇</ci><ci id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">T_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> under the DM objective in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E3" title="In 2.1 Notation ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3</span></a>) using the full training set (i.e., implemented as structural Hint <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib39" title="">39</a>]</cite>) <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>This choice comes with an additional computational cost compared to the single-pass pseudoinverse solution, but it is necessary for disambiguating the effects of the different stitching settings.</span></span></span>, similar to the SLM, TLM and FuLA settings. We clarify that we refer to direct matching as DM only when it is used for initializing the stitched model, and as a Hint otherwise.</p>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.1"><span class="ltx_text ltx_font_bold" id="S3.p6.1.1">Experimental Outline and Takeaways:</span>
First, we show in <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS1" title="3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3.1</span></a> that task-based model stitching can fabricate functional alignment depending on the training objective, which undermines its reliability as a functional similarity metric when transitioning between models that differ in or lack necessary functional properties. We reach a similar conclusion in <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS2" title="3.2 Stitching under Shortcuts ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3.2</span></a>, where task-based stitching is shown to (i) base alignment on visual cues unseen by both models or (ii) overlook alignment when not required by the task, both of which hinder the reliability. In light of these findings, in <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.SS3" title="3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">3.3</span></a> we revisit cross-layer stitching and question whether high functional similarity between distant layers is an artifact of task-based alignment or an inherent property of the models’ internal functional behavior, and conclude the latter. Overall, we find that FuLA, a task-agnostic method, retrieves non-trivial transformations missed by stitch-level alignment and is significantly less susceptible to the pitfalls of task-based approaches.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model Stitching under Adversarial Training</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We start by revisiting functional similarity between non-robust and robust models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite> as its multi-objective nature will allow us to gain insights on the behavior of different model stitching settings. In this case, the functional similarity can be evaluated based on two key and competing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib41" title="">41</a>]</cite> functional properties, namely accuracy and robust accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite>. We train the robust models using AT according to (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E4" title="In 2.2 Adversarial Training ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">4</span></a>) with <math alttext="\alpha=0.5" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><eq id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></eq><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝛼</ci><cn id="S3.SS1.p1.1.m1.1.1.3.cmml" type="float" xref="S3.SS1.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\alpha=0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_α = 0.5</annotation></semantics></math>. At all times, we train the stitching layer on the CIFAR-10 and experiment with same- and cross-task settings.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="489" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Cross-task stitching under AT – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="720" id="S3.F5.sf1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf1.2.1.1" style="font-size:90%;">((a))</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="756" id="S3.F5.sf2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf2.2.1.1" style="font-size:90%;">((b))</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="756" id="S3.F5.sf3.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf3.2.1.1" style="font-size:90%;">((c))</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="756" id="S3.F5.sf4.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf4.2.1.1" style="font-size:90%;">((d))</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.4.2.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S3.F5.2.1" style="font-size:90%;">Same-task stitching under AT <math alttext="(\alpha=1)" class="ltx_Math" display="inline" id="S3.F5.2.1.m1.1"><semantics id="S3.F5.2.1.m1.1b"><mrow id="S3.F5.2.1.m1.1.1.1" xref="S3.F5.2.1.m1.1.1.1.1.cmml"><mo id="S3.F5.2.1.m1.1.1.1.2" stretchy="false" xref="S3.F5.2.1.m1.1.1.1.1.cmml">(</mo><mrow id="S3.F5.2.1.m1.1.1.1.1" xref="S3.F5.2.1.m1.1.1.1.1.cmml"><mi id="S3.F5.2.1.m1.1.1.1.1.2" xref="S3.F5.2.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S3.F5.2.1.m1.1.1.1.1.1" xref="S3.F5.2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S3.F5.2.1.m1.1.1.1.1.3" xref="S3.F5.2.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.F5.2.1.m1.1.1.1.3" stretchy="false" xref="S3.F5.2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.1c"><apply id="S3.F5.2.1.m1.1.1.1.1.cmml" xref="S3.F5.2.1.m1.1.1.1"><eq id="S3.F5.2.1.m1.1.1.1.1.1.cmml" xref="S3.F5.2.1.m1.1.1.1.1.1"></eq><ci id="S3.F5.2.1.m1.1.1.1.1.2.cmml" xref="S3.F5.2.1.m1.1.1.1.1.2">𝛼</ci><cn id="S3.F5.2.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.F5.2.1.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.1.m1.1d">(\alpha=1)</annotation><annotation encoding="application/x-llamapun" id="S3.F5.2.1.m1.1e">( italic_α = 1 )</annotation></semantics></math> – ResNet18 </span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">In Figs. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F4" title="Figure 4 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">4</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F5" title="Figure 5 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">5</span></a>
we compared model stitching under different setting for various configurations of adversarial examples proportions, front and end models. When looking at model stitching without AT (i.e. <math alttext="\alpha=0" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></eq><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝛼</ci><cn id="S3.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_α = 0</annotation></semantics></math>) in the first row of Fig <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F4" title="Figure 4 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">4</span></a>, we observe that all settings interpolate the performance of their models which aligns with what was reported originally by <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">Model stitching with AT poses particular interest, as distinct behaviors emerge across different stitching configurations (e.g., first column in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F4" title="Figure 4 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">4</span></a>). When stitching non-robust models, the SLM and TLM setting display an irregular behavior in both clean and robust accuracy, which becomes more pronounced when only adversarial examples are used (i.e. <math alttext="\alpha=1" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝛼</ci><cn id="S3.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_α = 1</annotation></semantics></math>). In particular, these settings hallucinate non-robust accuracy at the cost of clean accuracy. This is a highly problematic behavior, as functional similarity metrics should capture genuine functional comparability rather than fabricate it to improve task performance. Similar, irregular behavior can be observed when stitching robust to non-robust and the reverse, where clean accuracy drops in an attempt to achieve robust accuracy earlier or for longer depending on the exact configuration.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">On the other hand, the Hint and FuLA behave more stably across all cases, as they smoothly interpolate the functional properties between the two extremes. Overall, FuLA tends to produce better-performing stitched models without exhibiting signs of fabricated alignment. A reoccurring exception was the non-robust to robust configuration where in most cases Hint reports higher accuracy in the deeper layers when training using <math alttext="\alpha=1" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><eq id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></eq><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝛼</ci><cn id="S3.SS1.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_α = 1</annotation></semantics></math>. Interestingly, this is also the configuration where both Hint and FuLA consistently report non-existent functional similarity (i.e., random chance performance) at the penultimate layer (i.e., the 9<math alttext="{}^{\text{th}}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><msup id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1a" xref="S3.SS1.p4.2.m2.1.1.cmml"></mi><mtext id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><ci id="S3.SS1.p4.2.m2.1.1.1a.cmml" xref="S3.SS1.p4.2.m2.1.1.1"><mtext id="S3.SS1.p4.2.m2.1.1.1.cmml" mathsize="70%" xref="S3.SS1.p4.2.m2.1.1.1">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">{}^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">start_FLOATSUPERSCRIPT th end_FLOATSUPERSCRIPT</annotation></semantics></math> layer corresponds to the layer before the fully connected classifier).</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">We further investigated this behavior by analyzing the CKA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib23" title="">23</a>]</cite> and the functional similarity at the penultimate layers of the end and the stitched models. For the CKA, we used a DM-initialized stitched model and evaluated the similarity between its end model, using adversarial examples crafted on the former. For functional similarity, we used model stitching under FuLA by setting the contributions of all (functional) Hints weights to <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mn id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><cn id="S3.SS1.p5.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p5.1.m1.1.1">0</cn></annotation-xml></semantics></math> apart from the last which was set 1 (see Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E5" title="In 2.3 Functional Latent Alignment (FuLA) ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">5</span></a>)). Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F6" title="Figure 6 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">6</span></a> suggests a distinct functional behavior as we morph from the robust to non-robust models.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="132" id="S3.F6.g1" src="x9.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S3.F6.3.2" style="font-size:90%;">Adversarial example penultimate layer similarity.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">In particular, the penultimate layers exhibit a decaying trend in functional similarity for the non-robust to robust stitching configuration, starting at 6<math alttext="{}^{\text{th}}" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><msup id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1a" xref="S3.SS1.p6.1.m1.1.1.cmml"></mi><mtext id="S3.SS1.p6.1.m1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><ci id="S3.SS1.p6.1.m1.1.1.1a.cmml" xref="S3.SS1.p6.1.m1.1.1.1"><mtext id="S3.SS1.p6.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.SS1.p6.1.m1.1.1.1">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">{}^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">start_FLOATSUPERSCRIPT th end_FLOATSUPERSCRIPT</annotation></semantics></math> layer, whereas the others remain relatively steady throughout all layers. In light of this, FuLA may more accurately detect the onset of functionally dissimilar representations earlier than Hint (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F5.sf3" title="In Figure 5 ‣ 3.1 Model Stitching under Adversarial Training ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">5(c)</span></a>), as per its use of functional Hints.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.1">While CKA also identifies the penultimate layers between the robust model and the non-robust-to-robust model stitched at 9<math alttext="{}^{\text{th}}" class="ltx_Math" display="inline" id="S3.SS1.p7.1.m1.1"><semantics id="S3.SS1.p7.1.m1.1a"><msup id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml"><mi id="S3.SS1.p7.1.m1.1.1a" xref="S3.SS1.p7.1.m1.1.1.cmml"></mi><mtext id="S3.SS1.p7.1.m1.1.1.1" xref="S3.SS1.p7.1.m1.1.1.1a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><apply id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1"><ci id="S3.SS1.p7.1.m1.1.1.1a.cmml" xref="S3.SS1.p7.1.m1.1.1.1"><mtext id="S3.SS1.p7.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.SS1.p7.1.m1.1.1.1">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">{}^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.1.m1.1d">start_FLOATSUPERSCRIPT th end_FLOATSUPERSCRIPT</annotation></semantics></math> as the least similar, it fails to capture the functional nuances meaningfully. More specifically, the relative differences in CKA do not appear to be predictive of the functional comparability of the front and end models at their penultimate layers. Similar limitations of CKA have also been reported in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib35" title="">35</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p8">
<p class="ltx_p" id="S3.SS1.p8.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p8.1.1">Takeaway:</span> Task-based model stitching can be unreliable as a functional similarity metric fabricating alignment to solve the task. In contrast, alignment-based methods behave more intuitively, with FuLA generally achieving higher metrics without the drawbacks of optimizing for task performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Stitching under Shortcuts</h3>
<figure class="ltx_figure ltx_align_floatright" id="S3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="S3.F7.g1" src="x10.png" width="216"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S3.F7.3.2" style="font-size:90%;">Pattern-based vs location-based shortcuts.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Next, we explore a setting where shortcuts<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib16" title="">16</a>]</cite>, previously unseen by both the front and end models, are introduced during model stitching. We adapt the AT stitching setup for shortcut learning using models trained on clean data and stitching with three types of shortcuts: pattern-based, location-based, and their combination. Each class is assigned a unique <math alttext="4\times 4" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">4</mn><mo id="S3.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><cn id="S3.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.2">4</cn><cn id="S3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">4\times 4</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">4 × 4</annotation></semantics></math> marker—either a single-colored square (pattern-based) or uniformly random noise at a specific location (location-based) (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F7" title="Figure 7 ‣ 3.2 Stitching under Shortcuts ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S3.F8.g1" src="x11.png" width="689"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S3.F8.3.2" style="font-size:90%;">Stitching under shortcuts.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">In Fig <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F8" title="Figure 8 ‣ 3.2 Stitching under Shortcuts ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">8</span></a>, we report the functional similarity across the three key shortcut conditions considered, for the different model stitching settings. We note that shortcut reliance can manifest in two primary ways: (i) improved performance on shortcut-augmented data relative to clean data, and/or (ii) degraded performance on clean data due to the model’s overreliance on spurious cues. Both (i) and (ii) are problematic as they can provide a distorted picture of functional similarity.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">In this regard, the results suggest that task-based model stitching is inferior to alignment-based approaches. Specifically, we observe that both SLM and TLM not only exploit shortcuts but also overlook existing functional alignments, leading to degraded performance on clean data. In contrast, alignment-based model stitching retains its ability to perform well on clean data, suggesting that it captures functional similarity more effectively. However, we also observe that even Hint and FuLA are susceptible to shortcut learning, particularly in the absence of functional similarity. For instance, location shortcuts are exploited when stitching deeper layers of ImageNet models to CIFAR models, but not when stitching independently trained models on CIFAR.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="253" id="S3.F9.g1" src="x12.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F9.2.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S3.F9.3.2" style="font-size:90%;">Model stitching when DM-initialized and trained on a subset of classes.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">Severe discrepancies between shortcut and clean data indicate overfitting to the training distribution, in this case, the shortcuts. Based on this, it is evident that task-based model stitching is prone to overfitting in the presence of covariance shift (e.g. shortcuts). To further relate model stitching with overfitting, we consider a setting of label shift. In particular, we perform cross-task model stitching using a subset of CIFAR-10 <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Classes were added progressively based on their label index, i.e. CIFAR-1 consists of the ’airplane’ class.</span></span></span>. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F9" title="Figure 9 ‣ 3.2 Stitching under Shortcuts ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">9</span></a> suggests that all model stitching methods underperform when trained on samples from a limited number of classes. However, we observe a clear trend: TLM and SLM tend to overfit more than Hint and FuLA. In this setting, FuLA emerges as the most effective model stitching approach, maintaining high functional similarity across the full distribution despite being trained on only a subset of it. Notably, in the same-task stitching setup, FuLA outperformed the others only in the single-class setting. Beyond that, SLM, Hint, and FuLA performed comparably well, while TLM consistently underperformed.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">Takeaway:</span> Alignment-based model stitching identifies more meaningful notions of functional similarity, as it is less sensitive to the data used for alignment compared to task-based model stitching.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Cross Layer Stitching</h3>
<figure class="ltx_figure" id="S3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="321" id="S3.F10.g1" src="x13.png" width="689"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F10.2.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="S3.F10.3.2" style="font-size:90%;">Cross-layer stitching between regularly trained models. Rows and columns represent the output layers of the front model and input layers of the end model, respectively. Each cell shows the stitched model’s accuracy (i.e., functional similarity). Self-Accuracy indicates how often a layer is most similar to itself, with parentheses denoting non-directional mode performance.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Recently, <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite> questioned the reliability of model stitching under TLM, criticizing its directional nature where high functional similarity is attainable when stitching deep to swallower layers but not vice versa <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib19" title="">19</a>]</cite>. A consequence to that is high functional similarity between distant layers sometimes exceeds that of architecturally corresponding ones, even within identical networks. In response, DM was proposed as a more appropriate similarity metric.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Previously, we have seen that task-based stitching can be unreliable due to its reliance on output level cues to solve the task, and in that sense directionality could potentially be a byproduct of that. We revisit cross-layer stitching and find that task-agnostic FuLA also behaves in a directional manner. In particular, we have observed a smooth transition as we included deeper functional terms (i.e., through weighting the FuLA objective the Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S2.E5" title="In 2.3 Functional Latent Alignment (FuLA) ‣ 2 Model Stitching ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">5</span></a>)) as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F11" title="Figure 11 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">11</span></a>. Based on that, we conclude that earlier layers can retain functionally relevant information when guided by deeper layers. In contrast, guidance from deeper layers, when given swallow-level input is not sufficient to establish functional comparability.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="161" id="S3.F11.g1" src="x14.png" width="166"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F11.2.1.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="S3.F11.3.2" style="font-size:90%;">Cross-layer stitching with FuLA when including up to three functional Hints.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">We observe that model stitching by Hint (i.e., realizing the DM) also exhibits directional behavior (e.g., [5,3] is higher than [3,5] in self-stitching in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F10" title="Figure 10 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">10</span></a>) which breaks as we move from the diagonal towards the bottom-left. In relation to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F11" title="Figure 11 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">11</span></a>, this appears to be a form of regularization on functional alignment enforcing non-directional behavior. We argue that directionality can also break trivially by considering both directions to infer similarity. For example in Fig <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F10" title="Figure 10 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">10</span></a> corresponding layers in self-stitching are accurately detected, when incorporating (i.e., averaging) both directions to identify them.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.2">On the other hand, the directionality of functional similarity can provide fine-grained insights. For example, when comparing the rows in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F10" title="Figure 10 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">10</span></a> under FuLA, it appears that skipping the first <math alttext="5" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mn id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><cn id="S3.SS3.p4.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p4.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">5</annotation></semantics></math> in-distribution layers is functionally equivalent to using the penultimate representations of an out-of-distribution task (i.e., these settings achieved 59% and 60% accuracy). Another interesting observation is that functional similarity appears to diffuse gradually across the axons of task specialization (see 2<span class="ltx_text ltx_markedasmath" id="S3.SS3.p4.2.1">nd</span> in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#S3.F10" title="Figure 10 ‣ 3.3 Cross Layer Stitching ‣ 3 Experiments ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">10</span></a>) which is a property missed by Hint, but maintained for the rest of the settings.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p5.1.1">Takeaway:</span> Model stitching is a directional functional similarity metric even when inferred using task-agnostic functional alignment enabled by FuLA.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Model Stitching:</span>
Model stitching was introduced by <cite class="ltx_cite ltx_citemacro_citet">Lenc and Vedaldi [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib25" title="">25</a>]</cite>, who used a <math alttext="1\times 1" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mn id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">1</mn><mo id="S4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><times id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1"></times><cn id="S4.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.p1.1.m1.1.1.2">1</cn><cn id="S4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">1 × 1</annotation></semantics></math> affine transformation to connect intermediate convolutional layers to study invariance and equivariance. This was later extended by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite> to measure functional similarity. Recently, the reliability of model stitching for functional similarity has been questioned, arguing that high similarity scores may arise even among models with different biases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib40" title="">40</a>]</cite> or between distant layers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib19" title="">19</a>]</cite>. Beyond functional similarity, model-stitching has been used to connect independent network components from the model zoo <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib43" title="">43</a>]</cite> allowing for networks of controllable performance-efficiency trade-offs. Zero-shot stitching has also been achieved by learning representations in relative space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib34" title="">34</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Feature distillation:</span> Feature-based distillation was introduced by <cite class="ltx_cite ltx_citemacro_citet">Romero et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib39" title="">39</a>]</cite>, where teacher features guide the student via L2 minimization. Notable extensions include attention-based distillation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib44" title="">44</a>]</cite> and inter-channel correlation transfer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib28" title="">28</a>]</cite>, both applied at manually chosen layers. <cite class="ltx_cite ltx_citemacro_citet">Ji et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib20" title="">20</a>]</cite> and <cite class="ltx_cite ltx_citemacro_citet">Chen et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib6" title="">6</a>]</cite> avoid manual layer linking by learning connections via attention. While FuLA also minimizes L2 feature distance, it does so through frozen layer compositions of the end model, achieving alignment in the functional sense.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Function consistency:</span> Function consistency has been used in KD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib42" title="">42</a>]</cite> to help students better replicate teacher behavior, improving performance. <cite class="ltx_cite ltx_citemacro_citet">Yang et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib43" title="">43</a>]</cite> applied it to group equivalent blocks in the model zoo, later reassembled under resource constraints. In contrast, FuLA leverages function consistency to align models for measuring functional similarity.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we proposed FuLA as a novel optimization condition for model stitching as a functional similarity metric. We show that stitching models using output-level cues (i.e., SLM and TLM) can fabricate alignment by overfitting to the training task. Experiments under adversarial training, distribution shifts, and cross-task stitching demonstrate that FuLA is significantly less susceptible to pitfalls of task-based stitching. Moreover, it retrieves non-trivial alignment transformations missed by stitch-level alignment, making it a more reliable approach for evaluating functional similarity.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Limitations:</span> While FuLA shows promise as a more reliable metric for functional similarity compared to prior model stitching approaches, definitive conclusions remain out of reach due to the lack to ground truth. Furthermore, our study is limited to image classification, exploring FuLA’s relation to task-based stitching in other modalities and tasks is a promising direction for future work.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balogh and Jelasity [2023]</span>
<span class="ltx_bibblock">
András Balogh and Márk Jelasity.

</span>
<span class="ltx_bibblock">On the functional similarity of robust and non-robust neural representations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International Conference on Machine Learning</em>, pages 1614–1635. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balogh and Jelasity [2025]</span>
<span class="ltx_bibblock">
András Balogh and Márk Jelasity.

</span>
<span class="ltx_bibblock">How not to stitch representations to measure similarity: Task loss matching versus direct matching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 39, pages 15472–15480, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bansal et al. [2021]</span>
<span class="ltx_bibblock">
Yamini Bansal, Preetum Nakkiran, and Boaz Barak.

</span>
<span class="ltx_bibblock">Revisiting model stitching to compare neural representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in neural information processing systems</em>, 34:225–236, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al. [2012]</span>
<span class="ltx_bibblock">
Yoshua Bengio, Aaron Courville, and Pascal Vincent.

</span>
<span class="ltx_bibblock">Representation learning: A review and new perspectives. arxiv 2012.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:1206.5538</em>, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cannistraci et al. [2023]</span>
<span class="ltx_bibblock">
Irene Cannistraci, Luca Moschella, Marco Fumero, Valentino Maiorca, and Emanuele Rodolà.

</span>
<span class="ltx_bibblock">From bricks to bridges: Product of invariances to enhance latent space communication.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2310.01211</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2021]</span>
<span class="ltx_bibblock">
Defang Chen, Jian-Ping Mei, Yuan Zhang, Can Wang, Zhe Wang, Yan Feng, and Chun Chen.

</span>
<span class="ltx_bibblock">Cross-layer distillation with semantic calibration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 35, pages 7028–7036, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowers and Weiss [2023]</span>
<span class="ltx_bibblock">
Rhea Chowers and Yair Weiss.

</span>
<span class="ltx_bibblock">What do cnns learn in the first layer and why? a linear systems perspective.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">International Conference on Machine Learning</em>, pages 6115–6139. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Croce and Hein [2020]</span>
<span class="ltx_bibblock">
Francesco Croce and Matthias Hein.

</span>
<span class="ltx_bibblock">Reliable evaluation of adversarial robustness with an ensemble of diverse parameter-free attacks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International conference on machine learning</em>, pages 2206–2216. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Csiszárik et al. [2021]</span>
<span class="ltx_bibblock">
Adrián Csiszárik, Péter Kőrösi-Szabó, Akos Matszangosz, Gergely Papp, and Dániel Varga.

</span>
<span class="ltx_bibblock">Similarity and matching of neural network representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems</em>, 34:5656–5668, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Davari et al. [2022]</span>
<span class="ltx_bibblock">
MohammadReza Davari, Stefan Horoi, Amine Natik, Guillaume Lajoie, Guy Wolf, and Eugene Belilovsky.

</span>
<span class="ltx_bibblock">Reliability of cka as a similarity measure in deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2210.16156</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. [2009]</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">2009 IEEE conference on computer vision and pattern recognition</em>, pages 248–255. Ieee, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. [2021]</span>
<span class="ltx_bibblock">
Frances Ding, Jean-Stanislas Denain, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Grounding representation similarity through statistical testing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, 34:1556–1568, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doimo et al. [2020]</span>
<span class="ltx_bibblock">
Diego Doimo, Aldo Glielmo, Alessio Ansuini, and Alessandro Laio.

</span>
<span class="ltx_bibblock">Hierarchical nucleation in deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>, 33:7526–7536, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Esteva et al. [2017]</span>
<span class="ltx_bibblock">
Andre Esteva, Brett Kuprel, Roberto A Novoa, Justin Ko, Susan M Swetter, Helen M Blau, and Sebastian Thrun.

</span>
<span class="ltx_bibblock">Dermatologist-level classification of skin cancer with deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">nature</em>, 542(7639):115–118, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garrido-Jurado et al. [2014]</span>
<span class="ltx_bibblock">
Sergio Garrido-Jurado, Rafael Muñoz-Salinas, Francisco José Madrid-Cuevas, and Manuel Jesús Marín-Jiménez.

</span>
<span class="ltx_bibblock">Automatic generation and detection of highly reliable fiducial markers under occlusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Pattern Recognition</em>, 47(6):2280–2292, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geirhos et al. [2020]</span>
<span class="ltx_bibblock">
Robert Geirhos, Jörn-Henrik Jacobsen, Claudio Michaelis, Richard Zemel, Wieland Brendel, Matthias Bethge, and Felix A Wichmann.

</span>
<span class="ltx_bibblock">Shortcut learning in deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Nature Machine Intelligence</em>, 2(11):665–673, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al. [2014]</span>
<span class="ltx_bibblock">
Ian J Goodfellow, Jonathon Shlens, and Christian Szegedy.

</span>
<span class="ltx_bibblock">Explaining and harnessing adversarial examples.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1412.6572</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2016]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et al. [2022]</span>
<span class="ltx_bibblock">
Adriano Hernandez, Rumen Dangovski, Peter Y. Lu, and Marin Soljacic.

</span>
<span class="ltx_bibblock">Model stitching: Looking for functional similarity between representations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">SVRHM 2022 Workshop @ NeurIPS</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=7bHLCO5FQdB" title="">https://openreview.net/forum?id=7bHLCO5FQdB</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al. [2021]</span>
<span class="ltx_bibblock">
Mingi Ji, Byeongho Heo, and Sungrae Park.

</span>
<span class="ltx_bibblock">Show, attend and distill: Knowledge distillation via attention-based feature matching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 35, pages 7945–7952, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jones et al. [2022]</span>
<span class="ltx_bibblock">
Haydn T Jones, Jacob M Springer, Garrett T Kenyon, and Juston S Moore.

</span>
<span class="ltx_bibblock">If you’ve trained one you’ve trained them all: inter-architecture similarity increases with robustness.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Uncertainty in Artificial Intelligence</em>, pages 928–937. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma [2014]</span>
<span class="ltx_bibblock">
Diederik P Kingma.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kornblith et al. [2019]</span>
<span class="ltx_bibblock">
Simon Kornblith, Mohammad Norouzi, Honglak Lee, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Similarity of neural network representations revisited.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International conference on machine learning</em>, pages 3519–3529. PMLR, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. [2017]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Imagenet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Communications of the ACM</em>, 60(6):84–90, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lenc and Vedaldi [2015]</span>
<span class="ltx_bibblock">
Karel Lenc and Andrea Vedaldi.

</span>
<span class="ltx_bibblock">Understanding image representations by measuring their equivariance and equivalence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 991–999, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2022]</span>
<span class="ltx_bibblock">
Tao Li, Yingwen Wu, Sizhe Chen, Kun Fang, and Xiaolin Huang.

</span>
<span class="ltx_bibblock">Subspace adversarial training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 13409–13418, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023]</span>
<span class="ltx_bibblock">
Dongyang Liu, Meina Kan, Shiguang Shan, and Xilin Chen.

</span>
<span class="ltx_bibblock">Function-consistent feature distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2304.11832</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Li Liu, Qingle Huang, Sihao Lin, Hongwei Xie, Bing Wang, Xiaojun Chang, and Xiaodan Liang.

</span>
<span class="ltx_bibblock">Exploring inter-channel correlation for diversity-preserved knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pages 8271–8280, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madry et al. [2017]</span>
<span class="ltx_bibblock">
Aleksander Madry, Aleksandar Makelov, Ludwig Schmidt, Dimitris Tsipras, and Adrian Vladu.

</span>
<span class="ltx_bibblock">Towards deep learning models resistant to adversarial attacks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:1706.06083</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Masarczyk et al. [2023]</span>
<span class="ltx_bibblock">
Wojciech Masarczyk, Mateusz Ostaszewski, Ehsan Imani, Razvan Pascanu, Piotr Miłoś, and Tomasz Trzcinski.

</span>
<span class="ltx_bibblock">The tunnel effect: Building data representations in deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>, 36:76772–76805, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al. [2013]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Efficient estimation of word representations in vector space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:1301.3781</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mirzadeh et al. [2020]</span>
<span class="ltx_bibblock">
Seyed Iman Mirzadeh, Mehrdad Farajtabar, Dilan Gorur, Razvan Pascanu, and Hassan Ghasemzadeh.

</span>
<span class="ltx_bibblock">Linear mode connectivity in multitask and continual learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2010.04495</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morcos et al. [2018]</span>
<span class="ltx_bibblock">
Ari Morcos, Maithra Raghu, and Samy Bengio.

</span>
<span class="ltx_bibblock">Insights on representational similarity in neural networks with canonical correlation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moschella et al. [2022]</span>
<span class="ltx_bibblock">
Luca Moschella, Valentino Maiorca, Marco Fumero, Antonio Norelli, Francesco Locatello, and Emanuele Rodolà.

</span>
<span class="ltx_bibblock">Relative representations enable zero-shot latent space communication.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2209.15430</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda et al. [2022]</span>
<span class="ltx_bibblock">
Vedant Nanda, Till Speicher, Camila Kolling, John P Dickerson, Krishna Gummadi, and Adrian Weller.

</span>
<span class="ltx_bibblock">Measuring representational robustness of neural networks through shared invariances.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">International Conference on Machine Learning</em>, pages 16368–16382. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. [2020]</span>
<span class="ltx_bibblock">
Thao Nguyen, Maithra Raghu, and Simon Kornblith.

</span>
<span class="ltx_bibblock">Do wide and deep networks learn the same things? uncovering how neural network representations vary with width and depth.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2010.15327</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. [2023]</span>
<span class="ltx_bibblock">
Zizheng Pan, Jianfei Cai, and Bohan Zhuang.

</span>
<span class="ltx_bibblock">Stitchable neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 16102–16112, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. [2024]</span>
<span class="ltx_bibblock">
Zizheng Pan, Jing Liu, Haoyu He, Jianfei Cai, and Bohan Zhuang.

</span>
<span class="ltx_bibblock">Stitched vits are flexible vision backbones.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">European Conference on Computer Vision</em>, pages 258–274. Springer, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romero et al. [2014]</span>
<span class="ltx_bibblock">
Adriana Romero, Nicolas Ballas, Samira Ebrahimi Kahou, Antoine Chassang, Carlo Gatta, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Fitnets: Hints for thin deep nets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:1412.6550</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith and Marcu [2024]</span>
<span class="ltx_bibblock">
Damian Smith and Antonia Marcu.

</span>
<span class="ltx_bibblock">Comparing apples and oranges: is stitching similarity a load of spheres?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">NeurIPS 2024 Workshop on Scientific Methods for Understanding Deep Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tsipras et al. [2018]</span>
<span class="ltx_bibblock">
Dimitris Tsipras, Shibani Santurkar, Logan Engstrom, Alexander Turner, and Aleksander Madry.

</span>
<span class="ltx_bibblock">Robustness may be at odds with accuracy.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:1805.12152</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021]</span>
<span class="ltx_bibblock">
Jing Yang, Brais Martinez, Adrian Bulat, and Georgios Tzimiropoulos.

</span>
<span class="ltx_bibblock">Knowledge distillation via softmax regression representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2022]</span>
<span class="ltx_bibblock">
Xingyi Yang, Daquan Zhou, Songhua Liu, Jingwen Ye, and Xinchao Wang.

</span>
<span class="ltx_bibblock">Deep model reassembly.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Advances in neural information processing systems</em>, 35:25739–25753, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zagoruyko and Komodakis [2016]</span>
<span class="ltx_bibblock">
Sergey Zagoruyko and Nikos Komodakis.

</span>
<span class="ltx_bibblock">Paying more attention to attention: Improving the performance of convolutional neural networks via attention transfer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1612.03928</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziyin et al. [2024]</span>
<span class="ltx_bibblock">
Liu Ziyin, Isaac Chuang, Tomer Galanti, and Tomaso Poggio.

</span>
<span class="ltx_bibblock">Formation of representations in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2410.03006</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Setup</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this section, we cover the implementation details needed for reproducing our results.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Baseline Training</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In this study, we experimented with CNN-based architectures, namely ResNet18, ResNet34, and a modified version of ResNet18 in which the residual connections were removed, effectively rendering it a plain convolutional neural network (CNN). To train the end and front models we used the CIFAR-10 and low resolution version of ImageNet where we randomly sampled 10 classes, we refer to that as LS-ImageNet-10.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Non-robust models:</span> The non-robust models were trained for 200 epochs using the SGD optimizer with momentum. The initial learning rate was set to 0.1, with a batch size of 128. During training, we applied random horizontal flips and random cropping with 4-pixel padding. A weight decay of <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><mrow id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mn id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">1</mn><mo id="A1.SS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.1.m1.1.1.1.cmml">×</mo><msup id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml"><mn id="A1.SS1.p2.1.m1.1.1.3.2" xref="A1.SS1.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="A1.SS1.p2.1.m1.1.1.3.3" xref="A1.SS1.p2.1.m1.1.1.3.3.cmml"><mo id="A1.SS1.p2.1.m1.1.1.3.3a" xref="A1.SS1.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.SS1.p2.1.m1.1.1.3.3.2" xref="A1.SS1.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><times id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1.1"></times><cn id="A1.SS1.p2.1.m1.1.1.2.cmml" type="integer" xref="A1.SS1.p2.1.m1.1.1.2">1</cn><apply id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3">superscript</csymbol><cn id="A1.SS1.p2.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS1.p2.1.m1.1.1.3.2">10</cn><apply id="A1.SS1.p2.1.m1.1.1.3.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3"><minus id="A1.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3"></minus><cn id="A1.SS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A1.SS1.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> was used, and the learning rate was reduced by a factor of 0.1 at every third of the total training epochs.</p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.4"><span class="ltx_text ltx_font_bold" id="A1.SS1.p3.4.1">Robust models:</span> The robust models were trained using the same hyperparameter settings as the non-robust models, with adversarial training performed according to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib29" title="">29</a>]</cite>, using an equal mix of clean and adversarial examples (<math alttext="\alpha=0.5" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1"><semantics id="A1.SS1.p3.1.m1.1a"><mrow id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml"><mi id="A1.SS1.p3.1.m1.1.1.2" xref="A1.SS1.p3.1.m1.1.1.2.cmml">α</mi><mo id="A1.SS1.p3.1.m1.1.1.1" xref="A1.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.1.m1.1.1.3" xref="A1.SS1.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><apply id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1"><eq id="A1.SS1.p3.1.m1.1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1.1"></eq><ci id="A1.SS1.p3.1.m1.1.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.2">𝛼</ci><cn id="A1.SS1.p3.1.m1.1.1.3.cmml" type="float" xref="A1.SS1.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">\alpha=0.5</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.1.m1.1d">italic_α = 0.5</annotation></semantics></math>). The adversarial examples were generated using 10 steps, with a step size of <math alttext="2/255" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1"><semantics id="A1.SS1.p3.2.m2.1a"><mrow id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml"><mn id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml">2</mn><mo id="A1.SS1.p3.2.m2.1.1.1" xref="A1.SS1.p3.2.m2.1.1.1.cmml">/</mo><mn id="A1.SS1.p3.2.m2.1.1.3" xref="A1.SS1.p3.2.m2.1.1.3.cmml">255</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1"><divide id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1.1"></divide><cn id="A1.SS1.p3.2.m2.1.1.2.cmml" type="integer" xref="A1.SS1.p3.2.m2.1.1.2">2</cn><cn id="A1.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.p3.2.m2.1.1.3">255</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">2/255</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.2.m2.1d">2 / 255</annotation></semantics></math> and <math alttext="\epsilon" class="ltx_Math" display="inline" id="A1.SS1.p3.3.m3.1"><semantics id="A1.SS1.p3.3.m3.1a"><mi id="A1.SS1.p3.3.m3.1.1" xref="A1.SS1.p3.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.3.m3.1b"><ci id="A1.SS1.p3.3.m3.1.1.cmml" xref="A1.SS1.p3.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.3.m3.1d">italic_ϵ</annotation></semantics></math> set to <math alttext="8/255" class="ltx_Math" display="inline" id="A1.SS1.p3.4.m4.1"><semantics id="A1.SS1.p3.4.m4.1a"><mrow id="A1.SS1.p3.4.m4.1.1" xref="A1.SS1.p3.4.m4.1.1.cmml"><mn id="A1.SS1.p3.4.m4.1.1.2" xref="A1.SS1.p3.4.m4.1.1.2.cmml">8</mn><mo id="A1.SS1.p3.4.m4.1.1.1" xref="A1.SS1.p3.4.m4.1.1.1.cmml">/</mo><mn id="A1.SS1.p3.4.m4.1.1.3" xref="A1.SS1.p3.4.m4.1.1.3.cmml">255</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.4.m4.1b"><apply id="A1.SS1.p3.4.m4.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1"><divide id="A1.SS1.p3.4.m4.1.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1.1"></divide><cn id="A1.SS1.p3.4.m4.1.1.2.cmml" type="integer" xref="A1.SS1.p3.4.m4.1.1.2">8</cn><cn id="A1.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="A1.SS1.p3.4.m4.1.1.3">255</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.4.m4.1c">8/255</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.4.m4.1d">8 / 255</annotation></semantics></math>. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite> and measure adversarial robustness was measured using the "rand" configuration of AutoAttack <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib8" title="">8</a>]</cite>.</p>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1">The performance of each model is shown in Tab <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A1.T1" title="Table 1 ‣ A.1 Baseline Training ‣ Appendix A Experimental Setup ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="A1.T1.3.2" style="font-size:90%;">Performance for the baseline models used as front and end models during stitching.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T1.4">
<tr class="ltx_tr" id="A1.T1.4.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.1.1">Model ID</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.1.2"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.2.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.1.3"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.3.1">Architecture</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.1.4"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.4.1">Accuracy</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.1.5">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.1.5.1">
<tr class="ltx_tr" id="A1.T1.4.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.1.5.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.5.1.1.1.1">Robust</span></td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.1.5.1.2.1"><span class="ltx_text ltx_font_bold" id="A1.T1.4.1.5.1.2.1.1">Accuracy</span></td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.2.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.2.1.1">cifar10_0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.2.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.2.2.1">CIFAR-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.2.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.2.3.1">
<tr class="ltx_tr" id="A1.T1.4.2.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.2.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.2.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.2.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.2.4">94.21%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.2.5">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.3.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.3.2">94.51%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.3.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.4.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.4.2">94.14%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.4.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.5.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.5.1.1">cifar10_1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.5.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.5.2.1">CIFAR-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.5.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.5.3.1">
<tr class="ltx_tr" id="A1.T1.4.5.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.5.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.5.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.5.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.5.4">94.21%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.5.5">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.6.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.6.2">94.03%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.6.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.7">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.7.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.7.2">94.91%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.7.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.8">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.8.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.8.1.1">ls_imagenet10_0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.8.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.8.2.1">LS-ImageNet-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.8.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.8.3.1">
<tr class="ltx_tr" id="A1.T1.4.8.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.8.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.8.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.8.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.8.4">76.12%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.8.5">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.9">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.9.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.9.2">74.8%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.9.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.10.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.10.2">74.93%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.10.3">0%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.11">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.11.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.11.1.1">
<span class="ltx_tabular ltx_align_middle" id="A1.T1.4.11.1.1.1">
<span class="ltx_tr" id="A1.T1.4.11.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.11.1.1.1.1.1">cifar10_0</span></span>
<span class="ltx_tr" id="A1.T1.4.11.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.11.1.1.1.2.1">robust</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.11.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.11.2.1">CIFAR-10 w/ AT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.11.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.11.3.1">
<tr class="ltx_tr" id="A1.T1.4.11.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.11.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.11.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.11.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.11.4">84.86%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.11.5">40.59%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.12">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.12.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.12.2">85.52%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.12.3">40.73%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.13.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.13.2">86.69%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.13.3">42.89%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.14">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.14.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.14.1.1">
<span class="ltx_tabular ltx_align_middle" id="A1.T1.4.14.1.1.1">
<span class="ltx_tr" id="A1.T1.4.14.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.14.1.1.1.1.1">cifar10_1</span></span>
<span class="ltx_tr" id="A1.T1.4.14.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.14.1.1.1.2.1">robust</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.14.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.14.2.1">CIFAR-10 w/ AT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.14.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.14.3.1">
<tr class="ltx_tr" id="A1.T1.4.14.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.14.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.14.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.14.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.14.4">85.17%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.14.5">40.99%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.15">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.15.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.15.2">84.96%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.15.3">40.65%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.16">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.16.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.16.2">86.22%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.16.3">42.86%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.17">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.4.17.1" rowspan="3"><span class="ltx_text" id="A1.T1.4.17.1.1">
<span class="ltx_tabular ltx_align_middle" id="A1.T1.4.17.1.1.1">
<span class="ltx_tr" id="A1.T1.4.17.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.17.1.1.1.1.1">ls_imagenet10_0</span></span>
<span class="ltx_tr" id="A1.T1.4.17.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.17.1.1.1.2.1">robust</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.4.17.2" rowspan="3"><span class="ltx_text" id="A1.T1.4.17.2.1">LS-ImageNet-10 w/ AT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.17.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T1.4.17.3.1">
<tr class="ltx_tr" id="A1.T1.4.17.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.17.3.1.1.1">ResNet18</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.17.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T1.4.17.3.1.2.1">(w/o residuals)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.17.4">66.2%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.17.5">21.8%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.18">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.18.1">ResNet18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.18.2">63.23%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T1.4.18.3">22.6%</td>
</tr>
<tr class="ltx_tr" id="A1.T1.4.19">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.4.19.1">ResNet34</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.4.19.2">63.79%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.4.19.3">22.2%</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Stitching Training</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.6">We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib9" title="">9</a>]</cite> and use <math alttext="1\times 1" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mn id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">1</mn><mo id="A1.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><times id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"></times><cn id="A1.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS2.p1.1.m1.1.1.2">1</cn><cn id="A1.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">1 × 1</annotation></semantics></math> convolutional layers with bias as a stitch layer to connect the front and end models. During training we keep everything frozen apart from the alignment transformation and the batch normalization statistics of the front and end models. The affine transformation was trained for <math alttext="30" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><mn id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><cn id="A1.SS2.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS2.p1.2.m2.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">30</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">30</annotation></semantics></math> epochs using Adam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib22" title="">22</a>]</cite> optimizer with a learning rate of <math alttext="0.001" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><mn id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><cn id="A1.SS2.p1.3.m3.1.1.cmml" type="float" xref="A1.SS2.p1.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">0.001</annotation></semantics></math> and weight decay of <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m4.1"><semantics id="A1.SS2.p1.4.m4.1a"><mrow id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml"><mn id="A1.SS2.p1.4.m4.1.1.2" xref="A1.SS2.p1.4.m4.1.1.2.cmml">1</mn><mo id="A1.SS2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p1.4.m4.1.1.1.cmml">×</mo><msup id="A1.SS2.p1.4.m4.1.1.3" xref="A1.SS2.p1.4.m4.1.1.3.cmml"><mn id="A1.SS2.p1.4.m4.1.1.3.2" xref="A1.SS2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="A1.SS2.p1.4.m4.1.1.3.3" xref="A1.SS2.p1.4.m4.1.1.3.3.cmml"><mo id="A1.SS2.p1.4.m4.1.1.3.3a" xref="A1.SS2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="A1.SS2.p1.4.m4.1.1.3.3.2" xref="A1.SS2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><apply id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1"><times id="A1.SS2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1.1"></times><cn id="A1.SS2.p1.4.m4.1.1.2.cmml" type="integer" xref="A1.SS2.p1.4.m4.1.1.2">1</cn><apply id="A1.SS2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m4.1.1.3.1.cmml" xref="A1.SS2.p1.4.m4.1.1.3">superscript</csymbol><cn id="A1.SS2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="A1.SS2.p1.4.m4.1.1.3.2">10</cn><apply id="A1.SS2.p1.4.m4.1.1.3.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3.3"><minus id="A1.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="A1.SS2.p1.4.m4.1.1.3.3"></minus><cn id="A1.SS2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="A1.SS2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m4.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. During training, we use the same augmentation strategy used to train the base models. We perform stitching at the first convolutional layer and at the first and last (residual) block of each layer leading to <math alttext="9" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m5.1"><semantics id="A1.SS2.p1.5.m5.1a"><mn id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><cn id="A1.SS2.p1.5.m5.1.1.cmml" type="integer" xref="A1.SS2.p1.5.m5.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">9</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m5.1d">9</annotation></semantics></math> stitching locations for all architectures considered. At all times, the stitching layer was initialized by DM using <math alttext="100" class="ltx_Math" display="inline" id="A1.SS2.p1.6.m6.1"><semantics id="A1.SS2.p1.6.m6.1a"><mn id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><cn id="A1.SS2.p1.6.m6.1.1.cmml" type="integer" xref="A1.SS2.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">100</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.6.m6.1d">100</annotation></semantics></math> samples for the training set.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.4"><span class="ltx_text ltx_font_bold" id="A1.SS2.p2.4.1">Model Stitching under Adversarial Training:</span> When performing stitching under adversarial training, we consider three <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_α</annotation></semantics></math> configurations, following <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib1" title="">1</a>]</cite>: <math alttext="\alpha=0" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><mrow id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mi id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml">α</mi><mo id="A1.SS2.p2.2.m2.1.1.1" xref="A1.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><eq id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1"></eq><ci id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2">𝛼</ci><cn id="A1.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">italic_α = 0</annotation></semantics></math> (stitching using only clean samples), <math alttext="\alpha=0.5" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><mrow id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml"><mi id="A1.SS2.p2.3.m3.1.1.2" xref="A1.SS2.p2.3.m3.1.1.2.cmml">α</mi><mo id="A1.SS2.p2.3.m3.1.1.1" xref="A1.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.p2.3.m3.1.1.3" xref="A1.SS2.p2.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><apply id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1"><eq id="A1.SS2.p2.3.m3.1.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1.1"></eq><ci id="A1.SS2.p2.3.m3.1.1.2.cmml" xref="A1.SS2.p2.3.m3.1.1.2">𝛼</ci><cn id="A1.SS2.p2.3.m3.1.1.3.cmml" type="float" xref="A1.SS2.p2.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">\alpha=0.5</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">italic_α = 0.5</annotation></semantics></math> (stitching using an equal mix of clean and adversarial examples), and <math alttext="\alpha=1" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m4.1"><semantics id="A1.SS2.p2.4.m4.1a"><mrow id="A1.SS2.p2.4.m4.1.1" xref="A1.SS2.p2.4.m4.1.1.cmml"><mi id="A1.SS2.p2.4.m4.1.1.2" xref="A1.SS2.p2.4.m4.1.1.2.cmml">α</mi><mo id="A1.SS2.p2.4.m4.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS2.p2.4.m4.1.1.3" xref="A1.SS2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.1b"><apply id="A1.SS2.p2.4.m4.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1"><eq id="A1.SS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1"></eq><ci id="A1.SS2.p2.4.m4.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.2">𝛼</ci><cn id="A1.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="A1.SS2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m4.1d">italic_α = 1</annotation></semantics></math> (stitching using only adversarial examples). The adversarial examples were generated for the stitched model using the same hyperparameters as those used to train the robust models.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.2"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.2.1">Model Stitching under Shortcut:</span> We consider various shortcut settings, namely: (i) patterns that correlate with the class at random locations, (ii) random patterns (uniform noise) at fixed locations correlated with the class, and (iii) a combination of both. For the patterns, we use either <math alttext="4\times 4" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><mrow id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mn id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">4</mn><mo id="A1.SS2.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p3.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><times id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1"></times><cn id="A1.SS2.p3.1.m1.1.1.2.cmml" type="integer" xref="A1.SS2.p3.1.m1.1.1.2">4</cn><cn id="A1.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">4\times 4</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">4 × 4</annotation></semantics></math> squares of fixed values depending on the class—referred to as pixels—or <math alttext="4\times 4" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><mrow id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mn id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">4</mn><mo id="A1.SS2.p3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p3.2.m2.1.1.1.cmml">×</mo><mn id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><times id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1.1"></times><cn id="A1.SS2.p3.2.m2.1.1.2.cmml" type="integer" xref="A1.SS2.p3.2.m2.1.1.2">4</cn><cn id="A1.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p3.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">4\times 4</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">4 × 4</annotation></semantics></math> ArUco markers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib15" title="">15</a>]</cite>. An example of these shortcut configurations is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#A1.F12" title="Figure 12 ‣ A.2 Stitching Training ‣ Appendix A Experimental Setup ‣ Model Stitching by Functional Latent Alignment"><span class="ltx_text ltx_ref_tag">12</span></a>.</p>
</div>
<figure class="ltx_figure" id="A1.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="211" id="A1.F12.g1" src="x15.png" width="249"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F12.2.1.1" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" id="A1.F12.3.2" style="font-size:90%;">Visualizing shortcut configurations.</span></figcaption>
</figure>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p4.1.1">Cross-Layer Stitching:</span> During cross-layer stitching, we train the affine transformation using the same training configuration as used for the corresponding layer stitching. We performed stitching for all <math alttext="9\times 9" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mn id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">9</mn><mo id="A1.SS2.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p4.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><times id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1"></times><cn id="A1.SS2.p4.1.m1.1.1.2.cmml" type="integer" xref="A1.SS2.p4.1.m1.1.1.2">9</cn><cn id="A1.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p4.1.m1.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">9\times 9</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">9 × 9</annotation></semantics></math> layer combinations. When stitching layers that produce feature maps of different spatial resolutions, we follow <cite class="ltx_cite ltx_citemacro_citet">Balogh and Jelasity [<a class="ltx_ref" href="https://arxiv.org/html/2505.20142v1#bib.bib2" title="">2</a>]</cite> and use bilinear interpolation to match the resolution of the front feature maps to that of the end feature maps. To convert directional functional similarity into a non-directional measure, we averaged the functional similarities in both stitching directions. For example, the similarity between the 8<sup class="ltx_sup" id="A1.SS2.p4.1.2">th</sup> and 1<sup class="ltx_sup" id="A1.SS2.p4.1.3">st</sup> layers is computed as the average of the functional similarities when stitching from the 1<sup class="ltx_sup" id="A1.SS2.p4.1.4">st</sup> layer to the 8<sup class="ltx_sup" id="A1.SS2.p4.1.5">th</sup>, and from the 8<sup class="ltx_sup" id="A1.SS2.p4.1.6">th</sup> to the 1<sup class="ltx_sup" id="A1.SS2.p4.1.7">st</sup>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Full Results on Additional Architectures</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this section, we provide experimental results on additional architectures and shortcut learning settings.</p>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Model Stitching under Adversarial Training</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">When it comes to model stitching under adversarial training, we observe that identical conclusions can be drawn across all CNN architectures: both SLM and TLM stitching settings can fabricate alignment sufficient to solve the task. For example, task-based stitching can report high functional similarity with respect to adversarial accuracy even when stitching between non-robust models, while FuLA and Hint can achieve non-zero adversarial robustness only when at least one of the stitched models is robust. Additionally, in almost all cases, FuLA outperforms Hint in stitching performance. As discussed in the main paper, cases where FuLA underperforms compared to Hint may indicate functional misalignment at deeper layers, which Hint may fail to detect.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A2.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="496" id="A2.F13.g1" src="x16.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F13.2.1.1" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" id="A2.F13.3.2" style="font-size:90%;">Cross-task stitching under AT – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="515" id="A2.F14.g1" src="x17.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F14.2.1.1" style="font-size:90%;">Figure 14</span>: </span><span class="ltx_text" id="A2.F14.3.2" style="font-size:90%;">Same-task stitching under AT – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A2.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="496" id="A2.F15.g1" src="x18.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F15.2.1.1" style="font-size:90%;">Figure 15</span>: </span><span class="ltx_text" id="A2.F15.3.2" style="font-size:90%;">Cross-task stitching under AT – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="515" id="A2.F16.g1" src="x19.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F16.2.1.1" style="font-size:90%;">Figure 16</span>: </span><span class="ltx_text" id="A2.F16.3.2" style="font-size:90%;">Same-task stitching under AT – ResNet18.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A2.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="496" id="A2.F17.g1" src="x20.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F17.2.1.1" style="font-size:90%;">Figure 17</span>: </span><span class="ltx_text" id="A2.F17.3.2" style="font-size:90%;">Cross-task stitching under AT – ResNet34.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F18"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="508" id="A2.F18.g1" src="x21.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F18.2.1.1" style="font-size:90%;">Figure 18</span>: </span><span class="ltx_text" id="A2.F18.3.2" style="font-size:90%;">Same-task stitching under AT – ResNet34.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Model Stitching under Shortcuts</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">We observe that all architectures considered exhibit similar behavior across the different shortcut settings. In particular, task-based stitching tends to overfit to the shortcuts—achieving high performance on them but reduced performance on clean data—indicating that both SLM and TLM opt for alignments that maximize task performance, which can be problematic for evaluating functional similarity. Once again, FuLA outperforms Hint, while performance on clean data remains relatively stable across the different shortcut settings. This suggests that FuLA captures a more meaningful notion of functional alignment.</p>
</div>
<figure class="ltx_figure" id="A2.F19"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="289" id="A2.F19.g1" src="x22.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F19.2.1.1" style="font-size:90%;">Figure 19</span>: </span><span class="ltx_text" id="A2.F19.3.2" style="font-size:90%;">Cross-task stitching under shortcuts – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F20"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="295" id="A2.F20.g1" src="x23.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F20.2.1.1" style="font-size:90%;">Figure 20</span>: </span><span class="ltx_text" id="A2.F20.3.2" style="font-size:90%;">Same-task stitching under shortcuts – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F21"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="289" id="A2.F21.g1" src="x24.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F21.2.1.1" style="font-size:90%;">Figure 21</span>: </span><span class="ltx_text" id="A2.F21.3.2" style="font-size:90%;">Cross-task stitching under shortcuts – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F22"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="295" id="A2.F22.g1" src="x25.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F22.2.1.1" style="font-size:90%;">Figure 22</span>: </span><span class="ltx_text" id="A2.F22.3.2" style="font-size:90%;">Same-task stitching under shortcuts – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F23"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="289" id="A2.F23.g1" src="x26.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F23.2.1.1" style="font-size:90%;">Figure 23</span>: </span><span class="ltx_text" id="A2.F23.3.2" style="font-size:90%;">Cross-task stitching under shortcuts – ResNet34.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F24"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="295" id="A2.F24.g1" src="x27.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F24.2.1.1" style="font-size:90%;">Figure 24</span>: </span><span class="ltx_text" id="A2.F24.3.2" style="font-size:90%;">Same-task stitching under shortcuts – ResNet34.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Model Stitching on a Subset of Classes</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">When training on a subset of classes, FuLA demonstrates greater robustness, where alignment on the subset leads to improved stitching performance across all classes. This effect is more pronounced in the cross-task setting, but it is also observable in the same-task setting.</p>
</div>
<figure class="ltx_figure" id="A2.F25"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="323" id="A2.F25.g1" src="x28.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F25.2.1.1" style="font-size:90%;">Figure 25</span>: </span><span class="ltx_text" id="A2.F25.3.2" style="font-size:90%;">Stitching on a subset of classes – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F26"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="323" id="A2.F26.g1" src="x29.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F26.2.1.1" style="font-size:90%;">Figure 26</span>: </span><span class="ltx_text" id="A2.F26.3.2" style="font-size:90%;">Stitching on a subset of classes – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F27"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="323" id="A2.F27.g1" src="x30.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F27.2.1.1" style="font-size:90%;">Figure 27</span>: </span><span class="ltx_text" id="A2.F27.3.2" style="font-size:90%;">Stitching on a subset of classes – ResNet34.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Cross Layer Stitching</h3>
<div class="ltx_para" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1">Cross-layer stitching reveals that the directionality of functional similarity is not induced by the task, as we also observe it when stitching under FuLA, which is task-agnostic. When applicable, enforcing non-directionality at a post-hoc stage appears to improve the corresponding layer detection performance across all settings. As expected, the benefit of converting Hint into a non-directional metric is smaller, since Hint is already regularized to be less directional during training.</p>
</div>
<figure class="ltx_figure" id="A2.F28"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="577" id="A2.F28.g1" src="x31.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F28.2.1.1" style="font-size:90%;">Figure 28</span>: </span><span class="ltx_text" id="A2.F28.3.2" style="font-size:90%;">Cross-layer stitching – ResNet18 (w/o residuals).</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F29"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="573" id="A2.F29.g1" src="x32.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F29.2.1.1" style="font-size:90%;">Figure 29</span>: </span><span class="ltx_text" id="A2.F29.3.2" style="font-size:90%;">Cross-layer stitching – ResNet18.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A2.F30"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="578" id="A2.F30.g1" src="x33.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F30.2.1.1" style="font-size:90%;">Figure 30</span>: </span><span class="ltx_text" id="A2.F30.3.2" style="font-size:90%;">Cross-layer stitching – ResNet34.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon May 26 15:41:04 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
