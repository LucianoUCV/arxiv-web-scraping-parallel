<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance</title>
<!--Generated on Mon May 26 17:06:09 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.20229v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S1" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S2" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Prelimenaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.SS1" title="In 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Sparse autoencoders for extracting interpretable components</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.SS2" title="In 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Understanding what semantics components encode</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.SS3" title="In 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Understanding component-output alignment with Logit Lens</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS1" title="In 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Instance-wise attribution of components</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="In 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Revealing unexpected concept reliance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS1" title="In 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Evaluating attribution faithfulness (Q1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS2" title="In 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Interpretability and diversity of SAE components (Q2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS3" title="In 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Robustness of CLIP to semantic ambiguity and spurious correlations (Q3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS4" title="In 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Case study: spurious correlation analysis in melanoma detection (Q4)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S6" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Experimental settings</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1.SS0.SSS0.Px1" title="In Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1.SS0.SSS0.Px2" title="In Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1.SS0.SSS0.Px3" title="In Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Sparse autoencoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1.SS0.SSS0.Px4" title="In Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Computational resources</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Latent component attributions</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.SS1" title="In Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Approximation of activation times gradient</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.SS2" title="In Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Evaluating faithfulness of attributions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Interpretability and diversity of SAE components</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.SS1" title="In Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Interpretability correlates with activation magnitude</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.SS2" title="In Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Finding unexpected components and concepts</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Robustness analysis of CLIP</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4.SS1" title="In Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Finding failure modes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4.SS2" title="In Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Evaluating failure modes</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5" title="In From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Medical case study: melanoma detection</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5.SS0.SSS0.Px1" title="In Appendix E Medical case study: melanoma detection ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Image-level red hue augmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5.SS0.SSS0.Px2" title="In Appendix E Medical case study: melanoma detection ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_title">Latent-level red hue augmentation</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maximilian Dreyer<sup class="ltx_sup" id="id25.11.id1"><span class="ltx_text ltx_font_italic" id="id25.11.id1.1">1</span></sup>  Lorenz Hufe<sup class="ltx_sup" id="id26.12.id2"><span class="ltx_text ltx_font_italic" id="id26.12.id2.1">1</span></sup>  Jim Berend<sup class="ltx_sup" id="id27.13.id3">1</sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.4">Thomas Wiegand<sup class="ltx_sup" id="id7.7.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.4.1.1">1,2,3</span></sup>  Sebastian Lapuschkin<sup class="ltx_sup" id="id7.7.4.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.4.2.1">1,4</span></sup>  Wojciech Samek<sup class="ltx_sup" id="id7.7.4.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.4.3.1">1,2,3</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id7.7.4.4"><span class="ltx_text ltx_font_medium" id="id7.7.4.4.1">1</span></sup></span>Fraunhofer Heinrich Hertz Institute  <sup class="ltx_sup" id="id28.14.id4">2</sup>Technische Universität Berlin 
<br class="ltx_break"/><sup class="ltx_sup" id="id29.15.id5">3</sup>BIFOLD – Berlin Institute for the Foundations of Learning and Data
<br class="ltx_break"/><sup class="ltx_sup" id="id30.16.id6">4</sup>Centre of eXplainable Artificial Intelligence, Technological University Dublin 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id31.17.id7">{wojciech.samek,sebastian.lapuschkin}@hhi.fraunhofer.de
<br class="ltx_break"/></span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id32.id1">Transformer-based CLIP models are widely used for text-image probing and feature extraction, making it relevant to understand the internal mechanisms behind their predictions. While recent works show that Sparse Autoencoders (SAEs) yield interpretable latent components, they focus on <em class="ltx_emph ltx_font_italic" id="id32.id1.1">what</em> these encode and miss <em class="ltx_emph ltx_font_italic" id="id32.id1.2">how</em> they drive predictions. We introduce a scalable framework that reveals what latent components activate for, how they align with expected semantics, and how important they are to predictions. To achieve this, we adapt attribution patching for instance-wise component attributions in CLIP and highlight key faithfulness limitations of the widely used Logit Lens technique. By combining attributions with semantic alignment scores, we can automatically uncover reliance on components that encode semantically unexpected or spurious concepts. Applied across multiple CLIP variants, our method uncovers hundreds of surprising components linked to polysemous words, compound nouns, visual typography and dataset artifacts. While text embeddings remain prone to semantic ambiguity, they are more robust to spurious correlations compared to linear classifiers trained on image embeddings. A case study on skin lesion detection highlights how such classifiers can amplify hidden shortcuts, underscoring the need for holistic, mechanistic interpretability.
We provide code at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/maxdreyer/attributing-clip" title="">https://github.com/maxdreyer/attributing-clip</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Vision-language models such as CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib39" title="">39</a>]</cite> are trained in semi-supervised fashion on paired images and text to learn a wide range of visual concepts without requiring explicit human annotation.
These models are widely adopted as feature encoders in larger vision-language systems for tasks such as retrieval, captioning, and reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib55" title="">55</a>]</cite>.
While semi-supervised training is scalable and enables strong generalization across diverse domains, it also raises fundamental questions: What kinds of patterns do CLIP models rely on? And how do these align – or misalign – with human expectations?</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Prior work has focused on explaining CLIP’s representations via human-expected concepts, relying on predefined concept sets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib54" title="">54</a>]</cite>. However, such approaches tend to overlook features that emerge from biases in image-text data, including spurious correlations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib52" title="">52</a>]</cite> and ambiguous linguistic cues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib28" title="">28</a>]</cite>. As a result, key aspects of model behavior may remain hidden.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">An alternative line of research investigates internal components of neural networks, such as neurons or latent dimensions. These methods aim to provide an explanation of the full spectrum of learned semantic signals that a model perceives. For convolutional neural networks, recent frameworks such as SemanticLens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib12" title="">12</a>]</cite> and WWW <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib2" title="">2</a>]</cite> have enabled such analyses by measuring what components encode (by providing textual descriptions) and how they influence model outputs via latent attribution scores. However, these techniques are not directly applicable to CLIP’s <span class="ltx_glossaryref" title="">Vision Transformer (ViT)</span>-based architecture due to its lack of interpretable intermediate representations and the absence of attribution methods in latent space.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">While the Logit Lens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib4" title="">4</a>]</cite> approach for probing component<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" stretchy="false" xref="S1.p4.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">↔</annotation></semantics></math>output relations in language models offers a <em class="ltx_emph ltx_font_italic" id="S1.p4.2.1">global</em> alignment measure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib6" title="">6</a>]</cite>, it does not capture <em class="ltx_emph ltx_font_italic" id="S1.p4.2.2">instance-wise</em> attribution or interaction effects <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib19" title="">19</a>]</cite>. Alternatively, attribution patching <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib34" title="">34</a>]</cite>, which is related to Input<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mo id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><times id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">×</annotation></semantics></math>Gradient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib46" title="">46</a>]</cite> attributions in latent space, represents an efficient alternative for attributing weights or components in language models relevant for a specific behavior.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="264" id="S1.F1.g1" src="x1.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A framework for interpreting CLIP via latent attributions.
a) Sparse autoencoders (SAEs) extract a diverse set of interpretable latent components from CLIP representations. Each component is assigned a textual label from an expected set of concepts.
b) Instance-wise attribution scores quantify each component’s contribution to model predictions.
c) Attribution reveals unexpected model behavior,
including components that are unusually predictive relative to a baseline expectation (e.g., on a test set) or lack strong semantic alignment to expected textual labels.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.2">In this work, we adapt attribution patching for text-image probing with CLIP, enabling a more faithful quantification of how latent components contribute to outputs compared to Logit Lens, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S1.F1" title="In 1 Introduction ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>. We further build on recent advances in sparse dictionary learning and employ <span class="ltx_glossaryref" title="">Sparse Autoencoders (SAEs)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib7" title="">7</a>]</cite> to extract interpretable components from CLIP’s latent representations. By combining SAEs with attributions, we provide the first framework for scalable component-level analysis of CLIP models that explains both input<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mo id="S1.p5.1.m1.1.1" stretchy="false" xref="S1.p5.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">↔</annotation></semantics></math>component and component<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mo id="S1.p5.2.m2.1.1" stretchy="false" xref="S1.p5.2.m2.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">↔</annotation></semantics></math>output relations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our approach, applied to the final embeddings after the last transformer block, reveals the relevance of hundreds of unexpected or unintended features, often arising from polysemous words, compound nouns, visual typography, or spurious correlations. We benchmark various CLIP architectures and show that even larger models exhibit such issues, suggesting practical limitations in how textual inputs are encoded. Finally, we apply our framework to the domain of skin lesion classification, where we identify and correct the reliance on background features, measurably improving robustness.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text ltx_font_bold" id="S1.p7.1.1">Contributions:</span>
The contributions of this work are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Instance-wise component attribution:</span> We adapt attribution patching to CLIP, enabling instance-specific attribution of latent components. We draw an intrinsic connection to the Logit Lens technique and highlight its limitations for achieving locally faithful explanations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Diverse and interpretable components with SAEs:</span> Through sparse autoencoding, we discover a rich set of interpretable components within CLIP models. Notably, highly relevant latents tend to be more interpretable than weak latents.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">A holistic framework for revealing failure cases:</span> We combine latent attributions with semantic descriptions of highly activating samples, allowing to analyze <em class="ltx_emph ltx_font_italic" id="S1.I1.i3.p1.1.2">what</em> and <em class="ltx_emph ltx_font_italic" id="S1.I1.i3.p1.1.3">how</em> concepts are used. This enables to probe for outlier behaviors by identifying relevant concepts that deviate from expected semantics or expected importance patterns.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Systematic analysis of text-embedding failures:</span> We identify persistent issues in text embeddings across multiple CLIP variants, stemming from ambiguous textual alignment.
However, compared to training linear classifiers on visual embeddings, text-based probing shows greater robustness against dataset-specific spurious correlations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i5.p1.1.1">Case study for downstream applications:</span> In a skin lesion classification task, we demonstrate that naively training linear classifiers on CLIP embeddings risks amplifying hidden spurious correlations, thereby reducing robustness in application.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Understanding CLIP representations:</span>
A line of work on interpreting CLIP and other vision-language models focuses on decomposing latent embeddings into a set of predefined, human-interpretable concepts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib54" title="">54</a>]</cite>. These methods generally evaluate alignment to known textual labels but struggle to capture the full diversity of learned features, particularly unexpected or spurious ones.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">For a more comprehensive understanding, component-level understanding is essential.
To this end, studies have begun to examine attention heads and MLP neurons <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib10" title="">10</a>]</cite>. Alternatively, visual embeddings in CLIP’s last layer can be decomposed into a diverse set of interpretable components using <span class="ltx_glossaryref" title="">SAEs</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib25" title="">25</a>]</cite>, which have been originally proposed for language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib7" title="">7</a>]</cite>.
Rao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib40" title="">40</a>]</cite> train linear classifiers directly on <span class="ltx_glossaryref" title="">SAEs</span> activations for downstream-tasks, but, as such, can no longer explain the original CLIP model.
Other works based on <span class="ltx_glossaryref" title="">SAEs</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib48" title="">48</a>]</cite> successfully explain <em class="ltx_emph ltx_font_italic" id="S2.p2.1.1">what</em> components encode and represent, yet overlook <em class="ltx_emph ltx_font_italic" id="S2.p2.1.2">how</em> they influence specific predictions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.2"><span class="ltx_text ltx_font_bold" id="S2.p3.2.1">Holistic interpretability frameworks:</span>
Comprehensive interpretability frameworks aim to analyze both input<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mo id="S2.p3.1.m1.1.1" stretchy="false" xref="S2.p3.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">↔</annotation></semantics></math>component and component<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mo id="S2.p3.2.m2.1.1" stretchy="false" xref="S2.p3.2.m2.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">↔</annotation></semantics></math>output relations.
CRP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib1" title="">1</a>]</cite> and CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib16" title="">16</a>]</cite> map neurons to highly activating examples and compute relevance scores for predictions. WWW <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib2" title="">2</a>]</cite> and SemanticLens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib12" title="">12</a>]</cite> further assign textual labels to components. While these approaches allow for a comprehensive understanding effective for debugging and scientific discovery, they are typically limited to individual filters or neurons in convolutional networks.
<span class="ltx_glossaryref" title="">SAEs</span> enable the extraction of interpretable components for CLIP, but how to compute attributions remains an open challenge.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Latent attributions:</span>
For convolutional networks and image data, feature attribution methods such as Input<math alttext="\times" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mo id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><times id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">×</annotation></semantics></math>Gradient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib46" title="">46</a>]</cite>, GradCAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib45" title="">45</a>]</cite>, and LRP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib3" title="">3</a>]</cite> have been developed to identify input pixels relevant to a model’s prediction. Recent work on vision models has extended input attributions to latent representations, enabling both local <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib15" title="">15</a>]</cite> and global <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib11" title="">11</a>]</cite> analysis of latent components.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">For interpreting transformer-based language models, Logit Lens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib4" title="">4</a>]</cite> has emerged as a popular tool by projecting intermediate activations directly to output logits <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib6" title="">6</a>]</cite>. While this method provides a global measure for output alignment, it is limited in its ability to reveal which specific latents contribute to particular outputs.
Alternatively, activation patching has been proposed as a causal intervention technique to identify neurons and weights responsible for specific behaviors <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib51" title="">51</a>]</cite>. As this method requires multiple forward passes, attribution patching based on output gradients has been proposed as a more efficient alternative <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib34" title="">34</a>]</cite>, also applied for <span class="ltx_glossaryref" title="">SAE</span> components recently <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib32" title="">32</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">While there is growing interest in interpreting large vision-language models, few approaches offer holistic and scalable tools that operate at the component level. Attribution scores for <span class="ltx_glossaryref" title="">ViT</span> s and CLIP have remained largely unexplored, and existing tools typically fall short in revealing how exactly CLIP relies on its components.
Our work bridges this gap by combining SAEs with a novel adaptation of attribution patching for CLIP. This enables systematic identification of the components most responsible for specific predictions, even when they encode unexpected or spurious concepts. Unlike previous work, our framework is designed to support the full pipeline of discovering, labeling,
and attributing latent components in CLIP models.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Prelimenaries</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The following section introduces <span class="ltx_glossaryref" title="">SAEs</span>, textual labeling of components and the Logit Lens technique.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Sparse autoencoders for extracting interpretable components</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">One major challenge in transformer interpretability lies in the often non-interpretable and polysemantic nature of individual neurons <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib13" title="">13</a>]</cite>. Motivated by the sparse feature hypothesis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib36" title="">36</a>]</cite>, recent advancements in sparse dictionary learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib7" title="">7</a>]</cite> have shown that <span class="ltx_glossaryref" title="">SAEs</span> can effectively identify interpretable monosemantic directions in representations.
For a latent representation <math alttext="\mathbf{x}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐱</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐱</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{x}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> of dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_d</annotation></semantics></math> in a hidden layer, the <span class="ltx_glossaryref" title="">SAE</span> computes a decomposition as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\mathbf{x}}=\hat{\mathbf{x}}(\mathbf{x})+\boldsymbol{\varepsilon}(\mathbf{x})%
=\sum_{i=1}^{d_{\text{SAE}}}a_{i}(\mathbf{x})\mathbf{v}_{i}+\mathbf{b}+%
\boldsymbol{\varepsilon}(\mathbf{x})~{}." class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.4" xref="S3.E1.m1.5.5.1.1.4.cmml"><mrow id="S3.E1.m1.5.5.1.1.4.2" xref="S3.E1.m1.5.5.1.1.4.2.cmml"><mover accent="true" id="S3.E1.m1.5.5.1.1.4.2.2" xref="S3.E1.m1.5.5.1.1.4.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.4.2.2.2" xref="S3.E1.m1.5.5.1.1.4.2.2.2.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.4.2.2.1" xref="S3.E1.m1.5.5.1.1.4.2.2.1.cmml">^</mo></mover><mo id="S3.E1.m1.5.5.1.1.4.2.1" xref="S3.E1.m1.5.5.1.1.4.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.4.2.3.2" xref="S3.E1.m1.5.5.1.1.4.2.cmml"><mo id="S3.E1.m1.5.5.1.1.4.2.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.4.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.4.2.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.4.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.4.1" xref="S3.E1.m1.5.5.1.1.4.1.cmml">+</mo><mrow id="S3.E1.m1.5.5.1.1.4.3" xref="S3.E1.m1.5.5.1.1.4.3.cmml"><mi id="S3.E1.m1.5.5.1.1.4.3.2" xref="S3.E1.m1.5.5.1.1.4.3.2.cmml">𝜺</mi><mo id="S3.E1.m1.5.5.1.1.4.3.1" xref="S3.E1.m1.5.5.1.1.4.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.4.3.3.2" xref="S3.E1.m1.5.5.1.1.4.3.cmml"><mo id="S3.E1.m1.5.5.1.1.4.3.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.4.3.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.4.3.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.5" rspace="0.111em" xref="S3.E1.m1.5.5.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.6" xref="S3.E1.m1.5.5.1.1.6.cmml"><mrow id="S3.E1.m1.5.5.1.1.6.2" xref="S3.E1.m1.5.5.1.1.6.2.cmml"><munderover id="S3.E1.m1.5.5.1.1.6.2.1" xref="S3.E1.m1.5.5.1.1.6.2.1.cmml"><mo id="S3.E1.m1.5.5.1.1.6.2.1.2.2" movablelimits="false" xref="S3.E1.m1.5.5.1.1.6.2.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.5.5.1.1.6.2.1.2.3" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1.6.2.1.2.3.2" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.5.5.1.1.6.2.1.2.3.1" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.5.5.1.1.6.2.1.2.3.3" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.5.5.1.1.6.2.1.3" xref="S3.E1.m1.5.5.1.1.6.2.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.6.2.1.3.2" xref="S3.E1.m1.5.5.1.1.6.2.1.3.2.cmml">d</mi><mtext id="S3.E1.m1.5.5.1.1.6.2.1.3.3" xref="S3.E1.m1.5.5.1.1.6.2.1.3.3a.cmml">SAE</mtext></msub></munderover><mrow id="S3.E1.m1.5.5.1.1.6.2.2" xref="S3.E1.m1.5.5.1.1.6.2.2.cmml"><msub id="S3.E1.m1.5.5.1.1.6.2.2.2" xref="S3.E1.m1.5.5.1.1.6.2.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.6.2.2.2.2" xref="S3.E1.m1.5.5.1.1.6.2.2.2.2.cmml">a</mi><mi id="S3.E1.m1.5.5.1.1.6.2.2.2.3" xref="S3.E1.m1.5.5.1.1.6.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.5.5.1.1.6.2.2.1" xref="S3.E1.m1.5.5.1.1.6.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.6.2.2.3.2" xref="S3.E1.m1.5.5.1.1.6.2.2.cmml"><mo id="S3.E1.m1.5.5.1.1.6.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.6.2.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.6.2.2.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.6.2.2.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.6.2.2.1a" xref="S3.E1.m1.5.5.1.1.6.2.2.1.cmml">⁢</mo><msub id="S3.E1.m1.5.5.1.1.6.2.2.4" xref="S3.E1.m1.5.5.1.1.6.2.2.4.cmml"><mi id="S3.E1.m1.5.5.1.1.6.2.2.4.2" xref="S3.E1.m1.5.5.1.1.6.2.2.4.2.cmml">𝐯</mi><mi id="S3.E1.m1.5.5.1.1.6.2.2.4.3" xref="S3.E1.m1.5.5.1.1.6.2.2.4.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.6.1" xref="S3.E1.m1.5.5.1.1.6.1.cmml">+</mo><mi id="S3.E1.m1.5.5.1.1.6.3" xref="S3.E1.m1.5.5.1.1.6.3.cmml">𝐛</mi><mo id="S3.E1.m1.5.5.1.1.6.1a" xref="S3.E1.m1.5.5.1.1.6.1.cmml">+</mo><mrow id="S3.E1.m1.5.5.1.1.6.4" xref="S3.E1.m1.5.5.1.1.6.4.cmml"><mi id="S3.E1.m1.5.5.1.1.6.4.2" xref="S3.E1.m1.5.5.1.1.6.4.2.cmml">𝜺</mi><mo id="S3.E1.m1.5.5.1.1.6.4.1" xref="S3.E1.m1.5.5.1.1.6.4.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.6.4.3.2" xref="S3.E1.m1.5.5.1.1.6.4.cmml"><mo id="S3.E1.m1.5.5.1.1.6.4.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.6.4.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.1.1.6.4.3.2.2" rspace="0.052em" stretchy="false" xref="S3.E1.m1.5.5.1.1.6.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><and id="S3.E1.m1.5.5.1.1a.cmml" xref="S3.E1.m1.5.5.1"></and><apply id="S3.E1.m1.5.5.1.1b.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"></eq><ci id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2">𝐱</ci><apply id="S3.E1.m1.5.5.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.4"><plus id="S3.E1.m1.5.5.1.1.4.1.cmml" xref="S3.E1.m1.5.5.1.1.4.1"></plus><apply id="S3.E1.m1.5.5.1.1.4.2.cmml" xref="S3.E1.m1.5.5.1.1.4.2"><times id="S3.E1.m1.5.5.1.1.4.2.1.cmml" xref="S3.E1.m1.5.5.1.1.4.2.1"></times><apply id="S3.E1.m1.5.5.1.1.4.2.2.cmml" xref="S3.E1.m1.5.5.1.1.4.2.2"><ci id="S3.E1.m1.5.5.1.1.4.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.4.2.2.1">^</ci><ci id="S3.E1.m1.5.5.1.1.4.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.4.2.2.2">𝐱</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐱</ci></apply><apply id="S3.E1.m1.5.5.1.1.4.3.cmml" xref="S3.E1.m1.5.5.1.1.4.3"><times id="S3.E1.m1.5.5.1.1.4.3.1.cmml" xref="S3.E1.m1.5.5.1.1.4.3.1"></times><ci id="S3.E1.m1.5.5.1.1.4.3.2.cmml" xref="S3.E1.m1.5.5.1.1.4.3.2">𝜺</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐱</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.1.1c.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.5"></eq><share href="https://arxiv.org/html/2505.20229v1#S3.E1.m1.5.5.1.1.4.cmml" id="S3.E1.m1.5.5.1.1d.cmml" xref="S3.E1.m1.5.5.1"></share><apply id="S3.E1.m1.5.5.1.1.6.cmml" xref="S3.E1.m1.5.5.1.1.6"><plus id="S3.E1.m1.5.5.1.1.6.1.cmml" xref="S3.E1.m1.5.5.1.1.6.1"></plus><apply id="S3.E1.m1.5.5.1.1.6.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2"><apply id="S3.E1.m1.5.5.1.1.6.2.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.6.2.1.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.6.2.1.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.6.2.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1">subscript</csymbol><sum id="S3.E1.m1.5.5.1.1.6.2.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.2.2"></sum><apply id="S3.E1.m1.5.5.1.1.6.2.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3"><eq id="S3.E1.m1.5.5.1.1.6.2.1.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.1"></eq><ci id="S3.E1.m1.5.5.1.1.6.2.1.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.2">𝑖</ci><cn id="S3.E1.m1.5.5.1.1.6.2.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.6.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.5.5.1.1.6.2.1.3.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.6.2.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.6.2.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.3.2">𝑑</ci><ci id="S3.E1.m1.5.5.1.1.6.2.1.3.3a.cmml" xref="S3.E1.m1.5.5.1.1.6.2.1.3.3"><mtext id="S3.E1.m1.5.5.1.1.6.2.1.3.3.cmml" mathsize="50%" xref="S3.E1.m1.5.5.1.1.6.2.1.3.3">SAE</mtext></ci></apply></apply><apply id="S3.E1.m1.5.5.1.1.6.2.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2"><times id="S3.E1.m1.5.5.1.1.6.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.1"></times><apply id="S3.E1.m1.5.5.1.1.6.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.6.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.6.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.2.2">𝑎</ci><ci id="S3.E1.m1.5.5.1.1.6.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐱</ci><apply id="S3.E1.m1.5.5.1.1.6.2.2.4.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.6.2.2.4.1.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.4">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.6.2.2.4.2.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.4.2">𝐯</ci><ci id="S3.E1.m1.5.5.1.1.6.2.2.4.3.cmml" xref="S3.E1.m1.5.5.1.1.6.2.2.4.3">𝑖</ci></apply></apply></apply><ci id="S3.E1.m1.5.5.1.1.6.3.cmml" xref="S3.E1.m1.5.5.1.1.6.3">𝐛</ci><apply id="S3.E1.m1.5.5.1.1.6.4.cmml" xref="S3.E1.m1.5.5.1.1.6.4"><times id="S3.E1.m1.5.5.1.1.6.4.1.cmml" xref="S3.E1.m1.5.5.1.1.6.4.1"></times><ci id="S3.E1.m1.5.5.1.1.6.4.2.cmml" xref="S3.E1.m1.5.5.1.1.6.4.2">𝜺</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">{\mathbf{x}}=\hat{\mathbf{x}}(\mathbf{x})+\boldsymbol{\varepsilon}(\mathbf{x})%
=\sum_{i=1}^{d_{\text{SAE}}}a_{i}(\mathbf{x})\mathbf{v}_{i}+\mathbf{b}+%
\boldsymbol{\varepsilon}(\mathbf{x})~{}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">bold_x = over^ start_ARG bold_x end_ARG ( bold_x ) + bold_italic_ε ( bold_x ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_x ) bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + bold_b + bold_italic_ε ( bold_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.8">This formulation reconstructs the representation <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m1.1"><semantics id="S3.SS1.p1.3.m1.1a"><mi id="S3.SS1.p1.3.m1.1.1" xref="S3.SS1.p1.3.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><ci id="S3.SS1.p1.3.m1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m1.1d">bold_x</annotation></semantics></math> through a sparse combination of <math alttext="d_{\text{SAE}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m2.1"><semantics id="S3.SS1.p1.4.m2.1a"><msub id="S3.SS1.p1.4.m2.1.1" xref="S3.SS1.p1.4.m2.1.1.cmml"><mi id="S3.SS1.p1.4.m2.1.1.2" xref="S3.SS1.p1.4.m2.1.1.2.cmml">d</mi><mtext id="S3.SS1.p1.4.m2.1.1.3" xref="S3.SS1.p1.4.m2.1.1.3a.cmml">SAE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m2.1b"><apply id="S3.SS1.p1.4.m2.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m2.1.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m2.1.1.2.cmml" xref="S3.SS1.p1.4.m2.1.1.2">𝑑</ci><ci id="S3.SS1.p1.4.m2.1.1.3a.cmml" xref="S3.SS1.p1.4.m2.1.1.3"><mtext id="S3.SS1.p1.4.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.4.m2.1.1.3">SAE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m2.1c">d_{\text{SAE}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m2.1d">italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT</annotation></semantics></math> feature vectors <math alttext="\mathbf{v}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m3.1"><semantics id="S3.SS1.p1.5.m3.1a"><mrow id="S3.SS1.p1.5.m3.1.1" xref="S3.SS1.p1.5.m3.1.1.cmml"><msub id="S3.SS1.p1.5.m3.1.1.2" xref="S3.SS1.p1.5.m3.1.1.2.cmml"><mi id="S3.SS1.p1.5.m3.1.1.2.2" xref="S3.SS1.p1.5.m3.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS1.p1.5.m3.1.1.2.3" xref="S3.SS1.p1.5.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.5.m3.1.1.1" xref="S3.SS1.p1.5.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.5.m3.1.1.3" xref="S3.SS1.p1.5.m3.1.1.3.cmml"><mi id="S3.SS1.p1.5.m3.1.1.3.2" xref="S3.SS1.p1.5.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.5.m3.1.1.3.3" xref="S3.SS1.p1.5.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m3.1b"><apply id="S3.SS1.p1.5.m3.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1"><in id="S3.SS1.p1.5.m3.1.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1.1"></in><apply id="S3.SS1.p1.5.m3.1.1.2.cmml" xref="S3.SS1.p1.5.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m3.1.1.2.1.cmml" xref="S3.SS1.p1.5.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.5.m3.1.1.2.2.cmml" xref="S3.SS1.p1.5.m3.1.1.2.2">𝐯</ci><ci id="S3.SS1.p1.5.m3.1.1.2.3.cmml" xref="S3.SS1.p1.5.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.5.m3.1.1.3.cmml" xref="S3.SS1.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m3.1.1.3.1.cmml" xref="S3.SS1.p1.5.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.5.m3.1.1.3.2.cmml" xref="S3.SS1.p1.5.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.5.m3.1.1.3.3.cmml" xref="S3.SS1.p1.5.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m3.1c">\mathbf{v}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m3.1d">bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, with activations <math alttext="a_{i}(\mathbf{x})\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m4.1"><semantics id="S3.SS1.p1.6.m4.1a"><mrow id="S3.SS1.p1.6.m4.1.2" xref="S3.SS1.p1.6.m4.1.2.cmml"><mrow id="S3.SS1.p1.6.m4.1.2.2" xref="S3.SS1.p1.6.m4.1.2.2.cmml"><msub id="S3.SS1.p1.6.m4.1.2.2.2" xref="S3.SS1.p1.6.m4.1.2.2.2.cmml"><mi id="S3.SS1.p1.6.m4.1.2.2.2.2" xref="S3.SS1.p1.6.m4.1.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.6.m4.1.2.2.2.3" xref="S3.SS1.p1.6.m4.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.6.m4.1.2.2.1" xref="S3.SS1.p1.6.m4.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.6.m4.1.2.2.3.2" xref="S3.SS1.p1.6.m4.1.2.2.cmml"><mo id="S3.SS1.p1.6.m4.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p1.6.m4.1.2.2.cmml">(</mo><mi id="S3.SS1.p1.6.m4.1.1" xref="S3.SS1.p1.6.m4.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.6.m4.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p1.6.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.6.m4.1.2.1" xref="S3.SS1.p1.6.m4.1.2.1.cmml">∈</mo><mi id="S3.SS1.p1.6.m4.1.2.3" xref="S3.SS1.p1.6.m4.1.2.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m4.1b"><apply id="S3.SS1.p1.6.m4.1.2.cmml" xref="S3.SS1.p1.6.m4.1.2"><in id="S3.SS1.p1.6.m4.1.2.1.cmml" xref="S3.SS1.p1.6.m4.1.2.1"></in><apply id="S3.SS1.p1.6.m4.1.2.2.cmml" xref="S3.SS1.p1.6.m4.1.2.2"><times id="S3.SS1.p1.6.m4.1.2.2.1.cmml" xref="S3.SS1.p1.6.m4.1.2.2.1"></times><apply id="S3.SS1.p1.6.m4.1.2.2.2.cmml" xref="S3.SS1.p1.6.m4.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m4.1.2.2.2.1.cmml" xref="S3.SS1.p1.6.m4.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m4.1.2.2.2.2.cmml" xref="S3.SS1.p1.6.m4.1.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.6.m4.1.2.2.2.3.cmml" xref="S3.SS1.p1.6.m4.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.6.m4.1.1.cmml" xref="S3.SS1.p1.6.m4.1.1">𝐱</ci></apply><ci id="S3.SS1.p1.6.m4.1.2.3.cmml" xref="S3.SS1.p1.6.m4.1.2.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m4.1c">a_{i}(\mathbf{x})\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m4.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_x ) ∈ blackboard_R</annotation></semantics></math>, bias term <math alttext="\mathbf{b}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m5.1"><semantics id="S3.SS1.p1.7.m5.1a"><mrow id="S3.SS1.p1.7.m5.1.1" xref="S3.SS1.p1.7.m5.1.1.cmml"><mi id="S3.SS1.p1.7.m5.1.1.2" xref="S3.SS1.p1.7.m5.1.1.2.cmml">𝐛</mi><mo id="S3.SS1.p1.7.m5.1.1.1" xref="S3.SS1.p1.7.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m5.1.1.3" xref="S3.SS1.p1.7.m5.1.1.3.cmml"><mi id="S3.SS1.p1.7.m5.1.1.3.2" xref="S3.SS1.p1.7.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.7.m5.1.1.3.3" xref="S3.SS1.p1.7.m5.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m5.1b"><apply id="S3.SS1.p1.7.m5.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1"><in id="S3.SS1.p1.7.m5.1.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1.1"></in><ci id="S3.SS1.p1.7.m5.1.1.2.cmml" xref="S3.SS1.p1.7.m5.1.1.2">𝐛</ci><apply id="S3.SS1.p1.7.m5.1.1.3.cmml" xref="S3.SS1.p1.7.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m5.1.1.3.1.cmml" xref="S3.SS1.p1.7.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m5.1.1.3.2.cmml" xref="S3.SS1.p1.7.m5.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.7.m5.1.1.3.3.cmml" xref="S3.SS1.p1.7.m5.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m5.1c">\mathbf{b}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m5.1d">bold_b ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and an error term <math alttext="\boldsymbol{\varepsilon}(\mathbf{x})=\mathbf{x}-\hat{\mathbf{x}}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m6.2"><semantics id="S3.SS1.p1.8.m6.2a"><mrow id="S3.SS1.p1.8.m6.2.3" xref="S3.SS1.p1.8.m6.2.3.cmml"><mrow id="S3.SS1.p1.8.m6.2.3.2" xref="S3.SS1.p1.8.m6.2.3.2.cmml"><mi id="S3.SS1.p1.8.m6.2.3.2.2" xref="S3.SS1.p1.8.m6.2.3.2.2.cmml">𝜺</mi><mo id="S3.SS1.p1.8.m6.2.3.2.1" xref="S3.SS1.p1.8.m6.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m6.2.3.2.3.2" xref="S3.SS1.p1.8.m6.2.3.2.cmml"><mo id="S3.SS1.p1.8.m6.2.3.2.3.2.1" stretchy="false" xref="S3.SS1.p1.8.m6.2.3.2.cmml">(</mo><mi id="S3.SS1.p1.8.m6.1.1" xref="S3.SS1.p1.8.m6.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.8.m6.2.3.2.3.2.2" stretchy="false" xref="S3.SS1.p1.8.m6.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.8.m6.2.3.1" xref="S3.SS1.p1.8.m6.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.8.m6.2.3.3" xref="S3.SS1.p1.8.m6.2.3.3.cmml"><mi id="S3.SS1.p1.8.m6.2.3.3.2" xref="S3.SS1.p1.8.m6.2.3.3.2.cmml">𝐱</mi><mo id="S3.SS1.p1.8.m6.2.3.3.1" xref="S3.SS1.p1.8.m6.2.3.3.1.cmml">−</mo><mrow id="S3.SS1.p1.8.m6.2.3.3.3" xref="S3.SS1.p1.8.m6.2.3.3.3.cmml"><mover accent="true" id="S3.SS1.p1.8.m6.2.3.3.3.2" xref="S3.SS1.p1.8.m6.2.3.3.3.2.cmml"><mi id="S3.SS1.p1.8.m6.2.3.3.3.2.2" xref="S3.SS1.p1.8.m6.2.3.3.3.2.2.cmml">𝐱</mi><mo id="S3.SS1.p1.8.m6.2.3.3.3.2.1" xref="S3.SS1.p1.8.m6.2.3.3.3.2.1.cmml">^</mo></mover><mo id="S3.SS1.p1.8.m6.2.3.3.3.1" xref="S3.SS1.p1.8.m6.2.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m6.2.3.3.3.3.2" xref="S3.SS1.p1.8.m6.2.3.3.3.cmml"><mo id="S3.SS1.p1.8.m6.2.3.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.8.m6.2.3.3.3.cmml">(</mo><mi id="S3.SS1.p1.8.m6.2.2" xref="S3.SS1.p1.8.m6.2.2.cmml">𝐱</mi><mo id="S3.SS1.p1.8.m6.2.3.3.3.3.2.2" stretchy="false" xref="S3.SS1.p1.8.m6.2.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m6.2b"><apply id="S3.SS1.p1.8.m6.2.3.cmml" xref="S3.SS1.p1.8.m6.2.3"><eq id="S3.SS1.p1.8.m6.2.3.1.cmml" xref="S3.SS1.p1.8.m6.2.3.1"></eq><apply id="S3.SS1.p1.8.m6.2.3.2.cmml" xref="S3.SS1.p1.8.m6.2.3.2"><times id="S3.SS1.p1.8.m6.2.3.2.1.cmml" xref="S3.SS1.p1.8.m6.2.3.2.1"></times><ci id="S3.SS1.p1.8.m6.2.3.2.2.cmml" xref="S3.SS1.p1.8.m6.2.3.2.2">𝜺</ci><ci id="S3.SS1.p1.8.m6.1.1.cmml" xref="S3.SS1.p1.8.m6.1.1">𝐱</ci></apply><apply id="S3.SS1.p1.8.m6.2.3.3.cmml" xref="S3.SS1.p1.8.m6.2.3.3"><minus id="S3.SS1.p1.8.m6.2.3.3.1.cmml" xref="S3.SS1.p1.8.m6.2.3.3.1"></minus><ci id="S3.SS1.p1.8.m6.2.3.3.2.cmml" xref="S3.SS1.p1.8.m6.2.3.3.2">𝐱</ci><apply id="S3.SS1.p1.8.m6.2.3.3.3.cmml" xref="S3.SS1.p1.8.m6.2.3.3.3"><times id="S3.SS1.p1.8.m6.2.3.3.3.1.cmml" xref="S3.SS1.p1.8.m6.2.3.3.3.1"></times><apply id="S3.SS1.p1.8.m6.2.3.3.3.2.cmml" xref="S3.SS1.p1.8.m6.2.3.3.3.2"><ci id="S3.SS1.p1.8.m6.2.3.3.3.2.1.cmml" xref="S3.SS1.p1.8.m6.2.3.3.3.2.1">^</ci><ci id="S3.SS1.p1.8.m6.2.3.3.3.2.2.cmml" xref="S3.SS1.p1.8.m6.2.3.3.3.2.2">𝐱</ci></apply><ci id="S3.SS1.p1.8.m6.2.2.cmml" xref="S3.SS1.p1.8.m6.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m6.2c">\boldsymbol{\varepsilon}(\mathbf{x})=\mathbf{x}-\hat{\mathbf{x}}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m6.2d">bold_italic_ε ( bold_x ) = bold_x - over^ start_ARG bold_x end_ARG ( bold_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.7">The SAE is post-hoc trained and optimized to reduce the reconstruction error <math alttext="\boldsymbol{\varepsilon}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">𝜺</mi><mo id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mo id="S3.SS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><times id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝜺</ci><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\boldsymbol{\varepsilon}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_italic_ε ( bold_x )</annotation></semantics></math> and constraint to enforce activation sparsity, e.g., via <math alttext="L_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">L</mi><mn id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐿</ci><cn id="S3.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">L_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-norm regularization. Recently, top-<math alttext="{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_k</annotation></semantics></math> activation functions have been introduced, where activations <math alttext="a_{i}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.2" xref="S3.SS1.p2.4.m4.1.2.cmml"><msub id="S3.SS1.p2.4.m4.1.2.2" xref="S3.SS1.p2.4.m4.1.2.2.cmml"><mi id="S3.SS1.p2.4.m4.1.2.2.2" xref="S3.SS1.p2.4.m4.1.2.2.2.cmml">a</mi><mi id="S3.SS1.p2.4.m4.1.2.2.3" xref="S3.SS1.p2.4.m4.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.4.m4.1.2.1" xref="S3.SS1.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.1.2.3.2" xref="S3.SS1.p2.4.m4.1.2.cmml"><mo id="S3.SS1.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝐱</mi><mo id="S3.SS1.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.2.cmml" xref="S3.SS1.p2.4.m4.1.2"><times id="S3.SS1.p2.4.m4.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2.1"></times><apply id="S3.SS1.p2.4.m4.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.2.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.2.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2.2.2">𝑎</ci><ci id="S3.SS1.p2.4.m4.1.2.2.3.cmml" xref="S3.SS1.p2.4.m4.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">a_{i}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> are set to zero if they do not belong to the set of the <math alttext="{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_k</annotation></semantics></math> largest activations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib20" title="">20</a>]</cite>, a simple but effective measure to enforce sparsity.
Througout experiments in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5" title="5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we use top-<math alttext="{k}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_k</annotation></semantics></math> <span class="ltx_glossaryref" title="">SAEs</span>, and set <math alttext="\|\mathbf{v}_{i}\|=1" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mrow id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.2.cmml"><mo id="S3.SS1.p2.7.m7.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">‖</mo><msub id="S3.SS1.p2.7.m7.1.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.1.1.1.2" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS1.p2.7.m7.1.1.1.1.1.3" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.7.m7.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">=</mo><mn id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><eq id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2"></eq><apply id="S3.SS1.p2.7.m7.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.7.m7.1.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2">𝐯</ci><ci id="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.SS1.p2.7.m7.1.1.3.cmml" type="integer" xref="S3.SS1.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\|\mathbf{v}_{i}\|=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">∥ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ = 1</annotation></semantics></math> without loss of generality.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Understanding what semantics components encode</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="317" id="S3.F2.g1" src="x2.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Methodological overview:
a) For each <span class="ltx_glossaryref" title="">SAE</span> component, we collect its most activating samples and assign a textual label based on semantic alignment.
b) Logit Lens computes a global alignment score by projecting each latent embedding onto a textual embedding.
c) Instance-wise attributions are derived by  <svg class="ltx_picture" height="15.74" id="S3.F2.3.pic1" overflow="visible" version="1.1" width="15.74"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,15.74) matrix(1 0 0 -1 0 0) translate(7.87,0) translate(0,7.87)"><g color="#9999FF" fill="#9999FF" stroke="#9999FF"><path d="M 7.59 0 C 7.59 4.19 4.19 7.59 0 7.59 C -4.19 7.59 -7.59 4.19 -7.59 0 C -7.59 -4.19 -4.19 -7.59 0 -7.59 C 4.19 -7.59 7.59 -4.19 7.59 0 Z M 0 0"></path></g><g color="#9999FF" fill="#9999FF" stroke="#9999FF" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S3.F2.3.pic1.1.1.1.1.1">1</span></foreignobject></g></g></svg> performing a forward pass to obtain predictions and  <svg class="ltx_picture" height="15.74" id="S3.F2.4.pic2" overflow="visible" version="1.1" width="15.74"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,15.74) matrix(1 0 0 -1 0 0) translate(7.87,0) translate(0,7.87)"><g color="#FF6666" fill="#FF6666" stroke="#FF6666"><path d="M 7.59 0 C 7.59 4.19 4.19 7.59 0 7.59 C -4.19 7.59 -7.59 4.19 -7.59 0 C -7.59 -4.19 -4.19 -7.59 0 -7.59 C 4.19 -7.59 7.59 -4.19 7.59 0 Z M 0 0"></path></g><g color="#FF6666" fill="#FF6666" stroke="#FF6666" transform="matrix(1.0 0.0 0.0 1.0 -3.46 -4.46)"><foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><span class="ltx_text" id="S3.F2.4.pic2.1.1.1.1.1">2</span></foreignobject></g></g></svg> backpropagating gradients to estimate each component’s contribution. In contrast to Logit Lens, this – applied after the last transformer block – accounts for component magnitude (including activation) and adds a local correction term.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.8">The activation of a component signals the presence of a specific visual input pattern, commonly referred to as “concept”. To communicate this concept, the top-<math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_k</annotation></semantics></math> most activating samples from a dataset are usually retrieved, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.F2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>a. For textual labeling of a component <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_j</annotation></semantics></math>, we follow SemanticLens, which uses Mobile-CLIP-S2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib50" title="">50</a>]</cite> to first compute the average visual CLIP embedding <math alttext="\bar{\boldsymbol{x}}_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">𝒙</mi><mo id="S3.SS2.p1.3.m3.1.1.2.1" xref="S3.SS2.p1.3.m3.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><ci id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2.1">¯</ci><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝒙</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\bar{\boldsymbol{x}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of these examples. Note, that <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">bold_italic_x</annotation></semantics></math> represents the last transformer layer’s class token embedding <math alttext="\mathbf{x}_{\text{cls}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">𝐱</mi><mtext id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3a.cmml">cls</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝐱</ci><ci id="S3.SS2.p1.5.m5.1.1.3a.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><mtext id="S3.SS2.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.5.m5.1.1.3">cls</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathbf{x}_{\text{cls}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">bold_x start_POSTSUBSCRIPT cls end_POSTSUBSCRIPT</annotation></semantics></math> after a LayerNorm and projection operation, as is standard in CLIP.
We then compute the alignment between average embedding <math alttext="\bar{\boldsymbol{x}}_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">𝒙</mi><mo id="S3.SS2.p1.6.m6.1.1.2.1" xref="S3.SS2.p1.6.m6.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"><ci id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2.1">¯</ci><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝒙</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\bar{\boldsymbol{x}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and each text embedding <math alttext="\mathbf{t}\in\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝐭</mi><mo id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">𝒯</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><in id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"></in><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝐭</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathbf{t}\in\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">bold_t ∈ caligraphic_T</annotation></semantics></math> of predefined labels, and further subtract the alignment with an empty prompt <math alttext="\mathbf{t}_{\text{empty}}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">𝐭</mi><mtext id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3a.cmml">empty</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝐭</ci><ci id="S3.SS2.p1.8.m8.1.1.3a.cmml" xref="S3.SS2.p1.8.m8.1.1.3"><mtext id="S3.SS2.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.8.m8.1.1.3">empty</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathbf{t}_{\text{empty}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">bold_t start_POSTSUBSCRIPT empty end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{j}(\mathbf{t})=\frac{\bar{\boldsymbol{x}}_{j}\cdot\mathbf{t}}{\|\bar{%
\boldsymbol{x}}_{j}\|\|\mathbf{t}\|}-\frac{\bar{\boldsymbol{x}}_{j}\cdot%
\mathbf{t}_{\text{empty}}}{\|\bar{\boldsymbol{x}}_{j}\|\|\mathbf{t}_{\text{%
empty}}\|}\,," class="ltx_Math" display="block" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml"><msub id="S3.E2.m1.6.6.1.1.2.2" xref="S3.E2.m1.6.6.1.1.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.cmml">s</mi><mi id="S3.E2.m1.6.6.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.2.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.6.6.1.1.2.1" xref="S3.E2.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.2.3.2" xref="S3.E2.m1.6.6.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.2.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">𝐭</mi><mo id="S3.E2.m1.6.6.1.1.2.3.2.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><msub id="S3.E2.m1.2.2.4.2" xref="S3.E2.m1.2.2.4.2.cmml"><mover accent="true" id="S3.E2.m1.2.2.4.2.2" xref="S3.E2.m1.2.2.4.2.2.cmml"><mi id="S3.E2.m1.2.2.4.2.2.2" xref="S3.E2.m1.2.2.4.2.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.2.2.4.2.2.1" xref="S3.E2.m1.2.2.4.2.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.2.2.4.2.3" xref="S3.E2.m1.2.2.4.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.2.2.4.1.cmml">⋅</mo><mi id="S3.E2.m1.2.2.4.3" xref="S3.E2.m1.2.2.4.3.cmml">𝐭</mi></mrow><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.cmml"><mo id="S3.E2.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.2.2" xref="S3.E2.m1.2.2.2.2.1.1.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.2.2.2.2.1.1.2.1" xref="S3.E2.m1.2.2.2.2.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.E2.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.1.cmml">‖</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mo id="S3.E2.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝐭</mi><mo id="S3.E2.m1.2.2.2.4.2.2" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.1.cmml">‖</mo></mrow></mrow></mfrac><mo id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">−</mo><mfrac id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><msub id="S3.E2.m1.4.4.4.2" xref="S3.E2.m1.4.4.4.2.cmml"><mover accent="true" id="S3.E2.m1.4.4.4.2.2" xref="S3.E2.m1.4.4.4.2.2.cmml"><mi id="S3.E2.m1.4.4.4.2.2.2" xref="S3.E2.m1.4.4.4.2.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.4.4.4.2.2.1" xref="S3.E2.m1.4.4.4.2.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.4.4.4.2.3" xref="S3.E2.m1.4.4.4.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.4.4.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.4.4.4.1.cmml">⋅</mo><msub id="S3.E2.m1.4.4.4.3" xref="S3.E2.m1.4.4.4.3.cmml"><mi id="S3.E2.m1.4.4.4.3.2" xref="S3.E2.m1.4.4.4.3.2.cmml">𝐭</mi><mtext id="S3.E2.m1.4.4.4.3.3" xref="S3.E2.m1.4.4.4.3.3a.cmml">empty</mtext></msub></mrow><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml"><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.1.cmml">‖</mo><msub id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.3.3.1.1.1.1.2.1" xref="S3.E2.m1.3.3.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.3.3.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E2.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.2.cmml"><mo id="S3.E2.m1.4.4.2.2.1.2" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.1.cmml">‖</mo><msub id="S3.E2.m1.4.4.2.2.1.1" xref="S3.E2.m1.4.4.2.2.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.1.1.2" xref="S3.E2.m1.4.4.2.2.1.1.2.cmml">𝐭</mi><mtext id="S3.E2.m1.4.4.2.2.1.1.3" xref="S3.E2.m1.4.4.2.2.1.1.3a.cmml">empty</mtext></msub><mo id="S3.E2.m1.4.4.2.2.1.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" lspace="0.170em" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"></eq><apply id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"><times id="S3.E2.m1.6.6.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.1"></times><apply id="S3.E2.m1.6.6.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2">𝑠</ci><ci id="S3.E2.m1.6.6.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.3">𝑗</ci></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝐭</ci></apply><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><minus id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></minus><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><ci id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4.1">⋅</ci><apply id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.2.1.cmml" xref="S3.E2.m1.2.2.4.2">subscript</csymbol><apply id="S3.E2.m1.2.2.4.2.2.cmml" xref="S3.E2.m1.2.2.4.2.2"><ci id="S3.E2.m1.2.2.4.2.2.1.cmml" xref="S3.E2.m1.2.2.4.2.2.1">¯</ci><ci id="S3.E2.m1.2.2.4.2.2.2.cmml" xref="S3.E2.m1.2.2.4.2.2.2">𝒙</ci></apply><ci id="S3.E2.m1.2.2.4.2.3.cmml" xref="S3.E2.m1.2.2.4.2.3">𝑗</ci></apply><ci id="S3.E2.m1.2.2.4.3.cmml" xref="S3.E2.m1.2.2.4.3">𝐭</ci></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><times id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2"><ci id="S3.E2.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.1">¯</ci><ci id="S3.E2.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2">𝒙</ci></apply><ci id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.4.1.1.cmml" xref="S3.E2.m1.2.2.2.4.2.1">norm</csymbol><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝐭</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><divide id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4"></divide><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><ci id="S3.E2.m1.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.1">⋅</ci><apply id="S3.E2.m1.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.2.1.cmml" xref="S3.E2.m1.4.4.4.2">subscript</csymbol><apply id="S3.E2.m1.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.2.2"><ci id="S3.E2.m1.4.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.4.2.2.1">¯</ci><ci id="S3.E2.m1.4.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.4.2.2.2">𝒙</ci></apply><ci id="S3.E2.m1.4.4.4.2.3.cmml" xref="S3.E2.m1.4.4.4.2.3">𝑗</ci></apply><apply id="S3.E2.m1.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.3.1.cmml" xref="S3.E2.m1.4.4.4.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.3.2.cmml" xref="S3.E2.m1.4.4.4.3.2">𝐭</ci><ci id="S3.E2.m1.4.4.4.3.3a.cmml" xref="S3.E2.m1.4.4.4.3.3"><mtext id="S3.E2.m1.4.4.4.3.3.cmml" mathsize="70%" xref="S3.E2.m1.4.4.4.3.3">empty</mtext></ci></apply></apply><apply id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"><times id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.3"></times><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"><ci id="S3.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.1">¯</ci><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2">𝒙</ci></apply><ci id="S3.E2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.2">norm</csymbol><apply id="S3.E2.m1.4.4.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.2">𝐭</ci><ci id="S3.E2.m1.4.4.2.2.1.1.3a.cmml" xref="S3.E2.m1.4.4.2.2.1.1.3"><mtext id="S3.E2.m1.4.4.2.2.1.1.3.cmml" mathsize="70%" xref="S3.E2.m1.4.4.2.2.1.1.3">empty</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">s_{j}(\mathbf{t})=\frac{\bar{\boldsymbol{x}}_{j}\cdot\mathbf{t}}{\|\bar{%
\boldsymbol{x}}_{j}\|\|\mathbf{t}\|}-\frac{\bar{\boldsymbol{x}}_{j}\cdot%
\mathbf{t}_{\text{empty}}}{\|\bar{\boldsymbol{x}}_{j}\|\|\mathbf{t}_{\text{%
empty}}\|}\,,</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t ) = divide start_ARG over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ bold_t end_ARG start_ARG ∥ over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ ∥ bold_t ∥ end_ARG - divide start_ARG over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ bold_t start_POSTSUBSCRIPT empty end_POSTSUBSCRIPT end_ARG start_ARG ∥ over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ ∥ bold_t start_POSTSUBSCRIPT empty end_POSTSUBSCRIPT ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">where <math alttext="s_{j}(\mathbf{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m1.1"><semantics id="S3.SS2.p1.9.m1.1a"><mrow id="S3.SS2.p1.9.m1.1.2" xref="S3.SS2.p1.9.m1.1.2.cmml"><msub id="S3.SS2.p1.9.m1.1.2.2" xref="S3.SS2.p1.9.m1.1.2.2.cmml"><mi id="S3.SS2.p1.9.m1.1.2.2.2" xref="S3.SS2.p1.9.m1.1.2.2.2.cmml">s</mi><mi id="S3.SS2.p1.9.m1.1.2.2.3" xref="S3.SS2.p1.9.m1.1.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.p1.9.m1.1.2.1" xref="S3.SS2.p1.9.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.9.m1.1.2.3.2" xref="S3.SS2.p1.9.m1.1.2.cmml"><mo id="S3.SS2.p1.9.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.9.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml">𝐭</mi><mo id="S3.SS2.p1.9.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.9.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.1b"><apply id="S3.SS2.p1.9.m1.1.2.cmml" xref="S3.SS2.p1.9.m1.1.2"><times id="S3.SS2.p1.9.m1.1.2.1.cmml" xref="S3.SS2.p1.9.m1.1.2.1"></times><apply id="S3.SS2.p1.9.m1.1.2.2.cmml" xref="S3.SS2.p1.9.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m1.1.2.2.1.cmml" xref="S3.SS2.p1.9.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.9.m1.1.2.2.2.cmml" xref="S3.SS2.p1.9.m1.1.2.2.2">𝑠</ci><ci id="S3.SS2.p1.9.m1.1.2.2.3.cmml" xref="S3.SS2.p1.9.m1.1.2.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.1c">s_{j}(\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m1.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t )</annotation></semantics></math> is high when the label <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m2.1"><semantics id="S3.SS2.p1.10.m2.1a"><mi id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><ci id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m2.1d">bold_t</annotation></semantics></math> semantically matches the component’s highly activating samples, and negative if the empty prompt aligns better. The component label is assigned as <math alttext="\text{argmax}_{\mathbf{t}\in\mathcal{T}}s_{j}(\mathbf{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m3.1"><semantics id="S3.SS2.p1.11.m3.1a"><mrow id="S3.SS2.p1.11.m3.1.2" xref="S3.SS2.p1.11.m3.1.2.cmml"><msub id="S3.SS2.p1.11.m3.1.2.2" xref="S3.SS2.p1.11.m3.1.2.2.cmml"><mtext id="S3.SS2.p1.11.m3.1.2.2.2" xref="S3.SS2.p1.11.m3.1.2.2.2a.cmml">argmax</mtext><mrow id="S3.SS2.p1.11.m3.1.2.2.3" xref="S3.SS2.p1.11.m3.1.2.2.3.cmml"><mi id="S3.SS2.p1.11.m3.1.2.2.3.2" xref="S3.SS2.p1.11.m3.1.2.2.3.2.cmml">𝐭</mi><mo id="S3.SS2.p1.11.m3.1.2.2.3.1" xref="S3.SS2.p1.11.m3.1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.11.m3.1.2.2.3.3" xref="S3.SS2.p1.11.m3.1.2.2.3.3.cmml">𝒯</mi></mrow></msub><mo id="S3.SS2.p1.11.m3.1.2.1" xref="S3.SS2.p1.11.m3.1.2.1.cmml">⁢</mo><msub id="S3.SS2.p1.11.m3.1.2.3" xref="S3.SS2.p1.11.m3.1.2.3.cmml"><mi id="S3.SS2.p1.11.m3.1.2.3.2" xref="S3.SS2.p1.11.m3.1.2.3.2.cmml">s</mi><mi id="S3.SS2.p1.11.m3.1.2.3.3" xref="S3.SS2.p1.11.m3.1.2.3.3.cmml">j</mi></msub><mo id="S3.SS2.p1.11.m3.1.2.1a" xref="S3.SS2.p1.11.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m3.1.2.4.2" xref="S3.SS2.p1.11.m3.1.2.cmml"><mo id="S3.SS2.p1.11.m3.1.2.4.2.1" stretchy="false" xref="S3.SS2.p1.11.m3.1.2.cmml">(</mo><mi id="S3.SS2.p1.11.m3.1.1" xref="S3.SS2.p1.11.m3.1.1.cmml">𝐭</mi><mo id="S3.SS2.p1.11.m3.1.2.4.2.2" stretchy="false" xref="S3.SS2.p1.11.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.1b"><apply id="S3.SS2.p1.11.m3.1.2.cmml" xref="S3.SS2.p1.11.m3.1.2"><times id="S3.SS2.p1.11.m3.1.2.1.cmml" xref="S3.SS2.p1.11.m3.1.2.1"></times><apply id="S3.SS2.p1.11.m3.1.2.2.cmml" xref="S3.SS2.p1.11.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.1.2.2.1.cmml" xref="S3.SS2.p1.11.m3.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.11.m3.1.2.2.2a.cmml" xref="S3.SS2.p1.11.m3.1.2.2.2"><mtext id="S3.SS2.p1.11.m3.1.2.2.2.cmml" xref="S3.SS2.p1.11.m3.1.2.2.2">argmax</mtext></ci><apply id="S3.SS2.p1.11.m3.1.2.2.3.cmml" xref="S3.SS2.p1.11.m3.1.2.2.3"><in id="S3.SS2.p1.11.m3.1.2.2.3.1.cmml" xref="S3.SS2.p1.11.m3.1.2.2.3.1"></in><ci id="S3.SS2.p1.11.m3.1.2.2.3.2.cmml" xref="S3.SS2.p1.11.m3.1.2.2.3.2">𝐭</ci><ci id="S3.SS2.p1.11.m3.1.2.2.3.3.cmml" xref="S3.SS2.p1.11.m3.1.2.2.3.3">𝒯</ci></apply></apply><apply id="S3.SS2.p1.11.m3.1.2.3.cmml" xref="S3.SS2.p1.11.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.1.2.3.1.cmml" xref="S3.SS2.p1.11.m3.1.2.3">subscript</csymbol><ci id="S3.SS2.p1.11.m3.1.2.3.2.cmml" xref="S3.SS2.p1.11.m3.1.2.3.2">𝑠</ci><ci id="S3.SS2.p1.11.m3.1.2.3.3.cmml" xref="S3.SS2.p1.11.m3.1.2.3.3">𝑗</ci></apply><ci id="S3.SS2.p1.11.m3.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.1c">\text{argmax}_{\mathbf{t}\in\mathcal{T}}s_{j}(\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m3.1d">argmax start_POSTSUBSCRIPT bold_t ∈ caligraphic_T end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Understanding component-output alignment with Logit Lens</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Logit Lens is a technique for estimating how individual components align with specific outputs by isolating their contribution to the model’s prediction. The core assumption is that a single component is solely responsible for the embedding <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">bold_x</annotation></semantics></math>, which is then propagated to produce output logits. This yields a global alignment score that reflects how well a given representation aligns with the final output, offering insight into how the model might use that component.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.7">In the context of CLIP and <span class="ltx_glossaryref" title="">SAEs</span>, this procedure involves projecting the intermediate representation <math alttext="\mathbf{v}_{j}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝐯</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝐯</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathbf{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of component <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_j</annotation></semantics></math> onto a textual embedding <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">bold_t</annotation></semantics></math>. This corresponds to <math alttext="a_{i}=\delta_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">a</mi><mi id="S3.SS3.p2.4.m4.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">δ</mi><mrow id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.3.2" xref="S3.SS3.p2.4.m4.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.p2.4.m4.1.1.3.3.1" xref="S3.SS3.p2.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.3.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><eq id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></eq><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">𝑎</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝛿</ci><apply id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3"><times id="S3.SS3.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">a_{i}=\delta_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}=\boldsymbol{\varepsilon}(x)\overset{!}{=}0" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.2" xref="S3.SS3.p2.5.m5.1.2.cmml"><mi id="S3.SS3.p2.5.m5.1.2.2" xref="S3.SS3.p2.5.m5.1.2.2.cmml">𝐛</mi><mo id="S3.SS3.p2.5.m5.1.2.1" xref="S3.SS3.p2.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS3.p2.5.m5.1.2.3" xref="S3.SS3.p2.5.m5.1.2.3.cmml"><mi id="S3.SS3.p2.5.m5.1.2.3.2" xref="S3.SS3.p2.5.m5.1.2.3.2.cmml">𝜺</mi><mo id="S3.SS3.p2.5.m5.1.2.3.1" xref="S3.SS3.p2.5.m5.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.1.2.3.3.2" xref="S3.SS3.p2.5.m5.1.2.3.cmml"><mo id="S3.SS3.p2.5.m5.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.1.2.3.cmml">(</mo><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">x</mi><mo id="S3.SS3.p2.5.m5.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p2.5.m5.1.2.3.cmml">)</mo></mrow><mo id="S3.SS3.p2.5.m5.1.2.3.1a" xref="S3.SS3.p2.5.m5.1.2.3.1.cmml">⁢</mo><mover accent="true" id="S3.SS3.p2.5.m5.1.2.3.4" xref="S3.SS3.p2.5.m5.1.2.3.4.cmml"><mo id="S3.SS3.p2.5.m5.1.2.3.4.2" xref="S3.SS3.p2.5.m5.1.2.3.4.2.cmml">=</mo><mo id="S3.SS3.p2.5.m5.1.2.3.4.1" xref="S3.SS3.p2.5.m5.1.2.3.4.1.cmml">!</mo></mover><mo id="S3.SS3.p2.5.m5.1.2.3.1b" xref="S3.SS3.p2.5.m5.1.2.3.1.cmml">⁢</mo><mn id="S3.SS3.p2.5.m5.1.2.3.5" xref="S3.SS3.p2.5.m5.1.2.3.5.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.2.cmml" xref="S3.SS3.p2.5.m5.1.2"><eq id="S3.SS3.p2.5.m5.1.2.1.cmml" xref="S3.SS3.p2.5.m5.1.2.1"></eq><ci id="S3.SS3.p2.5.m5.1.2.2.cmml" xref="S3.SS3.p2.5.m5.1.2.2">𝐛</ci><apply id="S3.SS3.p2.5.m5.1.2.3.cmml" xref="S3.SS3.p2.5.m5.1.2.3"><times id="S3.SS3.p2.5.m5.1.2.3.1.cmml" xref="S3.SS3.p2.5.m5.1.2.3.1"></times><ci id="S3.SS3.p2.5.m5.1.2.3.2.cmml" xref="S3.SS3.p2.5.m5.1.2.3.2">𝜺</ci><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑥</ci><apply id="S3.SS3.p2.5.m5.1.2.3.4.cmml" xref="S3.SS3.p2.5.m5.1.2.3.4"><factorial id="S3.SS3.p2.5.m5.1.2.3.4.1.cmml" xref="S3.SS3.p2.5.m5.1.2.3.4.1"></factorial><eq id="S3.SS3.p2.5.m5.1.2.3.4.2.cmml" xref="S3.SS3.p2.5.m5.1.2.3.4.2"></eq></apply><cn id="S3.SS3.p2.5.m5.1.2.3.5.cmml" type="integer" xref="S3.SS3.p2.5.m5.1.2.3.5">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\mathbf{b}=\boldsymbol{\varepsilon}(x)\overset{!}{=}0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">bold_b = bold_italic_ε ( italic_x ) over! start_ARG = end_ARG 0</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E1" title="In 3.1 Sparse autoencoders for extracting interpretable components ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, where <math alttext="\delta_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">δ</mi><mrow id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.p2.6.m6.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.6.m6.1.1.3.1" xref="S3.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝛿</ci><apply id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3"><times id="S3.SS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.1"></times><ci id="S3.SS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\delta_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the Kronecker delta.
After applying the downstream LayerNorm and projection layer, we obtain the embedding <math alttext="{\boldsymbol{v}}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><msub id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">𝒗</mi><mi id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝒗</ci><ci id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">{\boldsymbol{v}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">bold_italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and compute the Logit Lens alignment score as:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\texttt{LogitLens}_{j}(\mathbf{t})=\frac{{\boldsymbol{v}}_{j}}{\|{\boldsymbol{%
v}}_{j}\|}\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|}~{}." class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><msub id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.4.4.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2a.cmml">LogitLens</mtext><mi id="S3.E3.m1.4.4.1.1.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">j</mi></msub><mo id="S3.E3.m1.4.4.1.1.2.1" xref="S3.E3.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.2.3.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝐭</mi><mo id="S3.E3.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mfrac id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">𝒗</mi><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">j</mi></msub><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="S3.E3.m1.4.4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.4.4.1.1.3.1.cmml">⋅</mo><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mi id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">𝐭</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.2.cmml"><mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">‖</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">𝐭</mi><mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" lspace="0.330em" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"></eq><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><times id="S3.E3.m1.4.4.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1"></times><apply id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.2.2a.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.4.4.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2">LogitLens</mtext></ci><ci id="S3.E3.m1.4.4.1.1.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝐭</ci></apply><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><ci id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1">⋅</ci><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><divide id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"></divide><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝒗</ci><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑗</ci></apply><apply id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝒗</ci><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2"></divide><ci id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3">𝐭</ci><apply id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.3"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.2.1.cmml" xref="S3.E3.m1.2.2.1.3.1">norm</csymbol><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝐭</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\texttt{LogitLens}_{j}(\mathbf{t})=\frac{{\boldsymbol{v}}_{j}}{\|{\boldsymbol{%
v}}_{j}\|}\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|}~{}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">LogitLens start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t ) = divide start_ARG bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG ⋅ divide start_ARG bold_t end_ARG start_ARG ∥ bold_t ∥ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">Notably, Logit Lens assumes activation of a <em class="ltx_emph ltx_font_italic" id="S3.SS3.p4.1.1">single</em> latent, ignoring magnitude and interactions with other components, providing only a global approximation of a component’s relevance to an output.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We present a holistic framework for analyzing the latent representations of CLIP models.
Building on <span class="ltx_glossaryref" title="">SAEs</span>, we extract interpretable components and compute their semantic alignment to expected concepts (e.g., textual labels) via <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
Our core methodological contributions are: (1) the computation of instance-wise attribution scores for individual latent components, and (2) the automatic detection of outlier concept reliance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.8">CLIP’s image encoder consists of transformer blocks, each producing token-wise embeddings of shape <math alttext="d_{\text{token}}\times d_{\text{pre}}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><msub id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml"><mi id="S4.p2.1.m1.1.1.2.2" xref="S4.p2.1.m1.1.1.2.2.cmml">d</mi><mtext id="S4.p2.1.m1.1.1.2.3" xref="S4.p2.1.m1.1.1.2.3a.cmml">token</mtext></msub><mo id="S4.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.1.m1.1.1.1.cmml">×</mo><msub id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><mi id="S4.p2.1.m1.1.1.3.2" xref="S4.p2.1.m1.1.1.3.2.cmml">d</mi><mtext id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3a.cmml">pre</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><times id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></times><apply id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.2.1.cmml" xref="S4.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.2.2">𝑑</ci><ci id="S4.p2.1.m1.1.1.2.3a.cmml" xref="S4.p2.1.m1.1.1.2.3"><mtext id="S4.p2.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.p2.1.m1.1.1.2.3">token</mtext></ci></apply><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2">𝑑</ci><ci id="S4.p2.1.m1.1.1.3.3a.cmml" xref="S4.p2.1.m1.1.1.3.3"><mtext id="S4.p2.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S4.p2.1.m1.1.1.3.3">pre</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">d_{\text{token}}\times d_{\text{pre}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_d start_POSTSUBSCRIPT token end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT</annotation></semantics></math>, where each token (including spatial and class tokens) has an embedding <math alttext="\mathbf{x}\in\mathbb{R}^{d_{\text{pre}}}" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">𝐱</mi><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml"><mi id="S4.p2.2.m2.1.1.3.2" xref="S4.p2.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S4.p2.2.m2.1.1.3.3" xref="S4.p2.2.m2.1.1.3.3.cmml"><mi id="S4.p2.2.m2.1.1.3.3.2" xref="S4.p2.2.m2.1.1.3.3.2.cmml">d</mi><mtext id="S4.p2.2.m2.1.1.3.3.3" xref="S4.p2.2.m2.1.1.3.3.3a.cmml">pre</mtext></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><in id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></in><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝐱</ci><apply id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.3.1.cmml" xref="S4.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.p2.2.m2.1.1.3.2.cmml" xref="S4.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.p2.2.m2.1.1.3.3.cmml" xref="S4.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.3.3.1.cmml" xref="S4.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.p2.2.m2.1.1.3.3.2.cmml" xref="S4.p2.2.m2.1.1.3.3.2">𝑑</ci><ci id="S4.p2.2.m2.1.1.3.3.3a.cmml" xref="S4.p2.2.m2.1.1.3.3.3"><mtext id="S4.p2.2.m2.1.1.3.3.3.cmml" mathsize="50%" xref="S4.p2.2.m2.1.1.3.3.3">pre</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\mathbf{x}\in\mathbb{R}^{d_{\text{pre}}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
After the final transformer block, the output is processed through:
1) chosing the class token embedding, 2) LayerNorm with optional scaling and bias <math alttext="\boldsymbol{\gamma},\boldsymbol{\beta}\in\mathbb{R}^{d_{\text{pre}}}" class="ltx_Math" display="inline" id="S4.p2.3.m3.2"><semantics id="S4.p2.3.m3.2a"><mrow id="S4.p2.3.m3.2.3" xref="S4.p2.3.m3.2.3.cmml"><mrow id="S4.p2.3.m3.2.3.2.2" xref="S4.p2.3.m3.2.3.2.1.cmml"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">𝜸</mi><mo id="S4.p2.3.m3.2.3.2.2.1" xref="S4.p2.3.m3.2.3.2.1.cmml">,</mo><mi id="S4.p2.3.m3.2.2" xref="S4.p2.3.m3.2.2.cmml">𝜷</mi></mrow><mo id="S4.p2.3.m3.2.3.1" xref="S4.p2.3.m3.2.3.1.cmml">∈</mo><msup id="S4.p2.3.m3.2.3.3" xref="S4.p2.3.m3.2.3.3.cmml"><mi id="S4.p2.3.m3.2.3.3.2" xref="S4.p2.3.m3.2.3.3.2.cmml">ℝ</mi><msub id="S4.p2.3.m3.2.3.3.3" xref="S4.p2.3.m3.2.3.3.3.cmml"><mi id="S4.p2.3.m3.2.3.3.3.2" xref="S4.p2.3.m3.2.3.3.3.2.cmml">d</mi><mtext id="S4.p2.3.m3.2.3.3.3.3" xref="S4.p2.3.m3.2.3.3.3.3a.cmml">pre</mtext></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.2b"><apply id="S4.p2.3.m3.2.3.cmml" xref="S4.p2.3.m3.2.3"><in id="S4.p2.3.m3.2.3.1.cmml" xref="S4.p2.3.m3.2.3.1"></in><list id="S4.p2.3.m3.2.3.2.1.cmml" xref="S4.p2.3.m3.2.3.2.2"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝜸</ci><ci id="S4.p2.3.m3.2.2.cmml" xref="S4.p2.3.m3.2.2">𝜷</ci></list><apply id="S4.p2.3.m3.2.3.3.cmml" xref="S4.p2.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.2.3.3.1.cmml" xref="S4.p2.3.m3.2.3.3">superscript</csymbol><ci id="S4.p2.3.m3.2.3.3.2.cmml" xref="S4.p2.3.m3.2.3.3.2">ℝ</ci><apply id="S4.p2.3.m3.2.3.3.3.cmml" xref="S4.p2.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.2.3.3.3.1.cmml" xref="S4.p2.3.m3.2.3.3.3">subscript</csymbol><ci id="S4.p2.3.m3.2.3.3.3.2.cmml" xref="S4.p2.3.m3.2.3.3.3.2">𝑑</ci><ci id="S4.p2.3.m3.2.3.3.3.3a.cmml" xref="S4.p2.3.m3.2.3.3.3.3"><mtext id="S4.p2.3.m3.2.3.3.3.3.cmml" mathsize="50%" xref="S4.p2.3.m3.2.3.3.3.3">pre</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.2c">\boldsymbol{\gamma},\boldsymbol{\beta}\in\mathbb{R}^{d_{\text{pre}}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.2d">bold_italic_γ , bold_italic_β ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and 3) a projection through matrix <math alttext="W_{\text{proj}}\in\mathbb{R}^{d_{\text{pre}}\times d_{\text{post}}}" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><mrow id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><msub id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml"><mi id="S4.p2.4.m4.1.1.2.2" xref="S4.p2.4.m4.1.1.2.2.cmml">W</mi><mtext id="S4.p2.4.m4.1.1.2.3" xref="S4.p2.4.m4.1.1.2.3a.cmml">proj</mtext></msub><mo id="S4.p2.4.m4.1.1.1" xref="S4.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml"><mi id="S4.p2.4.m4.1.1.3.2" xref="S4.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p2.4.m4.1.1.3.3" xref="S4.p2.4.m4.1.1.3.3.cmml"><msub id="S4.p2.4.m4.1.1.3.3.2" xref="S4.p2.4.m4.1.1.3.3.2.cmml"><mi id="S4.p2.4.m4.1.1.3.3.2.2" xref="S4.p2.4.m4.1.1.3.3.2.2.cmml">d</mi><mtext id="S4.p2.4.m4.1.1.3.3.2.3" xref="S4.p2.4.m4.1.1.3.3.2.3a.cmml">pre</mtext></msub><mo id="S4.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.p2.4.m4.1.1.3.3.3" xref="S4.p2.4.m4.1.1.3.3.3.cmml"><mi id="S4.p2.4.m4.1.1.3.3.3.2" xref="S4.p2.4.m4.1.1.3.3.3.2.cmml">d</mi><mtext id="S4.p2.4.m4.1.1.3.3.3.3" xref="S4.p2.4.m4.1.1.3.3.3.3a.cmml">post</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><in id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1"></in><apply id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.2.1.cmml" xref="S4.p2.4.m4.1.1.2">subscript</csymbol><ci id="S4.p2.4.m4.1.1.2.2.cmml" xref="S4.p2.4.m4.1.1.2.2">𝑊</ci><ci id="S4.p2.4.m4.1.1.2.3a.cmml" xref="S4.p2.4.m4.1.1.2.3"><mtext id="S4.p2.4.m4.1.1.2.3.cmml" mathsize="70%" xref="S4.p2.4.m4.1.1.2.3">proj</mtext></ci></apply><apply id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.3.1.cmml" xref="S4.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.p2.4.m4.1.1.3.2.cmml" xref="S4.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S4.p2.4.m4.1.1.3.3.cmml" xref="S4.p2.4.m4.1.1.3.3"><times id="S4.p2.4.m4.1.1.3.3.1.cmml" xref="S4.p2.4.m4.1.1.3.3.1"></times><apply id="S4.p2.4.m4.1.1.3.3.2.cmml" xref="S4.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.3.3.2.1.cmml" xref="S4.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S4.p2.4.m4.1.1.3.3.2.2.cmml" xref="S4.p2.4.m4.1.1.3.3.2.2">𝑑</ci><ci id="S4.p2.4.m4.1.1.3.3.2.3a.cmml" xref="S4.p2.4.m4.1.1.3.3.2.3"><mtext id="S4.p2.4.m4.1.1.3.3.2.3.cmml" mathsize="50%" xref="S4.p2.4.m4.1.1.3.3.2.3">pre</mtext></ci></apply><apply id="S4.p2.4.m4.1.1.3.3.3.cmml" xref="S4.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.3.3.3.1.cmml" xref="S4.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S4.p2.4.m4.1.1.3.3.3.2.cmml" xref="S4.p2.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S4.p2.4.m4.1.1.3.3.3.3a.cmml" xref="S4.p2.4.m4.1.1.3.3.3.3"><mtext id="S4.p2.4.m4.1.1.3.3.3.3.cmml" mathsize="50%" xref="S4.p2.4.m4.1.1.3.3.3.3">post</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">W_{\text{proj}}\in\mathbb{R}^{d_{\text{pre}}\times d_{\text{post}}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">italic_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT post end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> to dimension <math alttext="d_{\text{post}}" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><msub id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">d</mi><mtext id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3a.cmml">post</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1">subscript</csymbol><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝑑</ci><ci id="S4.p2.5.m5.1.1.3a.cmml" xref="S4.p2.5.m5.1.1.3"><mtext id="S4.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.p2.5.m5.1.1.3">post</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">d_{\text{post}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">italic_d start_POSTSUBSCRIPT post end_POSTSUBSCRIPT</annotation></semantics></math>.
The model prediction <math alttext="y" class="ltx_Math" display="inline" id="S4.p2.6.m6.1"><semantics id="S4.p2.6.m6.1a"><mi id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><ci id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.p2.6.m6.1d">italic_y</annotation></semantics></math> for an image-text pair is computed via cosine similarity between the projected image embedding <math alttext="{\boldsymbol{x}}" class="ltx_Math" display="inline" id="S4.p2.7.m7.1"><semantics id="S4.p2.7.m7.1a"><mi id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><ci id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">{\boldsymbol{x}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.7.m7.1d">bold_italic_x</annotation></semantics></math> and a textual embedding <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="S4.p2.8.m8.1"><semantics id="S4.p2.8.m8.1a"><mi id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><ci id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.8.m8.1d">bold_t</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y({\boldsymbol{x}},\mathbf{t})=\frac{{\boldsymbol{x}}}{\|{\boldsymbol{x}}\|}%
\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|},\quad\text{where}\quad\boldsymbol{x}=%
\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}\left[\mathbf{x}%
\right]W_{\text{proj}}~{}." class="ltx_Math" display="block" id="S4.E4.m1.9"><semantics id="S4.E4.m1.9a"><mrow id="S4.E4.m1.9.9.1"><mrow id="S4.E4.m1.9.9.1.1.2" xref="S4.E4.m1.9.9.1.1.3.cmml"><mrow id="S4.E4.m1.9.9.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.cmml"><mrow id="S4.E4.m1.9.9.1.1.1.1.3" xref="S4.E4.m1.9.9.1.1.1.1.3.cmml"><mi id="S4.E4.m1.9.9.1.1.1.1.3.2" xref="S4.E4.m1.9.9.1.1.1.1.3.2.cmml">y</mi><mo id="S4.E4.m1.9.9.1.1.1.1.3.1" xref="S4.E4.m1.9.9.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.3.3.2" xref="S4.E4.m1.9.9.1.1.1.1.3.3.1.cmml"><mo id="S4.E4.m1.9.9.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E4.m1.9.9.1.1.1.1.3.3.1.cmml">(</mo><mi id="S4.E4.m1.5.5" xref="S4.E4.m1.5.5.cmml">𝒙</mi><mo id="S4.E4.m1.9.9.1.1.1.1.3.3.2.2" xref="S4.E4.m1.9.9.1.1.1.1.3.3.1.cmml">,</mo><mi id="S4.E4.m1.6.6" xref="S4.E4.m1.6.6.cmml">𝐭</mi><mo id="S4.E4.m1.9.9.1.1.1.1.3.3.2.3" stretchy="false" xref="S4.E4.m1.9.9.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.9.9.1.1.1.1.2" xref="S4.E4.m1.9.9.1.1.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.1.2.cmml"><mrow id="S4.E4.m1.9.9.1.1.1.1.1.1.1" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.cmml"><mfrac id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mi id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml">𝒙</mi><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.2.cmml"><mo id="S4.E4.m1.1.1.1.3.1" stretchy="false" xref="S4.E4.m1.1.1.1.2.1.cmml">‖</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">𝒙</mi><mo id="S4.E4.m1.1.1.1.3.2" stretchy="false" xref="S4.E4.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="S4.E4.m1.9.9.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.1.cmml">⋅</mo><mfrac id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml"><mi id="S4.E4.m1.2.2.3" xref="S4.E4.m1.2.2.3.cmml">𝐭</mi><mrow id="S4.E4.m1.2.2.1.3" xref="S4.E4.m1.2.2.1.2.cmml"><mo id="S4.E4.m1.2.2.1.3.1" stretchy="false" xref="S4.E4.m1.2.2.1.2.1.cmml">‖</mo><mi id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml">𝐭</mi><mo id="S4.E4.m1.2.2.1.3.2" stretchy="false" xref="S4.E4.m1.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S4.E4.m1.9.9.1.1.1.1.1.1.2" rspace="1.167em" xref="S4.E4.m1.9.9.1.1.1.1.1.2.cmml">,</mo><mtext id="S4.E4.m1.8.8" xref="S4.E4.m1.8.8a.cmml">where</mtext></mrow></mrow><mspace id="S4.E4.m1.9.9.1.1.2.3" width="1em" xref="S4.E4.m1.9.9.1.1.3a.cmml"></mspace><mrow id="S4.E4.m1.9.9.1.1.2.2" xref="S4.E4.m1.9.9.1.1.2.2.cmml"><mi id="S4.E4.m1.9.9.1.1.2.2.2" xref="S4.E4.m1.9.9.1.1.2.2.2.cmml">𝒙</mi><mo id="S4.E4.m1.9.9.1.1.2.2.1" xref="S4.E4.m1.9.9.1.1.2.2.1.cmml">=</mo><mrow id="S4.E4.m1.9.9.1.1.2.2.3" xref="S4.E4.m1.9.9.1.1.2.2.3.cmml"><msub id="S4.E4.m1.9.9.1.1.2.2.3.2" xref="S4.E4.m1.9.9.1.1.2.2.3.2.cmml"><mtext id="S4.E4.m1.9.9.1.1.2.2.3.2.2" xref="S4.E4.m1.9.9.1.1.2.2.3.2.2a.cmml">LayerNorm</mtext><mrow id="S4.E4.m1.4.4.2.4" xref="S4.E4.m1.4.4.2.3.cmml"><mi id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml">𝜸</mi><mo id="S4.E4.m1.4.4.2.4.1" xref="S4.E4.m1.4.4.2.3.cmml">,</mo><mi id="S4.E4.m1.4.4.2.2" xref="S4.E4.m1.4.4.2.2.cmml">𝜷</mi></mrow></msub><mo id="S4.E4.m1.9.9.1.1.2.2.3.1" xref="S4.E4.m1.9.9.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S4.E4.m1.9.9.1.1.2.2.3.3.2" xref="S4.E4.m1.9.9.1.1.2.2.3.3.1.cmml"><mo id="S4.E4.m1.9.9.1.1.2.2.3.3.2.1" xref="S4.E4.m1.9.9.1.1.2.2.3.3.1.1.cmml">[</mo><mi id="S4.E4.m1.7.7" xref="S4.E4.m1.7.7.cmml">𝐱</mi><mo id="S4.E4.m1.9.9.1.1.2.2.3.3.2.2" xref="S4.E4.m1.9.9.1.1.2.2.3.3.1.1.cmml">]</mo></mrow><mo id="S4.E4.m1.9.9.1.1.2.2.3.1a" xref="S4.E4.m1.9.9.1.1.2.2.3.1.cmml">⁢</mo><msub id="S4.E4.m1.9.9.1.1.2.2.3.4" xref="S4.E4.m1.9.9.1.1.2.2.3.4.cmml"><mi id="S4.E4.m1.9.9.1.1.2.2.3.4.2" xref="S4.E4.m1.9.9.1.1.2.2.3.4.2.cmml">W</mi><mtext id="S4.E4.m1.9.9.1.1.2.2.3.4.3" xref="S4.E4.m1.9.9.1.1.2.2.3.4.3a.cmml">proj</mtext></msub></mrow></mrow></mrow><mo id="S4.E4.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.9b"><apply id="S4.E4.m1.9.9.1.1.3.cmml" xref="S4.E4.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.3a.cmml" xref="S4.E4.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E4.m1.9.9.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1"><eq id="S4.E4.m1.9.9.1.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.2"></eq><apply id="S4.E4.m1.9.9.1.1.1.1.3.cmml" xref="S4.E4.m1.9.9.1.1.1.1.3"><times id="S4.E4.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.3.1"></times><ci id="S4.E4.m1.9.9.1.1.1.1.3.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.3.2">𝑦</ci><interval closure="open" id="S4.E4.m1.9.9.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.3.3.2"><ci id="S4.E4.m1.5.5.cmml" xref="S4.E4.m1.5.5">𝒙</ci><ci id="S4.E4.m1.6.6.cmml" xref="S4.E4.m1.6.6">𝐭</ci></interval></apply><list id="S4.E4.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1"><apply id="S4.E4.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1"><ci id="S4.E4.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.9.9.1.1.1.1.1.1.1.1">⋅</ci><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><divide id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1"></divide><ci id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3">𝒙</ci><apply id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.3"><csymbol cd="latexml" id="S4.E4.m1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.3.1">norm</csymbol><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝒙</ci></apply></apply><apply id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"><divide id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2"></divide><ci id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2.3">𝐭</ci><apply id="S4.E4.m1.2.2.1.2.cmml" xref="S4.E4.m1.2.2.1.3"><csymbol cd="latexml" id="S4.E4.m1.2.2.1.2.1.cmml" xref="S4.E4.m1.2.2.1.3.1">norm</csymbol><ci id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1.1">𝐭</ci></apply></apply></apply><ci id="S4.E4.m1.8.8a.cmml" xref="S4.E4.m1.8.8"><mtext id="S4.E4.m1.8.8.cmml" xref="S4.E4.m1.8.8">where</mtext></ci></list></apply><apply id="S4.E4.m1.9.9.1.1.2.2.cmml" xref="S4.E4.m1.9.9.1.1.2.2"><eq id="S4.E4.m1.9.9.1.1.2.2.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.1"></eq><ci id="S4.E4.m1.9.9.1.1.2.2.2.cmml" xref="S4.E4.m1.9.9.1.1.2.2.2">𝒙</ci><apply id="S4.E4.m1.9.9.1.1.2.2.3.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3"><times id="S4.E4.m1.9.9.1.1.2.2.3.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.1"></times><apply id="S4.E4.m1.9.9.1.1.2.2.3.2.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.2.2.3.2.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.2">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.2.2.3.2.2a.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.2.2"><mtext id="S4.E4.m1.9.9.1.1.2.2.3.2.2.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.2.2">LayerNorm</mtext></ci><list id="S4.E4.m1.4.4.2.3.cmml" xref="S4.E4.m1.4.4.2.4"><ci id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1.1">𝜸</ci><ci id="S4.E4.m1.4.4.2.2.cmml" xref="S4.E4.m1.4.4.2.2">𝜷</ci></list></apply><apply id="S4.E4.m1.9.9.1.1.2.2.3.3.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.3.2"><csymbol cd="latexml" id="S4.E4.m1.9.9.1.1.2.2.3.3.1.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.3.2.1">delimited-[]</csymbol><ci id="S4.E4.m1.7.7.cmml" xref="S4.E4.m1.7.7">𝐱</ci></apply><apply id="S4.E4.m1.9.9.1.1.2.2.3.4.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.4"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.1.1.2.2.3.4.1.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.4">subscript</csymbol><ci id="S4.E4.m1.9.9.1.1.2.2.3.4.2.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.4.2">𝑊</ci><ci id="S4.E4.m1.9.9.1.1.2.2.3.4.3a.cmml" xref="S4.E4.m1.9.9.1.1.2.2.3.4.3"><mtext id="S4.E4.m1.9.9.1.1.2.2.3.4.3.cmml" mathsize="70%" xref="S4.E4.m1.9.9.1.1.2.2.3.4.3">proj</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.9c">y({\boldsymbol{x}},\mathbf{t})=\frac{{\boldsymbol{x}}}{\|{\boldsymbol{x}}\|}%
\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|},\quad\text{where}\quad\boldsymbol{x}=%
\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}\left[\mathbf{x}%
\right]W_{\text{proj}}~{}.</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.9d">italic_y ( bold_italic_x , bold_t ) = divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG ⋅ divide start_ARG bold_t end_ARG start_ARG ∥ bold_t ∥ end_ARG , where bold_italic_x = LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_x ] italic_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">While our framework can be applied at any transformer layer, we focus on the final block’s class token embedding for clarity, which is also used directly for prediction.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Instance-wise attribution of components</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">In language models, attribution patching quantifies how a model’s output changes when a neuron’s activation is replaced with a reference value <math alttext="a_{\text{ref}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">a</mi><mtext id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑎</ci><ci id="S4.SS1.p1.1.m1.1.1.3a.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><mtext id="S4.SS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.1.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">a_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>, using a first-order Taylor approximation. We extend this approach to CLIP by estimating the effect of zeroing out individual latent activations. Specifically, we analyze the output <math alttext="y(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.2"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2.3" xref="S4.SS1.p1.2.m2.2.3.cmml"><mi id="S4.SS1.p1.2.m2.2.3.2" xref="S4.SS1.p1.2.m2.2.3.2.cmml">y</mi><mo id="S4.SS1.p1.2.m2.2.3.1" xref="S4.SS1.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.2.3.3.2" xref="S4.SS1.p1.2.m2.2.3.3.1.cmml"><mo id="S4.SS1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒙</mi><mo id="S4.SS1.p1.2.m2.2.3.3.2.2" xref="S4.SS1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">𝐭</mi><mo id="S4.SS1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.2b"><apply id="S4.SS1.p1.2.m2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.3"><times id="S4.SS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.p1.2.m2.2.3.1"></times><ci id="S4.SS1.p1.2.m2.2.3.2.cmml" xref="S4.SS1.p1.2.m2.2.3.2">𝑦</ci><interval closure="open" id="S4.SS1.p1.2.m2.2.3.3.1.cmml" xref="S4.SS1.p1.2.m2.2.3.3.2"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒙</ci><ci id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">y(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.2d">italic_y ( bold_italic_x , bold_t )</annotation></semantics></math> for <math alttext="a_{\text{ref}}=0" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><msub id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2.2" xref="S4.SS1.p1.3.m3.1.1.2.2.cmml">a</mi><mtext id="S4.SS1.p1.3.m3.1.1.2.3" xref="S4.SS1.p1.3.m3.1.1.2.3a.cmml">ref</mtext></msub><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><eq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></eq><apply id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2.2">𝑎</ci><ci id="S4.SS1.p1.3.m3.1.1.2.3a.cmml" xref="S4.SS1.p1.3.m3.1.1.2.3"><mtext id="S4.SS1.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S4.SS1.p1.3.m3.1.1.2.3">ref</mtext></ci></apply><cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">a_{\text{ref}}=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT = 0</annotation></semantics></math>, yielding component-wise attributions <math alttext="R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.2"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.3" xref="S4.SS1.p1.4.m4.2.3.cmml"><msub id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.2.cmml"><mi id="S4.SS1.p1.4.m4.2.3.2.2" xref="S4.SS1.p1.4.m4.2.3.2.2.cmml">R</mi><mi id="S4.SS1.p1.4.m4.2.3.2.3" xref="S4.SS1.p1.4.m4.2.3.2.3.cmml">j</mi></msub><mo id="S4.SS1.p1.4.m4.2.3.1" xref="S4.SS1.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.4.m4.2.3.3.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml"><mo id="S4.SS1.p1.4.m4.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">𝒙</mi><mo id="S4.SS1.p1.4.m4.2.3.3.2.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">𝐭</mi><mo id="S4.SS1.p1.4.m4.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3"><times id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.1"></times><apply id="S4.SS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.3.2.1.cmml" xref="S4.SS1.p1.4.m4.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.3.2.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2.2">𝑅</ci><ci id="S4.SS1.p1.4.m4.2.3.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S4.SS1.p1.4.m4.2.3.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.3.2"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝒙</ci><ci id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math> defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="S4.E5.m1.2"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.3" xref="S4.E5.m1.2.3.cmml"><msub id="S4.E5.m1.2.3.2" xref="S4.E5.m1.2.3.2.cmml"><mi id="S4.E5.m1.2.3.2.2" xref="S4.E5.m1.2.3.2.2.cmml">R</mi><mi id="S4.E5.m1.2.3.2.3" xref="S4.E5.m1.2.3.2.3.cmml">j</mi></msub><mo id="S4.E5.m1.2.3.1" xref="S4.E5.m1.2.3.1.cmml">⁢</mo><mrow id="S4.E5.m1.2.3.3.2" xref="S4.E5.m1.2.3.3.1.cmml"><mo id="S4.E5.m1.2.3.3.2.1" stretchy="false" xref="S4.E5.m1.2.3.3.1.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝒙</mi><mo id="S4.E5.m1.2.3.3.2.2" xref="S4.E5.m1.2.3.3.1.cmml">,</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝐭</mi><mo id="S4.E5.m1.2.3.3.2.3" stretchy="false" xref="S4.E5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.3.cmml" xref="S4.E5.m1.2.3"><times id="S4.E5.m1.2.3.1.cmml" xref="S4.E5.m1.2.3.1"></times><apply id="S4.E5.m1.2.3.2.cmml" xref="S4.E5.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.3.2.1.cmml" xref="S4.E5.m1.2.3.2">subscript</csymbol><ci id="S4.E5.m1.2.3.2.2.cmml" xref="S4.E5.m1.2.3.2.2">𝑅</ci><ci id="S4.E5.m1.2.3.2.3.cmml" xref="S4.E5.m1.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S4.E5.m1.2.3.3.1.cmml" xref="S4.E5.m1.2.3.3.2"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝒙</ci><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=y(\boldsymbol{x},\mathbf{t})-y(\boldsymbol{x},\mathbf{t})\big{|}%
_{a_{j}=0}\approx a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a%
_{j}}~{}," class="ltx_Math" display="inline" id="S4.E5.m2.8"><semantics id="S4.E5.m2.8a"><mrow id="S4.E5.m2.8.8.1" xref="S4.E5.m2.8.8.1.1.cmml"><mrow id="S4.E5.m2.8.8.1.1" xref="S4.E5.m2.8.8.1.1.cmml"><mi id="S4.E5.m2.8.8.1.1.3" xref="S4.E5.m2.8.8.1.1.3.cmml"></mi><mo id="S4.E5.m2.8.8.1.1.4" xref="S4.E5.m2.8.8.1.1.4.cmml">=</mo><mrow id="S4.E5.m2.8.8.1.1.1" xref="S4.E5.m2.8.8.1.1.1.cmml"><mrow id="S4.E5.m2.8.8.1.1.1.3" xref="S4.E5.m2.8.8.1.1.1.3.cmml"><mi id="S4.E5.m2.8.8.1.1.1.3.2" xref="S4.E5.m2.8.8.1.1.1.3.2.cmml">y</mi><mo id="S4.E5.m2.8.8.1.1.1.3.1" xref="S4.E5.m2.8.8.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E5.m2.8.8.1.1.1.3.3.2" xref="S4.E5.m2.8.8.1.1.1.3.3.1.cmml"><mo id="S4.E5.m2.8.8.1.1.1.3.3.2.1" stretchy="false" xref="S4.E5.m2.8.8.1.1.1.3.3.1.cmml">(</mo><mi id="S4.E5.m2.3.3" xref="S4.E5.m2.3.3.cmml">𝒙</mi><mo id="S4.E5.m2.8.8.1.1.1.3.3.2.2" xref="S4.E5.m2.8.8.1.1.1.3.3.1.cmml">,</mo><mi id="S4.E5.m2.4.4" xref="S4.E5.m2.4.4.cmml">𝐭</mi><mo id="S4.E5.m2.8.8.1.1.1.3.3.2.3" stretchy="false" xref="S4.E5.m2.8.8.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m2.8.8.1.1.1.2" xref="S4.E5.m2.8.8.1.1.1.2.cmml">−</mo><msub id="S4.E5.m2.8.8.1.1.1.1.1" xref="S4.E5.m2.8.8.1.1.1.1.2.cmml"><mrow id="S4.E5.m2.8.8.1.1.1.1.1.1" xref="S4.E5.m2.8.8.1.1.1.1.2.cmml"><mrow id="S4.E5.m2.8.8.1.1.1.1.1.1.1" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.8.8.1.1.1.1.1.1.1.2" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E5.m2.8.8.1.1.1.1.1.1.1.1" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.2" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E5.m2.5.5" xref="S4.E5.m2.5.5.cmml">𝒙</mi><mo id="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.2.2" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E5.m2.6.6" xref="S4.E5.m2.6.6.cmml">𝐭</mi><mo id="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m2.8.8.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E5.m2.8.8.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S4.E5.m2.7.7.1" xref="S4.E5.m2.7.7.1.cmml"><msub id="S4.E5.m2.7.7.1.2" xref="S4.E5.m2.7.7.1.2.cmml"><mi id="S4.E5.m2.7.7.1.2.2" xref="S4.E5.m2.7.7.1.2.2.cmml">a</mi><mi id="S4.E5.m2.7.7.1.2.3" xref="S4.E5.m2.7.7.1.2.3.cmml">j</mi></msub><mo id="S4.E5.m2.7.7.1.1" xref="S4.E5.m2.7.7.1.1.cmml">=</mo><mn id="S4.E5.m2.7.7.1.3" xref="S4.E5.m2.7.7.1.3.cmml">0</mn></mrow></msub></mrow><mo id="S4.E5.m2.8.8.1.1.5" xref="S4.E5.m2.8.8.1.1.5.cmml">≈</mo><mrow id="S4.E5.m2.8.8.1.1.6" xref="S4.E5.m2.8.8.1.1.6.cmml"><msub id="S4.E5.m2.8.8.1.1.6.2" xref="S4.E5.m2.8.8.1.1.6.2.cmml"><mi id="S4.E5.m2.8.8.1.1.6.2.2" xref="S4.E5.m2.8.8.1.1.6.2.2.cmml">a</mi><mi id="S4.E5.m2.8.8.1.1.6.2.3" xref="S4.E5.m2.8.8.1.1.6.2.3.cmml">j</mi></msub><mo id="S4.E5.m2.8.8.1.1.6.1" xref="S4.E5.m2.8.8.1.1.6.1.cmml">⁢</mo><mstyle displaystyle="true" id="S4.E5.m2.2.2" xref="S4.E5.m2.2.2.cmml"><mfrac id="S4.E5.m2.2.2a" xref="S4.E5.m2.2.2.cmml"><mrow id="S4.E5.m2.2.2.2" xref="S4.E5.m2.2.2.2.cmml"><mo id="S4.E5.m2.2.2.2.3" rspace="0em" xref="S4.E5.m2.2.2.2.3.cmml">∂</mo><mrow id="S4.E5.m2.2.2.2.4" xref="S4.E5.m2.2.2.2.4.cmml"><mi id="S4.E5.m2.2.2.2.4.2" xref="S4.E5.m2.2.2.2.4.2.cmml">y</mi><mo id="S4.E5.m2.2.2.2.4.1" xref="S4.E5.m2.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.E5.m2.2.2.2.4.3.2" xref="S4.E5.m2.2.2.2.4.3.1.cmml"><mo id="S4.E5.m2.2.2.2.4.3.2.1" stretchy="false" xref="S4.E5.m2.2.2.2.4.3.1.cmml">(</mo><mi id="S4.E5.m2.1.1.1.1" xref="S4.E5.m2.1.1.1.1.cmml">𝒙</mi><mo id="S4.E5.m2.2.2.2.4.3.2.2" xref="S4.E5.m2.2.2.2.4.3.1.cmml">,</mo><mi id="S4.E5.m2.2.2.2.2" xref="S4.E5.m2.2.2.2.2.cmml">𝐭</mi><mo id="S4.E5.m2.2.2.2.4.3.2.3" stretchy="false" xref="S4.E5.m2.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E5.m2.2.2.4" xref="S4.E5.m2.2.2.4.cmml"><mo id="S4.E5.m2.2.2.4.1" rspace="0em" xref="S4.E5.m2.2.2.4.1.cmml">∂</mo><msub id="S4.E5.m2.2.2.4.2" xref="S4.E5.m2.2.2.4.2.cmml"><mi id="S4.E5.m2.2.2.4.2.2" xref="S4.E5.m2.2.2.4.2.2.cmml">a</mi><mi id="S4.E5.m2.2.2.4.2.3" xref="S4.E5.m2.2.2.4.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle></mrow></mrow><mo id="S4.E5.m2.8.8.1.2" lspace="0.330em" xref="S4.E5.m2.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m2.8b"><apply id="S4.E5.m2.8.8.1.1.cmml" xref="S4.E5.m2.8.8.1"><and id="S4.E5.m2.8.8.1.1a.cmml" xref="S4.E5.m2.8.8.1"></and><apply id="S4.E5.m2.8.8.1.1b.cmml" xref="S4.E5.m2.8.8.1"><eq id="S4.E5.m2.8.8.1.1.4.cmml" xref="S4.E5.m2.8.8.1.1.4"></eq><csymbol cd="latexml" id="S4.E5.m2.8.8.1.1.3.cmml" xref="S4.E5.m2.8.8.1.1.3">absent</csymbol><apply id="S4.E5.m2.8.8.1.1.1.cmml" xref="S4.E5.m2.8.8.1.1.1"><minus id="S4.E5.m2.8.8.1.1.1.2.cmml" xref="S4.E5.m2.8.8.1.1.1.2"></minus><apply id="S4.E5.m2.8.8.1.1.1.3.cmml" xref="S4.E5.m2.8.8.1.1.1.3"><times id="S4.E5.m2.8.8.1.1.1.3.1.cmml" xref="S4.E5.m2.8.8.1.1.1.3.1"></times><ci id="S4.E5.m2.8.8.1.1.1.3.2.cmml" xref="S4.E5.m2.8.8.1.1.1.3.2">𝑦</ci><interval closure="open" id="S4.E5.m2.8.8.1.1.1.3.3.1.cmml" xref="S4.E5.m2.8.8.1.1.1.3.3.2"><ci id="S4.E5.m2.3.3.cmml" xref="S4.E5.m2.3.3">𝒙</ci><ci id="S4.E5.m2.4.4.cmml" xref="S4.E5.m2.4.4">𝐭</ci></interval></apply><apply id="S4.E5.m2.8.8.1.1.1.1.2.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m2.8.8.1.1.1.1.2.1.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S4.E5.m2.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1"><times id="S4.E5.m2.8.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.1"></times><ci id="S4.E5.m2.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.2">𝑦</ci><interval closure="open" id="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m2.8.8.1.1.1.1.1.1.1.3.2"><ci id="S4.E5.m2.5.5.cmml" xref="S4.E5.m2.5.5">𝒙</ci><ci id="S4.E5.m2.6.6.cmml" xref="S4.E5.m2.6.6">𝐭</ci></interval></apply><apply id="S4.E5.m2.7.7.1.cmml" xref="S4.E5.m2.7.7.1"><eq id="S4.E5.m2.7.7.1.1.cmml" xref="S4.E5.m2.7.7.1.1"></eq><apply id="S4.E5.m2.7.7.1.2.cmml" xref="S4.E5.m2.7.7.1.2"><csymbol cd="ambiguous" id="S4.E5.m2.7.7.1.2.1.cmml" xref="S4.E5.m2.7.7.1.2">subscript</csymbol><ci id="S4.E5.m2.7.7.1.2.2.cmml" xref="S4.E5.m2.7.7.1.2.2">𝑎</ci><ci id="S4.E5.m2.7.7.1.2.3.cmml" xref="S4.E5.m2.7.7.1.2.3">𝑗</ci></apply><cn id="S4.E5.m2.7.7.1.3.cmml" type="integer" xref="S4.E5.m2.7.7.1.3">0</cn></apply></apply></apply></apply><apply id="S4.E5.m2.8.8.1.1c.cmml" xref="S4.E5.m2.8.8.1"><approx id="S4.E5.m2.8.8.1.1.5.cmml" xref="S4.E5.m2.8.8.1.1.5"></approx><share href="https://arxiv.org/html/2505.20229v1#S4.E5.m2.8.8.1.1.1.cmml" id="S4.E5.m2.8.8.1.1d.cmml" xref="S4.E5.m2.8.8.1"></share><apply id="S4.E5.m2.8.8.1.1.6.cmml" xref="S4.E5.m2.8.8.1.1.6"><times id="S4.E5.m2.8.8.1.1.6.1.cmml" xref="S4.E5.m2.8.8.1.1.6.1"></times><apply id="S4.E5.m2.8.8.1.1.6.2.cmml" xref="S4.E5.m2.8.8.1.1.6.2"><csymbol cd="ambiguous" id="S4.E5.m2.8.8.1.1.6.2.1.cmml" xref="S4.E5.m2.8.8.1.1.6.2">subscript</csymbol><ci id="S4.E5.m2.8.8.1.1.6.2.2.cmml" xref="S4.E5.m2.8.8.1.1.6.2.2">𝑎</ci><ci id="S4.E5.m2.8.8.1.1.6.2.3.cmml" xref="S4.E5.m2.8.8.1.1.6.2.3">𝑗</ci></apply><apply id="S4.E5.m2.2.2.cmml" xref="S4.E5.m2.2.2"><divide id="S4.E5.m2.2.2.3.cmml" xref="S4.E5.m2.2.2"></divide><apply id="S4.E5.m2.2.2.2.cmml" xref="S4.E5.m2.2.2.2"><partialdiff id="S4.E5.m2.2.2.2.3.cmml" xref="S4.E5.m2.2.2.2.3"></partialdiff><apply id="S4.E5.m2.2.2.2.4.cmml" xref="S4.E5.m2.2.2.2.4"><times id="S4.E5.m2.2.2.2.4.1.cmml" xref="S4.E5.m2.2.2.2.4.1"></times><ci id="S4.E5.m2.2.2.2.4.2.cmml" xref="S4.E5.m2.2.2.2.4.2">𝑦</ci><interval closure="open" id="S4.E5.m2.2.2.2.4.3.1.cmml" xref="S4.E5.m2.2.2.2.4.3.2"><ci id="S4.E5.m2.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1">𝒙</ci><ci id="S4.E5.m2.2.2.2.2.cmml" xref="S4.E5.m2.2.2.2.2">𝐭</ci></interval></apply></apply><apply id="S4.E5.m2.2.2.4.cmml" xref="S4.E5.m2.2.2.4"><partialdiff id="S4.E5.m2.2.2.4.1.cmml" xref="S4.E5.m2.2.2.4.1"></partialdiff><apply id="S4.E5.m2.2.2.4.2.cmml" xref="S4.E5.m2.2.2.4.2"><csymbol cd="ambiguous" id="S4.E5.m2.2.2.4.2.1.cmml" xref="S4.E5.m2.2.2.4.2">subscript</csymbol><ci id="S4.E5.m2.2.2.4.2.2.cmml" xref="S4.E5.m2.2.2.4.2.2">𝑎</ci><ci id="S4.E5.m2.2.2.4.2.3.cmml" xref="S4.E5.m2.2.2.4.2.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m2.8c">\displaystyle=y(\boldsymbol{x},\mathbf{t})-y(\boldsymbol{x},\mathbf{t})\big{|}%
_{a_{j}=0}\approx a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a%
_{j}}~{},</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m2.8d">= italic_y ( bold_italic_x , bold_t ) - italic_y ( bold_italic_x , bold_t ) | start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT ≈ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∂ italic_y ( bold_italic_x , bold_t ) end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.8">resembling Input<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m1.1"><semantics id="S4.SS1.p1.5.m1.1a"><mo id="S4.SS1.p1.5.m1.1.1" xref="S4.SS1.p1.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m1.1b"><times id="S4.SS1.p1.5.m1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m1.1d">×</annotation></semantics></math>Gradient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib46" title="">46</a>]</cite> attributions in the latent space (i.e., “Activation<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m2.1"><semantics id="S4.SS1.p1.6.m2.1a"><mo id="S4.SS1.p1.6.m2.1.1" xref="S4.SS1.p1.6.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m2.1b"><times id="S4.SS1.p1.6.m2.1.1.cmml" xref="S4.SS1.p1.6.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m2.1d">×</annotation></semantics></math>Gradient”), which showed faithful results for convolutional networks before <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib11" title="">11</a>]</cite>.
As derived in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2" title="Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">B</span></a>, when assuming that the LayerNorm bias <math alttext="\boldsymbol{\beta}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m3.1"><semantics id="S4.SS1.p1.7.m3.1a"><mi id="S4.SS1.p1.7.m3.1.1" xref="S4.SS1.p1.7.m3.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m3.1b"><ci id="S4.SS1.p1.7.m3.1.1.cmml" xref="S4.SS1.p1.7.m3.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m3.1c">\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m3.1d">bold_italic_β</annotation></semantics></math> is small,
we receive the approximation for <math alttext="R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m4.2"><semantics id="S4.SS1.p1.8.m4.2a"><mrow id="S4.SS1.p1.8.m4.2.3" xref="S4.SS1.p1.8.m4.2.3.cmml"><msub id="S4.SS1.p1.8.m4.2.3.2" xref="S4.SS1.p1.8.m4.2.3.2.cmml"><mi id="S4.SS1.p1.8.m4.2.3.2.2" xref="S4.SS1.p1.8.m4.2.3.2.2.cmml">R</mi><mi id="S4.SS1.p1.8.m4.2.3.2.3" xref="S4.SS1.p1.8.m4.2.3.2.3.cmml">j</mi></msub><mo id="S4.SS1.p1.8.m4.2.3.1" xref="S4.SS1.p1.8.m4.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.8.m4.2.3.3.2" xref="S4.SS1.p1.8.m4.2.3.3.1.cmml"><mo id="S4.SS1.p1.8.m4.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.8.m4.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.8.m4.1.1" xref="S4.SS1.p1.8.m4.1.1.cmml">𝒙</mi><mo id="S4.SS1.p1.8.m4.2.3.3.2.2" xref="S4.SS1.p1.8.m4.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.8.m4.2.2" xref="S4.SS1.p1.8.m4.2.2.cmml">𝐭</mi><mo id="S4.SS1.p1.8.m4.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.8.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m4.2b"><apply id="S4.SS1.p1.8.m4.2.3.cmml" xref="S4.SS1.p1.8.m4.2.3"><times id="S4.SS1.p1.8.m4.2.3.1.cmml" xref="S4.SS1.p1.8.m4.2.3.1"></times><apply id="S4.SS1.p1.8.m4.2.3.2.cmml" xref="S4.SS1.p1.8.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m4.2.3.2.1.cmml" xref="S4.SS1.p1.8.m4.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.8.m4.2.3.2.2.cmml" xref="S4.SS1.p1.8.m4.2.3.2.2">𝑅</ci><ci id="S4.SS1.p1.8.m4.2.3.2.3.cmml" xref="S4.SS1.p1.8.m4.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S4.SS1.p1.8.m4.2.3.3.1.cmml" xref="S4.SS1.p1.8.m4.2.3.3.2"><ci id="S4.SS1.p1.8.m4.1.1.cmml" xref="S4.SS1.p1.8.m4.1.1">𝒙</ci><ci id="S4.SS1.p1.8.m4.2.2.cmml" xref="S4.SS1.p1.8.m4.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m4.2c">R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m4.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math> of</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}}\overset{%
\boldsymbol{\beta}\rightarrow 0}{=}a_{j}\frac{\|\boldsymbol{v}_{j}\|}{\|%
\boldsymbol{x}\|}\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-%
\mu_{\mathbf{x}}\|}\left(\texttt{LogitLens}_{j}(\mathbf{t})-y(\boldsymbol{x},%
\mathbf{t})\frac{\boldsymbol{v}_{j}}{\|\boldsymbol{v}_{j}\|}\cdot\frac{%
\boldsymbol{x}}{\|\boldsymbol{x}\|}\right)~{}," class="ltx_Math" display="block" id="S4.E6.m1.12"><semantics id="S4.E6.m1.12a"><mrow id="S4.E6.m1.12.12.1" xref="S4.E6.m1.12.12.1.1.cmml"><mrow id="S4.E6.m1.12.12.1.1" xref="S4.E6.m1.12.12.1.1.cmml"><msub id="S4.E6.m1.12.12.1.1.3" xref="S4.E6.m1.12.12.1.1.3.cmml"><mi id="S4.E6.m1.12.12.1.1.3.2" xref="S4.E6.m1.12.12.1.1.3.2.cmml">a</mi><mi id="S4.E6.m1.12.12.1.1.3.3" xref="S4.E6.m1.12.12.1.1.3.3.cmml">j</mi></msub><mo id="S4.E6.m1.12.12.1.1.2" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><mfrac id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><mo id="S4.E6.m1.2.2.2.3" rspace="0em" xref="S4.E6.m1.2.2.2.3.cmml">∂</mo><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.4.cmml"><mi id="S4.E6.m1.2.2.2.4.2" xref="S4.E6.m1.2.2.2.4.2.cmml">y</mi><mo id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.4.3.2" xref="S4.E6.m1.2.2.2.4.3.1.cmml"><mo id="S4.E6.m1.2.2.2.4.3.2.1" stretchy="false" xref="S4.E6.m1.2.2.2.4.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">𝒙</mi><mo id="S4.E6.m1.2.2.2.4.3.2.2" xref="S4.E6.m1.2.2.2.4.3.1.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">𝐭</mi><mo id="S4.E6.m1.2.2.2.4.3.2.3" stretchy="false" xref="S4.E6.m1.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E6.m1.2.2.4" xref="S4.E6.m1.2.2.4.cmml"><mo id="S4.E6.m1.2.2.4.1" rspace="0em" xref="S4.E6.m1.2.2.4.1.cmml">∂</mo><msub id="S4.E6.m1.2.2.4.2" xref="S4.E6.m1.2.2.4.2.cmml"><mi id="S4.E6.m1.2.2.4.2.2" xref="S4.E6.m1.2.2.4.2.2.cmml">a</mi><mi id="S4.E6.m1.2.2.4.2.3" xref="S4.E6.m1.2.2.4.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="S4.E6.m1.12.12.1.1.2a" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><mover accent="true" id="S4.E6.m1.12.12.1.1.4" xref="S4.E6.m1.12.12.1.1.4.cmml"><mo id="S4.E6.m1.12.12.1.1.4.2" xref="S4.E6.m1.12.12.1.1.4.2.cmml">=</mo><mrow id="S4.E6.m1.12.12.1.1.4.1" xref="S4.E6.m1.12.12.1.1.4.1.cmml"><mi id="S4.E6.m1.12.12.1.1.4.1.2" xref="S4.E6.m1.12.12.1.1.4.1.2.cmml">𝜷</mi><mo id="S4.E6.m1.12.12.1.1.4.1.1" stretchy="false" xref="S4.E6.m1.12.12.1.1.4.1.1.cmml">→</mo><mn id="S4.E6.m1.12.12.1.1.4.1.3" xref="S4.E6.m1.12.12.1.1.4.1.3.cmml">0</mn></mrow></mover><mo id="S4.E6.m1.12.12.1.1.2b" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><msub id="S4.E6.m1.12.12.1.1.5" xref="S4.E6.m1.12.12.1.1.5.cmml"><mi id="S4.E6.m1.12.12.1.1.5.2" xref="S4.E6.m1.12.12.1.1.5.2.cmml">a</mi><mi id="S4.E6.m1.12.12.1.1.5.3" xref="S4.E6.m1.12.12.1.1.5.3.cmml">j</mi></msub><mo id="S4.E6.m1.12.12.1.1.2c" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><mfrac id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.2.cmml"><mo id="S4.E6.m1.3.3.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.2.1.cmml">‖</mo><msub id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">𝒗</mi><mi id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml">j</mi></msub><mo id="S4.E6.m1.3.3.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.2.1.cmml">‖</mo></mrow><mrow id="S4.E6.m1.4.4.2.3" xref="S4.E6.m1.4.4.2.2.cmml"><mo id="S4.E6.m1.4.4.2.3.1" stretchy="false" xref="S4.E6.m1.4.4.2.2.1.cmml">‖</mo><mi id="S4.E6.m1.4.4.2.1" xref="S4.E6.m1.4.4.2.1.cmml">𝒙</mi><mo id="S4.E6.m1.4.4.2.3.2" stretchy="false" xref="S4.E6.m1.4.4.2.2.1.cmml">‖</mo></mrow></mfrac><mo id="S4.E6.m1.12.12.1.1.2d" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><mfrac id="S4.E6.m1.6.6" xref="S4.E6.m1.6.6.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.2.cmml"><mo id="S4.E6.m1.5.5.1.1.2" stretchy="false" xref="S4.E6.m1.5.5.1.2.1.cmml">‖</mo><mrow id="S4.E6.m1.5.5.1.1.1" xref="S4.E6.m1.5.5.1.1.1.cmml"><msub id="S4.E6.m1.5.5.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><mi id="S4.E6.m1.5.5.1.1.1.2.2" xref="S4.E6.m1.5.5.1.1.1.2.2.cmml">𝐯</mi><mi id="S4.E6.m1.5.5.1.1.1.2.3" xref="S4.E6.m1.5.5.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.E6.m1.5.5.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.cmml">−</mo><msub id="S4.E6.m1.5.5.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.3.cmml"><mi id="S4.E6.m1.5.5.1.1.1.3.2" xref="S4.E6.m1.5.5.1.1.1.3.2.cmml">μ</mi><msub id="S4.E6.m1.5.5.1.1.1.3.3" xref="S4.E6.m1.5.5.1.1.1.3.3.cmml"><mi id="S4.E6.m1.5.5.1.1.1.3.3.2" xref="S4.E6.m1.5.5.1.1.1.3.3.2.cmml">𝐯</mi><mi id="S4.E6.m1.5.5.1.1.1.3.3.3" xref="S4.E6.m1.5.5.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="S4.E6.m1.5.5.1.1.3" stretchy="false" xref="S4.E6.m1.5.5.1.2.1.cmml">‖</mo></mrow><mrow id="S4.E6.m1.6.6.2.1" xref="S4.E6.m1.6.6.2.2.cmml"><mo id="S4.E6.m1.6.6.2.1.2" stretchy="false" xref="S4.E6.m1.6.6.2.2.1.cmml">‖</mo><mrow id="S4.E6.m1.6.6.2.1.1" xref="S4.E6.m1.6.6.2.1.1.cmml"><mi id="S4.E6.m1.6.6.2.1.1.2" xref="S4.E6.m1.6.6.2.1.1.2.cmml">𝐱</mi><mo id="S4.E6.m1.6.6.2.1.1.1" xref="S4.E6.m1.6.6.2.1.1.1.cmml">−</mo><msub id="S4.E6.m1.6.6.2.1.1.3" xref="S4.E6.m1.6.6.2.1.1.3.cmml"><mi id="S4.E6.m1.6.6.2.1.1.3.2" xref="S4.E6.m1.6.6.2.1.1.3.2.cmml">μ</mi><mi id="S4.E6.m1.6.6.2.1.1.3.3" xref="S4.E6.m1.6.6.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="S4.E6.m1.6.6.2.1.3" stretchy="false" xref="S4.E6.m1.6.6.2.2.1.cmml">‖</mo></mrow></mfrac><mo id="S4.E6.m1.12.12.1.1.2e" xref="S4.E6.m1.12.12.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.12.12.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.cmml"><mo id="S4.E6.m1.12.12.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.12.12.1.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.2.cmml"><msub id="S4.E6.m1.12.12.1.1.1.1.1.2.2" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.E6.m1.12.12.1.1.1.1.1.2.2.2" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.2a.cmml">LogitLens</mtext><mi id="S4.E6.m1.12.12.1.1.1.1.1.2.2.3" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S4.E6.m1.12.12.1.1.1.1.1.2.1" xref="S4.E6.m1.12.12.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1.2.3.2" xref="S4.E6.m1.12.12.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.12.12.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E6.m1.12.12.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E6.m1.9.9" xref="S4.E6.m1.9.9.cmml">𝐭</mi><mo id="S4.E6.m1.12.12.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.E6.m1.12.12.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.12.12.1.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1.3" xref="S4.E6.m1.12.12.1.1.1.1.1.3.cmml"><mrow id="S4.E6.m1.12.12.1.1.1.1.1.3.2" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.12.12.1.1.1.1.1.3.2.2" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.2.1" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.2" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.1.cmml"><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.2.1" stretchy="false" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.1.cmml">(</mo><mi id="S4.E6.m1.10.10" xref="S4.E6.m1.10.10.cmml">𝒙</mi><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.2.2" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.1.cmml">,</mo><mi id="S4.E6.m1.11.11" xref="S4.E6.m1.11.11.cmml">𝐭</mi><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.2.3" stretchy="false" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.1.cmml">)</mo></mrow><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.2.1a" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.1.cmml">⁢</mo><mfrac id="S4.E6.m1.7.7" xref="S4.E6.m1.7.7.cmml"><msub id="S4.E6.m1.7.7.3" xref="S4.E6.m1.7.7.3.cmml"><mi id="S4.E6.m1.7.7.3.2" xref="S4.E6.m1.7.7.3.2.cmml">𝒗</mi><mi id="S4.E6.m1.7.7.3.3" xref="S4.E6.m1.7.7.3.3.cmml">j</mi></msub><mrow id="S4.E6.m1.7.7.1.1" xref="S4.E6.m1.7.7.1.2.cmml"><mo id="S4.E6.m1.7.7.1.1.2" stretchy="false" xref="S4.E6.m1.7.7.1.2.1.cmml">‖</mo><msub id="S4.E6.m1.7.7.1.1.1" xref="S4.E6.m1.7.7.1.1.1.cmml"><mi id="S4.E6.m1.7.7.1.1.1.2" xref="S4.E6.m1.7.7.1.1.1.2.cmml">𝒗</mi><mi id="S4.E6.m1.7.7.1.1.1.3" xref="S4.E6.m1.7.7.1.1.1.3.cmml">j</mi></msub><mo id="S4.E6.m1.7.7.1.1.3" stretchy="false" xref="S4.E6.m1.7.7.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S4.E6.m1.12.12.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.12.12.1.1.1.1.1.3.1.cmml">⋅</mo><mfrac id="S4.E6.m1.8.8" xref="S4.E6.m1.8.8.cmml"><mi id="S4.E6.m1.8.8.3" xref="S4.E6.m1.8.8.3.cmml">𝒙</mi><mrow id="S4.E6.m1.8.8.1.3" xref="S4.E6.m1.8.8.1.2.cmml"><mo id="S4.E6.m1.8.8.1.3.1" stretchy="false" xref="S4.E6.m1.8.8.1.2.1.cmml">‖</mo><mi id="S4.E6.m1.8.8.1.1" xref="S4.E6.m1.8.8.1.1.cmml">𝒙</mi><mo id="S4.E6.m1.8.8.1.3.2" stretchy="false" xref="S4.E6.m1.8.8.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow><mo id="S4.E6.m1.12.12.1.1.1.1.3" rspace="0.330em" xref="S4.E6.m1.12.12.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.12.12.1.2" xref="S4.E6.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.12b"><apply id="S4.E6.m1.12.12.1.1.cmml" xref="S4.E6.m1.12.12.1"><times id="S4.E6.m1.12.12.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.2"></times><apply id="S4.E6.m1.12.12.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.1.1.3.1.cmml" xref="S4.E6.m1.12.12.1.1.3">subscript</csymbol><ci id="S4.E6.m1.12.12.1.1.3.2.cmml" xref="S4.E6.m1.12.12.1.1.3.2">𝑎</ci><ci id="S4.E6.m1.12.12.1.1.3.3.cmml" xref="S4.E6.m1.12.12.1.1.3.3">𝑗</ci></apply><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><divide id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2"></divide><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><partialdiff id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.3"></partialdiff><apply id="S4.E6.m1.2.2.2.4.cmml" xref="S4.E6.m1.2.2.2.4"><times id="S4.E6.m1.2.2.2.4.1.cmml" xref="S4.E6.m1.2.2.2.4.1"></times><ci id="S4.E6.m1.2.2.2.4.2.cmml" xref="S4.E6.m1.2.2.2.4.2">𝑦</ci><interval closure="open" id="S4.E6.m1.2.2.2.4.3.1.cmml" xref="S4.E6.m1.2.2.2.4.3.2"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝒙</ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝐭</ci></interval></apply></apply><apply id="S4.E6.m1.2.2.4.cmml" xref="S4.E6.m1.2.2.4"><partialdiff id="S4.E6.m1.2.2.4.1.cmml" xref="S4.E6.m1.2.2.4.1"></partialdiff><apply id="S4.E6.m1.2.2.4.2.cmml" xref="S4.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.2.1.cmml" xref="S4.E6.m1.2.2.4.2">subscript</csymbol><ci id="S4.E6.m1.2.2.4.2.2.cmml" xref="S4.E6.m1.2.2.4.2.2">𝑎</ci><ci id="S4.E6.m1.2.2.4.2.3.cmml" xref="S4.E6.m1.2.2.4.2.3">𝑗</ci></apply></apply></apply><apply id="S4.E6.m1.12.12.1.1.4.cmml" xref="S4.E6.m1.12.12.1.1.4"><apply id="S4.E6.m1.12.12.1.1.4.1.cmml" xref="S4.E6.m1.12.12.1.1.4.1"><ci id="S4.E6.m1.12.12.1.1.4.1.1.cmml" xref="S4.E6.m1.12.12.1.1.4.1.1">→</ci><ci id="S4.E6.m1.12.12.1.1.4.1.2.cmml" xref="S4.E6.m1.12.12.1.1.4.1.2">𝜷</ci><cn id="S4.E6.m1.12.12.1.1.4.1.3.cmml" type="integer" xref="S4.E6.m1.12.12.1.1.4.1.3">0</cn></apply><eq id="S4.E6.m1.12.12.1.1.4.2.cmml" xref="S4.E6.m1.12.12.1.1.4.2"></eq></apply><apply id="S4.E6.m1.12.12.1.1.5.cmml" xref="S4.E6.m1.12.12.1.1.5"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.1.1.5.1.cmml" xref="S4.E6.m1.12.12.1.1.5">subscript</csymbol><ci id="S4.E6.m1.12.12.1.1.5.2.cmml" xref="S4.E6.m1.12.12.1.1.5.2">𝑎</ci><ci id="S4.E6.m1.12.12.1.1.5.3.cmml" xref="S4.E6.m1.12.12.1.1.5.3">𝑗</ci></apply><apply id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"><divide id="S4.E6.m1.4.4.3.cmml" xref="S4.E6.m1.4.4"></divide><apply id="S4.E6.m1.3.3.1.2.cmml" xref="S4.E6.m1.3.3.1.1"><csymbol cd="latexml" id="S4.E6.m1.3.3.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2">norm</csymbol><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2">𝒗</ci><ci id="S4.E6.m1.3.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.3"><csymbol cd="latexml" id="S4.E6.m1.4.4.2.2.1.cmml" xref="S4.E6.m1.4.4.2.3.1">norm</csymbol><ci id="S4.E6.m1.4.4.2.1.cmml" xref="S4.E6.m1.4.4.2.1">𝒙</ci></apply></apply><apply id="S4.E6.m1.6.6.cmml" xref="S4.E6.m1.6.6"><divide id="S4.E6.m1.6.6.3.cmml" xref="S4.E6.m1.6.6"></divide><apply id="S4.E6.m1.5.5.1.2.cmml" xref="S4.E6.m1.5.5.1.1"><csymbol cd="latexml" id="S4.E6.m1.5.5.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">norm</csymbol><apply id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"><minus id="S4.E6.m1.5.5.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1"></minus><apply id="S4.E6.m1.5.5.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2">𝐯</ci><ci id="S4.E6.m1.5.5.1.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.1.2.3">𝑗</ci></apply><apply id="S4.E6.m1.5.5.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.1.3.2">𝜇</ci><apply id="S4.E6.m1.5.5.1.1.1.3.3.cmml" xref="S4.E6.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.1.3.3.2">𝐯</ci><ci id="S4.E6.m1.5.5.1.1.1.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E6.m1.6.6.2.2.cmml" xref="S4.E6.m1.6.6.2.1"><csymbol cd="latexml" id="S4.E6.m1.6.6.2.2.1.cmml" xref="S4.E6.m1.6.6.2.1.2">norm</csymbol><apply id="S4.E6.m1.6.6.2.1.1.cmml" xref="S4.E6.m1.6.6.2.1.1"><minus id="S4.E6.m1.6.6.2.1.1.1.cmml" xref="S4.E6.m1.6.6.2.1.1.1"></minus><ci id="S4.E6.m1.6.6.2.1.1.2.cmml" xref="S4.E6.m1.6.6.2.1.1.2">𝐱</ci><apply id="S4.E6.m1.6.6.2.1.1.3.cmml" xref="S4.E6.m1.6.6.2.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.6.6.2.1.1.3.1.cmml" xref="S4.E6.m1.6.6.2.1.1.3">subscript</csymbol><ci id="S4.E6.m1.6.6.2.1.1.3.2.cmml" xref="S4.E6.m1.6.6.2.1.1.3.2">𝜇</ci><ci id="S4.E6.m1.6.6.2.1.1.3.3.cmml" xref="S4.E6.m1.6.6.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="S4.E6.m1.12.12.1.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1"><minus id="S4.E6.m1.12.12.1.1.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1"></minus><apply id="S4.E6.m1.12.12.1.1.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2"><times id="S4.E6.m1.12.12.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.1"></times><apply id="S4.E6.m1.12.12.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.1.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E6.m1.12.12.1.1.1.1.1.2.2.2a.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="S4.E6.m1.12.12.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.2">LogitLens</mtext></ci><ci id="S4.E6.m1.12.12.1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E6.m1.9.9.cmml" xref="S4.E6.m1.9.9">𝐭</ci></apply><apply id="S4.E6.m1.12.12.1.1.1.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3"><ci id="S4.E6.m1.12.12.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E6.m1.12.12.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2"><times id="S4.E6.m1.12.12.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.1"></times><ci id="S4.E6.m1.12.12.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.2">𝑦</ci><interval closure="open" id="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.3.2.3.2"><ci id="S4.E6.m1.10.10.cmml" xref="S4.E6.m1.10.10">𝒙</ci><ci id="S4.E6.m1.11.11.cmml" xref="S4.E6.m1.11.11">𝐭</ci></interval><apply id="S4.E6.m1.7.7.cmml" xref="S4.E6.m1.7.7"><divide id="S4.E6.m1.7.7.2.cmml" xref="S4.E6.m1.7.7"></divide><apply id="S4.E6.m1.7.7.3.cmml" xref="S4.E6.m1.7.7.3"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.3.1.cmml" xref="S4.E6.m1.7.7.3">subscript</csymbol><ci id="S4.E6.m1.7.7.3.2.cmml" xref="S4.E6.m1.7.7.3.2">𝒗</ci><ci id="S4.E6.m1.7.7.3.3.cmml" xref="S4.E6.m1.7.7.3.3">𝑗</ci></apply><apply id="S4.E6.m1.7.7.1.2.cmml" xref="S4.E6.m1.7.7.1.1"><csymbol cd="latexml" id="S4.E6.m1.7.7.1.2.1.cmml" xref="S4.E6.m1.7.7.1.1.2">norm</csymbol><apply id="S4.E6.m1.7.7.1.1.1.cmml" xref="S4.E6.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.1.1.1.1.cmml" xref="S4.E6.m1.7.7.1.1.1">subscript</csymbol><ci id="S4.E6.m1.7.7.1.1.1.2.cmml" xref="S4.E6.m1.7.7.1.1.1.2">𝒗</ci><ci id="S4.E6.m1.7.7.1.1.1.3.cmml" xref="S4.E6.m1.7.7.1.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E6.m1.8.8.cmml" xref="S4.E6.m1.8.8"><divide id="S4.E6.m1.8.8.2.cmml" xref="S4.E6.m1.8.8"></divide><ci id="S4.E6.m1.8.8.3.cmml" xref="S4.E6.m1.8.8.3">𝒙</ci><apply id="S4.E6.m1.8.8.1.2.cmml" xref="S4.E6.m1.8.8.1.3"><csymbol cd="latexml" id="S4.E6.m1.8.8.1.2.1.cmml" xref="S4.E6.m1.8.8.1.3.1">norm</csymbol><ci id="S4.E6.m1.8.8.1.1.cmml" xref="S4.E6.m1.8.8.1.1">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.12c">a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}}\overset{%
\boldsymbol{\beta}\rightarrow 0}{=}a_{j}\frac{\|\boldsymbol{v}_{j}\|}{\|%
\boldsymbol{x}\|}\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-%
\mu_{\mathbf{x}}\|}\left(\texttt{LogitLens}_{j}(\mathbf{t})-y(\boldsymbol{x},%
\mathbf{t})\frac{\boldsymbol{v}_{j}}{\|\boldsymbol{v}_{j}\|}\cdot\frac{%
\boldsymbol{x}}{\|\boldsymbol{x}\|}\right)~{},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.12d">italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∂ italic_y ( bold_italic_x , bold_t ) end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_OVERACCENT bold_italic_β → 0 end_OVERACCENT start_ARG = end_ARG italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG ( LogitLens start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t ) - italic_y ( bold_italic_x , bold_t ) divide start_ARG bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG ⋅ divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.13">where <math alttext="\mu_{\mathbf{x}/\mathbf{v}_{j}}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m1.1"><semantics id="S4.SS1.p1.9.m1.1a"><msub id="S4.SS1.p1.9.m1.1.1" xref="S4.SS1.p1.9.m1.1.1.cmml"><mi id="S4.SS1.p1.9.m1.1.1.2" xref="S4.SS1.p1.9.m1.1.1.2.cmml">μ</mi><mrow id="S4.SS1.p1.9.m1.1.1.3" xref="S4.SS1.p1.9.m1.1.1.3.cmml"><mi id="S4.SS1.p1.9.m1.1.1.3.2" xref="S4.SS1.p1.9.m1.1.1.3.2.cmml">𝐱</mi><mo id="S4.SS1.p1.9.m1.1.1.3.1" xref="S4.SS1.p1.9.m1.1.1.3.1.cmml">/</mo><msub id="S4.SS1.p1.9.m1.1.1.3.3" xref="S4.SS1.p1.9.m1.1.1.3.3.cmml"><mi id="S4.SS1.p1.9.m1.1.1.3.3.2" xref="S4.SS1.p1.9.m1.1.1.3.3.2.cmml">𝐯</mi><mi id="S4.SS1.p1.9.m1.1.1.3.3.3" xref="S4.SS1.p1.9.m1.1.1.3.3.3.cmml">j</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m1.1b"><apply id="S4.SS1.p1.9.m1.1.1.cmml" xref="S4.SS1.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m1.1.1.1.cmml" xref="S4.SS1.p1.9.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m1.1.1.2.cmml" xref="S4.SS1.p1.9.m1.1.1.2">𝜇</ci><apply id="S4.SS1.p1.9.m1.1.1.3.cmml" xref="S4.SS1.p1.9.m1.1.1.3"><divide id="S4.SS1.p1.9.m1.1.1.3.1.cmml" xref="S4.SS1.p1.9.m1.1.1.3.1"></divide><ci id="S4.SS1.p1.9.m1.1.1.3.2.cmml" xref="S4.SS1.p1.9.m1.1.1.3.2">𝐱</ci><apply id="S4.SS1.p1.9.m1.1.1.3.3.cmml" xref="S4.SS1.p1.9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m1.1.1.3.3.1.cmml" xref="S4.SS1.p1.9.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.9.m1.1.1.3.3.2.cmml" xref="S4.SS1.p1.9.m1.1.1.3.3.2">𝐯</ci><ci id="S4.SS1.p1.9.m1.1.1.3.3.3.cmml" xref="S4.SS1.p1.9.m1.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m1.1c">\mu_{\mathbf{x}/\mathbf{v}_{j}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m1.1d">italic_μ start_POSTSUBSCRIPT bold_x / bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> denotes the mean over the elements of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m2.1"><semantics id="S4.SS1.p1.10.m2.1a"><mi id="S4.SS1.p1.10.m2.1.1" xref="S4.SS1.p1.10.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m2.1b"><ci id="S4.SS1.p1.10.m2.1.1.cmml" xref="S4.SS1.p1.10.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m2.1d">bold_x</annotation></semantics></math> or <math alttext="\mathbf{v}_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m3.1"><semantics id="S4.SS1.p1.11.m3.1a"><msub id="S4.SS1.p1.11.m3.1.1" xref="S4.SS1.p1.11.m3.1.1.cmml"><mi id="S4.SS1.p1.11.m3.1.1.2" xref="S4.SS1.p1.11.m3.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p1.11.m3.1.1.3" xref="S4.SS1.p1.11.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m3.1b"><apply id="S4.SS1.p1.11.m3.1.1.cmml" xref="S4.SS1.p1.11.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m3.1.1.1.cmml" xref="S4.SS1.p1.11.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.11.m3.1.1.2.cmml" xref="S4.SS1.p1.11.m3.1.1.2">𝐯</ci><ci id="S4.SS1.p1.11.m3.1.1.3.cmml" xref="S4.SS1.p1.11.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m3.1c">\mathbf{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m3.1d">bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
This highlights the distinction from the Logit Lens method: an additional scaling factor that captures the strength of the latent component (including its activation), as well as a correction term. The correction term reduces the relevance score when the output is already high, and the projected embedding <math alttext="\boldsymbol{v}_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m4.1"><semantics id="S4.SS1.p1.12.m4.1a"><msub id="S4.SS1.p1.12.m4.1.1" xref="S4.SS1.p1.12.m4.1.1.cmml"><mi id="S4.SS1.p1.12.m4.1.1.2" xref="S4.SS1.p1.12.m4.1.1.2.cmml">𝒗</mi><mi id="S4.SS1.p1.12.m4.1.1.3" xref="S4.SS1.p1.12.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m4.1b"><apply id="S4.SS1.p1.12.m4.1.1.cmml" xref="S4.SS1.p1.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m4.1.1.1.cmml" xref="S4.SS1.p1.12.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m4.1.1.2.cmml" xref="S4.SS1.p1.12.m4.1.1.2">𝒗</ci><ci id="S4.SS1.p1.12.m4.1.1.3.cmml" xref="S4.SS1.p1.12.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m4.1c">\boldsymbol{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m4.1d">bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is highly aligned with embedding <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m5.1"><semantics id="S4.SS1.p1.13.m5.1a"><mi id="S4.SS1.p1.13.m5.1.1" xref="S4.SS1.p1.13.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m5.1b"><ci id="S4.SS1.p1.13.m5.1.1.cmml" xref="S4.SS1.p1.13.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m5.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m5.1d">bold_italic_x</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Revealing unexpected concept reliance</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We propose two complementary strategies to identify concepts that models unexpectedly rely on by combining latent relevance scores with either user-defined or statistically derived expectations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.4.1">a) Hidden concepts: high relevance, low alignment:</span>
This approach identifies model components that are highly relevant to a prediction but poorly aligned with known or expected semantics. Specifically, for each component <math alttext="j" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_j</annotation></semantics></math>, we compute a relevance score <math alttext="R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.2"><semantics id="S4.SS2.p2.2.m2.2a"><mrow id="S4.SS2.p2.2.m2.2.3" xref="S4.SS2.p2.2.m2.2.3.cmml"><msub id="S4.SS2.p2.2.m2.2.3.2" xref="S4.SS2.p2.2.m2.2.3.2.cmml"><mi id="S4.SS2.p2.2.m2.2.3.2.2" xref="S4.SS2.p2.2.m2.2.3.2.2.cmml">R</mi><mi id="S4.SS2.p2.2.m2.2.3.2.3" xref="S4.SS2.p2.2.m2.2.3.2.3.cmml">j</mi></msub><mo id="S4.SS2.p2.2.m2.2.3.1" xref="S4.SS2.p2.2.m2.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m2.2.3.3.2" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml"><mo id="S4.SS2.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">𝒙</mi><mo id="S4.SS2.p2.2.m2.2.3.3.2.2" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p2.2.m2.2.2" xref="S4.SS2.p2.2.m2.2.2.cmml">𝐭</mi><mo id="S4.SS2.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS2.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><apply id="S4.SS2.p2.2.m2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.3"><times id="S4.SS2.p2.2.m2.2.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.1"></times><apply id="S4.SS2.p2.2.m2.2.3.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.2.1.cmml" xref="S4.SS2.p2.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.3.2.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2.2">𝑅</ci><ci id="S4.SS2.p2.2.m2.2.3.2.3.cmml" xref="S4.SS2.p2.2.m2.2.3.2.3">𝑗</ci></apply><interval closure="open" id="S4.SS2.p2.2.m2.2.3.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.3.2"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝒙</ci><ci id="S4.SS2.p2.2.m2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math>, and a textual alignment score <math alttext="s_{j}(\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.2" xref="S4.SS2.p2.3.m3.1.2.cmml"><msub id="S4.SS2.p2.3.m3.1.2.2" xref="S4.SS2.p2.3.m3.1.2.2.cmml"><mi id="S4.SS2.p2.3.m3.1.2.2.2" xref="S4.SS2.p2.3.m3.1.2.2.2.cmml">s</mi><mi id="S4.SS2.p2.3.m3.1.2.2.3" xref="S4.SS2.p2.3.m3.1.2.2.3.cmml">j</mi></msub><mo id="S4.SS2.p2.3.m3.1.2.1" xref="S4.SS2.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.3.m3.1.2.3.2" xref="S4.SS2.p2.3.m3.1.2.cmml"><mo id="S4.SS2.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">𝐭</mi><mo id="S4.SS2.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.2.cmml" xref="S4.SS2.p2.3.m3.1.2"><times id="S4.SS2.p2.3.m3.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.2.1"></times><apply id="S4.SS2.p2.3.m3.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.2.2.1.cmml" xref="S4.SS2.p2.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.2.2.2.cmml" xref="S4.SS2.p2.3.m3.1.2.2.2">𝑠</ci><ci id="S4.SS2.p2.3.m3.1.2.2.3.cmml" xref="S4.SS2.p2.3.m3.1.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">s_{j}(\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t )</annotation></semantics></math> (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>) to predefined label embeddings <math alttext="\mathbf{t}\in\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">𝐭</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">𝒯</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><in id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></in><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝐭</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathbf{t}\in\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">bold_t ∈ caligraphic_T</annotation></semantics></math>.
We then select components that satisfy:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{j}(\boldsymbol{x},\mathbf{t})\geq\tau_{\text{rel}},\quad s_{j}(\mathbf{t})%
\leq\tau_{\text{align}}" class="ltx_Math" display="block" id="S4.E7.m1.5"><semantics id="S4.E7.m1.5a"><mrow id="S4.E7.m1.5.5.2" xref="S4.E7.m1.5.5.3.cmml"><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml"><msub id="S4.E7.m1.4.4.1.1.2.2" xref="S4.E7.m1.4.4.1.1.2.2.cmml"><mi id="S4.E7.m1.4.4.1.1.2.2.2" xref="S4.E7.m1.4.4.1.1.2.2.2.cmml">R</mi><mi id="S4.E7.m1.4.4.1.1.2.2.3" xref="S4.E7.m1.4.4.1.1.2.2.3.cmml">j</mi></msub><mo id="S4.E7.m1.4.4.1.1.2.1" xref="S4.E7.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.2.3.2" xref="S4.E7.m1.4.4.1.1.2.3.1.cmml"><mo id="S4.E7.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S4.E7.m1.4.4.1.1.2.3.1.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝒙</mi><mo id="S4.E7.m1.4.4.1.1.2.3.2.2" xref="S4.E7.m1.4.4.1.1.2.3.1.cmml">,</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">𝐭</mi><mo id="S4.E7.m1.4.4.1.1.2.3.2.3" stretchy="false" xref="S4.E7.m1.4.4.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.cmml">≥</mo><msub id="S4.E7.m1.4.4.1.1.3" xref="S4.E7.m1.4.4.1.1.3.cmml"><mi id="S4.E7.m1.4.4.1.1.3.2" xref="S4.E7.m1.4.4.1.1.3.2.cmml">τ</mi><mtext id="S4.E7.m1.4.4.1.1.3.3" xref="S4.E7.m1.4.4.1.1.3.3a.cmml">rel</mtext></msub></mrow><mo id="S4.E7.m1.5.5.2.3" rspace="1.167em" xref="S4.E7.m1.5.5.3a.cmml">,</mo><mrow id="S4.E7.m1.5.5.2.2" xref="S4.E7.m1.5.5.2.2.cmml"><mrow id="S4.E7.m1.5.5.2.2.2" xref="S4.E7.m1.5.5.2.2.2.cmml"><msub id="S4.E7.m1.5.5.2.2.2.2" xref="S4.E7.m1.5.5.2.2.2.2.cmml"><mi id="S4.E7.m1.5.5.2.2.2.2.2" xref="S4.E7.m1.5.5.2.2.2.2.2.cmml">s</mi><mi id="S4.E7.m1.5.5.2.2.2.2.3" xref="S4.E7.m1.5.5.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E7.m1.5.5.2.2.2.1" xref="S4.E7.m1.5.5.2.2.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.2.2.2.3.2" xref="S4.E7.m1.5.5.2.2.2.cmml"><mo id="S4.E7.m1.5.5.2.2.2.3.2.1" stretchy="false" xref="S4.E7.m1.5.5.2.2.2.cmml">(</mo><mi id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">𝐭</mi><mo id="S4.E7.m1.5.5.2.2.2.3.2.2" stretchy="false" xref="S4.E7.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.5.5.2.2.1" xref="S4.E7.m1.5.5.2.2.1.cmml">≤</mo><msub id="S4.E7.m1.5.5.2.2.3" xref="S4.E7.m1.5.5.2.2.3.cmml"><mi id="S4.E7.m1.5.5.2.2.3.2" xref="S4.E7.m1.5.5.2.2.3.2.cmml">τ</mi><mtext id="S4.E7.m1.5.5.2.2.3.3" xref="S4.E7.m1.5.5.2.2.3.3a.cmml">align</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.5b"><apply id="S4.E7.m1.5.5.3.cmml" xref="S4.E7.m1.5.5.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.3a.cmml" xref="S4.E7.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1.1"><geq id="S4.E7.m1.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1"></geq><apply id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2"><times id="S4.E7.m1.4.4.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.2.1"></times><apply id="S4.E7.m1.4.4.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.2.2.1.cmml" xref="S4.E7.m1.4.4.1.1.2.2">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.2.2.2">𝑅</ci><ci id="S4.E7.m1.4.4.1.1.2.2.3.cmml" xref="S4.E7.m1.4.4.1.1.2.2.3">𝑗</ci></apply><interval closure="open" id="S4.E7.m1.4.4.1.1.2.3.1.cmml" xref="S4.E7.m1.4.4.1.1.2.3.2"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝒙</ci><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝐭</ci></interval></apply><apply id="S4.E7.m1.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2">𝜏</ci><ci id="S4.E7.m1.4.4.1.1.3.3a.cmml" xref="S4.E7.m1.4.4.1.1.3.3"><mtext id="S4.E7.m1.4.4.1.1.3.3.cmml" mathsize="70%" xref="S4.E7.m1.4.4.1.1.3.3">rel</mtext></ci></apply></apply><apply id="S4.E7.m1.5.5.2.2.cmml" xref="S4.E7.m1.5.5.2.2"><leq id="S4.E7.m1.5.5.2.2.1.cmml" xref="S4.E7.m1.5.5.2.2.1"></leq><apply id="S4.E7.m1.5.5.2.2.2.cmml" xref="S4.E7.m1.5.5.2.2.2"><times id="S4.E7.m1.5.5.2.2.2.1.cmml" xref="S4.E7.m1.5.5.2.2.2.1"></times><apply id="S4.E7.m1.5.5.2.2.2.2.cmml" xref="S4.E7.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.2.2.2.2.1.cmml" xref="S4.E7.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.2.2.2.2.2.cmml" xref="S4.E7.m1.5.5.2.2.2.2.2">𝑠</ci><ci id="S4.E7.m1.5.5.2.2.2.2.3.cmml" xref="S4.E7.m1.5.5.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3">𝐭</ci></apply><apply id="S4.E7.m1.5.5.2.2.3.cmml" xref="S4.E7.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.2.2.3.1.cmml" xref="S4.E7.m1.5.5.2.2.3">subscript</csymbol><ci id="S4.E7.m1.5.5.2.2.3.2.cmml" xref="S4.E7.m1.5.5.2.2.3.2">𝜏</ci><ci id="S4.E7.m1.5.5.2.2.3.3a.cmml" xref="S4.E7.m1.5.5.2.2.3.3"><mtext id="S4.E7.m1.5.5.2.2.3.3.cmml" mathsize="70%" xref="S4.E7.m1.5.5.2.2.3.3">align</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.5c">R_{j}(\boldsymbol{x},\mathbf{t})\geq\tau_{\text{rel}},\quad s_{j}(\mathbf{t})%
\leq\tau_{\text{align}}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.5d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t ) ≥ italic_τ start_POSTSUBSCRIPT rel end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t ) ≤ italic_τ start_POSTSUBSCRIPT align end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.7">where <math alttext="\tau_{\text{rel}}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m1.1"><semantics id="S4.SS2.p2.5.m1.1a"><msub id="S4.SS2.p2.5.m1.1.1" xref="S4.SS2.p2.5.m1.1.1.cmml"><mi id="S4.SS2.p2.5.m1.1.1.2" xref="S4.SS2.p2.5.m1.1.1.2.cmml">τ</mi><mtext id="S4.SS2.p2.5.m1.1.1.3" xref="S4.SS2.p2.5.m1.1.1.3a.cmml">rel</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m1.1b"><apply id="S4.SS2.p2.5.m1.1.1.cmml" xref="S4.SS2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m1.1.1.1.cmml" xref="S4.SS2.p2.5.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m1.1.1.2.cmml" xref="S4.SS2.p2.5.m1.1.1.2">𝜏</ci><ci id="S4.SS2.p2.5.m1.1.1.3a.cmml" xref="S4.SS2.p2.5.m1.1.1.3"><mtext id="S4.SS2.p2.5.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p2.5.m1.1.1.3">rel</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m1.1c">\tau_{\text{rel}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m1.1d">italic_τ start_POSTSUBSCRIPT rel end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tau_{\text{align}}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m2.1"><semantics id="S4.SS2.p2.6.m2.1a"><msub id="S4.SS2.p2.6.m2.1.1" xref="S4.SS2.p2.6.m2.1.1.cmml"><mi id="S4.SS2.p2.6.m2.1.1.2" xref="S4.SS2.p2.6.m2.1.1.2.cmml">τ</mi><mtext id="S4.SS2.p2.6.m2.1.1.3" xref="S4.SS2.p2.6.m2.1.1.3a.cmml">align</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m2.1b"><apply id="S4.SS2.p2.6.m2.1.1.cmml" xref="S4.SS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m2.1.1.1.cmml" xref="S4.SS2.p2.6.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m2.1.1.2.cmml" xref="S4.SS2.p2.6.m2.1.1.2">𝜏</ci><ci id="S4.SS2.p2.6.m2.1.1.3a.cmml" xref="S4.SS2.p2.6.m2.1.1.3"><mtext id="S4.SS2.p2.6.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p2.6.m2.1.1.3">align</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m2.1c">\tau_{\text{align}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m2.1d">italic_τ start_POSTSUBSCRIPT align end_POSTSUBSCRIPT</annotation></semantics></math> are thresholds for relevance and alignment respectively.
Thresholding high relevance scores effectively filters out noisy or irrelevant components, isolating those that meaningfully contribute to predictions. These identified components often unveil novel and unexpected features. Alternatively, activations <math alttext="a_{j}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m3.1"><semantics id="S4.SS2.p2.7.m3.1a"><msub id="S4.SS2.p2.7.m3.1.1" xref="S4.SS2.p2.7.m3.1.1.cmml"><mi id="S4.SS2.p2.7.m3.1.1.2" xref="S4.SS2.p2.7.m3.1.1.2.cmml">a</mi><mi id="S4.SS2.p2.7.m3.1.1.3" xref="S4.SS2.p2.7.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m3.1b"><apply id="S4.SS2.p2.7.m3.1.1.cmml" xref="S4.SS2.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m3.1.1.1.cmml" xref="S4.SS2.p2.7.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m3.1.1.2.cmml" xref="S4.SS2.p2.7.m3.1.1.2">𝑎</ci><ci id="S4.SS2.p2.7.m3.1.1.3.cmml" xref="S4.SS2.p2.7.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m3.1c">a_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m3.1d">italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can serve as an output-agnostic proxy for relevance (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.E6" title="In 4.1 Instance-wise attribution of components ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.7.1">b) Failure cases: higher relevance than expected:</span>
We define an expected relevance distribution for each component based on a reference set (e.g., training images with known labels). For component <math alttext="j" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_j</annotation></semantics></math>, we collect relevance scores across this reference set, calculating the sample mean <math alttext="\mu_{j}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">μ</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝜇</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mu_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and standard deviation <math alttext="\hat{\sigma}_{j}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.2" xref="S4.SS2.p3.3.m3.1.1.2.2.cmml">σ</mi><mo id="S4.SS2.p3.3.m3.1.1.2.1" xref="S4.SS2.p3.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><apply id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2"><ci id="S4.SS2.p3.3.m3.1.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p3.3.m3.1.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.2">𝜎</ci></apply><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\hat{\sigma}_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Given a new input with embedding <math alttext="\boldsymbol{x}_{\text{test}}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><msub id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">𝒙</mi><mtext id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝒙</ci><ci id="S4.SS2.p3.4.m4.1.1.3a.cmml" xref="S4.SS2.p3.4.m4.1.1.3"><mtext id="S4.SS2.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.4.m4.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\boldsymbol{x}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">bold_italic_x start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math>, we compute its relevance <math alttext="R_{j}(\boldsymbol{x}_{\text{test}},\mathbf{t})" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.2"><semantics id="S4.SS2.p3.5.m5.2a"><mrow id="S4.SS2.p3.5.m5.2.2" xref="S4.SS2.p3.5.m5.2.2.cmml"><msub id="S4.SS2.p3.5.m5.2.2.3" xref="S4.SS2.p3.5.m5.2.2.3.cmml"><mi id="S4.SS2.p3.5.m5.2.2.3.2" xref="S4.SS2.p3.5.m5.2.2.3.2.cmml">R</mi><mi id="S4.SS2.p3.5.m5.2.2.3.3" xref="S4.SS2.p3.5.m5.2.2.3.3.cmml">j</mi></msub><mo id="S4.SS2.p3.5.m5.2.2.2" xref="S4.SS2.p3.5.m5.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.p3.5.m5.2.2.1.1" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml"><mo id="S4.SS2.p3.5.m5.2.2.1.1.2" stretchy="false" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">(</mo><msub id="S4.SS2.p3.5.m5.2.2.1.1.1" xref="S4.SS2.p3.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.5.m5.2.2.1.1.1.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.cmml">𝒙</mi><mtext id="S4.SS2.p3.5.m5.2.2.1.1.1.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.3a.cmml">test</mtext></msub><mo id="S4.SS2.p3.5.m5.2.2.1.1.3" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">,</mo><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">𝐭</mi><mo id="S4.SS2.p3.5.m5.2.2.1.1.4" stretchy="false" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.2b"><apply id="S4.SS2.p3.5.m5.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2"><times id="S4.SS2.p3.5.m5.2.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.2"></times><apply id="S4.SS2.p3.5.m5.2.2.3.cmml" xref="S4.SS2.p3.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.3.1.cmml" xref="S4.SS2.p3.5.m5.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.2.3.2.cmml" xref="S4.SS2.p3.5.m5.2.2.3.2">𝑅</ci><ci id="S4.SS2.p3.5.m5.2.2.3.3.cmml" xref="S4.SS2.p3.5.m5.2.2.3.3">𝑗</ci></apply><interval closure="open" id="S4.SS2.p3.5.m5.2.2.1.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1"><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2">𝒙</ci><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.3a.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.3"><mtext id="S4.SS2.p3.5.m5.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.5.m5.2.2.1.1.1.3">test</mtext></ci></apply><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.2c">R_{j}(\boldsymbol{x}_{\text{test}},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT test end_POSTSUBSCRIPT , bold_t )</annotation></semantics></math>, and derive the <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1"><semantics id="S4.SS2.p3.6.m6.1a"><mi id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><ci id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.1d">italic_z</annotation></semantics></math>-score to determine whether this value deviates significantly from the expected distribution. The <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.1d">italic_z</annotation></semantics></math>-score, which serves as a standard method to detect outliers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib23" title="">23</a>]</cite>, quantifies the deviation in terms of standard deviations from the mean:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z=\frac{R_{j}(\boldsymbol{x}_{\text{test}},\mathbf{t})-\mu_{j}}{\hat{\sigma}_{%
j}}." class="ltx_Math" display="block" id="S4.E8.m1.3"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml">z</mi><mo id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml"><mrow id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml"><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml"><msub id="S4.E8.m1.2.2.2.2.3" xref="S4.E8.m1.2.2.2.2.3.cmml"><mi id="S4.E8.m1.2.2.2.2.3.2" xref="S4.E8.m1.2.2.2.2.3.2.cmml">R</mi><mi id="S4.E8.m1.2.2.2.2.3.3" xref="S4.E8.m1.2.2.2.2.3.3.cmml">j</mi></msub><mo id="S4.E8.m1.2.2.2.2.2" xref="S4.E8.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.2.cmml"><mo id="S4.E8.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.2.cmml">(</mo><msub id="S4.E8.m1.2.2.2.2.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.2.cmml">𝒙</mi><mtext id="S4.E8.m1.2.2.2.2.1.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.1.3a.cmml">test</mtext></msub><mo id="S4.E8.m1.2.2.2.2.1.1.3" xref="S4.E8.m1.2.2.2.2.1.2.cmml">,</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">𝐭</mi><mo id="S4.E8.m1.2.2.2.2.1.1.4" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.2.2.2.3" xref="S4.E8.m1.2.2.2.3.cmml">−</mo><msub id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.4.cmml"><mi id="S4.E8.m1.2.2.2.4.2" xref="S4.E8.m1.2.2.2.4.2.cmml">μ</mi><mi id="S4.E8.m1.2.2.2.4.3" xref="S4.E8.m1.2.2.2.4.3.cmml">j</mi></msub></mrow><msub id="S4.E8.m1.2.2.4" xref="S4.E8.m1.2.2.4.cmml"><mover accent="true" id="S4.E8.m1.2.2.4.2" xref="S4.E8.m1.2.2.4.2.cmml"><mi id="S4.E8.m1.2.2.4.2.2" xref="S4.E8.m1.2.2.4.2.2.cmml">σ</mi><mo id="S4.E8.m1.2.2.4.2.1" xref="S4.E8.m1.2.2.4.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.2.2.4.3" xref="S4.E8.m1.2.2.4.3.cmml">j</mi></msub></mfrac></mrow><mo id="S4.E8.m1.3.3.1.2" lspace="0em" xref="S4.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1"><eq id="S4.E8.m1.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1"></eq><ci id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2">𝑧</ci><apply id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2"><divide id="S4.E8.m1.2.2.3.cmml" xref="S4.E8.m1.2.2"></divide><apply id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"><minus id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.3"></minus><apply id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2"><times id="S4.E8.m1.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.2"></times><apply id="S4.E8.m1.2.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.3.1.cmml" xref="S4.E8.m1.2.2.2.2.3">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.3.2.cmml" xref="S4.E8.m1.2.2.2.2.3.2">𝑅</ci><ci id="S4.E8.m1.2.2.2.2.3.3.cmml" xref="S4.E8.m1.2.2.2.2.3.3">𝑗</ci></apply><interval closure="open" id="S4.E8.m1.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1"><apply id="S4.E8.m1.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2">𝒙</ci><ci id="S4.E8.m1.2.2.2.2.1.1.1.3a.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.3"><mtext id="S4.E8.m1.2.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.E8.m1.2.2.2.2.1.1.1.3">test</mtext></ci></apply><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝐭</ci></interval></apply><apply id="S4.E8.m1.2.2.2.4.cmml" xref="S4.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.4.1.cmml" xref="S4.E8.m1.2.2.2.4">subscript</csymbol><ci id="S4.E8.m1.2.2.2.4.2.cmml" xref="S4.E8.m1.2.2.2.4.2">𝜇</ci><ci id="S4.E8.m1.2.2.2.4.3.cmml" xref="S4.E8.m1.2.2.2.4.3">𝑗</ci></apply></apply><apply id="S4.E8.m1.2.2.4.cmml" xref="S4.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.4.1.cmml" xref="S4.E8.m1.2.2.4">subscript</csymbol><apply id="S4.E8.m1.2.2.4.2.cmml" xref="S4.E8.m1.2.2.4.2"><ci id="S4.E8.m1.2.2.4.2.1.cmml" xref="S4.E8.m1.2.2.4.2.1">^</ci><ci id="S4.E8.m1.2.2.4.2.2.cmml" xref="S4.E8.m1.2.2.4.2.2">𝜎</ci></apply><ci id="S4.E8.m1.2.2.4.3.cmml" xref="S4.E8.m1.2.2.4.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">z=\frac{R_{j}(\boldsymbol{x}_{\text{test}},\mathbf{t})-\mu_{j}}{\hat{\sigma}_{%
j}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.3d">italic_z = divide start_ARG italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT test end_POSTSUBSCRIPT , bold_t ) - italic_μ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG over^ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.10">Components yielding a <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m1.1"><semantics id="S4.SS2.p3.8.m1.1a"><mi id="S4.SS2.p3.8.m1.1.1" xref="S4.SS2.p3.8.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m1.1b"><ci id="S4.SS2.p3.8.m1.1.1.cmml" xref="S4.SS2.p3.8.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m1.1d">italic_z</annotation></semantics></math>-score above <math alttext="3.0" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m2.1"><semantics id="S4.SS2.p3.9.m2.1a"><mn id="S4.SS2.p3.9.m2.1.1" xref="S4.SS2.p3.9.m2.1.1.cmml">3.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m2.1b"><cn id="S4.SS2.p3.9.m2.1.1.cmml" type="float" xref="S4.SS2.p3.9.m2.1.1">3.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m2.1c">3.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m2.1d">3.0</annotation></semantics></math> are commonly flagged as potential failure points, indicating that the model relies on them more than expected and should be inspected.
This approach assumes approximate normality of relevance scores, or sufficient <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m3.1"><semantics id="S4.SS2.p3.10.m3.1a"><mi id="S4.SS2.p3.10.m3.1.1" xref="S4.SS2.p3.10.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m3.1b"><ci id="S4.SS2.p3.10.m3.1.1.cmml" xref="S4.SS2.p3.10.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m3.1d">italic_n</annotation></semantics></math> for the Central Limit Theorem to hold.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="212" id="S4.F3.g1" src="x3.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Faithfulness evaluation of latent attributions on the ImageNet test set. We measure output scores while performing latent deletion (setting activations to zero) with instance-wise attributions (<em class="ltx_emph ltx_font_italic" id="S4.F3.4.1">left</em>) and average attributions on a subset (<em class="ltx_emph ltx_font_italic" id="S4.F3.5.2">middle</em>), and while performing latent insertion (<em class="ltx_emph ltx_font_italic" id="S4.F3.6.3">right</em>).</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.3">We design our experiments to answer the following key research questions:</p>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix1.1.1.1">Q1</span></span>
<div class="ltx_para" id="S5.I1.ix1.p1">
<p class="ltx_p" id="S5.I1.ix1.p1.1">How faithfully do attributions reflect a component’s actual influence on CLIP predictions?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix2.1.1.1">Q2</span></span>
<div class="ltx_para" id="S5.I1.ix2.p1">
<p class="ltx_p" id="S5.I1.ix2.p1.1">How effective are SAEs for extracting human-interpretable components in CLIP, and how many unexpected concepts exist?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix3.1.1.1">Q3</span></span>
<div class="ltx_para" id="S5.I1.ix3.p1">
<p class="ltx_p" id="S5.I1.ix3.p1.1">How robust is text-image probing in CLIP and what are typical failure cases?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix4.1.1.1">Q4</span></span>
<div class="ltx_para ltx_noindent" id="S5.I1.ix4.p1">
<p class="ltx_p" id="S5.I1.ix4.p1.1">Can we detect spurious behavior in a CLIP-based classifier trained for melanoma detection?</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S5.p1.2"><span class="ltx_text ltx_font_bold" id="S5.p1.2.1">Experimental settings:</span>
We train top-<math alttext="k" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_k</annotation></semantics></math> <span class="ltx_glossaryref" title="">SAEs</span> with <math alttext="k=64" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><mrow id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">k</mi><mo id="S5.p1.2.m2.1.1.1" xref="S5.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><eq id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1.1"></eq><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝑘</ci><cn id="S5.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">k=64</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">italic_k = 64</annotation></semantics></math> and 30,000 components on the class token embeddings of the last transformer block, using the ImageNet-1k <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib27" title="">27</a>]</cite> train set. Experiments cover publicly available <span class="ltx_glossaryref" title="">ViT</span> variants: B/32, B/16, L/14, and H/14 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib24" title="">24</a>]</cite>. To assess semantic alignment of SAE latents, we evaluate alignment against ImageNet-21k class names <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib41" title="">41</a>]</cite> using CLIP-Mobile-S2. For the medical domain, we apply our method to WhyLesion-CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib53" title="">53</a>]</cite> and train SAEs on ISIC skin lesion datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib9" title="">9</a>]</cite>. Additional implementation details are provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1" title="Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Evaluating attribution faithfulness (Q1)</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3">We assess whether component attribution scores reflect the true influence of individual latents on model predictions by performing deletion and insertion experiments. In the deletion setting, we ablate latents by setting their activations to zero, starting from the most relevant components. In the insertion setting, we begin with all latent activations ablated and sequentially reintroduce them in order of estimated relevance. We perform both local (instance-wise relevance) and global (mean relevance over a reference set) deletion experiments. All evaluations are conducted on the ImageNet test set for 100 classes, with 50 samples per class and prompting the CLIP <span class="ltx_glossaryref" title="">ViT</span>-L/14 model with the class name as text input. We compare six methods: our proposed Act<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mo id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><times id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">×</annotation></semantics></math>Grad score as in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E29" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">29</span></a>, the product of activation and Logit Lens score, Logit Lens alone, Energy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib48" title="">48</a>]</cite> (given as activation <math alttext="a_{j}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><msub id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">a</mi><mi id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">𝑎</ci><ci id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">a_{j}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> times the norm of <math alttext="\mathbf{v}_{j}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><msub id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">𝐯</mi><mi id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">𝐯</ci><ci id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\mathbf{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E1" title="In 3.1 Sparse autoencoders for extracting interpretable components ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>), Integrated Gradients <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib32" title="">32</a>]</cite>, and a random ordering of active latents.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.F3" title="In 4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>,  Act<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mo id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><times id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">×</annotation></semantics></math>Grad attributions consistently lead to the largest performance drop in deletion and the fastest recovery in insertion, indicating higher faithfulness. AUC scores with <span class="ltx_glossaryref" title="">Standard Error of the Mean (SEM)</span> across 9 subsets are reported in the legend. Activation times Logit Lens provides improvements over Logit Lens in deletion, but remains inferior to our method, especially in cases involving few interdependent latents.
Results on other CLIP models are provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2" title="Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Interpretability and diversity of SAE components (Q2)</h3>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="444" id="S5.F4.g1" src="x4.png" width="805"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Analysis of components extracted by SAEs in CLIP.
a) Most latent components have both low activation and low interpretability; activation strongly correlates with interpretability.
b) Compared to the inherent neural basis and PCA, SAEs yield a significantly more diverse and specific set of concepts. Larger CLIP models tend to encode a broader range of semantic concepts.
c) When probing components with expected labels, a large fraction show weak alignment (compared to alignment between ImageNet-1k class names and test set images). Unexpected concepts include game renderings, cliparts, and visually similar object pairs. More examples can be found in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3" title="Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">C</span></a>.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.2">We study the number, interpretability, and diversity of latent components extracted from CLIP models using <span class="ltx_glossaryref" title="">SAEs</span>. For the <span class="ltx_glossaryref" title="">ViT</span>-L/14 model, we obtain 17,455 components (filtered to those with <math alttext="\geq 20" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">≥</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><geq id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></geq><csymbol cd="latexml" id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\geq 20</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">≥ 20</annotation></semantics></math> non-zero activations for meaningful statistical analysis of interpretability) from an SAE trained on the final class token embeddings . To assess interpretability, we use the clarity metric introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib12" title="">12</a>]</cite>, which quantifies visual similarity among top-activating samples. As shown in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F4" title="In 5.2 Interpretability and diversity of SAE components (Q2) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>a, the majority of components exhibit unexpectedly low clarity.
Analyzing the relationship between interpretability and activation scores on the 20 highly activating samples, we observe a strong correlation of <math alttext="0.75" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mn id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">0.75</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><cn id="S5.SS2.p1.2.m2.1.1.cmml" type="float" xref="S5.SS2.p1.2.m2.1.1">0.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">0.75</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">0.75</annotation></semantics></math>, indicating that components with higher activations (which relate to relevance via <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E29" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">29</span></a>) tend to be more interpretable. Notably, activation frequency and activation magnitude show a smaller correlation with interpretability (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3" title="Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">C</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">To evaluate representational diversity, we compare the number of unique concepts identified across different bases: the inherent neural basis, PCA-transformed embeddings, and <span class="ltx_glossaryref" title="">SAE</span> feature space. <span class="ltx_glossaryref" title="">SAEs</span> yield a larger and more specific concept set (5,363 unique labels vs. less than <math alttext="500" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><cn id="S5.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">500</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">500</annotation></semantics></math> for PCA). Moreover, larger CLIP models capture broader concept sets, with ViT-H/14 showing over 20 % more unique concepts than ViT-B/16, indicating that model capacity contributes to conceptual diversity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Finally, probing latent components with ImageNet-21k class names using CLIP-Mobile-S2 for alignment scoring (filtered with <math alttext="\tau_{\text{act}}=3.0" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mrow id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><msub id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2.2" xref="S5.SS2.p3.1.m1.1.1.2.2.cmml">τ</mi><mtext id="S5.SS2.p3.1.m1.1.1.2.3" xref="S5.SS2.p3.1.m1.1.1.2.3a.cmml">act</mtext></msub><mo id="S5.SS2.p3.1.m1.1.1.1" xref="S5.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">3.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><eq id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1.1"></eq><apply id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.2.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.2">𝜏</ci><ci id="S5.SS2.p3.1.m1.1.1.2.3a.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3"><mtext id="S5.SS2.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S5.SS2.p3.1.m1.1.1.2.3">act</mtext></ci></apply><cn id="S5.SS2.p3.1.m1.1.1.3.cmml" type="float" xref="S5.SS2.p3.1.m1.1.1.3">3.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\tau_{\text{act}}=3.0</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_τ start_POSTSUBSCRIPT act end_POSTSUBSCRIPT = 3.0</annotation></semantics></math> as in method <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>a), we uncover a substantial fraction of components encoding semantically unexpected features. These include high-level visual abstractions such as “clipart”, “game rendering”, or “US states”, which are not part of the labeled class taxonomy (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F4" title="In 5.2 Interpretability and diversity of SAE components (Q2) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>c). This highlights the presence of latent knowledge in foundation models that extends beyond standard dataset annotations. Additional examples are provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3" title="Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Robustness of CLIP to semantic ambiguity and spurious correlations (Q3)</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="290" id="S5.F5.g1" src="x5.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Analysis of failure modes in text-image probing. We evaluate CLIP’s robustness to textual ambiguities and dataset artifacts across multiple model variants. Failure cases include polysemous words, compound nouns, typography in images, and spurious correlations. For each scenario, we assess the separability of true images from found distractors (“spurious AUC”) and from unrelated ImageNet classes (“valid AUC”).
We compare performance using both vanilla and enriched text prompts (e.g., via templating and detailed descriptions), and include linear classifiers trained on image embeddings as a baseline. Uncertainty estimates are provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4" title="Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">D</span></a>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We evaluate the robustness of CLIP models to semantic ambiguities and spurious correlations across multiple <span class="ltx_glossaryref" title="">ViT</span> variants. Following the approach introduced in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>b, we identify latent components that contribute to high-confidence predictions for a given ImageNet-1k class significantly more than expected.
To establish these expectations, we first estimate the class-conditional relevance distribution across the class samples in the training set. We then identify outlier components whose relevance on high-confidence non-class samples deviates significantly from this distribution. These components are flagged automatically, and their associated concepts are manually inspected.
This procedure reveals over 220 failure cases of four recurrent modes: polysemous prompts (e.g., “crane” as bird or machine), compound nouns (e.g., “Egyptian cat”), embedded typography in images, and spurious visual correlations.
All identified misaligned samples, where a flagged component fires strongly form the benchmark evaluation set, with examples for each failure mode provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4" title="Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">We quantify robustness using two metrics: the AUROC for distinguishing true class images from spurious distractors (“spurious AUC”), and from unrelated ImageNet classes (“valid AUC”). Spurious distractors include both automatically discovered cases and 50 known dataset-specific artifacts from <cite class="ltx_cite ltx_citemacro_citet">Neuhaus et al. [<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib35" title="">35</a>]</cite>. Results are shown in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F5" title="In 5.3 Robustness of CLIP to semantic ambiguity and spurious correlations (Q3) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>.
We compare several probing strategies: (i) text-based probing using short class labels, (ii) enriched prompts via templating and detailed descriptions, and (iii) linear classifiers trained directly on visual embeddings. While CLIP exhibits greater robustness to spurious correlations compared to linear classifiers, it performs significantly worse in the presence of semantic ambiguity and typographic artifacts. Larger CLIP variants consistently show improved performance across both valid and spurious AUC.
Prompt enrichment improves robustness, particularly for typographic distractors, though gains vary across failure types. Notably, template-based prompting (e.g., “an image of…”) is effective against visual typography but less so for resolving polysemy.
Detailed results and uncertainty estimates are provided in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4" title="Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Case study: spurious correlation analysis in melanoma detection (Q4)</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Robustness and safety are particularly critical in medical applications. Recent works have introduced CLIP-based models for skin lesion classification, including melanoma detection from dermoscopic images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib53" title="">53</a>]</cite>. While foundation models like CLIP offer rich feature representations, they may also encode complex spurious correlations that compromise reliability when used as feature extractors.</p>
</div>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="230" id="S5.F6.g1" src="x6.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Melanoma detection case study.
a) Among the most relevant SAE components for the non-melanoma class, we identify a component encoding a “red hue” background artifact that strongly influences predictions when training a linear classifier on image embeddings. Training a more robust classifier on semantically augmented embeddings reduces this reliance.
b) When systematically adding or removing red coloration from input images, the robust classifier maintains more stable accuracies on both melanoma and non-melanoma samples, demonstrating improved resilience to spurious correlations.
Error bars correspond to the <span class="ltx_glossaryref" title="">SEM</span>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">We apply our interpretability framework to WhyLesion-CLIP by training a linear classifier on image embeddings to differentiate melanoma from non-melanoma samples on the ISIC 2019 dataset. As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F6" title="In 5.4 Case study: spurious correlation analysis in melanoma detection (Q4) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, two of the most influential SAE components encode red or pink hue background artifacts, contributing a mean relevance of 4.9 % and 2.8 % to the model’s output, respectively. When red coloration is artificially manipulated in images, classification performance on the test set shifts significantly: melanoma accuracy drops from 80.5 % to 59.9 %, while non-melanoma accuracy increases from 68.1 % to 82.8 %, confirming reliance on the red hue as a spurious cue for non-melanoma predictions. Notably, all <span class="ltx_glossaryref" title="">SEMs</span> for accuracy scores depicted in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F6" title="In 5.4 Case study: spurious correlation analysis in melanoma detection (Q4) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a> are below 2.4 %.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.5">To mitigate this shortcut, we train a robust linear classifier on semantically augmented embeddings <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S5.SS4.p3.1.m1.1"><semantics id="S5.SS4.p3.1.m1.1a"><mi id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><ci id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.1.m1.1d">bold_italic_x</annotation></semantics></math> by adding random signals along the latent direction associated with the red hue component <math alttext="\#2703" class="ltx_Math" display="inline" id="S5.SS4.p3.2.m2.1"><semantics id="S5.SS4.p3.2.m2.1a"><mrow id="S5.SS4.p3.2.m2.1.1" xref="S5.SS4.p3.2.m2.1.1.cmml"><mi id="S5.SS4.p3.2.m2.1.1.2" mathvariant="normal" xref="S5.SS4.p3.2.m2.1.1.2.cmml">#</mi><mo id="S5.SS4.p3.2.m2.1.1.1" xref="S5.SS4.p3.2.m2.1.1.1.cmml">⁢</mo><mn id="S5.SS4.p3.2.m2.1.1.3" xref="S5.SS4.p3.2.m2.1.1.3.cmml">2703</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.2.m2.1b"><apply id="S5.SS4.p3.2.m2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1"><times id="S5.SS4.p3.2.m2.1.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1.1"></times><ci id="S5.SS4.p3.2.m2.1.1.2.cmml" xref="S5.SS4.p3.2.m2.1.1.2">#</ci><cn id="S5.SS4.p3.2.m2.1.1.3.cmml" type="integer" xref="S5.SS4.p3.2.m2.1.1.3">2703</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.2.m2.1c">\#2703</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.2.m2.1d"># 2703</annotation></semantics></math>. Specifically, we estimate the latent feature direction between strongly and weakly activating samples, following the procedure from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib38" title="">38</a>]</cite> (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5" title="Appendix E Medical case study: melanoma detection ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">E</span></a> for details). This augmentation significantly improves robustness: melanoma accuracy now degrades by <math alttext="(5.1\pm 2.0)" class="ltx_Math" display="inline" id="S5.SS4.p3.3.m3.1"><semantics id="S5.SS4.p3.3.m3.1a"><mrow id="S5.SS4.p3.3.m3.1.1.1" xref="S5.SS4.p3.3.m3.1.1.1.1.cmml"><mo id="S5.SS4.p3.3.m3.1.1.1.2" stretchy="false" xref="S5.SS4.p3.3.m3.1.1.1.1.cmml">(</mo><mrow id="S5.SS4.p3.3.m3.1.1.1.1" xref="S5.SS4.p3.3.m3.1.1.1.1.cmml"><mn id="S5.SS4.p3.3.m3.1.1.1.1.2" xref="S5.SS4.p3.3.m3.1.1.1.1.2.cmml">5.1</mn><mo id="S5.SS4.p3.3.m3.1.1.1.1.1" xref="S5.SS4.p3.3.m3.1.1.1.1.1.cmml">±</mo><mn id="S5.SS4.p3.3.m3.1.1.1.1.3" xref="S5.SS4.p3.3.m3.1.1.1.1.3.cmml">2.0</mn></mrow><mo id="S5.SS4.p3.3.m3.1.1.1.3" stretchy="false" xref="S5.SS4.p3.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.3.m3.1b"><apply id="S5.SS4.p3.3.m3.1.1.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1.1"><csymbol cd="latexml" id="S5.SS4.p3.3.m3.1.1.1.1.1.cmml" xref="S5.SS4.p3.3.m3.1.1.1.1.1">plus-or-minus</csymbol><cn id="S5.SS4.p3.3.m3.1.1.1.1.2.cmml" type="float" xref="S5.SS4.p3.3.m3.1.1.1.1.2">5.1</cn><cn id="S5.SS4.p3.3.m3.1.1.1.1.3.cmml" type="float" xref="S5.SS4.p3.3.m3.1.1.1.1.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.3.m3.1c">(5.1\pm 2.0)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.3.m3.1d">( 5.1 ± 2.0 )</annotation></semantics></math> % under red hue increase, compared to <math alttext="(20.6\pm 2.1)" class="ltx_Math" display="inline" id="S5.SS4.p3.4.m4.1"><semantics id="S5.SS4.p3.4.m4.1a"><mrow id="S5.SS4.p3.4.m4.1.1.1" xref="S5.SS4.p3.4.m4.1.1.1.1.cmml"><mo id="S5.SS4.p3.4.m4.1.1.1.2" stretchy="false" xref="S5.SS4.p3.4.m4.1.1.1.1.cmml">(</mo><mrow id="S5.SS4.p3.4.m4.1.1.1.1" xref="S5.SS4.p3.4.m4.1.1.1.1.cmml"><mn id="S5.SS4.p3.4.m4.1.1.1.1.2" xref="S5.SS4.p3.4.m4.1.1.1.1.2.cmml">20.6</mn><mo id="S5.SS4.p3.4.m4.1.1.1.1.1" xref="S5.SS4.p3.4.m4.1.1.1.1.1.cmml">±</mo><mn id="S5.SS4.p3.4.m4.1.1.1.1.3" xref="S5.SS4.p3.4.m4.1.1.1.1.3.cmml">2.1</mn></mrow><mo id="S5.SS4.p3.4.m4.1.1.1.3" stretchy="false" xref="S5.SS4.p3.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.4.m4.1b"><apply id="S5.SS4.p3.4.m4.1.1.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1.1"><csymbol cd="latexml" id="S5.SS4.p3.4.m4.1.1.1.1.1.cmml" xref="S5.SS4.p3.4.m4.1.1.1.1.1">plus-or-minus</csymbol><cn id="S5.SS4.p3.4.m4.1.1.1.1.2.cmml" type="float" xref="S5.SS4.p3.4.m4.1.1.1.1.2">20.6</cn><cn id="S5.SS4.p3.4.m4.1.1.1.1.3.cmml" type="float" xref="S5.SS4.p3.4.m4.1.1.1.1.3">2.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.4.m4.1c">(20.6\pm 2.1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.4.m4.1d">( 20.6 ± 2.1 )</annotation></semantics></math> % without.
Both color-encoding components become less relevant, with <math alttext="\#2703" class="ltx_Math" display="inline" id="S5.SS4.p3.5.m5.1"><semantics id="S5.SS4.p3.5.m5.1a"><mrow id="S5.SS4.p3.5.m5.1.1" xref="S5.SS4.p3.5.m5.1.1.cmml"><mi id="S5.SS4.p3.5.m5.1.1.2" mathvariant="normal" xref="S5.SS4.p3.5.m5.1.1.2.cmml">#</mi><mo id="S5.SS4.p3.5.m5.1.1.1" xref="S5.SS4.p3.5.m5.1.1.1.cmml">⁢</mo><mn id="S5.SS4.p3.5.m5.1.1.3" xref="S5.SS4.p3.5.m5.1.1.3.cmml">2703</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.5.m5.1b"><apply id="S5.SS4.p3.5.m5.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1"><times id="S5.SS4.p3.5.m5.1.1.1.cmml" xref="S5.SS4.p3.5.m5.1.1.1"></times><ci id="S5.SS4.p3.5.m5.1.1.2.cmml" xref="S5.SS4.p3.5.m5.1.1.2">#</ci><cn id="S5.SS4.p3.5.m5.1.1.3.cmml" type="integer" xref="S5.SS4.p3.5.m5.1.1.3">2703</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.5.m5.1c">\#2703</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.5.m5.1d"># 2703</annotation></semantics></math> now indicating melanoma instead, which is valid if corresponding specifically to the lesion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We present the first holistic framework for instance-wise attribution of sparse, interpretable components in CLIP models, enabling a dual perspective on model behavior: understanding <em class="ltx_emph ltx_font_italic" id="S6.p1.1.1">what</em> concepts are encoded, and also <em class="ltx_emph ltx_font_italic" id="S6.p1.1.2">how</em> they influence predictions.
By combining attributions with alignment to expected semantics, our method automatically identifies reliance on both spurious features (e.g., red backgrounds in melanoma detection) and surprising concepts (e.g. twin-like objects), potentially corresponding to novel patterns in the data. Applied across multiple CLIP variants and a real-world medical use case, we highlight persistent failure modes, including polysemous prompts, compound nouns, visual typography, and spurious correlations.
A key advantage of including latent attributions is their simplicity: based on activation and output gradient, it is easy to implement, scale, and adopt.
Our findings emphasize the importance of mechanistic interpretability methods that move beyond global summaries to support the reliable and safe deployment of multimodal foundation models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Limitations:</span>
Throughout our experiments, we focus on class token embeddings from the final transformer block, which are most predictive, but may miss relevant dynamics in earlier layers. While we use <span class="ltx_glossaryref" title="">SAEs</span> for extracting interpretable components, alternative sparse dictionary learning methods could be applied; however, challenges like polysemanticity or hidden latent concepts may remain. Lastly, our semantic alignment relies on CLIP-Mobile-S2, which may itself be affected by spurious correlations or ambiguous language.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p3">
<p class="ltx_p" id="S6.p3.1"><span class="ltx_text ltx_font_bold" id="S6.p3.1.1">Acknowledgements:</span>
This work was supported by
the Federal Ministry of Education and Research (BMBF) as grant BIFOLD (01IS18025A, 01IS180371I);
the European Union’s Horizon Europe research and innovation programme (EU Horizon Europe) as grants [ACHILLES (101189689), TEMA (101093003)];
and the German Research Foundation (DFG) as research unit DeSBi [KI-FOR 5363] (459422098).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achtibat et al. [2023]</span>
<span class="ltx_bibblock">
R. Achtibat, M. Dreyer, I. Eisenbraun, S. Bosse, T. Wiegand, W. Samek, and S. Lapuschkin.

</span>
<span class="ltx_bibblock">From attribution maps to human-understandable explanations through concept relevance propagation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Nature Machine Intelligence</em>, 5(9):1006–1019, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahn et al. [2024]</span>
<span class="ltx_bibblock">
Y. H. Ahn, H. B. Kim, and S. T. Kim.

</span>
<span class="ltx_bibblock">Www: a unified framework for explaining what where and why of neural networks by interpretation of neuron concepts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 10968–10977, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bach et al. [2015]</span>
<span class="ltx_bibblock">
S. Bach, A. Binder, G. Montavon, F. Klauschen, K.-R. Müller, and W. Samek.

</span>
<span class="ltx_bibblock">On pixel-wise explanations for non-linear classifier decisions by layer-wise relevance propagation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">PloS one</em>, 10(7):e0130140, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Belrose et al. [2023]</span>
<span class="ltx_bibblock">
N. Belrose, Z. Furman, L. Smith, D. Halawi, I. Ostrovsky, L. McKinney, S. Biderman, and J. Steinhardt.

</span>
<span class="ltx_bibblock">Eliciting latent predictions from transformers with the tuned lens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2303.08112</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhalla et al. [2024]</span>
<span class="ltx_bibblock">
U. Bhalla, A. Oesterling, S. Srinivas, F. Calmon, and H. Lakkaraju.

</span>
<span class="ltx_bibblock">Interpreting CLIP with sparse linear concept embeddings (spliCE).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">The Thirty-eighth Annual Conference on Neural Information Processing Systems</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=7UyBKTFrtd" title="">https://openreview.net/forum?id=7UyBKTFrtd</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bloom and Lin [2024]</span>
<span class="ltx_bibblock">
J. Bloom and J. Lin.

</span>
<span class="ltx_bibblock">Understanding sae features with the logit lens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">AI Alignment Forum</em>, pages 24–25, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bricken et al. [2023]</span>
<span class="ltx_bibblock">
T. Bricken, A. Templeton, J. Batson, B. Chen, A. Jermyn, T. Conerly, N. Turner, C. Anil, C. Denison, A. Askell, et al.

</span>
<span class="ltx_bibblock">Towards monosemanticity: Decomposing language models with dictionary learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Transformer Circuits Thread</em>, 2, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Codella et al. [2018]</span>
<span class="ltx_bibblock">
N. C. Codella, D. Gutman, M. E. Celebi, B. Helba, M. A. Marchetti, S. W. Dusza, A. Kalloo, K. Liopyris, N. Mishra, H. Kittler, et al.

</span>
<span class="ltx_bibblock">Skin lesion analysis toward melanoma detection: A challenge at the 2017 international symposium on biomedical imaging (isbi), hosted by the international skin imaging collaboration (isic).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">2018 IEEE 15th international symposium on biomedical imaging (ISBI 2018)</em>, pages 168–172. IEEE, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collaboration et al. [2024]</span>
<span class="ltx_bibblock">
I. S. I. Collaboration et al.

</span>
<span class="ltx_bibblock">Slice-3d 2024 challenge dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International Skin Imaging Collaboration</em>, 10, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dorszewski et al. [2025]</span>
<span class="ltx_bibblock">
T. Dorszewski, L. Tětková, R. Jenssen, L. K. Hansen, and K. K. Wickstrøm.

</span>
<span class="ltx_bibblock">From colors to classes: Emergence of concepts in vision transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2503.24071</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dreyer et al. [2024]</span>
<span class="ltx_bibblock">
M. Dreyer, R. Achtibat, W. Samek, and S. Lapuschkin.

</span>
<span class="ltx_bibblock">Understanding the (extra-) ordinary: Validating deep model decisions with prototypical concept-based explanations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops</em>, pages 3491–3501, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dreyer et al. [2025]</span>
<span class="ltx_bibblock">
M. Dreyer, J. Berend, T. Labarta, J. Vielhaben, T. Wiegand, S. Lapuschkin, and W. Samek.

</span>
<span class="ltx_bibblock">Mechanistic understanding and validation of large ai models with semanticlens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2501.05398</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elhage et al. [2022]</span>
<span class="ltx_bibblock">
N. Elhage, T. Hume, C. Olsson, N. Schiefer, T. Henighan, S. Kravec, Z. Hatfield-Dodds, R. Lasenby, D. Drain, C. Chen, et al.

</span>
<span class="ltx_bibblock">Toy models of superposition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2209.10652</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. [2024]</span>
<span class="ltx_bibblock">
A. Fang, A. M. Jose, A. Jain, L. Schmidt, A. T. Toshev, and V. Shankar.

</span>
<span class="ltx_bibblock">Data filtering networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=KAk6ngZ09F" title="">https://openreview.net/forum?id=KAk6ngZ09F</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fel et al. [2023a]</span>
<span class="ltx_bibblock">
T. Fel, V. Boutin, L. Béthune, R. Cadène, M. Moayeri, L. Andéol, M. Chalvidal, and T. Serre.

</span>
<span class="ltx_bibblock">A holistic approach to unifying automatic concept extraction and concept importance estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 36:54805–54818, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fel et al. [2023b]</span>
<span class="ltx_bibblock">
T. Fel, A. Picard, L. Bethune, T. Boissin, D. Vigouroux, J. Colin, R. Cadène, and T. Serre.

</span>
<span class="ltx_bibblock">Craft: Concept recursive activation factorization for explainability.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 2711–2721, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gadre et al. [2023]</span>
<span class="ltx_bibblock">
S. Y. Gadre, G. Ilharco, A. Fang, J. Hayase, G. Smyrnis, T. Nguyen, R. Marten, M. Wortsman, D. Ghosh, J. Zhang, et al.

</span>
<span class="ltx_bibblock">Datacomp: In search of the next generation of multimodal datasets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</em>, 36:27092–27112, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gandelsman et al. [2024]</span>
<span class="ltx_bibblock">
Y. Gandelsman, A. A. Efros, and J. Steinhardt.

</span>
<span class="ltx_bibblock">Interpreting CLIP’s image representation via text-based decomposition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=5Ca9sSzuDp" title="">https://openreview.net/forum?id=5Ca9sSzuDp</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gandelsman et al. [2025]</span>
<span class="ltx_bibblock">
Y. Gandelsman, A. A. Efros, and J. Steinhardt.

</span>
<span class="ltx_bibblock">Interpreting the second-order effects of neurons in CLIP.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=GPDcvoFGOL" title="">https://openreview.net/forum?id=GPDcvoFGOL</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. [2025]</span>
<span class="ltx_bibblock">
L. Gao, T. D. la Tour, H. Tillman, G. Goh, R. Troll, A. Radford, I. Sutskever, J. Leike, and J. Wu.

</span>
<span class="ltx_bibblock">Scaling and evaluating sparse autoencoders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=tcsZt9ZNKD" title="">https://openreview.net/forum?id=tcsZt9ZNKD</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernández-Pérez et al. [2024]</span>
<span class="ltx_bibblock">
C. Hernández-Pérez, M. Combalia, S. Podlipnik, N. C. Codella, V. Rotemberg, A. C. Halpern, O. Reiter, C. Carrera, A. Barreiro, B. Helba, et al.

</span>
<span class="ltx_bibblock">Bcn20000: Dermoscopic lesions in the wild.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Scientific data</em>, 11(1):641, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huben et al. [2024]</span>
<span class="ltx_bibblock">
R. Huben, H. Cunningham, L. R. Smith, A. Ewart, and L. Sharkey.

</span>
<span class="ltx_bibblock">Sparse autoencoders find highly interpretable features in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=F76bwRSLeK" title="">https://openreview.net/forum?id=F76bwRSLeK</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Iglewicz and Hoaglin [1993]</span>
<span class="ltx_bibblock">
B. Iglewicz and D. C. Hoaglin.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Volume 16: how to detect and handle outliers</em>.

</span>
<span class="ltx_bibblock">Quality Press, 1993.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ilharco et al. [2021]</span>
<span class="ltx_bibblock">
G. Ilharco, M. Wortsman, R. Wightman, C. Gordon, N. Carlini, R. Taori, A. Dave, V. Shankar, H. Namkoong, J. Miller, H. Hajishirzi, A. Farhadi, and L. Schmidt.

</span>
<span class="ltx_bibblock">Openclip, July 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.5281/zenodo.5143773" title="">https://doi.org/10.5281/zenodo.5143773</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joseph et al. [2025]</span>
<span class="ltx_bibblock">
S. Joseph, P. Suresh, E. Goldfarb, L. Hufe, Y. Gandelsman, R. Graham, D. Bzdok, W. Samek, and B. A. Richards.

</span>
<span class="ltx_bibblock">Steering clip’s vision transformer with sparse autoencoders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Mechanistic Interpretability for Vision at CVPR 2025 (Non-proceedings Track)</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2024]</span>
<span class="ltx_bibblock">
C. Kim, S. U. Gadgil, A. J. DeGrave, J. A. Omiye, Z. R. Cai, R. Daneshjou, and S.-I. Lee.

</span>
<span class="ltx_bibblock">Transparent medical image ai via an image–text foundation model grounded in medical literature.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Nature Medicine</em>, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1038/s41591-024-02887-x</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41591-024-02887-x" title="">https://doi.org/10.1038/s41591-024-02887-x</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. [2012]</span>
<span class="ltx_bibblock">
A. Krizhevsky, I. Sutskever, and G. E. Hinton.

</span>
<span class="ltx_bibblock">Imagenet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in neural information processing systems</em>, 25, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. [2024]</span>
<span class="ltx_bibblock">
S. Kumar, S. Ghosh, S. Sakshi, U. Tyagi, and D. Manocha.

</span>
<span class="ltx_bibblock">Do vision-language models understand compound nouns?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2024 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (Volume 2: Short Papers)</em>, pages 519–527, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
J. Li, D. Li, S. Savarese, and S. Hoi.

</span>
<span class="ltx_bibblock">Blip-2: Bootstrapping language-image pre-training with frozen image encoders and large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International conference on machine learning</em>, pages 19730–19742. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim et al. [2025]</span>
<span class="ltx_bibblock">
H. Lim, J. Choi, J. Choo, and S. Schneider.

</span>
<span class="ltx_bibblock">Sparse autoencoders reveal selective remapping of visual concepts during adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=imT03YXlG2" title="">https://openreview.net/forum?id=imT03YXlG2</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter [2019]</span>
<span class="ltx_bibblock">
I. Loshchilov and F. Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marks et al. [2025]</span>
<span class="ltx_bibblock">
S. Marks, C. Rager, E. J. Michaud, Y. Belinkov, D. Bau, and A. Mueller.

</span>
<span class="ltx_bibblock">Sparse feature circuits: Discovering and editing interpretable causal graphs in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=I4e82CIDxv" title="">https://openreview.net/forum?id=I4e82CIDxv</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muinonen-Martin et al. [2018]</span>
<span class="ltx_bibblock">
A. J. Muinonen-Martin, S. J. O’Shea, and J. Newton-Bishop.

</span>
<span class="ltx_bibblock">Amelanotic melanoma.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">BMJ (Clinical research ed.)</em>, 360:k826, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda [2023]</span>
<span class="ltx_bibblock">
N. Nanda.

</span>
<span class="ltx_bibblock">Attribution patching: Activation patching at industrial scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">URL: https://www. neelnanda. io/mechanistic-interpretability/attribution-patching</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Neuhaus et al. [2023]</span>
<span class="ltx_bibblock">
Y. Neuhaus, M. Augustin, V. Boreiko, and M. Hein.

</span>
<span class="ltx_bibblock">Spurious features everywhere-large-scale detection of harmful spurious features in imagenet.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pages 20235–20246, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olshausen and Field [1997]</span>
<span class="ltx_bibblock">
B. A. Olshausen and D. J. Field.

</span>
<span class="ltx_bibblock">Sparse coding with an overcomplete basis set: A strategy employed by v1?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Vision research</em>, 37(23):3311–3325, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pach et al. [2025]</span>
<span class="ltx_bibblock">
M. Pach, S. Karthik, Q. Bouniot, S. Belongie, and Z. Akata.

</span>
<span class="ltx_bibblock">Sparse autoencoders learn monosemantic features in vision-language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2504.02821</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pahde et al. [2025]</span>
<span class="ltx_bibblock">
F. Pahde, M. Dreyer, M. Weckbecker, L. Weber, C. J. Anders, T. Wiegand, W. Samek, and S. Lapuschkin.

</span>
<span class="ltx_bibblock">Navigating neural space: Revisiting concept activation vectors to overcome directional divergence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Q95MaWfF4e" title="">https://openreview.net/forum?id=Q95MaWfF4e</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. [2021]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International conference on machine learning</em>, pages 8748–8763. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rao et al. [2024]</span>
<span class="ltx_bibblock">
S. Rao, S. Mahajan, M. Böhle, and B. Schiele.

</span>
<span class="ltx_bibblock">Discover-then-name: Task-agnostic concept bottlenecks via automated concept discovery.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">European Conference on Computer Vision</em>, pages 444–461. Springer, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ridnik et al. [2021]</span>
<span class="ltx_bibblock">
T. Ridnik, E. Ben-Baruch, A. Noy, and L. Zelnik-Manor.

</span>
<span class="ltx_bibblock">Imagenet-21k pretraining for the masses.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Thirty-fifth Conference on Neural Information Processing Systems Datasets and Benchmarks Track (Round 1)</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Zkj_VcZ6ol" title="">https://openreview.net/forum?id=Zkj_VcZ6ol</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rotemberg et al. [2021]</span>
<span class="ltx_bibblock">
V. Rotemberg, N. Kurtansky, B. Betz-Stablein, L. Caffery, E. Chousakos, N. Codella, M. Combalia, S. Dusza, P. Guitera, D. Gutman, et al.

</span>
<span class="ltx_bibblock">A patient-centric dataset of images and metadata for identifying melanomas using clinical context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Scientific data</em>, 8(1):34, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuhmann et al. [2021]</span>
<span class="ltx_bibblock">
C. Schuhmann, R. Vencu, R. Beaumont, R. Kaczmarczyk, C. Mullis, A. Katta, T. Coombes, J. Jitsev, and A. Komatsuzaki.

</span>
<span class="ltx_bibblock">Laion-400m: Open dataset of clip-filtered 400 million image-text pairs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2111.02114</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuhmann et al. [2022]</span>
<span class="ltx_bibblock">
C. Schuhmann, R. Beaumont, R. Vencu, C. Gordon, R. Wightman, M. Cherti, T. Coombes, A. Katta, C. Mullis, M. Wortsman, et al.

</span>
<span class="ltx_bibblock">Laion-5b: An open large-scale dataset for training next generation image-text models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Advances in neural information processing systems</em>, 35:25278–25294, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Selvaraju et al. [2017]</span>
<span class="ltx_bibblock">
R. R. Selvaraju, M. Cogswell, A. Das, R. Vedantam, D. Parikh, and D. Batra.

</span>
<span class="ltx_bibblock">Grad-cam: Visual explanations from deep networks via gradient-based localization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the IEEE international conference on computer vision</em>, pages 618–626, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shrikumar et al. [2017]</span>
<span class="ltx_bibblock">
A. Shrikumar, P. Greenside, and A. Kundaje.

</span>
<span class="ltx_bibblock">Learning important features through propagating activation differences.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International conference on machine learning</em>, pages 3145–3153. PMlR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Syed et al. [2024]</span>
<span class="ltx_bibblock">
A. Syed, C. Rager, and A. Conmy.

</span>
<span class="ltx_bibblock">Attribution patching outperforms automated circuit discovery.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of the 7th BlackboxNLP Workshop: Analyzing and Interpreting Neural Networks for NLP</em>, pages 407–416, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thasarathan et al. [2025]</span>
<span class="ltx_bibblock">
H. Thasarathan, J. Forsyth, T. Fel, M. Kowal, and K. Derpanis.

</span>
<span class="ltx_bibblock">Universal sparse autoencoders: Interpretable cross-model concept alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2502.03714</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tschandl et al. [2018]</span>
<span class="ltx_bibblock">
P. Tschandl, C. Rosendahl, and H. Kittler.

</span>
<span class="ltx_bibblock">The ham10000 dataset, a large collection of multi-source dermatoscopic images of common pigmented skin lesions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Scientific data</em>, 5(1):1–9, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vasu et al. [2024]</span>
<span class="ltx_bibblock">
P. K. A. Vasu, H. Pouransari, F. Faghri, R. Vemulapalli, and O. Tuzel.

</span>
<span class="ltx_bibblock">Mobileclip: Fast image-text models through multi-modal reinforced training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pages 15963–15974, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vig et al. [2020]</span>
<span class="ltx_bibblock">
J. Vig, S. Gehrmann, Y. Belinkov, S. Qian, D. Nevo, Y. Singer, and S. Shieber.

</span>
<span class="ltx_bibblock">Investigating gender bias in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Advances in neural information processing systems</em>, 33:12388–12401, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2024]</span>
<span class="ltx_bibblock">
Q. Wang, Y. Lin, Y. Chen, L. Schmidt, B. Han, and T. Zhang.

</span>
<span class="ltx_bibblock">A sober look at the robustness of CLIPs to spurious features.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">The Thirty-eighth Annual Conference on Neural Information Processing Systems</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=wWyumwEYV8" title="">https://openreview.net/forum?id=wWyumwEYV8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2024]</span>
<span class="ltx_bibblock">
Y. Yang, M. Gandhi, Y. Wang, Y. Wu, M. S. Yao, C. Callison-Burch, J. Gee, and M. Yatskar.

</span>
<span class="ltx_bibblock">A textbook remedy for domain shifts: Knowledge priors for medical image analysis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">The Thirty-eighth Annual Conference on Neural Information Processing Systems</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=STrpbhrvt3" title="">https://openreview.net/forum?id=STrpbhrvt3</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yun et al. [2023]</span>
<span class="ltx_bibblock">
T. Yun, U. Bhalla, E. Pavlick, and C. Sun.

</span>
<span class="ltx_bibblock">Do vision-language pretrained models learn composable primitive concepts?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Transactions on Machine Learning Research</em>, 2023.

</span>
<span class="ltx_bibblock">ISSN 2835-8856.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=YwNrPLjHSL" title="">https://openreview.net/forum?id=YwNrPLjHSL</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2024]</span>
<span class="ltx_bibblock">
D. Zhu, J. Chen, X. Shen, X. Li, and M. Elhoseiny.

</span>
<span class="ltx_bibblock">MiniGPT-4: Enhancing vision-language understanding with advanced large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=1tZbq88f27" title="">https://openreview.net/forum?id=1tZbq88f27</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
<div class="ltx_para ltx_noindent" id="Ax1.p1">
<p class="ltx_p" id="Ax1.p1.1">The appendix provides more methodological and experimental details for the main manuscript, begging with details on the experimental settings in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A1" title="Appendix A Experimental settings ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">A</span></a>, followed by additional descriptions and results on attribution faithfulness evaluations in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2" title="Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">B</span></a>, interpretability and diversity analysis of <span class="ltx_glossaryref" title="">SAE</span> components in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3" title="Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">C</span></a>, CLIP robustness evaluations in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4" title="Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">D</span></a>, and the medical case study in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5" title="Appendix E Medical case study: melanoma detection ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">App.</span> <span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental settings</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">This section provides more details on models, datasets, SAE training configurations, and computational resources for our experiments.</p>
</div>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Models</h4>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px1.p1.1">We evaluate several CLIP variants: ViT-B/32 trained on LAION-400M <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib43" title="">43</a>]</cite>, LAION-2B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib44" title="">44</a>]</cite>, and DataComp-(M, XL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib17" title="">17</a>]</cite>; ViT-B/16 and ViT-L/14 on DataComp-XL; and ViT-H/14 trained on DFN-5B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib14" title="">14</a>]</cite>. For semantic alignment scores (<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>), we use Mobile-CLIP-S2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib50" title="">50</a>]</cite>. For the medical setting, we evaluate on WhyLesion-CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib53" title="">53</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px2.p1.1">We use ImageNet-1k <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib27" title="">27</a>]</cite> for experiments in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sections</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS2" title="5.2 Interpretability and diversity of SAE components (Q2) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">5.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS3" title="5.3 Robustness of CLIP to semantic ambiguity and spurious correlations (Q3) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">5.3</span></a>.
Semantic alignment scores (<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>) are evaluated against the ImageNet-21k class names <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib41" title="">41</a>]</cite>.
For the medical analysis in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS4" title="5.4 Case study: spurious correlation analysis in melanoma detection (Q4) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.4</span></a>, we use ISIC datasets of 2019 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib21" title="">21</a>]</cite> for the main analysis, and also 2020 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib42" title="">42</a>]</cite> and 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib9" title="">9</a>]</cite> for <span class="ltx_glossaryref" title="">SAE</span> training.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Sparse autoencoder</h4>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p1.3">We train top-<math alttext="k" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="A1.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="A1.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.1.m1.1d">italic_k</annotation></semantics></math> <span class="ltx_glossaryref" title="">SAEs</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib20" title="">20</a>]</cite> with <math alttext="k=64" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="A1.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">k</mi><mo id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.1" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1"><eq id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.1"></eq><ci id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.2">𝑘</ci><cn id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.2.m2.1c">k=64</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.2.m2.1d">italic_k = 64</annotation></semantics></math> and 30,000 components. For general vision CLIP models, training is performed on the ImageNet-1k training set. For the medical task, we use a combined dataset of ISIC 2019, 2020, and 2024.
For the <span class="ltx_glossaryref" title="">SAEs</span> as described by <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E1" title="In 3.1 Sparse autoencoders for extracting interpretable components ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, we enforce latent vectors <math alttext="\mathbf{v}_{j}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="A1.SS0.SSS0.Px3.p1.3.m3.1a"><msub id="A1.SS0.SSS0.Px3.p1.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">𝐯</mi><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝐯</ci><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.3.m3.1c">\mathbf{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.3.m3.1d">bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to have a norm of one:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|\mathbf{v}_{j}\|=1\,." class="ltx_Math" display="block" id="A1.E9.m1.1"><semantics id="A1.E9.m1.1a"><mrow id="A1.E9.m1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml"><mrow id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml"><mrow id="A1.E9.m1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.2.cmml"><mo id="A1.E9.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E9.m1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.E9.m1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="A1.E9.m1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E9.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E9.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A1.E9.m1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.2.cmml">=</mo><mn id="A1.E9.m1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E9.m1.1.1.1.2" lspace="0.170em" xref="A1.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.1b"><apply id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1"><eq id="A1.E9.m1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.2"></eq><apply id="A1.E9.m1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E9.m1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="A1.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn id="A1.E9.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E9.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.1c">\|\mathbf{v}_{j}\|=1\,.</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.1d">∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ = 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px3.p2">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p2.2">For ImageNet <span class="ltx_glossaryref" title="">SAEs</span>, we train with AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib31" title="">31</a>]</cite> and a learning rate of <math alttext="1\cdot 10^{-6}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p2.1.m1.1"><semantics id="A1.SS0.SSS0.Px3.p2.1.m1.1a"><mrow id="A1.SS0.SSS0.Px3.p2.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.cmml"><mn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.2" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.2.cmml">1</mn><mo id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.1.cmml">⋅</mo><msup id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.cmml"><mn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.2" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml"><mo id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3a" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p2.1.m1.1b"><apply id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1"><ci id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.1">⋅</ci><cn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.2">1</cn><apply id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.1.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3">superscript</csymbol><cn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.2">10</cn><apply id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3"><minus id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3"></minus><cn id="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p2.1.m1.1c">1\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p2.1.m1.1d">1 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> for 30 epochs, reducing it by a factor of 10 after epochs 24 and 28. Each epoch is performed over 10 % of the full train dataset (randomly sampled). For the medical setting, we train for 25 epochs with a learning rate of <math alttext="5\cdot 10^{-5}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p2.2.m2.1"><semantics id="A1.SS0.SSS0.Px3.p2.2.m2.1a"><mrow id="A1.SS0.SSS0.Px3.p2.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.cmml"><mn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml">5</mn><mo id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml">⋅</mo><msup id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml"><mn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.2" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.2.cmml">10</mn><mrow id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.cmml"><mo id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3a" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p2.2.m2.1b"><apply id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1"><ci id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.1">⋅</ci><cn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.2">5</cn><apply id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.1.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3">superscript</csymbol><cn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.2">10</cn><apply id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3"><minus id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3"></minus><cn id="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="A1.SS0.SSS0.Px3.p2.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p2.2.m2.1c">5\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p2.2.m2.1d">5 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>, decayed at epochs 17 and 23.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px3.p3">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p3.3">The loss for training corresponds to an MSE loss between original <math alttext="\boldsymbol{x}_{j}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p3.1.m1.1"><semantics id="A1.SS0.SSS0.Px3.p3.1.m1.1a"><msub id="A1.SS0.SSS0.Px3.p3.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.2" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1.2.cmml">𝒙</mi><mi id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.3" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p3.1.m1.1b"><apply id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1.2">𝒙</ci><ci id="A1.SS0.SSS0.Px3.p3.1.m1.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p3.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p3.1.m1.1c">\boldsymbol{x}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p3.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and reconstructed normalized embeddings <math alttext="\hat{\boldsymbol{x}}_{j}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p3.2.m2.1"><semantics id="A1.SS0.SSS0.Px3.p3.2.m2.1a"><msub id="A1.SS0.SSS0.Px3.p3.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.cmml"><mover accent="true" id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.cmml"><mi id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.2" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.2.cmml">𝒙</mi><mo id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.1" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p3.2.m2.1b"><apply id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1">subscript</csymbol><apply id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2"><ci id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.1.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.1">^</ci><ci id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.2.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.2.2">𝒙</ci></apply><ci id="A1.SS0.SSS0.Px3.p3.2.m2.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p3.2.m2.1c">\hat{\boldsymbol{x}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p3.2.m2.1d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for token <math alttext="i" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p3.3.m3.1"><semantics id="A1.SS0.SSS0.Px3.p3.3.m3.1a"><mi id="A1.SS0.SSS0.Px3.p3.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p3.3.m3.1b"><ci id="A1.SS0.SSS0.Px3.p3.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p3.3.m3.1d">italic_i</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{MSE}}=L_{\text{MSE}}^{\text{cls}}+\frac{1}{m}\sum_{j}^{m}L_{\text{MSE%
}}^{j}\,,\quad\text{with}\quad L_{\text{MSE}}^{i}=\left\|\frac{{\boldsymbol{x}%
}_{j}}{\|{\boldsymbol{x}}_{j}\|}-\frac{\hat{\boldsymbol{x}}_{j}}{\|\hat{%
\boldsymbol{x}}_{j}\|}\right\|^{2}\,," class="ltx_Math" display="block" id="A1.E10.m1.4"><semantics id="A1.E10.m1.4a"><mrow id="A1.E10.m1.4.4.1"><mrow id="A1.E10.m1.4.4.1.1.2" xref="A1.E10.m1.4.4.1.1.3.cmml"><mrow id="A1.E10.m1.4.4.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.cmml"><msub id="A1.E10.m1.4.4.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.3.2" xref="A1.E10.m1.4.4.1.1.1.1.3.2.cmml">L</mi><mtext id="A1.E10.m1.4.4.1.1.1.1.3.3" xref="A1.E10.m1.4.4.1.1.1.1.3.3a.cmml">MSE</mtext></msub><mo id="A1.E10.m1.4.4.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.2.cmml">=</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3a.cmml">MSE</mtext><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3a.cmml">cls</mtext></msubsup><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mfrac id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.cmml"><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml">m</mi></mfrac><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.cmml"><munderover id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.2" movablelimits="false" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.3.cmml">j</mi><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.3.cmml">m</mi></munderover><msubsup id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.2.cmml">L</mi><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3a.cmml">MSE</mtext><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.cmml">j</mi></msubsup></mrow></mrow></mrow><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.2" rspace="1.167em" xref="A1.E10.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mtext id="A1.E10.m1.3.3" xref="A1.E10.m1.3.3a.cmml">with</mtext></mrow></mrow><mspace id="A1.E10.m1.4.4.1.1.2.3" width="1em" xref="A1.E10.m1.4.4.1.1.3a.cmml"></mspace><mrow id="A1.E10.m1.4.4.1.1.2.2" xref="A1.E10.m1.4.4.1.1.2.2.cmml"><msubsup id="A1.E10.m1.4.4.1.1.2.2.3" xref="A1.E10.m1.4.4.1.1.2.2.3.cmml"><mi id="A1.E10.m1.4.4.1.1.2.2.3.2.2" xref="A1.E10.m1.4.4.1.1.2.2.3.2.2.cmml">L</mi><mtext id="A1.E10.m1.4.4.1.1.2.2.3.2.3" xref="A1.E10.m1.4.4.1.1.2.2.3.2.3a.cmml">MSE</mtext><mi id="A1.E10.m1.4.4.1.1.2.2.3.3" xref="A1.E10.m1.4.4.1.1.2.2.3.3.cmml">i</mi></msubsup><mo id="A1.E10.m1.4.4.1.1.2.2.2" xref="A1.E10.m1.4.4.1.1.2.2.2.cmml">=</mo><msup id="A1.E10.m1.4.4.1.1.2.2.1" xref="A1.E10.m1.4.4.1.1.2.2.1.cmml"><mrow id="A1.E10.m1.4.4.1.1.2.2.1.1.1" xref="A1.E10.m1.4.4.1.1.2.2.1.1.2.cmml"><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.1.2" xref="A1.E10.m1.4.4.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="A1.E10.m1.4.4.1.1.2.2.1.1.1.1" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.cmml"><mfrac id="A1.E10.m1.1.1" xref="A1.E10.m1.1.1.cmml"><msub id="A1.E10.m1.1.1.3" xref="A1.E10.m1.1.1.3.cmml"><mi id="A1.E10.m1.1.1.3.2" xref="A1.E10.m1.1.1.3.2.cmml">𝒙</mi><mi id="A1.E10.m1.1.1.3.3" xref="A1.E10.m1.1.1.3.3.cmml">j</mi></msub><mrow id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.2.cmml"><mo id="A1.E10.m1.1.1.1.1.2" stretchy="false" xref="A1.E10.m1.1.1.1.2.1.cmml">‖</mo><msub id="A1.E10.m1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.cmml"><mi id="A1.E10.m1.1.1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="A1.E10.m1.1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E10.m1.1.1.1.1.3" stretchy="false" xref="A1.E10.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.1.cmml">−</mo><mfrac id="A1.E10.m1.2.2" xref="A1.E10.m1.2.2.cmml"><msub id="A1.E10.m1.2.2.3" xref="A1.E10.m1.2.2.3.cmml"><mover accent="true" id="A1.E10.m1.2.2.3.2" xref="A1.E10.m1.2.2.3.2.cmml"><mi id="A1.E10.m1.2.2.3.2.2" xref="A1.E10.m1.2.2.3.2.2.cmml">𝒙</mi><mo id="A1.E10.m1.2.2.3.2.1" xref="A1.E10.m1.2.2.3.2.1.cmml">^</mo></mover><mi id="A1.E10.m1.2.2.3.3" xref="A1.E10.m1.2.2.3.3.cmml">j</mi></msub><mrow id="A1.E10.m1.2.2.1.1" xref="A1.E10.m1.2.2.1.2.cmml"><mo id="A1.E10.m1.2.2.1.1.2" stretchy="false" xref="A1.E10.m1.2.2.1.2.1.cmml">‖</mo><msub id="A1.E10.m1.2.2.1.1.1" xref="A1.E10.m1.2.2.1.1.1.cmml"><mover accent="true" id="A1.E10.m1.2.2.1.1.1.2" xref="A1.E10.m1.2.2.1.1.1.2.cmml"><mi id="A1.E10.m1.2.2.1.1.1.2.2" xref="A1.E10.m1.2.2.1.1.1.2.2.cmml">𝒙</mi><mo id="A1.E10.m1.2.2.1.1.1.2.1" xref="A1.E10.m1.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="A1.E10.m1.2.2.1.1.1.3" xref="A1.E10.m1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E10.m1.2.2.1.1.3" stretchy="false" xref="A1.E10.m1.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.1.3" xref="A1.E10.m1.4.4.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E10.m1.4.4.1.1.2.2.1.3" xref="A1.E10.m1.4.4.1.1.2.2.1.3.cmml">2</mn></msup></mrow></mrow><mo id="A1.E10.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.4b"><apply id="A1.E10.m1.4.4.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.3a.cmml" xref="A1.E10.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1"><eq id="A1.E10.m1.4.4.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2"></eq><apply id="A1.E10.m1.4.4.1.1.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="A1.E10.m1.4.4.1.1.1.1.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.3.2">𝐿</ci><ci id="A1.E10.m1.4.4.1.1.1.1.3.3a.cmml" xref="A1.E10.m1.4.4.1.1.1.1.3.3"><mtext id="A1.E10.m1.4.4.1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.1.1.1.1.3.3">MSE</mtext></ci></apply><list id="A1.E10.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1"><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1"><plus id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1"></plus><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.2">𝐿</ci><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3a.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3"><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.2.3">MSE</mtext></ci></apply><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3a.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3"><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.2.3">cls</mtext></ci></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3"><times id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2"><divide id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2"></divide><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.2">1</cn><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3"><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1">subscript</csymbol><sum id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.2"></sum><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.2.3">𝑗</ci></apply><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.1.3">𝑚</ci></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.2">𝐿</ci><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3a.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3"><mtext id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.3">MSE</mtext></ci></apply><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply><ci id="A1.E10.m1.3.3a.cmml" xref="A1.E10.m1.3.3"><mtext id="A1.E10.m1.3.3.cmml" xref="A1.E10.m1.3.3">with</mtext></ci></list></apply><apply id="A1.E10.m1.4.4.1.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2"><eq id="A1.E10.m1.4.4.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.2"></eq><apply id="A1.E10.m1.4.4.1.1.2.2.3.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.2.2.3.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.2.2.3.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.2.2.3.2.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3">subscript</csymbol><ci id="A1.E10.m1.4.4.1.1.2.2.3.2.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3.2.2">𝐿</ci><ci id="A1.E10.m1.4.4.1.1.2.2.3.2.3a.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3.2.3"><mtext id="A1.E10.m1.4.4.1.1.2.2.3.2.3.cmml" mathsize="70%" xref="A1.E10.m1.4.4.1.1.2.2.3.2.3">MSE</mtext></ci></apply><ci id="A1.E10.m1.4.4.1.1.2.2.3.3.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3.3">𝑖</ci></apply><apply id="A1.E10.m1.4.4.1.1.2.2.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.2.2.1.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.2.2.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.4.4.1.1.2.2.1.1.2.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.2">norm</csymbol><apply id="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.1"><minus id="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.1"></minus><apply id="A1.E10.m1.1.1.cmml" xref="A1.E10.m1.1.1"><divide id="A1.E10.m1.1.1.2.cmml" xref="A1.E10.m1.1.1"></divide><apply id="A1.E10.m1.1.1.3.cmml" xref="A1.E10.m1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.3.1.cmml" xref="A1.E10.m1.1.1.3">subscript</csymbol><ci id="A1.E10.m1.1.1.3.2.cmml" xref="A1.E10.m1.1.1.3.2">𝒙</ci><ci id="A1.E10.m1.1.1.3.3.cmml" xref="A1.E10.m1.1.1.3.3">𝑗</ci></apply><apply id="A1.E10.m1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.1.1.1.2.1.cmml" xref="A1.E10.m1.1.1.1.1.2">norm</csymbol><apply id="A1.E10.m1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1.1.2">𝒙</ci><ci id="A1.E10.m1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="A1.E10.m1.2.2.cmml" xref="A1.E10.m1.2.2"><divide id="A1.E10.m1.2.2.2.cmml" xref="A1.E10.m1.2.2"></divide><apply id="A1.E10.m1.2.2.3.cmml" xref="A1.E10.m1.2.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.3.1.cmml" xref="A1.E10.m1.2.2.3">subscript</csymbol><apply id="A1.E10.m1.2.2.3.2.cmml" xref="A1.E10.m1.2.2.3.2"><ci id="A1.E10.m1.2.2.3.2.1.cmml" xref="A1.E10.m1.2.2.3.2.1">^</ci><ci id="A1.E10.m1.2.2.3.2.2.cmml" xref="A1.E10.m1.2.2.3.2.2">𝒙</ci></apply><ci id="A1.E10.m1.2.2.3.3.cmml" xref="A1.E10.m1.2.2.3.3">𝑗</ci></apply><apply id="A1.E10.m1.2.2.1.2.cmml" xref="A1.E10.m1.2.2.1.1"><csymbol cd="latexml" id="A1.E10.m1.2.2.1.2.1.cmml" xref="A1.E10.m1.2.2.1.1.2">norm</csymbol><apply id="A1.E10.m1.2.2.1.1.1.cmml" xref="A1.E10.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.1.1.1.1.cmml" xref="A1.E10.m1.2.2.1.1.1">subscript</csymbol><apply id="A1.E10.m1.2.2.1.1.1.2.cmml" xref="A1.E10.m1.2.2.1.1.1.2"><ci id="A1.E10.m1.2.2.1.1.1.2.1.cmml" xref="A1.E10.m1.2.2.1.1.1.2.1">^</ci><ci id="A1.E10.m1.2.2.1.1.1.2.2.cmml" xref="A1.E10.m1.2.2.1.1.1.2.2">𝒙</ci></apply><ci id="A1.E10.m1.2.2.1.1.1.3.cmml" xref="A1.E10.m1.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><cn id="A1.E10.m1.4.4.1.1.2.2.1.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.2.2.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.4c">L_{\text{MSE}}=L_{\text{MSE}}^{\text{cls}}+\frac{1}{m}\sum_{j}^{m}L_{\text{MSE%
}}^{j}\,,\quad\text{with}\quad L_{\text{MSE}}^{i}=\left\|\frac{{\boldsymbol{x}%
}_{j}}{\|{\boldsymbol{x}}_{j}\|}-\frac{\hat{\boldsymbol{x}}_{j}}{\|\hat{%
\boldsymbol{x}}_{j}\|}\right\|^{2}\,,</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.4d">italic_L start_POSTSUBSCRIPT MSE end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT MSE end_POSTSUBSCRIPT start_POSTSUPERSCRIPT cls end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG italic_m end_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT MSE end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , with italic_L start_POSTSUBSCRIPT MSE end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = ∥ divide start_ARG bold_italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG - divide start_ARG over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p3.5">where <math alttext="m" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p3.4.m1.1"><semantics id="A1.SS0.SSS0.Px3.p3.4.m1.1a"><mi id="A1.SS0.SSS0.Px3.p3.4.m1.1.1" xref="A1.SS0.SSS0.Px3.p3.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p3.4.m1.1b"><ci id="A1.SS0.SSS0.Px3.p3.4.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p3.4.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p3.4.m1.1d">italic_m</annotation></semantics></math> is the number of spatial tokens.
Note, that in the end, the <span class="ltx_glossaryref" title="">SAE</span> is used to reconstruct the class token embedding <math alttext="\boldsymbol{x}_{\text{cls}}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p3.5.m2.1"><semantics id="A1.SS0.SSS0.Px3.p3.5.m2.1a"><msub id="A1.SS0.SSS0.Px3.p3.5.m2.1.1" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.2.cmml">𝒙</mi><mtext id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3a.cmml">cls</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p3.5.m2.1b"><apply id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.2">𝒙</ci><ci id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3a.cmml" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3"><mtext id="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS0.SSS0.Px3.p3.5.m2.1.1.3">cls</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p3.5.m2.1c">\boldsymbol{x}_{\text{cls}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p3.5.m2.1d">bold_italic_x start_POSTSUBSCRIPT cls end_POSTSUBSCRIPT</annotation></semantics></math> only, but can, in principle, also reconstruct the spatial tokens.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Computational resources</h4>
<div class="ltx_para ltx_noindent" id="A1.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px4.p1.1">Training of <span class="ltx_glossaryref" title="">SAEs</span> has been performed on a GPU cluster with either one of four A100 40GB or Tesla V100 32GB GPUs by NVIDIA per node.
Training of the ViT-H/14 SAE takes about 12 hours (A100), ViT-L/14 16 hours (Tesla V100), ViT-B/16 6 hours (Tesla V100), ViT-B/32 3 hours (Tesla V100).
For all other experiments,
a NVIDIA Titan RTX 24GB on a local workstation was used.
Other compute intensive tasks correspond to the collection of visual embeddings and <span class="ltx_glossaryref" title="">SAE</span> component activations on the ImageNet-1k train set.
This takes about 11 hours for the ViT-H/14 and 5 hours for the ViT-L/14 model and 1.5 hours for the ViT-B/16 model.
All other experiments require less than 1 hour of compute time per model.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Latent component attributions</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This section provides additional methodological details for <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS1" title="4.1 Instance-wise attribution of components ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.1</span></a> and results on evaluating the faithfulness of instance-wise attributions using <span class="ltx_glossaryref" title="">SAE</span> components for <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Approximation of activation times gradient</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.5">We aim to compute attribution scores <math alttext="R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.2"><semantics id="A2.SS1.p1.1.m1.2a"><mrow id="A2.SS1.p1.1.m1.2.3" xref="A2.SS1.p1.1.m1.2.3.cmml"><msub id="A2.SS1.p1.1.m1.2.3.2" xref="A2.SS1.p1.1.m1.2.3.2.cmml"><mi id="A2.SS1.p1.1.m1.2.3.2.2" xref="A2.SS1.p1.1.m1.2.3.2.2.cmml">R</mi><mi id="A2.SS1.p1.1.m1.2.3.2.3" xref="A2.SS1.p1.1.m1.2.3.2.3.cmml">j</mi></msub><mo id="A2.SS1.p1.1.m1.2.3.1" xref="A2.SS1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.1.m1.2.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml"><mo id="A2.SS1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">𝒙</mi><mo id="A2.SS1.p1.1.m1.2.3.3.2.2" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">𝐭</mi><mo id="A2.SS1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.2b"><apply id="A2.SS1.p1.1.m1.2.3.cmml" xref="A2.SS1.p1.1.m1.2.3"><times id="A2.SS1.p1.1.m1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.1"></times><apply id="A2.SS1.p1.1.m1.2.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.2.3.2.1.cmml" xref="A2.SS1.p1.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS1.p1.1.m1.2.3.2.2.cmml" xref="A2.SS1.p1.1.m1.2.3.2.2">𝑅</ci><ci id="A2.SS1.p1.1.m1.2.3.2.3.cmml" xref="A2.SS1.p1.1.m1.2.3.2.3">𝑗</ci></apply><interval closure="open" id="A2.SS1.p1.1.m1.2.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.2"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝒙</ci><ci id="A2.SS1.p1.1.m1.2.2.cmml" xref="A2.SS1.p1.1.m1.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.2c">R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math> for component <math alttext="j" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mi id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><ci id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_j</annotation></semantics></math>, with output embedding <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">bold_italic_x</annotation></semantics></math> and textual prompt <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.1"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.1d">bold_t</annotation></semantics></math>, explaining an output <math alttext="y(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="A2.SS1.p1.5.m5.2"><semantics id="A2.SS1.p1.5.m5.2a"><mrow id="A2.SS1.p1.5.m5.2.3" xref="A2.SS1.p1.5.m5.2.3.cmml"><mi id="A2.SS1.p1.5.m5.2.3.2" xref="A2.SS1.p1.5.m5.2.3.2.cmml">y</mi><mo id="A2.SS1.p1.5.m5.2.3.1" xref="A2.SS1.p1.5.m5.2.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.5.m5.2.3.3.2" xref="A2.SS1.p1.5.m5.2.3.3.1.cmml"><mo id="A2.SS1.p1.5.m5.2.3.3.2.1" stretchy="false" xref="A2.SS1.p1.5.m5.2.3.3.1.cmml">(</mo><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">𝒙</mi><mo id="A2.SS1.p1.5.m5.2.3.3.2.2" xref="A2.SS1.p1.5.m5.2.3.3.1.cmml">,</mo><mi id="A2.SS1.p1.5.m5.2.2" xref="A2.SS1.p1.5.m5.2.2.cmml">𝐭</mi><mo id="A2.SS1.p1.5.m5.2.3.3.2.3" stretchy="false" xref="A2.SS1.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.2b"><apply id="A2.SS1.p1.5.m5.2.3.cmml" xref="A2.SS1.p1.5.m5.2.3"><times id="A2.SS1.p1.5.m5.2.3.1.cmml" xref="A2.SS1.p1.5.m5.2.3.1"></times><ci id="A2.SS1.p1.5.m5.2.3.2.cmml" xref="A2.SS1.p1.5.m5.2.3.2">𝑦</ci><interval closure="open" id="A2.SS1.p1.5.m5.2.3.3.1.cmml" xref="A2.SS1.p1.5.m5.2.3.3.2"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝒙</ci><ci id="A2.SS1.p1.5.m5.2.2.cmml" xref="A2.SS1.p1.5.m5.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.2c">y(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.5.m5.2d">italic_y ( bold_italic_x , bold_t )</annotation></semantics></math>. The relevance score is defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx2">
<tbody id="A2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})=a_{j}\frac{\partial y(%
\boldsymbol{x},\mathbf{t})}{\partial a_{j}}~{}." class="ltx_Math" display="inline" id="A2.E11.m1.5"><semantics id="A2.E11.m1.5a"><mrow id="A2.E11.m1.5.5.1" xref="A2.E11.m1.5.5.1.1.cmml"><mrow id="A2.E11.m1.5.5.1.1" xref="A2.E11.m1.5.5.1.1.cmml"><mrow id="A2.E11.m1.5.5.1.1.2" xref="A2.E11.m1.5.5.1.1.2.cmml"><msub id="A2.E11.m1.5.5.1.1.2.2" xref="A2.E11.m1.5.5.1.1.2.2.cmml"><mi id="A2.E11.m1.5.5.1.1.2.2.2" xref="A2.E11.m1.5.5.1.1.2.2.2.cmml">R</mi><mi id="A2.E11.m1.5.5.1.1.2.2.3" xref="A2.E11.m1.5.5.1.1.2.2.3.cmml">j</mi></msub><mo id="A2.E11.m1.5.5.1.1.2.1" xref="A2.E11.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="A2.E11.m1.5.5.1.1.2.3.2" xref="A2.E11.m1.5.5.1.1.2.3.1.cmml"><mo id="A2.E11.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="A2.E11.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="A2.E11.m1.3.3" xref="A2.E11.m1.3.3.cmml">𝒙</mi><mo id="A2.E11.m1.5.5.1.1.2.3.2.2" xref="A2.E11.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="A2.E11.m1.4.4" xref="A2.E11.m1.4.4.cmml">𝐭</mi><mo id="A2.E11.m1.5.5.1.1.2.3.2.3" stretchy="false" xref="A2.E11.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.5.5.1.1.1" xref="A2.E11.m1.5.5.1.1.1.cmml">=</mo><mrow id="A2.E11.m1.5.5.1.1.3" xref="A2.E11.m1.5.5.1.1.3.cmml"><msub id="A2.E11.m1.5.5.1.1.3.2" xref="A2.E11.m1.5.5.1.1.3.2.cmml"><mi id="A2.E11.m1.5.5.1.1.3.2.2" xref="A2.E11.m1.5.5.1.1.3.2.2.cmml">a</mi><mi id="A2.E11.m1.5.5.1.1.3.2.3" xref="A2.E11.m1.5.5.1.1.3.2.3.cmml">j</mi></msub><mo id="A2.E11.m1.5.5.1.1.3.1" xref="A2.E11.m1.5.5.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E11.m1.2.2" xref="A2.E11.m1.2.2.cmml"><mfrac id="A2.E11.m1.2.2a" xref="A2.E11.m1.2.2.cmml"><mrow id="A2.E11.m1.2.2.2" xref="A2.E11.m1.2.2.2.cmml"><mo id="A2.E11.m1.2.2.2.3" rspace="0em" xref="A2.E11.m1.2.2.2.3.cmml">∂</mo><mrow id="A2.E11.m1.2.2.2.4" xref="A2.E11.m1.2.2.2.4.cmml"><mi id="A2.E11.m1.2.2.2.4.2" xref="A2.E11.m1.2.2.2.4.2.cmml">y</mi><mo id="A2.E11.m1.2.2.2.4.1" xref="A2.E11.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="A2.E11.m1.2.2.2.4.3.2" xref="A2.E11.m1.2.2.2.4.3.1.cmml"><mo id="A2.E11.m1.2.2.2.4.3.2.1" stretchy="false" xref="A2.E11.m1.2.2.2.4.3.1.cmml">(</mo><mi id="A2.E11.m1.1.1.1.1" xref="A2.E11.m1.1.1.1.1.cmml">𝒙</mi><mo id="A2.E11.m1.2.2.2.4.3.2.2" xref="A2.E11.m1.2.2.2.4.3.1.cmml">,</mo><mi id="A2.E11.m1.2.2.2.2" xref="A2.E11.m1.2.2.2.2.cmml">𝐭</mi><mo id="A2.E11.m1.2.2.2.4.3.2.3" stretchy="false" xref="A2.E11.m1.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.E11.m1.2.2.4" xref="A2.E11.m1.2.2.4.cmml"><mo id="A2.E11.m1.2.2.4.1" rspace="0em" xref="A2.E11.m1.2.2.4.1.cmml">∂</mo><msub id="A2.E11.m1.2.2.4.2" xref="A2.E11.m1.2.2.4.2.cmml"><mi id="A2.E11.m1.2.2.4.2.2" xref="A2.E11.m1.2.2.4.2.2.cmml">a</mi><mi id="A2.E11.m1.2.2.4.2.3" xref="A2.E11.m1.2.2.4.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle></mrow></mrow><mo id="A2.E11.m1.5.5.1.2" lspace="0.330em" xref="A2.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E11.m1.5b"><apply id="A2.E11.m1.5.5.1.1.cmml" xref="A2.E11.m1.5.5.1"><eq id="A2.E11.m1.5.5.1.1.1.cmml" xref="A2.E11.m1.5.5.1.1.1"></eq><apply id="A2.E11.m1.5.5.1.1.2.cmml" xref="A2.E11.m1.5.5.1.1.2"><times id="A2.E11.m1.5.5.1.1.2.1.cmml" xref="A2.E11.m1.5.5.1.1.2.1"></times><apply id="A2.E11.m1.5.5.1.1.2.2.cmml" xref="A2.E11.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="A2.E11.m1.5.5.1.1.2.2.1.cmml" xref="A2.E11.m1.5.5.1.1.2.2">subscript</csymbol><ci id="A2.E11.m1.5.5.1.1.2.2.2.cmml" xref="A2.E11.m1.5.5.1.1.2.2.2">𝑅</ci><ci id="A2.E11.m1.5.5.1.1.2.2.3.cmml" xref="A2.E11.m1.5.5.1.1.2.2.3">𝑗</ci></apply><interval closure="open" id="A2.E11.m1.5.5.1.1.2.3.1.cmml" xref="A2.E11.m1.5.5.1.1.2.3.2"><ci id="A2.E11.m1.3.3.cmml" xref="A2.E11.m1.3.3">𝒙</ci><ci id="A2.E11.m1.4.4.cmml" xref="A2.E11.m1.4.4">𝐭</ci></interval></apply><apply id="A2.E11.m1.5.5.1.1.3.cmml" xref="A2.E11.m1.5.5.1.1.3"><times id="A2.E11.m1.5.5.1.1.3.1.cmml" xref="A2.E11.m1.5.5.1.1.3.1"></times><apply id="A2.E11.m1.5.5.1.1.3.2.cmml" xref="A2.E11.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="A2.E11.m1.5.5.1.1.3.2.1.cmml" xref="A2.E11.m1.5.5.1.1.3.2">subscript</csymbol><ci id="A2.E11.m1.5.5.1.1.3.2.2.cmml" xref="A2.E11.m1.5.5.1.1.3.2.2">𝑎</ci><ci id="A2.E11.m1.5.5.1.1.3.2.3.cmml" xref="A2.E11.m1.5.5.1.1.3.2.3">𝑗</ci></apply><apply id="A2.E11.m1.2.2.cmml" xref="A2.E11.m1.2.2"><divide id="A2.E11.m1.2.2.3.cmml" xref="A2.E11.m1.2.2"></divide><apply id="A2.E11.m1.2.2.2.cmml" xref="A2.E11.m1.2.2.2"><partialdiff id="A2.E11.m1.2.2.2.3.cmml" xref="A2.E11.m1.2.2.2.3"></partialdiff><apply id="A2.E11.m1.2.2.2.4.cmml" xref="A2.E11.m1.2.2.2.4"><times id="A2.E11.m1.2.2.2.4.1.cmml" xref="A2.E11.m1.2.2.2.4.1"></times><ci id="A2.E11.m1.2.2.2.4.2.cmml" xref="A2.E11.m1.2.2.2.4.2">𝑦</ci><interval closure="open" id="A2.E11.m1.2.2.2.4.3.1.cmml" xref="A2.E11.m1.2.2.2.4.3.2"><ci id="A2.E11.m1.1.1.1.1.cmml" xref="A2.E11.m1.1.1.1.1">𝒙</ci><ci id="A2.E11.m1.2.2.2.2.cmml" xref="A2.E11.m1.2.2.2.2">𝐭</ci></interval></apply></apply><apply id="A2.E11.m1.2.2.4.cmml" xref="A2.E11.m1.2.2.4"><partialdiff id="A2.E11.m1.2.2.4.1.cmml" xref="A2.E11.m1.2.2.4.1"></partialdiff><apply id="A2.E11.m1.2.2.4.2.cmml" xref="A2.E11.m1.2.2.4.2"><csymbol cd="ambiguous" id="A2.E11.m1.2.2.4.2.1.cmml" xref="A2.E11.m1.2.2.4.2">subscript</csymbol><ci id="A2.E11.m1.2.2.4.2.2.cmml" xref="A2.E11.m1.2.2.4.2.2">𝑎</ci><ci id="A2.E11.m1.2.2.4.2.3.cmml" xref="A2.E11.m1.2.2.4.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E11.m1.5c">\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})=a_{j}\frac{\partial y(%
\boldsymbol{x},\mathbf{t})}{\partial a_{j}}~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E11.m1.5d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t ) = italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∂ italic_y ( bold_italic_x , bold_t ) end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p1.8">We also know that <math alttext="y(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="A2.SS1.p1.6.m1.2"><semantics id="A2.SS1.p1.6.m1.2a"><mrow id="A2.SS1.p1.6.m1.2.3" xref="A2.SS1.p1.6.m1.2.3.cmml"><mi id="A2.SS1.p1.6.m1.2.3.2" xref="A2.SS1.p1.6.m1.2.3.2.cmml">y</mi><mo id="A2.SS1.p1.6.m1.2.3.1" xref="A2.SS1.p1.6.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.6.m1.2.3.3.2" xref="A2.SS1.p1.6.m1.2.3.3.1.cmml"><mo id="A2.SS1.p1.6.m1.2.3.3.2.1" stretchy="false" xref="A2.SS1.p1.6.m1.2.3.3.1.cmml">(</mo><mi id="A2.SS1.p1.6.m1.1.1" xref="A2.SS1.p1.6.m1.1.1.cmml">𝒙</mi><mo id="A2.SS1.p1.6.m1.2.3.3.2.2" xref="A2.SS1.p1.6.m1.2.3.3.1.cmml">,</mo><mi id="A2.SS1.p1.6.m1.2.2" xref="A2.SS1.p1.6.m1.2.2.cmml">𝐭</mi><mo id="A2.SS1.p1.6.m1.2.3.3.2.3" stretchy="false" xref="A2.SS1.p1.6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.6.m1.2b"><apply id="A2.SS1.p1.6.m1.2.3.cmml" xref="A2.SS1.p1.6.m1.2.3"><times id="A2.SS1.p1.6.m1.2.3.1.cmml" xref="A2.SS1.p1.6.m1.2.3.1"></times><ci id="A2.SS1.p1.6.m1.2.3.2.cmml" xref="A2.SS1.p1.6.m1.2.3.2">𝑦</ci><interval closure="open" id="A2.SS1.p1.6.m1.2.3.3.1.cmml" xref="A2.SS1.p1.6.m1.2.3.3.2"><ci id="A2.SS1.p1.6.m1.1.1.cmml" xref="A2.SS1.p1.6.m1.1.1">𝒙</ci><ci id="A2.SS1.p1.6.m1.2.2.cmml" xref="A2.SS1.p1.6.m1.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.6.m1.2c">y(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.6.m1.2d">italic_y ( bold_italic_x , bold_t )</annotation></semantics></math> is given by the cosine similarity between <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.SS1.p1.7.m2.1"><semantics id="A2.SS1.p1.7.m2.1a"><mi id="A2.SS1.p1.7.m2.1.1" xref="A2.SS1.p1.7.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.7.m2.1b"><ci id="A2.SS1.p1.7.m2.1.1.cmml" xref="A2.SS1.p1.7.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.7.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.7.m2.1d">bold_italic_x</annotation></semantics></math> and <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="A2.SS1.p1.8.m3.1"><semantics id="A2.SS1.p1.8.m3.1a"><mi id="A2.SS1.p1.8.m3.1.1" xref="A2.SS1.p1.8.m3.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.8.m3.1b"><ci id="A2.SS1.p1.8.m3.1.1.cmml" xref="A2.SS1.p1.8.m3.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.8.m3.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.8.m3.1d">bold_t</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}}=\frac{\partial}{%
\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}}\cdot\frac{\mathbf{t}}%
{\|\mathbf{t}\|}~{}," class="ltx_Math" display="block" id="A2.E12.m1.5"><semantics id="A2.E12.m1.5a"><mrow id="A2.E12.m1.5.5.1" xref="A2.E12.m1.5.5.1.1.cmml"><mrow id="A2.E12.m1.5.5.1.1" xref="A2.E12.m1.5.5.1.1.cmml"><mfrac id="A2.E12.m1.2.2" xref="A2.E12.m1.2.2.cmml"><mrow id="A2.E12.m1.2.2.2" xref="A2.E12.m1.2.2.2.cmml"><mo id="A2.E12.m1.2.2.2.3" rspace="0em" xref="A2.E12.m1.2.2.2.3.cmml">∂</mo><mrow id="A2.E12.m1.2.2.2.4" xref="A2.E12.m1.2.2.2.4.cmml"><mi id="A2.E12.m1.2.2.2.4.2" xref="A2.E12.m1.2.2.2.4.2.cmml">y</mi><mo id="A2.E12.m1.2.2.2.4.1" xref="A2.E12.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="A2.E12.m1.2.2.2.4.3.2" xref="A2.E12.m1.2.2.2.4.3.1.cmml"><mo id="A2.E12.m1.2.2.2.4.3.2.1" stretchy="false" xref="A2.E12.m1.2.2.2.4.3.1.cmml">(</mo><mi id="A2.E12.m1.1.1.1.1" xref="A2.E12.m1.1.1.1.1.cmml">𝒙</mi><mo id="A2.E12.m1.2.2.2.4.3.2.2" xref="A2.E12.m1.2.2.2.4.3.1.cmml">,</mo><mi id="A2.E12.m1.2.2.2.2" xref="A2.E12.m1.2.2.2.2.cmml">𝐭</mi><mo id="A2.E12.m1.2.2.2.4.3.2.3" stretchy="false" xref="A2.E12.m1.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.E12.m1.2.2.4" xref="A2.E12.m1.2.2.4.cmml"><mo id="A2.E12.m1.2.2.4.1" rspace="0em" xref="A2.E12.m1.2.2.4.1.cmml">∂</mo><msub id="A2.E12.m1.2.2.4.2" xref="A2.E12.m1.2.2.4.2.cmml"><mi id="A2.E12.m1.2.2.4.2.2" xref="A2.E12.m1.2.2.4.2.2.cmml">a</mi><mi id="A2.E12.m1.2.2.4.2.3" xref="A2.E12.m1.2.2.4.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E12.m1.5.5.1.1.1" xref="A2.E12.m1.5.5.1.1.1.cmml">=</mo><mrow id="A2.E12.m1.5.5.1.1.2" xref="A2.E12.m1.5.5.1.1.2.cmml"><mrow id="A2.E12.m1.5.5.1.1.2.2" xref="A2.E12.m1.5.5.1.1.2.2.cmml"><mfrac id="A2.E12.m1.5.5.1.1.2.2.2" xref="A2.E12.m1.5.5.1.1.2.2.2.cmml"><mo id="A2.E12.m1.5.5.1.1.2.2.2.2" xref="A2.E12.m1.5.5.1.1.2.2.2.2.cmml">∂</mo><mrow id="A2.E12.m1.5.5.1.1.2.2.2.3" xref="A2.E12.m1.5.5.1.1.2.2.2.3.cmml"><mo id="A2.E12.m1.5.5.1.1.2.2.2.3.1" rspace="0em" xref="A2.E12.m1.5.5.1.1.2.2.2.3.1.cmml">∂</mo><msub id="A2.E12.m1.5.5.1.1.2.2.2.3.2" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2.cmml"><mi id="A2.E12.m1.5.5.1.1.2.2.2.3.2.2" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2.2.cmml">a</mi><mi id="A2.E12.m1.5.5.1.1.2.2.2.3.2.3" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E12.m1.5.5.1.1.2.2.1" xref="A2.E12.m1.5.5.1.1.2.2.1.cmml">⁢</mo><mfrac id="A2.E12.m1.3.3" xref="A2.E12.m1.3.3.cmml"><mi id="A2.E12.m1.3.3.3" xref="A2.E12.m1.3.3.3.cmml">𝒙</mi><mrow id="A2.E12.m1.3.3.1.3" xref="A2.E12.m1.3.3.1.2.cmml"><mo id="A2.E12.m1.3.3.1.3.1" stretchy="false" xref="A2.E12.m1.3.3.1.2.1.cmml">‖</mo><mi id="A2.E12.m1.3.3.1.1" xref="A2.E12.m1.3.3.1.1.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" id="A2.E12.m1.3.3.1.3.2" mathvariant="bold" stretchy="false" xref="A2.E12.m1.3.3.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A2.E12.m1.5.5.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E12.m1.5.5.1.1.2.1.cmml">⋅</mo><mfrac id="A2.E12.m1.4.4" xref="A2.E12.m1.4.4.cmml"><mi id="A2.E12.m1.4.4.3" xref="A2.E12.m1.4.4.3.cmml">𝐭</mi><mrow id="A2.E12.m1.4.4.1.3" xref="A2.E12.m1.4.4.1.2.cmml"><mo id="A2.E12.m1.4.4.1.3.1" stretchy="false" xref="A2.E12.m1.4.4.1.2.1.cmml">‖</mo><mi id="A2.E12.m1.4.4.1.1" xref="A2.E12.m1.4.4.1.1.cmml">𝐭</mi><mo id="A2.E12.m1.4.4.1.3.2" stretchy="false" xref="A2.E12.m1.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow><mo id="A2.E12.m1.5.5.1.2" lspace="0.330em" xref="A2.E12.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E12.m1.5b"><apply id="A2.E12.m1.5.5.1.1.cmml" xref="A2.E12.m1.5.5.1"><eq id="A2.E12.m1.5.5.1.1.1.cmml" xref="A2.E12.m1.5.5.1.1.1"></eq><apply id="A2.E12.m1.2.2.cmml" xref="A2.E12.m1.2.2"><divide id="A2.E12.m1.2.2.3.cmml" xref="A2.E12.m1.2.2"></divide><apply id="A2.E12.m1.2.2.2.cmml" xref="A2.E12.m1.2.2.2"><partialdiff id="A2.E12.m1.2.2.2.3.cmml" xref="A2.E12.m1.2.2.2.3"></partialdiff><apply id="A2.E12.m1.2.2.2.4.cmml" xref="A2.E12.m1.2.2.2.4"><times id="A2.E12.m1.2.2.2.4.1.cmml" xref="A2.E12.m1.2.2.2.4.1"></times><ci id="A2.E12.m1.2.2.2.4.2.cmml" xref="A2.E12.m1.2.2.2.4.2">𝑦</ci><interval closure="open" id="A2.E12.m1.2.2.2.4.3.1.cmml" xref="A2.E12.m1.2.2.2.4.3.2"><ci id="A2.E12.m1.1.1.1.1.cmml" xref="A2.E12.m1.1.1.1.1">𝒙</ci><ci id="A2.E12.m1.2.2.2.2.cmml" xref="A2.E12.m1.2.2.2.2">𝐭</ci></interval></apply></apply><apply id="A2.E12.m1.2.2.4.cmml" xref="A2.E12.m1.2.2.4"><partialdiff id="A2.E12.m1.2.2.4.1.cmml" xref="A2.E12.m1.2.2.4.1"></partialdiff><apply id="A2.E12.m1.2.2.4.2.cmml" xref="A2.E12.m1.2.2.4.2"><csymbol cd="ambiguous" id="A2.E12.m1.2.2.4.2.1.cmml" xref="A2.E12.m1.2.2.4.2">subscript</csymbol><ci id="A2.E12.m1.2.2.4.2.2.cmml" xref="A2.E12.m1.2.2.4.2.2">𝑎</ci><ci id="A2.E12.m1.2.2.4.2.3.cmml" xref="A2.E12.m1.2.2.4.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E12.m1.5.5.1.1.2.cmml" xref="A2.E12.m1.5.5.1.1.2"><ci id="A2.E12.m1.5.5.1.1.2.1.cmml" xref="A2.E12.m1.5.5.1.1.2.1">⋅</ci><apply id="A2.E12.m1.5.5.1.1.2.2.cmml" xref="A2.E12.m1.5.5.1.1.2.2"><times id="A2.E12.m1.5.5.1.1.2.2.1.cmml" xref="A2.E12.m1.5.5.1.1.2.2.1"></times><apply id="A2.E12.m1.5.5.1.1.2.2.2.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2"><divide id="A2.E12.m1.5.5.1.1.2.2.2.1.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2"></divide><partialdiff id="A2.E12.m1.5.5.1.1.2.2.2.2.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.2"></partialdiff><apply id="A2.E12.m1.5.5.1.1.2.2.2.3.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3"><partialdiff id="A2.E12.m1.5.5.1.1.2.2.2.3.1.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3.1"></partialdiff><apply id="A2.E12.m1.5.5.1.1.2.2.2.3.2.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2"><csymbol cd="ambiguous" id="A2.E12.m1.5.5.1.1.2.2.2.3.2.1.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2">subscript</csymbol><ci id="A2.E12.m1.5.5.1.1.2.2.2.3.2.2.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2.2">𝑎</ci><ci id="A2.E12.m1.5.5.1.1.2.2.2.3.2.3.cmml" xref="A2.E12.m1.5.5.1.1.2.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E12.m1.3.3.cmml" xref="A2.E12.m1.3.3"><divide id="A2.E12.m1.3.3.2.cmml" xref="A2.E12.m1.3.3"></divide><ci id="A2.E12.m1.3.3.3.cmml" xref="A2.E12.m1.3.3.3">𝒙</ci><apply id="A2.E12.m1.3.3.1.2.cmml" xref="A2.E12.m1.3.3.1.3"><csymbol cd="latexml" id="A2.E12.m1.3.3.1.2.1.cmml" xref="A2.E12.m1.3.3.1.3.1">norm</csymbol><ci id="A2.E12.m1.3.3.1.1.cmml" xref="A2.E12.m1.3.3.1.1">𝒙</ci></apply></apply></apply><apply id="A2.E12.m1.4.4.cmml" xref="A2.E12.m1.4.4"><divide id="A2.E12.m1.4.4.2.cmml" xref="A2.E12.m1.4.4"></divide><ci id="A2.E12.m1.4.4.3.cmml" xref="A2.E12.m1.4.4.3">𝐭</ci><apply id="A2.E12.m1.4.4.1.2.cmml" xref="A2.E12.m1.4.4.1.3"><csymbol cd="latexml" id="A2.E12.m1.4.4.1.2.1.cmml" xref="A2.E12.m1.4.4.1.3.1">norm</csymbol><ci id="A2.E12.m1.4.4.1.1.cmml" xref="A2.E12.m1.4.4.1.1">𝐭</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E12.m1.5c">\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}}=\frac{\partial}{%
\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}}\cdot\frac{\mathbf{t}}%
{\|\mathbf{t}\|}~{},</annotation><annotation encoding="application/x-llamapun" id="A2.E12.m1.5d">divide start_ARG ∂ italic_y ( bold_italic_x , bold_t ) end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG = divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x bold_∥ end_ARG ⋅ divide start_ARG bold_t end_ARG start_ARG ∥ bold_t ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p1.10">where <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="A2.SS1.p1.9.m1.1"><semantics id="A2.SS1.p1.9.m1.1a"><mi id="A2.SS1.p1.9.m1.1.1" xref="A2.SS1.p1.9.m1.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.9.m1.1b"><ci id="A2.SS1.p1.9.m1.1.1.cmml" xref="A2.SS1.p1.9.m1.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.9.m1.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.9.m1.1d">bold_t</annotation></semantics></math> is independt of <math alttext="a_{j}" class="ltx_Math" display="inline" id="A2.SS1.p1.10.m2.1"><semantics id="A2.SS1.p1.10.m2.1a"><msub id="A2.SS1.p1.10.m2.1.1" xref="A2.SS1.p1.10.m2.1.1.cmml"><mi id="A2.SS1.p1.10.m2.1.1.2" xref="A2.SS1.p1.10.m2.1.1.2.cmml">a</mi><mi id="A2.SS1.p1.10.m2.1.1.3" xref="A2.SS1.p1.10.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.10.m2.1b"><apply id="A2.SS1.p1.10.m2.1.1.cmml" xref="A2.SS1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.10.m2.1.1.1.cmml" xref="A2.SS1.p1.10.m2.1.1">subscript</csymbol><ci id="A2.SS1.p1.10.m2.1.1.2.cmml" xref="A2.SS1.p1.10.m2.1.1.2">𝑎</ci><ci id="A2.SS1.p1.10.m2.1.1.3.cmml" xref="A2.SS1.p1.10.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.10.m2.1c">a_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.10.m2.1d">italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, using the quotient rule, we have to solve for</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}}=\frac%
{\|\boldsymbol{x}\|\frac{\partial}{\partial a_{j}}\boldsymbol{x}-\boldsymbol{x%
}\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|}{\|\boldsymbol{x}\|^{2}}~{}." class="ltx_Math" display="block" id="A2.E13.m1.5"><semantics id="A2.E13.m1.5a"><mrow id="A2.E13.m1.5.5.1" xref="A2.E13.m1.5.5.1.1.cmml"><mrow id="A2.E13.m1.5.5.1.1" xref="A2.E13.m1.5.5.1.1.cmml"><mrow id="A2.E13.m1.5.5.1.1.2" xref="A2.E13.m1.5.5.1.1.2.cmml"><mfrac id="A2.E13.m1.5.5.1.1.2.2" xref="A2.E13.m1.5.5.1.1.2.2.cmml"><mo id="A2.E13.m1.5.5.1.1.2.2.2" xref="A2.E13.m1.5.5.1.1.2.2.2.cmml">∂</mo><mrow id="A2.E13.m1.5.5.1.1.2.2.3" xref="A2.E13.m1.5.5.1.1.2.2.3.cmml"><mo id="A2.E13.m1.5.5.1.1.2.2.3.1" rspace="0em" xref="A2.E13.m1.5.5.1.1.2.2.3.1.cmml">∂</mo><msub id="A2.E13.m1.5.5.1.1.2.2.3.2" xref="A2.E13.m1.5.5.1.1.2.2.3.2.cmml"><mi id="A2.E13.m1.5.5.1.1.2.2.3.2.2" xref="A2.E13.m1.5.5.1.1.2.2.3.2.2.cmml">a</mi><mi id="A2.E13.m1.5.5.1.1.2.2.3.2.3" xref="A2.E13.m1.5.5.1.1.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E13.m1.5.5.1.1.2.1" xref="A2.E13.m1.5.5.1.1.2.1.cmml">⁢</mo><mfrac id="A2.E13.m1.1.1" xref="A2.E13.m1.1.1.cmml"><mi id="A2.E13.m1.1.1.3" xref="A2.E13.m1.1.1.3.cmml">𝒙</mi><mrow id="A2.E13.m1.1.1.1.3" xref="A2.E13.m1.1.1.1.2.cmml"><mo id="A2.E13.m1.1.1.1.3.1" stretchy="false" xref="A2.E13.m1.1.1.1.2.1.cmml">‖</mo><mi id="A2.E13.m1.1.1.1.1" xref="A2.E13.m1.1.1.1.1.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" id="A2.E13.m1.1.1.1.3.2" mathvariant="bold" stretchy="false" xref="A2.E13.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A2.E13.m1.5.5.1.1.1" xref="A2.E13.m1.5.5.1.1.1.cmml">=</mo><mfrac id="A2.E13.m1.4.4" xref="A2.E13.m1.4.4.cmml"><mrow id="A2.E13.m1.3.3.2" xref="A2.E13.m1.3.3.2.cmml"><mrow id="A2.E13.m1.3.3.2.4" xref="A2.E13.m1.3.3.2.4.cmml"><mrow id="A2.E13.m1.3.3.2.4.2.2" xref="A2.E13.m1.3.3.2.4.2.1.cmml"><mo id="A2.E13.m1.3.3.2.4.2.2.1" stretchy="false" xref="A2.E13.m1.3.3.2.4.2.1.1.cmml">‖</mo><mi id="A2.E13.m1.2.2.1.1" xref="A2.E13.m1.2.2.1.1.cmml">𝒙</mi><mo id="A2.E13.m1.3.3.2.4.2.2.2" stretchy="false" xref="A2.E13.m1.3.3.2.4.2.1.1.cmml">‖</mo></mrow><mo id="A2.E13.m1.3.3.2.4.1" xref="A2.E13.m1.3.3.2.4.1.cmml">⁢</mo><mfrac id="A2.E13.m1.3.3.2.4.3" xref="A2.E13.m1.3.3.2.4.3.cmml"><mo id="A2.E13.m1.3.3.2.4.3.2" xref="A2.E13.m1.3.3.2.4.3.2.cmml">∂</mo><mrow id="A2.E13.m1.3.3.2.4.3.3" xref="A2.E13.m1.3.3.2.4.3.3.cmml"><mo id="A2.E13.m1.3.3.2.4.3.3.1" rspace="0em" xref="A2.E13.m1.3.3.2.4.3.3.1.cmml">∂</mo><msub id="A2.E13.m1.3.3.2.4.3.3.2" xref="A2.E13.m1.3.3.2.4.3.3.2.cmml"><mi id="A2.E13.m1.3.3.2.4.3.3.2.2" xref="A2.E13.m1.3.3.2.4.3.3.2.2.cmml">a</mi><mi id="A2.E13.m1.3.3.2.4.3.3.2.3" xref="A2.E13.m1.3.3.2.4.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E13.m1.3.3.2.4.1a" xref="A2.E13.m1.3.3.2.4.1.cmml">⁢</mo><mi id="A2.E13.m1.3.3.2.4.4" xref="A2.E13.m1.3.3.2.4.4.cmml">𝒙</mi></mrow><mo id="A2.E13.m1.3.3.2.3" xref="A2.E13.m1.3.3.2.3.cmml">−</mo><mrow id="A2.E13.m1.3.3.2.5" xref="A2.E13.m1.3.3.2.5.cmml"><mi id="A2.E13.m1.3.3.2.5.2" xref="A2.E13.m1.3.3.2.5.2.cmml">𝒙</mi><mo id="A2.E13.m1.3.3.2.5.1" xref="A2.E13.m1.3.3.2.5.1.cmml">⁢</mo><mfrac id="A2.E13.m1.3.3.2.5.3" xref="A2.E13.m1.3.3.2.5.3.cmml"><mo id="A2.E13.m1.3.3.2.5.3.2" xref="A2.E13.m1.3.3.2.5.3.2.cmml">∂</mo><mrow id="A2.E13.m1.3.3.2.5.3.3" xref="A2.E13.m1.3.3.2.5.3.3.cmml"><mo id="A2.E13.m1.3.3.2.5.3.3.1" rspace="0em" xref="A2.E13.m1.3.3.2.5.3.3.1.cmml">∂</mo><msub id="A2.E13.m1.3.3.2.5.3.3.2" xref="A2.E13.m1.3.3.2.5.3.3.2.cmml"><mi id="A2.E13.m1.3.3.2.5.3.3.2.2" xref="A2.E13.m1.3.3.2.5.3.3.2.2.cmml">a</mi><mi id="A2.E13.m1.3.3.2.5.3.3.2.3" xref="A2.E13.m1.3.3.2.5.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E13.m1.3.3.2.5.1a" xref="A2.E13.m1.3.3.2.5.1.cmml">⁢</mo><mrow id="A2.E13.m1.3.3.2.5.4.2" xref="A2.E13.m1.3.3.2.5.4.1.cmml"><mo id="A2.E13.m1.3.3.2.5.4.2.1" stretchy="false" xref="A2.E13.m1.3.3.2.5.4.1.1.cmml">‖</mo><mi id="A2.E13.m1.3.3.2.2" xref="A2.E13.m1.3.3.2.2.cmml">𝒙</mi><mo id="A2.E13.m1.3.3.2.5.4.2.2" stretchy="false" xref="A2.E13.m1.3.3.2.5.4.1.1.cmml">‖</mo></mrow></mrow></mrow><msup id="A2.E13.m1.4.4.3" xref="A2.E13.m1.4.4.3.cmml"><mrow id="A2.E13.m1.4.4.3.3.2" xref="A2.E13.m1.4.4.3.3.1.cmml"><mo id="A2.E13.m1.4.4.3.3.2.1" stretchy="false" xref="A2.E13.m1.4.4.3.3.1.1.cmml">‖</mo><mi id="A2.E13.m1.4.4.3.1" xref="A2.E13.m1.4.4.3.1.cmml">𝒙</mi><mo id="A2.E13.m1.4.4.3.3.2.2" stretchy="false" xref="A2.E13.m1.4.4.3.3.1.1.cmml">‖</mo></mrow><mn id="A2.E13.m1.4.4.3.4" xref="A2.E13.m1.4.4.3.4.cmml">2</mn></msup></mfrac></mrow><mo id="A2.E13.m1.5.5.1.2" lspace="0.330em" xref="A2.E13.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E13.m1.5b"><apply id="A2.E13.m1.5.5.1.1.cmml" xref="A2.E13.m1.5.5.1"><eq id="A2.E13.m1.5.5.1.1.1.cmml" xref="A2.E13.m1.5.5.1.1.1"></eq><apply id="A2.E13.m1.5.5.1.1.2.cmml" xref="A2.E13.m1.5.5.1.1.2"><times id="A2.E13.m1.5.5.1.1.2.1.cmml" xref="A2.E13.m1.5.5.1.1.2.1"></times><apply id="A2.E13.m1.5.5.1.1.2.2.cmml" xref="A2.E13.m1.5.5.1.1.2.2"><divide id="A2.E13.m1.5.5.1.1.2.2.1.cmml" xref="A2.E13.m1.5.5.1.1.2.2"></divide><partialdiff id="A2.E13.m1.5.5.1.1.2.2.2.cmml" xref="A2.E13.m1.5.5.1.1.2.2.2"></partialdiff><apply id="A2.E13.m1.5.5.1.1.2.2.3.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3"><partialdiff id="A2.E13.m1.5.5.1.1.2.2.3.1.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3.1"></partialdiff><apply id="A2.E13.m1.5.5.1.1.2.2.3.2.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3.2"><csymbol cd="ambiguous" id="A2.E13.m1.5.5.1.1.2.2.3.2.1.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3.2">subscript</csymbol><ci id="A2.E13.m1.5.5.1.1.2.2.3.2.2.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3.2.2">𝑎</ci><ci id="A2.E13.m1.5.5.1.1.2.2.3.2.3.cmml" xref="A2.E13.m1.5.5.1.1.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E13.m1.1.1.cmml" xref="A2.E13.m1.1.1"><divide id="A2.E13.m1.1.1.2.cmml" xref="A2.E13.m1.1.1"></divide><ci id="A2.E13.m1.1.1.3.cmml" xref="A2.E13.m1.1.1.3">𝒙</ci><apply id="A2.E13.m1.1.1.1.2.cmml" xref="A2.E13.m1.1.1.1.3"><csymbol cd="latexml" id="A2.E13.m1.1.1.1.2.1.cmml" xref="A2.E13.m1.1.1.1.3.1">norm</csymbol><ci id="A2.E13.m1.1.1.1.1.cmml" xref="A2.E13.m1.1.1.1.1">𝒙</ci></apply></apply></apply><apply id="A2.E13.m1.4.4.cmml" xref="A2.E13.m1.4.4"><divide id="A2.E13.m1.4.4.4.cmml" xref="A2.E13.m1.4.4"></divide><apply id="A2.E13.m1.3.3.2.cmml" xref="A2.E13.m1.3.3.2"><minus id="A2.E13.m1.3.3.2.3.cmml" xref="A2.E13.m1.3.3.2.3"></minus><apply id="A2.E13.m1.3.3.2.4.cmml" xref="A2.E13.m1.3.3.2.4"><times id="A2.E13.m1.3.3.2.4.1.cmml" xref="A2.E13.m1.3.3.2.4.1"></times><apply id="A2.E13.m1.3.3.2.4.2.1.cmml" xref="A2.E13.m1.3.3.2.4.2.2"><csymbol cd="latexml" id="A2.E13.m1.3.3.2.4.2.1.1.cmml" xref="A2.E13.m1.3.3.2.4.2.2.1">norm</csymbol><ci id="A2.E13.m1.2.2.1.1.cmml" xref="A2.E13.m1.2.2.1.1">𝒙</ci></apply><apply id="A2.E13.m1.3.3.2.4.3.cmml" xref="A2.E13.m1.3.3.2.4.3"><divide id="A2.E13.m1.3.3.2.4.3.1.cmml" xref="A2.E13.m1.3.3.2.4.3"></divide><partialdiff id="A2.E13.m1.3.3.2.4.3.2.cmml" xref="A2.E13.m1.3.3.2.4.3.2"></partialdiff><apply id="A2.E13.m1.3.3.2.4.3.3.cmml" xref="A2.E13.m1.3.3.2.4.3.3"><partialdiff id="A2.E13.m1.3.3.2.4.3.3.1.cmml" xref="A2.E13.m1.3.3.2.4.3.3.1"></partialdiff><apply id="A2.E13.m1.3.3.2.4.3.3.2.cmml" xref="A2.E13.m1.3.3.2.4.3.3.2"><csymbol cd="ambiguous" id="A2.E13.m1.3.3.2.4.3.3.2.1.cmml" xref="A2.E13.m1.3.3.2.4.3.3.2">subscript</csymbol><ci id="A2.E13.m1.3.3.2.4.3.3.2.2.cmml" xref="A2.E13.m1.3.3.2.4.3.3.2.2">𝑎</ci><ci id="A2.E13.m1.3.3.2.4.3.3.2.3.cmml" xref="A2.E13.m1.3.3.2.4.3.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.E13.m1.3.3.2.4.4.cmml" xref="A2.E13.m1.3.3.2.4.4">𝒙</ci></apply><apply id="A2.E13.m1.3.3.2.5.cmml" xref="A2.E13.m1.3.3.2.5"><times id="A2.E13.m1.3.3.2.5.1.cmml" xref="A2.E13.m1.3.3.2.5.1"></times><ci id="A2.E13.m1.3.3.2.5.2.cmml" xref="A2.E13.m1.3.3.2.5.2">𝒙</ci><apply id="A2.E13.m1.3.3.2.5.3.cmml" xref="A2.E13.m1.3.3.2.5.3"><divide id="A2.E13.m1.3.3.2.5.3.1.cmml" xref="A2.E13.m1.3.3.2.5.3"></divide><partialdiff id="A2.E13.m1.3.3.2.5.3.2.cmml" xref="A2.E13.m1.3.3.2.5.3.2"></partialdiff><apply id="A2.E13.m1.3.3.2.5.3.3.cmml" xref="A2.E13.m1.3.3.2.5.3.3"><partialdiff id="A2.E13.m1.3.3.2.5.3.3.1.cmml" xref="A2.E13.m1.3.3.2.5.3.3.1"></partialdiff><apply id="A2.E13.m1.3.3.2.5.3.3.2.cmml" xref="A2.E13.m1.3.3.2.5.3.3.2"><csymbol cd="ambiguous" id="A2.E13.m1.3.3.2.5.3.3.2.1.cmml" xref="A2.E13.m1.3.3.2.5.3.3.2">subscript</csymbol><ci id="A2.E13.m1.3.3.2.5.3.3.2.2.cmml" xref="A2.E13.m1.3.3.2.5.3.3.2.2">𝑎</ci><ci id="A2.E13.m1.3.3.2.5.3.3.2.3.cmml" xref="A2.E13.m1.3.3.2.5.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E13.m1.3.3.2.5.4.1.cmml" xref="A2.E13.m1.3.3.2.5.4.2"><csymbol cd="latexml" id="A2.E13.m1.3.3.2.5.4.1.1.cmml" xref="A2.E13.m1.3.3.2.5.4.2.1">norm</csymbol><ci id="A2.E13.m1.3.3.2.2.cmml" xref="A2.E13.m1.3.3.2.2">𝒙</ci></apply></apply></apply><apply id="A2.E13.m1.4.4.3.cmml" xref="A2.E13.m1.4.4.3"><csymbol cd="ambiguous" id="A2.E13.m1.4.4.3.2.cmml" xref="A2.E13.m1.4.4.3">superscript</csymbol><apply id="A2.E13.m1.4.4.3.3.1.cmml" xref="A2.E13.m1.4.4.3.3.2"><csymbol cd="latexml" id="A2.E13.m1.4.4.3.3.1.1.cmml" xref="A2.E13.m1.4.4.3.3.2.1">norm</csymbol><ci id="A2.E13.m1.4.4.3.1.cmml" xref="A2.E13.m1.4.4.3.1">𝒙</ci></apply><cn id="A2.E13.m1.4.4.3.4.cmml" type="integer" xref="A2.E13.m1.4.4.3.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E13.m1.5c">\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}}=\frac%
{\|\boldsymbol{x}\|\frac{\partial}{\partial a_{j}}\boldsymbol{x}-\boldsymbol{x%
}\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|}{\|\boldsymbol{x}\|^{2}}~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E13.m1.5d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x bold_∥ end_ARG = divide start_ARG ∥ bold_italic_x ∥ divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x - bold_italic_x divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_italic_x ∥ end_ARG start_ARG ∥ bold_italic_x ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">We begin with solving for <math alttext="\frac{\partial}{\partial a_{j}}\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.1"><semantics id="A2.SS1.p2.1.m1.1a"><mrow id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml"><mfrac id="A2.SS1.p2.1.m1.1.1.2" xref="A2.SS1.p2.1.m1.1.1.2.cmml"><mo id="A2.SS1.p2.1.m1.1.1.2.2" xref="A2.SS1.p2.1.m1.1.1.2.2.cmml">∂</mo><mrow id="A2.SS1.p2.1.m1.1.1.2.3" xref="A2.SS1.p2.1.m1.1.1.2.3.cmml"><mo id="A2.SS1.p2.1.m1.1.1.2.3.1" rspace="0em" xref="A2.SS1.p2.1.m1.1.1.2.3.1.cmml">∂</mo><msub id="A2.SS1.p2.1.m1.1.1.2.3.2" xref="A2.SS1.p2.1.m1.1.1.2.3.2.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2.3.2.2" xref="A2.SS1.p2.1.m1.1.1.2.3.2.2.cmml">a</mi><mi id="A2.SS1.p2.1.m1.1.1.2.3.2.3" xref="A2.SS1.p2.1.m1.1.1.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.SS1.p2.1.m1.1.1.1" xref="A2.SS1.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.SS1.p2.1.m1.1.1.3" xref="A2.SS1.p2.1.m1.1.1.3.cmml">𝒙</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><apply id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1"><times id="A2.SS1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1.1"></times><apply id="A2.SS1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2"><divide id="A2.SS1.p2.1.m1.1.1.2.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2"></divide><partialdiff id="A2.SS1.p2.1.m1.1.1.2.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2"></partialdiff><apply id="A2.SS1.p2.1.m1.1.1.2.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3"><partialdiff id="A2.SS1.p2.1.m1.1.1.2.3.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.1"></partialdiff><apply id="A2.SS1.p2.1.m1.1.1.2.3.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.2.3.2.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p2.1.m1.1.1.2.3.2.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.2.2">𝑎</ci><ci id="A2.SS1.p2.1.m1.1.1.2.3.2.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.SS1.p2.1.m1.1.1.3.cmml" xref="A2.SS1.p2.1.m1.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">\frac{\partial}{\partial a_{j}}\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x</annotation></semantics></math> given as</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial}{\partial a_{j}}\boldsymbol{x}=\frac{\partial}{\partial a_{j}}%
\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]W_{\text{%
proj}}" class="ltx_Math" display="block" id="A2.E14.m1.3"><semantics id="A2.E14.m1.3a"><mrow id="A2.E14.m1.3.4" xref="A2.E14.m1.3.4.cmml"><mrow id="A2.E14.m1.3.4.2" xref="A2.E14.m1.3.4.2.cmml"><mfrac id="A2.E14.m1.3.4.2.2" xref="A2.E14.m1.3.4.2.2.cmml"><mo id="A2.E14.m1.3.4.2.2.2" xref="A2.E14.m1.3.4.2.2.2.cmml">∂</mo><mrow id="A2.E14.m1.3.4.2.2.3" xref="A2.E14.m1.3.4.2.2.3.cmml"><mo id="A2.E14.m1.3.4.2.2.3.1" rspace="0em" xref="A2.E14.m1.3.4.2.2.3.1.cmml">∂</mo><msub id="A2.E14.m1.3.4.2.2.3.2" xref="A2.E14.m1.3.4.2.2.3.2.cmml"><mi id="A2.E14.m1.3.4.2.2.3.2.2" xref="A2.E14.m1.3.4.2.2.3.2.2.cmml">a</mi><mi id="A2.E14.m1.3.4.2.2.3.2.3" xref="A2.E14.m1.3.4.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E14.m1.3.4.2.1" xref="A2.E14.m1.3.4.2.1.cmml">⁢</mo><mi id="A2.E14.m1.3.4.2.3" xref="A2.E14.m1.3.4.2.3.cmml">𝒙</mi></mrow><mo id="A2.E14.m1.3.4.1" xref="A2.E14.m1.3.4.1.cmml">=</mo><mrow id="A2.E14.m1.3.4.3" xref="A2.E14.m1.3.4.3.cmml"><mfrac id="A2.E14.m1.3.4.3.2" xref="A2.E14.m1.3.4.3.2.cmml"><mo id="A2.E14.m1.3.4.3.2.2" xref="A2.E14.m1.3.4.3.2.2.cmml">∂</mo><mrow id="A2.E14.m1.3.4.3.2.3" xref="A2.E14.m1.3.4.3.2.3.cmml"><mo id="A2.E14.m1.3.4.3.2.3.1" rspace="0em" xref="A2.E14.m1.3.4.3.2.3.1.cmml">∂</mo><msub id="A2.E14.m1.3.4.3.2.3.2" xref="A2.E14.m1.3.4.3.2.3.2.cmml"><mi id="A2.E14.m1.3.4.3.2.3.2.2" xref="A2.E14.m1.3.4.3.2.3.2.2.cmml">a</mi><mi id="A2.E14.m1.3.4.3.2.3.2.3" xref="A2.E14.m1.3.4.3.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E14.m1.3.4.3.1" xref="A2.E14.m1.3.4.3.1.cmml">⁢</mo><msub id="A2.E14.m1.3.4.3.3" xref="A2.E14.m1.3.4.3.3.cmml"><mtext id="A2.E14.m1.3.4.3.3.2" xref="A2.E14.m1.3.4.3.3.2a.cmml">LayerNorm</mtext><mrow id="A2.E14.m1.2.2.2.4" xref="A2.E14.m1.2.2.2.3.cmml"><mi id="A2.E14.m1.1.1.1.1" xref="A2.E14.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.E14.m1.2.2.2.4.1" xref="A2.E14.m1.2.2.2.3.cmml">,</mo><mi id="A2.E14.m1.2.2.2.2" xref="A2.E14.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E14.m1.3.4.3.1a" xref="A2.E14.m1.3.4.3.1.cmml">⁢</mo><mrow id="A2.E14.m1.3.4.3.4.2" xref="A2.E14.m1.3.4.3.4.1.cmml"><mo id="A2.E14.m1.3.4.3.4.2.1" stretchy="false" xref="A2.E14.m1.3.4.3.4.1.1.cmml">[</mo><mi id="A2.E14.m1.3.3" xref="A2.E14.m1.3.3.cmml">𝐱</mi><mo id="A2.E14.m1.3.4.3.4.2.2" stretchy="false" xref="A2.E14.m1.3.4.3.4.1.1.cmml">]</mo></mrow><mo id="A2.E14.m1.3.4.3.1b" xref="A2.E14.m1.3.4.3.1.cmml">⁢</mo><msub id="A2.E14.m1.3.4.3.5" xref="A2.E14.m1.3.4.3.5.cmml"><mi id="A2.E14.m1.3.4.3.5.2" xref="A2.E14.m1.3.4.3.5.2.cmml">W</mi><mtext id="A2.E14.m1.3.4.3.5.3" xref="A2.E14.m1.3.4.3.5.3a.cmml">proj</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E14.m1.3b"><apply id="A2.E14.m1.3.4.cmml" xref="A2.E14.m1.3.4"><eq id="A2.E14.m1.3.4.1.cmml" xref="A2.E14.m1.3.4.1"></eq><apply id="A2.E14.m1.3.4.2.cmml" xref="A2.E14.m1.3.4.2"><times id="A2.E14.m1.3.4.2.1.cmml" xref="A2.E14.m1.3.4.2.1"></times><apply id="A2.E14.m1.3.4.2.2.cmml" xref="A2.E14.m1.3.4.2.2"><divide id="A2.E14.m1.3.4.2.2.1.cmml" xref="A2.E14.m1.3.4.2.2"></divide><partialdiff id="A2.E14.m1.3.4.2.2.2.cmml" xref="A2.E14.m1.3.4.2.2.2"></partialdiff><apply id="A2.E14.m1.3.4.2.2.3.cmml" xref="A2.E14.m1.3.4.2.2.3"><partialdiff id="A2.E14.m1.3.4.2.2.3.1.cmml" xref="A2.E14.m1.3.4.2.2.3.1"></partialdiff><apply id="A2.E14.m1.3.4.2.2.3.2.cmml" xref="A2.E14.m1.3.4.2.2.3.2"><csymbol cd="ambiguous" id="A2.E14.m1.3.4.2.2.3.2.1.cmml" xref="A2.E14.m1.3.4.2.2.3.2">subscript</csymbol><ci id="A2.E14.m1.3.4.2.2.3.2.2.cmml" xref="A2.E14.m1.3.4.2.2.3.2.2">𝑎</ci><ci id="A2.E14.m1.3.4.2.2.3.2.3.cmml" xref="A2.E14.m1.3.4.2.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.E14.m1.3.4.2.3.cmml" xref="A2.E14.m1.3.4.2.3">𝒙</ci></apply><apply id="A2.E14.m1.3.4.3.cmml" xref="A2.E14.m1.3.4.3"><times id="A2.E14.m1.3.4.3.1.cmml" xref="A2.E14.m1.3.4.3.1"></times><apply id="A2.E14.m1.3.4.3.2.cmml" xref="A2.E14.m1.3.4.3.2"><divide id="A2.E14.m1.3.4.3.2.1.cmml" xref="A2.E14.m1.3.4.3.2"></divide><partialdiff id="A2.E14.m1.3.4.3.2.2.cmml" xref="A2.E14.m1.3.4.3.2.2"></partialdiff><apply id="A2.E14.m1.3.4.3.2.3.cmml" xref="A2.E14.m1.3.4.3.2.3"><partialdiff id="A2.E14.m1.3.4.3.2.3.1.cmml" xref="A2.E14.m1.3.4.3.2.3.1"></partialdiff><apply id="A2.E14.m1.3.4.3.2.3.2.cmml" xref="A2.E14.m1.3.4.3.2.3.2"><csymbol cd="ambiguous" id="A2.E14.m1.3.4.3.2.3.2.1.cmml" xref="A2.E14.m1.3.4.3.2.3.2">subscript</csymbol><ci id="A2.E14.m1.3.4.3.2.3.2.2.cmml" xref="A2.E14.m1.3.4.3.2.3.2.2">𝑎</ci><ci id="A2.E14.m1.3.4.3.2.3.2.3.cmml" xref="A2.E14.m1.3.4.3.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E14.m1.3.4.3.3.cmml" xref="A2.E14.m1.3.4.3.3"><csymbol cd="ambiguous" id="A2.E14.m1.3.4.3.3.1.cmml" xref="A2.E14.m1.3.4.3.3">subscript</csymbol><ci id="A2.E14.m1.3.4.3.3.2a.cmml" xref="A2.E14.m1.3.4.3.3.2"><mtext id="A2.E14.m1.3.4.3.3.2.cmml" xref="A2.E14.m1.3.4.3.3.2">LayerNorm</mtext></ci><list id="A2.E14.m1.2.2.2.3.cmml" xref="A2.E14.m1.2.2.2.4"><ci id="A2.E14.m1.1.1.1.1.cmml" xref="A2.E14.m1.1.1.1.1">𝜸</ci><ci id="A2.E14.m1.2.2.2.2.cmml" xref="A2.E14.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.E14.m1.3.4.3.4.1.cmml" xref="A2.E14.m1.3.4.3.4.2"><csymbol cd="latexml" id="A2.E14.m1.3.4.3.4.1.1.cmml" xref="A2.E14.m1.3.4.3.4.2.1">delimited-[]</csymbol><ci id="A2.E14.m1.3.3.cmml" xref="A2.E14.m1.3.3">𝐱</ci></apply><apply id="A2.E14.m1.3.4.3.5.cmml" xref="A2.E14.m1.3.4.3.5"><csymbol cd="ambiguous" id="A2.E14.m1.3.4.3.5.1.cmml" xref="A2.E14.m1.3.4.3.5">subscript</csymbol><ci id="A2.E14.m1.3.4.3.5.2.cmml" xref="A2.E14.m1.3.4.3.5.2">𝑊</ci><ci id="A2.E14.m1.3.4.3.5.3a.cmml" xref="A2.E14.m1.3.4.3.5.3"><mtext id="A2.E14.m1.3.4.3.5.3.cmml" mathsize="70%" xref="A2.E14.m1.3.4.3.5.3">proj</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E14.m1.3c">\frac{\partial}{\partial a_{j}}\boldsymbol{x}=\frac{\partial}{\partial a_{j}}%
\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]W_{\text{%
proj}}</annotation><annotation encoding="application/x-llamapun" id="A2.E14.m1.3d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x = divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_x ] italic_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">where the LayerNorm operation leads to</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="A2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]=\frac{%
\mathbf{x}-\mu_{\mathbf{x}}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}\circ\boldsymbol{%
\gamma}+\boldsymbol{\beta}" class="ltx_Math" display="block" id="A2.E15.m1.4"><semantics id="A2.E15.m1.4a"><mrow id="A2.E15.m1.4.5" xref="A2.E15.m1.4.5.cmml"><mrow id="A2.E15.m1.4.5.2" xref="A2.E15.m1.4.5.2.cmml"><msub id="A2.E15.m1.4.5.2.2" xref="A2.E15.m1.4.5.2.2.cmml"><mtext id="A2.E15.m1.4.5.2.2.2" xref="A2.E15.m1.4.5.2.2.2a.cmml">LayerNorm</mtext><mrow id="A2.E15.m1.2.2.2.4" xref="A2.E15.m1.2.2.2.3.cmml"><mi id="A2.E15.m1.1.1.1.1" xref="A2.E15.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.E15.m1.2.2.2.4.1" xref="A2.E15.m1.2.2.2.3.cmml">,</mo><mi id="A2.E15.m1.2.2.2.2" xref="A2.E15.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E15.m1.4.5.2.1" xref="A2.E15.m1.4.5.2.1.cmml">⁢</mo><mrow id="A2.E15.m1.4.5.2.3.2" xref="A2.E15.m1.4.5.2.3.1.cmml"><mo id="A2.E15.m1.4.5.2.3.2.1" stretchy="false" xref="A2.E15.m1.4.5.2.3.1.1.cmml">[</mo><mi id="A2.E15.m1.4.4" xref="A2.E15.m1.4.4.cmml">𝐱</mi><mo id="A2.E15.m1.4.5.2.3.2.2" stretchy="false" xref="A2.E15.m1.4.5.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="A2.E15.m1.4.5.1" xref="A2.E15.m1.4.5.1.cmml">=</mo><mrow id="A2.E15.m1.4.5.3" xref="A2.E15.m1.4.5.3.cmml"><mrow id="A2.E15.m1.4.5.3.2" xref="A2.E15.m1.4.5.3.2.cmml"><mfrac id="A2.E15.m1.3.3" xref="A2.E15.m1.3.3.cmml"><mrow id="A2.E15.m1.3.3.3" xref="A2.E15.m1.3.3.3.cmml"><mi id="A2.E15.m1.3.3.3.2" xref="A2.E15.m1.3.3.3.2.cmml">𝐱</mi><mo id="A2.E15.m1.3.3.3.1" xref="A2.E15.m1.3.3.3.1.cmml">−</mo><msub id="A2.E15.m1.3.3.3.3" xref="A2.E15.m1.3.3.3.3.cmml"><mi id="A2.E15.m1.3.3.3.3.2" xref="A2.E15.m1.3.3.3.3.2.cmml">μ</mi><mi id="A2.E15.m1.3.3.3.3.3" xref="A2.E15.m1.3.3.3.3.3.cmml">𝐱</mi></msub></mrow><mrow id="A2.E15.m1.3.3.1.1" xref="A2.E15.m1.3.3.1.2.cmml"><mo id="A2.E15.m1.3.3.1.1.2" stretchy="false" xref="A2.E15.m1.3.3.1.2.1.cmml">‖</mo><mrow id="A2.E15.m1.3.3.1.1.1" xref="A2.E15.m1.3.3.1.1.1.cmml"><mi id="A2.E15.m1.3.3.1.1.1.2" xref="A2.E15.m1.3.3.1.1.1.2.cmml">𝐱</mi><mo id="A2.E15.m1.3.3.1.1.1.1" xref="A2.E15.m1.3.3.1.1.1.1.cmml">−</mo><msub id="A2.E15.m1.3.3.1.1.1.3" xref="A2.E15.m1.3.3.1.1.1.3.cmml"><mi id="A2.E15.m1.3.3.1.1.1.3.2" xref="A2.E15.m1.3.3.1.1.1.3.2.cmml">μ</mi><mi id="A2.E15.m1.3.3.1.1.1.3.3" xref="A2.E15.m1.3.3.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E15.m1.3.3.1.1.3" stretchy="false" xref="A2.E15.m1.3.3.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="A2.E15.m1.4.5.3.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E15.m1.4.5.3.2.1.cmml">∘</mo><mi id="A2.E15.m1.4.5.3.2.2" xref="A2.E15.m1.4.5.3.2.2.cmml">𝜸</mi></mrow><mo id="A2.E15.m1.4.5.3.1" xref="A2.E15.m1.4.5.3.1.cmml">+</mo><mi id="A2.E15.m1.4.5.3.3" xref="A2.E15.m1.4.5.3.3.cmml">𝜷</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E15.m1.4b"><apply id="A2.E15.m1.4.5.cmml" xref="A2.E15.m1.4.5"><eq id="A2.E15.m1.4.5.1.cmml" xref="A2.E15.m1.4.5.1"></eq><apply id="A2.E15.m1.4.5.2.cmml" xref="A2.E15.m1.4.5.2"><times id="A2.E15.m1.4.5.2.1.cmml" xref="A2.E15.m1.4.5.2.1"></times><apply id="A2.E15.m1.4.5.2.2.cmml" xref="A2.E15.m1.4.5.2.2"><csymbol cd="ambiguous" id="A2.E15.m1.4.5.2.2.1.cmml" xref="A2.E15.m1.4.5.2.2">subscript</csymbol><ci id="A2.E15.m1.4.5.2.2.2a.cmml" xref="A2.E15.m1.4.5.2.2.2"><mtext id="A2.E15.m1.4.5.2.2.2.cmml" xref="A2.E15.m1.4.5.2.2.2">LayerNorm</mtext></ci><list id="A2.E15.m1.2.2.2.3.cmml" xref="A2.E15.m1.2.2.2.4"><ci id="A2.E15.m1.1.1.1.1.cmml" xref="A2.E15.m1.1.1.1.1">𝜸</ci><ci id="A2.E15.m1.2.2.2.2.cmml" xref="A2.E15.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.E15.m1.4.5.2.3.1.cmml" xref="A2.E15.m1.4.5.2.3.2"><csymbol cd="latexml" id="A2.E15.m1.4.5.2.3.1.1.cmml" xref="A2.E15.m1.4.5.2.3.2.1">delimited-[]</csymbol><ci id="A2.E15.m1.4.4.cmml" xref="A2.E15.m1.4.4">𝐱</ci></apply></apply><apply id="A2.E15.m1.4.5.3.cmml" xref="A2.E15.m1.4.5.3"><plus id="A2.E15.m1.4.5.3.1.cmml" xref="A2.E15.m1.4.5.3.1"></plus><apply id="A2.E15.m1.4.5.3.2.cmml" xref="A2.E15.m1.4.5.3.2"><compose id="A2.E15.m1.4.5.3.2.1.cmml" xref="A2.E15.m1.4.5.3.2.1"></compose><apply id="A2.E15.m1.3.3.cmml" xref="A2.E15.m1.3.3"><divide id="A2.E15.m1.3.3.2.cmml" xref="A2.E15.m1.3.3"></divide><apply id="A2.E15.m1.3.3.3.cmml" xref="A2.E15.m1.3.3.3"><minus id="A2.E15.m1.3.3.3.1.cmml" xref="A2.E15.m1.3.3.3.1"></minus><ci id="A2.E15.m1.3.3.3.2.cmml" xref="A2.E15.m1.3.3.3.2">𝐱</ci><apply id="A2.E15.m1.3.3.3.3.cmml" xref="A2.E15.m1.3.3.3.3"><csymbol cd="ambiguous" id="A2.E15.m1.3.3.3.3.1.cmml" xref="A2.E15.m1.3.3.3.3">subscript</csymbol><ci id="A2.E15.m1.3.3.3.3.2.cmml" xref="A2.E15.m1.3.3.3.3.2">𝜇</ci><ci id="A2.E15.m1.3.3.3.3.3.cmml" xref="A2.E15.m1.3.3.3.3.3">𝐱</ci></apply></apply><apply id="A2.E15.m1.3.3.1.2.cmml" xref="A2.E15.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E15.m1.3.3.1.2.1.cmml" xref="A2.E15.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E15.m1.3.3.1.1.1.cmml" xref="A2.E15.m1.3.3.1.1.1"><minus id="A2.E15.m1.3.3.1.1.1.1.cmml" xref="A2.E15.m1.3.3.1.1.1.1"></minus><ci id="A2.E15.m1.3.3.1.1.1.2.cmml" xref="A2.E15.m1.3.3.1.1.1.2">𝐱</ci><apply id="A2.E15.m1.3.3.1.1.1.3.cmml" xref="A2.E15.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E15.m1.3.3.1.1.1.3.1.cmml" xref="A2.E15.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A2.E15.m1.3.3.1.1.1.3.2.cmml" xref="A2.E15.m1.3.3.1.1.1.3.2">𝜇</ci><ci id="A2.E15.m1.3.3.1.1.1.3.3.cmml" xref="A2.E15.m1.3.3.1.1.1.3.3">𝐱</ci></apply></apply></apply></apply><ci id="A2.E15.m1.4.5.3.2.2.cmml" xref="A2.E15.m1.4.5.3.2.2">𝜸</ci></apply><ci id="A2.E15.m1.4.5.3.3.cmml" xref="A2.E15.m1.4.5.3.3">𝜷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E15.m1.4c">\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]=\frac{%
\mathbf{x}-\mu_{\mathbf{x}}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}\circ\boldsymbol{%
\gamma}+\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="A2.E15.m1.4d">LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_x ] = divide start_ARG bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG ∘ bold_italic_γ + bold_italic_β</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p4.4">with average <math alttext="\mu_{\mathbf{x}}" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><msub id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mi id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml">μ</mi><mi id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">𝐱</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p4.1.m1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2">𝜇</ci><ci id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">\mu_{\mathbf{x}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT</annotation></semantics></math> over elements of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A2.SS1.p4.2.m2.1"><semantics id="A2.SS1.p4.2.m2.1a"><mi id="A2.SS1.p4.2.m2.1.1" xref="A2.SS1.p4.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.1b"><ci id="A2.SS1.p4.2.m2.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.2.m2.1d">bold_x</annotation></semantics></math>, element-wise scaling via <math alttext="\boldsymbol{\gamma}" class="ltx_Math" display="inline" id="A2.SS1.p4.3.m3.1"><semantics id="A2.SS1.p4.3.m3.1a"><mi id="A2.SS1.p4.3.m3.1.1" xref="A2.SS1.p4.3.m3.1.1.cmml">𝜸</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.3.m3.1b"><ci id="A2.SS1.p4.3.m3.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1">𝜸</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.3.m3.1c">\boldsymbol{\gamma}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.3.m3.1d">bold_italic_γ</annotation></semantics></math> and bias term <math alttext="\boldsymbol{\beta}" class="ltx_Math" display="inline" id="A2.SS1.p4.4.m4.1"><semantics id="A2.SS1.p4.4.m4.1a"><mi id="A2.SS1.p4.4.m4.1.1" xref="A2.SS1.p4.4.m4.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.4.m4.1b"><ci id="A2.SS1.p4.4.m4.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.4.m4.1c">\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.4.m4.1d">bold_italic_β</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<p class="ltx_p" id="A2.SS1.p5.1">Applying LayerNorm to a single latent component vector <math alttext="\mathbf{v}_{j}" class="ltx_Math" display="inline" id="A2.SS1.p5.1.m1.1"><semantics id="A2.SS1.p5.1.m1.1a"><msub id="A2.SS1.p5.1.m1.1.1" xref="A2.SS1.p5.1.m1.1.1.cmml"><mi id="A2.SS1.p5.1.m1.1.1.2" xref="A2.SS1.p5.1.m1.1.1.2.cmml">𝐯</mi><mi id="A2.SS1.p5.1.m1.1.1.3" xref="A2.SS1.p5.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.1.m1.1b"><apply id="A2.SS1.p5.1.m1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.1.m1.1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p5.1.m1.1.1.2.cmml" xref="A2.SS1.p5.1.m1.1.1.2">𝐯</ci><ci id="A2.SS1.p5.1.m1.1.1.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.1.m1.1c">\mathbf{v}_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.1.m1.1d">bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> results in</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{v}_{j}]=%
\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}}{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j%
}}\|}\circ\boldsymbol{\gamma}+\boldsymbol{\beta}~{}." class="ltx_Math" display="block" id="A2.E16.m1.4"><semantics id="A2.E16.m1.4a"><mrow id="A2.E16.m1.4.4.1" xref="A2.E16.m1.4.4.1.1.cmml"><mrow id="A2.E16.m1.4.4.1.1" xref="A2.E16.m1.4.4.1.1.cmml"><mrow id="A2.E16.m1.4.4.1.1.1" xref="A2.E16.m1.4.4.1.1.1.cmml"><msub id="A2.E16.m1.4.4.1.1.1.3" xref="A2.E16.m1.4.4.1.1.1.3.cmml"><mtext id="A2.E16.m1.4.4.1.1.1.3.2" xref="A2.E16.m1.4.4.1.1.1.3.2a.cmml">LayerNorm</mtext><mrow id="A2.E16.m1.2.2.2.4" xref="A2.E16.m1.2.2.2.3.cmml"><mi id="A2.E16.m1.1.1.1.1" xref="A2.E16.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.E16.m1.2.2.2.4.1" xref="A2.E16.m1.2.2.2.3.cmml">,</mo><mi id="A2.E16.m1.2.2.2.2" xref="A2.E16.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E16.m1.4.4.1.1.1.2" xref="A2.E16.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A2.E16.m1.4.4.1.1.1.1.1" xref="A2.E16.m1.4.4.1.1.1.1.2.cmml"><mo id="A2.E16.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="A2.E16.m1.4.4.1.1.1.1.2.1.cmml">[</mo><msub id="A2.E16.m1.4.4.1.1.1.1.1.1" xref="A2.E16.m1.4.4.1.1.1.1.1.1.cmml"><mi id="A2.E16.m1.4.4.1.1.1.1.1.1.2" xref="A2.E16.m1.4.4.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="A2.E16.m1.4.4.1.1.1.1.1.1.3" xref="A2.E16.m1.4.4.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A2.E16.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="A2.E16.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A2.E16.m1.4.4.1.1.2" xref="A2.E16.m1.4.4.1.1.2.cmml">=</mo><mrow id="A2.E16.m1.4.4.1.1.3" xref="A2.E16.m1.4.4.1.1.3.cmml"><mrow id="A2.E16.m1.4.4.1.1.3.2" xref="A2.E16.m1.4.4.1.1.3.2.cmml"><mfrac id="A2.E16.m1.3.3" xref="A2.E16.m1.3.3.cmml"><mrow id="A2.E16.m1.3.3.3" xref="A2.E16.m1.3.3.3.cmml"><msub id="A2.E16.m1.3.3.3.2" xref="A2.E16.m1.3.3.3.2.cmml"><mi id="A2.E16.m1.3.3.3.2.2" xref="A2.E16.m1.3.3.3.2.2.cmml">𝐯</mi><mi id="A2.E16.m1.3.3.3.2.3" xref="A2.E16.m1.3.3.3.2.3.cmml">j</mi></msub><mo id="A2.E16.m1.3.3.3.1" xref="A2.E16.m1.3.3.3.1.cmml">−</mo><msub id="A2.E16.m1.3.3.3.3" xref="A2.E16.m1.3.3.3.3.cmml"><mi id="A2.E16.m1.3.3.3.3.2" xref="A2.E16.m1.3.3.3.3.2.cmml">μ</mi><msub id="A2.E16.m1.3.3.3.3.3" xref="A2.E16.m1.3.3.3.3.3.cmml"><mi id="A2.E16.m1.3.3.3.3.3.2" xref="A2.E16.m1.3.3.3.3.3.2.cmml">𝐯</mi><mi id="A2.E16.m1.3.3.3.3.3.3" xref="A2.E16.m1.3.3.3.3.3.3.cmml">j</mi></msub></msub></mrow><mrow id="A2.E16.m1.3.3.1.1" xref="A2.E16.m1.3.3.1.2.cmml"><mo id="A2.E16.m1.3.3.1.1.2" stretchy="false" xref="A2.E16.m1.3.3.1.2.1.cmml">‖</mo><mrow id="A2.E16.m1.3.3.1.1.1" xref="A2.E16.m1.3.3.1.1.1.cmml"><msub id="A2.E16.m1.3.3.1.1.1.2" xref="A2.E16.m1.3.3.1.1.1.2.cmml"><mi id="A2.E16.m1.3.3.1.1.1.2.2" xref="A2.E16.m1.3.3.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E16.m1.3.3.1.1.1.2.3" xref="A2.E16.m1.3.3.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E16.m1.3.3.1.1.1.1" xref="A2.E16.m1.3.3.1.1.1.1.cmml">−</mo><msub id="A2.E16.m1.3.3.1.1.1.3" xref="A2.E16.m1.3.3.1.1.1.3.cmml"><mi id="A2.E16.m1.3.3.1.1.1.3.2" xref="A2.E16.m1.3.3.1.1.1.3.2.cmml">μ</mi><msub id="A2.E16.m1.3.3.1.1.1.3.3" xref="A2.E16.m1.3.3.1.1.1.3.3.cmml"><mi id="A2.E16.m1.3.3.1.1.1.3.3.2" xref="A2.E16.m1.3.3.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E16.m1.3.3.1.1.1.3.3.3" xref="A2.E16.m1.3.3.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E16.m1.3.3.1.1.3" stretchy="false" xref="A2.E16.m1.3.3.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="A2.E16.m1.4.4.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E16.m1.4.4.1.1.3.2.1.cmml">∘</mo><mi id="A2.E16.m1.4.4.1.1.3.2.2" xref="A2.E16.m1.4.4.1.1.3.2.2.cmml">𝜸</mi></mrow><mo id="A2.E16.m1.4.4.1.1.3.1" xref="A2.E16.m1.4.4.1.1.3.1.cmml">+</mo><mi id="A2.E16.m1.4.4.1.1.3.3" xref="A2.E16.m1.4.4.1.1.3.3.cmml">𝜷</mi></mrow></mrow><mo id="A2.E16.m1.4.4.1.2" lspace="0.330em" xref="A2.E16.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E16.m1.4b"><apply id="A2.E16.m1.4.4.1.1.cmml" xref="A2.E16.m1.4.4.1"><eq id="A2.E16.m1.4.4.1.1.2.cmml" xref="A2.E16.m1.4.4.1.1.2"></eq><apply id="A2.E16.m1.4.4.1.1.1.cmml" xref="A2.E16.m1.4.4.1.1.1"><times id="A2.E16.m1.4.4.1.1.1.2.cmml" xref="A2.E16.m1.4.4.1.1.1.2"></times><apply id="A2.E16.m1.4.4.1.1.1.3.cmml" xref="A2.E16.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A2.E16.m1.4.4.1.1.1.3.1.cmml" xref="A2.E16.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A2.E16.m1.4.4.1.1.1.3.2a.cmml" xref="A2.E16.m1.4.4.1.1.1.3.2"><mtext id="A2.E16.m1.4.4.1.1.1.3.2.cmml" xref="A2.E16.m1.4.4.1.1.1.3.2">LayerNorm</mtext></ci><list id="A2.E16.m1.2.2.2.3.cmml" xref="A2.E16.m1.2.2.2.4"><ci id="A2.E16.m1.1.1.1.1.cmml" xref="A2.E16.m1.1.1.1.1">𝜸</ci><ci id="A2.E16.m1.2.2.2.2.cmml" xref="A2.E16.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.E16.m1.4.4.1.1.1.1.2.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="A2.E16.m1.4.4.1.1.1.1.2.1.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E16.m1.4.4.1.1.1.1.1.1.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E16.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E16.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1.1.2">𝐯</ci><ci id="A2.E16.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A2.E16.m1.4.4.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="A2.E16.m1.4.4.1.1.3.cmml" xref="A2.E16.m1.4.4.1.1.3"><plus id="A2.E16.m1.4.4.1.1.3.1.cmml" xref="A2.E16.m1.4.4.1.1.3.1"></plus><apply id="A2.E16.m1.4.4.1.1.3.2.cmml" xref="A2.E16.m1.4.4.1.1.3.2"><compose id="A2.E16.m1.4.4.1.1.3.2.1.cmml" xref="A2.E16.m1.4.4.1.1.3.2.1"></compose><apply id="A2.E16.m1.3.3.cmml" xref="A2.E16.m1.3.3"><divide id="A2.E16.m1.3.3.2.cmml" xref="A2.E16.m1.3.3"></divide><apply id="A2.E16.m1.3.3.3.cmml" xref="A2.E16.m1.3.3.3"><minus id="A2.E16.m1.3.3.3.1.cmml" xref="A2.E16.m1.3.3.3.1"></minus><apply id="A2.E16.m1.3.3.3.2.cmml" xref="A2.E16.m1.3.3.3.2"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.3.2.1.cmml" xref="A2.E16.m1.3.3.3.2">subscript</csymbol><ci id="A2.E16.m1.3.3.3.2.2.cmml" xref="A2.E16.m1.3.3.3.2.2">𝐯</ci><ci id="A2.E16.m1.3.3.3.2.3.cmml" xref="A2.E16.m1.3.3.3.2.3">𝑗</ci></apply><apply id="A2.E16.m1.3.3.3.3.cmml" xref="A2.E16.m1.3.3.3.3"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.3.3.1.cmml" xref="A2.E16.m1.3.3.3.3">subscript</csymbol><ci id="A2.E16.m1.3.3.3.3.2.cmml" xref="A2.E16.m1.3.3.3.3.2">𝜇</ci><apply id="A2.E16.m1.3.3.3.3.3.cmml" xref="A2.E16.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.3.3.3.1.cmml" xref="A2.E16.m1.3.3.3.3.3">subscript</csymbol><ci id="A2.E16.m1.3.3.3.3.3.2.cmml" xref="A2.E16.m1.3.3.3.3.3.2">𝐯</ci><ci id="A2.E16.m1.3.3.3.3.3.3.cmml" xref="A2.E16.m1.3.3.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A2.E16.m1.3.3.1.2.cmml" xref="A2.E16.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E16.m1.3.3.1.2.1.cmml" xref="A2.E16.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E16.m1.3.3.1.1.1.cmml" xref="A2.E16.m1.3.3.1.1.1"><minus id="A2.E16.m1.3.3.1.1.1.1.cmml" xref="A2.E16.m1.3.3.1.1.1.1"></minus><apply id="A2.E16.m1.3.3.1.1.1.2.cmml" xref="A2.E16.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.1.1.1.2.1.cmml" xref="A2.E16.m1.3.3.1.1.1.2">subscript</csymbol><ci id="A2.E16.m1.3.3.1.1.1.2.2.cmml" xref="A2.E16.m1.3.3.1.1.1.2.2">𝐯</ci><ci id="A2.E16.m1.3.3.1.1.1.2.3.cmml" xref="A2.E16.m1.3.3.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E16.m1.3.3.1.1.1.3.cmml" xref="A2.E16.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.1.1.1.3.1.cmml" xref="A2.E16.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A2.E16.m1.3.3.1.1.1.3.2.cmml" xref="A2.E16.m1.3.3.1.1.1.3.2">𝜇</ci><apply id="A2.E16.m1.3.3.1.1.1.3.3.cmml" xref="A2.E16.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E16.m1.3.3.1.1.1.3.3.1.cmml" xref="A2.E16.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="A2.E16.m1.3.3.1.1.1.3.3.2.cmml" xref="A2.E16.m1.3.3.1.1.1.3.3.2">𝐯</ci><ci id="A2.E16.m1.3.3.1.1.1.3.3.3.cmml" xref="A2.E16.m1.3.3.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><ci id="A2.E16.m1.4.4.1.1.3.2.2.cmml" xref="A2.E16.m1.4.4.1.1.3.2.2">𝜸</ci></apply><ci id="A2.E16.m1.4.4.1.1.3.3.cmml" xref="A2.E16.m1.4.4.1.1.3.3">𝜷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E16.m1.4c">\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{v}_{j}]=%
\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}}{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j%
}}\|}\circ\boldsymbol{\gamma}+\boldsymbol{\beta}~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E16.m1.4d">LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ] = divide start_ARG bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG ∘ bold_italic_γ + bold_italic_β .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p6">
<p class="ltx_p" id="A2.SS1.p6.5">Notably,
<math alttext="\mathbf{x}=\sum_{i}^{d_{\text{SAE}}}a_{i}\mathbf{v}_{i}+\mathbf{b}+\boldsymbol%
{\varepsilon}" class="ltx_Math" display="inline" id="A2.SS1.p6.1.m1.1"><semantics id="A2.SS1.p6.1.m1.1a"><mrow id="A2.SS1.p6.1.m1.1.1" xref="A2.SS1.p6.1.m1.1.1.cmml"><mi id="A2.SS1.p6.1.m1.1.1.2" xref="A2.SS1.p6.1.m1.1.1.2.cmml">𝐱</mi><mo id="A2.SS1.p6.1.m1.1.1.1" rspace="0.111em" xref="A2.SS1.p6.1.m1.1.1.1.cmml">=</mo><mrow id="A2.SS1.p6.1.m1.1.1.3" xref="A2.SS1.p6.1.m1.1.1.3.cmml"><mrow id="A2.SS1.p6.1.m1.1.1.3.2" xref="A2.SS1.p6.1.m1.1.1.3.2.cmml"><msubsup id="A2.SS1.p6.1.m1.1.1.3.2.1" xref="A2.SS1.p6.1.m1.1.1.3.2.1.cmml"><mo id="A2.SS1.p6.1.m1.1.1.3.2.1.2.2" xref="A2.SS1.p6.1.m1.1.1.3.2.1.2.2.cmml">∑</mo><mi id="A2.SS1.p6.1.m1.1.1.3.2.1.2.3" xref="A2.SS1.p6.1.m1.1.1.3.2.1.2.3.cmml">i</mi><msub id="A2.SS1.p6.1.m1.1.1.3.2.1.3" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.cmml"><mi id="A2.SS1.p6.1.m1.1.1.3.2.1.3.2" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.2.cmml">d</mi><mtext id="A2.SS1.p6.1.m1.1.1.3.2.1.3.3" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.3a.cmml">SAE</mtext></msub></msubsup><mrow id="A2.SS1.p6.1.m1.1.1.3.2.2" xref="A2.SS1.p6.1.m1.1.1.3.2.2.cmml"><msub id="A2.SS1.p6.1.m1.1.1.3.2.2.2" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2.cmml"><mi id="A2.SS1.p6.1.m1.1.1.3.2.2.2.2" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p6.1.m1.1.1.3.2.2.2.3" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2.3.cmml">i</mi></msub><mo id="A2.SS1.p6.1.m1.1.1.3.2.2.1" xref="A2.SS1.p6.1.m1.1.1.3.2.2.1.cmml">⁢</mo><msub id="A2.SS1.p6.1.m1.1.1.3.2.2.3" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3.cmml"><mi id="A2.SS1.p6.1.m1.1.1.3.2.2.3.2" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3.2.cmml">𝐯</mi><mi id="A2.SS1.p6.1.m1.1.1.3.2.2.3.3" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.SS1.p6.1.m1.1.1.3.1" xref="A2.SS1.p6.1.m1.1.1.3.1.cmml">+</mo><mi id="A2.SS1.p6.1.m1.1.1.3.3" xref="A2.SS1.p6.1.m1.1.1.3.3.cmml">𝐛</mi><mo id="A2.SS1.p6.1.m1.1.1.3.1a" xref="A2.SS1.p6.1.m1.1.1.3.1.cmml">+</mo><mi id="A2.SS1.p6.1.m1.1.1.3.4" xref="A2.SS1.p6.1.m1.1.1.3.4.cmml">𝜺</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.1.m1.1b"><apply id="A2.SS1.p6.1.m1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1"><eq id="A2.SS1.p6.1.m1.1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1.1"></eq><ci id="A2.SS1.p6.1.m1.1.1.2.cmml" xref="A2.SS1.p6.1.m1.1.1.2">𝐱</ci><apply id="A2.SS1.p6.1.m1.1.1.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3"><plus id="A2.SS1.p6.1.m1.1.1.3.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.1"></plus><apply id="A2.SS1.p6.1.m1.1.1.3.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2"><apply id="A2.SS1.p6.1.m1.1.1.3.2.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="A2.SS1.p6.1.m1.1.1.3.2.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1">superscript</csymbol><apply id="A2.SS1.p6.1.m1.1.1.3.2.1.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="A2.SS1.p6.1.m1.1.1.3.2.1.2.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1">subscript</csymbol><sum id="A2.SS1.p6.1.m1.1.1.3.2.1.2.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.2.2"></sum><ci id="A2.SS1.p6.1.m1.1.1.3.2.1.2.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.2.3">𝑖</ci></apply><apply id="A2.SS1.p6.1.m1.1.1.3.2.1.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="A2.SS1.p6.1.m1.1.1.3.2.1.3.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3">subscript</csymbol><ci id="A2.SS1.p6.1.m1.1.1.3.2.1.3.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.2">𝑑</ci><ci id="A2.SS1.p6.1.m1.1.1.3.2.1.3.3a.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.3"><mtext id="A2.SS1.p6.1.m1.1.1.3.2.1.3.3.cmml" mathsize="50%" xref="A2.SS1.p6.1.m1.1.1.3.2.1.3.3">SAE</mtext></ci></apply></apply><apply id="A2.SS1.p6.1.m1.1.1.3.2.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2"><times id="A2.SS1.p6.1.m1.1.1.3.2.2.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.1"></times><apply id="A2.SS1.p6.1.m1.1.1.3.2.2.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p6.1.m1.1.1.3.2.2.2.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p6.1.m1.1.1.3.2.2.2.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2.2">𝑎</ci><ci id="A2.SS1.p6.1.m1.1.1.3.2.2.2.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="A2.SS1.p6.1.m1.1.1.3.2.2.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="A2.SS1.p6.1.m1.1.1.3.2.2.3.1.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3">subscript</csymbol><ci id="A2.SS1.p6.1.m1.1.1.3.2.2.3.2.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3.2">𝐯</ci><ci id="A2.SS1.p6.1.m1.1.1.3.2.2.3.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.2.2.3.3">𝑖</ci></apply></apply></apply><ci id="A2.SS1.p6.1.m1.1.1.3.3.cmml" xref="A2.SS1.p6.1.m1.1.1.3.3">𝐛</ci><ci id="A2.SS1.p6.1.m1.1.1.3.4.cmml" xref="A2.SS1.p6.1.m1.1.1.3.4">𝜺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.1.m1.1c">\mathbf{x}=\sum_{i}^{d_{\text{SAE}}}a_{i}\mathbf{v}_{i}+\mathbf{b}+\boldsymbol%
{\varepsilon}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.1.m1.1d">bold_x = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + bold_b + bold_italic_ε</annotation></semantics></math>
with feature vectors <math alttext="\mathbf{v}_{i}" class="ltx_Math" display="inline" id="A2.SS1.p6.2.m2.1"><semantics id="A2.SS1.p6.2.m2.1a"><msub id="A2.SS1.p6.2.m2.1.1" xref="A2.SS1.p6.2.m2.1.1.cmml"><mi id="A2.SS1.p6.2.m2.1.1.2" xref="A2.SS1.p6.2.m2.1.1.2.cmml">𝐯</mi><mi id="A2.SS1.p6.2.m2.1.1.3" xref="A2.SS1.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.2.m2.1b"><apply id="A2.SS1.p6.2.m2.1.1.cmml" xref="A2.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p6.2.m2.1.1.1.cmml" xref="A2.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p6.2.m2.1.1.2.cmml" xref="A2.SS1.p6.2.m2.1.1.2">𝐯</ci><ci id="A2.SS1.p6.2.m2.1.1.3.cmml" xref="A2.SS1.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.2.m2.1c">\mathbf{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.2.m2.1d">bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for latent SAE components, a bias and error term (see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E1" title="In 3.1 Sparse autoencoders for extracting interpretable components ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>).
We now include the bias and error term in the sum, introducing <math alttext="a_{d_{\text{SAE}}+1}=a_{d_{\text{SAE}}+2}=1" class="ltx_Math" display="inline" id="A2.SS1.p6.3.m3.1"><semantics id="A2.SS1.p6.3.m3.1a"><mrow id="A2.SS1.p6.3.m3.1.1" xref="A2.SS1.p6.3.m3.1.1.cmml"><msub id="A2.SS1.p6.3.m3.1.1.2" xref="A2.SS1.p6.3.m3.1.1.2.cmml"><mi id="A2.SS1.p6.3.m3.1.1.2.2" xref="A2.SS1.p6.3.m3.1.1.2.2.cmml">a</mi><mrow id="A2.SS1.p6.3.m3.1.1.2.3" xref="A2.SS1.p6.3.m3.1.1.2.3.cmml"><msub id="A2.SS1.p6.3.m3.1.1.2.3.2" xref="A2.SS1.p6.3.m3.1.1.2.3.2.cmml"><mi id="A2.SS1.p6.3.m3.1.1.2.3.2.2" xref="A2.SS1.p6.3.m3.1.1.2.3.2.2.cmml">d</mi><mtext id="A2.SS1.p6.3.m3.1.1.2.3.2.3" xref="A2.SS1.p6.3.m3.1.1.2.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.SS1.p6.3.m3.1.1.2.3.1" xref="A2.SS1.p6.3.m3.1.1.2.3.1.cmml">+</mo><mn id="A2.SS1.p6.3.m3.1.1.2.3.3" xref="A2.SS1.p6.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A2.SS1.p6.3.m3.1.1.3" xref="A2.SS1.p6.3.m3.1.1.3.cmml">=</mo><msub id="A2.SS1.p6.3.m3.1.1.4" xref="A2.SS1.p6.3.m3.1.1.4.cmml"><mi id="A2.SS1.p6.3.m3.1.1.4.2" xref="A2.SS1.p6.3.m3.1.1.4.2.cmml">a</mi><mrow id="A2.SS1.p6.3.m3.1.1.4.3" xref="A2.SS1.p6.3.m3.1.1.4.3.cmml"><msub id="A2.SS1.p6.3.m3.1.1.4.3.2" xref="A2.SS1.p6.3.m3.1.1.4.3.2.cmml"><mi id="A2.SS1.p6.3.m3.1.1.4.3.2.2" xref="A2.SS1.p6.3.m3.1.1.4.3.2.2.cmml">d</mi><mtext id="A2.SS1.p6.3.m3.1.1.4.3.2.3" xref="A2.SS1.p6.3.m3.1.1.4.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.SS1.p6.3.m3.1.1.4.3.1" xref="A2.SS1.p6.3.m3.1.1.4.3.1.cmml">+</mo><mn id="A2.SS1.p6.3.m3.1.1.4.3.3" xref="A2.SS1.p6.3.m3.1.1.4.3.3.cmml">2</mn></mrow></msub><mo id="A2.SS1.p6.3.m3.1.1.5" xref="A2.SS1.p6.3.m3.1.1.5.cmml">=</mo><mn id="A2.SS1.p6.3.m3.1.1.6" xref="A2.SS1.p6.3.m3.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.3.m3.1b"><apply id="A2.SS1.p6.3.m3.1.1.cmml" xref="A2.SS1.p6.3.m3.1.1"><and id="A2.SS1.p6.3.m3.1.1a.cmml" xref="A2.SS1.p6.3.m3.1.1"></and><apply id="A2.SS1.p6.3.m3.1.1b.cmml" xref="A2.SS1.p6.3.m3.1.1"><eq id="A2.SS1.p6.3.m3.1.1.3.cmml" xref="A2.SS1.p6.3.m3.1.1.3"></eq><apply id="A2.SS1.p6.3.m3.1.1.2.cmml" xref="A2.SS1.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p6.3.m3.1.1.2.1.cmml" xref="A2.SS1.p6.3.m3.1.1.2">subscript</csymbol><ci id="A2.SS1.p6.3.m3.1.1.2.2.cmml" xref="A2.SS1.p6.3.m3.1.1.2.2">𝑎</ci><apply id="A2.SS1.p6.3.m3.1.1.2.3.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3"><plus id="A2.SS1.p6.3.m3.1.1.2.3.1.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3.1"></plus><apply id="A2.SS1.p6.3.m3.1.1.2.3.2.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p6.3.m3.1.1.2.3.2.1.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p6.3.m3.1.1.2.3.2.2.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3.2.2">𝑑</ci><ci id="A2.SS1.p6.3.m3.1.1.2.3.2.3a.cmml" xref="A2.SS1.p6.3.m3.1.1.2.3.2.3"><mtext id="A2.SS1.p6.3.m3.1.1.2.3.2.3.cmml" mathsize="50%" xref="A2.SS1.p6.3.m3.1.1.2.3.2.3">SAE</mtext></ci></apply><cn id="A2.SS1.p6.3.m3.1.1.2.3.3.cmml" type="integer" xref="A2.SS1.p6.3.m3.1.1.2.3.3">1</cn></apply></apply><apply id="A2.SS1.p6.3.m3.1.1.4.cmml" xref="A2.SS1.p6.3.m3.1.1.4"><csymbol cd="ambiguous" id="A2.SS1.p6.3.m3.1.1.4.1.cmml" xref="A2.SS1.p6.3.m3.1.1.4">subscript</csymbol><ci id="A2.SS1.p6.3.m3.1.1.4.2.cmml" xref="A2.SS1.p6.3.m3.1.1.4.2">𝑎</ci><apply id="A2.SS1.p6.3.m3.1.1.4.3.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3"><plus id="A2.SS1.p6.3.m3.1.1.4.3.1.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3.1"></plus><apply id="A2.SS1.p6.3.m3.1.1.4.3.2.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3.2"><csymbol cd="ambiguous" id="A2.SS1.p6.3.m3.1.1.4.3.2.1.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3.2">subscript</csymbol><ci id="A2.SS1.p6.3.m3.1.1.4.3.2.2.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3.2.2">𝑑</ci><ci id="A2.SS1.p6.3.m3.1.1.4.3.2.3a.cmml" xref="A2.SS1.p6.3.m3.1.1.4.3.2.3"><mtext id="A2.SS1.p6.3.m3.1.1.4.3.2.3.cmml" mathsize="50%" xref="A2.SS1.p6.3.m3.1.1.4.3.2.3">SAE</mtext></ci></apply><cn id="A2.SS1.p6.3.m3.1.1.4.3.3.cmml" type="integer" xref="A2.SS1.p6.3.m3.1.1.4.3.3">2</cn></apply></apply></apply><apply id="A2.SS1.p6.3.m3.1.1c.cmml" xref="A2.SS1.p6.3.m3.1.1"><eq id="A2.SS1.p6.3.m3.1.1.5.cmml" xref="A2.SS1.p6.3.m3.1.1.5"></eq><share href="https://arxiv.org/html/2505.20229v1#A2.SS1.p6.3.m3.1.1.4.cmml" id="A2.SS1.p6.3.m3.1.1d.cmml" xref="A2.SS1.p6.3.m3.1.1"></share><cn id="A2.SS1.p6.3.m3.1.1.6.cmml" type="integer" xref="A2.SS1.p6.3.m3.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.3.m3.1c">a_{d_{\text{SAE}}+1}=a_{d_{\text{SAE}}+2}=1</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT = italic_a start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 2 end_POSTSUBSCRIPT = 1</annotation></semantics></math> and <math alttext="\mathbf{v}_{d_{\text{SAE}}+1}=\mathbf{b}" class="ltx_Math" display="inline" id="A2.SS1.p6.4.m4.1"><semantics id="A2.SS1.p6.4.m4.1a"><mrow id="A2.SS1.p6.4.m4.1.1" xref="A2.SS1.p6.4.m4.1.1.cmml"><msub id="A2.SS1.p6.4.m4.1.1.2" xref="A2.SS1.p6.4.m4.1.1.2.cmml"><mi id="A2.SS1.p6.4.m4.1.1.2.2" xref="A2.SS1.p6.4.m4.1.1.2.2.cmml">𝐯</mi><mrow id="A2.SS1.p6.4.m4.1.1.2.3" xref="A2.SS1.p6.4.m4.1.1.2.3.cmml"><msub id="A2.SS1.p6.4.m4.1.1.2.3.2" xref="A2.SS1.p6.4.m4.1.1.2.3.2.cmml"><mi id="A2.SS1.p6.4.m4.1.1.2.3.2.2" xref="A2.SS1.p6.4.m4.1.1.2.3.2.2.cmml">d</mi><mtext id="A2.SS1.p6.4.m4.1.1.2.3.2.3" xref="A2.SS1.p6.4.m4.1.1.2.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.SS1.p6.4.m4.1.1.2.3.1" xref="A2.SS1.p6.4.m4.1.1.2.3.1.cmml">+</mo><mn id="A2.SS1.p6.4.m4.1.1.2.3.3" xref="A2.SS1.p6.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A2.SS1.p6.4.m4.1.1.1" xref="A2.SS1.p6.4.m4.1.1.1.cmml">=</mo><mi id="A2.SS1.p6.4.m4.1.1.3" xref="A2.SS1.p6.4.m4.1.1.3.cmml">𝐛</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.4.m4.1b"><apply id="A2.SS1.p6.4.m4.1.1.cmml" xref="A2.SS1.p6.4.m4.1.1"><eq id="A2.SS1.p6.4.m4.1.1.1.cmml" xref="A2.SS1.p6.4.m4.1.1.1"></eq><apply id="A2.SS1.p6.4.m4.1.1.2.cmml" xref="A2.SS1.p6.4.m4.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p6.4.m4.1.1.2.1.cmml" xref="A2.SS1.p6.4.m4.1.1.2">subscript</csymbol><ci id="A2.SS1.p6.4.m4.1.1.2.2.cmml" xref="A2.SS1.p6.4.m4.1.1.2.2">𝐯</ci><apply id="A2.SS1.p6.4.m4.1.1.2.3.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3"><plus id="A2.SS1.p6.4.m4.1.1.2.3.1.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3.1"></plus><apply id="A2.SS1.p6.4.m4.1.1.2.3.2.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p6.4.m4.1.1.2.3.2.1.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p6.4.m4.1.1.2.3.2.2.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3.2.2">𝑑</ci><ci id="A2.SS1.p6.4.m4.1.1.2.3.2.3a.cmml" xref="A2.SS1.p6.4.m4.1.1.2.3.2.3"><mtext id="A2.SS1.p6.4.m4.1.1.2.3.2.3.cmml" mathsize="50%" xref="A2.SS1.p6.4.m4.1.1.2.3.2.3">SAE</mtext></ci></apply><cn id="A2.SS1.p6.4.m4.1.1.2.3.3.cmml" type="integer" xref="A2.SS1.p6.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="A2.SS1.p6.4.m4.1.1.3.cmml" xref="A2.SS1.p6.4.m4.1.1.3">𝐛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.4.m4.1c">\mathbf{v}_{d_{\text{SAE}}+1}=\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.4.m4.1d">bold_v start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT = bold_b</annotation></semantics></math> and <math alttext="\mathbf{v}_{d_{\text{SAE}}+2}=\boldsymbol{\varepsilon}" class="ltx_Math" display="inline" id="A2.SS1.p6.5.m5.1"><semantics id="A2.SS1.p6.5.m5.1a"><mrow id="A2.SS1.p6.5.m5.1.1" xref="A2.SS1.p6.5.m5.1.1.cmml"><msub id="A2.SS1.p6.5.m5.1.1.2" xref="A2.SS1.p6.5.m5.1.1.2.cmml"><mi id="A2.SS1.p6.5.m5.1.1.2.2" xref="A2.SS1.p6.5.m5.1.1.2.2.cmml">𝐯</mi><mrow id="A2.SS1.p6.5.m5.1.1.2.3" xref="A2.SS1.p6.5.m5.1.1.2.3.cmml"><msub id="A2.SS1.p6.5.m5.1.1.2.3.2" xref="A2.SS1.p6.5.m5.1.1.2.3.2.cmml"><mi id="A2.SS1.p6.5.m5.1.1.2.3.2.2" xref="A2.SS1.p6.5.m5.1.1.2.3.2.2.cmml">d</mi><mtext id="A2.SS1.p6.5.m5.1.1.2.3.2.3" xref="A2.SS1.p6.5.m5.1.1.2.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.SS1.p6.5.m5.1.1.2.3.1" xref="A2.SS1.p6.5.m5.1.1.2.3.1.cmml">+</mo><mn id="A2.SS1.p6.5.m5.1.1.2.3.3" xref="A2.SS1.p6.5.m5.1.1.2.3.3.cmml">2</mn></mrow></msub><mo id="A2.SS1.p6.5.m5.1.1.1" xref="A2.SS1.p6.5.m5.1.1.1.cmml">=</mo><mi id="A2.SS1.p6.5.m5.1.1.3" xref="A2.SS1.p6.5.m5.1.1.3.cmml">𝜺</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.5.m5.1b"><apply id="A2.SS1.p6.5.m5.1.1.cmml" xref="A2.SS1.p6.5.m5.1.1"><eq id="A2.SS1.p6.5.m5.1.1.1.cmml" xref="A2.SS1.p6.5.m5.1.1.1"></eq><apply id="A2.SS1.p6.5.m5.1.1.2.cmml" xref="A2.SS1.p6.5.m5.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p6.5.m5.1.1.2.1.cmml" xref="A2.SS1.p6.5.m5.1.1.2">subscript</csymbol><ci id="A2.SS1.p6.5.m5.1.1.2.2.cmml" xref="A2.SS1.p6.5.m5.1.1.2.2">𝐯</ci><apply id="A2.SS1.p6.5.m5.1.1.2.3.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3"><plus id="A2.SS1.p6.5.m5.1.1.2.3.1.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3.1"></plus><apply id="A2.SS1.p6.5.m5.1.1.2.3.2.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p6.5.m5.1.1.2.3.2.1.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p6.5.m5.1.1.2.3.2.2.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3.2.2">𝑑</ci><ci id="A2.SS1.p6.5.m5.1.1.2.3.2.3a.cmml" xref="A2.SS1.p6.5.m5.1.1.2.3.2.3"><mtext id="A2.SS1.p6.5.m5.1.1.2.3.2.3.cmml" mathsize="50%" xref="A2.SS1.p6.5.m5.1.1.2.3.2.3">SAE</mtext></ci></apply><cn id="A2.SS1.p6.5.m5.1.1.2.3.3.cmml" type="integer" xref="A2.SS1.p6.5.m5.1.1.2.3.3">2</cn></apply></apply><ci id="A2.SS1.p6.5.m5.1.1.3.cmml" xref="A2.SS1.p6.5.m5.1.1.3">𝜺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.5.m5.1c">\mathbf{v}_{d_{\text{SAE}}+2}=\boldsymbol{\varepsilon}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.5.m5.1d">bold_v start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 2 end_POSTSUBSCRIPT = bold_italic_ε</annotation></semantics></math> , resulting in</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}=\sum_{i}^{d_{\text{SAE}}+2}a_{i}\mathbf{v}_{i}~{}." class="ltx_Math" display="block" id="A2.E17.m1.1"><semantics id="A2.E17.m1.1a"><mrow id="A2.E17.m1.1.1.1" xref="A2.E17.m1.1.1.1.1.cmml"><mrow id="A2.E17.m1.1.1.1.1" xref="A2.E17.m1.1.1.1.1.cmml"><mi id="A2.E17.m1.1.1.1.1.2" xref="A2.E17.m1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E17.m1.1.1.1.1.1" rspace="0.111em" xref="A2.E17.m1.1.1.1.1.1.cmml">=</mo><mrow id="A2.E17.m1.1.1.1.1.3" xref="A2.E17.m1.1.1.1.1.3.cmml"><munderover id="A2.E17.m1.1.1.1.1.3.1" xref="A2.E17.m1.1.1.1.1.3.1.cmml"><mo id="A2.E17.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="A2.E17.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mi id="A2.E17.m1.1.1.1.1.3.1.2.3" xref="A2.E17.m1.1.1.1.1.3.1.2.3.cmml">i</mi><mrow id="A2.E17.m1.1.1.1.1.3.1.3" xref="A2.E17.m1.1.1.1.1.3.1.3.cmml"><msub id="A2.E17.m1.1.1.1.1.3.1.3.2" xref="A2.E17.m1.1.1.1.1.3.1.3.2.cmml"><mi id="A2.E17.m1.1.1.1.1.3.1.3.2.2" xref="A2.E17.m1.1.1.1.1.3.1.3.2.2.cmml">d</mi><mtext id="A2.E17.m1.1.1.1.1.3.1.3.2.3" xref="A2.E17.m1.1.1.1.1.3.1.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.E17.m1.1.1.1.1.3.1.3.1" xref="A2.E17.m1.1.1.1.1.3.1.3.1.cmml">+</mo><mn id="A2.E17.m1.1.1.1.1.3.1.3.3" xref="A2.E17.m1.1.1.1.1.3.1.3.3.cmml">2</mn></mrow></munderover><mrow id="A2.E17.m1.1.1.1.1.3.2" xref="A2.E17.m1.1.1.1.1.3.2.cmml"><msub id="A2.E17.m1.1.1.1.1.3.2.2" xref="A2.E17.m1.1.1.1.1.3.2.2.cmml"><mi id="A2.E17.m1.1.1.1.1.3.2.2.2" xref="A2.E17.m1.1.1.1.1.3.2.2.2.cmml">a</mi><mi id="A2.E17.m1.1.1.1.1.3.2.2.3" xref="A2.E17.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="A2.E17.m1.1.1.1.1.3.2.1" xref="A2.E17.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="A2.E17.m1.1.1.1.1.3.2.3" xref="A2.E17.m1.1.1.1.1.3.2.3.cmml"><mi id="A2.E17.m1.1.1.1.1.3.2.3.2" xref="A2.E17.m1.1.1.1.1.3.2.3.2.cmml">𝐯</mi><mi id="A2.E17.m1.1.1.1.1.3.2.3.3" xref="A2.E17.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="A2.E17.m1.1.1.1.2" lspace="0em" xref="A2.E17.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E17.m1.1b"><apply id="A2.E17.m1.1.1.1.1.cmml" xref="A2.E17.m1.1.1.1"><eq id="A2.E17.m1.1.1.1.1.1.cmml" xref="A2.E17.m1.1.1.1.1.1"></eq><ci id="A2.E17.m1.1.1.1.1.2.cmml" xref="A2.E17.m1.1.1.1.1.2">𝐱</ci><apply id="A2.E17.m1.1.1.1.1.3.cmml" xref="A2.E17.m1.1.1.1.1.3"><apply id="A2.E17.m1.1.1.1.1.3.1.cmml" xref="A2.E17.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.1.3.1.1.cmml" xref="A2.E17.m1.1.1.1.1.3.1">superscript</csymbol><apply id="A2.E17.m1.1.1.1.1.3.1.2.cmml" xref="A2.E17.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.1.3.1.2.1.cmml" xref="A2.E17.m1.1.1.1.1.3.1">subscript</csymbol><sum id="A2.E17.m1.1.1.1.1.3.1.2.2.cmml" xref="A2.E17.m1.1.1.1.1.3.1.2.2"></sum><ci id="A2.E17.m1.1.1.1.1.3.1.2.3.cmml" xref="A2.E17.m1.1.1.1.1.3.1.2.3">𝑖</ci></apply><apply id="A2.E17.m1.1.1.1.1.3.1.3.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3"><plus id="A2.E17.m1.1.1.1.1.3.1.3.1.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3.1"></plus><apply id="A2.E17.m1.1.1.1.1.3.1.3.2.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.1.3.1.3.2.1.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3.2">subscript</csymbol><ci id="A2.E17.m1.1.1.1.1.3.1.3.2.2.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3.2.2">𝑑</ci><ci id="A2.E17.m1.1.1.1.1.3.1.3.2.3a.cmml" xref="A2.E17.m1.1.1.1.1.3.1.3.2.3"><mtext id="A2.E17.m1.1.1.1.1.3.1.3.2.3.cmml" mathsize="50%" xref="A2.E17.m1.1.1.1.1.3.1.3.2.3">SAE</mtext></ci></apply><cn id="A2.E17.m1.1.1.1.1.3.1.3.3.cmml" type="integer" xref="A2.E17.m1.1.1.1.1.3.1.3.3">2</cn></apply></apply><apply id="A2.E17.m1.1.1.1.1.3.2.cmml" xref="A2.E17.m1.1.1.1.1.3.2"><times id="A2.E17.m1.1.1.1.1.3.2.1.cmml" xref="A2.E17.m1.1.1.1.1.3.2.1"></times><apply id="A2.E17.m1.1.1.1.1.3.2.2.cmml" xref="A2.E17.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.1.3.2.2.1.cmml" xref="A2.E17.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="A2.E17.m1.1.1.1.1.3.2.2.2.cmml" xref="A2.E17.m1.1.1.1.1.3.2.2.2">𝑎</ci><ci id="A2.E17.m1.1.1.1.1.3.2.2.3.cmml" xref="A2.E17.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="A2.E17.m1.1.1.1.1.3.2.3.cmml" xref="A2.E17.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.1.3.2.3.1.cmml" xref="A2.E17.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A2.E17.m1.1.1.1.1.3.2.3.2.cmml" xref="A2.E17.m1.1.1.1.1.3.2.3.2">𝐯</ci><ci id="A2.E17.m1.1.1.1.1.3.2.3.3.cmml" xref="A2.E17.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E17.m1.1c">\mathbf{x}=\sum_{i}^{d_{\text{SAE}}+2}a_{i}\mathbf{v}_{i}~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E17.m1.1d">bold_x = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 2 end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p6.6">We further note that</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}-\mu_{\mathbf{x}}=\sum_{i}^{d_{\text{SAE}}+2}a_{i}(\mathbf{v}_{i}-%
\mu_{\mathbf{v}_{i}})~{}." class="ltx_Math" display="block" id="A2.E18.m1.1"><semantics id="A2.E18.m1.1a"><mrow id="A2.E18.m1.1.1.1" xref="A2.E18.m1.1.1.1.1.cmml"><mrow id="A2.E18.m1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.cmml"><mrow id="A2.E18.m1.1.1.1.1.3" xref="A2.E18.m1.1.1.1.1.3.cmml"><mi id="A2.E18.m1.1.1.1.1.3.2" xref="A2.E18.m1.1.1.1.1.3.2.cmml">𝐱</mi><mo id="A2.E18.m1.1.1.1.1.3.1" xref="A2.E18.m1.1.1.1.1.3.1.cmml">−</mo><msub id="A2.E18.m1.1.1.1.1.3.3" xref="A2.E18.m1.1.1.1.1.3.3.cmml"><mi id="A2.E18.m1.1.1.1.1.3.3.2" xref="A2.E18.m1.1.1.1.1.3.3.2.cmml">μ</mi><mi id="A2.E18.m1.1.1.1.1.3.3.3" xref="A2.E18.m1.1.1.1.1.3.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E18.m1.1.1.1.1.2" rspace="0.111em" xref="A2.E18.m1.1.1.1.1.2.cmml">=</mo><mrow id="A2.E18.m1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.cmml"><munderover id="A2.E18.m1.1.1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.1.2.cmml"><mo id="A2.E18.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A2.E18.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="A2.E18.m1.1.1.1.1.1.2.2.3" xref="A2.E18.m1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="A2.E18.m1.1.1.1.1.1.2.3" xref="A2.E18.m1.1.1.1.1.1.2.3.cmml"><msub id="A2.E18.m1.1.1.1.1.1.2.3.2" xref="A2.E18.m1.1.1.1.1.1.2.3.2.cmml"><mi id="A2.E18.m1.1.1.1.1.1.2.3.2.2" xref="A2.E18.m1.1.1.1.1.1.2.3.2.2.cmml">d</mi><mtext id="A2.E18.m1.1.1.1.1.1.2.3.2.3" xref="A2.E18.m1.1.1.1.1.1.2.3.2.3a.cmml">SAE</mtext></msub><mo id="A2.E18.m1.1.1.1.1.1.2.3.1" xref="A2.E18.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A2.E18.m1.1.1.1.1.1.2.3.3" xref="A2.E18.m1.1.1.1.1.1.2.3.3.cmml">2</mn></mrow></munderover><mrow id="A2.E18.m1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.cmml"><msub id="A2.E18.m1.1.1.1.1.1.1.3" xref="A2.E18.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.3.2" xref="A2.E18.m1.1.1.1.1.1.1.3.2.cmml">a</mi><mi id="A2.E18.m1.1.1.1.1.1.1.3.3" xref="A2.E18.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A2.E18.m1.1.1.1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E18.m1.1.1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.E18.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E18.m1.1.1.1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.E18.m1.1.1.1.1.1.1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A2.E18.m1.1.1.1.1.1.1.1.1.3" rspace="0.052em" stretchy="false" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A2.E18.m1.1.1.1.2" xref="A2.E18.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E18.m1.1b"><apply id="A2.E18.m1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1"><eq id="A2.E18.m1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.2"></eq><apply id="A2.E18.m1.1.1.1.1.3.cmml" xref="A2.E18.m1.1.1.1.1.3"><minus id="A2.E18.m1.1.1.1.1.3.1.cmml" xref="A2.E18.m1.1.1.1.1.3.1"></minus><ci id="A2.E18.m1.1.1.1.1.3.2.cmml" xref="A2.E18.m1.1.1.1.1.3.2">𝐱</ci><apply id="A2.E18.m1.1.1.1.1.3.3.cmml" xref="A2.E18.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.3.3.1.cmml" xref="A2.E18.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.3.3.2.cmml" xref="A2.E18.m1.1.1.1.1.3.3.2">𝜇</ci><ci id="A2.E18.m1.1.1.1.1.3.3.3.cmml" xref="A2.E18.m1.1.1.1.1.3.3.3">𝐱</ci></apply></apply><apply id="A2.E18.m1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1"><apply id="A2.E18.m1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.2.1.cmml" xref="A2.E18.m1.1.1.1.1.1.2">superscript</csymbol><apply id="A2.E18.m1.1.1.1.1.1.2.2.cmml" xref="A2.E18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.2.2.1.cmml" xref="A2.E18.m1.1.1.1.1.1.2">subscript</csymbol><sum id="A2.E18.m1.1.1.1.1.1.2.2.2.cmml" xref="A2.E18.m1.1.1.1.1.1.2.2.2"></sum><ci id="A2.E18.m1.1.1.1.1.1.2.2.3.cmml" xref="A2.E18.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="A2.E18.m1.1.1.1.1.1.2.3.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3"><plus id="A2.E18.m1.1.1.1.1.1.2.3.1.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3.1"></plus><apply id="A2.E18.m1.1.1.1.1.1.2.3.2.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3.2.2">𝑑</ci><ci id="A2.E18.m1.1.1.1.1.1.2.3.2.3a.cmml" xref="A2.E18.m1.1.1.1.1.1.2.3.2.3"><mtext id="A2.E18.m1.1.1.1.1.1.2.3.2.3.cmml" mathsize="50%" xref="A2.E18.m1.1.1.1.1.1.2.3.2.3">SAE</mtext></ci></apply><cn id="A2.E18.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A2.E18.m1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A2.E18.m1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1"><times id="A2.E18.m1.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.2"></times><apply id="A2.E18.m1.1.1.1.1.1.1.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.3.2">𝑎</ci><ci id="A2.E18.m1.1.1.1.1.1.1.3.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1"><minus id="A2.E18.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A2.E18.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m1.1c">\mathbf{x}-\mu_{\mathbf{x}}=\sum_{i}^{d_{\text{SAE}}+2}a_{i}(\mathbf{v}_{i}-%
\mu_{\mathbf{v}_{i}})~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E18.m1.1d">bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT SAE end_POSTSUBSCRIPT + 2 end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p7">
<p class="ltx_p" id="A2.SS1.p7.2">We in the following assume, that <math alttext="\boldsymbol{\beta}" class="ltx_Math" display="inline" id="A2.SS1.p7.1.m1.1"><semantics id="A2.SS1.p7.1.m1.1a"><mi id="A2.SS1.p7.1.m1.1.1" xref="A2.SS1.p7.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p7.1.m1.1b"><ci id="A2.SS1.p7.1.m1.1.1.cmml" xref="A2.SS1.p7.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p7.1.m1.1c">\boldsymbol{\beta}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p7.1.m1.1d">bold_italic_β</annotation></semantics></math> is very small and neglectable, i.e., <math alttext="\boldsymbol{\beta}\overset{!}{=}0" class="ltx_Math" display="inline" id="A2.SS1.p7.2.m2.1"><semantics id="A2.SS1.p7.2.m2.1a"><mrow id="A2.SS1.p7.2.m2.1.1" xref="A2.SS1.p7.2.m2.1.1.cmml"><mi id="A2.SS1.p7.2.m2.1.1.2" xref="A2.SS1.p7.2.m2.1.1.2.cmml">𝜷</mi><mo id="A2.SS1.p7.2.m2.1.1.1" xref="A2.SS1.p7.2.m2.1.1.1.cmml">⁢</mo><mover accent="true" id="A2.SS1.p7.2.m2.1.1.3" xref="A2.SS1.p7.2.m2.1.1.3.cmml"><mo id="A2.SS1.p7.2.m2.1.1.3.2" xref="A2.SS1.p7.2.m2.1.1.3.2.cmml">=</mo><mo id="A2.SS1.p7.2.m2.1.1.3.1" xref="A2.SS1.p7.2.m2.1.1.3.1.cmml">!</mo></mover><mo id="A2.SS1.p7.2.m2.1.1.1a" xref="A2.SS1.p7.2.m2.1.1.1.cmml">⁢</mo><mn id="A2.SS1.p7.2.m2.1.1.4" xref="A2.SS1.p7.2.m2.1.1.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p7.2.m2.1b"><apply id="A2.SS1.p7.2.m2.1.1.cmml" xref="A2.SS1.p7.2.m2.1.1"><times id="A2.SS1.p7.2.m2.1.1.1.cmml" xref="A2.SS1.p7.2.m2.1.1.1"></times><ci id="A2.SS1.p7.2.m2.1.1.2.cmml" xref="A2.SS1.p7.2.m2.1.1.2">𝜷</ci><apply id="A2.SS1.p7.2.m2.1.1.3.cmml" xref="A2.SS1.p7.2.m2.1.1.3"><factorial id="A2.SS1.p7.2.m2.1.1.3.1.cmml" xref="A2.SS1.p7.2.m2.1.1.3.1"></factorial><eq id="A2.SS1.p7.2.m2.1.1.3.2.cmml" xref="A2.SS1.p7.2.m2.1.1.3.2"></eq></apply><cn id="A2.SS1.p7.2.m2.1.1.4.cmml" type="integer" xref="A2.SS1.p7.2.m2.1.1.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p7.2.m2.1c">\boldsymbol{\beta}\overset{!}{=}0</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p7.2.m2.1d">bold_italic_β over! start_ARG = end_ARG 0</annotation></semantics></math>.
Then, using <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E18" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">18</span></a>, we can write</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]=\sum_{i}%
a_{i}\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{v}_{i}]%
\frac{\|\mathbf{v}_{i}-\mu_{\mathbf{v}_{i}}\|}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}" class="ltx_Math" display="block" id="A2.E19.m1.8"><semantics id="A2.E19.m1.8a"><mrow id="A2.E19.m1.8.8" xref="A2.E19.m1.8.8.cmml"><mrow id="A2.E19.m1.8.8.3" xref="A2.E19.m1.8.8.3.cmml"><msub id="A2.E19.m1.8.8.3.2" xref="A2.E19.m1.8.8.3.2.cmml"><mtext id="A2.E19.m1.8.8.3.2.2" xref="A2.E19.m1.8.8.3.2.2a.cmml">LayerNorm</mtext><mrow id="A2.E19.m1.2.2.2.4" xref="A2.E19.m1.2.2.2.3.cmml"><mi id="A2.E19.m1.1.1.1.1" xref="A2.E19.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.E19.m1.2.2.2.4.1" xref="A2.E19.m1.2.2.2.3.cmml">,</mo><mi id="A2.E19.m1.2.2.2.2" xref="A2.E19.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E19.m1.8.8.3.1" xref="A2.E19.m1.8.8.3.1.cmml">⁢</mo><mrow id="A2.E19.m1.8.8.3.3.2" xref="A2.E19.m1.8.8.3.3.1.cmml"><mo id="A2.E19.m1.8.8.3.3.2.1" stretchy="false" xref="A2.E19.m1.8.8.3.3.1.1.cmml">[</mo><mi id="A2.E19.m1.7.7" xref="A2.E19.m1.7.7.cmml">𝐱</mi><mo id="A2.E19.m1.8.8.3.3.2.2" stretchy="false" xref="A2.E19.m1.8.8.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="A2.E19.m1.8.8.2" rspace="0.111em" xref="A2.E19.m1.8.8.2.cmml">=</mo><mrow id="A2.E19.m1.8.8.1" xref="A2.E19.m1.8.8.1.cmml"><munder id="A2.E19.m1.8.8.1.2" xref="A2.E19.m1.8.8.1.2.cmml"><mo id="A2.E19.m1.8.8.1.2.2" movablelimits="false" xref="A2.E19.m1.8.8.1.2.2.cmml">∑</mo><mi id="A2.E19.m1.8.8.1.2.3" xref="A2.E19.m1.8.8.1.2.3.cmml">i</mi></munder><mrow id="A2.E19.m1.8.8.1.1" xref="A2.E19.m1.8.8.1.1.cmml"><msub id="A2.E19.m1.8.8.1.1.3" xref="A2.E19.m1.8.8.1.1.3.cmml"><mi id="A2.E19.m1.8.8.1.1.3.2" xref="A2.E19.m1.8.8.1.1.3.2.cmml">a</mi><mi id="A2.E19.m1.8.8.1.1.3.3" xref="A2.E19.m1.8.8.1.1.3.3.cmml">i</mi></msub><mo id="A2.E19.m1.8.8.1.1.2" xref="A2.E19.m1.8.8.1.1.2.cmml">⁢</mo><msub id="A2.E19.m1.8.8.1.1.4" xref="A2.E19.m1.8.8.1.1.4.cmml"><mtext id="A2.E19.m1.8.8.1.1.4.2" xref="A2.E19.m1.8.8.1.1.4.2a.cmml">LayerNorm</mtext><mrow id="A2.E19.m1.4.4.2.4" xref="A2.E19.m1.4.4.2.3.cmml"><mi id="A2.E19.m1.3.3.1.1" xref="A2.E19.m1.3.3.1.1.cmml">𝜸</mi><mo id="A2.E19.m1.4.4.2.4.1" xref="A2.E19.m1.4.4.2.3.cmml">,</mo><mi id="A2.E19.m1.4.4.2.2" xref="A2.E19.m1.4.4.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E19.m1.8.8.1.1.2a" xref="A2.E19.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="A2.E19.m1.8.8.1.1.1.1" xref="A2.E19.m1.8.8.1.1.1.2.cmml"><mo id="A2.E19.m1.8.8.1.1.1.1.2" stretchy="false" xref="A2.E19.m1.8.8.1.1.1.2.1.cmml">[</mo><msub id="A2.E19.m1.8.8.1.1.1.1.1" xref="A2.E19.m1.8.8.1.1.1.1.1.cmml"><mi id="A2.E19.m1.8.8.1.1.1.1.1.2" xref="A2.E19.m1.8.8.1.1.1.1.1.2.cmml">𝐯</mi><mi id="A2.E19.m1.8.8.1.1.1.1.1.3" xref="A2.E19.m1.8.8.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E19.m1.8.8.1.1.1.1.3" stretchy="false" xref="A2.E19.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow><mo id="A2.E19.m1.8.8.1.1.2b" xref="A2.E19.m1.8.8.1.1.2.cmml">⁢</mo><mfrac id="A2.E19.m1.6.6" xref="A2.E19.m1.6.6.cmml"><mrow id="A2.E19.m1.5.5.1.1" xref="A2.E19.m1.5.5.1.2.cmml"><mo id="A2.E19.m1.5.5.1.1.2" stretchy="false" xref="A2.E19.m1.5.5.1.2.1.cmml">‖</mo><mrow id="A2.E19.m1.5.5.1.1.1" xref="A2.E19.m1.5.5.1.1.1.cmml"><msub id="A2.E19.m1.5.5.1.1.1.2" xref="A2.E19.m1.5.5.1.1.1.2.cmml"><mi id="A2.E19.m1.5.5.1.1.1.2.2" xref="A2.E19.m1.5.5.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E19.m1.5.5.1.1.1.2.3" xref="A2.E19.m1.5.5.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.E19.m1.5.5.1.1.1.1" xref="A2.E19.m1.5.5.1.1.1.1.cmml">−</mo><msub id="A2.E19.m1.5.5.1.1.1.3" xref="A2.E19.m1.5.5.1.1.1.3.cmml"><mi id="A2.E19.m1.5.5.1.1.1.3.2" xref="A2.E19.m1.5.5.1.1.1.3.2.cmml">μ</mi><msub id="A2.E19.m1.5.5.1.1.1.3.3" xref="A2.E19.m1.5.5.1.1.1.3.3.cmml"><mi id="A2.E19.m1.5.5.1.1.1.3.3.2" xref="A2.E19.m1.5.5.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E19.m1.5.5.1.1.1.3.3.3" xref="A2.E19.m1.5.5.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A2.E19.m1.5.5.1.1.3" stretchy="false" xref="A2.E19.m1.5.5.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E19.m1.6.6.2.1" xref="A2.E19.m1.6.6.2.2.cmml"><mo id="A2.E19.m1.6.6.2.1.2" stretchy="false" xref="A2.E19.m1.6.6.2.2.1.cmml">‖</mo><mrow id="A2.E19.m1.6.6.2.1.1" xref="A2.E19.m1.6.6.2.1.1.cmml"><mi id="A2.E19.m1.6.6.2.1.1.2" xref="A2.E19.m1.6.6.2.1.1.2.cmml">𝐱</mi><mo id="A2.E19.m1.6.6.2.1.1.1" xref="A2.E19.m1.6.6.2.1.1.1.cmml">−</mo><msub id="A2.E19.m1.6.6.2.1.1.3" xref="A2.E19.m1.6.6.2.1.1.3.cmml"><mi id="A2.E19.m1.6.6.2.1.1.3.2" xref="A2.E19.m1.6.6.2.1.1.3.2.cmml">μ</mi><mi id="A2.E19.m1.6.6.2.1.1.3.3" xref="A2.E19.m1.6.6.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E19.m1.6.6.2.1.3" stretchy="false" xref="A2.E19.m1.6.6.2.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E19.m1.8b"><apply id="A2.E19.m1.8.8.cmml" xref="A2.E19.m1.8.8"><eq id="A2.E19.m1.8.8.2.cmml" xref="A2.E19.m1.8.8.2"></eq><apply id="A2.E19.m1.8.8.3.cmml" xref="A2.E19.m1.8.8.3"><times id="A2.E19.m1.8.8.3.1.cmml" xref="A2.E19.m1.8.8.3.1"></times><apply id="A2.E19.m1.8.8.3.2.cmml" xref="A2.E19.m1.8.8.3.2"><csymbol cd="ambiguous" id="A2.E19.m1.8.8.3.2.1.cmml" xref="A2.E19.m1.8.8.3.2">subscript</csymbol><ci id="A2.E19.m1.8.8.3.2.2a.cmml" xref="A2.E19.m1.8.8.3.2.2"><mtext id="A2.E19.m1.8.8.3.2.2.cmml" xref="A2.E19.m1.8.8.3.2.2">LayerNorm</mtext></ci><list id="A2.E19.m1.2.2.2.3.cmml" xref="A2.E19.m1.2.2.2.4"><ci id="A2.E19.m1.1.1.1.1.cmml" xref="A2.E19.m1.1.1.1.1">𝜸</ci><ci id="A2.E19.m1.2.2.2.2.cmml" xref="A2.E19.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.E19.m1.8.8.3.3.1.cmml" xref="A2.E19.m1.8.8.3.3.2"><csymbol cd="latexml" id="A2.E19.m1.8.8.3.3.1.1.cmml" xref="A2.E19.m1.8.8.3.3.2.1">delimited-[]</csymbol><ci id="A2.E19.m1.7.7.cmml" xref="A2.E19.m1.7.7">𝐱</ci></apply></apply><apply id="A2.E19.m1.8.8.1.cmml" xref="A2.E19.m1.8.8.1"><apply id="A2.E19.m1.8.8.1.2.cmml" xref="A2.E19.m1.8.8.1.2"><csymbol cd="ambiguous" id="A2.E19.m1.8.8.1.2.1.cmml" xref="A2.E19.m1.8.8.1.2">subscript</csymbol><sum id="A2.E19.m1.8.8.1.2.2.cmml" xref="A2.E19.m1.8.8.1.2.2"></sum><ci id="A2.E19.m1.8.8.1.2.3.cmml" xref="A2.E19.m1.8.8.1.2.3">𝑖</ci></apply><apply id="A2.E19.m1.8.8.1.1.cmml" xref="A2.E19.m1.8.8.1.1"><times id="A2.E19.m1.8.8.1.1.2.cmml" xref="A2.E19.m1.8.8.1.1.2"></times><apply id="A2.E19.m1.8.8.1.1.3.cmml" xref="A2.E19.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.8.8.1.1.3.1.cmml" xref="A2.E19.m1.8.8.1.1.3">subscript</csymbol><ci id="A2.E19.m1.8.8.1.1.3.2.cmml" xref="A2.E19.m1.8.8.1.1.3.2">𝑎</ci><ci id="A2.E19.m1.8.8.1.1.3.3.cmml" xref="A2.E19.m1.8.8.1.1.3.3">𝑖</ci></apply><apply id="A2.E19.m1.8.8.1.1.4.cmml" xref="A2.E19.m1.8.8.1.1.4"><csymbol cd="ambiguous" id="A2.E19.m1.8.8.1.1.4.1.cmml" xref="A2.E19.m1.8.8.1.1.4">subscript</csymbol><ci id="A2.E19.m1.8.8.1.1.4.2a.cmml" xref="A2.E19.m1.8.8.1.1.4.2"><mtext id="A2.E19.m1.8.8.1.1.4.2.cmml" xref="A2.E19.m1.8.8.1.1.4.2">LayerNorm</mtext></ci><list id="A2.E19.m1.4.4.2.3.cmml" xref="A2.E19.m1.4.4.2.4"><ci id="A2.E19.m1.3.3.1.1.cmml" xref="A2.E19.m1.3.3.1.1">𝜸</ci><ci id="A2.E19.m1.4.4.2.2.cmml" xref="A2.E19.m1.4.4.2.2">𝜷</ci></list></apply><apply id="A2.E19.m1.8.8.1.1.1.2.cmml" xref="A2.E19.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.8.8.1.1.1.2.1.cmml" xref="A2.E19.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E19.m1.8.8.1.1.1.1.1.cmml" xref="A2.E19.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.8.8.1.1.1.1.1.1.cmml" xref="A2.E19.m1.8.8.1.1.1.1.1">subscript</csymbol><ci id="A2.E19.m1.8.8.1.1.1.1.1.2.cmml" xref="A2.E19.m1.8.8.1.1.1.1.1.2">𝐯</ci><ci id="A2.E19.m1.8.8.1.1.1.1.1.3.cmml" xref="A2.E19.m1.8.8.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A2.E19.m1.6.6.cmml" xref="A2.E19.m1.6.6"><divide id="A2.E19.m1.6.6.3.cmml" xref="A2.E19.m1.6.6"></divide><apply id="A2.E19.m1.5.5.1.2.cmml" xref="A2.E19.m1.5.5.1.1"><csymbol cd="latexml" id="A2.E19.m1.5.5.1.2.1.cmml" xref="A2.E19.m1.5.5.1.1.2">norm</csymbol><apply id="A2.E19.m1.5.5.1.1.1.cmml" xref="A2.E19.m1.5.5.1.1.1"><minus id="A2.E19.m1.5.5.1.1.1.1.cmml" xref="A2.E19.m1.5.5.1.1.1.1"></minus><apply id="A2.E19.m1.5.5.1.1.1.2.cmml" xref="A2.E19.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.2.1.cmml" xref="A2.E19.m1.5.5.1.1.1.2">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.2.2.cmml" xref="A2.E19.m1.5.5.1.1.1.2.2">𝐯</ci><ci id="A2.E19.m1.5.5.1.1.1.2.3.cmml" xref="A2.E19.m1.5.5.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E19.m1.5.5.1.1.1.3.cmml" xref="A2.E19.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.3.1.cmml" xref="A2.E19.m1.5.5.1.1.1.3">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.3.2.cmml" xref="A2.E19.m1.5.5.1.1.1.3.2">𝜇</ci><apply id="A2.E19.m1.5.5.1.1.1.3.3.cmml" xref="A2.E19.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.3.3.1.cmml" xref="A2.E19.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.3.3.2.cmml" xref="A2.E19.m1.5.5.1.1.1.3.3.2">𝐯</ci><ci id="A2.E19.m1.5.5.1.1.1.3.3.3.cmml" xref="A2.E19.m1.5.5.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A2.E19.m1.6.6.2.2.cmml" xref="A2.E19.m1.6.6.2.1"><csymbol cd="latexml" id="A2.E19.m1.6.6.2.2.1.cmml" xref="A2.E19.m1.6.6.2.1.2">norm</csymbol><apply id="A2.E19.m1.6.6.2.1.1.cmml" xref="A2.E19.m1.6.6.2.1.1"><minus id="A2.E19.m1.6.6.2.1.1.1.cmml" xref="A2.E19.m1.6.6.2.1.1.1"></minus><ci id="A2.E19.m1.6.6.2.1.1.2.cmml" xref="A2.E19.m1.6.6.2.1.1.2">𝐱</ci><apply id="A2.E19.m1.6.6.2.1.1.3.cmml" xref="A2.E19.m1.6.6.2.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.6.6.2.1.1.3.1.cmml" xref="A2.E19.m1.6.6.2.1.1.3">subscript</csymbol><ci id="A2.E19.m1.6.6.2.1.1.3.2.cmml" xref="A2.E19.m1.6.6.2.1.1.3.2">𝜇</ci><ci id="A2.E19.m1.6.6.2.1.1.3.3.cmml" xref="A2.E19.m1.6.6.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m1.8c">\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{x}]=\sum_{i}%
a_{i}\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[\mathbf{v}_{i}]%
\frac{\|\mathbf{v}_{i}-\mu_{\mathbf{v}_{i}}\|}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}</annotation><annotation encoding="application/x-llamapun" id="A2.E19.m1.8d">LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_x ] = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p8">
<p class="ltx_p" id="A2.SS1.p8.1">By defining <math alttext="\boldsymbol{v}_{i}=\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[%
\mathbf{v}_{i}]W_{\text{proj}}" class="ltx_Math" display="inline" id="A2.SS1.p8.1.m1.3"><semantics id="A2.SS1.p8.1.m1.3a"><mrow id="A2.SS1.p8.1.m1.3.3" xref="A2.SS1.p8.1.m1.3.3.cmml"><msub id="A2.SS1.p8.1.m1.3.3.3" xref="A2.SS1.p8.1.m1.3.3.3.cmml"><mi id="A2.SS1.p8.1.m1.3.3.3.2" xref="A2.SS1.p8.1.m1.3.3.3.2.cmml">𝒗</mi><mi id="A2.SS1.p8.1.m1.3.3.3.3" xref="A2.SS1.p8.1.m1.3.3.3.3.cmml">i</mi></msub><mo id="A2.SS1.p8.1.m1.3.3.2" xref="A2.SS1.p8.1.m1.3.3.2.cmml">=</mo><mrow id="A2.SS1.p8.1.m1.3.3.1" xref="A2.SS1.p8.1.m1.3.3.1.cmml"><msub id="A2.SS1.p8.1.m1.3.3.1.3" xref="A2.SS1.p8.1.m1.3.3.1.3.cmml"><mtext id="A2.SS1.p8.1.m1.3.3.1.3.2" xref="A2.SS1.p8.1.m1.3.3.1.3.2a.cmml">LayerNorm</mtext><mrow id="A2.SS1.p8.1.m1.2.2.2.4" xref="A2.SS1.p8.1.m1.2.2.2.3.cmml"><mi id="A2.SS1.p8.1.m1.1.1.1.1" xref="A2.SS1.p8.1.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.SS1.p8.1.m1.2.2.2.4.1" xref="A2.SS1.p8.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.SS1.p8.1.m1.2.2.2.2" xref="A2.SS1.p8.1.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.SS1.p8.1.m1.3.3.1.2" xref="A2.SS1.p8.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="A2.SS1.p8.1.m1.3.3.1.1.1" xref="A2.SS1.p8.1.m1.3.3.1.1.2.cmml"><mo id="A2.SS1.p8.1.m1.3.3.1.1.1.2" stretchy="false" xref="A2.SS1.p8.1.m1.3.3.1.1.2.1.cmml">[</mo><msub id="A2.SS1.p8.1.m1.3.3.1.1.1.1" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1.cmml"><mi id="A2.SS1.p8.1.m1.3.3.1.1.1.1.2" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1.2.cmml">𝐯</mi><mi id="A2.SS1.p8.1.m1.3.3.1.1.1.1.3" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.SS1.p8.1.m1.3.3.1.1.1.3" stretchy="false" xref="A2.SS1.p8.1.m1.3.3.1.1.2.1.cmml">]</mo></mrow><mo id="A2.SS1.p8.1.m1.3.3.1.2a" xref="A2.SS1.p8.1.m1.3.3.1.2.cmml">⁢</mo><msub id="A2.SS1.p8.1.m1.3.3.1.4" xref="A2.SS1.p8.1.m1.3.3.1.4.cmml"><mi id="A2.SS1.p8.1.m1.3.3.1.4.2" xref="A2.SS1.p8.1.m1.3.3.1.4.2.cmml">W</mi><mtext id="A2.SS1.p8.1.m1.3.3.1.4.3" xref="A2.SS1.p8.1.m1.3.3.1.4.3a.cmml">proj</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p8.1.m1.3b"><apply id="A2.SS1.p8.1.m1.3.3.cmml" xref="A2.SS1.p8.1.m1.3.3"><eq id="A2.SS1.p8.1.m1.3.3.2.cmml" xref="A2.SS1.p8.1.m1.3.3.2"></eq><apply id="A2.SS1.p8.1.m1.3.3.3.cmml" xref="A2.SS1.p8.1.m1.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p8.1.m1.3.3.3.1.cmml" xref="A2.SS1.p8.1.m1.3.3.3">subscript</csymbol><ci id="A2.SS1.p8.1.m1.3.3.3.2.cmml" xref="A2.SS1.p8.1.m1.3.3.3.2">𝒗</ci><ci id="A2.SS1.p8.1.m1.3.3.3.3.cmml" xref="A2.SS1.p8.1.m1.3.3.3.3">𝑖</ci></apply><apply id="A2.SS1.p8.1.m1.3.3.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1"><times id="A2.SS1.p8.1.m1.3.3.1.2.cmml" xref="A2.SS1.p8.1.m1.3.3.1.2"></times><apply id="A2.SS1.p8.1.m1.3.3.1.3.cmml" xref="A2.SS1.p8.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="A2.SS1.p8.1.m1.3.3.1.3.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1.3">subscript</csymbol><ci id="A2.SS1.p8.1.m1.3.3.1.3.2a.cmml" xref="A2.SS1.p8.1.m1.3.3.1.3.2"><mtext id="A2.SS1.p8.1.m1.3.3.1.3.2.cmml" xref="A2.SS1.p8.1.m1.3.3.1.3.2">LayerNorm</mtext></ci><list id="A2.SS1.p8.1.m1.2.2.2.3.cmml" xref="A2.SS1.p8.1.m1.2.2.2.4"><ci id="A2.SS1.p8.1.m1.1.1.1.1.cmml" xref="A2.SS1.p8.1.m1.1.1.1.1">𝜸</ci><ci id="A2.SS1.p8.1.m1.2.2.2.2.cmml" xref="A2.SS1.p8.1.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.SS1.p8.1.m1.3.3.1.1.2.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="A2.SS1.p8.1.m1.3.3.1.1.2.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="A2.SS1.p8.1.m1.3.3.1.1.1.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p8.1.m1.3.3.1.1.1.1.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p8.1.m1.3.3.1.1.1.1.2.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1.2">𝐯</ci><ci id="A2.SS1.p8.1.m1.3.3.1.1.1.1.3.cmml" xref="A2.SS1.p8.1.m1.3.3.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A2.SS1.p8.1.m1.3.3.1.4.cmml" xref="A2.SS1.p8.1.m1.3.3.1.4"><csymbol cd="ambiguous" id="A2.SS1.p8.1.m1.3.3.1.4.1.cmml" xref="A2.SS1.p8.1.m1.3.3.1.4">subscript</csymbol><ci id="A2.SS1.p8.1.m1.3.3.1.4.2.cmml" xref="A2.SS1.p8.1.m1.3.3.1.4.2">𝑊</ci><ci id="A2.SS1.p8.1.m1.3.3.1.4.3a.cmml" xref="A2.SS1.p8.1.m1.3.3.1.4.3"><mtext id="A2.SS1.p8.1.m1.3.3.1.4.3.cmml" mathsize="70%" xref="A2.SS1.p8.1.m1.3.3.1.4.3">proj</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p8.1.m1.3c">\boldsymbol{v}_{i}=\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[%
\mathbf{v}_{i}]W_{\text{proj}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p8.1.m1.3d">bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] italic_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT</annotation></semantics></math>, we can write</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{x}=\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[%
\mathbf{x}]W_{\text{proj}}=\frac{\sum_{i}a_{i}\|\mathbf{v}_{i}-\mu_{\mathbf{v}%
_{i}}\|\boldsymbol{v}_{i}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}~{}." class="ltx_Math" display="block" id="A2.E20.m1.6"><semantics id="A2.E20.m1.6a"><mrow id="A2.E20.m1.6.6.1" xref="A2.E20.m1.6.6.1.1.cmml"><mrow id="A2.E20.m1.6.6.1.1" xref="A2.E20.m1.6.6.1.1.cmml"><mi id="A2.E20.m1.6.6.1.1.2" xref="A2.E20.m1.6.6.1.1.2.cmml">𝒙</mi><mo id="A2.E20.m1.6.6.1.1.3" xref="A2.E20.m1.6.6.1.1.3.cmml">=</mo><mrow id="A2.E20.m1.6.6.1.1.4" xref="A2.E20.m1.6.6.1.1.4.cmml"><msub id="A2.E20.m1.6.6.1.1.4.2" xref="A2.E20.m1.6.6.1.1.4.2.cmml"><mtext id="A2.E20.m1.6.6.1.1.4.2.2" xref="A2.E20.m1.6.6.1.1.4.2.2a.cmml">LayerNorm</mtext><mrow id="A2.E20.m1.2.2.2.4" xref="A2.E20.m1.2.2.2.3.cmml"><mi id="A2.E20.m1.1.1.1.1" xref="A2.E20.m1.1.1.1.1.cmml">𝜸</mi><mo id="A2.E20.m1.2.2.2.4.1" xref="A2.E20.m1.2.2.2.3.cmml">,</mo><mi id="A2.E20.m1.2.2.2.2" xref="A2.E20.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo id="A2.E20.m1.6.6.1.1.4.1" xref="A2.E20.m1.6.6.1.1.4.1.cmml">⁢</mo><mrow id="A2.E20.m1.6.6.1.1.4.3.2" xref="A2.E20.m1.6.6.1.1.4.3.1.cmml"><mo id="A2.E20.m1.6.6.1.1.4.3.2.1" stretchy="false" xref="A2.E20.m1.6.6.1.1.4.3.1.1.cmml">[</mo><mi id="A2.E20.m1.5.5" xref="A2.E20.m1.5.5.cmml">𝐱</mi><mo id="A2.E20.m1.6.6.1.1.4.3.2.2" stretchy="false" xref="A2.E20.m1.6.6.1.1.4.3.1.1.cmml">]</mo></mrow><mo id="A2.E20.m1.6.6.1.1.4.1a" xref="A2.E20.m1.6.6.1.1.4.1.cmml">⁢</mo><msub id="A2.E20.m1.6.6.1.1.4.4" xref="A2.E20.m1.6.6.1.1.4.4.cmml"><mi id="A2.E20.m1.6.6.1.1.4.4.2" xref="A2.E20.m1.6.6.1.1.4.4.2.cmml">W</mi><mtext id="A2.E20.m1.6.6.1.1.4.4.3" xref="A2.E20.m1.6.6.1.1.4.4.3a.cmml">proj</mtext></msub></mrow><mo id="A2.E20.m1.6.6.1.1.5" xref="A2.E20.m1.6.6.1.1.5.cmml">=</mo><mfrac id="A2.E20.m1.4.4" xref="A2.E20.m1.4.4.cmml"><mrow id="A2.E20.m1.3.3.1" xref="A2.E20.m1.3.3.1.cmml"><msub id="A2.E20.m1.3.3.1.2" xref="A2.E20.m1.3.3.1.2.cmml"><mo id="A2.E20.m1.3.3.1.2.2" xref="A2.E20.m1.3.3.1.2.2.cmml">∑</mo><mi id="A2.E20.m1.3.3.1.2.3" xref="A2.E20.m1.3.3.1.2.3.cmml">i</mi></msub><mrow id="A2.E20.m1.3.3.1.1" xref="A2.E20.m1.3.3.1.1.cmml"><msub id="A2.E20.m1.3.3.1.1.3" xref="A2.E20.m1.3.3.1.1.3.cmml"><mi id="A2.E20.m1.3.3.1.1.3.2" xref="A2.E20.m1.3.3.1.1.3.2.cmml">a</mi><mi id="A2.E20.m1.3.3.1.1.3.3" xref="A2.E20.m1.3.3.1.1.3.3.cmml">i</mi></msub><mo id="A2.E20.m1.3.3.1.1.2" xref="A2.E20.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="A2.E20.m1.3.3.1.1.1.1" xref="A2.E20.m1.3.3.1.1.1.2.cmml"><mo id="A2.E20.m1.3.3.1.1.1.1.2" stretchy="false" xref="A2.E20.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E20.m1.3.3.1.1.1.1.1" xref="A2.E20.m1.3.3.1.1.1.1.1.cmml"><msub id="A2.E20.m1.3.3.1.1.1.1.1.2" xref="A2.E20.m1.3.3.1.1.1.1.1.2.cmml"><mi id="A2.E20.m1.3.3.1.1.1.1.1.2.2" xref="A2.E20.m1.3.3.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E20.m1.3.3.1.1.1.1.1.2.3" xref="A2.E20.m1.3.3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.E20.m1.3.3.1.1.1.1.1.1" xref="A2.E20.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E20.m1.3.3.1.1.1.1.1.3" xref="A2.E20.m1.3.3.1.1.1.1.1.3.cmml"><mi id="A2.E20.m1.3.3.1.1.1.1.1.3.2" xref="A2.E20.m1.3.3.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E20.m1.3.3.1.1.1.1.1.3.3" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3.cmml"><mi id="A2.E20.m1.3.3.1.1.1.1.1.3.3.2" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E20.m1.3.3.1.1.1.1.1.3.3.3" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A2.E20.m1.3.3.1.1.1.1.3" stretchy="false" xref="A2.E20.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A2.E20.m1.3.3.1.1.2a" xref="A2.E20.m1.3.3.1.1.2.cmml">⁢</mo><msub id="A2.E20.m1.3.3.1.1.4" xref="A2.E20.m1.3.3.1.1.4.cmml"><mi id="A2.E20.m1.3.3.1.1.4.2" xref="A2.E20.m1.3.3.1.1.4.2.cmml">𝒗</mi><mi id="A2.E20.m1.3.3.1.1.4.3" xref="A2.E20.m1.3.3.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mrow id="A2.E20.m1.4.4.2.1" xref="A2.E20.m1.4.4.2.2.cmml"><mo id="A2.E20.m1.4.4.2.1.2" stretchy="false" xref="A2.E20.m1.4.4.2.2.1.cmml">‖</mo><mrow id="A2.E20.m1.4.4.2.1.1" xref="A2.E20.m1.4.4.2.1.1.cmml"><mi id="A2.E20.m1.4.4.2.1.1.2" xref="A2.E20.m1.4.4.2.1.1.2.cmml">𝐱</mi><mo id="A2.E20.m1.4.4.2.1.1.1" xref="A2.E20.m1.4.4.2.1.1.1.cmml">−</mo><msub id="A2.E20.m1.4.4.2.1.1.3" xref="A2.E20.m1.4.4.2.1.1.3.cmml"><mi id="A2.E20.m1.4.4.2.1.1.3.2" xref="A2.E20.m1.4.4.2.1.1.3.2.cmml">μ</mi><mi id="A2.E20.m1.4.4.2.1.1.3.3" xref="A2.E20.m1.4.4.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E20.m1.4.4.2.1.3" stretchy="false" xref="A2.E20.m1.4.4.2.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A2.E20.m1.6.6.1.2" lspace="0.330em" xref="A2.E20.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E20.m1.6b"><apply id="A2.E20.m1.6.6.1.1.cmml" xref="A2.E20.m1.6.6.1"><and id="A2.E20.m1.6.6.1.1a.cmml" xref="A2.E20.m1.6.6.1"></and><apply id="A2.E20.m1.6.6.1.1b.cmml" xref="A2.E20.m1.6.6.1"><eq id="A2.E20.m1.6.6.1.1.3.cmml" xref="A2.E20.m1.6.6.1.1.3"></eq><ci id="A2.E20.m1.6.6.1.1.2.cmml" xref="A2.E20.m1.6.6.1.1.2">𝒙</ci><apply id="A2.E20.m1.6.6.1.1.4.cmml" xref="A2.E20.m1.6.6.1.1.4"><times id="A2.E20.m1.6.6.1.1.4.1.cmml" xref="A2.E20.m1.6.6.1.1.4.1"></times><apply id="A2.E20.m1.6.6.1.1.4.2.cmml" xref="A2.E20.m1.6.6.1.1.4.2"><csymbol cd="ambiguous" id="A2.E20.m1.6.6.1.1.4.2.1.cmml" xref="A2.E20.m1.6.6.1.1.4.2">subscript</csymbol><ci id="A2.E20.m1.6.6.1.1.4.2.2a.cmml" xref="A2.E20.m1.6.6.1.1.4.2.2"><mtext id="A2.E20.m1.6.6.1.1.4.2.2.cmml" xref="A2.E20.m1.6.6.1.1.4.2.2">LayerNorm</mtext></ci><list id="A2.E20.m1.2.2.2.3.cmml" xref="A2.E20.m1.2.2.2.4"><ci id="A2.E20.m1.1.1.1.1.cmml" xref="A2.E20.m1.1.1.1.1">𝜸</ci><ci id="A2.E20.m1.2.2.2.2.cmml" xref="A2.E20.m1.2.2.2.2">𝜷</ci></list></apply><apply id="A2.E20.m1.6.6.1.1.4.3.1.cmml" xref="A2.E20.m1.6.6.1.1.4.3.2"><csymbol cd="latexml" id="A2.E20.m1.6.6.1.1.4.3.1.1.cmml" xref="A2.E20.m1.6.6.1.1.4.3.2.1">delimited-[]</csymbol><ci id="A2.E20.m1.5.5.cmml" xref="A2.E20.m1.5.5">𝐱</ci></apply><apply id="A2.E20.m1.6.6.1.1.4.4.cmml" xref="A2.E20.m1.6.6.1.1.4.4"><csymbol cd="ambiguous" id="A2.E20.m1.6.6.1.1.4.4.1.cmml" xref="A2.E20.m1.6.6.1.1.4.4">subscript</csymbol><ci id="A2.E20.m1.6.6.1.1.4.4.2.cmml" xref="A2.E20.m1.6.6.1.1.4.4.2">𝑊</ci><ci id="A2.E20.m1.6.6.1.1.4.4.3a.cmml" xref="A2.E20.m1.6.6.1.1.4.4.3"><mtext id="A2.E20.m1.6.6.1.1.4.4.3.cmml" mathsize="70%" xref="A2.E20.m1.6.6.1.1.4.4.3">proj</mtext></ci></apply></apply></apply><apply id="A2.E20.m1.6.6.1.1c.cmml" xref="A2.E20.m1.6.6.1"><eq id="A2.E20.m1.6.6.1.1.5.cmml" xref="A2.E20.m1.6.6.1.1.5"></eq><share href="https://arxiv.org/html/2505.20229v1#A2.E20.m1.6.6.1.1.4.cmml" id="A2.E20.m1.6.6.1.1d.cmml" xref="A2.E20.m1.6.6.1"></share><apply id="A2.E20.m1.4.4.cmml" xref="A2.E20.m1.4.4"><divide id="A2.E20.m1.4.4.3.cmml" xref="A2.E20.m1.4.4"></divide><apply id="A2.E20.m1.3.3.1.cmml" xref="A2.E20.m1.3.3.1"><apply id="A2.E20.m1.3.3.1.2.cmml" xref="A2.E20.m1.3.3.1.2"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.2.1.cmml" xref="A2.E20.m1.3.3.1.2">subscript</csymbol><sum id="A2.E20.m1.3.3.1.2.2.cmml" xref="A2.E20.m1.3.3.1.2.2"></sum><ci id="A2.E20.m1.3.3.1.2.3.cmml" xref="A2.E20.m1.3.3.1.2.3">𝑖</ci></apply><apply id="A2.E20.m1.3.3.1.1.cmml" xref="A2.E20.m1.3.3.1.1"><times id="A2.E20.m1.3.3.1.1.2.cmml" xref="A2.E20.m1.3.3.1.1.2"></times><apply id="A2.E20.m1.3.3.1.1.3.cmml" xref="A2.E20.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.1.3.1.cmml" xref="A2.E20.m1.3.3.1.1.3">subscript</csymbol><ci id="A2.E20.m1.3.3.1.1.3.2.cmml" xref="A2.E20.m1.3.3.1.1.3.2">𝑎</ci><ci id="A2.E20.m1.3.3.1.1.3.3.cmml" xref="A2.E20.m1.3.3.1.1.3.3">𝑖</ci></apply><apply id="A2.E20.m1.3.3.1.1.1.2.cmml" xref="A2.E20.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A2.E20.m1.3.3.1.1.1.2.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="A2.E20.m1.3.3.1.1.1.1.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1"><minus id="A2.E20.m1.3.3.1.1.1.1.1.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.1"></minus><apply id="A2.E20.m1.3.3.1.1.1.1.1.2.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E20.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E20.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E20.m1.3.3.1.1.1.1.1.3.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E20.m1.3.3.1.1.1.1.1.3.2.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E20.m1.3.3.1.1.1.1.1.3.3.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E20.m1.3.3.1.1.1.1.1.3.3.2.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E20.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="A2.E20.m1.3.3.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A2.E20.m1.3.3.1.1.4.cmml" xref="A2.E20.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.1.1.4.1.cmml" xref="A2.E20.m1.3.3.1.1.4">subscript</csymbol><ci id="A2.E20.m1.3.3.1.1.4.2.cmml" xref="A2.E20.m1.3.3.1.1.4.2">𝒗</ci><ci id="A2.E20.m1.3.3.1.1.4.3.cmml" xref="A2.E20.m1.3.3.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="A2.E20.m1.4.4.2.2.cmml" xref="A2.E20.m1.4.4.2.1"><csymbol cd="latexml" id="A2.E20.m1.4.4.2.2.1.cmml" xref="A2.E20.m1.4.4.2.1.2">norm</csymbol><apply id="A2.E20.m1.4.4.2.1.1.cmml" xref="A2.E20.m1.4.4.2.1.1"><minus id="A2.E20.m1.4.4.2.1.1.1.cmml" xref="A2.E20.m1.4.4.2.1.1.1"></minus><ci id="A2.E20.m1.4.4.2.1.1.2.cmml" xref="A2.E20.m1.4.4.2.1.1.2">𝐱</ci><apply id="A2.E20.m1.4.4.2.1.1.3.cmml" xref="A2.E20.m1.4.4.2.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m1.4.4.2.1.1.3.1.cmml" xref="A2.E20.m1.4.4.2.1.1.3">subscript</csymbol><ci id="A2.E20.m1.4.4.2.1.1.3.2.cmml" xref="A2.E20.m1.4.4.2.1.1.3.2">𝜇</ci><ci id="A2.E20.m1.4.4.2.1.1.3.3.cmml" xref="A2.E20.m1.4.4.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E20.m1.6c">\boldsymbol{x}=\text{LayerNorm}_{\boldsymbol{\gamma},\boldsymbol{\beta}}[%
\mathbf{x}]W_{\text{proj}}=\frac{\sum_{i}a_{i}\|\mathbf{v}_{i}-\mu_{\mathbf{v}%
_{i}}\|\boldsymbol{v}_{i}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E20.m1.6d">bold_italic_x = LayerNorm start_POSTSUBSCRIPT bold_italic_γ , bold_italic_β end_POSTSUBSCRIPT [ bold_x ] italic_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p9">
<p class="ltx_p" id="A2.SS1.p9.1">Now, by inserting this last formulation into <math alttext="\frac{\partial}{\partial a_{j}}\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.SS1.p9.1.m1.1"><semantics id="A2.SS1.p9.1.m1.1a"><mrow id="A2.SS1.p9.1.m1.1.1" xref="A2.SS1.p9.1.m1.1.1.cmml"><mfrac id="A2.SS1.p9.1.m1.1.1.2" xref="A2.SS1.p9.1.m1.1.1.2.cmml"><mo id="A2.SS1.p9.1.m1.1.1.2.2" xref="A2.SS1.p9.1.m1.1.1.2.2.cmml">∂</mo><mrow id="A2.SS1.p9.1.m1.1.1.2.3" xref="A2.SS1.p9.1.m1.1.1.2.3.cmml"><mo id="A2.SS1.p9.1.m1.1.1.2.3.1" rspace="0em" xref="A2.SS1.p9.1.m1.1.1.2.3.1.cmml">∂</mo><msub id="A2.SS1.p9.1.m1.1.1.2.3.2" xref="A2.SS1.p9.1.m1.1.1.2.3.2.cmml"><mi id="A2.SS1.p9.1.m1.1.1.2.3.2.2" xref="A2.SS1.p9.1.m1.1.1.2.3.2.2.cmml">a</mi><mi id="A2.SS1.p9.1.m1.1.1.2.3.2.3" xref="A2.SS1.p9.1.m1.1.1.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.SS1.p9.1.m1.1.1.1" xref="A2.SS1.p9.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.SS1.p9.1.m1.1.1.3" xref="A2.SS1.p9.1.m1.1.1.3.cmml">𝒙</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p9.1.m1.1b"><apply id="A2.SS1.p9.1.m1.1.1.cmml" xref="A2.SS1.p9.1.m1.1.1"><times id="A2.SS1.p9.1.m1.1.1.1.cmml" xref="A2.SS1.p9.1.m1.1.1.1"></times><apply id="A2.SS1.p9.1.m1.1.1.2.cmml" xref="A2.SS1.p9.1.m1.1.1.2"><divide id="A2.SS1.p9.1.m1.1.1.2.1.cmml" xref="A2.SS1.p9.1.m1.1.1.2"></divide><partialdiff id="A2.SS1.p9.1.m1.1.1.2.2.cmml" xref="A2.SS1.p9.1.m1.1.1.2.2"></partialdiff><apply id="A2.SS1.p9.1.m1.1.1.2.3.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3"><partialdiff id="A2.SS1.p9.1.m1.1.1.2.3.1.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3.1"></partialdiff><apply id="A2.SS1.p9.1.m1.1.1.2.3.2.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p9.1.m1.1.1.2.3.2.1.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p9.1.m1.1.1.2.3.2.2.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3.2.2">𝑎</ci><ci id="A2.SS1.p9.1.m1.1.1.2.3.2.3.cmml" xref="A2.SS1.p9.1.m1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.SS1.p9.1.m1.1.1.3.cmml" xref="A2.SS1.p9.1.m1.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p9.1.m1.1c">\frac{\partial}{\partial a_{j}}\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p9.1.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x</annotation></semantics></math>, we receive</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial}{\partial a_{j}}\boldsymbol{x}=\ \frac{\partial}{\partial a_{j}%
}\frac{\sum_{i}a_{i}\|\mathbf{v}_{i}-\mu_{\mathbf{v}_{i}}\|\boldsymbol{v}_{i}}%
{\|\mathbf{x}-\mu_{\mathbf{x}}\|}=\frac{\|\mathbf{x}-\mu_{\mathbf{x}}\|\|%
\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|\boldsymbol{v}_{j}-\sum_{i}a_{i}\|\mathbf%
{v}_{i}-\mu_{\mathbf{v}_{i}}\|\boldsymbol{v}_{i}\frac{\partial}{\partial a_{j}%
}\|\mathbf{x}-\mu_{\mathbf{x}}\|}{\|\mathbf{x}-\mu_{\mathbf{x}}\|^{2}}~{}," class="ltx_Math" display="block" id="A2.E21.m1.8"><semantics id="A2.E21.m1.8a"><mrow id="A2.E21.m1.8.8.1" xref="A2.E21.m1.8.8.1.1.cmml"><mrow id="A2.E21.m1.8.8.1.1" xref="A2.E21.m1.8.8.1.1.cmml"><mrow id="A2.E21.m1.8.8.1.1.2" xref="A2.E21.m1.8.8.1.1.2.cmml"><mfrac id="A2.E21.m1.8.8.1.1.2.2" xref="A2.E21.m1.8.8.1.1.2.2.cmml"><mo id="A2.E21.m1.8.8.1.1.2.2.2" xref="A2.E21.m1.8.8.1.1.2.2.2.cmml">∂</mo><mrow id="A2.E21.m1.8.8.1.1.2.2.3" xref="A2.E21.m1.8.8.1.1.2.2.3.cmml"><mo id="A2.E21.m1.8.8.1.1.2.2.3.1" rspace="0em" xref="A2.E21.m1.8.8.1.1.2.2.3.1.cmml">∂</mo><msub id="A2.E21.m1.8.8.1.1.2.2.3.2" xref="A2.E21.m1.8.8.1.1.2.2.3.2.cmml"><mi id="A2.E21.m1.8.8.1.1.2.2.3.2.2" xref="A2.E21.m1.8.8.1.1.2.2.3.2.2.cmml">a</mi><mi id="A2.E21.m1.8.8.1.1.2.2.3.2.3" xref="A2.E21.m1.8.8.1.1.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E21.m1.8.8.1.1.2.1" xref="A2.E21.m1.8.8.1.1.2.1.cmml">⁢</mo><mi id="A2.E21.m1.8.8.1.1.2.3" xref="A2.E21.m1.8.8.1.1.2.3.cmml">𝒙</mi></mrow><mo id="A2.E21.m1.8.8.1.1.3" rspace="0.778em" xref="A2.E21.m1.8.8.1.1.3.cmml">=</mo><mrow id="A2.E21.m1.8.8.1.1.4" xref="A2.E21.m1.8.8.1.1.4.cmml"><mfrac id="A2.E21.m1.8.8.1.1.4.2" xref="A2.E21.m1.8.8.1.1.4.2.cmml"><mo id="A2.E21.m1.8.8.1.1.4.2.2" xref="A2.E21.m1.8.8.1.1.4.2.2.cmml">∂</mo><mrow id="A2.E21.m1.8.8.1.1.4.2.3" xref="A2.E21.m1.8.8.1.1.4.2.3.cmml"><mo id="A2.E21.m1.8.8.1.1.4.2.3.1" rspace="0em" xref="A2.E21.m1.8.8.1.1.4.2.3.1.cmml">∂</mo><msub id="A2.E21.m1.8.8.1.1.4.2.3.2" xref="A2.E21.m1.8.8.1.1.4.2.3.2.cmml"><mi id="A2.E21.m1.8.8.1.1.4.2.3.2.2" xref="A2.E21.m1.8.8.1.1.4.2.3.2.2.cmml">a</mi><mi id="A2.E21.m1.8.8.1.1.4.2.3.2.3" xref="A2.E21.m1.8.8.1.1.4.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E21.m1.8.8.1.1.4.1" xref="A2.E21.m1.8.8.1.1.4.1.cmml">⁢</mo><mfrac id="A2.E21.m1.2.2" xref="A2.E21.m1.2.2.cmml"><mrow id="A2.E21.m1.1.1.1" xref="A2.E21.m1.1.1.1.cmml"><msub id="A2.E21.m1.1.1.1.2" xref="A2.E21.m1.1.1.1.2.cmml"><mo id="A2.E21.m1.1.1.1.2.2" xref="A2.E21.m1.1.1.1.2.2.cmml">∑</mo><mi id="A2.E21.m1.1.1.1.2.3" xref="A2.E21.m1.1.1.1.2.3.cmml">i</mi></msub><mrow id="A2.E21.m1.1.1.1.1" xref="A2.E21.m1.1.1.1.1.cmml"><msub id="A2.E21.m1.1.1.1.1.3" xref="A2.E21.m1.1.1.1.1.3.cmml"><mi id="A2.E21.m1.1.1.1.1.3.2" xref="A2.E21.m1.1.1.1.1.3.2.cmml">a</mi><mi id="A2.E21.m1.1.1.1.1.3.3" xref="A2.E21.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A2.E21.m1.1.1.1.1.2" xref="A2.E21.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E21.m1.1.1.1.1.1.1" xref="A2.E21.m1.1.1.1.1.1.2.cmml"><mo id="A2.E21.m1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E21.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E21.m1.1.1.1.1.1.1.1" xref="A2.E21.m1.1.1.1.1.1.1.1.cmml"><msub id="A2.E21.m1.1.1.1.1.1.1.1.2" xref="A2.E21.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A2.E21.m1.1.1.1.1.1.1.1.2.2" xref="A2.E21.m1.1.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E21.m1.1.1.1.1.1.1.1.2.3" xref="A2.E21.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.E21.m1.1.1.1.1.1.1.1.1" xref="A2.E21.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E21.m1.1.1.1.1.1.1.1.3" xref="A2.E21.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E21.m1.1.1.1.1.1.1.1.3.2" xref="A2.E21.m1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E21.m1.1.1.1.1.1.1.1.3.3" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A2.E21.m1.1.1.1.1.1.1.1.3.3.2" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E21.m1.1.1.1.1.1.1.1.3.3.3" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A2.E21.m1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E21.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A2.E21.m1.1.1.1.1.2a" xref="A2.E21.m1.1.1.1.1.2.cmml">⁢</mo><msub id="A2.E21.m1.1.1.1.1.4" xref="A2.E21.m1.1.1.1.1.4.cmml"><mi id="A2.E21.m1.1.1.1.1.4.2" xref="A2.E21.m1.1.1.1.1.4.2.cmml">𝒗</mi><mi id="A2.E21.m1.1.1.1.1.4.3" xref="A2.E21.m1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mrow id="A2.E21.m1.2.2.2.1" xref="A2.E21.m1.2.2.2.2.cmml"><mo id="A2.E21.m1.2.2.2.1.2" stretchy="false" xref="A2.E21.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E21.m1.2.2.2.1.1" xref="A2.E21.m1.2.2.2.1.1.cmml"><mi id="A2.E21.m1.2.2.2.1.1.2" xref="A2.E21.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E21.m1.2.2.2.1.1.1" xref="A2.E21.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E21.m1.2.2.2.1.1.3" xref="A2.E21.m1.2.2.2.1.1.3.cmml"><mi id="A2.E21.m1.2.2.2.1.1.3.2" xref="A2.E21.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E21.m1.2.2.2.1.1.3.3" xref="A2.E21.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E21.m1.2.2.2.1.3" stretchy="false" xref="A2.E21.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A2.E21.m1.8.8.1.1.5" xref="A2.E21.m1.8.8.1.1.5.cmml">=</mo><mfrac id="A2.E21.m1.7.7" xref="A2.E21.m1.7.7.cmml"><mrow id="A2.E21.m1.6.6.4" xref="A2.E21.m1.6.6.4.cmml"><mrow id="A2.E21.m1.4.4.2.2" xref="A2.E21.m1.4.4.2.2.cmml"><mrow id="A2.E21.m1.3.3.1.1.1.1" xref="A2.E21.m1.3.3.1.1.1.2.cmml"><mo id="A2.E21.m1.3.3.1.1.1.1.2" stretchy="false" xref="A2.E21.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E21.m1.3.3.1.1.1.1.1" xref="A2.E21.m1.3.3.1.1.1.1.1.cmml"><mi id="A2.E21.m1.3.3.1.1.1.1.1.2" xref="A2.E21.m1.3.3.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E21.m1.3.3.1.1.1.1.1.1" xref="A2.E21.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E21.m1.3.3.1.1.1.1.1.3" xref="A2.E21.m1.3.3.1.1.1.1.1.3.cmml"><mi id="A2.E21.m1.3.3.1.1.1.1.1.3.2" xref="A2.E21.m1.3.3.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.E21.m1.3.3.1.1.1.1.1.3.3" xref="A2.E21.m1.3.3.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E21.m1.3.3.1.1.1.1.3" stretchy="false" xref="A2.E21.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A2.E21.m1.4.4.2.2.3" xref="A2.E21.m1.4.4.2.2.3.cmml">⁢</mo><mrow id="A2.E21.m1.4.4.2.2.2.1" xref="A2.E21.m1.4.4.2.2.2.2.cmml"><mo id="A2.E21.m1.4.4.2.2.2.1.2" stretchy="false" xref="A2.E21.m1.4.4.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E21.m1.4.4.2.2.2.1.1" xref="A2.E21.m1.4.4.2.2.2.1.1.cmml"><msub id="A2.E21.m1.4.4.2.2.2.1.1.2" xref="A2.E21.m1.4.4.2.2.2.1.1.2.cmml"><mi id="A2.E21.m1.4.4.2.2.2.1.1.2.2" xref="A2.E21.m1.4.4.2.2.2.1.1.2.2.cmml">𝐯</mi><mi id="A2.E21.m1.4.4.2.2.2.1.1.2.3" xref="A2.E21.m1.4.4.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="A2.E21.m1.4.4.2.2.2.1.1.1" xref="A2.E21.m1.4.4.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E21.m1.4.4.2.2.2.1.1.3" xref="A2.E21.m1.4.4.2.2.2.1.1.3.cmml"><mi id="A2.E21.m1.4.4.2.2.2.1.1.3.2" xref="A2.E21.m1.4.4.2.2.2.1.1.3.2.cmml">μ</mi><msub id="A2.E21.m1.4.4.2.2.2.1.1.3.3" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3.cmml"><mi id="A2.E21.m1.4.4.2.2.2.1.1.3.3.2" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E21.m1.4.4.2.2.2.1.1.3.3.3" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E21.m1.4.4.2.2.2.1.3" stretchy="false" xref="A2.E21.m1.4.4.2.2.2.2.1.cmml">‖</mo></mrow><mo id="A2.E21.m1.4.4.2.2.3a" xref="A2.E21.m1.4.4.2.2.3.cmml">⁢</mo><msub id="A2.E21.m1.4.4.2.2.4" xref="A2.E21.m1.4.4.2.2.4.cmml"><mi id="A2.E21.m1.4.4.2.2.4.2" xref="A2.E21.m1.4.4.2.2.4.2.cmml">𝒗</mi><mi id="A2.E21.m1.4.4.2.2.4.3" xref="A2.E21.m1.4.4.2.2.4.3.cmml">j</mi></msub></mrow><mo id="A2.E21.m1.6.6.4.5" rspace="0.055em" xref="A2.E21.m1.6.6.4.5.cmml">−</mo><mrow id="A2.E21.m1.6.6.4.4" xref="A2.E21.m1.6.6.4.4.cmml"><msub id="A2.E21.m1.6.6.4.4.3" xref="A2.E21.m1.6.6.4.4.3.cmml"><mo id="A2.E21.m1.6.6.4.4.3.2" xref="A2.E21.m1.6.6.4.4.3.2.cmml">∑</mo><mi id="A2.E21.m1.6.6.4.4.3.3" xref="A2.E21.m1.6.6.4.4.3.3.cmml">i</mi></msub><mrow id="A2.E21.m1.6.6.4.4.2" xref="A2.E21.m1.6.6.4.4.2.cmml"><msub id="A2.E21.m1.6.6.4.4.2.4" xref="A2.E21.m1.6.6.4.4.2.4.cmml"><mi id="A2.E21.m1.6.6.4.4.2.4.2" xref="A2.E21.m1.6.6.4.4.2.4.2.cmml">a</mi><mi id="A2.E21.m1.6.6.4.4.2.4.3" xref="A2.E21.m1.6.6.4.4.2.4.3.cmml">i</mi></msub><mo id="A2.E21.m1.6.6.4.4.2.3" xref="A2.E21.m1.6.6.4.4.2.3.cmml">⁢</mo><mrow id="A2.E21.m1.5.5.3.3.1.1.1" xref="A2.E21.m1.5.5.3.3.1.1.2.cmml"><mo id="A2.E21.m1.5.5.3.3.1.1.1.2" stretchy="false" xref="A2.E21.m1.5.5.3.3.1.1.2.1.cmml">‖</mo><mrow id="A2.E21.m1.5.5.3.3.1.1.1.1" xref="A2.E21.m1.5.5.3.3.1.1.1.1.cmml"><msub id="A2.E21.m1.5.5.3.3.1.1.1.1.2" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2.cmml"><mi id="A2.E21.m1.5.5.3.3.1.1.1.1.2.2" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E21.m1.5.5.3.3.1.1.1.1.2.3" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.E21.m1.5.5.3.3.1.1.1.1.1" xref="A2.E21.m1.5.5.3.3.1.1.1.1.1.cmml">−</mo><msub id="A2.E21.m1.5.5.3.3.1.1.1.1.3" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.cmml"><mi id="A2.E21.m1.5.5.3.3.1.1.1.1.3.2" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.cmml"><mi id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.2" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.3" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A2.E21.m1.5.5.3.3.1.1.1.3" stretchy="false" xref="A2.E21.m1.5.5.3.3.1.1.2.1.cmml">‖</mo></mrow><mo id="A2.E21.m1.6.6.4.4.2.3a" xref="A2.E21.m1.6.6.4.4.2.3.cmml">⁢</mo><msub id="A2.E21.m1.6.6.4.4.2.5" xref="A2.E21.m1.6.6.4.4.2.5.cmml"><mi id="A2.E21.m1.6.6.4.4.2.5.2" xref="A2.E21.m1.6.6.4.4.2.5.2.cmml">𝒗</mi><mi id="A2.E21.m1.6.6.4.4.2.5.3" xref="A2.E21.m1.6.6.4.4.2.5.3.cmml">i</mi></msub><mo id="A2.E21.m1.6.6.4.4.2.3b" xref="A2.E21.m1.6.6.4.4.2.3.cmml">⁢</mo><mfrac id="A2.E21.m1.6.6.4.4.2.6" xref="A2.E21.m1.6.6.4.4.2.6.cmml"><mo id="A2.E21.m1.6.6.4.4.2.6.2" xref="A2.E21.m1.6.6.4.4.2.6.2.cmml">∂</mo><mrow id="A2.E21.m1.6.6.4.4.2.6.3" xref="A2.E21.m1.6.6.4.4.2.6.3.cmml"><mo id="A2.E21.m1.6.6.4.4.2.6.3.1" rspace="0em" xref="A2.E21.m1.6.6.4.4.2.6.3.1.cmml">∂</mo><msub id="A2.E21.m1.6.6.4.4.2.6.3.2" xref="A2.E21.m1.6.6.4.4.2.6.3.2.cmml"><mi id="A2.E21.m1.6.6.4.4.2.6.3.2.2" xref="A2.E21.m1.6.6.4.4.2.6.3.2.2.cmml">a</mi><mi id="A2.E21.m1.6.6.4.4.2.6.3.2.3" xref="A2.E21.m1.6.6.4.4.2.6.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E21.m1.6.6.4.4.2.3c" xref="A2.E21.m1.6.6.4.4.2.3.cmml">⁢</mo><mrow id="A2.E21.m1.6.6.4.4.2.2.1" xref="A2.E21.m1.6.6.4.4.2.2.2.cmml"><mo id="A2.E21.m1.6.6.4.4.2.2.1.2" stretchy="false" xref="A2.E21.m1.6.6.4.4.2.2.2.1.cmml">‖</mo><mrow id="A2.E21.m1.6.6.4.4.2.2.1.1" xref="A2.E21.m1.6.6.4.4.2.2.1.1.cmml"><mi id="A2.E21.m1.6.6.4.4.2.2.1.1.2" xref="A2.E21.m1.6.6.4.4.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E21.m1.6.6.4.4.2.2.1.1.1" xref="A2.E21.m1.6.6.4.4.2.2.1.1.1.cmml">−</mo><msub id="A2.E21.m1.6.6.4.4.2.2.1.1.3" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3.cmml"><mi id="A2.E21.m1.6.6.4.4.2.2.1.1.3.2" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E21.m1.6.6.4.4.2.2.1.1.3.3" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E21.m1.6.6.4.4.2.2.1.3" stretchy="false" xref="A2.E21.m1.6.6.4.4.2.2.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><msup id="A2.E21.m1.7.7.5" xref="A2.E21.m1.7.7.5.cmml"><mrow id="A2.E21.m1.7.7.5.1.1" xref="A2.E21.m1.7.7.5.1.2.cmml"><mo id="A2.E21.m1.7.7.5.1.1.2" stretchy="false" xref="A2.E21.m1.7.7.5.1.2.1.cmml">‖</mo><mrow id="A2.E21.m1.7.7.5.1.1.1" xref="A2.E21.m1.7.7.5.1.1.1.cmml"><mi id="A2.E21.m1.7.7.5.1.1.1.2" xref="A2.E21.m1.7.7.5.1.1.1.2.cmml">𝐱</mi><mo id="A2.E21.m1.7.7.5.1.1.1.1" xref="A2.E21.m1.7.7.5.1.1.1.1.cmml">−</mo><msub id="A2.E21.m1.7.7.5.1.1.1.3" xref="A2.E21.m1.7.7.5.1.1.1.3.cmml"><mi id="A2.E21.m1.7.7.5.1.1.1.3.2" xref="A2.E21.m1.7.7.5.1.1.1.3.2.cmml">μ</mi><mi id="A2.E21.m1.7.7.5.1.1.1.3.3" xref="A2.E21.m1.7.7.5.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E21.m1.7.7.5.1.1.3" stretchy="false" xref="A2.E21.m1.7.7.5.1.2.1.cmml">‖</mo></mrow><mn id="A2.E21.m1.7.7.5.3" xref="A2.E21.m1.7.7.5.3.cmml">2</mn></msup></mfrac></mrow><mo id="A2.E21.m1.8.8.1.2" lspace="0.330em" xref="A2.E21.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E21.m1.8b"><apply id="A2.E21.m1.8.8.1.1.cmml" xref="A2.E21.m1.8.8.1"><and id="A2.E21.m1.8.8.1.1a.cmml" xref="A2.E21.m1.8.8.1"></and><apply id="A2.E21.m1.8.8.1.1b.cmml" xref="A2.E21.m1.8.8.1"><eq id="A2.E21.m1.8.8.1.1.3.cmml" xref="A2.E21.m1.8.8.1.1.3"></eq><apply id="A2.E21.m1.8.8.1.1.2.cmml" xref="A2.E21.m1.8.8.1.1.2"><times id="A2.E21.m1.8.8.1.1.2.1.cmml" xref="A2.E21.m1.8.8.1.1.2.1"></times><apply id="A2.E21.m1.8.8.1.1.2.2.cmml" xref="A2.E21.m1.8.8.1.1.2.2"><divide id="A2.E21.m1.8.8.1.1.2.2.1.cmml" xref="A2.E21.m1.8.8.1.1.2.2"></divide><partialdiff id="A2.E21.m1.8.8.1.1.2.2.2.cmml" xref="A2.E21.m1.8.8.1.1.2.2.2"></partialdiff><apply id="A2.E21.m1.8.8.1.1.2.2.3.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3"><partialdiff id="A2.E21.m1.8.8.1.1.2.2.3.1.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3.1"></partialdiff><apply id="A2.E21.m1.8.8.1.1.2.2.3.2.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3.2"><csymbol cd="ambiguous" id="A2.E21.m1.8.8.1.1.2.2.3.2.1.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3.2">subscript</csymbol><ci id="A2.E21.m1.8.8.1.1.2.2.3.2.2.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3.2.2">𝑎</ci><ci id="A2.E21.m1.8.8.1.1.2.2.3.2.3.cmml" xref="A2.E21.m1.8.8.1.1.2.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.E21.m1.8.8.1.1.2.3.cmml" xref="A2.E21.m1.8.8.1.1.2.3">𝒙</ci></apply><apply id="A2.E21.m1.8.8.1.1.4.cmml" xref="A2.E21.m1.8.8.1.1.4"><times id="A2.E21.m1.8.8.1.1.4.1.cmml" xref="A2.E21.m1.8.8.1.1.4.1"></times><apply id="A2.E21.m1.8.8.1.1.4.2.cmml" xref="A2.E21.m1.8.8.1.1.4.2"><divide id="A2.E21.m1.8.8.1.1.4.2.1.cmml" xref="A2.E21.m1.8.8.1.1.4.2"></divide><partialdiff id="A2.E21.m1.8.8.1.1.4.2.2.cmml" xref="A2.E21.m1.8.8.1.1.4.2.2"></partialdiff><apply id="A2.E21.m1.8.8.1.1.4.2.3.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3"><partialdiff id="A2.E21.m1.8.8.1.1.4.2.3.1.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3.1"></partialdiff><apply id="A2.E21.m1.8.8.1.1.4.2.3.2.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3.2"><csymbol cd="ambiguous" id="A2.E21.m1.8.8.1.1.4.2.3.2.1.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3.2">subscript</csymbol><ci id="A2.E21.m1.8.8.1.1.4.2.3.2.2.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3.2.2">𝑎</ci><ci id="A2.E21.m1.8.8.1.1.4.2.3.2.3.cmml" xref="A2.E21.m1.8.8.1.1.4.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E21.m1.2.2.cmml" xref="A2.E21.m1.2.2"><divide id="A2.E21.m1.2.2.3.cmml" xref="A2.E21.m1.2.2"></divide><apply id="A2.E21.m1.1.1.1.cmml" xref="A2.E21.m1.1.1.1"><apply id="A2.E21.m1.1.1.1.2.cmml" xref="A2.E21.m1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.2.1.cmml" xref="A2.E21.m1.1.1.1.2">subscript</csymbol><sum id="A2.E21.m1.1.1.1.2.2.cmml" xref="A2.E21.m1.1.1.1.2.2"></sum><ci id="A2.E21.m1.1.1.1.2.3.cmml" xref="A2.E21.m1.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E21.m1.1.1.1.1.cmml" xref="A2.E21.m1.1.1.1.1"><times id="A2.E21.m1.1.1.1.1.2.cmml" xref="A2.E21.m1.1.1.1.1.2"></times><apply id="A2.E21.m1.1.1.1.1.3.cmml" xref="A2.E21.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.1.3.1.cmml" xref="A2.E21.m1.1.1.1.1.3">subscript</csymbol><ci id="A2.E21.m1.1.1.1.1.3.2.cmml" xref="A2.E21.m1.1.1.1.1.3.2">𝑎</ci><ci id="A2.E21.m1.1.1.1.1.3.3.cmml" xref="A2.E21.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A2.E21.m1.1.1.1.1.1.2.cmml" xref="A2.E21.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E21.m1.1.1.1.1.1.2.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A2.E21.m1.1.1.1.1.1.1.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1"><minus id="A2.E21.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.1"></minus><apply id="A2.E21.m1.1.1.1.1.1.1.1.2.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E21.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E21.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E21.m1.1.1.1.1.1.1.1.3.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E21.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E21.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E21.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E21.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A2.E21.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A2.E21.m1.1.1.1.1.4.cmml" xref="A2.E21.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E21.m1.1.1.1.1.4.1.cmml" xref="A2.E21.m1.1.1.1.1.4">subscript</csymbol><ci id="A2.E21.m1.1.1.1.1.4.2.cmml" xref="A2.E21.m1.1.1.1.1.4.2">𝒗</ci><ci id="A2.E21.m1.1.1.1.1.4.3.cmml" xref="A2.E21.m1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="A2.E21.m1.2.2.2.2.cmml" xref="A2.E21.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E21.m1.2.2.2.2.1.cmml" xref="A2.E21.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E21.m1.2.2.2.1.1.cmml" xref="A2.E21.m1.2.2.2.1.1"><minus id="A2.E21.m1.2.2.2.1.1.1.cmml" xref="A2.E21.m1.2.2.2.1.1.1"></minus><ci id="A2.E21.m1.2.2.2.1.1.2.cmml" xref="A2.E21.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E21.m1.2.2.2.1.1.3.cmml" xref="A2.E21.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.2.2.2.1.1.3.1.cmml" xref="A2.E21.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E21.m1.2.2.2.1.1.3.2.cmml" xref="A2.E21.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E21.m1.2.2.2.1.1.3.3.cmml" xref="A2.E21.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply><apply id="A2.E21.m1.8.8.1.1c.cmml" xref="A2.E21.m1.8.8.1"><eq id="A2.E21.m1.8.8.1.1.5.cmml" xref="A2.E21.m1.8.8.1.1.5"></eq><share href="https://arxiv.org/html/2505.20229v1#A2.E21.m1.8.8.1.1.4.cmml" id="A2.E21.m1.8.8.1.1d.cmml" xref="A2.E21.m1.8.8.1"></share><apply id="A2.E21.m1.7.7.cmml" xref="A2.E21.m1.7.7"><divide id="A2.E21.m1.7.7.6.cmml" xref="A2.E21.m1.7.7"></divide><apply id="A2.E21.m1.6.6.4.cmml" xref="A2.E21.m1.6.6.4"><minus id="A2.E21.m1.6.6.4.5.cmml" xref="A2.E21.m1.6.6.4.5"></minus><apply id="A2.E21.m1.4.4.2.2.cmml" xref="A2.E21.m1.4.4.2.2"><times id="A2.E21.m1.4.4.2.2.3.cmml" xref="A2.E21.m1.4.4.2.2.3"></times><apply id="A2.E21.m1.3.3.1.1.1.2.cmml" xref="A2.E21.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A2.E21.m1.3.3.1.1.1.2.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="A2.E21.m1.3.3.1.1.1.1.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1"><minus id="A2.E21.m1.3.3.1.1.1.1.1.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.1"></minus><ci id="A2.E21.m1.3.3.1.1.1.1.1.2.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.2">𝐱</ci><apply id="A2.E21.m1.3.3.1.1.1.1.1.3.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E21.m1.3.3.1.1.1.1.1.3.2.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.3.2">𝜇</ci><ci id="A2.E21.m1.3.3.1.1.1.1.1.3.3.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1.3.3">𝐱</ci></apply></apply></apply><apply id="A2.E21.m1.4.4.2.2.2.2.cmml" xref="A2.E21.m1.4.4.2.2.2.1"><csymbol cd="latexml" id="A2.E21.m1.4.4.2.2.2.2.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.2">norm</csymbol><apply id="A2.E21.m1.4.4.2.2.2.1.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1"><minus id="A2.E21.m1.4.4.2.2.2.1.1.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.1"></minus><apply id="A2.E21.m1.4.4.2.2.2.1.1.2.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.2.2.1.1.2.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.2">subscript</csymbol><ci id="A2.E21.m1.4.4.2.2.2.1.1.2.2.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.2.2">𝐯</ci><ci id="A2.E21.m1.4.4.2.2.2.1.1.2.3.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="A2.E21.m1.4.4.2.2.2.1.1.3.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.2.2.1.1.3.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E21.m1.4.4.2.2.2.1.1.3.2.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3.2">𝜇</ci><apply id="A2.E21.m1.4.4.2.2.2.1.1.3.3.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.2.2.1.1.3.3.1.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3">subscript</csymbol><ci id="A2.E21.m1.4.4.2.2.2.1.1.3.3.2.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3.2">𝐯</ci><ci id="A2.E21.m1.4.4.2.2.2.1.1.3.3.3.cmml" xref="A2.E21.m1.4.4.2.2.2.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E21.m1.4.4.2.2.4.cmml" xref="A2.E21.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.2.4.1.cmml" xref="A2.E21.m1.4.4.2.2.4">subscript</csymbol><ci id="A2.E21.m1.4.4.2.2.4.2.cmml" xref="A2.E21.m1.4.4.2.2.4.2">𝒗</ci><ci id="A2.E21.m1.4.4.2.2.4.3.cmml" xref="A2.E21.m1.4.4.2.2.4.3">𝑗</ci></apply></apply><apply id="A2.E21.m1.6.6.4.4.cmml" xref="A2.E21.m1.6.6.4.4"><apply id="A2.E21.m1.6.6.4.4.3.cmml" xref="A2.E21.m1.6.6.4.4.3"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.4.4.3.1.cmml" xref="A2.E21.m1.6.6.4.4.3">subscript</csymbol><sum id="A2.E21.m1.6.6.4.4.3.2.cmml" xref="A2.E21.m1.6.6.4.4.3.2"></sum><ci id="A2.E21.m1.6.6.4.4.3.3.cmml" xref="A2.E21.m1.6.6.4.4.3.3">𝑖</ci></apply><apply id="A2.E21.m1.6.6.4.4.2.cmml" xref="A2.E21.m1.6.6.4.4.2"><times id="A2.E21.m1.6.6.4.4.2.3.cmml" xref="A2.E21.m1.6.6.4.4.2.3"></times><apply id="A2.E21.m1.6.6.4.4.2.4.cmml" xref="A2.E21.m1.6.6.4.4.2.4"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.4.4.2.4.1.cmml" xref="A2.E21.m1.6.6.4.4.2.4">subscript</csymbol><ci id="A2.E21.m1.6.6.4.4.2.4.2.cmml" xref="A2.E21.m1.6.6.4.4.2.4.2">𝑎</ci><ci id="A2.E21.m1.6.6.4.4.2.4.3.cmml" xref="A2.E21.m1.6.6.4.4.2.4.3">𝑖</ci></apply><apply id="A2.E21.m1.5.5.3.3.1.1.2.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1"><csymbol cd="latexml" id="A2.E21.m1.5.5.3.3.1.1.2.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.2">norm</csymbol><apply id="A2.E21.m1.5.5.3.3.1.1.1.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1"><minus id="A2.E21.m1.5.5.3.3.1.1.1.1.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.1"></minus><apply id="A2.E21.m1.5.5.3.3.1.1.1.1.2.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.5.5.3.3.1.1.1.1.2.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2">subscript</csymbol><ci id="A2.E21.m1.5.5.3.3.1.1.1.1.2.2.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2.2">𝐯</ci><ci id="A2.E21.m1.5.5.3.3.1.1.1.1.2.3.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="A2.E21.m1.5.5.3.3.1.1.1.1.3.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.5.5.3.3.1.1.1.1.3.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3">subscript</csymbol><ci id="A2.E21.m1.5.5.3.3.1.1.1.1.3.2.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.2">𝜇</ci><apply id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.1.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.2.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.3.cmml" xref="A2.E21.m1.5.5.3.3.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A2.E21.m1.6.6.4.4.2.5.cmml" xref="A2.E21.m1.6.6.4.4.2.5"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.4.4.2.5.1.cmml" xref="A2.E21.m1.6.6.4.4.2.5">subscript</csymbol><ci id="A2.E21.m1.6.6.4.4.2.5.2.cmml" xref="A2.E21.m1.6.6.4.4.2.5.2">𝒗</ci><ci id="A2.E21.m1.6.6.4.4.2.5.3.cmml" xref="A2.E21.m1.6.6.4.4.2.5.3">𝑖</ci></apply><apply id="A2.E21.m1.6.6.4.4.2.6.cmml" xref="A2.E21.m1.6.6.4.4.2.6"><divide id="A2.E21.m1.6.6.4.4.2.6.1.cmml" xref="A2.E21.m1.6.6.4.4.2.6"></divide><partialdiff id="A2.E21.m1.6.6.4.4.2.6.2.cmml" xref="A2.E21.m1.6.6.4.4.2.6.2"></partialdiff><apply id="A2.E21.m1.6.6.4.4.2.6.3.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3"><partialdiff id="A2.E21.m1.6.6.4.4.2.6.3.1.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3.1"></partialdiff><apply id="A2.E21.m1.6.6.4.4.2.6.3.2.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3.2"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.4.4.2.6.3.2.1.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3.2">subscript</csymbol><ci id="A2.E21.m1.6.6.4.4.2.6.3.2.2.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3.2.2">𝑎</ci><ci id="A2.E21.m1.6.6.4.4.2.6.3.2.3.cmml" xref="A2.E21.m1.6.6.4.4.2.6.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E21.m1.6.6.4.4.2.2.2.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1"><csymbol cd="latexml" id="A2.E21.m1.6.6.4.4.2.2.2.1.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.2">norm</csymbol><apply id="A2.E21.m1.6.6.4.4.2.2.1.1.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1"><minus id="A2.E21.m1.6.6.4.4.2.2.1.1.1.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.1"></minus><ci id="A2.E21.m1.6.6.4.4.2.2.1.1.2.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.2">𝐱</ci><apply id="A2.E21.m1.6.6.4.4.2.2.1.1.3.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.4.4.2.2.1.1.3.1.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3">subscript</csymbol><ci id="A2.E21.m1.6.6.4.4.2.2.1.1.3.2.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3.2">𝜇</ci><ci id="A2.E21.m1.6.6.4.4.2.2.1.1.3.3.cmml" xref="A2.E21.m1.6.6.4.4.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply><apply id="A2.E21.m1.7.7.5.cmml" xref="A2.E21.m1.7.7.5"><csymbol cd="ambiguous" id="A2.E21.m1.7.7.5.2.cmml" xref="A2.E21.m1.7.7.5">superscript</csymbol><apply id="A2.E21.m1.7.7.5.1.2.cmml" xref="A2.E21.m1.7.7.5.1.1"><csymbol cd="latexml" id="A2.E21.m1.7.7.5.1.2.1.cmml" xref="A2.E21.m1.7.7.5.1.1.2">norm</csymbol><apply id="A2.E21.m1.7.7.5.1.1.1.cmml" xref="A2.E21.m1.7.7.5.1.1.1"><minus id="A2.E21.m1.7.7.5.1.1.1.1.cmml" xref="A2.E21.m1.7.7.5.1.1.1.1"></minus><ci id="A2.E21.m1.7.7.5.1.1.1.2.cmml" xref="A2.E21.m1.7.7.5.1.1.1.2">𝐱</ci><apply id="A2.E21.m1.7.7.5.1.1.1.3.cmml" xref="A2.E21.m1.7.7.5.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.7.7.5.1.1.1.3.1.cmml" xref="A2.E21.m1.7.7.5.1.1.1.3">subscript</csymbol><ci id="A2.E21.m1.7.7.5.1.1.1.3.2.cmml" xref="A2.E21.m1.7.7.5.1.1.1.3.2">𝜇</ci><ci id="A2.E21.m1.7.7.5.1.1.1.3.3.cmml" xref="A2.E21.m1.7.7.5.1.1.1.3.3">𝐱</ci></apply></apply></apply><cn id="A2.E21.m1.7.7.5.3.cmml" type="integer" xref="A2.E21.m1.7.7.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E21.m1.8c">\frac{\partial}{\partial a_{j}}\boldsymbol{x}=\ \frac{\partial}{\partial a_{j}%
}\frac{\sum_{i}a_{i}\|\mathbf{v}_{i}-\mu_{\mathbf{v}_{i}}\|\boldsymbol{v}_{i}}%
{\|\mathbf{x}-\mu_{\mathbf{x}}\|}=\frac{\|\mathbf{x}-\mu_{\mathbf{x}}\|\|%
\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|\boldsymbol{v}_{j}-\sum_{i}a_{i}\|\mathbf%
{v}_{i}-\mu_{\mathbf{v}_{i}}\|\boldsymbol{v}_{i}\frac{\partial}{\partial a_{j}%
}\|\mathbf{x}-\mu_{\mathbf{x}}\|}{\|\mathbf{x}-\mu_{\mathbf{x}}\|^{2}}~{},</annotation><annotation encoding="application/x-llamapun" id="A2.E21.m1.8d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x = divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG divide start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG = divide start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p9.2">where we have used the quotient rule again.
We now aim to solve for the term of <math alttext="\frac{\partial}{\partial a_{j}}\|\mathbf{x}-\mu_{\mathbf{x}}\|" class="ltx_Math" display="inline" id="A2.SS1.p9.2.m1.1"><semantics id="A2.SS1.p9.2.m1.1a"><mrow id="A2.SS1.p9.2.m1.1.1" xref="A2.SS1.p9.2.m1.1.1.cmml"><mfrac id="A2.SS1.p9.2.m1.1.1.3" xref="A2.SS1.p9.2.m1.1.1.3.cmml"><mo id="A2.SS1.p9.2.m1.1.1.3.2" xref="A2.SS1.p9.2.m1.1.1.3.2.cmml">∂</mo><mrow id="A2.SS1.p9.2.m1.1.1.3.3" xref="A2.SS1.p9.2.m1.1.1.3.3.cmml"><mo id="A2.SS1.p9.2.m1.1.1.3.3.1" rspace="0em" xref="A2.SS1.p9.2.m1.1.1.3.3.1.cmml">∂</mo><msub id="A2.SS1.p9.2.m1.1.1.3.3.2" xref="A2.SS1.p9.2.m1.1.1.3.3.2.cmml"><mi id="A2.SS1.p9.2.m1.1.1.3.3.2.2" xref="A2.SS1.p9.2.m1.1.1.3.3.2.2.cmml">a</mi><mi id="A2.SS1.p9.2.m1.1.1.3.3.2.3" xref="A2.SS1.p9.2.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.SS1.p9.2.m1.1.1.2" xref="A2.SS1.p9.2.m1.1.1.2.cmml">⁢</mo><mrow id="A2.SS1.p9.2.m1.1.1.1.1" xref="A2.SS1.p9.2.m1.1.1.1.2.cmml"><mo id="A2.SS1.p9.2.m1.1.1.1.1.2" stretchy="false" xref="A2.SS1.p9.2.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.SS1.p9.2.m1.1.1.1.1.1" xref="A2.SS1.p9.2.m1.1.1.1.1.1.cmml"><mi id="A2.SS1.p9.2.m1.1.1.1.1.1.2" xref="A2.SS1.p9.2.m1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.SS1.p9.2.m1.1.1.1.1.1.1" xref="A2.SS1.p9.2.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.SS1.p9.2.m1.1.1.1.1.1.3" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3.cmml"><mi id="A2.SS1.p9.2.m1.1.1.1.1.1.3.2" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.SS1.p9.2.m1.1.1.1.1.1.3.3" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.SS1.p9.2.m1.1.1.1.1.3" stretchy="false" xref="A2.SS1.p9.2.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p9.2.m1.1b"><apply id="A2.SS1.p9.2.m1.1.1.cmml" xref="A2.SS1.p9.2.m1.1.1"><times id="A2.SS1.p9.2.m1.1.1.2.cmml" xref="A2.SS1.p9.2.m1.1.1.2"></times><apply id="A2.SS1.p9.2.m1.1.1.3.cmml" xref="A2.SS1.p9.2.m1.1.1.3"><divide id="A2.SS1.p9.2.m1.1.1.3.1.cmml" xref="A2.SS1.p9.2.m1.1.1.3"></divide><partialdiff id="A2.SS1.p9.2.m1.1.1.3.2.cmml" xref="A2.SS1.p9.2.m1.1.1.3.2"></partialdiff><apply id="A2.SS1.p9.2.m1.1.1.3.3.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3"><partialdiff id="A2.SS1.p9.2.m1.1.1.3.3.1.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3.1"></partialdiff><apply id="A2.SS1.p9.2.m1.1.1.3.3.2.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.SS1.p9.2.m1.1.1.3.3.2.1.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3.2">subscript</csymbol><ci id="A2.SS1.p9.2.m1.1.1.3.3.2.2.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3.2.2">𝑎</ci><ci id="A2.SS1.p9.2.m1.1.1.3.3.2.3.cmml" xref="A2.SS1.p9.2.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.SS1.p9.2.m1.1.1.1.2.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1"><csymbol cd="latexml" id="A2.SS1.p9.2.m1.1.1.1.2.1.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.2">norm</csymbol><apply id="A2.SS1.p9.2.m1.1.1.1.1.1.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1"><minus id="A2.SS1.p9.2.m1.1.1.1.1.1.1.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.1"></minus><ci id="A2.SS1.p9.2.m1.1.1.1.1.1.2.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.2">𝐱</ci><apply id="A2.SS1.p9.2.m1.1.1.1.1.1.3.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p9.2.m1.1.1.1.1.1.3.1.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.SS1.p9.2.m1.1.1.1.1.1.3.2.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3.2">𝜇</ci><ci id="A2.SS1.p9.2.m1.1.1.1.1.1.3.3.cmml" xref="A2.SS1.p9.2.m1.1.1.1.1.1.3.3">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p9.2.m1.1c">\frac{\partial}{\partial a_{j}}\|\mathbf{x}-\mu_{\mathbf{x}}\|</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p9.2.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥</annotation></semantics></math> given as</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial}{\partial a_{j}}\|\mathbf{x}-\mu_{\mathbf{x}}\|=\frac{(\mathbf{%
x}-\mu_{\mathbf{x}})\cdot(\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}})}{\|\mathbf{x}-%
\mu_{\mathbf{x}}\|}~{}," class="ltx_Math" display="block" id="A2.E22.m1.4"><semantics id="A2.E22.m1.4a"><mrow id="A2.E22.m1.4.4.1" xref="A2.E22.m1.4.4.1.1.cmml"><mrow id="A2.E22.m1.4.4.1.1" xref="A2.E22.m1.4.4.1.1.cmml"><mrow id="A2.E22.m1.4.4.1.1.1" xref="A2.E22.m1.4.4.1.1.1.cmml"><mfrac id="A2.E22.m1.4.4.1.1.1.3" xref="A2.E22.m1.4.4.1.1.1.3.cmml"><mo id="A2.E22.m1.4.4.1.1.1.3.2" xref="A2.E22.m1.4.4.1.1.1.3.2.cmml">∂</mo><mrow id="A2.E22.m1.4.4.1.1.1.3.3" xref="A2.E22.m1.4.4.1.1.1.3.3.cmml"><mo id="A2.E22.m1.4.4.1.1.1.3.3.1" rspace="0em" xref="A2.E22.m1.4.4.1.1.1.3.3.1.cmml">∂</mo><msub id="A2.E22.m1.4.4.1.1.1.3.3.2" xref="A2.E22.m1.4.4.1.1.1.3.3.2.cmml"><mi id="A2.E22.m1.4.4.1.1.1.3.3.2.2" xref="A2.E22.m1.4.4.1.1.1.3.3.2.2.cmml">a</mi><mi id="A2.E22.m1.4.4.1.1.1.3.3.2.3" xref="A2.E22.m1.4.4.1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.E22.m1.4.4.1.1.1.2" xref="A2.E22.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A2.E22.m1.4.4.1.1.1.1.1" xref="A2.E22.m1.4.4.1.1.1.1.2.cmml"><mo id="A2.E22.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="A2.E22.m1.4.4.1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E22.m1.4.4.1.1.1.1.1.1" xref="A2.E22.m1.4.4.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.4.4.1.1.1.1.1.1.2" xref="A2.E22.m1.4.4.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E22.m1.4.4.1.1.1.1.1.1.1" xref="A2.E22.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E22.m1.4.4.1.1.1.1.1.1.3" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="A2.E22.m1.4.4.1.1.1.1.1.1.3.2" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.E22.m1.4.4.1.1.1.1.1.1.3.3" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E22.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="A2.E22.m1.4.4.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A2.E22.m1.4.4.1.1.2" xref="A2.E22.m1.4.4.1.1.2.cmml">=</mo><mfrac id="A2.E22.m1.3.3" xref="A2.E22.m1.3.3.cmml"><mrow id="A2.E22.m1.2.2.2" xref="A2.E22.m1.2.2.2.cmml"><mrow id="A2.E22.m1.1.1.1.1.1" xref="A2.E22.m1.1.1.1.1.1.1.cmml"><mo id="A2.E22.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E22.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E22.m1.1.1.1.1.1.1" xref="A2.E22.m1.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.1.1.1.1.1.1.2" xref="A2.E22.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E22.m1.1.1.1.1.1.1.1" xref="A2.E22.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E22.m1.1.1.1.1.1.1.3" xref="A2.E22.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E22.m1.1.1.1.1.1.1.3.2" xref="A2.E22.m1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.E22.m1.1.1.1.1.1.1.3.3" xref="A2.E22.m1.1.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E22.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A2.E22.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E22.m1.2.2.2.3" rspace="0.222em" xref="A2.E22.m1.2.2.2.3.cmml">⋅</mo><mrow id="A2.E22.m1.2.2.2.2.1" xref="A2.E22.m1.2.2.2.2.1.1.cmml"><mo id="A2.E22.m1.2.2.2.2.1.2" stretchy="false" xref="A2.E22.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="A2.E22.m1.2.2.2.2.1.1" xref="A2.E22.m1.2.2.2.2.1.1.cmml"><msub id="A2.E22.m1.2.2.2.2.1.1.2" xref="A2.E22.m1.2.2.2.2.1.1.2.cmml"><mi id="A2.E22.m1.2.2.2.2.1.1.2.2" xref="A2.E22.m1.2.2.2.2.1.1.2.2.cmml">𝐯</mi><mi id="A2.E22.m1.2.2.2.2.1.1.2.3" xref="A2.E22.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="A2.E22.m1.2.2.2.2.1.1.1" xref="A2.E22.m1.2.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E22.m1.2.2.2.2.1.1.3" xref="A2.E22.m1.2.2.2.2.1.1.3.cmml"><mi id="A2.E22.m1.2.2.2.2.1.1.3.2" xref="A2.E22.m1.2.2.2.2.1.1.3.2.cmml">μ</mi><msub id="A2.E22.m1.2.2.2.2.1.1.3.3" xref="A2.E22.m1.2.2.2.2.1.1.3.3.cmml"><mi id="A2.E22.m1.2.2.2.2.1.1.3.3.2" xref="A2.E22.m1.2.2.2.2.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E22.m1.2.2.2.2.1.1.3.3.3" xref="A2.E22.m1.2.2.2.2.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E22.m1.2.2.2.2.1.3" stretchy="false" xref="A2.E22.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E22.m1.3.3.3.1" xref="A2.E22.m1.3.3.3.2.cmml"><mo id="A2.E22.m1.3.3.3.1.2" stretchy="false" xref="A2.E22.m1.3.3.3.2.1.cmml">‖</mo><mrow id="A2.E22.m1.3.3.3.1.1" xref="A2.E22.m1.3.3.3.1.1.cmml"><mi id="A2.E22.m1.3.3.3.1.1.2" xref="A2.E22.m1.3.3.3.1.1.2.cmml">𝐱</mi><mo id="A2.E22.m1.3.3.3.1.1.1" xref="A2.E22.m1.3.3.3.1.1.1.cmml">−</mo><msub id="A2.E22.m1.3.3.3.1.1.3" xref="A2.E22.m1.3.3.3.1.1.3.cmml"><mi id="A2.E22.m1.3.3.3.1.1.3.2" xref="A2.E22.m1.3.3.3.1.1.3.2.cmml">μ</mi><mi id="A2.E22.m1.3.3.3.1.1.3.3" xref="A2.E22.m1.3.3.3.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E22.m1.3.3.3.1.3" stretchy="false" xref="A2.E22.m1.3.3.3.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="A2.E22.m1.4.4.1.2" lspace="0.330em" xref="A2.E22.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E22.m1.4b"><apply id="A2.E22.m1.4.4.1.1.cmml" xref="A2.E22.m1.4.4.1"><eq id="A2.E22.m1.4.4.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.2"></eq><apply id="A2.E22.m1.4.4.1.1.1.cmml" xref="A2.E22.m1.4.4.1.1.1"><times id="A2.E22.m1.4.4.1.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.1.2"></times><apply id="A2.E22.m1.4.4.1.1.1.3.cmml" xref="A2.E22.m1.4.4.1.1.1.3"><divide id="A2.E22.m1.4.4.1.1.1.3.1.cmml" xref="A2.E22.m1.4.4.1.1.1.3"></divide><partialdiff id="A2.E22.m1.4.4.1.1.1.3.2.cmml" xref="A2.E22.m1.4.4.1.1.1.3.2"></partialdiff><apply id="A2.E22.m1.4.4.1.1.1.3.3.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3"><partialdiff id="A2.E22.m1.4.4.1.1.1.3.3.1.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3.1"></partialdiff><apply id="A2.E22.m1.4.4.1.1.1.3.3.2.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.E22.m1.4.4.1.1.1.3.3.2.1.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3.2">subscript</csymbol><ci id="A2.E22.m1.4.4.1.1.1.3.3.2.2.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3.2.2">𝑎</ci><ci id="A2.E22.m1.4.4.1.1.1.3.3.2.3.cmml" xref="A2.E22.m1.4.4.1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E22.m1.4.4.1.1.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="A2.E22.m1.4.4.1.1.1.1.2.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.2">norm</csymbol><apply id="A2.E22.m1.4.4.1.1.1.1.1.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1"><minus id="A2.E22.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.1"></minus><ci id="A2.E22.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.2">𝐱</ci><apply id="A2.E22.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E22.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3.2">𝜇</ci><ci id="A2.E22.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="A2.E22.m1.4.4.1.1.1.1.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E22.m1.3.3.cmml" xref="A2.E22.m1.3.3"><divide id="A2.E22.m1.3.3.4.cmml" xref="A2.E22.m1.3.3"></divide><apply id="A2.E22.m1.2.2.2.cmml" xref="A2.E22.m1.2.2.2"><ci id="A2.E22.m1.2.2.2.3.cmml" xref="A2.E22.m1.2.2.2.3">⋅</ci><apply id="A2.E22.m1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.1.1.1.1.1"><minus id="A2.E22.m1.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.1.1.1.1.1.1.1"></minus><ci id="A2.E22.m1.1.1.1.1.1.1.2.cmml" xref="A2.E22.m1.1.1.1.1.1.1.2">𝐱</ci><apply id="A2.E22.m1.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E22.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E22.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E22.m1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="A2.E22.m1.1.1.1.1.1.1.3.3.cmml" xref="A2.E22.m1.1.1.1.1.1.1.3.3">𝐱</ci></apply></apply><apply id="A2.E22.m1.2.2.2.2.1.1.cmml" xref="A2.E22.m1.2.2.2.2.1"><minus id="A2.E22.m1.2.2.2.2.1.1.1.cmml" xref="A2.E22.m1.2.2.2.2.1.1.1"></minus><apply id="A2.E22.m1.2.2.2.2.1.1.2.cmml" xref="A2.E22.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.E22.m1.2.2.2.2.1.1.2.1.cmml" xref="A2.E22.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A2.E22.m1.2.2.2.2.1.1.2.2.cmml" xref="A2.E22.m1.2.2.2.2.1.1.2.2">𝐯</ci><ci id="A2.E22.m1.2.2.2.2.1.1.2.3.cmml" xref="A2.E22.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="A2.E22.m1.2.2.2.2.1.1.3.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.2.2.2.2.1.1.3.1.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E22.m1.2.2.2.2.1.1.3.2.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3.2">𝜇</ci><apply id="A2.E22.m1.2.2.2.2.1.1.3.3.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A2.E22.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="A2.E22.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3.3.2">𝐯</ci><ci id="A2.E22.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A2.E22.m1.2.2.2.2.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E22.m1.3.3.3.2.cmml" xref="A2.E22.m1.3.3.3.1"><csymbol cd="latexml" id="A2.E22.m1.3.3.3.2.1.cmml" xref="A2.E22.m1.3.3.3.1.2">norm</csymbol><apply id="A2.E22.m1.3.3.3.1.1.cmml" xref="A2.E22.m1.3.3.3.1.1"><minus id="A2.E22.m1.3.3.3.1.1.1.cmml" xref="A2.E22.m1.3.3.3.1.1.1"></minus><ci id="A2.E22.m1.3.3.3.1.1.2.cmml" xref="A2.E22.m1.3.3.3.1.1.2">𝐱</ci><apply id="A2.E22.m1.3.3.3.1.1.3.cmml" xref="A2.E22.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.3.3.3.1.1.3.1.cmml" xref="A2.E22.m1.3.3.3.1.1.3">subscript</csymbol><ci id="A2.E22.m1.3.3.3.1.1.3.2.cmml" xref="A2.E22.m1.3.3.3.1.1.3.2">𝜇</ci><ci id="A2.E22.m1.3.3.3.1.1.3.3.cmml" xref="A2.E22.m1.3.3.3.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E22.m1.4c">\frac{\partial}{\partial a_{j}}\|\mathbf{x}-\mu_{\mathbf{x}}\|=\frac{(\mathbf{%
x}-\mu_{\mathbf{x}})\cdot(\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}})}{\|\mathbf{x}-%
\mu_{\mathbf{x}}\|}~{},</annotation><annotation encoding="application/x-llamapun" id="A2.E22.m1.4d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ = divide start_ARG ( bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ) ⋅ ( bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p9.3">which,
inserted into previous result for <math alttext="\frac{\partial}{\partial a_{j}}\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.SS1.p9.3.m1.1"><semantics id="A2.SS1.p9.3.m1.1a"><mrow id="A2.SS1.p9.3.m1.1.1" xref="A2.SS1.p9.3.m1.1.1.cmml"><mfrac id="A2.SS1.p9.3.m1.1.1.2" xref="A2.SS1.p9.3.m1.1.1.2.cmml"><mo id="A2.SS1.p9.3.m1.1.1.2.2" xref="A2.SS1.p9.3.m1.1.1.2.2.cmml">∂</mo><mrow id="A2.SS1.p9.3.m1.1.1.2.3" xref="A2.SS1.p9.3.m1.1.1.2.3.cmml"><mo id="A2.SS1.p9.3.m1.1.1.2.3.1" rspace="0em" xref="A2.SS1.p9.3.m1.1.1.2.3.1.cmml">∂</mo><msub id="A2.SS1.p9.3.m1.1.1.2.3.2" xref="A2.SS1.p9.3.m1.1.1.2.3.2.cmml"><mi id="A2.SS1.p9.3.m1.1.1.2.3.2.2" xref="A2.SS1.p9.3.m1.1.1.2.3.2.2.cmml">a</mi><mi id="A2.SS1.p9.3.m1.1.1.2.3.2.3" xref="A2.SS1.p9.3.m1.1.1.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.SS1.p9.3.m1.1.1.1" xref="A2.SS1.p9.3.m1.1.1.1.cmml">⁢</mo><mi id="A2.SS1.p9.3.m1.1.1.3" xref="A2.SS1.p9.3.m1.1.1.3.cmml">𝒙</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p9.3.m1.1b"><apply id="A2.SS1.p9.3.m1.1.1.cmml" xref="A2.SS1.p9.3.m1.1.1"><times id="A2.SS1.p9.3.m1.1.1.1.cmml" xref="A2.SS1.p9.3.m1.1.1.1"></times><apply id="A2.SS1.p9.3.m1.1.1.2.cmml" xref="A2.SS1.p9.3.m1.1.1.2"><divide id="A2.SS1.p9.3.m1.1.1.2.1.cmml" xref="A2.SS1.p9.3.m1.1.1.2"></divide><partialdiff id="A2.SS1.p9.3.m1.1.1.2.2.cmml" xref="A2.SS1.p9.3.m1.1.1.2.2"></partialdiff><apply id="A2.SS1.p9.3.m1.1.1.2.3.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3"><partialdiff id="A2.SS1.p9.3.m1.1.1.2.3.1.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3.1"></partialdiff><apply id="A2.SS1.p9.3.m1.1.1.2.3.2.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p9.3.m1.1.1.2.3.2.1.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3.2">subscript</csymbol><ci id="A2.SS1.p9.3.m1.1.1.2.3.2.2.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3.2.2">𝑎</ci><ci id="A2.SS1.p9.3.m1.1.1.2.3.2.3.cmml" xref="A2.SS1.p9.3.m1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.SS1.p9.3.m1.1.1.3.cmml" xref="A2.SS1.p9.3.m1.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p9.3.m1.1c">\frac{\partial}{\partial a_{j}}\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p9.3.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x</annotation></semantics></math> gives</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx3">
<tbody id="A2.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial}{\partial a_{j}}\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.E23.m1.1"><semantics id="A2.E23.m1.1a"><mrow id="A2.E23.m1.1.1" xref="A2.E23.m1.1.1.cmml"><mstyle displaystyle="true" id="A2.E23.m1.1.1.2" xref="A2.E23.m1.1.1.2.cmml"><mfrac id="A2.E23.m1.1.1.2a" xref="A2.E23.m1.1.1.2.cmml"><mo id="A2.E23.m1.1.1.2.2" xref="A2.E23.m1.1.1.2.2.cmml">∂</mo><mrow id="A2.E23.m1.1.1.2.3" xref="A2.E23.m1.1.1.2.3.cmml"><mo id="A2.E23.m1.1.1.2.3.1" rspace="0em" xref="A2.E23.m1.1.1.2.3.1.cmml">∂</mo><msub id="A2.E23.m1.1.1.2.3.2" xref="A2.E23.m1.1.1.2.3.2.cmml"><mi id="A2.E23.m1.1.1.2.3.2.2" xref="A2.E23.m1.1.1.2.3.2.2.cmml">a</mi><mi id="A2.E23.m1.1.1.2.3.2.3" xref="A2.E23.m1.1.1.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo id="A2.E23.m1.1.1.1" xref="A2.E23.m1.1.1.1.cmml">⁢</mo><mi id="A2.E23.m1.1.1.3" xref="A2.E23.m1.1.1.3.cmml">𝒙</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.E23.m1.1b"><apply id="A2.E23.m1.1.1.cmml" xref="A2.E23.m1.1.1"><times id="A2.E23.m1.1.1.1.cmml" xref="A2.E23.m1.1.1.1"></times><apply id="A2.E23.m1.1.1.2.cmml" xref="A2.E23.m1.1.1.2"><divide id="A2.E23.m1.1.1.2.1.cmml" xref="A2.E23.m1.1.1.2"></divide><partialdiff id="A2.E23.m1.1.1.2.2.cmml" xref="A2.E23.m1.1.1.2.2"></partialdiff><apply id="A2.E23.m1.1.1.2.3.cmml" xref="A2.E23.m1.1.1.2.3"><partialdiff id="A2.E23.m1.1.1.2.3.1.cmml" xref="A2.E23.m1.1.1.2.3.1"></partialdiff><apply id="A2.E23.m1.1.1.2.3.2.cmml" xref="A2.E23.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.E23.m1.1.1.2.3.2.1.cmml" xref="A2.E23.m1.1.1.2.3.2">subscript</csymbol><ci id="A2.E23.m1.1.1.2.3.2.2.cmml" xref="A2.E23.m1.1.1.2.3.2.2">𝑎</ci><ci id="A2.E23.m1.1.1.2.3.2.3.cmml" xref="A2.E23.m1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><ci id="A2.E23.m1.1.1.3.cmml" xref="A2.E23.m1.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E23.m1.1c">\displaystyle\frac{\partial}{\partial a_{j}}\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.E23.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\|\mathbf{x}-\mu_{\mathbf{x}}\|\|\mathbf{v}_{j}-\mu_{%
\mathbf{v}_{j}}\|\boldsymbol{v}_{j}-\boldsymbol{x}(\mathbf{x}-\mu_{\mathbf{x}}%
)\cdot(\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}})}{\|\mathbf{x}-\mu_{\mathbf{x}}\|^{%
2}}" class="ltx_Math" display="inline" id="A2.E23.m2.5"><semantics id="A2.E23.m2.5a"><mrow id="A2.E23.m2.5.6" xref="A2.E23.m2.5.6.cmml"><mi id="A2.E23.m2.5.6.2" xref="A2.E23.m2.5.6.2.cmml"></mi><mo id="A2.E23.m2.5.6.1" xref="A2.E23.m2.5.6.1.cmml">=</mo><mstyle displaystyle="true" id="A2.E23.m2.5.5" xref="A2.E23.m2.5.5.cmml"><mfrac id="A2.E23.m2.5.5a" xref="A2.E23.m2.5.5.cmml"><mrow id="A2.E23.m2.4.4.4" xref="A2.E23.m2.4.4.4.cmml"><mrow id="A2.E23.m2.2.2.2.2" xref="A2.E23.m2.2.2.2.2.cmml"><mrow id="A2.E23.m2.1.1.1.1.1.1" xref="A2.E23.m2.1.1.1.1.1.2.cmml"><mo id="A2.E23.m2.1.1.1.1.1.1.2" stretchy="false" xref="A2.E23.m2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E23.m2.1.1.1.1.1.1.1" xref="A2.E23.m2.1.1.1.1.1.1.1.cmml"><mi id="A2.E23.m2.1.1.1.1.1.1.1.2" xref="A2.E23.m2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E23.m2.1.1.1.1.1.1.1.1" xref="A2.E23.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E23.m2.1.1.1.1.1.1.1.3" xref="A2.E23.m2.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E23.m2.1.1.1.1.1.1.1.3.2" xref="A2.E23.m2.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.E23.m2.1.1.1.1.1.1.1.3.3" xref="A2.E23.m2.1.1.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E23.m2.1.1.1.1.1.1.3" stretchy="false" xref="A2.E23.m2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A2.E23.m2.2.2.2.2.3" xref="A2.E23.m2.2.2.2.2.3.cmml">⁢</mo><mrow id="A2.E23.m2.2.2.2.2.2.1" xref="A2.E23.m2.2.2.2.2.2.2.cmml"><mo id="A2.E23.m2.2.2.2.2.2.1.2" stretchy="false" xref="A2.E23.m2.2.2.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E23.m2.2.2.2.2.2.1.1" xref="A2.E23.m2.2.2.2.2.2.1.1.cmml"><msub id="A2.E23.m2.2.2.2.2.2.1.1.2" xref="A2.E23.m2.2.2.2.2.2.1.1.2.cmml"><mi id="A2.E23.m2.2.2.2.2.2.1.1.2.2" xref="A2.E23.m2.2.2.2.2.2.1.1.2.2.cmml">𝐯</mi><mi id="A2.E23.m2.2.2.2.2.2.1.1.2.3" xref="A2.E23.m2.2.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="A2.E23.m2.2.2.2.2.2.1.1.1" xref="A2.E23.m2.2.2.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E23.m2.2.2.2.2.2.1.1.3" xref="A2.E23.m2.2.2.2.2.2.1.1.3.cmml"><mi id="A2.E23.m2.2.2.2.2.2.1.1.3.2" xref="A2.E23.m2.2.2.2.2.2.1.1.3.2.cmml">μ</mi><msub id="A2.E23.m2.2.2.2.2.2.1.1.3.3" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3.cmml"><mi id="A2.E23.m2.2.2.2.2.2.1.1.3.3.2" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E23.m2.2.2.2.2.2.1.1.3.3.3" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E23.m2.2.2.2.2.2.1.3" stretchy="false" xref="A2.E23.m2.2.2.2.2.2.2.1.cmml">‖</mo></mrow><mo id="A2.E23.m2.2.2.2.2.3a" xref="A2.E23.m2.2.2.2.2.3.cmml">⁢</mo><msub id="A2.E23.m2.2.2.2.2.4" xref="A2.E23.m2.2.2.2.2.4.cmml"><mi id="A2.E23.m2.2.2.2.2.4.2" xref="A2.E23.m2.2.2.2.2.4.2.cmml">𝒗</mi><mi id="A2.E23.m2.2.2.2.2.4.3" xref="A2.E23.m2.2.2.2.2.4.3.cmml">j</mi></msub></mrow><mo id="A2.E23.m2.4.4.4.5" xref="A2.E23.m2.4.4.4.5.cmml">−</mo><mrow id="A2.E23.m2.4.4.4.4" xref="A2.E23.m2.4.4.4.4.cmml"><mrow id="A2.E23.m2.3.3.3.3.1" xref="A2.E23.m2.3.3.3.3.1.cmml"><mi id="A2.E23.m2.3.3.3.3.1.3" xref="A2.E23.m2.3.3.3.3.1.3.cmml">𝒙</mi><mo id="A2.E23.m2.3.3.3.3.1.2" xref="A2.E23.m2.3.3.3.3.1.2.cmml">⁢</mo><mrow id="A2.E23.m2.3.3.3.3.1.1.1" xref="A2.E23.m2.3.3.3.3.1.1.1.1.cmml"><mo id="A2.E23.m2.3.3.3.3.1.1.1.2" stretchy="false" xref="A2.E23.m2.3.3.3.3.1.1.1.1.cmml">(</mo><mrow id="A2.E23.m2.3.3.3.3.1.1.1.1" xref="A2.E23.m2.3.3.3.3.1.1.1.1.cmml"><mi id="A2.E23.m2.3.3.3.3.1.1.1.1.2" xref="A2.E23.m2.3.3.3.3.1.1.1.1.2.cmml">𝐱</mi><mo id="A2.E23.m2.3.3.3.3.1.1.1.1.1" xref="A2.E23.m2.3.3.3.3.1.1.1.1.1.cmml">−</mo><msub id="A2.E23.m2.3.3.3.3.1.1.1.1.3" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3.cmml"><mi id="A2.E23.m2.3.3.3.3.1.1.1.1.3.2" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3.2.cmml">μ</mi><mi id="A2.E23.m2.3.3.3.3.1.1.1.1.3.3" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E23.m2.3.3.3.3.1.1.1.3" rspace="0.055em" stretchy="false" xref="A2.E23.m2.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E23.m2.4.4.4.4.3" rspace="0.222em" xref="A2.E23.m2.4.4.4.4.3.cmml">⋅</mo><mrow id="A2.E23.m2.4.4.4.4.2.1" xref="A2.E23.m2.4.4.4.4.2.1.1.cmml"><mo id="A2.E23.m2.4.4.4.4.2.1.2" stretchy="false" xref="A2.E23.m2.4.4.4.4.2.1.1.cmml">(</mo><mrow id="A2.E23.m2.4.4.4.4.2.1.1" xref="A2.E23.m2.4.4.4.4.2.1.1.cmml"><msub id="A2.E23.m2.4.4.4.4.2.1.1.2" xref="A2.E23.m2.4.4.4.4.2.1.1.2.cmml"><mi id="A2.E23.m2.4.4.4.4.2.1.1.2.2" xref="A2.E23.m2.4.4.4.4.2.1.1.2.2.cmml">𝐯</mi><mi id="A2.E23.m2.4.4.4.4.2.1.1.2.3" xref="A2.E23.m2.4.4.4.4.2.1.1.2.3.cmml">j</mi></msub><mo id="A2.E23.m2.4.4.4.4.2.1.1.1" xref="A2.E23.m2.4.4.4.4.2.1.1.1.cmml">−</mo><msub id="A2.E23.m2.4.4.4.4.2.1.1.3" xref="A2.E23.m2.4.4.4.4.2.1.1.3.cmml"><mi id="A2.E23.m2.4.4.4.4.2.1.1.3.2" xref="A2.E23.m2.4.4.4.4.2.1.1.3.2.cmml">μ</mi><msub id="A2.E23.m2.4.4.4.4.2.1.1.3.3" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3.cmml"><mi id="A2.E23.m2.4.4.4.4.2.1.1.3.3.2" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E23.m2.4.4.4.4.2.1.1.3.3.3" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E23.m2.4.4.4.4.2.1.3" stretchy="false" xref="A2.E23.m2.4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><msup id="A2.E23.m2.5.5.5" xref="A2.E23.m2.5.5.5.cmml"><mrow id="A2.E23.m2.5.5.5.1.1" xref="A2.E23.m2.5.5.5.1.2.cmml"><mo id="A2.E23.m2.5.5.5.1.1.2" stretchy="false" xref="A2.E23.m2.5.5.5.1.2.1.cmml">‖</mo><mrow id="A2.E23.m2.5.5.5.1.1.1" xref="A2.E23.m2.5.5.5.1.1.1.cmml"><mi id="A2.E23.m2.5.5.5.1.1.1.2" xref="A2.E23.m2.5.5.5.1.1.1.2.cmml">𝐱</mi><mo id="A2.E23.m2.5.5.5.1.1.1.1" xref="A2.E23.m2.5.5.5.1.1.1.1.cmml">−</mo><msub id="A2.E23.m2.5.5.5.1.1.1.3" xref="A2.E23.m2.5.5.5.1.1.1.3.cmml"><mi id="A2.E23.m2.5.5.5.1.1.1.3.2" xref="A2.E23.m2.5.5.5.1.1.1.3.2.cmml">μ</mi><mi id="A2.E23.m2.5.5.5.1.1.1.3.3" xref="A2.E23.m2.5.5.5.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E23.m2.5.5.5.1.1.3" stretchy="false" xref="A2.E23.m2.5.5.5.1.2.1.cmml">‖</mo></mrow><mn id="A2.E23.m2.5.5.5.3" xref="A2.E23.m2.5.5.5.3.cmml">2</mn></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A2.E23.m2.5b"><apply id="A2.E23.m2.5.6.cmml" xref="A2.E23.m2.5.6"><eq id="A2.E23.m2.5.6.1.cmml" xref="A2.E23.m2.5.6.1"></eq><csymbol cd="latexml" id="A2.E23.m2.5.6.2.cmml" xref="A2.E23.m2.5.6.2">absent</csymbol><apply id="A2.E23.m2.5.5.cmml" xref="A2.E23.m2.5.5"><divide id="A2.E23.m2.5.5.6.cmml" xref="A2.E23.m2.5.5"></divide><apply id="A2.E23.m2.4.4.4.cmml" xref="A2.E23.m2.4.4.4"><minus id="A2.E23.m2.4.4.4.5.cmml" xref="A2.E23.m2.4.4.4.5"></minus><apply id="A2.E23.m2.2.2.2.2.cmml" xref="A2.E23.m2.2.2.2.2"><times id="A2.E23.m2.2.2.2.2.3.cmml" xref="A2.E23.m2.2.2.2.2.3"></times><apply id="A2.E23.m2.1.1.1.1.1.2.cmml" xref="A2.E23.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E23.m2.1.1.1.1.1.2.1.cmml" xref="A2.E23.m2.1.1.1.1.1.1.2">norm</csymbol><apply id="A2.E23.m2.1.1.1.1.1.1.1.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1"><minus id="A2.E23.m2.1.1.1.1.1.1.1.1.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.1"></minus><ci id="A2.E23.m2.1.1.1.1.1.1.1.2.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.2">𝐱</ci><apply id="A2.E23.m2.1.1.1.1.1.1.1.3.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E23.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E23.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="A2.E23.m2.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E23.m2.1.1.1.1.1.1.1.3.3">𝐱</ci></apply></apply></apply><apply id="A2.E23.m2.2.2.2.2.2.2.cmml" xref="A2.E23.m2.2.2.2.2.2.1"><csymbol cd="latexml" id="A2.E23.m2.2.2.2.2.2.2.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.2">norm</csymbol><apply id="A2.E23.m2.2.2.2.2.2.1.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1"><minus id="A2.E23.m2.2.2.2.2.2.1.1.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.1"></minus><apply id="A2.E23.m2.2.2.2.2.2.1.1.2.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.E23.m2.2.2.2.2.2.1.1.2.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A2.E23.m2.2.2.2.2.2.1.1.2.2.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.2.2">𝐯</ci><ci id="A2.E23.m2.2.2.2.2.2.1.1.2.3.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="A2.E23.m2.2.2.2.2.2.1.1.3.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E23.m2.2.2.2.2.2.1.1.3.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E23.m2.2.2.2.2.2.1.1.3.2.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3.2">𝜇</ci><apply id="A2.E23.m2.2.2.2.2.2.1.1.3.3.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A2.E23.m2.2.2.2.2.2.1.1.3.3.1.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="A2.E23.m2.2.2.2.2.2.1.1.3.3.2.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3.2">𝐯</ci><ci id="A2.E23.m2.2.2.2.2.2.1.1.3.3.3.cmml" xref="A2.E23.m2.2.2.2.2.2.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E23.m2.2.2.2.2.4.cmml" xref="A2.E23.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="A2.E23.m2.2.2.2.2.4.1.cmml" xref="A2.E23.m2.2.2.2.2.4">subscript</csymbol><ci id="A2.E23.m2.2.2.2.2.4.2.cmml" xref="A2.E23.m2.2.2.2.2.4.2">𝒗</ci><ci id="A2.E23.m2.2.2.2.2.4.3.cmml" xref="A2.E23.m2.2.2.2.2.4.3">𝑗</ci></apply></apply><apply id="A2.E23.m2.4.4.4.4.cmml" xref="A2.E23.m2.4.4.4.4"><ci id="A2.E23.m2.4.4.4.4.3.cmml" xref="A2.E23.m2.4.4.4.4.3">⋅</ci><apply id="A2.E23.m2.3.3.3.3.1.cmml" xref="A2.E23.m2.3.3.3.3.1"><times id="A2.E23.m2.3.3.3.3.1.2.cmml" xref="A2.E23.m2.3.3.3.3.1.2"></times><ci id="A2.E23.m2.3.3.3.3.1.3.cmml" xref="A2.E23.m2.3.3.3.3.1.3">𝒙</ci><apply id="A2.E23.m2.3.3.3.3.1.1.1.1.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1"><minus id="A2.E23.m2.3.3.3.3.1.1.1.1.1.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.1"></minus><ci id="A2.E23.m2.3.3.3.3.1.1.1.1.2.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.2">𝐱</ci><apply id="A2.E23.m2.3.3.3.3.1.1.1.1.3.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E23.m2.3.3.3.3.1.1.1.1.3.1.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="A2.E23.m2.3.3.3.3.1.1.1.1.3.2.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3.2">𝜇</ci><ci id="A2.E23.m2.3.3.3.3.1.1.1.1.3.3.cmml" xref="A2.E23.m2.3.3.3.3.1.1.1.1.3.3">𝐱</ci></apply></apply></apply><apply id="A2.E23.m2.4.4.4.4.2.1.1.cmml" xref="A2.E23.m2.4.4.4.4.2.1"><minus id="A2.E23.m2.4.4.4.4.2.1.1.1.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.1"></minus><apply id="A2.E23.m2.4.4.4.4.2.1.1.2.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A2.E23.m2.4.4.4.4.2.1.1.2.1.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.2">subscript</csymbol><ci id="A2.E23.m2.4.4.4.4.2.1.1.2.2.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.2.2">𝐯</ci><ci id="A2.E23.m2.4.4.4.4.2.1.1.2.3.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.2.3">𝑗</ci></apply><apply id="A2.E23.m2.4.4.4.4.2.1.1.3.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="A2.E23.m2.4.4.4.4.2.1.1.3.1.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3">subscript</csymbol><ci id="A2.E23.m2.4.4.4.4.2.1.1.3.2.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3.2">𝜇</ci><apply id="A2.E23.m2.4.4.4.4.2.1.1.3.3.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3"><csymbol cd="ambiguous" id="A2.E23.m2.4.4.4.4.2.1.1.3.3.1.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3">subscript</csymbol><ci id="A2.E23.m2.4.4.4.4.2.1.1.3.3.2.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3.2">𝐯</ci><ci id="A2.E23.m2.4.4.4.4.2.1.1.3.3.3.cmml" xref="A2.E23.m2.4.4.4.4.2.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A2.E23.m2.5.5.5.cmml" xref="A2.E23.m2.5.5.5"><csymbol cd="ambiguous" id="A2.E23.m2.5.5.5.2.cmml" xref="A2.E23.m2.5.5.5">superscript</csymbol><apply id="A2.E23.m2.5.5.5.1.2.cmml" xref="A2.E23.m2.5.5.5.1.1"><csymbol cd="latexml" id="A2.E23.m2.5.5.5.1.2.1.cmml" xref="A2.E23.m2.5.5.5.1.1.2">norm</csymbol><apply id="A2.E23.m2.5.5.5.1.1.1.cmml" xref="A2.E23.m2.5.5.5.1.1.1"><minus id="A2.E23.m2.5.5.5.1.1.1.1.cmml" xref="A2.E23.m2.5.5.5.1.1.1.1"></minus><ci id="A2.E23.m2.5.5.5.1.1.1.2.cmml" xref="A2.E23.m2.5.5.5.1.1.1.2">𝐱</ci><apply id="A2.E23.m2.5.5.5.1.1.1.3.cmml" xref="A2.E23.m2.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A2.E23.m2.5.5.5.1.1.1.3.1.cmml" xref="A2.E23.m2.5.5.5.1.1.1.3">subscript</csymbol><ci id="A2.E23.m2.5.5.5.1.1.1.3.2.cmml" xref="A2.E23.m2.5.5.5.1.1.1.3.2">𝜇</ci><ci id="A2.E23.m2.5.5.5.1.1.1.3.3.cmml" xref="A2.E23.m2.5.5.5.1.1.1.3.3">𝐱</ci></apply></apply></apply><cn id="A2.E23.m2.5.5.5.3.cmml" type="integer" xref="A2.E23.m2.5.5.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E23.m2.5c">\displaystyle=\frac{\|\mathbf{x}-\mu_{\mathbf{x}}\|\|\mathbf{v}_{j}-\mu_{%
\mathbf{v}_{j}}\|\boldsymbol{v}_{j}-\boldsymbol{x}(\mathbf{x}-\mu_{\mathbf{x}}%
)\cdot(\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}})}{\|\mathbf{x}-\mu_{\mathbf{x}}\|^{%
2}}</annotation><annotation encoding="application/x-llamapun" id="A2.E23.m2.5d">= divide start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - bold_italic_x ( bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ) ⋅ ( bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
<tbody id="A2.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\left[\boldsymbol{v}_{j}-\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{%
j}}}{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}\cdot\frac{\mathbf{x}-\mu_{%
\mathbf{x}}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}\boldsymbol{x}\right]~{}." class="ltx_Math" display="inline" id="A2.E24.m1.5"><semantics id="A2.E24.m1.5a"><mrow id="A2.E24.m1.5.5.1" xref="A2.E24.m1.5.5.1.1.cmml"><mrow id="A2.E24.m1.5.5.1.1" xref="A2.E24.m1.5.5.1.1.cmml"><mi id="A2.E24.m1.5.5.1.1.3" xref="A2.E24.m1.5.5.1.1.3.cmml"></mi><mo id="A2.E24.m1.5.5.1.1.2" xref="A2.E24.m1.5.5.1.1.2.cmml">=</mo><mrow id="A2.E24.m1.5.5.1.1.1" xref="A2.E24.m1.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E24.m1.2.2" xref="A2.E24.m1.2.2.cmml"><mfrac id="A2.E24.m1.2.2a" xref="A2.E24.m1.2.2.cmml"><mrow id="A2.E24.m1.1.1.1.1" xref="A2.E24.m1.1.1.1.2.cmml"><mo id="A2.E24.m1.1.1.1.1.2" stretchy="false" xref="A2.E24.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E24.m1.1.1.1.1.1" xref="A2.E24.m1.1.1.1.1.1.cmml"><msub id="A2.E24.m1.1.1.1.1.1.2" xref="A2.E24.m1.1.1.1.1.1.2.cmml"><mi id="A2.E24.m1.1.1.1.1.1.2.2" xref="A2.E24.m1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E24.m1.1.1.1.1.1.2.3" xref="A2.E24.m1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E24.m1.1.1.1.1.1.1" xref="A2.E24.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E24.m1.1.1.1.1.1.3" xref="A2.E24.m1.1.1.1.1.1.3.cmml"><mi id="A2.E24.m1.1.1.1.1.1.3.2" xref="A2.E24.m1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E24.m1.1.1.1.1.1.3.3" xref="A2.E24.m1.1.1.1.1.1.3.3.cmml"><mi id="A2.E24.m1.1.1.1.1.1.3.3.2" xref="A2.E24.m1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E24.m1.1.1.1.1.1.3.3.3" xref="A2.E24.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E24.m1.1.1.1.1.3" stretchy="false" xref="A2.E24.m1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E24.m1.2.2.2.1" xref="A2.E24.m1.2.2.2.2.cmml"><mo id="A2.E24.m1.2.2.2.1.2" stretchy="false" xref="A2.E24.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E24.m1.2.2.2.1.1" xref="A2.E24.m1.2.2.2.1.1.cmml"><mi id="A2.E24.m1.2.2.2.1.1.2" xref="A2.E24.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E24.m1.2.2.2.1.1.1" xref="A2.E24.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E24.m1.2.2.2.1.1.3" xref="A2.E24.m1.2.2.2.1.1.3.cmml"><mi id="A2.E24.m1.2.2.2.1.1.3.2" xref="A2.E24.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E24.m1.2.2.2.1.1.3.3" xref="A2.E24.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E24.m1.2.2.2.1.3" stretchy="false" xref="A2.E24.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E24.m1.5.5.1.1.1.2" xref="A2.E24.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A2.E24.m1.5.5.1.1.1.1.1" xref="A2.E24.m1.5.5.1.1.1.1.2.cmml"><mo id="A2.E24.m1.5.5.1.1.1.1.1.2" xref="A2.E24.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.E24.m1.5.5.1.1.1.1.1.1" xref="A2.E24.m1.5.5.1.1.1.1.1.1.cmml"><msub id="A2.E24.m1.5.5.1.1.1.1.1.1.2" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="A2.E24.m1.5.5.1.1.1.1.1.1.2.2" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝒗</mi><mi id="A2.E24.m1.5.5.1.1.1.1.1.1.2.3" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E24.m1.5.5.1.1.1.1.1.1.1" xref="A2.E24.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E24.m1.5.5.1.1.1.1.1.1.3" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.cmml"><mrow id="A2.E24.m1.5.5.1.1.1.1.1.1.3.2" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.cmml"><mstyle displaystyle="true" id="A2.E24.m1.3.3" xref="A2.E24.m1.3.3.cmml"><mfrac id="A2.E24.m1.3.3a" xref="A2.E24.m1.3.3.cmml"><mrow id="A2.E24.m1.3.3.3" xref="A2.E24.m1.3.3.3.cmml"><msub id="A2.E24.m1.3.3.3.2" xref="A2.E24.m1.3.3.3.2.cmml"><mi id="A2.E24.m1.3.3.3.2.2" xref="A2.E24.m1.3.3.3.2.2.cmml">𝐯</mi><mi id="A2.E24.m1.3.3.3.2.3" xref="A2.E24.m1.3.3.3.2.3.cmml">j</mi></msub><mo id="A2.E24.m1.3.3.3.1" xref="A2.E24.m1.3.3.3.1.cmml">−</mo><msub id="A2.E24.m1.3.3.3.3" xref="A2.E24.m1.3.3.3.3.cmml"><mi id="A2.E24.m1.3.3.3.3.2" xref="A2.E24.m1.3.3.3.3.2.cmml">μ</mi><msub id="A2.E24.m1.3.3.3.3.3" xref="A2.E24.m1.3.3.3.3.3.cmml"><mi id="A2.E24.m1.3.3.3.3.3.2" xref="A2.E24.m1.3.3.3.3.3.2.cmml">𝐯</mi><mi id="A2.E24.m1.3.3.3.3.3.3" xref="A2.E24.m1.3.3.3.3.3.3.cmml">j</mi></msub></msub></mrow><mrow id="A2.E24.m1.3.3.1.1" xref="A2.E24.m1.3.3.1.2.cmml"><mo id="A2.E24.m1.3.3.1.1.2" stretchy="false" xref="A2.E24.m1.3.3.1.2.1.cmml">‖</mo><mrow id="A2.E24.m1.3.3.1.1.1" xref="A2.E24.m1.3.3.1.1.1.cmml"><msub id="A2.E24.m1.3.3.1.1.1.2" xref="A2.E24.m1.3.3.1.1.1.2.cmml"><mi id="A2.E24.m1.3.3.1.1.1.2.2" xref="A2.E24.m1.3.3.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E24.m1.3.3.1.1.1.2.3" xref="A2.E24.m1.3.3.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E24.m1.3.3.1.1.1.1" xref="A2.E24.m1.3.3.1.1.1.1.cmml">−</mo><msub id="A2.E24.m1.3.3.1.1.1.3" xref="A2.E24.m1.3.3.1.1.1.3.cmml"><mi id="A2.E24.m1.3.3.1.1.1.3.2" xref="A2.E24.m1.3.3.1.1.1.3.2.cmml">μ</mi><msub id="A2.E24.m1.3.3.1.1.1.3.3" xref="A2.E24.m1.3.3.1.1.1.3.3.cmml"><mi id="A2.E24.m1.3.3.1.1.1.3.3.2" xref="A2.E24.m1.3.3.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E24.m1.3.3.1.1.1.3.3.3" xref="A2.E24.m1.3.3.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E24.m1.3.3.1.1.3" stretchy="false" xref="A2.E24.m1.3.3.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="A2.E24.m1.4.4" xref="A2.E24.m1.4.4.cmml"><mfrac id="A2.E24.m1.4.4a" xref="A2.E24.m1.4.4.cmml"><mrow id="A2.E24.m1.4.4.3" xref="A2.E24.m1.4.4.3.cmml"><mi id="A2.E24.m1.4.4.3.2" xref="A2.E24.m1.4.4.3.2.cmml">𝐱</mi><mo id="A2.E24.m1.4.4.3.1" xref="A2.E24.m1.4.4.3.1.cmml">−</mo><msub id="A2.E24.m1.4.4.3.3" xref="A2.E24.m1.4.4.3.3.cmml"><mi id="A2.E24.m1.4.4.3.3.2" xref="A2.E24.m1.4.4.3.3.2.cmml">μ</mi><mi id="A2.E24.m1.4.4.3.3.3" xref="A2.E24.m1.4.4.3.3.3.cmml">𝐱</mi></msub></mrow><mrow id="A2.E24.m1.4.4.1.1" xref="A2.E24.m1.4.4.1.2.cmml"><mo id="A2.E24.m1.4.4.1.1.2" stretchy="false" xref="A2.E24.m1.4.4.1.2.1.cmml">‖</mo><mrow id="A2.E24.m1.4.4.1.1.1" xref="A2.E24.m1.4.4.1.1.1.cmml"><mi id="A2.E24.m1.4.4.1.1.1.2" xref="A2.E24.m1.4.4.1.1.1.2.cmml">𝐱</mi><mo id="A2.E24.m1.4.4.1.1.1.1" xref="A2.E24.m1.4.4.1.1.1.1.cmml">−</mo><msub id="A2.E24.m1.4.4.1.1.1.3" xref="A2.E24.m1.4.4.1.1.1.3.cmml"><mi id="A2.E24.m1.4.4.1.1.1.3.2" xref="A2.E24.m1.4.4.1.1.1.3.2.cmml">μ</mi><mi id="A2.E24.m1.4.4.1.1.1.3.3" xref="A2.E24.m1.4.4.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E24.m1.4.4.1.1.3" stretchy="false" xref="A2.E24.m1.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo id="A2.E24.m1.5.5.1.1.1.1.1.1.3.1" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A2.E24.m1.5.5.1.1.1.1.1.1.3.3" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.3.cmml">𝒙</mi></mrow></mrow><mo id="A2.E24.m1.5.5.1.1.1.1.1.3" rspace="0.052em" xref="A2.E24.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.E24.m1.5.5.1.2" xref="A2.E24.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E24.m1.5b"><apply id="A2.E24.m1.5.5.1.1.cmml" xref="A2.E24.m1.5.5.1"><eq id="A2.E24.m1.5.5.1.1.2.cmml" xref="A2.E24.m1.5.5.1.1.2"></eq><csymbol cd="latexml" id="A2.E24.m1.5.5.1.1.3.cmml" xref="A2.E24.m1.5.5.1.1.3">absent</csymbol><apply id="A2.E24.m1.5.5.1.1.1.cmml" xref="A2.E24.m1.5.5.1.1.1"><times id="A2.E24.m1.5.5.1.1.1.2.cmml" xref="A2.E24.m1.5.5.1.1.1.2"></times><apply id="A2.E24.m1.2.2.cmml" xref="A2.E24.m1.2.2"><divide id="A2.E24.m1.2.2.3.cmml" xref="A2.E24.m1.2.2"></divide><apply id="A2.E24.m1.1.1.1.2.cmml" xref="A2.E24.m1.1.1.1.1"><csymbol cd="latexml" id="A2.E24.m1.1.1.1.2.1.cmml" xref="A2.E24.m1.1.1.1.1.2">norm</csymbol><apply id="A2.E24.m1.1.1.1.1.1.cmml" xref="A2.E24.m1.1.1.1.1.1"><minus id="A2.E24.m1.1.1.1.1.1.1.cmml" xref="A2.E24.m1.1.1.1.1.1.1"></minus><apply id="A2.E24.m1.1.1.1.1.1.2.cmml" xref="A2.E24.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E24.m1.1.1.1.1.1.2.1.cmml" xref="A2.E24.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E24.m1.1.1.1.1.1.2.2.cmml" xref="A2.E24.m1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E24.m1.1.1.1.1.1.2.3.cmml" xref="A2.E24.m1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E24.m1.1.1.1.1.1.3.cmml" xref="A2.E24.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E24.m1.1.1.1.1.1.3.1.cmml" xref="A2.E24.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E24.m1.1.1.1.1.1.3.2.cmml" xref="A2.E24.m1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E24.m1.1.1.1.1.1.3.3.cmml" xref="A2.E24.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E24.m1.1.1.1.1.1.3.3.1.cmml" xref="A2.E24.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E24.m1.1.1.1.1.1.3.3.2.cmml" xref="A2.E24.m1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E24.m1.1.1.1.1.1.3.3.3.cmml" xref="A2.E24.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E24.m1.2.2.2.2.cmml" xref="A2.E24.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E24.m1.2.2.2.2.1.cmml" xref="A2.E24.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E24.m1.2.2.2.1.1.cmml" xref="A2.E24.m1.2.2.2.1.1"><minus id="A2.E24.m1.2.2.2.1.1.1.cmml" xref="A2.E24.m1.2.2.2.1.1.1"></minus><ci id="A2.E24.m1.2.2.2.1.1.2.cmml" xref="A2.E24.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E24.m1.2.2.2.1.1.3.cmml" xref="A2.E24.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E24.m1.2.2.2.1.1.3.1.cmml" xref="A2.E24.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E24.m1.2.2.2.1.1.3.2.cmml" xref="A2.E24.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E24.m1.2.2.2.1.1.3.3.cmml" xref="A2.E24.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E24.m1.5.5.1.1.1.1.2.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A2.E24.m1.5.5.1.1.1.1.2.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E24.m1.5.5.1.1.1.1.1.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1"><minus id="A2.E24.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="A2.E24.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E24.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E24.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2.2">𝒗</ci><ci id="A2.E24.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E24.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3"><times id="A2.E24.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.1"></times><apply id="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.2"><ci id="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.2.1">⋅</ci><apply id="A2.E24.m1.3.3.cmml" xref="A2.E24.m1.3.3"><divide id="A2.E24.m1.3.3.2.cmml" xref="A2.E24.m1.3.3"></divide><apply id="A2.E24.m1.3.3.3.cmml" xref="A2.E24.m1.3.3.3"><minus id="A2.E24.m1.3.3.3.1.cmml" xref="A2.E24.m1.3.3.3.1"></minus><apply id="A2.E24.m1.3.3.3.2.cmml" xref="A2.E24.m1.3.3.3.2"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.3.2.1.cmml" xref="A2.E24.m1.3.3.3.2">subscript</csymbol><ci id="A2.E24.m1.3.3.3.2.2.cmml" xref="A2.E24.m1.3.3.3.2.2">𝐯</ci><ci id="A2.E24.m1.3.3.3.2.3.cmml" xref="A2.E24.m1.3.3.3.2.3">𝑗</ci></apply><apply id="A2.E24.m1.3.3.3.3.cmml" xref="A2.E24.m1.3.3.3.3"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.3.3.1.cmml" xref="A2.E24.m1.3.3.3.3">subscript</csymbol><ci id="A2.E24.m1.3.3.3.3.2.cmml" xref="A2.E24.m1.3.3.3.3.2">𝜇</ci><apply id="A2.E24.m1.3.3.3.3.3.cmml" xref="A2.E24.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.3.3.3.1.cmml" xref="A2.E24.m1.3.3.3.3.3">subscript</csymbol><ci id="A2.E24.m1.3.3.3.3.3.2.cmml" xref="A2.E24.m1.3.3.3.3.3.2">𝐯</ci><ci id="A2.E24.m1.3.3.3.3.3.3.cmml" xref="A2.E24.m1.3.3.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A2.E24.m1.3.3.1.2.cmml" xref="A2.E24.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E24.m1.3.3.1.2.1.cmml" xref="A2.E24.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E24.m1.3.3.1.1.1.cmml" xref="A2.E24.m1.3.3.1.1.1"><minus id="A2.E24.m1.3.3.1.1.1.1.cmml" xref="A2.E24.m1.3.3.1.1.1.1"></minus><apply id="A2.E24.m1.3.3.1.1.1.2.cmml" xref="A2.E24.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.1.1.1.2.1.cmml" xref="A2.E24.m1.3.3.1.1.1.2">subscript</csymbol><ci id="A2.E24.m1.3.3.1.1.1.2.2.cmml" xref="A2.E24.m1.3.3.1.1.1.2.2">𝐯</ci><ci id="A2.E24.m1.3.3.1.1.1.2.3.cmml" xref="A2.E24.m1.3.3.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E24.m1.3.3.1.1.1.3.cmml" xref="A2.E24.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.1.1.1.3.1.cmml" xref="A2.E24.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A2.E24.m1.3.3.1.1.1.3.2.cmml" xref="A2.E24.m1.3.3.1.1.1.3.2">𝜇</ci><apply id="A2.E24.m1.3.3.1.1.1.3.3.cmml" xref="A2.E24.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E24.m1.3.3.1.1.1.3.3.1.cmml" xref="A2.E24.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="A2.E24.m1.3.3.1.1.1.3.3.2.cmml" xref="A2.E24.m1.3.3.1.1.1.3.3.2">𝐯</ci><ci id="A2.E24.m1.3.3.1.1.1.3.3.3.cmml" xref="A2.E24.m1.3.3.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A2.E24.m1.4.4.cmml" xref="A2.E24.m1.4.4"><divide id="A2.E24.m1.4.4.2.cmml" xref="A2.E24.m1.4.4"></divide><apply id="A2.E24.m1.4.4.3.cmml" xref="A2.E24.m1.4.4.3"><minus id="A2.E24.m1.4.4.3.1.cmml" xref="A2.E24.m1.4.4.3.1"></minus><ci id="A2.E24.m1.4.4.3.2.cmml" xref="A2.E24.m1.4.4.3.2">𝐱</ci><apply id="A2.E24.m1.4.4.3.3.cmml" xref="A2.E24.m1.4.4.3.3"><csymbol cd="ambiguous" id="A2.E24.m1.4.4.3.3.1.cmml" xref="A2.E24.m1.4.4.3.3">subscript</csymbol><ci id="A2.E24.m1.4.4.3.3.2.cmml" xref="A2.E24.m1.4.4.3.3.2">𝜇</ci><ci id="A2.E24.m1.4.4.3.3.3.cmml" xref="A2.E24.m1.4.4.3.3.3">𝐱</ci></apply></apply><apply id="A2.E24.m1.4.4.1.2.cmml" xref="A2.E24.m1.4.4.1.1"><csymbol cd="latexml" id="A2.E24.m1.4.4.1.2.1.cmml" xref="A2.E24.m1.4.4.1.1.2">norm</csymbol><apply id="A2.E24.m1.4.4.1.1.1.cmml" xref="A2.E24.m1.4.4.1.1.1"><minus id="A2.E24.m1.4.4.1.1.1.1.cmml" xref="A2.E24.m1.4.4.1.1.1.1"></minus><ci id="A2.E24.m1.4.4.1.1.1.2.cmml" xref="A2.E24.m1.4.4.1.1.1.2">𝐱</ci><apply id="A2.E24.m1.4.4.1.1.1.3.cmml" xref="A2.E24.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A2.E24.m1.4.4.1.1.1.3.1.cmml" xref="A2.E24.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A2.E24.m1.4.4.1.1.1.3.2.cmml" xref="A2.E24.m1.4.4.1.1.1.3.2">𝜇</ci><ci id="A2.E24.m1.4.4.1.1.1.3.3.cmml" xref="A2.E24.m1.4.4.1.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply><ci id="A2.E24.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="A2.E24.m1.5.5.1.1.1.1.1.1.3.3">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E24.m1.5c">\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\left[\boldsymbol{v}_{j}-\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{%
j}}}{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}\cdot\frac{\mathbf{x}-\mu_{%
\mathbf{x}}}{\|\mathbf{x}-\mu_{\mathbf{x}}\|}\boldsymbol{x}\right]~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E24.m1.5d">= divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG [ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - divide start_ARG bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG ⋅ divide start_ARG bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG bold_italic_x ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p10">
<p class="ltx_p" id="A2.SS1.p10.1">Next,
we have to solve <math alttext="\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|" class="ltx_Math" display="inline" id="A2.SS1.p10.1.m1.1"><semantics id="A2.SS1.p10.1.m1.1a"><mrow id="A2.SS1.p10.1.m1.1.2" xref="A2.SS1.p10.1.m1.1.2.cmml"><mfrac id="A2.SS1.p10.1.m1.1.2.2" xref="A2.SS1.p10.1.m1.1.2.2.cmml"><mo id="A2.SS1.p10.1.m1.1.2.2.2" xref="A2.SS1.p10.1.m1.1.2.2.2.cmml">∂</mo><mrow id="A2.SS1.p10.1.m1.1.2.2.3" xref="A2.SS1.p10.1.m1.1.2.2.3.cmml"><mo id="A2.SS1.p10.1.m1.1.2.2.3.1" rspace="0em" xref="A2.SS1.p10.1.m1.1.2.2.3.1.cmml">∂</mo><msub id="A2.SS1.p10.1.m1.1.2.2.3.2" xref="A2.SS1.p10.1.m1.1.2.2.3.2.cmml"><mi id="A2.SS1.p10.1.m1.1.2.2.3.2.2" xref="A2.SS1.p10.1.m1.1.2.2.3.2.2.cmml">a</mi><mi id="A2.SS1.p10.1.m1.1.2.2.3.2.3" xref="A2.SS1.p10.1.m1.1.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="A2.SS1.p10.1.m1.1.2.1" xref="A2.SS1.p10.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p10.1.m1.1.2.3.2" xref="A2.SS1.p10.1.m1.1.2.3.1.cmml"><mo id="A2.SS1.p10.1.m1.1.2.3.2.1" stretchy="false" xref="A2.SS1.p10.1.m1.1.2.3.1.1.cmml">‖</mo><mi id="A2.SS1.p10.1.m1.1.1" xref="A2.SS1.p10.1.m1.1.1.cmml">𝒙</mi><mo id="A2.SS1.p10.1.m1.1.2.3.2.2" stretchy="false" xref="A2.SS1.p10.1.m1.1.2.3.1.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p10.1.m1.1b"><apply id="A2.SS1.p10.1.m1.1.2.cmml" xref="A2.SS1.p10.1.m1.1.2"><times id="A2.SS1.p10.1.m1.1.2.1.cmml" xref="A2.SS1.p10.1.m1.1.2.1"></times><apply id="A2.SS1.p10.1.m1.1.2.2.cmml" xref="A2.SS1.p10.1.m1.1.2.2"><divide id="A2.SS1.p10.1.m1.1.2.2.1.cmml" xref="A2.SS1.p10.1.m1.1.2.2"></divide><partialdiff id="A2.SS1.p10.1.m1.1.2.2.2.cmml" xref="A2.SS1.p10.1.m1.1.2.2.2"></partialdiff><apply id="A2.SS1.p10.1.m1.1.2.2.3.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3"><partialdiff id="A2.SS1.p10.1.m1.1.2.2.3.1.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3.1"></partialdiff><apply id="A2.SS1.p10.1.m1.1.2.2.3.2.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p10.1.m1.1.2.2.3.2.1.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3.2">subscript</csymbol><ci id="A2.SS1.p10.1.m1.1.2.2.3.2.2.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3.2.2">𝑎</ci><ci id="A2.SS1.p10.1.m1.1.2.2.3.2.3.cmml" xref="A2.SS1.p10.1.m1.1.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.SS1.p10.1.m1.1.2.3.1.cmml" xref="A2.SS1.p10.1.m1.1.2.3.2"><csymbol cd="latexml" id="A2.SS1.p10.1.m1.1.2.3.1.1.cmml" xref="A2.SS1.p10.1.m1.1.2.3.2.1">norm</csymbol><ci id="A2.SS1.p10.1.m1.1.1.cmml" xref="A2.SS1.p10.1.m1.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p10.1.m1.1c">\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p10.1.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_italic_x ∥</annotation></semantics></math> as in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E13" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">13</span></a>:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p11">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx4">
<tbody id="A2.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|" class="ltx_Math" display="inline" id="A2.E25.m1.1"><semantics id="A2.E25.m1.1a"><mrow id="A2.E25.m1.1.2" xref="A2.E25.m1.1.2.cmml"><mstyle displaystyle="true" id="A2.E25.m1.1.2.2" xref="A2.E25.m1.1.2.2.cmml"><mfrac id="A2.E25.m1.1.2.2a" xref="A2.E25.m1.1.2.2.cmml"><mo id="A2.E25.m1.1.2.2.2" xref="A2.E25.m1.1.2.2.2.cmml">∂</mo><mrow id="A2.E25.m1.1.2.2.3" xref="A2.E25.m1.1.2.2.3.cmml"><mo id="A2.E25.m1.1.2.2.3.1" rspace="0em" xref="A2.E25.m1.1.2.2.3.1.cmml">∂</mo><msub id="A2.E25.m1.1.2.2.3.2" xref="A2.E25.m1.1.2.2.3.2.cmml"><mi id="A2.E25.m1.1.2.2.3.2.2" xref="A2.E25.m1.1.2.2.3.2.2.cmml">a</mi><mi id="A2.E25.m1.1.2.2.3.2.3" xref="A2.E25.m1.1.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo id="A2.E25.m1.1.2.1" xref="A2.E25.m1.1.2.1.cmml">⁢</mo><mrow id="A2.E25.m1.1.2.3.2" xref="A2.E25.m1.1.2.3.1.cmml"><mo id="A2.E25.m1.1.2.3.2.1" stretchy="false" xref="A2.E25.m1.1.2.3.1.1.cmml">‖</mo><mi id="A2.E25.m1.1.1" xref="A2.E25.m1.1.1.cmml">𝒙</mi><mo id="A2.E25.m1.1.2.3.2.2" stretchy="false" xref="A2.E25.m1.1.2.3.1.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E25.m1.1b"><apply id="A2.E25.m1.1.2.cmml" xref="A2.E25.m1.1.2"><times id="A2.E25.m1.1.2.1.cmml" xref="A2.E25.m1.1.2.1"></times><apply id="A2.E25.m1.1.2.2.cmml" xref="A2.E25.m1.1.2.2"><divide id="A2.E25.m1.1.2.2.1.cmml" xref="A2.E25.m1.1.2.2"></divide><partialdiff id="A2.E25.m1.1.2.2.2.cmml" xref="A2.E25.m1.1.2.2.2"></partialdiff><apply id="A2.E25.m1.1.2.2.3.cmml" xref="A2.E25.m1.1.2.2.3"><partialdiff id="A2.E25.m1.1.2.2.3.1.cmml" xref="A2.E25.m1.1.2.2.3.1"></partialdiff><apply id="A2.E25.m1.1.2.2.3.2.cmml" xref="A2.E25.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="A2.E25.m1.1.2.2.3.2.1.cmml" xref="A2.E25.m1.1.2.2.3.2">subscript</csymbol><ci id="A2.E25.m1.1.2.2.3.2.2.cmml" xref="A2.E25.m1.1.2.2.3.2.2">𝑎</ci><ci id="A2.E25.m1.1.2.2.3.2.3.cmml" xref="A2.E25.m1.1.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E25.m1.1.2.3.1.cmml" xref="A2.E25.m1.1.2.3.2"><csymbol cd="latexml" id="A2.E25.m1.1.2.3.1.1.cmml" xref="A2.E25.m1.1.2.3.2.1">norm</csymbol><ci id="A2.E25.m1.1.1.cmml" xref="A2.E25.m1.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E25.m1.1c">\displaystyle\frac{\partial}{\partial a_{j}}\|\boldsymbol{x}\|</annotation><annotation encoding="application/x-llamapun" id="A2.E25.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∥ bold_italic_x ∥</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\|\boldsymbol{x}\|}\boldsymbol{x}\cdot\frac{\partial}{%
\partial a_{j}}\boldsymbol{x}" class="ltx_Math" display="inline" id="A2.E25.m2.1"><semantics id="A2.E25.m2.1a"><mrow id="A2.E25.m2.1.2" xref="A2.E25.m2.1.2.cmml"><mi id="A2.E25.m2.1.2.2" xref="A2.E25.m2.1.2.2.cmml"></mi><mo id="A2.E25.m2.1.2.1" xref="A2.E25.m2.1.2.1.cmml">=</mo><mrow id="A2.E25.m2.1.2.3" xref="A2.E25.m2.1.2.3.cmml"><mrow id="A2.E25.m2.1.2.3.2" xref="A2.E25.m2.1.2.3.2.cmml"><mrow id="A2.E25.m2.1.2.3.2.2" xref="A2.E25.m2.1.2.3.2.2.cmml"><mstyle displaystyle="true" id="A2.E25.m2.1.1" xref="A2.E25.m2.1.1.cmml"><mfrac id="A2.E25.m2.1.1a" xref="A2.E25.m2.1.1.cmml"><mn id="A2.E25.m2.1.1.3" xref="A2.E25.m2.1.1.3.cmml">1</mn><mrow id="A2.E25.m2.1.1.1.3" xref="A2.E25.m2.1.1.1.2.cmml"><mo id="A2.E25.m2.1.1.1.3.1" stretchy="false" xref="A2.E25.m2.1.1.1.2.1.cmml">‖</mo><mi id="A2.E25.m2.1.1.1.1" xref="A2.E25.m2.1.1.1.1.cmml">𝒙</mi><mo id="A2.E25.m2.1.1.1.3.2" stretchy="false" xref="A2.E25.m2.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E25.m2.1.2.3.2.2.1" xref="A2.E25.m2.1.2.3.2.2.1.cmml">⁢</mo><mi id="A2.E25.m2.1.2.3.2.2.2" xref="A2.E25.m2.1.2.3.2.2.2.cmml">𝒙</mi></mrow><mo id="A2.E25.m2.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E25.m2.1.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="A2.E25.m2.1.2.3.2.3" xref="A2.E25.m2.1.2.3.2.3.cmml"><mfrac id="A2.E25.m2.1.2.3.2.3a" xref="A2.E25.m2.1.2.3.2.3.cmml"><mo id="A2.E25.m2.1.2.3.2.3.2" xref="A2.E25.m2.1.2.3.2.3.2.cmml">∂</mo><mrow id="A2.E25.m2.1.2.3.2.3.3" xref="A2.E25.m2.1.2.3.2.3.3.cmml"><mo id="A2.E25.m2.1.2.3.2.3.3.1" rspace="0em" xref="A2.E25.m2.1.2.3.2.3.3.1.cmml">∂</mo><msub id="A2.E25.m2.1.2.3.2.3.3.2" xref="A2.E25.m2.1.2.3.2.3.3.2.cmml"><mi id="A2.E25.m2.1.2.3.2.3.3.2.2" xref="A2.E25.m2.1.2.3.2.3.3.2.2.cmml">a</mi><mi id="A2.E25.m2.1.2.3.2.3.3.2.3" xref="A2.E25.m2.1.2.3.2.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle></mrow><mo id="A2.E25.m2.1.2.3.1" xref="A2.E25.m2.1.2.3.1.cmml">⁢</mo><mi id="A2.E25.m2.1.2.3.3" xref="A2.E25.m2.1.2.3.3.cmml">𝒙</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E25.m2.1b"><apply id="A2.E25.m2.1.2.cmml" xref="A2.E25.m2.1.2"><eq id="A2.E25.m2.1.2.1.cmml" xref="A2.E25.m2.1.2.1"></eq><csymbol cd="latexml" id="A2.E25.m2.1.2.2.cmml" xref="A2.E25.m2.1.2.2">absent</csymbol><apply id="A2.E25.m2.1.2.3.cmml" xref="A2.E25.m2.1.2.3"><times id="A2.E25.m2.1.2.3.1.cmml" xref="A2.E25.m2.1.2.3.1"></times><apply id="A2.E25.m2.1.2.3.2.cmml" xref="A2.E25.m2.1.2.3.2"><ci id="A2.E25.m2.1.2.3.2.1.cmml" xref="A2.E25.m2.1.2.3.2.1">⋅</ci><apply id="A2.E25.m2.1.2.3.2.2.cmml" xref="A2.E25.m2.1.2.3.2.2"><times id="A2.E25.m2.1.2.3.2.2.1.cmml" xref="A2.E25.m2.1.2.3.2.2.1"></times><apply id="A2.E25.m2.1.1.cmml" xref="A2.E25.m2.1.1"><divide id="A2.E25.m2.1.1.2.cmml" xref="A2.E25.m2.1.1"></divide><cn id="A2.E25.m2.1.1.3.cmml" type="integer" xref="A2.E25.m2.1.1.3">1</cn><apply id="A2.E25.m2.1.1.1.2.cmml" xref="A2.E25.m2.1.1.1.3"><csymbol cd="latexml" id="A2.E25.m2.1.1.1.2.1.cmml" xref="A2.E25.m2.1.1.1.3.1">norm</csymbol><ci id="A2.E25.m2.1.1.1.1.cmml" xref="A2.E25.m2.1.1.1.1">𝒙</ci></apply></apply><ci id="A2.E25.m2.1.2.3.2.2.2.cmml" xref="A2.E25.m2.1.2.3.2.2.2">𝒙</ci></apply><apply id="A2.E25.m2.1.2.3.2.3.cmml" xref="A2.E25.m2.1.2.3.2.3"><divide id="A2.E25.m2.1.2.3.2.3.1.cmml" xref="A2.E25.m2.1.2.3.2.3"></divide><partialdiff id="A2.E25.m2.1.2.3.2.3.2.cmml" xref="A2.E25.m2.1.2.3.2.3.2"></partialdiff><apply id="A2.E25.m2.1.2.3.2.3.3.cmml" xref="A2.E25.m2.1.2.3.2.3.3"><partialdiff id="A2.E25.m2.1.2.3.2.3.3.1.cmml" xref="A2.E25.m2.1.2.3.2.3.3.1"></partialdiff><apply id="A2.E25.m2.1.2.3.2.3.3.2.cmml" xref="A2.E25.m2.1.2.3.2.3.3.2"><csymbol cd="ambiguous" id="A2.E25.m2.1.2.3.2.3.3.2.1.cmml" xref="A2.E25.m2.1.2.3.2.3.3.2">subscript</csymbol><ci id="A2.E25.m2.1.2.3.2.3.3.2.2.cmml" xref="A2.E25.m2.1.2.3.2.3.3.2.2">𝑎</ci><ci id="A2.E25.m2.1.2.3.2.3.3.2.3.cmml" xref="A2.E25.m2.1.2.3.2.3.3.2.3">𝑗</ci></apply></apply></apply></apply><ci id="A2.E25.m2.1.2.3.3.cmml" xref="A2.E25.m2.1.2.3.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E25.m2.1c">\displaystyle=\frac{1}{\|\boldsymbol{x}\|}\boldsymbol{x}\cdot\frac{\partial}{%
\partial a_{j}}\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A2.E25.m2.1d">= divide start_ARG 1 end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG bold_italic_x ⋅ divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG bold_italic_x</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
<tbody id="A2.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\left[\frac{\boldsymbol{x}}{\|\boldsymbol{x}\|}\cdot\boldsymbol%
{v}_{j}-\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}}{\|\mathbf{v}_{j}-\mu_{%
\mathbf{v}_{j}}\|}\cdot\frac{\mathbf{x}-\mu_{\mathbf{x}}}{\|\mathbf{x}-\mu_{%
\mathbf{x}}\|}\right]~{}." class="ltx_Math" display="inline" id="A2.E26.m1.6"><semantics id="A2.E26.m1.6a"><mrow id="A2.E26.m1.6.6.1" xref="A2.E26.m1.6.6.1.1.cmml"><mrow id="A2.E26.m1.6.6.1.1" xref="A2.E26.m1.6.6.1.1.cmml"><mi id="A2.E26.m1.6.6.1.1.3" xref="A2.E26.m1.6.6.1.1.3.cmml"></mi><mo id="A2.E26.m1.6.6.1.1.2" xref="A2.E26.m1.6.6.1.1.2.cmml">=</mo><mrow id="A2.E26.m1.6.6.1.1.1" xref="A2.E26.m1.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E26.m1.2.2" xref="A2.E26.m1.2.2.cmml"><mfrac id="A2.E26.m1.2.2a" xref="A2.E26.m1.2.2.cmml"><mrow id="A2.E26.m1.1.1.1.1" xref="A2.E26.m1.1.1.1.2.cmml"><mo id="A2.E26.m1.1.1.1.1.2" stretchy="false" xref="A2.E26.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E26.m1.1.1.1.1.1" xref="A2.E26.m1.1.1.1.1.1.cmml"><msub id="A2.E26.m1.1.1.1.1.1.2" xref="A2.E26.m1.1.1.1.1.1.2.cmml"><mi id="A2.E26.m1.1.1.1.1.1.2.2" xref="A2.E26.m1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E26.m1.1.1.1.1.1.2.3" xref="A2.E26.m1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E26.m1.1.1.1.1.1.1" xref="A2.E26.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E26.m1.1.1.1.1.1.3" xref="A2.E26.m1.1.1.1.1.1.3.cmml"><mi id="A2.E26.m1.1.1.1.1.1.3.2" xref="A2.E26.m1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E26.m1.1.1.1.1.1.3.3" xref="A2.E26.m1.1.1.1.1.1.3.3.cmml"><mi id="A2.E26.m1.1.1.1.1.1.3.3.2" xref="A2.E26.m1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E26.m1.1.1.1.1.1.3.3.3" xref="A2.E26.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E26.m1.1.1.1.1.3" stretchy="false" xref="A2.E26.m1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E26.m1.2.2.2.1" xref="A2.E26.m1.2.2.2.2.cmml"><mo id="A2.E26.m1.2.2.2.1.2" stretchy="false" xref="A2.E26.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E26.m1.2.2.2.1.1" xref="A2.E26.m1.2.2.2.1.1.cmml"><mi id="A2.E26.m1.2.2.2.1.1.2" xref="A2.E26.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E26.m1.2.2.2.1.1.1" xref="A2.E26.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E26.m1.2.2.2.1.1.3" xref="A2.E26.m1.2.2.2.1.1.3.cmml"><mi id="A2.E26.m1.2.2.2.1.1.3.2" xref="A2.E26.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E26.m1.2.2.2.1.1.3.3" xref="A2.E26.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E26.m1.2.2.2.1.3" stretchy="false" xref="A2.E26.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E26.m1.6.6.1.1.1.2" xref="A2.E26.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="A2.E26.m1.6.6.1.1.1.1.1" xref="A2.E26.m1.6.6.1.1.1.1.2.cmml"><mo id="A2.E26.m1.6.6.1.1.1.1.1.2" xref="A2.E26.m1.6.6.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.E26.m1.6.6.1.1.1.1.1.1" xref="A2.E26.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="A2.E26.m1.6.6.1.1.1.1.1.1.2" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A2.E26.m1.3.3" xref="A2.E26.m1.3.3.cmml"><mfrac id="A2.E26.m1.3.3a" xref="A2.E26.m1.3.3.cmml"><mi id="A2.E26.m1.3.3.3" xref="A2.E26.m1.3.3.3.cmml">𝒙</mi><mrow id="A2.E26.m1.3.3.1.3" xref="A2.E26.m1.3.3.1.2.cmml"><mo id="A2.E26.m1.3.3.1.3.1" stretchy="false" xref="A2.E26.m1.3.3.1.2.1.cmml">‖</mo><mi id="A2.E26.m1.3.3.1.1" xref="A2.E26.m1.3.3.1.1.cmml">𝒙</mi><mo id="A2.E26.m1.3.3.1.3.2" stretchy="false" xref="A2.E26.m1.3.3.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E26.m1.6.6.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.cmml"><mi id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.2" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">𝒗</mi><mi id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.3" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A2.E26.m1.6.6.1.1.1.1.1.1.1" xref="A2.E26.m1.6.6.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E26.m1.6.6.1.1.1.1.1.1.3" xref="A2.E26.m1.6.6.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A2.E26.m1.4.4" xref="A2.E26.m1.4.4.cmml"><mfrac id="A2.E26.m1.4.4a" xref="A2.E26.m1.4.4.cmml"><mrow id="A2.E26.m1.4.4.3" xref="A2.E26.m1.4.4.3.cmml"><msub id="A2.E26.m1.4.4.3.2" xref="A2.E26.m1.4.4.3.2.cmml"><mi id="A2.E26.m1.4.4.3.2.2" xref="A2.E26.m1.4.4.3.2.2.cmml">𝐯</mi><mi id="A2.E26.m1.4.4.3.2.3" xref="A2.E26.m1.4.4.3.2.3.cmml">j</mi></msub><mo id="A2.E26.m1.4.4.3.1" xref="A2.E26.m1.4.4.3.1.cmml">−</mo><msub id="A2.E26.m1.4.4.3.3" xref="A2.E26.m1.4.4.3.3.cmml"><mi id="A2.E26.m1.4.4.3.3.2" xref="A2.E26.m1.4.4.3.3.2.cmml">μ</mi><msub id="A2.E26.m1.4.4.3.3.3" xref="A2.E26.m1.4.4.3.3.3.cmml"><mi id="A2.E26.m1.4.4.3.3.3.2" xref="A2.E26.m1.4.4.3.3.3.2.cmml">𝐯</mi><mi id="A2.E26.m1.4.4.3.3.3.3" xref="A2.E26.m1.4.4.3.3.3.3.cmml">j</mi></msub></msub></mrow><mrow id="A2.E26.m1.4.4.1.1" xref="A2.E26.m1.4.4.1.2.cmml"><mo id="A2.E26.m1.4.4.1.1.2" stretchy="false" xref="A2.E26.m1.4.4.1.2.1.cmml">‖</mo><mrow id="A2.E26.m1.4.4.1.1.1" xref="A2.E26.m1.4.4.1.1.1.cmml"><msub id="A2.E26.m1.4.4.1.1.1.2" xref="A2.E26.m1.4.4.1.1.1.2.cmml"><mi id="A2.E26.m1.4.4.1.1.1.2.2" xref="A2.E26.m1.4.4.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E26.m1.4.4.1.1.1.2.3" xref="A2.E26.m1.4.4.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E26.m1.4.4.1.1.1.1" xref="A2.E26.m1.4.4.1.1.1.1.cmml">−</mo><msub id="A2.E26.m1.4.4.1.1.1.3" xref="A2.E26.m1.4.4.1.1.1.3.cmml"><mi id="A2.E26.m1.4.4.1.1.1.3.2" xref="A2.E26.m1.4.4.1.1.1.3.2.cmml">μ</mi><msub id="A2.E26.m1.4.4.1.1.1.3.3" xref="A2.E26.m1.4.4.1.1.1.3.3.cmml"><mi id="A2.E26.m1.4.4.1.1.1.3.3.2" xref="A2.E26.m1.4.4.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E26.m1.4.4.1.1.1.3.3.3" xref="A2.E26.m1.4.4.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E26.m1.4.4.1.1.3" stretchy="false" xref="A2.E26.m1.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E26.m1.6.6.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A2.E26.m1.6.6.1.1.1.1.1.1.3.1.cmml">⋅</mo><mstyle displaystyle="true" id="A2.E26.m1.5.5" xref="A2.E26.m1.5.5.cmml"><mfrac id="A2.E26.m1.5.5a" xref="A2.E26.m1.5.5.cmml"><mrow id="A2.E26.m1.5.5.3" xref="A2.E26.m1.5.5.3.cmml"><mi id="A2.E26.m1.5.5.3.2" xref="A2.E26.m1.5.5.3.2.cmml">𝐱</mi><mo id="A2.E26.m1.5.5.3.1" xref="A2.E26.m1.5.5.3.1.cmml">−</mo><msub id="A2.E26.m1.5.5.3.3" xref="A2.E26.m1.5.5.3.3.cmml"><mi id="A2.E26.m1.5.5.3.3.2" xref="A2.E26.m1.5.5.3.3.2.cmml">μ</mi><mi id="A2.E26.m1.5.5.3.3.3" xref="A2.E26.m1.5.5.3.3.3.cmml">𝐱</mi></msub></mrow><mrow id="A2.E26.m1.5.5.1.1" xref="A2.E26.m1.5.5.1.2.cmml"><mo id="A2.E26.m1.5.5.1.1.2" stretchy="false" xref="A2.E26.m1.5.5.1.2.1.cmml">‖</mo><mrow id="A2.E26.m1.5.5.1.1.1" xref="A2.E26.m1.5.5.1.1.1.cmml"><mi id="A2.E26.m1.5.5.1.1.1.2" xref="A2.E26.m1.5.5.1.1.1.2.cmml">𝐱</mi><mo id="A2.E26.m1.5.5.1.1.1.1" xref="A2.E26.m1.5.5.1.1.1.1.cmml">−</mo><msub id="A2.E26.m1.5.5.1.1.1.3" xref="A2.E26.m1.5.5.1.1.1.3.cmml"><mi id="A2.E26.m1.5.5.1.1.1.3.2" xref="A2.E26.m1.5.5.1.1.1.3.2.cmml">μ</mi><mi id="A2.E26.m1.5.5.1.1.1.3.3" xref="A2.E26.m1.5.5.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E26.m1.5.5.1.1.3" stretchy="false" xref="A2.E26.m1.5.5.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow></mrow><mo id="A2.E26.m1.6.6.1.1.1.1.1.3" rspace="0.052em" xref="A2.E26.m1.6.6.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.E26.m1.6.6.1.2" xref="A2.E26.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E26.m1.6b"><apply id="A2.E26.m1.6.6.1.1.cmml" xref="A2.E26.m1.6.6.1"><eq id="A2.E26.m1.6.6.1.1.2.cmml" xref="A2.E26.m1.6.6.1.1.2"></eq><csymbol cd="latexml" id="A2.E26.m1.6.6.1.1.3.cmml" xref="A2.E26.m1.6.6.1.1.3">absent</csymbol><apply id="A2.E26.m1.6.6.1.1.1.cmml" xref="A2.E26.m1.6.6.1.1.1"><times id="A2.E26.m1.6.6.1.1.1.2.cmml" xref="A2.E26.m1.6.6.1.1.1.2"></times><apply id="A2.E26.m1.2.2.cmml" xref="A2.E26.m1.2.2"><divide id="A2.E26.m1.2.2.3.cmml" xref="A2.E26.m1.2.2"></divide><apply id="A2.E26.m1.1.1.1.2.cmml" xref="A2.E26.m1.1.1.1.1"><csymbol cd="latexml" id="A2.E26.m1.1.1.1.2.1.cmml" xref="A2.E26.m1.1.1.1.1.2">norm</csymbol><apply id="A2.E26.m1.1.1.1.1.1.cmml" xref="A2.E26.m1.1.1.1.1.1"><minus id="A2.E26.m1.1.1.1.1.1.1.cmml" xref="A2.E26.m1.1.1.1.1.1.1"></minus><apply id="A2.E26.m1.1.1.1.1.1.2.cmml" xref="A2.E26.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.1.1.2.1.cmml" xref="A2.E26.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E26.m1.1.1.1.1.1.2.2.cmml" xref="A2.E26.m1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E26.m1.1.1.1.1.1.2.3.cmml" xref="A2.E26.m1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E26.m1.1.1.1.1.1.3.cmml" xref="A2.E26.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.1.1.3.1.cmml" xref="A2.E26.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E26.m1.1.1.1.1.1.3.2.cmml" xref="A2.E26.m1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E26.m1.1.1.1.1.1.3.3.cmml" xref="A2.E26.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.1.1.3.3.1.cmml" xref="A2.E26.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E26.m1.1.1.1.1.1.3.3.2.cmml" xref="A2.E26.m1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E26.m1.1.1.1.1.1.3.3.3.cmml" xref="A2.E26.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E26.m1.2.2.2.2.cmml" xref="A2.E26.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E26.m1.2.2.2.2.1.cmml" xref="A2.E26.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E26.m1.2.2.2.1.1.cmml" xref="A2.E26.m1.2.2.2.1.1"><minus id="A2.E26.m1.2.2.2.1.1.1.cmml" xref="A2.E26.m1.2.2.2.1.1.1"></minus><ci id="A2.E26.m1.2.2.2.1.1.2.cmml" xref="A2.E26.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E26.m1.2.2.2.1.1.3.cmml" xref="A2.E26.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.2.2.2.1.1.3.1.cmml" xref="A2.E26.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E26.m1.2.2.2.1.1.3.2.cmml" xref="A2.E26.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E26.m1.2.2.2.1.1.3.3.cmml" xref="A2.E26.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E26.m1.6.6.1.1.1.1.2.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="A2.E26.m1.6.6.1.1.1.1.2.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E26.m1.6.6.1.1.1.1.1.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1"><minus id="A2.E26.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.1"></minus><apply id="A2.E26.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2"><ci id="A2.E26.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.1">⋅</ci><apply id="A2.E26.m1.3.3.cmml" xref="A2.E26.m1.3.3"><divide id="A2.E26.m1.3.3.2.cmml" xref="A2.E26.m1.3.3"></divide><ci id="A2.E26.m1.3.3.3.cmml" xref="A2.E26.m1.3.3.3">𝒙</ci><apply id="A2.E26.m1.3.3.1.2.cmml" xref="A2.E26.m1.3.3.1.3"><csymbol cd="latexml" id="A2.E26.m1.3.3.1.2.1.cmml" xref="A2.E26.m1.3.3.1.3.1">norm</csymbol><ci id="A2.E26.m1.3.3.1.1.cmml" xref="A2.E26.m1.3.3.1.1">𝒙</ci></apply></apply><apply id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.2">𝒗</ci><ci id="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A2.E26.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.3"><ci id="A2.E26.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="A2.E26.m1.6.6.1.1.1.1.1.1.3.1">⋅</ci><apply id="A2.E26.m1.4.4.cmml" xref="A2.E26.m1.4.4"><divide id="A2.E26.m1.4.4.2.cmml" xref="A2.E26.m1.4.4"></divide><apply id="A2.E26.m1.4.4.3.cmml" xref="A2.E26.m1.4.4.3"><minus id="A2.E26.m1.4.4.3.1.cmml" xref="A2.E26.m1.4.4.3.1"></minus><apply id="A2.E26.m1.4.4.3.2.cmml" xref="A2.E26.m1.4.4.3.2"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.3.2.1.cmml" xref="A2.E26.m1.4.4.3.2">subscript</csymbol><ci id="A2.E26.m1.4.4.3.2.2.cmml" xref="A2.E26.m1.4.4.3.2.2">𝐯</ci><ci id="A2.E26.m1.4.4.3.2.3.cmml" xref="A2.E26.m1.4.4.3.2.3">𝑗</ci></apply><apply id="A2.E26.m1.4.4.3.3.cmml" xref="A2.E26.m1.4.4.3.3"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.3.3.1.cmml" xref="A2.E26.m1.4.4.3.3">subscript</csymbol><ci id="A2.E26.m1.4.4.3.3.2.cmml" xref="A2.E26.m1.4.4.3.3.2">𝜇</ci><apply id="A2.E26.m1.4.4.3.3.3.cmml" xref="A2.E26.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.3.3.3.1.cmml" xref="A2.E26.m1.4.4.3.3.3">subscript</csymbol><ci id="A2.E26.m1.4.4.3.3.3.2.cmml" xref="A2.E26.m1.4.4.3.3.3.2">𝐯</ci><ci id="A2.E26.m1.4.4.3.3.3.3.cmml" xref="A2.E26.m1.4.4.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A2.E26.m1.4.4.1.2.cmml" xref="A2.E26.m1.4.4.1.1"><csymbol cd="latexml" id="A2.E26.m1.4.4.1.2.1.cmml" xref="A2.E26.m1.4.4.1.1.2">norm</csymbol><apply id="A2.E26.m1.4.4.1.1.1.cmml" xref="A2.E26.m1.4.4.1.1.1"><minus id="A2.E26.m1.4.4.1.1.1.1.cmml" xref="A2.E26.m1.4.4.1.1.1.1"></minus><apply id="A2.E26.m1.4.4.1.1.1.2.cmml" xref="A2.E26.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.1.1.1.2.1.cmml" xref="A2.E26.m1.4.4.1.1.1.2">subscript</csymbol><ci id="A2.E26.m1.4.4.1.1.1.2.2.cmml" xref="A2.E26.m1.4.4.1.1.1.2.2">𝐯</ci><ci id="A2.E26.m1.4.4.1.1.1.2.3.cmml" xref="A2.E26.m1.4.4.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E26.m1.4.4.1.1.1.3.cmml" xref="A2.E26.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.1.1.1.3.1.cmml" xref="A2.E26.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A2.E26.m1.4.4.1.1.1.3.2.cmml" xref="A2.E26.m1.4.4.1.1.1.3.2">𝜇</ci><apply id="A2.E26.m1.4.4.1.1.1.3.3.cmml" xref="A2.E26.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E26.m1.4.4.1.1.1.3.3.1.cmml" xref="A2.E26.m1.4.4.1.1.1.3.3">subscript</csymbol><ci id="A2.E26.m1.4.4.1.1.1.3.3.2.cmml" xref="A2.E26.m1.4.4.1.1.1.3.3.2">𝐯</ci><ci id="A2.E26.m1.4.4.1.1.1.3.3.3.cmml" xref="A2.E26.m1.4.4.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A2.E26.m1.5.5.cmml" xref="A2.E26.m1.5.5"><divide id="A2.E26.m1.5.5.2.cmml" xref="A2.E26.m1.5.5"></divide><apply id="A2.E26.m1.5.5.3.cmml" xref="A2.E26.m1.5.5.3"><minus id="A2.E26.m1.5.5.3.1.cmml" xref="A2.E26.m1.5.5.3.1"></minus><ci id="A2.E26.m1.5.5.3.2.cmml" xref="A2.E26.m1.5.5.3.2">𝐱</ci><apply id="A2.E26.m1.5.5.3.3.cmml" xref="A2.E26.m1.5.5.3.3"><csymbol cd="ambiguous" id="A2.E26.m1.5.5.3.3.1.cmml" xref="A2.E26.m1.5.5.3.3">subscript</csymbol><ci id="A2.E26.m1.5.5.3.3.2.cmml" xref="A2.E26.m1.5.5.3.3.2">𝜇</ci><ci id="A2.E26.m1.5.5.3.3.3.cmml" xref="A2.E26.m1.5.5.3.3.3">𝐱</ci></apply></apply><apply id="A2.E26.m1.5.5.1.2.cmml" xref="A2.E26.m1.5.5.1.1"><csymbol cd="latexml" id="A2.E26.m1.5.5.1.2.1.cmml" xref="A2.E26.m1.5.5.1.1.2">norm</csymbol><apply id="A2.E26.m1.5.5.1.1.1.cmml" xref="A2.E26.m1.5.5.1.1.1"><minus id="A2.E26.m1.5.5.1.1.1.1.cmml" xref="A2.E26.m1.5.5.1.1.1.1"></minus><ci id="A2.E26.m1.5.5.1.1.1.2.cmml" xref="A2.E26.m1.5.5.1.1.1.2">𝐱</ci><apply id="A2.E26.m1.5.5.1.1.1.3.cmml" xref="A2.E26.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.5.5.1.1.1.3.1.cmml" xref="A2.E26.m1.5.5.1.1.1.3">subscript</csymbol><ci id="A2.E26.m1.5.5.1.1.1.3.2.cmml" xref="A2.E26.m1.5.5.1.1.1.3.2">𝜇</ci><ci id="A2.E26.m1.5.5.1.1.1.3.3.cmml" xref="A2.E26.m1.5.5.1.1.1.3.3">𝐱</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E26.m1.6c">\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\left[\frac{\boldsymbol{x}}{\|\boldsymbol{x}\|}\cdot\boldsymbol%
{v}_{j}-\frac{\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}}{\|\mathbf{v}_{j}-\mu_{%
\mathbf{v}_{j}}\|}\cdot\frac{\mathbf{x}-\mu_{\mathbf{x}}}{\|\mathbf{x}-\mu_{%
\mathbf{x}}\|}\right]~{}.</annotation><annotation encoding="application/x-llamapun" id="A2.E26.m1.6d">= divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG [ divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG ⋅ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - divide start_ARG bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG ⋅ divide start_ARG bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p12">
<p class="ltx_p" id="A2.SS1.p12.1">Inserting previous results into <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E13" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">13</span></a> leads to:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p13">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx5">
<tbody id="A2.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|%
\boldsymbol{x}\|}" class="ltx_Math" display="inline" id="A2.E27.m1.1"><semantics id="A2.E27.m1.1a"><mrow id="A2.E27.m1.1.2" xref="A2.E27.m1.1.2.cmml"><mstyle displaystyle="true" id="A2.E27.m1.1.2.2" xref="A2.E27.m1.1.2.2.cmml"><mfrac id="A2.E27.m1.1.2.2a" xref="A2.E27.m1.1.2.2.cmml"><mo id="A2.E27.m1.1.2.2.2" xref="A2.E27.m1.1.2.2.2.cmml">∂</mo><mrow id="A2.E27.m1.1.2.2.3" xref="A2.E27.m1.1.2.2.3.cmml"><mo id="A2.E27.m1.1.2.2.3.1" rspace="0em" xref="A2.E27.m1.1.2.2.3.1.cmml">∂</mo><msub id="A2.E27.m1.1.2.2.3.2" xref="A2.E27.m1.1.2.2.3.2.cmml"><mi id="A2.E27.m1.1.2.2.3.2.2" xref="A2.E27.m1.1.2.2.3.2.2.cmml">a</mi><mi id="A2.E27.m1.1.2.2.3.2.3" xref="A2.E27.m1.1.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo id="A2.E27.m1.1.2.1" xref="A2.E27.m1.1.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E27.m1.1.1" xref="A2.E27.m1.1.1.cmml"><mfrac id="A2.E27.m1.1.1a" xref="A2.E27.m1.1.1.cmml"><mi id="A2.E27.m1.1.1.3" xref="A2.E27.m1.1.1.3.cmml">𝒙</mi><mrow id="A2.E27.m1.1.1.1.3" xref="A2.E27.m1.1.1.1.2.cmml"><mo id="A2.E27.m1.1.1.1.3.1" stretchy="false" xref="A2.E27.m1.1.1.1.2.1.cmml">‖</mo><mi id="A2.E27.m1.1.1.1.1" xref="A2.E27.m1.1.1.1.1.cmml">𝒙</mi><mo id="A2.E27.m1.1.1.1.3.2" stretchy="false" xref="A2.E27.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A2.E27.m1.1b"><apply id="A2.E27.m1.1.2.cmml" xref="A2.E27.m1.1.2"><times id="A2.E27.m1.1.2.1.cmml" xref="A2.E27.m1.1.2.1"></times><apply id="A2.E27.m1.1.2.2.cmml" xref="A2.E27.m1.1.2.2"><divide id="A2.E27.m1.1.2.2.1.cmml" xref="A2.E27.m1.1.2.2"></divide><partialdiff id="A2.E27.m1.1.2.2.2.cmml" xref="A2.E27.m1.1.2.2.2"></partialdiff><apply id="A2.E27.m1.1.2.2.3.cmml" xref="A2.E27.m1.1.2.2.3"><partialdiff id="A2.E27.m1.1.2.2.3.1.cmml" xref="A2.E27.m1.1.2.2.3.1"></partialdiff><apply id="A2.E27.m1.1.2.2.3.2.cmml" xref="A2.E27.m1.1.2.2.3.2"><csymbol cd="ambiguous" id="A2.E27.m1.1.2.2.3.2.1.cmml" xref="A2.E27.m1.1.2.2.3.2">subscript</csymbol><ci id="A2.E27.m1.1.2.2.3.2.2.cmml" xref="A2.E27.m1.1.2.2.3.2.2">𝑎</ci><ci id="A2.E27.m1.1.2.2.3.2.3.cmml" xref="A2.E27.m1.1.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E27.m1.1.1.cmml" xref="A2.E27.m1.1.1"><divide id="A2.E27.m1.1.1.2.cmml" xref="A2.E27.m1.1.1"></divide><ci id="A2.E27.m1.1.1.3.cmml" xref="A2.E27.m1.1.1.3">𝒙</ci><apply id="A2.E27.m1.1.1.1.2.cmml" xref="A2.E27.m1.1.1.1.3"><csymbol cd="latexml" id="A2.E27.m1.1.1.1.2.1.cmml" xref="A2.E27.m1.1.1.1.3.1">norm</csymbol><ci id="A2.E27.m1.1.1.1.1.cmml" xref="A2.E27.m1.1.1.1.1">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E27.m1.1c">\displaystyle\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|%
\boldsymbol{x}\|}</annotation><annotation encoding="application/x-llamapun" id="A2.E27.m1.1d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\frac{1}{\|\boldsymbol{x}\|}\left[\boldsymbol{v}_{j}-\frac{%
\boldsymbol{x}\cdot\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|}\frac{\boldsymbol{x}%
}{\|\boldsymbol{x}\|}\right]" class="ltx_Math" display="inline" id="A2.E27.m2.6"><semantics id="A2.E27.m2.6a"><mrow id="A2.E27.m2.6.6" xref="A2.E27.m2.6.6.cmml"><mi id="A2.E27.m2.6.6.3" xref="A2.E27.m2.6.6.3.cmml"></mi><mo id="A2.E27.m2.6.6.2" xref="A2.E27.m2.6.6.2.cmml">=</mo><mrow id="A2.E27.m2.6.6.1" xref="A2.E27.m2.6.6.1.cmml"><mstyle displaystyle="true" id="A2.E27.m2.2.2" xref="A2.E27.m2.2.2.cmml"><mfrac id="A2.E27.m2.2.2a" xref="A2.E27.m2.2.2.cmml"><mrow id="A2.E27.m2.1.1.1.1" xref="A2.E27.m2.1.1.1.2.cmml"><mo id="A2.E27.m2.1.1.1.1.2" stretchy="false" xref="A2.E27.m2.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E27.m2.1.1.1.1.1" xref="A2.E27.m2.1.1.1.1.1.cmml"><msub id="A2.E27.m2.1.1.1.1.1.2" xref="A2.E27.m2.1.1.1.1.1.2.cmml"><mi id="A2.E27.m2.1.1.1.1.1.2.2" xref="A2.E27.m2.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E27.m2.1.1.1.1.1.2.3" xref="A2.E27.m2.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E27.m2.1.1.1.1.1.1" xref="A2.E27.m2.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E27.m2.1.1.1.1.1.3" xref="A2.E27.m2.1.1.1.1.1.3.cmml"><mi id="A2.E27.m2.1.1.1.1.1.3.2" xref="A2.E27.m2.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E27.m2.1.1.1.1.1.3.3" xref="A2.E27.m2.1.1.1.1.1.3.3.cmml"><mi id="A2.E27.m2.1.1.1.1.1.3.3.2" xref="A2.E27.m2.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E27.m2.1.1.1.1.1.3.3.3" xref="A2.E27.m2.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E27.m2.1.1.1.1.3" stretchy="false" xref="A2.E27.m2.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E27.m2.2.2.2.1" xref="A2.E27.m2.2.2.2.2.cmml"><mo id="A2.E27.m2.2.2.2.1.2" stretchy="false" xref="A2.E27.m2.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E27.m2.2.2.2.1.1" xref="A2.E27.m2.2.2.2.1.1.cmml"><mi id="A2.E27.m2.2.2.2.1.1.2" xref="A2.E27.m2.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E27.m2.2.2.2.1.1.1" xref="A2.E27.m2.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E27.m2.2.2.2.1.1.3" xref="A2.E27.m2.2.2.2.1.1.3.cmml"><mi id="A2.E27.m2.2.2.2.1.1.3.2" xref="A2.E27.m2.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E27.m2.2.2.2.1.1.3.3" xref="A2.E27.m2.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E27.m2.2.2.2.1.3" stretchy="false" xref="A2.E27.m2.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E27.m2.6.6.1.2" xref="A2.E27.m2.6.6.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E27.m2.3.3" xref="A2.E27.m2.3.3.cmml"><mfrac id="A2.E27.m2.3.3a" xref="A2.E27.m2.3.3.cmml"><mn id="A2.E27.m2.3.3.3" xref="A2.E27.m2.3.3.3.cmml">1</mn><mrow id="A2.E27.m2.3.3.1.3" xref="A2.E27.m2.3.3.1.2.cmml"><mo id="A2.E27.m2.3.3.1.3.1" stretchy="false" xref="A2.E27.m2.3.3.1.2.1.cmml">‖</mo><mi id="A2.E27.m2.3.3.1.1" xref="A2.E27.m2.3.3.1.1.cmml">𝒙</mi><mo id="A2.E27.m2.3.3.1.3.2" stretchy="false" xref="A2.E27.m2.3.3.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E27.m2.6.6.1.2a" xref="A2.E27.m2.6.6.1.2.cmml">⁢</mo><mrow id="A2.E27.m2.6.6.1.1.1" xref="A2.E27.m2.6.6.1.1.2.cmml"><mo id="A2.E27.m2.6.6.1.1.1.2" xref="A2.E27.m2.6.6.1.1.2.1.cmml">[</mo><mrow id="A2.E27.m2.6.6.1.1.1.1" xref="A2.E27.m2.6.6.1.1.1.1.cmml"><msub id="A2.E27.m2.6.6.1.1.1.1.2" xref="A2.E27.m2.6.6.1.1.1.1.2.cmml"><mi id="A2.E27.m2.6.6.1.1.1.1.2.2" xref="A2.E27.m2.6.6.1.1.1.1.2.2.cmml">𝒗</mi><mi id="A2.E27.m2.6.6.1.1.1.1.2.3" xref="A2.E27.m2.6.6.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E27.m2.6.6.1.1.1.1.1" xref="A2.E27.m2.6.6.1.1.1.1.1.cmml">−</mo><mrow id="A2.E27.m2.6.6.1.1.1.1.3" xref="A2.E27.m2.6.6.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A2.E27.m2.4.4" xref="A2.E27.m2.4.4.cmml"><mfrac id="A2.E27.m2.4.4a" xref="A2.E27.m2.4.4.cmml"><mrow id="A2.E27.m2.4.4.3" xref="A2.E27.m2.4.4.3.cmml"><mi id="A2.E27.m2.4.4.3.2" xref="A2.E27.m2.4.4.3.2.cmml">𝒙</mi><mo id="A2.E27.m2.4.4.3.1" lspace="0.222em" rspace="0.222em" xref="A2.E27.m2.4.4.3.1.cmml">⋅</mo><msub id="A2.E27.m2.4.4.3.3" xref="A2.E27.m2.4.4.3.3.cmml"><mi id="A2.E27.m2.4.4.3.3.2" xref="A2.E27.m2.4.4.3.3.2.cmml">𝒗</mi><mi id="A2.E27.m2.4.4.3.3.3" xref="A2.E27.m2.4.4.3.3.3.cmml">j</mi></msub></mrow><mrow id="A2.E27.m2.4.4.1.3" xref="A2.E27.m2.4.4.1.2.cmml"><mo id="A2.E27.m2.4.4.1.3.1" stretchy="false" xref="A2.E27.m2.4.4.1.2.1.cmml">‖</mo><mi id="A2.E27.m2.4.4.1.1" xref="A2.E27.m2.4.4.1.1.cmml">𝒙</mi><mo id="A2.E27.m2.4.4.1.3.2" stretchy="false" xref="A2.E27.m2.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E27.m2.6.6.1.1.1.1.3.1" xref="A2.E27.m2.6.6.1.1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E27.m2.5.5" xref="A2.E27.m2.5.5.cmml"><mfrac id="A2.E27.m2.5.5a" xref="A2.E27.m2.5.5.cmml"><mi id="A2.E27.m2.5.5.3" xref="A2.E27.m2.5.5.3.cmml">𝒙</mi><mrow id="A2.E27.m2.5.5.1.3" xref="A2.E27.m2.5.5.1.2.cmml"><mo id="A2.E27.m2.5.5.1.3.1" stretchy="false" xref="A2.E27.m2.5.5.1.2.1.cmml">‖</mo><mi id="A2.E27.m2.5.5.1.1" xref="A2.E27.m2.5.5.1.1.cmml">𝒙</mi><mo id="A2.E27.m2.5.5.1.3.2" stretchy="false" xref="A2.E27.m2.5.5.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow></mrow><mo id="A2.E27.m2.6.6.1.1.1.3" xref="A2.E27.m2.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E27.m2.6b"><apply id="A2.E27.m2.6.6.cmml" xref="A2.E27.m2.6.6"><eq id="A2.E27.m2.6.6.2.cmml" xref="A2.E27.m2.6.6.2"></eq><csymbol cd="latexml" id="A2.E27.m2.6.6.3.cmml" xref="A2.E27.m2.6.6.3">absent</csymbol><apply id="A2.E27.m2.6.6.1.cmml" xref="A2.E27.m2.6.6.1"><times id="A2.E27.m2.6.6.1.2.cmml" xref="A2.E27.m2.6.6.1.2"></times><apply id="A2.E27.m2.2.2.cmml" xref="A2.E27.m2.2.2"><divide id="A2.E27.m2.2.2.3.cmml" xref="A2.E27.m2.2.2"></divide><apply id="A2.E27.m2.1.1.1.2.cmml" xref="A2.E27.m2.1.1.1.1"><csymbol cd="latexml" id="A2.E27.m2.1.1.1.2.1.cmml" xref="A2.E27.m2.1.1.1.1.2">norm</csymbol><apply id="A2.E27.m2.1.1.1.1.1.cmml" xref="A2.E27.m2.1.1.1.1.1"><minus id="A2.E27.m2.1.1.1.1.1.1.cmml" xref="A2.E27.m2.1.1.1.1.1.1"></minus><apply id="A2.E27.m2.1.1.1.1.1.2.cmml" xref="A2.E27.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E27.m2.1.1.1.1.1.2.1.cmml" xref="A2.E27.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E27.m2.1.1.1.1.1.2.2.cmml" xref="A2.E27.m2.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E27.m2.1.1.1.1.1.2.3.cmml" xref="A2.E27.m2.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E27.m2.1.1.1.1.1.3.cmml" xref="A2.E27.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E27.m2.1.1.1.1.1.3.1.cmml" xref="A2.E27.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E27.m2.1.1.1.1.1.3.2.cmml" xref="A2.E27.m2.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E27.m2.1.1.1.1.1.3.3.cmml" xref="A2.E27.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E27.m2.1.1.1.1.1.3.3.1.cmml" xref="A2.E27.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E27.m2.1.1.1.1.1.3.3.2.cmml" xref="A2.E27.m2.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E27.m2.1.1.1.1.1.3.3.3.cmml" xref="A2.E27.m2.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E27.m2.2.2.2.2.cmml" xref="A2.E27.m2.2.2.2.1"><csymbol cd="latexml" id="A2.E27.m2.2.2.2.2.1.cmml" xref="A2.E27.m2.2.2.2.1.2">norm</csymbol><apply id="A2.E27.m2.2.2.2.1.1.cmml" xref="A2.E27.m2.2.2.2.1.1"><minus id="A2.E27.m2.2.2.2.1.1.1.cmml" xref="A2.E27.m2.2.2.2.1.1.1"></minus><ci id="A2.E27.m2.2.2.2.1.1.2.cmml" xref="A2.E27.m2.2.2.2.1.1.2">𝐱</ci><apply id="A2.E27.m2.2.2.2.1.1.3.cmml" xref="A2.E27.m2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E27.m2.2.2.2.1.1.3.1.cmml" xref="A2.E27.m2.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E27.m2.2.2.2.1.1.3.2.cmml" xref="A2.E27.m2.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E27.m2.2.2.2.1.1.3.3.cmml" xref="A2.E27.m2.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E27.m2.3.3.cmml" xref="A2.E27.m2.3.3"><divide id="A2.E27.m2.3.3.2.cmml" xref="A2.E27.m2.3.3"></divide><cn id="A2.E27.m2.3.3.3.cmml" type="integer" xref="A2.E27.m2.3.3.3">1</cn><apply id="A2.E27.m2.3.3.1.2.cmml" xref="A2.E27.m2.3.3.1.3"><csymbol cd="latexml" id="A2.E27.m2.3.3.1.2.1.cmml" xref="A2.E27.m2.3.3.1.3.1">norm</csymbol><ci id="A2.E27.m2.3.3.1.1.cmml" xref="A2.E27.m2.3.3.1.1">𝒙</ci></apply></apply><apply id="A2.E27.m2.6.6.1.1.2.cmml" xref="A2.E27.m2.6.6.1.1.1"><csymbol cd="latexml" id="A2.E27.m2.6.6.1.1.2.1.cmml" xref="A2.E27.m2.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A2.E27.m2.6.6.1.1.1.1.cmml" xref="A2.E27.m2.6.6.1.1.1.1"><minus id="A2.E27.m2.6.6.1.1.1.1.1.cmml" xref="A2.E27.m2.6.6.1.1.1.1.1"></minus><apply id="A2.E27.m2.6.6.1.1.1.1.2.cmml" xref="A2.E27.m2.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E27.m2.6.6.1.1.1.1.2.1.cmml" xref="A2.E27.m2.6.6.1.1.1.1.2">subscript</csymbol><ci id="A2.E27.m2.6.6.1.1.1.1.2.2.cmml" xref="A2.E27.m2.6.6.1.1.1.1.2.2">𝒗</ci><ci id="A2.E27.m2.6.6.1.1.1.1.2.3.cmml" xref="A2.E27.m2.6.6.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E27.m2.6.6.1.1.1.1.3.cmml" xref="A2.E27.m2.6.6.1.1.1.1.3"><times id="A2.E27.m2.6.6.1.1.1.1.3.1.cmml" xref="A2.E27.m2.6.6.1.1.1.1.3.1"></times><apply id="A2.E27.m2.4.4.cmml" xref="A2.E27.m2.4.4"><divide id="A2.E27.m2.4.4.2.cmml" xref="A2.E27.m2.4.4"></divide><apply id="A2.E27.m2.4.4.3.cmml" xref="A2.E27.m2.4.4.3"><ci id="A2.E27.m2.4.4.3.1.cmml" xref="A2.E27.m2.4.4.3.1">⋅</ci><ci id="A2.E27.m2.4.4.3.2.cmml" xref="A2.E27.m2.4.4.3.2">𝒙</ci><apply id="A2.E27.m2.4.4.3.3.cmml" xref="A2.E27.m2.4.4.3.3"><csymbol cd="ambiguous" id="A2.E27.m2.4.4.3.3.1.cmml" xref="A2.E27.m2.4.4.3.3">subscript</csymbol><ci id="A2.E27.m2.4.4.3.3.2.cmml" xref="A2.E27.m2.4.4.3.3.2">𝒗</ci><ci id="A2.E27.m2.4.4.3.3.3.cmml" xref="A2.E27.m2.4.4.3.3.3">𝑗</ci></apply></apply><apply id="A2.E27.m2.4.4.1.2.cmml" xref="A2.E27.m2.4.4.1.3"><csymbol cd="latexml" id="A2.E27.m2.4.4.1.2.1.cmml" xref="A2.E27.m2.4.4.1.3.1">norm</csymbol><ci id="A2.E27.m2.4.4.1.1.cmml" xref="A2.E27.m2.4.4.1.1">𝒙</ci></apply></apply><apply id="A2.E27.m2.5.5.cmml" xref="A2.E27.m2.5.5"><divide id="A2.E27.m2.5.5.2.cmml" xref="A2.E27.m2.5.5"></divide><ci id="A2.E27.m2.5.5.3.cmml" xref="A2.E27.m2.5.5.3">𝒙</ci><apply id="A2.E27.m2.5.5.1.2.cmml" xref="A2.E27.m2.5.5.1.3"><csymbol cd="latexml" id="A2.E27.m2.5.5.1.2.1.cmml" xref="A2.E27.m2.5.5.1.3.1">norm</csymbol><ci id="A2.E27.m2.5.5.1.1.cmml" xref="A2.E27.m2.5.5.1.1">𝒙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E27.m2.6c">\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\frac{1}{\|\boldsymbol{x}\|}\left[\boldsymbol{v}_{j}-\frac{%
\boldsymbol{x}\cdot\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|}\frac{\boldsymbol{x}%
}{\|\boldsymbol{x}\|}\right]</annotation><annotation encoding="application/x-llamapun" id="A2.E27.m2.6d">= divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG 1 end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG [ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - divide start_ARG bold_italic_x ⋅ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
<tbody id="A2.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[\frac{%
\boldsymbol{v}_{j}}{\|\boldsymbol{v}_{j}\|}-\frac{\boldsymbol{x}\cdot%
\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|\|\boldsymbol{v}_{j}\|}\frac{\boldsymbol%
{x}}{\|\boldsymbol{x}\|}\right]~{}," class="ltx_Math" display="inline" id="A2.E28.m1.9"><semantics id="A2.E28.m1.9a"><mrow id="A2.E28.m1.9.9.1" xref="A2.E28.m1.9.9.1.1.cmml"><mrow id="A2.E28.m1.9.9.1.1" xref="A2.E28.m1.9.9.1.1.cmml"><mi id="A2.E28.m1.9.9.1.1.3" xref="A2.E28.m1.9.9.1.1.3.cmml"></mi><mo id="A2.E28.m1.9.9.1.1.2" xref="A2.E28.m1.9.9.1.1.2.cmml">=</mo><mrow id="A2.E28.m1.9.9.1.1.1" xref="A2.E28.m1.9.9.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E28.m1.2.2" xref="A2.E28.m1.2.2.cmml"><mfrac id="A2.E28.m1.2.2a" xref="A2.E28.m1.2.2.cmml"><mrow id="A2.E28.m1.1.1.1.1" xref="A2.E28.m1.1.1.1.2.cmml"><mo id="A2.E28.m1.1.1.1.1.2" stretchy="false" xref="A2.E28.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E28.m1.1.1.1.1.1" xref="A2.E28.m1.1.1.1.1.1.cmml"><msub id="A2.E28.m1.1.1.1.1.1.2" xref="A2.E28.m1.1.1.1.1.1.2.cmml"><mi id="A2.E28.m1.1.1.1.1.1.2.2" xref="A2.E28.m1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E28.m1.1.1.1.1.1.2.3" xref="A2.E28.m1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E28.m1.1.1.1.1.1.1" xref="A2.E28.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E28.m1.1.1.1.1.1.3" xref="A2.E28.m1.1.1.1.1.1.3.cmml"><mi id="A2.E28.m1.1.1.1.1.1.3.2" xref="A2.E28.m1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E28.m1.1.1.1.1.1.3.3" xref="A2.E28.m1.1.1.1.1.1.3.3.cmml"><mi id="A2.E28.m1.1.1.1.1.1.3.3.2" xref="A2.E28.m1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E28.m1.1.1.1.1.1.3.3.3" xref="A2.E28.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E28.m1.1.1.1.1.3" stretchy="false" xref="A2.E28.m1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E28.m1.2.2.2.1" xref="A2.E28.m1.2.2.2.2.cmml"><mo id="A2.E28.m1.2.2.2.1.2" stretchy="false" xref="A2.E28.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E28.m1.2.2.2.1.1" xref="A2.E28.m1.2.2.2.1.1.cmml"><mi id="A2.E28.m1.2.2.2.1.1.2" xref="A2.E28.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E28.m1.2.2.2.1.1.1" xref="A2.E28.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E28.m1.2.2.2.1.1.3" xref="A2.E28.m1.2.2.2.1.1.3.cmml"><mi id="A2.E28.m1.2.2.2.1.1.3.2" xref="A2.E28.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E28.m1.2.2.2.1.1.3.3" xref="A2.E28.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E28.m1.2.2.2.1.3" stretchy="false" xref="A2.E28.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E28.m1.9.9.1.1.1.2" xref="A2.E28.m1.9.9.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E28.m1.4.4" xref="A2.E28.m1.4.4.cmml"><mfrac id="A2.E28.m1.4.4a" xref="A2.E28.m1.4.4.cmml"><mrow id="A2.E28.m1.3.3.1.1" xref="A2.E28.m1.3.3.1.2.cmml"><mo id="A2.E28.m1.3.3.1.1.2" stretchy="false" xref="A2.E28.m1.3.3.1.2.1.cmml">‖</mo><msub id="A2.E28.m1.3.3.1.1.1" xref="A2.E28.m1.3.3.1.1.1.cmml"><mi id="A2.E28.m1.3.3.1.1.1.2" xref="A2.E28.m1.3.3.1.1.1.2.cmml">𝒗</mi><mi id="A2.E28.m1.3.3.1.1.1.3" xref="A2.E28.m1.3.3.1.1.1.3.cmml">j</mi></msub><mo id="A2.E28.m1.3.3.1.1.3" stretchy="false" xref="A2.E28.m1.3.3.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E28.m1.4.4.2.3" xref="A2.E28.m1.4.4.2.2.cmml"><mo id="A2.E28.m1.4.4.2.3.1" stretchy="false" xref="A2.E28.m1.4.4.2.2.1.cmml">‖</mo><mi id="A2.E28.m1.4.4.2.1" xref="A2.E28.m1.4.4.2.1.cmml">𝒙</mi><mo id="A2.E28.m1.4.4.2.3.2" stretchy="false" xref="A2.E28.m1.4.4.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E28.m1.9.9.1.1.1.2a" xref="A2.E28.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="A2.E28.m1.9.9.1.1.1.1.1" xref="A2.E28.m1.9.9.1.1.1.1.2.cmml"><mo id="A2.E28.m1.9.9.1.1.1.1.1.2" xref="A2.E28.m1.9.9.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.E28.m1.9.9.1.1.1.1.1.1" xref="A2.E28.m1.9.9.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E28.m1.5.5" xref="A2.E28.m1.5.5.cmml"><mfrac id="A2.E28.m1.5.5a" xref="A2.E28.m1.5.5.cmml"><msub id="A2.E28.m1.5.5.3" xref="A2.E28.m1.5.5.3.cmml"><mi id="A2.E28.m1.5.5.3.2" xref="A2.E28.m1.5.5.3.2.cmml">𝒗</mi><mi id="A2.E28.m1.5.5.3.3" xref="A2.E28.m1.5.5.3.3.cmml">j</mi></msub><mrow id="A2.E28.m1.5.5.1.1" xref="A2.E28.m1.5.5.1.2.cmml"><mo id="A2.E28.m1.5.5.1.1.2" stretchy="false" xref="A2.E28.m1.5.5.1.2.1.cmml">‖</mo><msub id="A2.E28.m1.5.5.1.1.1" xref="A2.E28.m1.5.5.1.1.1.cmml"><mi id="A2.E28.m1.5.5.1.1.1.2" xref="A2.E28.m1.5.5.1.1.1.2.cmml">𝒗</mi><mi id="A2.E28.m1.5.5.1.1.1.3" xref="A2.E28.m1.5.5.1.1.1.3.cmml">j</mi></msub><mo id="A2.E28.m1.5.5.1.1.3" stretchy="false" xref="A2.E28.m1.5.5.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E28.m1.9.9.1.1.1.1.1.1.1" xref="A2.E28.m1.9.9.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E28.m1.9.9.1.1.1.1.1.1.2" xref="A2.E28.m1.9.9.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A2.E28.m1.7.7" xref="A2.E28.m1.7.7.cmml"><mfrac id="A2.E28.m1.7.7a" xref="A2.E28.m1.7.7.cmml"><mrow id="A2.E28.m1.7.7.4" xref="A2.E28.m1.7.7.4.cmml"><mi id="A2.E28.m1.7.7.4.2" xref="A2.E28.m1.7.7.4.2.cmml">𝒙</mi><mo id="A2.E28.m1.7.7.4.1" lspace="0.222em" rspace="0.222em" xref="A2.E28.m1.7.7.4.1.cmml">⋅</mo><msub id="A2.E28.m1.7.7.4.3" xref="A2.E28.m1.7.7.4.3.cmml"><mi id="A2.E28.m1.7.7.4.3.2" xref="A2.E28.m1.7.7.4.3.2.cmml">𝒗</mi><mi id="A2.E28.m1.7.7.4.3.3" xref="A2.E28.m1.7.7.4.3.3.cmml">j</mi></msub></mrow><mrow id="A2.E28.m1.7.7.2" xref="A2.E28.m1.7.7.2.cmml"><mrow id="A2.E28.m1.7.7.2.4.2" xref="A2.E28.m1.7.7.2.4.1.cmml"><mo id="A2.E28.m1.7.7.2.4.2.1" stretchy="false" xref="A2.E28.m1.7.7.2.4.1.1.cmml">‖</mo><mi id="A2.E28.m1.6.6.1.1" xref="A2.E28.m1.6.6.1.1.cmml">𝒙</mi><mo id="A2.E28.m1.7.7.2.4.2.2" stretchy="false" xref="A2.E28.m1.7.7.2.4.1.1.cmml">‖</mo></mrow><mo id="A2.E28.m1.7.7.2.3" xref="A2.E28.m1.7.7.2.3.cmml">⁢</mo><mrow id="A2.E28.m1.7.7.2.2.1" xref="A2.E28.m1.7.7.2.2.2.cmml"><mo id="A2.E28.m1.7.7.2.2.1.2" stretchy="false" xref="A2.E28.m1.7.7.2.2.2.1.cmml">‖</mo><msub id="A2.E28.m1.7.7.2.2.1.1" xref="A2.E28.m1.7.7.2.2.1.1.cmml"><mi id="A2.E28.m1.7.7.2.2.1.1.2" xref="A2.E28.m1.7.7.2.2.1.1.2.cmml">𝒗</mi><mi id="A2.E28.m1.7.7.2.2.1.1.3" xref="A2.E28.m1.7.7.2.2.1.1.3.cmml">j</mi></msub><mo id="A2.E28.m1.7.7.2.2.1.3" stretchy="false" xref="A2.E28.m1.7.7.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle><mo id="A2.E28.m1.9.9.1.1.1.1.1.1.2.1" xref="A2.E28.m1.9.9.1.1.1.1.1.1.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E28.m1.8.8" xref="A2.E28.m1.8.8.cmml"><mfrac id="A2.E28.m1.8.8a" xref="A2.E28.m1.8.8.cmml"><mi id="A2.E28.m1.8.8.3" xref="A2.E28.m1.8.8.3.cmml">𝒙</mi><mrow id="A2.E28.m1.8.8.1.3" xref="A2.E28.m1.8.8.1.2.cmml"><mo id="A2.E28.m1.8.8.1.3.1" stretchy="false" xref="A2.E28.m1.8.8.1.2.1.cmml">‖</mo><mi id="A2.E28.m1.8.8.1.1" xref="A2.E28.m1.8.8.1.1.cmml">𝒙</mi><mo id="A2.E28.m1.8.8.1.3.2" stretchy="false" xref="A2.E28.m1.8.8.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow></mrow><mo id="A2.E28.m1.9.9.1.1.1.1.1.3" rspace="0.330em" xref="A2.E28.m1.9.9.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.E28.m1.9.9.1.2" xref="A2.E28.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E28.m1.9b"><apply id="A2.E28.m1.9.9.1.1.cmml" xref="A2.E28.m1.9.9.1"><eq id="A2.E28.m1.9.9.1.1.2.cmml" xref="A2.E28.m1.9.9.1.1.2"></eq><csymbol cd="latexml" id="A2.E28.m1.9.9.1.1.3.cmml" xref="A2.E28.m1.9.9.1.1.3">absent</csymbol><apply id="A2.E28.m1.9.9.1.1.1.cmml" xref="A2.E28.m1.9.9.1.1.1"><times id="A2.E28.m1.9.9.1.1.1.2.cmml" xref="A2.E28.m1.9.9.1.1.1.2"></times><apply id="A2.E28.m1.2.2.cmml" xref="A2.E28.m1.2.2"><divide id="A2.E28.m1.2.2.3.cmml" xref="A2.E28.m1.2.2"></divide><apply id="A2.E28.m1.1.1.1.2.cmml" xref="A2.E28.m1.1.1.1.1"><csymbol cd="latexml" id="A2.E28.m1.1.1.1.2.1.cmml" xref="A2.E28.m1.1.1.1.1.2">norm</csymbol><apply id="A2.E28.m1.1.1.1.1.1.cmml" xref="A2.E28.m1.1.1.1.1.1"><minus id="A2.E28.m1.1.1.1.1.1.1.cmml" xref="A2.E28.m1.1.1.1.1.1.1"></minus><apply id="A2.E28.m1.1.1.1.1.1.2.cmml" xref="A2.E28.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E28.m1.1.1.1.1.1.2.1.cmml" xref="A2.E28.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E28.m1.1.1.1.1.1.2.2.cmml" xref="A2.E28.m1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E28.m1.1.1.1.1.1.2.3.cmml" xref="A2.E28.m1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E28.m1.1.1.1.1.1.3.cmml" xref="A2.E28.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E28.m1.1.1.1.1.1.3.1.cmml" xref="A2.E28.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E28.m1.1.1.1.1.1.3.2.cmml" xref="A2.E28.m1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E28.m1.1.1.1.1.1.3.3.cmml" xref="A2.E28.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E28.m1.1.1.1.1.1.3.3.1.cmml" xref="A2.E28.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E28.m1.1.1.1.1.1.3.3.2.cmml" xref="A2.E28.m1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E28.m1.1.1.1.1.1.3.3.3.cmml" xref="A2.E28.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E28.m1.2.2.2.2.cmml" xref="A2.E28.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E28.m1.2.2.2.2.1.cmml" xref="A2.E28.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E28.m1.2.2.2.1.1.cmml" xref="A2.E28.m1.2.2.2.1.1"><minus id="A2.E28.m1.2.2.2.1.1.1.cmml" xref="A2.E28.m1.2.2.2.1.1.1"></minus><ci id="A2.E28.m1.2.2.2.1.1.2.cmml" xref="A2.E28.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E28.m1.2.2.2.1.1.3.cmml" xref="A2.E28.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E28.m1.2.2.2.1.1.3.1.cmml" xref="A2.E28.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E28.m1.2.2.2.1.1.3.2.cmml" xref="A2.E28.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E28.m1.2.2.2.1.1.3.3.cmml" xref="A2.E28.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E28.m1.4.4.cmml" xref="A2.E28.m1.4.4"><divide id="A2.E28.m1.4.4.3.cmml" xref="A2.E28.m1.4.4"></divide><apply id="A2.E28.m1.3.3.1.2.cmml" xref="A2.E28.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E28.m1.3.3.1.2.1.cmml" xref="A2.E28.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E28.m1.3.3.1.1.1.cmml" xref="A2.E28.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.E28.m1.3.3.1.1.1.1.cmml" xref="A2.E28.m1.3.3.1.1.1">subscript</csymbol><ci id="A2.E28.m1.3.3.1.1.1.2.cmml" xref="A2.E28.m1.3.3.1.1.1.2">𝒗</ci><ci id="A2.E28.m1.3.3.1.1.1.3.cmml" xref="A2.E28.m1.3.3.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E28.m1.4.4.2.2.cmml" xref="A2.E28.m1.4.4.2.3"><csymbol cd="latexml" id="A2.E28.m1.4.4.2.2.1.cmml" xref="A2.E28.m1.4.4.2.3.1">norm</csymbol><ci id="A2.E28.m1.4.4.2.1.cmml" xref="A2.E28.m1.4.4.2.1">𝒙</ci></apply></apply><apply id="A2.E28.m1.9.9.1.1.1.1.2.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="A2.E28.m1.9.9.1.1.1.1.2.1.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E28.m1.9.9.1.1.1.1.1.1.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1.1"><minus id="A2.E28.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1.1.1"></minus><apply id="A2.E28.m1.5.5.cmml" xref="A2.E28.m1.5.5"><divide id="A2.E28.m1.5.5.2.cmml" xref="A2.E28.m1.5.5"></divide><apply id="A2.E28.m1.5.5.3.cmml" xref="A2.E28.m1.5.5.3"><csymbol cd="ambiguous" id="A2.E28.m1.5.5.3.1.cmml" xref="A2.E28.m1.5.5.3">subscript</csymbol><ci id="A2.E28.m1.5.5.3.2.cmml" xref="A2.E28.m1.5.5.3.2">𝒗</ci><ci id="A2.E28.m1.5.5.3.3.cmml" xref="A2.E28.m1.5.5.3.3">𝑗</ci></apply><apply id="A2.E28.m1.5.5.1.2.cmml" xref="A2.E28.m1.5.5.1.1"><csymbol cd="latexml" id="A2.E28.m1.5.5.1.2.1.cmml" xref="A2.E28.m1.5.5.1.1.2">norm</csymbol><apply id="A2.E28.m1.5.5.1.1.1.cmml" xref="A2.E28.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="A2.E28.m1.5.5.1.1.1.1.cmml" xref="A2.E28.m1.5.5.1.1.1">subscript</csymbol><ci id="A2.E28.m1.5.5.1.1.1.2.cmml" xref="A2.E28.m1.5.5.1.1.1.2">𝒗</ci><ci id="A2.E28.m1.5.5.1.1.1.3.cmml" xref="A2.E28.m1.5.5.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="A2.E28.m1.9.9.1.1.1.1.1.1.2.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1.1.2"><times id="A2.E28.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="A2.E28.m1.9.9.1.1.1.1.1.1.2.1"></times><apply id="A2.E28.m1.7.7.cmml" xref="A2.E28.m1.7.7"><divide id="A2.E28.m1.7.7.3.cmml" xref="A2.E28.m1.7.7"></divide><apply id="A2.E28.m1.7.7.4.cmml" xref="A2.E28.m1.7.7.4"><ci id="A2.E28.m1.7.7.4.1.cmml" xref="A2.E28.m1.7.7.4.1">⋅</ci><ci id="A2.E28.m1.7.7.4.2.cmml" xref="A2.E28.m1.7.7.4.2">𝒙</ci><apply id="A2.E28.m1.7.7.4.3.cmml" xref="A2.E28.m1.7.7.4.3"><csymbol cd="ambiguous" id="A2.E28.m1.7.7.4.3.1.cmml" xref="A2.E28.m1.7.7.4.3">subscript</csymbol><ci id="A2.E28.m1.7.7.4.3.2.cmml" xref="A2.E28.m1.7.7.4.3.2">𝒗</ci><ci id="A2.E28.m1.7.7.4.3.3.cmml" xref="A2.E28.m1.7.7.4.3.3">𝑗</ci></apply></apply><apply id="A2.E28.m1.7.7.2.cmml" xref="A2.E28.m1.7.7.2"><times id="A2.E28.m1.7.7.2.3.cmml" xref="A2.E28.m1.7.7.2.3"></times><apply id="A2.E28.m1.7.7.2.4.1.cmml" xref="A2.E28.m1.7.7.2.4.2"><csymbol cd="latexml" id="A2.E28.m1.7.7.2.4.1.1.cmml" xref="A2.E28.m1.7.7.2.4.2.1">norm</csymbol><ci id="A2.E28.m1.6.6.1.1.cmml" xref="A2.E28.m1.6.6.1.1">𝒙</ci></apply><apply id="A2.E28.m1.7.7.2.2.2.cmml" xref="A2.E28.m1.7.7.2.2.1"><csymbol cd="latexml" id="A2.E28.m1.7.7.2.2.2.1.cmml" xref="A2.E28.m1.7.7.2.2.1.2">norm</csymbol><apply id="A2.E28.m1.7.7.2.2.1.1.cmml" xref="A2.E28.m1.7.7.2.2.1.1"><csymbol cd="ambiguous" id="A2.E28.m1.7.7.2.2.1.1.1.cmml" xref="A2.E28.m1.7.7.2.2.1.1">subscript</csymbol><ci id="A2.E28.m1.7.7.2.2.1.1.2.cmml" xref="A2.E28.m1.7.7.2.2.1.1.2">𝒗</ci><ci id="A2.E28.m1.7.7.2.2.1.1.3.cmml" xref="A2.E28.m1.7.7.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E28.m1.8.8.cmml" xref="A2.E28.m1.8.8"><divide id="A2.E28.m1.8.8.2.cmml" xref="A2.E28.m1.8.8"></divide><ci id="A2.E28.m1.8.8.3.cmml" xref="A2.E28.m1.8.8.3">𝒙</ci><apply id="A2.E28.m1.8.8.1.2.cmml" xref="A2.E28.m1.8.8.1.3"><csymbol cd="latexml" id="A2.E28.m1.8.8.1.2.1.cmml" xref="A2.E28.m1.8.8.1.3.1">norm</csymbol><ci id="A2.E28.m1.8.8.1.1.cmml" xref="A2.E28.m1.8.8.1.1">𝒙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E28.m1.9c">\displaystyle=\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}-\mu_%
{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[\frac{%
\boldsymbol{v}_{j}}{\|\boldsymbol{v}_{j}\|}-\frac{\boldsymbol{x}\cdot%
\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|\|\boldsymbol{v}_{j}\|}\frac{\boldsymbol%
{x}}{\|\boldsymbol{x}\|}\right]~{},</annotation><annotation encoding="application/x-llamapun" id="A2.E28.m1.9d">= divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG [ divide start_ARG bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG - divide start_ARG bold_italic_x ⋅ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_x ∥ ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p13.1">where two terms cancel out.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p14">
<p class="ltx_p" id="A2.SS1.p14.1">Finally, we can solve for the term of <math alttext="R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="A2.SS1.p14.1.m1.2"><semantics id="A2.SS1.p14.1.m1.2a"><mrow id="A2.SS1.p14.1.m1.2.3" xref="A2.SS1.p14.1.m1.2.3.cmml"><msub id="A2.SS1.p14.1.m1.2.3.2" xref="A2.SS1.p14.1.m1.2.3.2.cmml"><mi id="A2.SS1.p14.1.m1.2.3.2.2" xref="A2.SS1.p14.1.m1.2.3.2.2.cmml">R</mi><mi id="A2.SS1.p14.1.m1.2.3.2.3" xref="A2.SS1.p14.1.m1.2.3.2.3.cmml">j</mi></msub><mo id="A2.SS1.p14.1.m1.2.3.1" xref="A2.SS1.p14.1.m1.2.3.1.cmml">⁢</mo><mrow id="A2.SS1.p14.1.m1.2.3.3.2" xref="A2.SS1.p14.1.m1.2.3.3.1.cmml"><mo id="A2.SS1.p14.1.m1.2.3.3.2.1" stretchy="false" xref="A2.SS1.p14.1.m1.2.3.3.1.cmml">(</mo><mi id="A2.SS1.p14.1.m1.1.1" xref="A2.SS1.p14.1.m1.1.1.cmml">𝒙</mi><mo id="A2.SS1.p14.1.m1.2.3.3.2.2" xref="A2.SS1.p14.1.m1.2.3.3.1.cmml">,</mo><mi id="A2.SS1.p14.1.m1.2.2" xref="A2.SS1.p14.1.m1.2.2.cmml">𝐭</mi><mo id="A2.SS1.p14.1.m1.2.3.3.2.3" stretchy="false" xref="A2.SS1.p14.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p14.1.m1.2b"><apply id="A2.SS1.p14.1.m1.2.3.cmml" xref="A2.SS1.p14.1.m1.2.3"><times id="A2.SS1.p14.1.m1.2.3.1.cmml" xref="A2.SS1.p14.1.m1.2.3.1"></times><apply id="A2.SS1.p14.1.m1.2.3.2.cmml" xref="A2.SS1.p14.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.SS1.p14.1.m1.2.3.2.1.cmml" xref="A2.SS1.p14.1.m1.2.3.2">subscript</csymbol><ci id="A2.SS1.p14.1.m1.2.3.2.2.cmml" xref="A2.SS1.p14.1.m1.2.3.2.2">𝑅</ci><ci id="A2.SS1.p14.1.m1.2.3.2.3.cmml" xref="A2.SS1.p14.1.m1.2.3.2.3">𝑗</ci></apply><interval closure="open" id="A2.SS1.p14.1.m1.2.3.3.1.cmml" xref="A2.SS1.p14.1.m1.2.3.3.2"><ci id="A2.SS1.p14.1.m1.1.1.cmml" xref="A2.SS1.p14.1.m1.1.1">𝒙</ci><ci id="A2.SS1.p14.1.m1.2.2.cmml" xref="A2.SS1.p14.1.m1.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p14.1.m1.2c">R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p14.1.m1.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx6">
<tbody id="A2.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})" class="ltx_Math" display="inline" id="A2.E29.m1.2"><semantics id="A2.E29.m1.2a"><mrow id="A2.E29.m1.2.3" xref="A2.E29.m1.2.3.cmml"><msub id="A2.E29.m1.2.3.2" xref="A2.E29.m1.2.3.2.cmml"><mi id="A2.E29.m1.2.3.2.2" xref="A2.E29.m1.2.3.2.2.cmml">R</mi><mi id="A2.E29.m1.2.3.2.3" xref="A2.E29.m1.2.3.2.3.cmml">j</mi></msub><mo id="A2.E29.m1.2.3.1" xref="A2.E29.m1.2.3.1.cmml">⁢</mo><mrow id="A2.E29.m1.2.3.3.2" xref="A2.E29.m1.2.3.3.1.cmml"><mo id="A2.E29.m1.2.3.3.2.1" stretchy="false" xref="A2.E29.m1.2.3.3.1.cmml">(</mo><mi id="A2.E29.m1.1.1" xref="A2.E29.m1.1.1.cmml">𝒙</mi><mo id="A2.E29.m1.2.3.3.2.2" xref="A2.E29.m1.2.3.3.1.cmml">,</mo><mi id="A2.E29.m1.2.2" xref="A2.E29.m1.2.2.cmml">𝐭</mi><mo id="A2.E29.m1.2.3.3.2.3" stretchy="false" xref="A2.E29.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E29.m1.2b"><apply id="A2.E29.m1.2.3.cmml" xref="A2.E29.m1.2.3"><times id="A2.E29.m1.2.3.1.cmml" xref="A2.E29.m1.2.3.1"></times><apply id="A2.E29.m1.2.3.2.cmml" xref="A2.E29.m1.2.3.2"><csymbol cd="ambiguous" id="A2.E29.m1.2.3.2.1.cmml" xref="A2.E29.m1.2.3.2">subscript</csymbol><ci id="A2.E29.m1.2.3.2.2.cmml" xref="A2.E29.m1.2.3.2.2">𝑅</ci><ci id="A2.E29.m1.2.3.2.3.cmml" xref="A2.E29.m1.2.3.2.3">𝑗</ci></apply><interval closure="open" id="A2.E29.m1.2.3.3.1.cmml" xref="A2.E29.m1.2.3.3.2"><ci id="A2.E29.m1.1.1.cmml" xref="A2.E29.m1.1.1">𝒙</ci><ci id="A2.E29.m1.2.2.cmml" xref="A2.E29.m1.2.2">𝐭</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E29.m1.2c">\displaystyle R_{j}(\boldsymbol{x},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.E29.m1.2d">italic_R start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_italic_x , bold_t )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}%
}=a_{j}\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}%
}\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|}" class="ltx_Math" display="inline" id="A2.E29.m2.4"><semantics id="A2.E29.m2.4a"><mrow id="A2.E29.m2.4.5" xref="A2.E29.m2.4.5.cmml"><mi id="A2.E29.m2.4.5.2" xref="A2.E29.m2.4.5.2.cmml"></mi><mo id="A2.E29.m2.4.5.3" xref="A2.E29.m2.4.5.3.cmml">=</mo><mrow id="A2.E29.m2.4.5.4" xref="A2.E29.m2.4.5.4.cmml"><msub id="A2.E29.m2.4.5.4.2" xref="A2.E29.m2.4.5.4.2.cmml"><mi id="A2.E29.m2.4.5.4.2.2" xref="A2.E29.m2.4.5.4.2.2.cmml">a</mi><mi id="A2.E29.m2.4.5.4.2.3" xref="A2.E29.m2.4.5.4.2.3.cmml">j</mi></msub><mo id="A2.E29.m2.4.5.4.1" xref="A2.E29.m2.4.5.4.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E29.m2.2.2" xref="A2.E29.m2.2.2.cmml"><mfrac id="A2.E29.m2.2.2a" xref="A2.E29.m2.2.2.cmml"><mrow id="A2.E29.m2.2.2.2" xref="A2.E29.m2.2.2.2.cmml"><mo id="A2.E29.m2.2.2.2.3" rspace="0em" xref="A2.E29.m2.2.2.2.3.cmml">∂</mo><mrow id="A2.E29.m2.2.2.2.4" xref="A2.E29.m2.2.2.2.4.cmml"><mi id="A2.E29.m2.2.2.2.4.2" xref="A2.E29.m2.2.2.2.4.2.cmml">y</mi><mo id="A2.E29.m2.2.2.2.4.1" xref="A2.E29.m2.2.2.2.4.1.cmml">⁢</mo><mrow id="A2.E29.m2.2.2.2.4.3.2" xref="A2.E29.m2.2.2.2.4.3.1.cmml"><mo id="A2.E29.m2.2.2.2.4.3.2.1" stretchy="false" xref="A2.E29.m2.2.2.2.4.3.1.cmml">(</mo><mi id="A2.E29.m2.1.1.1.1" xref="A2.E29.m2.1.1.1.1.cmml">𝒙</mi><mo id="A2.E29.m2.2.2.2.4.3.2.2" xref="A2.E29.m2.2.2.2.4.3.1.cmml">,</mo><mi id="A2.E29.m2.2.2.2.2" xref="A2.E29.m2.2.2.2.2.cmml">𝐭</mi><mo id="A2.E29.m2.2.2.2.4.3.2.3" stretchy="false" xref="A2.E29.m2.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.E29.m2.2.2.4" xref="A2.E29.m2.2.2.4.cmml"><mo id="A2.E29.m2.2.2.4.1" rspace="0em" xref="A2.E29.m2.2.2.4.1.cmml">∂</mo><msub id="A2.E29.m2.2.2.4.2" xref="A2.E29.m2.2.2.4.2.cmml"><mi id="A2.E29.m2.2.2.4.2.2" xref="A2.E29.m2.2.2.4.2.2.cmml">a</mi><mi id="A2.E29.m2.2.2.4.2.3" xref="A2.E29.m2.2.2.4.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle></mrow><mo id="A2.E29.m2.4.5.5" xref="A2.E29.m2.4.5.5.cmml">=</mo><mrow id="A2.E29.m2.4.5.6" xref="A2.E29.m2.4.5.6.cmml"><mrow id="A2.E29.m2.4.5.6.2" xref="A2.E29.m2.4.5.6.2.cmml"><msub id="A2.E29.m2.4.5.6.2.2" xref="A2.E29.m2.4.5.6.2.2.cmml"><mi id="A2.E29.m2.4.5.6.2.2.2" xref="A2.E29.m2.4.5.6.2.2.2.cmml">a</mi><mi id="A2.E29.m2.4.5.6.2.2.3" xref="A2.E29.m2.4.5.6.2.2.3.cmml">j</mi></msub><mo id="A2.E29.m2.4.5.6.2.1" xref="A2.E29.m2.4.5.6.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E29.m2.4.5.6.2.3" xref="A2.E29.m2.4.5.6.2.3.cmml"><mfrac id="A2.E29.m2.4.5.6.2.3a" xref="A2.E29.m2.4.5.6.2.3.cmml"><mo id="A2.E29.m2.4.5.6.2.3.2" xref="A2.E29.m2.4.5.6.2.3.2.cmml">∂</mo><mrow id="A2.E29.m2.4.5.6.2.3.3" xref="A2.E29.m2.4.5.6.2.3.3.cmml"><mo id="A2.E29.m2.4.5.6.2.3.3.1" rspace="0em" xref="A2.E29.m2.4.5.6.2.3.3.1.cmml">∂</mo><msub id="A2.E29.m2.4.5.6.2.3.3.2" xref="A2.E29.m2.4.5.6.2.3.3.2.cmml"><mi id="A2.E29.m2.4.5.6.2.3.3.2.2" xref="A2.E29.m2.4.5.6.2.3.3.2.2.cmml">a</mi><mi id="A2.E29.m2.4.5.6.2.3.3.2.3" xref="A2.E29.m2.4.5.6.2.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo id="A2.E29.m2.4.5.6.2.1a" xref="A2.E29.m2.4.5.6.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E29.m2.3.3" xref="A2.E29.m2.3.3.cmml"><mfrac id="A2.E29.m2.3.3a" xref="A2.E29.m2.3.3.cmml"><mi id="A2.E29.m2.3.3.3" xref="A2.E29.m2.3.3.3.cmml">𝒙</mi><mrow id="A2.E29.m2.3.3.1.3" xref="A2.E29.m2.3.3.1.2.cmml"><mo id="A2.E29.m2.3.3.1.3.1" stretchy="false" xref="A2.E29.m2.3.3.1.2.1.cmml">‖</mo><mi id="A2.E29.m2.3.3.1.1" xref="A2.E29.m2.3.3.1.1.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" id="A2.E29.m2.3.3.1.3.2" mathvariant="bold" stretchy="false" xref="A2.E29.m2.3.3.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow><mo id="A2.E29.m2.4.5.6.1" lspace="0.222em" rspace="0.222em" xref="A2.E29.m2.4.5.6.1.cmml">⋅</mo><mstyle displaystyle="true" id="A2.E29.m2.4.4" xref="A2.E29.m2.4.4.cmml"><mfrac id="A2.E29.m2.4.4a" xref="A2.E29.m2.4.4.cmml"><mi id="A2.E29.m2.4.4.3" xref="A2.E29.m2.4.4.3.cmml">𝐭</mi><mrow id="A2.E29.m2.4.4.1.3" xref="A2.E29.m2.4.4.1.2.cmml"><mo id="A2.E29.m2.4.4.1.3.1" stretchy="false" xref="A2.E29.m2.4.4.1.2.1.cmml">‖</mo><mi id="A2.E29.m2.4.4.1.1" xref="A2.E29.m2.4.4.1.1.cmml">𝐭</mi><mo id="A2.E29.m2.4.4.1.3.2" stretchy="false" xref="A2.E29.m2.4.4.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E29.m2.4b"><apply id="A2.E29.m2.4.5.cmml" xref="A2.E29.m2.4.5"><and id="A2.E29.m2.4.5a.cmml" xref="A2.E29.m2.4.5"></and><apply id="A2.E29.m2.4.5b.cmml" xref="A2.E29.m2.4.5"><eq id="A2.E29.m2.4.5.3.cmml" xref="A2.E29.m2.4.5.3"></eq><csymbol cd="latexml" id="A2.E29.m2.4.5.2.cmml" xref="A2.E29.m2.4.5.2">absent</csymbol><apply id="A2.E29.m2.4.5.4.cmml" xref="A2.E29.m2.4.5.4"><times id="A2.E29.m2.4.5.4.1.cmml" xref="A2.E29.m2.4.5.4.1"></times><apply id="A2.E29.m2.4.5.4.2.cmml" xref="A2.E29.m2.4.5.4.2"><csymbol cd="ambiguous" id="A2.E29.m2.4.5.4.2.1.cmml" xref="A2.E29.m2.4.5.4.2">subscript</csymbol><ci id="A2.E29.m2.4.5.4.2.2.cmml" xref="A2.E29.m2.4.5.4.2.2">𝑎</ci><ci id="A2.E29.m2.4.5.4.2.3.cmml" xref="A2.E29.m2.4.5.4.2.3">𝑗</ci></apply><apply id="A2.E29.m2.2.2.cmml" xref="A2.E29.m2.2.2"><divide id="A2.E29.m2.2.2.3.cmml" xref="A2.E29.m2.2.2"></divide><apply id="A2.E29.m2.2.2.2.cmml" xref="A2.E29.m2.2.2.2"><partialdiff id="A2.E29.m2.2.2.2.3.cmml" xref="A2.E29.m2.2.2.2.3"></partialdiff><apply id="A2.E29.m2.2.2.2.4.cmml" xref="A2.E29.m2.2.2.2.4"><times id="A2.E29.m2.2.2.2.4.1.cmml" xref="A2.E29.m2.2.2.2.4.1"></times><ci id="A2.E29.m2.2.2.2.4.2.cmml" xref="A2.E29.m2.2.2.2.4.2">𝑦</ci><interval closure="open" id="A2.E29.m2.2.2.2.4.3.1.cmml" xref="A2.E29.m2.2.2.2.4.3.2"><ci id="A2.E29.m2.1.1.1.1.cmml" xref="A2.E29.m2.1.1.1.1">𝒙</ci><ci id="A2.E29.m2.2.2.2.2.cmml" xref="A2.E29.m2.2.2.2.2">𝐭</ci></interval></apply></apply><apply id="A2.E29.m2.2.2.4.cmml" xref="A2.E29.m2.2.2.4"><partialdiff id="A2.E29.m2.2.2.4.1.cmml" xref="A2.E29.m2.2.2.4.1"></partialdiff><apply id="A2.E29.m2.2.2.4.2.cmml" xref="A2.E29.m2.2.2.4.2"><csymbol cd="ambiguous" id="A2.E29.m2.2.2.4.2.1.cmml" xref="A2.E29.m2.2.2.4.2">subscript</csymbol><ci id="A2.E29.m2.2.2.4.2.2.cmml" xref="A2.E29.m2.2.2.4.2.2">𝑎</ci><ci id="A2.E29.m2.2.2.4.2.3.cmml" xref="A2.E29.m2.2.2.4.2.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A2.E29.m2.4.5c.cmml" xref="A2.E29.m2.4.5"><eq id="A2.E29.m2.4.5.5.cmml" xref="A2.E29.m2.4.5.5"></eq><share href="https://arxiv.org/html/2505.20229v1#A2.E29.m2.4.5.4.cmml" id="A2.E29.m2.4.5d.cmml" xref="A2.E29.m2.4.5"></share><apply id="A2.E29.m2.4.5.6.cmml" xref="A2.E29.m2.4.5.6"><ci id="A2.E29.m2.4.5.6.1.cmml" xref="A2.E29.m2.4.5.6.1">⋅</ci><apply id="A2.E29.m2.4.5.6.2.cmml" xref="A2.E29.m2.4.5.6.2"><times id="A2.E29.m2.4.5.6.2.1.cmml" xref="A2.E29.m2.4.5.6.2.1"></times><apply id="A2.E29.m2.4.5.6.2.2.cmml" xref="A2.E29.m2.4.5.6.2.2"><csymbol cd="ambiguous" id="A2.E29.m2.4.5.6.2.2.1.cmml" xref="A2.E29.m2.4.5.6.2.2">subscript</csymbol><ci id="A2.E29.m2.4.5.6.2.2.2.cmml" xref="A2.E29.m2.4.5.6.2.2.2">𝑎</ci><ci id="A2.E29.m2.4.5.6.2.2.3.cmml" xref="A2.E29.m2.4.5.6.2.2.3">𝑗</ci></apply><apply id="A2.E29.m2.4.5.6.2.3.cmml" xref="A2.E29.m2.4.5.6.2.3"><divide id="A2.E29.m2.4.5.6.2.3.1.cmml" xref="A2.E29.m2.4.5.6.2.3"></divide><partialdiff id="A2.E29.m2.4.5.6.2.3.2.cmml" xref="A2.E29.m2.4.5.6.2.3.2"></partialdiff><apply id="A2.E29.m2.4.5.6.2.3.3.cmml" xref="A2.E29.m2.4.5.6.2.3.3"><partialdiff id="A2.E29.m2.4.5.6.2.3.3.1.cmml" xref="A2.E29.m2.4.5.6.2.3.3.1"></partialdiff><apply id="A2.E29.m2.4.5.6.2.3.3.2.cmml" xref="A2.E29.m2.4.5.6.2.3.3.2"><csymbol cd="ambiguous" id="A2.E29.m2.4.5.6.2.3.3.2.1.cmml" xref="A2.E29.m2.4.5.6.2.3.3.2">subscript</csymbol><ci id="A2.E29.m2.4.5.6.2.3.3.2.2.cmml" xref="A2.E29.m2.4.5.6.2.3.3.2.2">𝑎</ci><ci id="A2.E29.m2.4.5.6.2.3.3.2.3.cmml" xref="A2.E29.m2.4.5.6.2.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="A2.E29.m2.3.3.cmml" xref="A2.E29.m2.3.3"><divide id="A2.E29.m2.3.3.2.cmml" xref="A2.E29.m2.3.3"></divide><ci id="A2.E29.m2.3.3.3.cmml" xref="A2.E29.m2.3.3.3">𝒙</ci><apply id="A2.E29.m2.3.3.1.2.cmml" xref="A2.E29.m2.3.3.1.3"><csymbol cd="latexml" id="A2.E29.m2.3.3.1.2.1.cmml" xref="A2.E29.m2.3.3.1.3.1">norm</csymbol><ci id="A2.E29.m2.3.3.1.1.cmml" xref="A2.E29.m2.3.3.1.1">𝒙</ci></apply></apply></apply><apply id="A2.E29.m2.4.4.cmml" xref="A2.E29.m2.4.4"><divide id="A2.E29.m2.4.4.2.cmml" xref="A2.E29.m2.4.4"></divide><ci id="A2.E29.m2.4.4.3.cmml" xref="A2.E29.m2.4.4.3">𝐭</ci><apply id="A2.E29.m2.4.4.1.2.cmml" xref="A2.E29.m2.4.4.1.3"><csymbol cd="latexml" id="A2.E29.m2.4.4.1.2.1.cmml" xref="A2.E29.m2.4.4.1.3.1">norm</csymbol><ci id="A2.E29.m2.4.4.1.1.cmml" xref="A2.E29.m2.4.4.1.1">𝐭</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E29.m2.4c">\displaystyle=a_{j}\frac{\partial y(\boldsymbol{x},\mathbf{t})}{\partial a_{j}%
}=a_{j}\frac{\partial}{\partial a_{j}}\frac{\boldsymbol{x}}{\|\boldsymbol{x\|}%
}\cdot\frac{\mathbf{t}}{\|\mathbf{t}\|}</annotation><annotation encoding="application/x-llamapun" id="A2.E29.m2.4d">= italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∂ italic_y ( bold_italic_x , bold_t ) end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG = italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∂ end_ARG start_ARG ∂ italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG divide start_ARG bold_italic_x end_ARG start_ARG ∥ bold_italic_x bold_∥ end_ARG ⋅ divide start_ARG bold_t end_ARG start_ARG ∥ bold_t ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
<tbody id="A2.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{a_{j}\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}%
-\mu_{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[%
\frac{\boldsymbol{v}_{j}\cdot\mathbf{t}}{\|\boldsymbol{v}_{j}\|\|\mathbf{t}\|}%
-\frac{\boldsymbol{x}\cdot\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|\|\boldsymbol{%
v}_{j}\|}\frac{\boldsymbol{x}\cdot\mathbf{t}}{\|\boldsymbol{x}\|\|\mathbf{t}\|%
}\right]" class="ltx_Math" display="inline" id="A2.E30.m1.11"><semantics id="A2.E30.m1.11a"><mrow id="A2.E30.m1.11.11" xref="A2.E30.m1.11.11.cmml"><mi id="A2.E30.m1.11.11.3" xref="A2.E30.m1.11.11.3.cmml"></mi><mo id="A2.E30.m1.11.11.2" xref="A2.E30.m1.11.11.2.cmml">=</mo><mrow id="A2.E30.m1.11.11.1" xref="A2.E30.m1.11.11.1.cmml"><mstyle displaystyle="true" id="A2.E30.m1.2.2" xref="A2.E30.m1.2.2.cmml"><mfrac id="A2.E30.m1.2.2a" xref="A2.E30.m1.2.2.cmml"><mrow id="A2.E30.m1.1.1.1" xref="A2.E30.m1.1.1.1.cmml"><msub id="A2.E30.m1.1.1.1.3" xref="A2.E30.m1.1.1.1.3.cmml"><mi id="A2.E30.m1.1.1.1.3.2" xref="A2.E30.m1.1.1.1.3.2.cmml">a</mi><mi id="A2.E30.m1.1.1.1.3.3" xref="A2.E30.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="A2.E30.m1.1.1.1.2" xref="A2.E30.m1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E30.m1.1.1.1.1.1" xref="A2.E30.m1.1.1.1.1.2.cmml"><mo id="A2.E30.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E30.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E30.m1.1.1.1.1.1.1" xref="A2.E30.m1.1.1.1.1.1.1.cmml"><msub id="A2.E30.m1.1.1.1.1.1.1.2" xref="A2.E30.m1.1.1.1.1.1.1.2.cmml"><mi id="A2.E30.m1.1.1.1.1.1.1.2.2" xref="A2.E30.m1.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E30.m1.1.1.1.1.1.1.2.3" xref="A2.E30.m1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E30.m1.1.1.1.1.1.1.1" xref="A2.E30.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E30.m1.1.1.1.1.1.1.3" xref="A2.E30.m1.1.1.1.1.1.1.3.cmml"><mi id="A2.E30.m1.1.1.1.1.1.1.3.2" xref="A2.E30.m1.1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E30.m1.1.1.1.1.1.1.3.3" xref="A2.E30.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A2.E30.m1.1.1.1.1.1.1.3.3.2" xref="A2.E30.m1.1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E30.m1.1.1.1.1.1.1.3.3.3" xref="A2.E30.m1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E30.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E30.m1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mrow id="A2.E30.m1.2.2.2.1" xref="A2.E30.m1.2.2.2.2.cmml"><mo id="A2.E30.m1.2.2.2.1.2" stretchy="false" xref="A2.E30.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E30.m1.2.2.2.1.1" xref="A2.E30.m1.2.2.2.1.1.cmml"><mi id="A2.E30.m1.2.2.2.1.1.2" xref="A2.E30.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E30.m1.2.2.2.1.1.1" xref="A2.E30.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E30.m1.2.2.2.1.1.3" xref="A2.E30.m1.2.2.2.1.1.3.cmml"><mi id="A2.E30.m1.2.2.2.1.1.3.2" xref="A2.E30.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E30.m1.2.2.2.1.1.3.3" xref="A2.E30.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E30.m1.2.2.2.1.3" stretchy="false" xref="A2.E30.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E30.m1.11.11.1.2" xref="A2.E30.m1.11.11.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E30.m1.4.4" xref="A2.E30.m1.4.4.cmml"><mfrac id="A2.E30.m1.4.4a" xref="A2.E30.m1.4.4.cmml"><mrow id="A2.E30.m1.3.3.1.1" xref="A2.E30.m1.3.3.1.2.cmml"><mo id="A2.E30.m1.3.3.1.1.2" stretchy="false" xref="A2.E30.m1.3.3.1.2.1.cmml">‖</mo><msub id="A2.E30.m1.3.3.1.1.1" xref="A2.E30.m1.3.3.1.1.1.cmml"><mi id="A2.E30.m1.3.3.1.1.1.2" xref="A2.E30.m1.3.3.1.1.1.2.cmml">𝒗</mi><mi id="A2.E30.m1.3.3.1.1.1.3" xref="A2.E30.m1.3.3.1.1.1.3.cmml">j</mi></msub><mo id="A2.E30.m1.3.3.1.1.3" stretchy="false" xref="A2.E30.m1.3.3.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E30.m1.4.4.2.3" xref="A2.E30.m1.4.4.2.2.cmml"><mo id="A2.E30.m1.4.4.2.3.1" stretchy="false" xref="A2.E30.m1.4.4.2.2.1.cmml">‖</mo><mi id="A2.E30.m1.4.4.2.1" xref="A2.E30.m1.4.4.2.1.cmml">𝒙</mi><mo id="A2.E30.m1.4.4.2.3.2" stretchy="false" xref="A2.E30.m1.4.4.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E30.m1.11.11.1.2a" xref="A2.E30.m1.11.11.1.2.cmml">⁢</mo><mrow id="A2.E30.m1.11.11.1.1.1" xref="A2.E30.m1.11.11.1.1.2.cmml"><mo id="A2.E30.m1.11.11.1.1.1.2" xref="A2.E30.m1.11.11.1.1.2.1.cmml">[</mo><mrow id="A2.E30.m1.11.11.1.1.1.1" xref="A2.E30.m1.11.11.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E30.m1.6.6" xref="A2.E30.m1.6.6.cmml"><mfrac id="A2.E30.m1.6.6a" xref="A2.E30.m1.6.6.cmml"><mrow id="A2.E30.m1.6.6.4" xref="A2.E30.m1.6.6.4.cmml"><msub id="A2.E30.m1.6.6.4.2" xref="A2.E30.m1.6.6.4.2.cmml"><mi id="A2.E30.m1.6.6.4.2.2" xref="A2.E30.m1.6.6.4.2.2.cmml">𝒗</mi><mi id="A2.E30.m1.6.6.4.2.3" xref="A2.E30.m1.6.6.4.2.3.cmml">j</mi></msub><mo id="A2.E30.m1.6.6.4.1" lspace="0.222em" rspace="0.222em" xref="A2.E30.m1.6.6.4.1.cmml">⋅</mo><mi id="A2.E30.m1.6.6.4.3" xref="A2.E30.m1.6.6.4.3.cmml">𝐭</mi></mrow><mrow id="A2.E30.m1.6.6.2" xref="A2.E30.m1.6.6.2.cmml"><mrow id="A2.E30.m1.6.6.2.2.1" xref="A2.E30.m1.6.6.2.2.2.cmml"><mo id="A2.E30.m1.6.6.2.2.1.2" stretchy="false" xref="A2.E30.m1.6.6.2.2.2.1.cmml">‖</mo><msub id="A2.E30.m1.6.6.2.2.1.1" xref="A2.E30.m1.6.6.2.2.1.1.cmml"><mi id="A2.E30.m1.6.6.2.2.1.1.2" xref="A2.E30.m1.6.6.2.2.1.1.2.cmml">𝒗</mi><mi id="A2.E30.m1.6.6.2.2.1.1.3" xref="A2.E30.m1.6.6.2.2.1.1.3.cmml">j</mi></msub><mo id="A2.E30.m1.6.6.2.2.1.3" stretchy="false" xref="A2.E30.m1.6.6.2.2.2.1.cmml">‖</mo></mrow><mo id="A2.E30.m1.6.6.2.3" xref="A2.E30.m1.6.6.2.3.cmml">⁢</mo><mrow id="A2.E30.m1.6.6.2.4.2" xref="A2.E30.m1.6.6.2.4.1.cmml"><mo id="A2.E30.m1.6.6.2.4.2.1" stretchy="false" xref="A2.E30.m1.6.6.2.4.1.1.cmml">‖</mo><mi id="A2.E30.m1.5.5.1.1" xref="A2.E30.m1.5.5.1.1.cmml">𝐭</mi><mo id="A2.E30.m1.6.6.2.4.2.2" stretchy="false" xref="A2.E30.m1.6.6.2.4.1.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle><mo id="A2.E30.m1.11.11.1.1.1.1.1" xref="A2.E30.m1.11.11.1.1.1.1.1.cmml">−</mo><mrow id="A2.E30.m1.11.11.1.1.1.1.2" xref="A2.E30.m1.11.11.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A2.E30.m1.8.8" xref="A2.E30.m1.8.8.cmml"><mfrac id="A2.E30.m1.8.8a" xref="A2.E30.m1.8.8.cmml"><mrow id="A2.E30.m1.8.8.4" xref="A2.E30.m1.8.8.4.cmml"><mi id="A2.E30.m1.8.8.4.2" xref="A2.E30.m1.8.8.4.2.cmml">𝒙</mi><mo id="A2.E30.m1.8.8.4.1" lspace="0.222em" rspace="0.222em" xref="A2.E30.m1.8.8.4.1.cmml">⋅</mo><msub id="A2.E30.m1.8.8.4.3" xref="A2.E30.m1.8.8.4.3.cmml"><mi id="A2.E30.m1.8.8.4.3.2" xref="A2.E30.m1.8.8.4.3.2.cmml">𝒗</mi><mi id="A2.E30.m1.8.8.4.3.3" xref="A2.E30.m1.8.8.4.3.3.cmml">j</mi></msub></mrow><mrow id="A2.E30.m1.8.8.2" xref="A2.E30.m1.8.8.2.cmml"><mrow id="A2.E30.m1.8.8.2.4.2" xref="A2.E30.m1.8.8.2.4.1.cmml"><mo id="A2.E30.m1.8.8.2.4.2.1" stretchy="false" xref="A2.E30.m1.8.8.2.4.1.1.cmml">‖</mo><mi id="A2.E30.m1.7.7.1.1" xref="A2.E30.m1.7.7.1.1.cmml">𝒙</mi><mo id="A2.E30.m1.8.8.2.4.2.2" stretchy="false" xref="A2.E30.m1.8.8.2.4.1.1.cmml">‖</mo></mrow><mo id="A2.E30.m1.8.8.2.3" xref="A2.E30.m1.8.8.2.3.cmml">⁢</mo><mrow id="A2.E30.m1.8.8.2.2.1" xref="A2.E30.m1.8.8.2.2.2.cmml"><mo id="A2.E30.m1.8.8.2.2.1.2" stretchy="false" xref="A2.E30.m1.8.8.2.2.2.1.cmml">‖</mo><msub id="A2.E30.m1.8.8.2.2.1.1" xref="A2.E30.m1.8.8.2.2.1.1.cmml"><mi id="A2.E30.m1.8.8.2.2.1.1.2" xref="A2.E30.m1.8.8.2.2.1.1.2.cmml">𝒗</mi><mi id="A2.E30.m1.8.8.2.2.1.1.3" xref="A2.E30.m1.8.8.2.2.1.1.3.cmml">j</mi></msub><mo id="A2.E30.m1.8.8.2.2.1.3" stretchy="false" xref="A2.E30.m1.8.8.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle><mo id="A2.E30.m1.11.11.1.1.1.1.2.1" xref="A2.E30.m1.11.11.1.1.1.1.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E30.m1.10.10" xref="A2.E30.m1.10.10.cmml"><mfrac id="A2.E30.m1.10.10a" xref="A2.E30.m1.10.10.cmml"><mrow id="A2.E30.m1.10.10.4" xref="A2.E30.m1.10.10.4.cmml"><mi id="A2.E30.m1.10.10.4.2" xref="A2.E30.m1.10.10.4.2.cmml">𝒙</mi><mo id="A2.E30.m1.10.10.4.1" lspace="0.222em" rspace="0.222em" xref="A2.E30.m1.10.10.4.1.cmml">⋅</mo><mi id="A2.E30.m1.10.10.4.3" xref="A2.E30.m1.10.10.4.3.cmml">𝐭</mi></mrow><mrow id="A2.E30.m1.10.10.2" xref="A2.E30.m1.10.10.2.cmml"><mrow id="A2.E30.m1.10.10.2.4.2" xref="A2.E30.m1.10.10.2.4.1.cmml"><mo id="A2.E30.m1.10.10.2.4.2.1" stretchy="false" xref="A2.E30.m1.10.10.2.4.1.1.cmml">‖</mo><mi id="A2.E30.m1.9.9.1.1" xref="A2.E30.m1.9.9.1.1.cmml">𝒙</mi><mo id="A2.E30.m1.10.10.2.4.2.2" stretchy="false" xref="A2.E30.m1.10.10.2.4.1.1.cmml">‖</mo></mrow><mo id="A2.E30.m1.10.10.2.3" xref="A2.E30.m1.10.10.2.3.cmml">⁢</mo><mrow id="A2.E30.m1.10.10.2.5.2" xref="A2.E30.m1.10.10.2.5.1.cmml"><mo id="A2.E30.m1.10.10.2.5.2.1" stretchy="false" xref="A2.E30.m1.10.10.2.5.1.1.cmml">‖</mo><mi id="A2.E30.m1.10.10.2.2" xref="A2.E30.m1.10.10.2.2.cmml">𝐭</mi><mo id="A2.E30.m1.10.10.2.5.2.2" stretchy="false" xref="A2.E30.m1.10.10.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="A2.E30.m1.11.11.1.1.1.3" xref="A2.E30.m1.11.11.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E30.m1.11b"><apply id="A2.E30.m1.11.11.cmml" xref="A2.E30.m1.11.11"><eq id="A2.E30.m1.11.11.2.cmml" xref="A2.E30.m1.11.11.2"></eq><csymbol cd="latexml" id="A2.E30.m1.11.11.3.cmml" xref="A2.E30.m1.11.11.3">absent</csymbol><apply id="A2.E30.m1.11.11.1.cmml" xref="A2.E30.m1.11.11.1"><times id="A2.E30.m1.11.11.1.2.cmml" xref="A2.E30.m1.11.11.1.2"></times><apply id="A2.E30.m1.2.2.cmml" xref="A2.E30.m1.2.2"><divide id="A2.E30.m1.2.2.3.cmml" xref="A2.E30.m1.2.2"></divide><apply id="A2.E30.m1.1.1.1.cmml" xref="A2.E30.m1.1.1.1"><times id="A2.E30.m1.1.1.1.2.cmml" xref="A2.E30.m1.1.1.1.2"></times><apply id="A2.E30.m1.1.1.1.3.cmml" xref="A2.E30.m1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E30.m1.1.1.1.3.1.cmml" xref="A2.E30.m1.1.1.1.3">subscript</csymbol><ci id="A2.E30.m1.1.1.1.3.2.cmml" xref="A2.E30.m1.1.1.1.3.2">𝑎</ci><ci id="A2.E30.m1.1.1.1.3.3.cmml" xref="A2.E30.m1.1.1.1.3.3">𝑗</ci></apply><apply id="A2.E30.m1.1.1.1.1.2.cmml" xref="A2.E30.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E30.m1.1.1.1.1.2.1.cmml" xref="A2.E30.m1.1.1.1.1.1.2">norm</csymbol><apply id="A2.E30.m1.1.1.1.1.1.1.cmml" xref="A2.E30.m1.1.1.1.1.1.1"><minus id="A2.E30.m1.1.1.1.1.1.1.1.cmml" xref="A2.E30.m1.1.1.1.1.1.1.1"></minus><apply id="A2.E30.m1.1.1.1.1.1.1.2.cmml" xref="A2.E30.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E30.m1.1.1.1.1.1.1.2.1.cmml" xref="A2.E30.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E30.m1.1.1.1.1.1.1.2.2.cmml" xref="A2.E30.m1.1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E30.m1.1.1.1.1.1.1.2.3.cmml" xref="A2.E30.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E30.m1.1.1.1.1.1.1.3.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E30.m1.1.1.1.1.1.1.3.1.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E30.m1.1.1.1.1.1.1.3.2.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E30.m1.1.1.1.1.1.1.3.3.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E30.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E30.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E30.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A2.E30.m1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A2.E30.m1.2.2.2.2.cmml" xref="A2.E30.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E30.m1.2.2.2.2.1.cmml" xref="A2.E30.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E30.m1.2.2.2.1.1.cmml" xref="A2.E30.m1.2.2.2.1.1"><minus id="A2.E30.m1.2.2.2.1.1.1.cmml" xref="A2.E30.m1.2.2.2.1.1.1"></minus><ci id="A2.E30.m1.2.2.2.1.1.2.cmml" xref="A2.E30.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E30.m1.2.2.2.1.1.3.cmml" xref="A2.E30.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E30.m1.2.2.2.1.1.3.1.cmml" xref="A2.E30.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E30.m1.2.2.2.1.1.3.2.cmml" xref="A2.E30.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E30.m1.2.2.2.1.1.3.3.cmml" xref="A2.E30.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E30.m1.4.4.cmml" xref="A2.E30.m1.4.4"><divide id="A2.E30.m1.4.4.3.cmml" xref="A2.E30.m1.4.4"></divide><apply id="A2.E30.m1.3.3.1.2.cmml" xref="A2.E30.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E30.m1.3.3.1.2.1.cmml" xref="A2.E30.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E30.m1.3.3.1.1.1.cmml" xref="A2.E30.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.E30.m1.3.3.1.1.1.1.cmml" xref="A2.E30.m1.3.3.1.1.1">subscript</csymbol><ci id="A2.E30.m1.3.3.1.1.1.2.cmml" xref="A2.E30.m1.3.3.1.1.1.2">𝒗</ci><ci id="A2.E30.m1.3.3.1.1.1.3.cmml" xref="A2.E30.m1.3.3.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E30.m1.4.4.2.2.cmml" xref="A2.E30.m1.4.4.2.3"><csymbol cd="latexml" id="A2.E30.m1.4.4.2.2.1.cmml" xref="A2.E30.m1.4.4.2.3.1">norm</csymbol><ci id="A2.E30.m1.4.4.2.1.cmml" xref="A2.E30.m1.4.4.2.1">𝒙</ci></apply></apply><apply id="A2.E30.m1.11.11.1.1.2.cmml" xref="A2.E30.m1.11.11.1.1.1"><csymbol cd="latexml" id="A2.E30.m1.11.11.1.1.2.1.cmml" xref="A2.E30.m1.11.11.1.1.1.2">delimited-[]</csymbol><apply id="A2.E30.m1.11.11.1.1.1.1.cmml" xref="A2.E30.m1.11.11.1.1.1.1"><minus id="A2.E30.m1.11.11.1.1.1.1.1.cmml" xref="A2.E30.m1.11.11.1.1.1.1.1"></minus><apply id="A2.E30.m1.6.6.cmml" xref="A2.E30.m1.6.6"><divide id="A2.E30.m1.6.6.3.cmml" xref="A2.E30.m1.6.6"></divide><apply id="A2.E30.m1.6.6.4.cmml" xref="A2.E30.m1.6.6.4"><ci id="A2.E30.m1.6.6.4.1.cmml" xref="A2.E30.m1.6.6.4.1">⋅</ci><apply id="A2.E30.m1.6.6.4.2.cmml" xref="A2.E30.m1.6.6.4.2"><csymbol cd="ambiguous" id="A2.E30.m1.6.6.4.2.1.cmml" xref="A2.E30.m1.6.6.4.2">subscript</csymbol><ci id="A2.E30.m1.6.6.4.2.2.cmml" xref="A2.E30.m1.6.6.4.2.2">𝒗</ci><ci id="A2.E30.m1.6.6.4.2.3.cmml" xref="A2.E30.m1.6.6.4.2.3">𝑗</ci></apply><ci id="A2.E30.m1.6.6.4.3.cmml" xref="A2.E30.m1.6.6.4.3">𝐭</ci></apply><apply id="A2.E30.m1.6.6.2.cmml" xref="A2.E30.m1.6.6.2"><times id="A2.E30.m1.6.6.2.3.cmml" xref="A2.E30.m1.6.6.2.3"></times><apply id="A2.E30.m1.6.6.2.2.2.cmml" xref="A2.E30.m1.6.6.2.2.1"><csymbol cd="latexml" id="A2.E30.m1.6.6.2.2.2.1.cmml" xref="A2.E30.m1.6.6.2.2.1.2">norm</csymbol><apply id="A2.E30.m1.6.6.2.2.1.1.cmml" xref="A2.E30.m1.6.6.2.2.1.1"><csymbol cd="ambiguous" id="A2.E30.m1.6.6.2.2.1.1.1.cmml" xref="A2.E30.m1.6.6.2.2.1.1">subscript</csymbol><ci id="A2.E30.m1.6.6.2.2.1.1.2.cmml" xref="A2.E30.m1.6.6.2.2.1.1.2">𝒗</ci><ci id="A2.E30.m1.6.6.2.2.1.1.3.cmml" xref="A2.E30.m1.6.6.2.2.1.1.3">𝑗</ci></apply></apply><apply id="A2.E30.m1.6.6.2.4.1.cmml" xref="A2.E30.m1.6.6.2.4.2"><csymbol cd="latexml" id="A2.E30.m1.6.6.2.4.1.1.cmml" xref="A2.E30.m1.6.6.2.4.2.1">norm</csymbol><ci id="A2.E30.m1.5.5.1.1.cmml" xref="A2.E30.m1.5.5.1.1">𝐭</ci></apply></apply></apply><apply id="A2.E30.m1.11.11.1.1.1.1.2.cmml" xref="A2.E30.m1.11.11.1.1.1.1.2"><times id="A2.E30.m1.11.11.1.1.1.1.2.1.cmml" xref="A2.E30.m1.11.11.1.1.1.1.2.1"></times><apply id="A2.E30.m1.8.8.cmml" xref="A2.E30.m1.8.8"><divide id="A2.E30.m1.8.8.3.cmml" xref="A2.E30.m1.8.8"></divide><apply id="A2.E30.m1.8.8.4.cmml" xref="A2.E30.m1.8.8.4"><ci id="A2.E30.m1.8.8.4.1.cmml" xref="A2.E30.m1.8.8.4.1">⋅</ci><ci id="A2.E30.m1.8.8.4.2.cmml" xref="A2.E30.m1.8.8.4.2">𝒙</ci><apply id="A2.E30.m1.8.8.4.3.cmml" xref="A2.E30.m1.8.8.4.3"><csymbol cd="ambiguous" id="A2.E30.m1.8.8.4.3.1.cmml" xref="A2.E30.m1.8.8.4.3">subscript</csymbol><ci id="A2.E30.m1.8.8.4.3.2.cmml" xref="A2.E30.m1.8.8.4.3.2">𝒗</ci><ci id="A2.E30.m1.8.8.4.3.3.cmml" xref="A2.E30.m1.8.8.4.3.3">𝑗</ci></apply></apply><apply id="A2.E30.m1.8.8.2.cmml" xref="A2.E30.m1.8.8.2"><times id="A2.E30.m1.8.8.2.3.cmml" xref="A2.E30.m1.8.8.2.3"></times><apply id="A2.E30.m1.8.8.2.4.1.cmml" xref="A2.E30.m1.8.8.2.4.2"><csymbol cd="latexml" id="A2.E30.m1.8.8.2.4.1.1.cmml" xref="A2.E30.m1.8.8.2.4.2.1">norm</csymbol><ci id="A2.E30.m1.7.7.1.1.cmml" xref="A2.E30.m1.7.7.1.1">𝒙</ci></apply><apply id="A2.E30.m1.8.8.2.2.2.cmml" xref="A2.E30.m1.8.8.2.2.1"><csymbol cd="latexml" id="A2.E30.m1.8.8.2.2.2.1.cmml" xref="A2.E30.m1.8.8.2.2.1.2">norm</csymbol><apply id="A2.E30.m1.8.8.2.2.1.1.cmml" xref="A2.E30.m1.8.8.2.2.1.1"><csymbol cd="ambiguous" id="A2.E30.m1.8.8.2.2.1.1.1.cmml" xref="A2.E30.m1.8.8.2.2.1.1">subscript</csymbol><ci id="A2.E30.m1.8.8.2.2.1.1.2.cmml" xref="A2.E30.m1.8.8.2.2.1.1.2">𝒗</ci><ci id="A2.E30.m1.8.8.2.2.1.1.3.cmml" xref="A2.E30.m1.8.8.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E30.m1.10.10.cmml" xref="A2.E30.m1.10.10"><divide id="A2.E30.m1.10.10.3.cmml" xref="A2.E30.m1.10.10"></divide><apply id="A2.E30.m1.10.10.4.cmml" xref="A2.E30.m1.10.10.4"><ci id="A2.E30.m1.10.10.4.1.cmml" xref="A2.E30.m1.10.10.4.1">⋅</ci><ci id="A2.E30.m1.10.10.4.2.cmml" xref="A2.E30.m1.10.10.4.2">𝒙</ci><ci id="A2.E30.m1.10.10.4.3.cmml" xref="A2.E30.m1.10.10.4.3">𝐭</ci></apply><apply id="A2.E30.m1.10.10.2.cmml" xref="A2.E30.m1.10.10.2"><times id="A2.E30.m1.10.10.2.3.cmml" xref="A2.E30.m1.10.10.2.3"></times><apply id="A2.E30.m1.10.10.2.4.1.cmml" xref="A2.E30.m1.10.10.2.4.2"><csymbol cd="latexml" id="A2.E30.m1.10.10.2.4.1.1.cmml" xref="A2.E30.m1.10.10.2.4.2.1">norm</csymbol><ci id="A2.E30.m1.9.9.1.1.cmml" xref="A2.E30.m1.9.9.1.1">𝒙</ci></apply><apply id="A2.E30.m1.10.10.2.5.1.cmml" xref="A2.E30.m1.10.10.2.5.2"><csymbol cd="latexml" id="A2.E30.m1.10.10.2.5.1.1.cmml" xref="A2.E30.m1.10.10.2.5.2.1">norm</csymbol><ci id="A2.E30.m1.10.10.2.2.cmml" xref="A2.E30.m1.10.10.2.2">𝐭</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E30.m1.11c">\displaystyle=\frac{a_{j}\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}%
-\mu_{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[%
\frac{\boldsymbol{v}_{j}\cdot\mathbf{t}}{\|\boldsymbol{v}_{j}\|\|\mathbf{t}\|}%
-\frac{\boldsymbol{x}\cdot\boldsymbol{v}_{j}}{\|\boldsymbol{x}\|\|\boldsymbol{%
v}_{j}\|}\frac{\boldsymbol{x}\cdot\mathbf{t}}{\|\boldsymbol{x}\|\|\mathbf{t}\|%
}\right]</annotation><annotation encoding="application/x-llamapun" id="A2.E30.m1.11d">= divide start_ARG italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG [ divide start_ARG bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ bold_t end_ARG start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ ∥ bold_t ∥ end_ARG - divide start_ARG bold_italic_x ⋅ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_x ∥ ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG bold_italic_x ⋅ bold_t end_ARG start_ARG ∥ bold_italic_x ∥ ∥ bold_t ∥ end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
<tbody id="A2.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=a_{j}\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}%
-\mu_{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[%
\texttt{LogitLens}_{j}(\mathbf{t})-\frac{\boldsymbol{x}\cdot\boldsymbol{v}_{j}%
}{\|\boldsymbol{x}\|\|\boldsymbol{v}_{j}\|}y(\boldsymbol{x},\mathbf{t})\right]%
~{}," class="ltx_Math" display="inline" id="A2.E31.m1.10"><semantics id="A2.E31.m1.10a"><mrow id="A2.E31.m1.10.10.1" xref="A2.E31.m1.10.10.1.1.cmml"><mrow id="A2.E31.m1.10.10.1.1" xref="A2.E31.m1.10.10.1.1.cmml"><mi id="A2.E31.m1.10.10.1.1.3" xref="A2.E31.m1.10.10.1.1.3.cmml"></mi><mo id="A2.E31.m1.10.10.1.1.2" xref="A2.E31.m1.10.10.1.1.2.cmml">=</mo><mrow id="A2.E31.m1.10.10.1.1.1" xref="A2.E31.m1.10.10.1.1.1.cmml"><msub id="A2.E31.m1.10.10.1.1.1.3" xref="A2.E31.m1.10.10.1.1.1.3.cmml"><mi id="A2.E31.m1.10.10.1.1.1.3.2" xref="A2.E31.m1.10.10.1.1.1.3.2.cmml">a</mi><mi id="A2.E31.m1.10.10.1.1.1.3.3" xref="A2.E31.m1.10.10.1.1.1.3.3.cmml">j</mi></msub><mo id="A2.E31.m1.10.10.1.1.1.2" xref="A2.E31.m1.10.10.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E31.m1.2.2" xref="A2.E31.m1.2.2.cmml"><mfrac id="A2.E31.m1.2.2a" xref="A2.E31.m1.2.2.cmml"><mrow id="A2.E31.m1.1.1.1.1" xref="A2.E31.m1.1.1.1.2.cmml"><mo id="A2.E31.m1.1.1.1.1.2" stretchy="false" xref="A2.E31.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A2.E31.m1.1.1.1.1.1" xref="A2.E31.m1.1.1.1.1.1.cmml"><msub id="A2.E31.m1.1.1.1.1.1.2" xref="A2.E31.m1.1.1.1.1.1.2.cmml"><mi id="A2.E31.m1.1.1.1.1.1.2.2" xref="A2.E31.m1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="A2.E31.m1.1.1.1.1.1.2.3" xref="A2.E31.m1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="A2.E31.m1.1.1.1.1.1.1" xref="A2.E31.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E31.m1.1.1.1.1.1.3" xref="A2.E31.m1.1.1.1.1.1.3.cmml"><mi id="A2.E31.m1.1.1.1.1.1.3.2" xref="A2.E31.m1.1.1.1.1.1.3.2.cmml">μ</mi><msub id="A2.E31.m1.1.1.1.1.1.3.3" xref="A2.E31.m1.1.1.1.1.1.3.3.cmml"><mi id="A2.E31.m1.1.1.1.1.1.3.3.2" xref="A2.E31.m1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A2.E31.m1.1.1.1.1.1.3.3.3" xref="A2.E31.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="A2.E31.m1.1.1.1.1.3" stretchy="false" xref="A2.E31.m1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E31.m1.2.2.2.1" xref="A2.E31.m1.2.2.2.2.cmml"><mo id="A2.E31.m1.2.2.2.1.2" stretchy="false" xref="A2.E31.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A2.E31.m1.2.2.2.1.1" xref="A2.E31.m1.2.2.2.1.1.cmml"><mi id="A2.E31.m1.2.2.2.1.1.2" xref="A2.E31.m1.2.2.2.1.1.2.cmml">𝐱</mi><mo id="A2.E31.m1.2.2.2.1.1.1" xref="A2.E31.m1.2.2.2.1.1.1.cmml">−</mo><msub id="A2.E31.m1.2.2.2.1.1.3" xref="A2.E31.m1.2.2.2.1.1.3.cmml"><mi id="A2.E31.m1.2.2.2.1.1.3.2" xref="A2.E31.m1.2.2.2.1.1.3.2.cmml">μ</mi><mi id="A2.E31.m1.2.2.2.1.1.3.3" xref="A2.E31.m1.2.2.2.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="A2.E31.m1.2.2.2.1.3" stretchy="false" xref="A2.E31.m1.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E31.m1.10.10.1.1.1.2a" xref="A2.E31.m1.10.10.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A2.E31.m1.4.4" xref="A2.E31.m1.4.4.cmml"><mfrac id="A2.E31.m1.4.4a" xref="A2.E31.m1.4.4.cmml"><mrow id="A2.E31.m1.3.3.1.1" xref="A2.E31.m1.3.3.1.2.cmml"><mo id="A2.E31.m1.3.3.1.1.2" stretchy="false" xref="A2.E31.m1.3.3.1.2.1.cmml">‖</mo><msub id="A2.E31.m1.3.3.1.1.1" xref="A2.E31.m1.3.3.1.1.1.cmml"><mi id="A2.E31.m1.3.3.1.1.1.2" xref="A2.E31.m1.3.3.1.1.1.2.cmml">𝒗</mi><mi id="A2.E31.m1.3.3.1.1.1.3" xref="A2.E31.m1.3.3.1.1.1.3.cmml">j</mi></msub><mo id="A2.E31.m1.3.3.1.1.3" stretchy="false" xref="A2.E31.m1.3.3.1.2.1.cmml">‖</mo></mrow><mrow id="A2.E31.m1.4.4.2.3" xref="A2.E31.m1.4.4.2.2.cmml"><mo id="A2.E31.m1.4.4.2.3.1" stretchy="false" xref="A2.E31.m1.4.4.2.2.1.cmml">‖</mo><mi id="A2.E31.m1.4.4.2.1" xref="A2.E31.m1.4.4.2.1.cmml">𝒙</mi><mo id="A2.E31.m1.4.4.2.3.2" stretchy="false" xref="A2.E31.m1.4.4.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mo id="A2.E31.m1.10.10.1.1.1.2b" xref="A2.E31.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="A2.E31.m1.10.10.1.1.1.1.1" xref="A2.E31.m1.10.10.1.1.1.1.2.cmml"><mo id="A2.E31.m1.10.10.1.1.1.1.1.2" xref="A2.E31.m1.10.10.1.1.1.1.2.1.cmml">[</mo><mrow id="A2.E31.m1.10.10.1.1.1.1.1.1" xref="A2.E31.m1.10.10.1.1.1.1.1.1.cmml"><mrow id="A2.E31.m1.10.10.1.1.1.1.1.1.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.cmml"><msub id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2a.cmml">LogitLens</mtext><mi id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.3" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.2.1" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A2.E31.m1.10.10.1.1.1.1.1.1.2.3.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.cmml"><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.cmml">(</mo><mi id="A2.E31.m1.7.7" xref="A2.E31.m1.7.7.cmml">𝐭</mi><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.1" xref="A2.E31.m1.10.10.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A2.E31.m1.10.10.1.1.1.1.1.1.3" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A2.E31.m1.6.6" xref="A2.E31.m1.6.6.cmml"><mfrac id="A2.E31.m1.6.6a" xref="A2.E31.m1.6.6.cmml"><mrow id="A2.E31.m1.6.6.4" xref="A2.E31.m1.6.6.4.cmml"><mi id="A2.E31.m1.6.6.4.2" xref="A2.E31.m1.6.6.4.2.cmml">𝒙</mi><mo id="A2.E31.m1.6.6.4.1" lspace="0.222em" rspace="0.222em" xref="A2.E31.m1.6.6.4.1.cmml">⋅</mo><msub id="A2.E31.m1.6.6.4.3" xref="A2.E31.m1.6.6.4.3.cmml"><mi id="A2.E31.m1.6.6.4.3.2" xref="A2.E31.m1.6.6.4.3.2.cmml">𝒗</mi><mi id="A2.E31.m1.6.6.4.3.3" xref="A2.E31.m1.6.6.4.3.3.cmml">j</mi></msub></mrow><mrow id="A2.E31.m1.6.6.2" xref="A2.E31.m1.6.6.2.cmml"><mrow id="A2.E31.m1.6.6.2.4.2" xref="A2.E31.m1.6.6.2.4.1.cmml"><mo id="A2.E31.m1.6.6.2.4.2.1" stretchy="false" xref="A2.E31.m1.6.6.2.4.1.1.cmml">‖</mo><mi id="A2.E31.m1.5.5.1.1" xref="A2.E31.m1.5.5.1.1.cmml">𝒙</mi><mo id="A2.E31.m1.6.6.2.4.2.2" stretchy="false" xref="A2.E31.m1.6.6.2.4.1.1.cmml">‖</mo></mrow><mo id="A2.E31.m1.6.6.2.3" xref="A2.E31.m1.6.6.2.3.cmml">⁢</mo><mrow id="A2.E31.m1.6.6.2.2.1" xref="A2.E31.m1.6.6.2.2.2.cmml"><mo id="A2.E31.m1.6.6.2.2.1.2" stretchy="false" xref="A2.E31.m1.6.6.2.2.2.1.cmml">‖</mo><msub id="A2.E31.m1.6.6.2.2.1.1" xref="A2.E31.m1.6.6.2.2.1.1.cmml"><mi id="A2.E31.m1.6.6.2.2.1.1.2" xref="A2.E31.m1.6.6.2.2.1.1.2.cmml">𝒗</mi><mi id="A2.E31.m1.6.6.2.2.1.1.3" xref="A2.E31.m1.6.6.2.2.1.1.3.cmml">j</mi></msub><mo id="A2.E31.m1.6.6.2.2.1.3" stretchy="false" xref="A2.E31.m1.6.6.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.3.1" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A2.E31.m1.10.10.1.1.1.1.1.1.3.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.3.1a" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.1.cmml"><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="A2.E31.m1.8.8" xref="A2.E31.m1.8.8.cmml">𝒙</mi><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.2.2" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="A2.E31.m1.9.9" xref="A2.E31.m1.9.9.cmml">𝐭</mi><mo id="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E31.m1.10.10.1.1.1.1.1.3" rspace="0.330em" xref="A2.E31.m1.10.10.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A2.E31.m1.10.10.1.2" xref="A2.E31.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E31.m1.10b"><apply id="A2.E31.m1.10.10.1.1.cmml" xref="A2.E31.m1.10.10.1"><eq id="A2.E31.m1.10.10.1.1.2.cmml" xref="A2.E31.m1.10.10.1.1.2"></eq><csymbol cd="latexml" id="A2.E31.m1.10.10.1.1.3.cmml" xref="A2.E31.m1.10.10.1.1.3">absent</csymbol><apply id="A2.E31.m1.10.10.1.1.1.cmml" xref="A2.E31.m1.10.10.1.1.1"><times id="A2.E31.m1.10.10.1.1.1.2.cmml" xref="A2.E31.m1.10.10.1.1.1.2"></times><apply id="A2.E31.m1.10.10.1.1.1.3.cmml" xref="A2.E31.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="A2.E31.m1.10.10.1.1.1.3.1.cmml" xref="A2.E31.m1.10.10.1.1.1.3">subscript</csymbol><ci id="A2.E31.m1.10.10.1.1.1.3.2.cmml" xref="A2.E31.m1.10.10.1.1.1.3.2">𝑎</ci><ci id="A2.E31.m1.10.10.1.1.1.3.3.cmml" xref="A2.E31.m1.10.10.1.1.1.3.3">𝑗</ci></apply><apply id="A2.E31.m1.2.2.cmml" xref="A2.E31.m1.2.2"><divide id="A2.E31.m1.2.2.3.cmml" xref="A2.E31.m1.2.2"></divide><apply id="A2.E31.m1.1.1.1.2.cmml" xref="A2.E31.m1.1.1.1.1"><csymbol cd="latexml" id="A2.E31.m1.1.1.1.2.1.cmml" xref="A2.E31.m1.1.1.1.1.2">norm</csymbol><apply id="A2.E31.m1.1.1.1.1.1.cmml" xref="A2.E31.m1.1.1.1.1.1"><minus id="A2.E31.m1.1.1.1.1.1.1.cmml" xref="A2.E31.m1.1.1.1.1.1.1"></minus><apply id="A2.E31.m1.1.1.1.1.1.2.cmml" xref="A2.E31.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E31.m1.1.1.1.1.1.2.1.cmml" xref="A2.E31.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E31.m1.1.1.1.1.1.2.2.cmml" xref="A2.E31.m1.1.1.1.1.1.2.2">𝐯</ci><ci id="A2.E31.m1.1.1.1.1.1.2.3.cmml" xref="A2.E31.m1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A2.E31.m1.1.1.1.1.1.3.cmml" xref="A2.E31.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E31.m1.1.1.1.1.1.3.1.cmml" xref="A2.E31.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E31.m1.1.1.1.1.1.3.2.cmml" xref="A2.E31.m1.1.1.1.1.1.3.2">𝜇</ci><apply id="A2.E31.m1.1.1.1.1.1.3.3.cmml" xref="A2.E31.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.E31.m1.1.1.1.1.1.3.3.1.cmml" xref="A2.E31.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.E31.m1.1.1.1.1.1.3.3.2.cmml" xref="A2.E31.m1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A2.E31.m1.1.1.1.1.1.3.3.3.cmml" xref="A2.E31.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="A2.E31.m1.2.2.2.2.cmml" xref="A2.E31.m1.2.2.2.1"><csymbol cd="latexml" id="A2.E31.m1.2.2.2.2.1.cmml" xref="A2.E31.m1.2.2.2.1.2">norm</csymbol><apply id="A2.E31.m1.2.2.2.1.1.cmml" xref="A2.E31.m1.2.2.2.1.1"><minus id="A2.E31.m1.2.2.2.1.1.1.cmml" xref="A2.E31.m1.2.2.2.1.1.1"></minus><ci id="A2.E31.m1.2.2.2.1.1.2.cmml" xref="A2.E31.m1.2.2.2.1.1.2">𝐱</ci><apply id="A2.E31.m1.2.2.2.1.1.3.cmml" xref="A2.E31.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E31.m1.2.2.2.1.1.3.1.cmml" xref="A2.E31.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E31.m1.2.2.2.1.1.3.2.cmml" xref="A2.E31.m1.2.2.2.1.1.3.2">𝜇</ci><ci id="A2.E31.m1.2.2.2.1.1.3.3.cmml" xref="A2.E31.m1.2.2.2.1.1.3.3">𝐱</ci></apply></apply></apply></apply><apply id="A2.E31.m1.4.4.cmml" xref="A2.E31.m1.4.4"><divide id="A2.E31.m1.4.4.3.cmml" xref="A2.E31.m1.4.4"></divide><apply id="A2.E31.m1.3.3.1.2.cmml" xref="A2.E31.m1.3.3.1.1"><csymbol cd="latexml" id="A2.E31.m1.3.3.1.2.1.cmml" xref="A2.E31.m1.3.3.1.1.2">norm</csymbol><apply id="A2.E31.m1.3.3.1.1.1.cmml" xref="A2.E31.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A2.E31.m1.3.3.1.1.1.1.cmml" xref="A2.E31.m1.3.3.1.1.1">subscript</csymbol><ci id="A2.E31.m1.3.3.1.1.1.2.cmml" xref="A2.E31.m1.3.3.1.1.1.2">𝒗</ci><ci id="A2.E31.m1.3.3.1.1.1.3.cmml" xref="A2.E31.m1.3.3.1.1.1.3">𝑗</ci></apply></apply><apply id="A2.E31.m1.4.4.2.2.cmml" xref="A2.E31.m1.4.4.2.3"><csymbol cd="latexml" id="A2.E31.m1.4.4.2.2.1.cmml" xref="A2.E31.m1.4.4.2.3.1">norm</csymbol><ci id="A2.E31.m1.4.4.2.1.cmml" xref="A2.E31.m1.4.4.2.1">𝒙</ci></apply></apply><apply id="A2.E31.m1.10.10.1.1.1.1.2.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="A2.E31.m1.10.10.1.1.1.1.2.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E31.m1.10.10.1.1.1.1.1.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1"><minus id="A2.E31.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.1"></minus><apply id="A2.E31.m1.10.10.1.1.1.1.1.1.2.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2"><times id="A2.E31.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.1"></times><apply id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2a.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.2">LogitLens</mtext></ci><ci id="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.3.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><ci id="A2.E31.m1.7.7.cmml" xref="A2.E31.m1.7.7">𝐭</ci></apply><apply id="A2.E31.m1.10.10.1.1.1.1.1.1.3.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3"><times id="A2.E31.m1.10.10.1.1.1.1.1.1.3.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.1"></times><apply id="A2.E31.m1.6.6.cmml" xref="A2.E31.m1.6.6"><divide id="A2.E31.m1.6.6.3.cmml" xref="A2.E31.m1.6.6"></divide><apply id="A2.E31.m1.6.6.4.cmml" xref="A2.E31.m1.6.6.4"><ci id="A2.E31.m1.6.6.4.1.cmml" xref="A2.E31.m1.6.6.4.1">⋅</ci><ci id="A2.E31.m1.6.6.4.2.cmml" xref="A2.E31.m1.6.6.4.2">𝒙</ci><apply id="A2.E31.m1.6.6.4.3.cmml" xref="A2.E31.m1.6.6.4.3"><csymbol cd="ambiguous" id="A2.E31.m1.6.6.4.3.1.cmml" xref="A2.E31.m1.6.6.4.3">subscript</csymbol><ci id="A2.E31.m1.6.6.4.3.2.cmml" xref="A2.E31.m1.6.6.4.3.2">𝒗</ci><ci id="A2.E31.m1.6.6.4.3.3.cmml" xref="A2.E31.m1.6.6.4.3.3">𝑗</ci></apply></apply><apply id="A2.E31.m1.6.6.2.cmml" xref="A2.E31.m1.6.6.2"><times id="A2.E31.m1.6.6.2.3.cmml" xref="A2.E31.m1.6.6.2.3"></times><apply id="A2.E31.m1.6.6.2.4.1.cmml" xref="A2.E31.m1.6.6.2.4.2"><csymbol cd="latexml" id="A2.E31.m1.6.6.2.4.1.1.cmml" xref="A2.E31.m1.6.6.2.4.2.1">norm</csymbol><ci id="A2.E31.m1.5.5.1.1.cmml" xref="A2.E31.m1.5.5.1.1">𝒙</ci></apply><apply id="A2.E31.m1.6.6.2.2.2.cmml" xref="A2.E31.m1.6.6.2.2.1"><csymbol cd="latexml" id="A2.E31.m1.6.6.2.2.2.1.cmml" xref="A2.E31.m1.6.6.2.2.1.2">norm</csymbol><apply id="A2.E31.m1.6.6.2.2.1.1.cmml" xref="A2.E31.m1.6.6.2.2.1.1"><csymbol cd="ambiguous" id="A2.E31.m1.6.6.2.2.1.1.1.cmml" xref="A2.E31.m1.6.6.2.2.1.1">subscript</csymbol><ci id="A2.E31.m1.6.6.2.2.1.1.2.cmml" xref="A2.E31.m1.6.6.2.2.1.1.2">𝒗</ci><ci id="A2.E31.m1.6.6.2.2.1.1.3.cmml" xref="A2.E31.m1.6.6.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply><ci id="A2.E31.m1.10.10.1.1.1.1.1.1.3.2.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.2">𝑦</ci><interval closure="open" id="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.1.cmml" xref="A2.E31.m1.10.10.1.1.1.1.1.1.3.3.2"><ci id="A2.E31.m1.8.8.cmml" xref="A2.E31.m1.8.8">𝒙</ci><ci id="A2.E31.m1.9.9.cmml" xref="A2.E31.m1.9.9">𝐭</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E31.m1.10c">\displaystyle=a_{j}\frac{\|\mathbf{v}_{j}-\mu_{\mathbf{v}_{j}}\|}{\|\mathbf{x}%
-\mu_{\mathbf{x}}\|}\frac{\|\boldsymbol{v}_{j}\|}{\|\boldsymbol{x}\|}\left[%
\texttt{LogitLens}_{j}(\mathbf{t})-\frac{\boldsymbol{x}\cdot\boldsymbol{v}_{j}%
}{\|\boldsymbol{x}\|\|\boldsymbol{v}_{j}\|}y(\boldsymbol{x},\mathbf{t})\right]%
~{},</annotation><annotation encoding="application/x-llamapun" id="A2.E31.m1.10d">= italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG ∥ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_x - italic_μ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG divide start_ARG ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG start_ARG ∥ bold_italic_x ∥ end_ARG [ LogitLens start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t ) - divide start_ARG bold_italic_x ⋅ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_italic_x ∥ ∥ bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG italic_y ( bold_italic_x , bold_t ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.SS1.p14.3">where we included <math alttext="\texttt{LogitLens}_{j}(\mathbf{t})" class="ltx_Math" display="inline" id="A2.SS1.p14.2.m1.1"><semantics id="A2.SS1.p14.2.m1.1a"><mrow id="A2.SS1.p14.2.m1.1.2" xref="A2.SS1.p14.2.m1.1.2.cmml"><msub id="A2.SS1.p14.2.m1.1.2.2" xref="A2.SS1.p14.2.m1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="A2.SS1.p14.2.m1.1.2.2.2" xref="A2.SS1.p14.2.m1.1.2.2.2a.cmml">LogitLens</mtext><mi id="A2.SS1.p14.2.m1.1.2.2.3" xref="A2.SS1.p14.2.m1.1.2.2.3.cmml">j</mi></msub><mo id="A2.SS1.p14.2.m1.1.2.1" xref="A2.SS1.p14.2.m1.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p14.2.m1.1.2.3.2" xref="A2.SS1.p14.2.m1.1.2.cmml"><mo id="A2.SS1.p14.2.m1.1.2.3.2.1" stretchy="false" xref="A2.SS1.p14.2.m1.1.2.cmml">(</mo><mi id="A2.SS1.p14.2.m1.1.1" xref="A2.SS1.p14.2.m1.1.1.cmml">𝐭</mi><mo id="A2.SS1.p14.2.m1.1.2.3.2.2" stretchy="false" xref="A2.SS1.p14.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p14.2.m1.1b"><apply id="A2.SS1.p14.2.m1.1.2.cmml" xref="A2.SS1.p14.2.m1.1.2"><times id="A2.SS1.p14.2.m1.1.2.1.cmml" xref="A2.SS1.p14.2.m1.1.2.1"></times><apply id="A2.SS1.p14.2.m1.1.2.2.cmml" xref="A2.SS1.p14.2.m1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p14.2.m1.1.2.2.1.cmml" xref="A2.SS1.p14.2.m1.1.2.2">subscript</csymbol><ci id="A2.SS1.p14.2.m1.1.2.2.2a.cmml" xref="A2.SS1.p14.2.m1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="A2.SS1.p14.2.m1.1.2.2.2.cmml" xref="A2.SS1.p14.2.m1.1.2.2.2">LogitLens</mtext></ci><ci id="A2.SS1.p14.2.m1.1.2.2.3.cmml" xref="A2.SS1.p14.2.m1.1.2.2.3">𝑗</ci></apply><ci id="A2.SS1.p14.2.m1.1.1.cmml" xref="A2.SS1.p14.2.m1.1.1">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p14.2.m1.1c">\texttt{LogitLens}_{j}(\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p14.2.m1.1d">LogitLens start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_t )</annotation></semantics></math> corresponding to the Logit Lens alignment score for component <math alttext="j" class="ltx_Math" display="inline" id="A2.SS1.p14.3.m2.1"><semantics id="A2.SS1.p14.3.m2.1a"><mi id="A2.SS1.p14.3.m2.1.1" xref="A2.SS1.p14.3.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p14.3.m2.1b"><ci id="A2.SS1.p14.3.m2.1.1.cmml" xref="A2.SS1.p14.3.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p14.3.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p14.3.m2.1d">italic_j</annotation></semantics></math> as given by <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E3" title="In 3.3 Understanding component-output alignment with Logit Lens ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Evaluating faithfulness of attributions</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">This section provides more details and results for experiments of <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>.
We perform all evaluations on the test set of ImageNet-1k, which contains 50,000 samples with 50 images per class.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p2.1.1">Deletion (local):</span> We evaluate the first 100 classes of ImageNet-1k, using 50 samples per class. For each image, we compute attribution scores indicating the relevance of each <span class="ltx_glossaryref" title="">SAE</span> component to the cosine similarity between the visual and text embeddings of the corresponding class label. The top 10 most relevant components are sequentially set to zero activation, and we measure the reduction in output similarity at each step. The area under this deletion curve (AUC) quantifies the contribution of the identified components.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p3.1.1">Deletion (global):</span> We compute global relevance scores based on the 50 samples per class. These scores are then used to select components for deletion across all 50 samples per class, allowing us to assess how globally important components affect prediction similarity when ablated.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p4">
<p class="ltx_p" id="A2.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p4.1.1">Deletion (random):</span> We compute global relevance scores based on 500 randomly sampled images. These scores are then used to select components for deletion across all 50 samples per class, allowing us to assess how important the choice of reference samples is for a method.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p5">
<p class="ltx_p" id="A2.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p5.1.1">Insertion (local):</span> This procedure mirrors local deletion but begins with all component activations set to zero. The most relevant components are then sequentially reinserted by restoring their original activation values, enabling us to assess their cumulative contribution to the model’s output.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p6">
<p class="ltx_p" id="A2.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p6.1.1">Baselines:</span>
We compare our method based on <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E29" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">29</span></a> (Act.<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p6.1.m1.1"><semantics id="A2.SS2.p6.1.m1.1a"><mo id="A2.SS2.p6.1.m1.1.1" xref="A2.SS2.p6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p6.1.m1.1b"><times id="A2.SS2.p6.1.m1.1.1.cmml" xref="A2.SS2.p6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p6.1.m1.1d">×</annotation></semantics></math>Grad) against Logit Lens, activation times Logit Lens (which mimicks <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E29" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">29</span></a> without the local correction term), Energy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib48" title="">48</a>]</cite> (corresponding to component activation, as the norm of latent vectors is one for our <span class="ltx_glossaryref" title="">SAEs</span>), Integrated Gradients as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib32" title="">32</a>]</cite> with 10 steps, and a random choice of activating latent componens.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p7">
<p class="ltx_p" id="A2.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p7.1.1">Uncertainty Estimation:</span>
To estimate the uncertainty of the AUC scores, we divide the evaluation data into 9 equally sized subsets. For each subset, we compute the AUC independently. The standard error of the mean (<span class="ltx_glossaryref" title="">SEM</span>) across these AUC values is then used as the uncertainty estimate.</p>
</div>
<div class="ltx_para" id="A2.SS2.p8">
<p class="ltx_p" id="A2.SS2.p8.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p8.1.1">Results:</span></p>
</div>
<figure class="ltx_figure" id="A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="644" id="A2.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Evaluating Faithfulness of attributions of different attribution methods under three evaluation settings: local deletion (<em class="ltx_emph ltx_font_italic" id="A2.F7.6.1">left</em>), global deletion (<em class="ltx_emph ltx_font_italic" id="A2.F7.7.2">middle</em>), and local insertion (<em class="ltx_emph ltx_font_italic" id="A2.F7.8.3">right</em>). Gradient-based approaches (e.g., Act<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.2.m1.1"><semantics id="A2.F7.2.m1.1b"><mo id="A2.F7.2.m1.1.1" xref="A2.F7.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.2.m1.1c"><times id="A2.F7.2.m1.1.1.cmml" xref="A2.F7.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.2.m1.1e">×</annotation></semantics></math>Grad, Integrated Gradients) consistently outperform baselines, indicating higher faithfulness. Methods relying solely on activation magnitude or alignment (e.g., Energy, Logit Lens) show limited reliability, especially in early steps. Errors represent standard error of the mean across samples.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="213" id="A2.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Evaluating Faithfulness of attributions of different attribution methods when attribution scores are estimated on random reference samples. All reference-sample dependent methods perform significantly worse in this setting, with Logit Lens resulting in the best scores. This underscores the need to chose meaningful reference samples. Errors represent standard error of the mean across samples.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS2.p9">
<p class="ltx_p" id="A2.SS2.p9.1">The results are summarized in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.F7" title="In B.2 Evaluating faithfulness of attributions ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>. Across all models and settings, random attribution order consistently yields the worst performance. The energy-based attributions also shows limited faithfulness, and shows an interesting outlier behavior for ViT-H/14 and ViT-L/14 in the first latent deletion or insertion step. This suggests that highly activated components can exist that do not contribute to the model output and may even counteract it during deletion. This observation highlights that high activation alone does not imply relevance or alignment with the output.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p10">
<p class="ltx_p" id="A2.SS2.p10.2">While Logit Lens, which measures alignment with the output, performs better than energy-based attributions, it still falls short as it ignores component magnitude. The Act<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p10.1.m1.1"><semantics id="A2.SS2.p10.1.m1.1a"><mo id="A2.SS2.p10.1.m1.1.1" xref="A2.SS2.p10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p10.1.m1.1b"><times id="A2.SS2.p10.1.m1.1.1.cmml" xref="A2.SS2.p10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p10.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p10.1.m1.1d">×</annotation></semantics></math>LogitLens approach, which combines activation magnitude with alignment, achieves performance comparable to Act<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p10.2.m2.1"><semantics id="A2.SS2.p10.2.m2.1a"><mo id="A2.SS2.p10.2.m2.1.1" xref="A2.SS2.p10.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p10.2.m2.1b"><times id="A2.SS2.p10.2.m2.1.1.cmml" xref="A2.SS2.p10.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p10.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p10.2.m2.1d">×</annotation></semantics></math>Grad and Integrated Gradients for deletion. However, for insertion, it often underperforms. This discrepancy may be due to the fact that in early insertion steps, alignment (and component interaction) matters more than activation strength. Such interactions are better captured by the local correction term introduced in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.E6" title="In 4.1 Instance-wise attribution of components ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, which gradient-based methods implicitly account for.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p11">
<p class="ltx_p" id="A2.SS2.p11.3">Integrated Gradients generally outperforms other methods when a larger number of components are deleted. Across both insertion and deletion tasks, gradient-based methods show the best overall performance. It is worth noting, however, that Integrated Gradients is significantly more computationally expensive – approximately <math alttext="N" class="ltx_Math" display="inline" id="A2.SS2.p11.1.m1.1"><semantics id="A2.SS2.p11.1.m1.1a"><mi id="A2.SS2.p11.1.m1.1.1" xref="A2.SS2.p11.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p11.1.m1.1b"><ci id="A2.SS2.p11.1.m1.1.1.cmml" xref="A2.SS2.p11.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p11.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p11.1.m1.1d">italic_N</annotation></semantics></math> times more than Act<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p11.2.m2.1"><semantics id="A2.SS2.p11.2.m2.1a"><mo id="A2.SS2.p11.2.m2.1.1" xref="A2.SS2.p11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p11.2.m2.1b"><times id="A2.SS2.p11.2.m2.1.1.cmml" xref="A2.SS2.p11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p11.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p11.2.m2.1d">×</annotation></semantics></math>Grad, depending on the number <math alttext="N" class="ltx_Math" display="inline" id="A2.SS2.p11.3.m3.1"><semantics id="A2.SS2.p11.3.m3.1a"><mi id="A2.SS2.p11.3.m3.1.1" xref="A2.SS2.p11.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p11.3.m3.1b"><ci id="A2.SS2.p11.3.m3.1.1.cmml" xref="A2.SS2.p11.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p11.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p11.3.m3.1d">italic_N</annotation></semantics></math> of integration steps used.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p12">
<p class="ltx_p" id="A2.SS2.p12.1">Notably,
the choice of reference samples is crucial as demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.F8" title="In B.2 Evaluating faithfulness of attributions ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>,
where we show deletion experiment results when attributions are erstimated on randomly chosen reference samples (and not the actual class-specific reference samples).
Here, Logit Lens performs significantly better than all other baselines.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Interpretability and diversity of SAE components</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">This section corresponds to <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS2" title="5.2 Interpretability and diversity of SAE components (Q2) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.2</span></a> of the main manuscript, and provides more quantitative and qualitative results for SAE component interpretability analysis and concept diversity comparisons.</p>
</div>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Interpretability correlates with activation magnitude</h3>
<div class="ltx_para ltx_noindent" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">We expand on the analysis from <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS2" title="5.2 Interpretability and diversity of SAE components (Q2) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.2</span></a>, examining how interpretability (measured as clarity using CLIP-Mobile-S2 and the 20 most activating samples on the ImageNet-1k train set) relates to the magnitude and frequency of component activations. Specifically, we consider three metrics:</p>
</div>
<div class="ltx_para" id="A3.SS1.p2">
<ol class="ltx_enumerate" id="A3.I1">
<li class="ltx_item" id="A3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A3.I1.i1.p1">
<p class="ltx_p" id="A3.I1.i1.p1.1">Mean activation on the top-5 most activating images per component,</p>
</div>
</li>
<li class="ltx_item" id="A3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A3.I1.i2.p1">
<p class="ltx_p" id="A3.I1.i2.p1.1">Average activation over the entire dataset,</p>
</div>
</li>
<li class="ltx_item" id="A3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="A3.I1.i3.p1">
<p class="ltx_p" id="A3.I1.i3.p1.1">Firing rate, defined as the number of non-zero activations per component.</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="A3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="1002" id="A3.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Correlation between interpretability (clarity) and component activation metrics across ImageNet-1k. We compare top-5 activation averages, overall mean activations, and firing rate (non-zero count). Top-5 activations show the strongest correlation with clarity. Average and count-based measures are shown on a logarithmic scale to highlight positive, though weaker, correlations.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A3.SS1.p3">
<p class="ltx_p" id="A3.SS1.p3.1">All measurements are now computed on the ImageNet-1k <em class="ltx_emph ltx_font_italic" id="A3.SS1.p3.1.1">test</em> set (results in the main manuscript were performed on the train set). Results for ViT-L/14, ViT-H/14, ViT-B/16, and ViT-B/32 models are shown in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F9" title="In C.1 Interpretability correlates with activation magnitude ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>.
We observe the following trends:
Top-5 activations exhibit the strongest correlation with interpretability (correlation coefficients are reported in the titles of each scatter plot). In contrast, average activation and firing rate show weaker correlations unless log-transformed, suggesting their raw distributions are highly skewed. Notably, the positive correlation between firing rate and clarity contradicts the common assumption that sparsity promotes interpretability, indicating that more frequently active components may also encode coherent and meaningful features.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Finding unexpected components and concepts</h3>
<figure class="ltx_figure" id="A3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="769" id="A3.F10.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Examples of unexpected concepts found in CLIP ViT-L/14 for different levels of interpretability (clarity <math alttext="c" class="ltx_Math" display="inline" id="A3.F10.7.m1.1"><semantics id="A3.F10.7.m1.1b"><mi id="A3.F10.7.m1.1.1" xref="A3.F10.7.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A3.F10.7.m1.1c"><ci id="A3.F10.7.m1.1.1.cmml" xref="A3.F10.7.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.7.m1.1d">c</annotation><annotation encoding="application/x-llamapun" id="A3.F10.7.m1.1e">italic_c</annotation></semantics></math>). Components are grouped by interpretability clarity: high (<math alttext="c\geq 0.6" class="ltx_Math" display="inline" id="A3.F10.8.m2.1"><semantics id="A3.F10.8.m2.1b"><mrow id="A3.F10.8.m2.1.1" xref="A3.F10.8.m2.1.1.cmml"><mi id="A3.F10.8.m2.1.1.2" xref="A3.F10.8.m2.1.1.2.cmml">c</mi><mo id="A3.F10.8.m2.1.1.1" xref="A3.F10.8.m2.1.1.1.cmml">≥</mo><mn id="A3.F10.8.m2.1.1.3" xref="A3.F10.8.m2.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F10.8.m2.1c"><apply id="A3.F10.8.m2.1.1.cmml" xref="A3.F10.8.m2.1.1"><geq id="A3.F10.8.m2.1.1.1.cmml" xref="A3.F10.8.m2.1.1.1"></geq><ci id="A3.F10.8.m2.1.1.2.cmml" xref="A3.F10.8.m2.1.1.2">𝑐</ci><cn id="A3.F10.8.m2.1.1.3.cmml" type="float" xref="A3.F10.8.m2.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.8.m2.1d">c\geq 0.6</annotation><annotation encoding="application/x-llamapun" id="A3.F10.8.m2.1e">italic_c ≥ 0.6</annotation></semantics></math>), medium (<math alttext="0.4&lt;c&lt;0.6" class="ltx_Math" display="inline" id="A3.F10.9.m3.1"><semantics id="A3.F10.9.m3.1b"><mrow id="A3.F10.9.m3.1.1" xref="A3.F10.9.m3.1.1.cmml"><mn id="A3.F10.9.m3.1.1.2" xref="A3.F10.9.m3.1.1.2.cmml">0.4</mn><mo id="A3.F10.9.m3.1.1.3" xref="A3.F10.9.m3.1.1.3.cmml">&lt;</mo><mi id="A3.F10.9.m3.1.1.4" xref="A3.F10.9.m3.1.1.4.cmml">c</mi><mo id="A3.F10.9.m3.1.1.5" xref="A3.F10.9.m3.1.1.5.cmml">&lt;</mo><mn id="A3.F10.9.m3.1.1.6" xref="A3.F10.9.m3.1.1.6.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F10.9.m3.1c"><apply id="A3.F10.9.m3.1.1.cmml" xref="A3.F10.9.m3.1.1"><and id="A3.F10.9.m3.1.1a.cmml" xref="A3.F10.9.m3.1.1"></and><apply id="A3.F10.9.m3.1.1b.cmml" xref="A3.F10.9.m3.1.1"><lt id="A3.F10.9.m3.1.1.3.cmml" xref="A3.F10.9.m3.1.1.3"></lt><cn id="A3.F10.9.m3.1.1.2.cmml" type="float" xref="A3.F10.9.m3.1.1.2">0.4</cn><ci id="A3.F10.9.m3.1.1.4.cmml" xref="A3.F10.9.m3.1.1.4">𝑐</ci></apply><apply id="A3.F10.9.m3.1.1c.cmml" xref="A3.F10.9.m3.1.1"><lt id="A3.F10.9.m3.1.1.5.cmml" xref="A3.F10.9.m3.1.1.5"></lt><share href="https://arxiv.org/html/2505.20229v1#A3.F10.9.m3.1.1.4.cmml" id="A3.F10.9.m3.1.1d.cmml" xref="A3.F10.9.m3.1.1"></share><cn id="A3.F10.9.m3.1.1.6.cmml" type="float" xref="A3.F10.9.m3.1.1.6">0.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.9.m3.1d">0.4&lt;c&lt;0.6</annotation><annotation encoding="application/x-llamapun" id="A3.F10.9.m3.1e">0.4 &lt; italic_c &lt; 0.6</annotation></semantics></math>), and low (<math alttext="c&lt;0.4" class="ltx_Math" display="inline" id="A3.F10.10.m4.1"><semantics id="A3.F10.10.m4.1b"><mrow id="A3.F10.10.m4.1.1" xref="A3.F10.10.m4.1.1.cmml"><mi id="A3.F10.10.m4.1.1.2" xref="A3.F10.10.m4.1.1.2.cmml">c</mi><mo id="A3.F10.10.m4.1.1.1" xref="A3.F10.10.m4.1.1.1.cmml">&lt;</mo><mn id="A3.F10.10.m4.1.1.3" xref="A3.F10.10.m4.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F10.10.m4.1c"><apply id="A3.F10.10.m4.1.1.cmml" xref="A3.F10.10.m4.1.1"><lt id="A3.F10.10.m4.1.1.1.cmml" xref="A3.F10.10.m4.1.1.1"></lt><ci id="A3.F10.10.m4.1.1.2.cmml" xref="A3.F10.10.m4.1.1.2">𝑐</ci><cn id="A3.F10.10.m4.1.1.3.cmml" type="float" xref="A3.F10.10.m4.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.10.m4.1d">c&lt;0.4</annotation><annotation encoding="application/x-llamapun" id="A3.F10.10.m4.1e">italic_c &lt; 0.4</annotation></semantics></math>). For each component, we report the average activation <math alttext="a" class="ltx_Math" display="inline" id="A3.F10.11.m5.1"><semantics id="A3.F10.11.m5.1b"><mi id="A3.F10.11.m5.1.1" xref="A3.F10.11.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A3.F10.11.m5.1c"><ci id="A3.F10.11.m5.1.1.cmml" xref="A3.F10.11.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.11.m5.1d">a</annotation><annotation encoding="application/x-llamapun" id="A3.F10.11.m5.1e">italic_a</annotation></semantics></math> across the top 20 activating samples and the textual alignment score <math alttext="s" class="ltx_Math" display="inline" id="A3.F10.12.m6.1"><semantics id="A3.F10.12.m6.1b"><mi id="A3.F10.12.m6.1.1" xref="A3.F10.12.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.F10.12.m6.1c"><ci id="A3.F10.12.m6.1.1.cmml" xref="A3.F10.12.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.12.m6.1d">s</annotation><annotation encoding="application/x-llamapun" id="A3.F10.12.m6.1e">italic_s</annotation></semantics></math> with the best-matching label.
</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="769" id="A3.F11.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Examples of unexpected concepts found in CLIP ViT-L/14 for different levels of interpretability (clarity <math alttext="c" class="ltx_Math" display="inline" id="A3.F11.7.m1.1"><semantics id="A3.F11.7.m1.1b"><mi id="A3.F11.7.m1.1.1" xref="A3.F11.7.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A3.F11.7.m1.1c"><ci id="A3.F11.7.m1.1.1.cmml" xref="A3.F11.7.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.7.m1.1d">c</annotation><annotation encoding="application/x-llamapun" id="A3.F11.7.m1.1e">italic_c</annotation></semantics></math>). Components are grouped by interpretability clarity: high (<math alttext="c\geq 0.6" class="ltx_Math" display="inline" id="A3.F11.8.m2.1"><semantics id="A3.F11.8.m2.1b"><mrow id="A3.F11.8.m2.1.1" xref="A3.F11.8.m2.1.1.cmml"><mi id="A3.F11.8.m2.1.1.2" xref="A3.F11.8.m2.1.1.2.cmml">c</mi><mo id="A3.F11.8.m2.1.1.1" xref="A3.F11.8.m2.1.1.1.cmml">≥</mo><mn id="A3.F11.8.m2.1.1.3" xref="A3.F11.8.m2.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.8.m2.1c"><apply id="A3.F11.8.m2.1.1.cmml" xref="A3.F11.8.m2.1.1"><geq id="A3.F11.8.m2.1.1.1.cmml" xref="A3.F11.8.m2.1.1.1"></geq><ci id="A3.F11.8.m2.1.1.2.cmml" xref="A3.F11.8.m2.1.1.2">𝑐</ci><cn id="A3.F11.8.m2.1.1.3.cmml" type="float" xref="A3.F11.8.m2.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.8.m2.1d">c\geq 0.6</annotation><annotation encoding="application/x-llamapun" id="A3.F11.8.m2.1e">italic_c ≥ 0.6</annotation></semantics></math>), medium (<math alttext="0.4&lt;c&lt;0.6" class="ltx_Math" display="inline" id="A3.F11.9.m3.1"><semantics id="A3.F11.9.m3.1b"><mrow id="A3.F11.9.m3.1.1" xref="A3.F11.9.m3.1.1.cmml"><mn id="A3.F11.9.m3.1.1.2" xref="A3.F11.9.m3.1.1.2.cmml">0.4</mn><mo id="A3.F11.9.m3.1.1.3" xref="A3.F11.9.m3.1.1.3.cmml">&lt;</mo><mi id="A3.F11.9.m3.1.1.4" xref="A3.F11.9.m3.1.1.4.cmml">c</mi><mo id="A3.F11.9.m3.1.1.5" xref="A3.F11.9.m3.1.1.5.cmml">&lt;</mo><mn id="A3.F11.9.m3.1.1.6" xref="A3.F11.9.m3.1.1.6.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.9.m3.1c"><apply id="A3.F11.9.m3.1.1.cmml" xref="A3.F11.9.m3.1.1"><and id="A3.F11.9.m3.1.1a.cmml" xref="A3.F11.9.m3.1.1"></and><apply id="A3.F11.9.m3.1.1b.cmml" xref="A3.F11.9.m3.1.1"><lt id="A3.F11.9.m3.1.1.3.cmml" xref="A3.F11.9.m3.1.1.3"></lt><cn id="A3.F11.9.m3.1.1.2.cmml" type="float" xref="A3.F11.9.m3.1.1.2">0.4</cn><ci id="A3.F11.9.m3.1.1.4.cmml" xref="A3.F11.9.m3.1.1.4">𝑐</ci></apply><apply id="A3.F11.9.m3.1.1c.cmml" xref="A3.F11.9.m3.1.1"><lt id="A3.F11.9.m3.1.1.5.cmml" xref="A3.F11.9.m3.1.1.5"></lt><share href="https://arxiv.org/html/2505.20229v1#A3.F11.9.m3.1.1.4.cmml" id="A3.F11.9.m3.1.1d.cmml" xref="A3.F11.9.m3.1.1"></share><cn id="A3.F11.9.m3.1.1.6.cmml" type="float" xref="A3.F11.9.m3.1.1.6">0.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.9.m3.1d">0.4&lt;c&lt;0.6</annotation><annotation encoding="application/x-llamapun" id="A3.F11.9.m3.1e">0.4 &lt; italic_c &lt; 0.6</annotation></semantics></math>), and low (<math alttext="c&lt;0.4" class="ltx_Math" display="inline" id="A3.F11.10.m4.1"><semantics id="A3.F11.10.m4.1b"><mrow id="A3.F11.10.m4.1.1" xref="A3.F11.10.m4.1.1.cmml"><mi id="A3.F11.10.m4.1.1.2" xref="A3.F11.10.m4.1.1.2.cmml">c</mi><mo id="A3.F11.10.m4.1.1.1" xref="A3.F11.10.m4.1.1.1.cmml">&lt;</mo><mn id="A3.F11.10.m4.1.1.3" xref="A3.F11.10.m4.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.10.m4.1c"><apply id="A3.F11.10.m4.1.1.cmml" xref="A3.F11.10.m4.1.1"><lt id="A3.F11.10.m4.1.1.1.cmml" xref="A3.F11.10.m4.1.1.1"></lt><ci id="A3.F11.10.m4.1.1.2.cmml" xref="A3.F11.10.m4.1.1.2">𝑐</ci><cn id="A3.F11.10.m4.1.1.3.cmml" type="float" xref="A3.F11.10.m4.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.10.m4.1d">c&lt;0.4</annotation><annotation encoding="application/x-llamapun" id="A3.F11.10.m4.1e">italic_c &lt; 0.4</annotation></semantics></math>). For each component, we report the average activation <math alttext="a" class="ltx_Math" display="inline" id="A3.F11.11.m5.1"><semantics id="A3.F11.11.m5.1b"><mi id="A3.F11.11.m5.1.1" xref="A3.F11.11.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A3.F11.11.m5.1c"><ci id="A3.F11.11.m5.1.1.cmml" xref="A3.F11.11.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.11.m5.1d">a</annotation><annotation encoding="application/x-llamapun" id="A3.F11.11.m5.1e">italic_a</annotation></semantics></math> across the top 20 activating samples and the textual alignment score <math alttext="s" class="ltx_Math" display="inline" id="A3.F11.12.m6.1"><semantics id="A3.F11.12.m6.1b"><mi id="A3.F11.12.m6.1.1" xref="A3.F11.12.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A3.F11.12.m6.1c"><ci id="A3.F11.12.m6.1.1.cmml" xref="A3.F11.12.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.12.m6.1d">s</annotation><annotation encoding="application/x-llamapun" id="A3.F11.12.m6.1e">italic_s</annotation></semantics></math> with the best-matching label. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">We present additional examples of latent components discovered using the approach described in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>a.
Specifically, we filter components with an average activation magnitude greater than <math alttext="3.0" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.1"><semantics id="A3.SS2.p1.1.m1.1a"><mn id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml">3.0</mn><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><cn id="A3.SS2.p1.1.m1.1.1.cmml" type="float" xref="A3.SS2.p1.1.m1.1.1">3.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">3.0</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.1.m1.1d">3.0</annotation></semantics></math> over their top-20 activating samples,
and with low alignment to ImageNet-21k class labels (as defined in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S3.E2" title="In 3.2 Understanding what semantics components encode ‣ 3 Prelimenaries ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>);
see <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F10" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Figs.</span> <span class="ltx_text ltx_ref_tag">10</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F11" title="Fig. 11 ‣ C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">11</span></a> for examples.
Here, activation is used as a proxy for relevance.
While activation alone is not always indicative of importance for a specific output, it is nevertheless informative in this setting,
as it provides a model-internal signal independent of a particular prompt.
According to <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.E6" title="In 4.1 Instance-wise attribution of components ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, activation contributes directly to the output,
thus high-activation components may influence predictions across a wide range of prompts.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.5">These components are further grouped by their interpretability levels (clarity).
We observe diverse and unexpected concepts, including textual artifacts such as image captions
(e.g., component <math alttext="\#1149" class="ltx_Math" display="inline" id="A3.SS2.p2.1.m1.1"><semantics id="A3.SS2.p2.1.m1.1a"><mrow id="A3.SS2.p2.1.m1.1.1" xref="A3.SS2.p2.1.m1.1.1.cmml"><mi id="A3.SS2.p2.1.m1.1.1.2" mathvariant="normal" xref="A3.SS2.p2.1.m1.1.1.2.cmml">#</mi><mo id="A3.SS2.p2.1.m1.1.1.1" xref="A3.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mn id="A3.SS2.p2.1.m1.1.1.3" xref="A3.SS2.p2.1.m1.1.1.3.cmml">1149</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.1.m1.1b"><apply id="A3.SS2.p2.1.m1.1.1.cmml" xref="A3.SS2.p2.1.m1.1.1"><times id="A3.SS2.p2.1.m1.1.1.1.cmml" xref="A3.SS2.p2.1.m1.1.1.1"></times><ci id="A3.SS2.p2.1.m1.1.1.2.cmml" xref="A3.SS2.p2.1.m1.1.1.2">#</ci><cn id="A3.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="A3.SS2.p2.1.m1.1.1.3">1149</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.1.m1.1c">\#1149</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.1.m1.1d"># 1149</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F10" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>), watermarks (component <math alttext="\#5581" class="ltx_Math" display="inline" id="A3.SS2.p2.2.m2.1"><semantics id="A3.SS2.p2.2.m2.1a"><mrow id="A3.SS2.p2.2.m2.1.1" xref="A3.SS2.p2.2.m2.1.1.cmml"><mi id="A3.SS2.p2.2.m2.1.1.2" mathvariant="normal" xref="A3.SS2.p2.2.m2.1.1.2.cmml">#</mi><mo id="A3.SS2.p2.2.m2.1.1.1" xref="A3.SS2.p2.2.m2.1.1.1.cmml">⁢</mo><mn id="A3.SS2.p2.2.m2.1.1.3" xref="A3.SS2.p2.2.m2.1.1.3.cmml">5581</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.2.m2.1b"><apply id="A3.SS2.p2.2.m2.1.1.cmml" xref="A3.SS2.p2.2.m2.1.1"><times id="A3.SS2.p2.2.m2.1.1.1.cmml" xref="A3.SS2.p2.2.m2.1.1.1"></times><ci id="A3.SS2.p2.2.m2.1.1.2.cmml" xref="A3.SS2.p2.2.m2.1.1.2">#</ci><cn id="A3.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="A3.SS2.p2.2.m2.1.1.3">5581</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.2.m2.1c">\#5581</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.2.m2.1d"># 5581</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F10" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>),
and typographic elements like the letter/number “O/0” (<math alttext="\#9941" class="ltx_Math" display="inline" id="A3.SS2.p2.3.m3.1"><semantics id="A3.SS2.p2.3.m3.1a"><mrow id="A3.SS2.p2.3.m3.1.1" xref="A3.SS2.p2.3.m3.1.1.cmml"><mi id="A3.SS2.p2.3.m3.1.1.2" mathvariant="normal" xref="A3.SS2.p2.3.m3.1.1.2.cmml">#</mi><mo id="A3.SS2.p2.3.m3.1.1.1" xref="A3.SS2.p2.3.m3.1.1.1.cmml">⁢</mo><mn id="A3.SS2.p2.3.m3.1.1.3" xref="A3.SS2.p2.3.m3.1.1.3.cmml">9941</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.3.m3.1b"><apply id="A3.SS2.p2.3.m3.1.1.cmml" xref="A3.SS2.p2.3.m3.1.1"><times id="A3.SS2.p2.3.m3.1.1.1.cmml" xref="A3.SS2.p2.3.m3.1.1.1"></times><ci id="A3.SS2.p2.3.m3.1.1.2.cmml" xref="A3.SS2.p2.3.m3.1.1.2">#</ci><cn id="A3.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="A3.SS2.p2.3.m3.1.1.3">9941</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.3.m3.1c">\#9941</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.3.m3.1d"># 9941</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F11" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>).
Additionally, some components appear to encode brand-specific information,
such as car logos (component <math alttext="\#9117" class="ltx_Math" display="inline" id="A3.SS2.p2.4.m4.1"><semantics id="A3.SS2.p2.4.m4.1a"><mrow id="A3.SS2.p2.4.m4.1.1" xref="A3.SS2.p2.4.m4.1.1.cmml"><mi id="A3.SS2.p2.4.m4.1.1.2" mathvariant="normal" xref="A3.SS2.p2.4.m4.1.1.2.cmml">#</mi><mo id="A3.SS2.p2.4.m4.1.1.1" xref="A3.SS2.p2.4.m4.1.1.1.cmml">⁢</mo><mn id="A3.SS2.p2.4.m4.1.1.3" xref="A3.SS2.p2.4.m4.1.1.3.cmml">9117</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.4.m4.1b"><apply id="A3.SS2.p2.4.m4.1.1.cmml" xref="A3.SS2.p2.4.m4.1.1"><times id="A3.SS2.p2.4.m4.1.1.1.cmml" xref="A3.SS2.p2.4.m4.1.1.1"></times><ci id="A3.SS2.p2.4.m4.1.1.2.cmml" xref="A3.SS2.p2.4.m4.1.1.2">#</ci><cn id="A3.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="A3.SS2.p2.4.m4.1.1.3">9117</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.4.m4.1c">\#9117</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.4.m4.1d"># 9117</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F11" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>) or electronic branding (component <math alttext="\#4968" class="ltx_Math" display="inline" id="A3.SS2.p2.5.m5.1"><semantics id="A3.SS2.p2.5.m5.1a"><mrow id="A3.SS2.p2.5.m5.1.1" xref="A3.SS2.p2.5.m5.1.1.cmml"><mi id="A3.SS2.p2.5.m5.1.1.2" mathvariant="normal" xref="A3.SS2.p2.5.m5.1.1.2.cmml">#</mi><mo id="A3.SS2.p2.5.m5.1.1.1" xref="A3.SS2.p2.5.m5.1.1.1.cmml">⁢</mo><mn id="A3.SS2.p2.5.m5.1.1.3" xref="A3.SS2.p2.5.m5.1.1.3.cmml">4968</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.5.m5.1b"><apply id="A3.SS2.p2.5.m5.1.1.cmml" xref="A3.SS2.p2.5.m5.1.1"><times id="A3.SS2.p2.5.m5.1.1.1.cmml" xref="A3.SS2.p2.5.m5.1.1.1"></times><ci id="A3.SS2.p2.5.m5.1.1.2.cmml" xref="A3.SS2.p2.5.m5.1.1.2">#</ci><cn id="A3.SS2.p2.5.m5.1.1.3.cmml" type="integer" xref="A3.SS2.p2.5.m5.1.1.3">4968</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.5.m5.1c">\#4968</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.5.m5.1d"># 4968</annotation></semantics></math> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A3.F10" title="In C.2 Finding unexpected components and concepts ‣ Appendix C Interpretability and diversity of SAE components ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>).</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Robustness analysis of CLIP</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">This section provides more details for experiments of <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS3" title="5.3 Robustness of CLIP to semantic ambiguity and spurious correlations (Q3) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.3</span></a>, where we benchmark CLIP’s robustness to spurious correlations, polysemous prompts, compound nouns, and visual typography.
We first applied approach <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S4.SS2" title="4.2 Revealing unexpected concept reliance ‣ 4 Method ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>b to the CLIP ViT-B/16 model to find outlier components, which were relevant on high-confidence samples, but were not expected to be relevant.</p>
</div>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Finding failure modes</h3>
<div class="ltx_para ltx_noindent" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">We conduct our analysis on a 20% subset of the ImageNet-1k training set, obtained by sampling every fifth image.
To identify potentially misleading SAE components, we first estimate their relevance distributions on class samples (approximately 200 per class), computing both mean and standard deviation of relevance scores.
Relevance scores are computed using <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A2.E29" title="In B.1 Approximation of activation times gradient ‣ Appendix B Latent component attributions ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">29</span></a> by explaining the cosine similarity between visual embedding and textual embedding for the full class label.
Next, we filter for samples (not belonging to the probed-for class) with high model output – specifically, those exceeding the class-specific mean output minus 1.5 standard deviations.
For these high-confidence samples, we compute relevance scores and flag components with a resulting <math alttext="z" class="ltx_Math" display="inline" id="A4.SS1.p1.1.m1.1"><semantics id="A4.SS1.p1.1.m1.1a"><mi id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><ci id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.1.m1.1d">italic_z</annotation></semantics></math>-score above 3.0 and at least 10 non-zero activations as potential failure cases.
These components are manually reviewed and incorporated into targeted test sets.</p>
</div>
<figure class="ltx_figure" id="A4.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="731" id="A4.F12.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Examples of sample sets where text-image probing led to false positives, corresponding to polysemous words or compound nouns. Each set contains high-confidence, highly activating samples for a flagged SAE component. The latent ID and the prompt class name are shown for each set.</figcaption>
</figure>
<figure class="ltx_figure" id="A4.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="731" id="A4.F13.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Examples of sample sets where text-image probing led to false positives, corresponding to visual typography or spurious correlations. Each set contains high-confidence, highly activating samples for a flagged SAE component. The latent ID and the prompt class name are shown for each set. Spurious correlations for components with ID above 30,000 correspond to spurious correlations found by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#bib.bib35" title="">35</a>]</cite>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS1.p2">
<p class="ltx_p" id="A4.SS1.p2.1">In total, we identify 76 polysemous failure modes, 78 compound noun cases, 21 related to visual typography, and 57 involving spurious correlations.
Representative examples from each category are shown: polysemous and compound noun cases in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4.F12" title="In D.1 Finding failure modes ‣ Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a>, and visual typography and spurious correlations in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4.F13" title="In D.1 Finding failure modes ‣ Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">13</span></a>, with 16 examples per set.</p>
</div>
<figure class="ltx_figure" id="A4.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="830" id="A4.F14.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>A detailed plot variant of <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F5" title="In 5.3 Robustness of CLIP to semantic ambiguity and spurious correlations (Q3) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> for the analysis of failure modes in text-image probing. We evaluate CLIP’s robustness to textual ambiguities and dataset artifacts across multiple model variants. Failure cases include polysemous words, compound nouns, typography in images, and spurious correlations. For each scenario, we assess the separability of true images from found distractors (“spurious AUC”) and from unrelated ImageNet classes (“valid AUC”).
We compare performance using both vanilla and enriched text prompts (e.g., via templating and detailed descriptions), and include linear classifiers trained on image embeddings as a baseline.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Evaluating failure modes</h3>
<div class="ltx_para ltx_noindent" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.1">We provide a detailed plot of <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.F5" title="In 5.3 Robustness of CLIP to semantic ambiguity and spurious correlations (Q3) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A4.F14" title="In D.1 Finding failure modes ‣ Appendix D Robustness analysis of CLIP ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">14</span></a>, where we also include the ViT-B/32 model trained on the DataComp-M dataset. We also display <span class="ltx_glossaryref" title="">SEM</span> values for each measurement point. The <span class="ltx_glossaryref" title="">SEM</span> is computed by assuming that the measured AUC scores are normally distributed.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS2.p2">
<p class="ltx_p" id="A4.SS2.p2.1">We evaluate text-image probing using three methods:
(1) the short ImageNet-1k class name (excluding text after a comma),
(2) the full class name with the mean textual embedding from three templates (“<span class="ltx_text ltx_font_typewriter" id="A4.SS2.p2.1.1">object</span>”, “an image of a <span class="ltx_text ltx_font_typewriter" id="A4.SS2.p2.1.2">object</span>”, and “a <span class="ltx_text ltx_font_typewriter" id="A4.SS2.p2.1.3">object</span>”),
and (3) linear regression classifiers trained on image embeddings from the test set.
For identified failure modes, we assess the ability to distinguish true class samples from spurious ones by computing AUROC scores on the model outputs (“spurious AUC”).
Additionally, we evaluate how well true class samples can be separated from all other non-class samples in the training set (“valid AUC”).
Ideally, both spurious and valid AUC scores are high.</p>
</div>
<figure class="ltx_table" id="A4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Investigating how better textual descriptions and templating effects failure modes detected in CLIP. We report the difference in spurious AUC scores (mean with <span class="ltx_glossaryref" title="">SEM</span>) across different failure case types and prompting variants</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T1.1.1.1.1" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T1.1.1.1.1.1">Failure Case</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T1.1.1.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T1.1.1.1.2.1">Templating</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T1.1.1.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T1.1.1.1.3.1">Extended Description</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T1.1.1.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T1.1.1.1.4.1">Both</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T1.1.2.1.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Polysemous words</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T1.1.2.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.020 ± 0.032</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T1.1.2.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.135 ± 0.028</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T1.1.2.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.151 ± 0.028</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T1.1.3.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Compound nouns</th>
<td class="ltx_td ltx_align_center" id="A4.T1.1.3.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">-0.001 ± 0.022</td>
<td class="ltx_td ltx_align_center" id="A4.T1.1.3.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.060 ± 0.020</td>
<td class="ltx_td ltx_align_center" id="A4.T1.1.3.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.055 ± 0.021</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T1.1.4.3.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Visual typography</th>
<td class="ltx_td ltx_align_center" id="A4.T1.1.4.3.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.063 ± 0.033</td>
<td class="ltx_td ltx_align_center" id="A4.T1.1.4.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.068 ± 0.038</td>
<td class="ltx_td ltx_align_center" id="A4.T1.1.4.3.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.117 ± 0.033</td>
</tr>
<tr class="ltx_tr" id="A4.T1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T1.1.5.4.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Spurious correlations</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T1.1.5.4.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">-0.002 ± 0.011</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T1.1.5.4.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">-0.001 ± 0.011</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T1.1.5.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">-0.005 ± 0.012</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS2.p3">
<p class="ltx_p" id="A4.SS2.p3.1">The influence of class name length and prompt templating on performance is shown in <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:app:tab:failure_case</span>.
We observe that extended class descriptions notably improve performance for polysemous terms and compound nouns.
Prompt templating yields a modest benefit only for visual typography cases, likely because longer prompts dilute the impact of short typographic artifacts by increasing the overall character count.
In contrast, spurious correlations appear largely unaffected by either class name length or templating.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Medical case study: melanoma detection</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">This section provides additional methodological details for the experiments described in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS4" title="5.4 Case study: spurious correlation analysis in melanoma detection (Q4) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.4</span></a>, where we evaluate WhyLesion-CLIP on the ISIC 2019 dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p2">
<p class="ltx_p" id="A5.p2.1">We construct a binary classification task by randomly selecting 80 % of melanoma samples (corresponding to 3,629 images) and 4,000 non-melanoma images to train linear classifiers (logistic regression models). These classifiers operate on the CLIP-derived visual embeddings.</p>
</div>
<section class="ltx_paragraph" id="A5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Image-level red hue augmentation</h4>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A5.SS0.SSS0.Px1.p1.1">To simulate the influence of red hue, we manipulate the red channel of input images. Let <span class="ltx_text ltx_font_typewriter" id="A5.SS0.SSS0.Px1.p1.1.1">red</span> <math alttext="\in[0,1]" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px1.p1.1.m1.2"><semantics id="A5.SS0.SSS0.Px1.p1.1.m1.2a"><mrow id="A5.SS0.SSS0.Px1.p1.1.m1.2.3" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.cmml"><mi id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.2" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.2.cmml"></mi><mo id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.1" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.2" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.1.cmml"><mo id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="A5.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">0</mn><mo id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.2.2" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A5.SS0.SSS0.Px1.p1.1.m1.2.2" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.2.cmml">1</mn><mo id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px1.p1.1.m1.2b"><apply id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.cmml" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3"><in id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.1.cmml" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.1"></in><csymbol cd="latexml" id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.2.cmml" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.2">absent</csymbol><interval closure="closed" id="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.1.cmml" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.3.3.2"><cn id="A5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="A5.SS0.SSS0.Px1.p1.1.m1.1.1">0</cn><cn id="A5.SS0.SSS0.Px1.p1.1.m1.2.2.cmml" type="integer" xref="A5.SS0.SSS0.Px1.p1.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px1.p1.1.m1.2c">\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px1.p1.1.m1.2d">∈ [ 0 , 1 ]</annotation></semantics></math> denote the red color channel of an image. We define the augmented red channel as:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\texttt{red}^{\prime}=\text{max}[\text{min}(\texttt{red}(1-\delta),1),0]~{}," class="ltx_Math" display="block" id="A5.E32.m1.3"><semantics id="A5.E32.m1.3a"><mrow id="A5.E32.m1.3.3.1" xref="A5.E32.m1.3.3.1.1.cmml"><mrow id="A5.E32.m1.3.3.1.1" xref="A5.E32.m1.3.3.1.1.cmml"><msup id="A5.E32.m1.3.3.1.1.3" xref="A5.E32.m1.3.3.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="A5.E32.m1.3.3.1.1.3.2" xref="A5.E32.m1.3.3.1.1.3.2a.cmml">red</mtext><mo id="A5.E32.m1.3.3.1.1.3.3" xref="A5.E32.m1.3.3.1.1.3.3.cmml">′</mo></msup><mo id="A5.E32.m1.3.3.1.1.2" xref="A5.E32.m1.3.3.1.1.2.cmml">=</mo><mrow id="A5.E32.m1.3.3.1.1.1" xref="A5.E32.m1.3.3.1.1.1.cmml"><mtext id="A5.E32.m1.3.3.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.3a.cmml">max</mtext><mo id="A5.E32.m1.3.3.1.1.1.2" xref="A5.E32.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.2.cmml"><mo id="A5.E32.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.2.cmml">[</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.cmml"><mtext id="A5.E32.m1.3.3.1.1.1.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.1.1.1.3a.cmml">min</mtext><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.2" xref="A5.E32.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3a.cmml">red</mtext><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">δ</mi></mrow><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mn id="A5.E32.m1.1.1" xref="A5.E32.m1.1.1.cmml">1</mn><mo id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A5.E32.m1.3.3.1.1.1.1.1.3" xref="A5.E32.m1.3.3.1.1.1.1.2.cmml">,</mo><mn id="A5.E32.m1.2.2" xref="A5.E32.m1.2.2.cmml">0</mn><mo id="A5.E32.m1.3.3.1.1.1.1.1.4" rspace="0.330em" stretchy="false" xref="A5.E32.m1.3.3.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="A5.E32.m1.3.3.1.2" xref="A5.E32.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E32.m1.3b"><apply id="A5.E32.m1.3.3.1.1.cmml" xref="A5.E32.m1.3.3.1"><eq id="A5.E32.m1.3.3.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.2"></eq><apply id="A5.E32.m1.3.3.1.1.3.cmml" xref="A5.E32.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A5.E32.m1.3.3.1.1.3.1.cmml" xref="A5.E32.m1.3.3.1.1.3">superscript</csymbol><ci id="A5.E32.m1.3.3.1.1.3.2a.cmml" xref="A5.E32.m1.3.3.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="A5.E32.m1.3.3.1.1.3.2.cmml" xref="A5.E32.m1.3.3.1.1.3.2">red</mtext></ci><ci id="A5.E32.m1.3.3.1.1.3.3.cmml" xref="A5.E32.m1.3.3.1.1.3.3">′</ci></apply><apply id="A5.E32.m1.3.3.1.1.1.cmml" xref="A5.E32.m1.3.3.1.1.1"><times id="A5.E32.m1.3.3.1.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.1.2"></times><ci id="A5.E32.m1.3.3.1.1.1.3a.cmml" xref="A5.E32.m1.3.3.1.1.1.3"><mtext id="A5.E32.m1.3.3.1.1.1.3.cmml" xref="A5.E32.m1.3.3.1.1.1.3">max</mtext></ci><interval closure="closed" id="A5.E32.m1.3.3.1.1.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1"><apply id="A5.E32.m1.3.3.1.1.1.1.1.1.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1"><times id="A5.E32.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.2"></times><ci id="A5.E32.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.3"><mtext id="A5.E32.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.3">min</mtext></ci><interval closure="open" id="A5.E32.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1"><apply id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><ci id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3a.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.3">red</mtext></ci><apply id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><minus id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E32.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛿</ci></apply></apply><cn id="A5.E32.m1.1.1.cmml" type="integer" xref="A5.E32.m1.1.1">1</cn></interval></apply><cn id="A5.E32.m1.2.2.cmml" type="integer" xref="A5.E32.m1.2.2">0</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E32.m1.3c">\texttt{red}^{\prime}=\text{max}[\text{min}(\texttt{red}(1-\delta),1),0]~{},</annotation><annotation encoding="application/x-llamapun" id="A5.E32.m1.3d">red start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = max [ min ( red ( 1 - italic_δ ) , 1 ) , 0 ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS0.SSS0.Px1.p1.4">where pixel values are clamped to remain within <math alttext="[0,1]" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px1.p1.2.m1.2"><semantics id="A5.SS0.SSS0.Px1.p1.2.m1.2a"><mrow id="A5.SS0.SSS0.Px1.p1.2.m1.2.3.2" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.3.1.cmml"><mo id="A5.SS0.SSS0.Px1.p1.2.m1.2.3.2.1" stretchy="false" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.3.1.cmml">[</mo><mn id="A5.SS0.SSS0.Px1.p1.2.m1.1.1" xref="A5.SS0.SSS0.Px1.p1.2.m1.1.1.cmml">0</mn><mo id="A5.SS0.SSS0.Px1.p1.2.m1.2.3.2.2" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.3.1.cmml">,</mo><mn id="A5.SS0.SSS0.Px1.p1.2.m1.2.2" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.2.cmml">1</mn><mo id="A5.SS0.SSS0.Px1.p1.2.m1.2.3.2.3" stretchy="false" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px1.p1.2.m1.2b"><interval closure="closed" id="A5.SS0.SSS0.Px1.p1.2.m1.2.3.1.cmml" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.3.2"><cn id="A5.SS0.SSS0.Px1.p1.2.m1.1.1.cmml" type="integer" xref="A5.SS0.SSS0.Px1.p1.2.m1.1.1">0</cn><cn id="A5.SS0.SSS0.Px1.p1.2.m1.2.2.cmml" type="integer" xref="A5.SS0.SSS0.Px1.p1.2.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px1.p1.2.m1.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px1.p1.2.m1.2d">[ 0 , 1 ]</annotation></semantics></math>. We apply <math alttext="\delta=-1.0" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px1.p1.3.m2.1"><semantics id="A5.SS0.SSS0.Px1.p1.3.m2.1a"><mrow id="A5.SS0.SSS0.Px1.p1.3.m2.1.1" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.cmml"><mi id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.2" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.2.cmml">δ</mi><mo id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.1" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.1.cmml">=</mo><mrow id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.cmml"><mo id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3a" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.cmml">−</mo><mn id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.2" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.2.cmml">1.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px1.p1.3.m2.1b"><apply id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.cmml" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1"><eq id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.1.cmml" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.1"></eq><ci id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.2.cmml" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.2">𝛿</ci><apply id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.cmml" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3"><minus id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.1.cmml" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3"></minus><cn id="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.2.cmml" type="float" xref="A5.SS0.SSS0.Px1.p1.3.m2.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px1.p1.3.m2.1c">\delta=-1.0</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px1.p1.3.m2.1d">italic_δ = - 1.0</annotation></semantics></math> to increase red hue and <math alttext="\delta=0.2" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px1.p1.4.m3.1"><semantics id="A5.SS0.SSS0.Px1.p1.4.m3.1a"><mrow id="A5.SS0.SSS0.Px1.p1.4.m3.1.1" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.cmml"><mi id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.2" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.2.cmml">δ</mi><mo id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.1" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.1.cmml">=</mo><mn id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.3" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px1.p1.4.m3.1b"><apply id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.cmml" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1"><eq id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.1.cmml" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.1"></eq><ci id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.2.cmml" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.2">𝛿</ci><cn id="A5.SS0.SSS0.Px1.p1.4.m3.1.1.3.cmml" type="float" xref="A5.SS0.SSS0.Px1.p1.4.m3.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px1.p1.4.m3.1c">\delta=0.2</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px1.p1.4.m3.1d">italic_δ = 0.2</annotation></semantics></math> to reduce it.</p>
</div>
<figure class="ltx_figure" id="A5.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="256" id="A5.F15.g1" src="x15.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Robustness analysis of linear classifiers trained on WhyLesion-CLIP visual embeddings for melanoma detection.
In addition to training standard (non-augmented) classifiers, we train robust models using latent space augmentations of varying strengths, controlled by the parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.F15.3.m1.1"><semantics id="A5.F15.3.m1.1b"><mi id="A5.F15.3.m1.1.1" xref="A5.F15.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.F15.3.m1.1c"><ci id="A5.F15.3.m1.1.1.cmml" xref="A5.F15.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F15.3.m1.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.F15.3.m1.1e">italic_α</annotation></semantics></math>. Results show that increasing <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.F15.4.m2.1"><semantics id="A5.F15.4.m2.1b"><mi id="A5.F15.4.m2.1.1" xref="A5.F15.4.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.F15.4.m2.1c"><ci id="A5.F15.4.m2.1.1.cmml" xref="A5.F15.4.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F15.4.m2.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.F15.4.m2.1e">italic_α</annotation></semantics></math> improves robustness, as performance degrades less under augmentation, indicating enhanced invariance to spurious red hue correlations.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Latent-level red hue augmentation</h4>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p1.6">To perturb embeddings in a semantically meaningful direction, we first estimate a “red hue” direction in latent space. We identify this direction by comparing two subsets of images using SAE component <math alttext="\#2703" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="A5.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="A5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.2" mathvariant="normal" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">#</mi><mo id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.1" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">⁢</mo><mn id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">2703</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1"><times id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.1"></times><ci id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.2">#</ci><cn id="A5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p1.1.m1.1.1.3">2703</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.1.m1.1c">\#2703</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.1.m1.1d"># 2703</annotation></semantics></math>, which is highly sensitive to red tones. Specifically,
(1) the low-red set includes non-melanoma samples where <math alttext="a_{2703}&lt;1.0" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="A5.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="A5.SS0.SSS0.Px2.p1.2.m2.1.1" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">a</mi><mn id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.3" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml">2703</mn></msub><mo id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1"><lt id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.1"></lt><apply id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2">𝑎</ci><cn id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.2.3">2703</cn></apply><cn id="A5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="A5.SS0.SSS0.Px2.p1.2.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.2.m2.1c">a_{2703}&lt;1.0</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT 2703 end_POSTSUBSCRIPT &lt; 1.0</annotation></semantics></math>,
and (2) high-red set includes non-melanoma samples where <math alttext="a_{2703}&gt;2.5" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="A5.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="A5.SS0.SSS0.Px2.p1.3.m3.1.1" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><msub id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml"><mi id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml">a</mi><mn id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml">2703</mn></msub><mo id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.1" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">2.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1"><gt id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.1"></gt><apply id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.1.cmml" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2">subscript</csymbol><ci id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2">𝑎</ci><cn id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3">2703</cn></apply><cn id="A5.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="A5.SS0.SSS0.Px2.p1.3.m3.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.3.m3.1c">a_{2703}&gt;2.5</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT 2703 end_POSTSUBSCRIPT &gt; 2.5</annotation></semantics></math>.
For reference, the mean activation of component <math alttext="\#2703" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="A5.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="A5.SS0.SSS0.Px2.p1.4.m4.1.1" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.2" mathvariant="normal" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml">#</mi><mo id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.1" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">⁢</mo><mn id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml">2703</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1"><times id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.1"></times><ci id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.2">#</ci><cn id="A5.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p1.4.m4.1.1.3">2703</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.4.m4.1c">\#2703</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.4.m4.1d"># 2703</annotation></semantics></math> is <math alttext="1.17" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.5.m5.1"><semantics id="A5.SS0.SSS0.Px2.p1.5.m5.1a"><mn id="A5.SS0.SSS0.Px2.p1.5.m5.1.1" xref="A5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">1.17</mn><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.5.m5.1b"><cn id="A5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" type="float" xref="A5.SS0.SSS0.Px2.p1.5.m5.1.1">1.17</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.5.m5.1c">1.17</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.5.m5.1d">1.17</annotation></semantics></math> with standard deviation <math alttext="0.65" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p1.6.m6.1"><semantics id="A5.SS0.SSS0.Px2.p1.6.m6.1a"><mn id="A5.SS0.SSS0.Px2.p1.6.m6.1.1" xref="A5.SS0.SSS0.Px2.p1.6.m6.1.1.cmml">0.65</mn><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p1.6.m6.1b"><cn id="A5.SS0.SSS0.Px2.p1.6.m6.1.1.cmml" type="float" xref="A5.SS0.SSS0.Px2.p1.6.m6.1.1">0.65</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p1.6.m6.1c">0.65</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p1.6.m6.1d">0.65</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p2.1">We compute the red-direction vector <math alttext="\boldsymbol{u}_{\text{red}}" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p2.1.m1.1"><semantics id="A5.SS0.SSS0.Px2.p2.1.m1.1a"><msub id="A5.SS0.SSS0.Px2.p2.1.m1.1.1" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.2" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml">𝒖</mi><mtext id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3a.cmml">red</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p2.1.m1.1b"><apply id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><ci id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.2">𝒖</ci><ci id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3a.cmml" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3"><mtext id="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="A5.SS0.SSS0.Px2.p2.1.m1.1.1.3">red</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p2.1.m1.1c">\boldsymbol{u}_{\text{red}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p2.1.m1.1d">bold_italic_u start_POSTSUBSCRIPT red end_POSTSUBSCRIPT</annotation></semantics></math> in latent space as the mean embedding difference:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{u}_{\text{red}}=\bar{\boldsymbol{x}}_{+}-\bar{\boldsymbol{x}}_{-}~%
{}," class="ltx_Math" display="block" id="A5.E33.m1.1"><semantics id="A5.E33.m1.1a"><mrow id="A5.E33.m1.1.1.1" xref="A5.E33.m1.1.1.1.1.cmml"><mrow id="A5.E33.m1.1.1.1.1" xref="A5.E33.m1.1.1.1.1.cmml"><msub id="A5.E33.m1.1.1.1.1.2" xref="A5.E33.m1.1.1.1.1.2.cmml"><mi id="A5.E33.m1.1.1.1.1.2.2" xref="A5.E33.m1.1.1.1.1.2.2.cmml">𝒖</mi><mtext id="A5.E33.m1.1.1.1.1.2.3" xref="A5.E33.m1.1.1.1.1.2.3a.cmml">red</mtext></msub><mo id="A5.E33.m1.1.1.1.1.1" xref="A5.E33.m1.1.1.1.1.1.cmml">=</mo><mrow id="A5.E33.m1.1.1.1.1.3" xref="A5.E33.m1.1.1.1.1.3.cmml"><msub id="A5.E33.m1.1.1.1.1.3.2" xref="A5.E33.m1.1.1.1.1.3.2.cmml"><mover accent="true" id="A5.E33.m1.1.1.1.1.3.2.2" xref="A5.E33.m1.1.1.1.1.3.2.2.cmml"><mi id="A5.E33.m1.1.1.1.1.3.2.2.2" xref="A5.E33.m1.1.1.1.1.3.2.2.2.cmml">𝒙</mi><mo id="A5.E33.m1.1.1.1.1.3.2.2.1" xref="A5.E33.m1.1.1.1.1.3.2.2.1.cmml">¯</mo></mover><mo id="A5.E33.m1.1.1.1.1.3.2.3" xref="A5.E33.m1.1.1.1.1.3.2.3.cmml">+</mo></msub><mo id="A5.E33.m1.1.1.1.1.3.1" xref="A5.E33.m1.1.1.1.1.3.1.cmml">−</mo><msub id="A5.E33.m1.1.1.1.1.3.3" xref="A5.E33.m1.1.1.1.1.3.3.cmml"><mover accent="true" id="A5.E33.m1.1.1.1.1.3.3.2" xref="A5.E33.m1.1.1.1.1.3.3.2.cmml"><mi id="A5.E33.m1.1.1.1.1.3.3.2.2" xref="A5.E33.m1.1.1.1.1.3.3.2.2.cmml">𝒙</mi><mo id="A5.E33.m1.1.1.1.1.3.3.2.1" xref="A5.E33.m1.1.1.1.1.3.3.2.1.cmml">¯</mo></mover><mo id="A5.E33.m1.1.1.1.1.3.3.3" xref="A5.E33.m1.1.1.1.1.3.3.3.cmml">−</mo></msub></mrow></mrow><mo id="A5.E33.m1.1.1.1.2" xref="A5.E33.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E33.m1.1b"><apply id="A5.E33.m1.1.1.1.1.cmml" xref="A5.E33.m1.1.1.1"><eq id="A5.E33.m1.1.1.1.1.1.cmml" xref="A5.E33.m1.1.1.1.1.1"></eq><apply id="A5.E33.m1.1.1.1.1.2.cmml" xref="A5.E33.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.E33.m1.1.1.1.1.2.1.cmml" xref="A5.E33.m1.1.1.1.1.2">subscript</csymbol><ci id="A5.E33.m1.1.1.1.1.2.2.cmml" xref="A5.E33.m1.1.1.1.1.2.2">𝒖</ci><ci id="A5.E33.m1.1.1.1.1.2.3a.cmml" xref="A5.E33.m1.1.1.1.1.2.3"><mtext id="A5.E33.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="A5.E33.m1.1.1.1.1.2.3">red</mtext></ci></apply><apply id="A5.E33.m1.1.1.1.1.3.cmml" xref="A5.E33.m1.1.1.1.1.3"><minus id="A5.E33.m1.1.1.1.1.3.1.cmml" xref="A5.E33.m1.1.1.1.1.3.1"></minus><apply id="A5.E33.m1.1.1.1.1.3.2.cmml" xref="A5.E33.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A5.E33.m1.1.1.1.1.3.2.1.cmml" xref="A5.E33.m1.1.1.1.1.3.2">subscript</csymbol><apply id="A5.E33.m1.1.1.1.1.3.2.2.cmml" xref="A5.E33.m1.1.1.1.1.3.2.2"><ci id="A5.E33.m1.1.1.1.1.3.2.2.1.cmml" xref="A5.E33.m1.1.1.1.1.3.2.2.1">¯</ci><ci id="A5.E33.m1.1.1.1.1.3.2.2.2.cmml" xref="A5.E33.m1.1.1.1.1.3.2.2.2">𝒙</ci></apply><plus id="A5.E33.m1.1.1.1.1.3.2.3.cmml" xref="A5.E33.m1.1.1.1.1.3.2.3"></plus></apply><apply id="A5.E33.m1.1.1.1.1.3.3.cmml" xref="A5.E33.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A5.E33.m1.1.1.1.1.3.3.1.cmml" xref="A5.E33.m1.1.1.1.1.3.3">subscript</csymbol><apply id="A5.E33.m1.1.1.1.1.3.3.2.cmml" xref="A5.E33.m1.1.1.1.1.3.3.2"><ci id="A5.E33.m1.1.1.1.1.3.3.2.1.cmml" xref="A5.E33.m1.1.1.1.1.3.3.2.1">¯</ci><ci id="A5.E33.m1.1.1.1.1.3.3.2.2.cmml" xref="A5.E33.m1.1.1.1.1.3.3.2.2">𝒙</ci></apply><minus id="A5.E33.m1.1.1.1.1.3.3.3.cmml" xref="A5.E33.m1.1.1.1.1.3.3.3"></minus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E33.m1.1c">\boldsymbol{u}_{\text{red}}=\bar{\boldsymbol{x}}_{+}-\bar{\boldsymbol{x}}_{-}~%
{},</annotation><annotation encoding="application/x-llamapun" id="A5.E33.m1.1d">bold_italic_u start_POSTSUBSCRIPT red end_POSTSUBSCRIPT = over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT + end_POSTSUBSCRIPT - over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p2.3">where <math alttext="\bar{\boldsymbol{x}}_{+}" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p2.2.m1.1"><semantics id="A5.SS0.SSS0.Px2.p2.2.m1.1a"><msub id="A5.SS0.SSS0.Px2.p2.2.m1.1.1" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.cmml"><mover accent="true" id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.cmml"><mi id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.2" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.2.cmml">𝒙</mi><mo id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.1" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.1.cmml">¯</mo></mover><mo id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.3" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p2.2.m1.1b"><apply id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1">subscript</csymbol><apply id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2"><ci id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.1.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.1">¯</ci><ci id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.2.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.2.2">𝒙</ci></apply><plus id="A5.SS0.SSS0.Px2.p2.2.m1.1.1.3.cmml" xref="A5.SS0.SSS0.Px2.p2.2.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p2.2.m1.1c">\bar{\boldsymbol{x}}_{+}</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p2.2.m1.1d">over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT + end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bar{\boldsymbol{x}}_{-}" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p2.3.m2.1"><semantics id="A5.SS0.SSS0.Px2.p2.3.m2.1a"><msub id="A5.SS0.SSS0.Px2.p2.3.m2.1.1" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.cmml"><mover accent="true" id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.cmml"><mi id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.2" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.2.cmml">𝒙</mi><mo id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.1" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.1.cmml">¯</mo></mover><mo id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.3" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.3.cmml">−</mo></msub><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p2.3.m2.1b"><apply id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1"><csymbol cd="ambiguous" id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1">subscript</csymbol><apply id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2"><ci id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.1.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.1">¯</ci><ci id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.2.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.2.2">𝒙</ci></apply><minus id="A5.SS0.SSS0.Px2.p2.3.m2.1.1.3.cmml" xref="A5.SS0.SSS0.Px2.p2.3.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p2.3.m2.1c">\bar{\boldsymbol{x}}_{-}</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p2.3.m2.1d">over¯ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT - end_POSTSUBSCRIPT</annotation></semantics></math> denote the average latent embeddings of the high-red and low-red sets, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px2.p3">
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p3.2">To apply this augmentation, we sample a scalar <math alttext="p\sim\mathcal{U}(0,1)" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.1.m1.2"><semantics id="A5.SS0.SSS0.Px2.p3.1.m1.2a"><mrow id="A5.SS0.SSS0.Px2.p3.1.m1.2.3" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.cmml"><mi id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.2" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.2.cmml">p</mi><mo id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.1" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.1.cmml">∼</mo><mrow id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.2" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.2.cmml">𝒰</mi><mo id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.1" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.2" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.1.cmml"><mo id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.2.1" stretchy="false" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.1.cmml">(</mo><mn id="A5.SS0.SSS0.Px2.p3.1.m1.1.1" xref="A5.SS0.SSS0.Px2.p3.1.m1.1.1.cmml">0</mn><mo id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.2.2" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.1.cmml">,</mo><mn id="A5.SS0.SSS0.Px2.p3.1.m1.2.2" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.2.cmml">1</mn><mo id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.2.3" stretchy="false" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.1.m1.2b"><apply id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3"><csymbol cd="latexml" id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.1.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.1">similar-to</csymbol><ci id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.2.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.2">𝑝</ci><apply id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3"><times id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.1.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.1"></times><ci id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.2.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.2">𝒰</ci><interval closure="open" id="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.1.cmml" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.3.3.3.2"><cn id="A5.SS0.SSS0.Px2.p3.1.m1.1.1.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p3.1.m1.1.1">0</cn><cn id="A5.SS0.SSS0.Px2.p3.1.m1.2.2.cmml" type="integer" xref="A5.SS0.SSS0.Px2.p3.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.1.m1.2c">p\sim\mathcal{U}(0,1)</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.1.m1.2d">italic_p ∼ caligraphic_U ( 0 , 1 )</annotation></semantics></math> and modify the original latent embedding <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.2.m2.1"><semantics id="A5.SS0.SSS0.Px2.p3.2.m2.1a"><mi id="A5.SS0.SSS0.Px2.p3.2.m2.1.1" xref="A5.SS0.SSS0.Px2.p3.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.2.m2.1b"><ci id="A5.SS0.SSS0.Px2.p3.2.m2.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.2.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.2.m2.1d">bold_italic_x</annotation></semantics></math> as:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{x}^{\prime}=\boldsymbol{x}+\alpha(p-0.5)\boldsymbol{u}_{\text{red}}," class="ltx_Math" display="block" id="A5.E34.m1.1"><semantics id="A5.E34.m1.1a"><mrow id="A5.E34.m1.1.1.1" xref="A5.E34.m1.1.1.1.1.cmml"><mrow id="A5.E34.m1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.cmml"><msup id="A5.E34.m1.1.1.1.1.3" xref="A5.E34.m1.1.1.1.1.3.cmml"><mi id="A5.E34.m1.1.1.1.1.3.2" xref="A5.E34.m1.1.1.1.1.3.2.cmml">𝒙</mi><mo id="A5.E34.m1.1.1.1.1.3.3" xref="A5.E34.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="A5.E34.m1.1.1.1.1.2" xref="A5.E34.m1.1.1.1.1.2.cmml">=</mo><mrow id="A5.E34.m1.1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.1.cmml"><mi id="A5.E34.m1.1.1.1.1.1.3" xref="A5.E34.m1.1.1.1.1.1.3.cmml">𝒙</mi><mo id="A5.E34.m1.1.1.1.1.1.2" xref="A5.E34.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="A5.E34.m1.1.1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.1.1.cmml"><mi id="A5.E34.m1.1.1.1.1.1.1.3" xref="A5.E34.m1.1.1.1.1.1.1.3.cmml">α</mi><mo id="A5.E34.m1.1.1.1.1.1.1.2" xref="A5.E34.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A5.E34.m1.1.1.1.1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E34.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.E34.m1.1.1.1.1.1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A5.E34.m1.1.1.1.1.1.1.1.1.1.2" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="A5.E34.m1.1.1.1.1.1.1.1.1.1.1" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="A5.E34.m1.1.1.1.1.1.1.1.1.1.3" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.3.cmml">0.5</mn></mrow><mo id="A5.E34.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A5.E34.m1.1.1.1.1.1.1.2a" xref="A5.E34.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A5.E34.m1.1.1.1.1.1.1.4" xref="A5.E34.m1.1.1.1.1.1.1.4.cmml"><mi id="A5.E34.m1.1.1.1.1.1.1.4.2" xref="A5.E34.m1.1.1.1.1.1.1.4.2.cmml">𝒖</mi><mtext id="A5.E34.m1.1.1.1.1.1.1.4.3" xref="A5.E34.m1.1.1.1.1.1.1.4.3a.cmml">red</mtext></msub></mrow></mrow></mrow><mo id="A5.E34.m1.1.1.1.2" xref="A5.E34.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.E34.m1.1b"><apply id="A5.E34.m1.1.1.1.1.cmml" xref="A5.E34.m1.1.1.1"><eq id="A5.E34.m1.1.1.1.1.2.cmml" xref="A5.E34.m1.1.1.1.1.2"></eq><apply id="A5.E34.m1.1.1.1.1.3.cmml" xref="A5.E34.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E34.m1.1.1.1.1.3.1.cmml" xref="A5.E34.m1.1.1.1.1.3">superscript</csymbol><ci id="A5.E34.m1.1.1.1.1.3.2.cmml" xref="A5.E34.m1.1.1.1.1.3.2">𝒙</ci><ci id="A5.E34.m1.1.1.1.1.3.3.cmml" xref="A5.E34.m1.1.1.1.1.3.3">′</ci></apply><apply id="A5.E34.m1.1.1.1.1.1.cmml" xref="A5.E34.m1.1.1.1.1.1"><plus id="A5.E34.m1.1.1.1.1.1.2.cmml" xref="A5.E34.m1.1.1.1.1.1.2"></plus><ci id="A5.E34.m1.1.1.1.1.1.3.cmml" xref="A5.E34.m1.1.1.1.1.1.3">𝒙</ci><apply id="A5.E34.m1.1.1.1.1.1.1.cmml" xref="A5.E34.m1.1.1.1.1.1.1"><times id="A5.E34.m1.1.1.1.1.1.1.2.cmml" xref="A5.E34.m1.1.1.1.1.1.1.2"></times><ci id="A5.E34.m1.1.1.1.1.1.1.3.cmml" xref="A5.E34.m1.1.1.1.1.1.1.3">𝛼</ci><apply id="A5.E34.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E34.m1.1.1.1.1.1.1.1.1"><minus id="A5.E34.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A5.E34.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><cn id="A5.E34.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="float" xref="A5.E34.m1.1.1.1.1.1.1.1.1.1.3">0.5</cn></apply><apply id="A5.E34.m1.1.1.1.1.1.1.4.cmml" xref="A5.E34.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A5.E34.m1.1.1.1.1.1.1.4.1.cmml" xref="A5.E34.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A5.E34.m1.1.1.1.1.1.1.4.2.cmml" xref="A5.E34.m1.1.1.1.1.1.1.4.2">𝒖</ci><ci id="A5.E34.m1.1.1.1.1.1.1.4.3a.cmml" xref="A5.E34.m1.1.1.1.1.1.1.4.3"><mtext id="A5.E34.m1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="A5.E34.m1.1.1.1.1.1.1.4.3">red</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E34.m1.1c">\boldsymbol{x}^{\prime}=\boldsymbol{x}+\alpha(p-0.5)\boldsymbol{u}_{\text{red}},</annotation><annotation encoding="application/x-llamapun" id="A5.E34.m1.1d">bold_italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_italic_x + italic_α ( italic_p - 0.5 ) bold_italic_u start_POSTSUBSCRIPT red end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p3.6">where <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.3.m1.1"><semantics id="A5.SS0.SSS0.Px2.p3.3.m1.1a"><mi id="A5.SS0.SSS0.Px2.p3.3.m1.1.1" xref="A5.SS0.SSS0.Px2.p3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.3.m1.1b"><ci id="A5.SS0.SSS0.Px2.p3.3.m1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.3.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.3.m1.1d">italic_α</annotation></semantics></math> is a scaling parameter.
In the main experiment reported in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#S5.SS4" title="5.4 Case study: spurious correlation analysis in melanoma detection (Q4) ‣ 5 Experiments ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5.4</span></a>, we set <math alttext="\alpha=0.5" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.4.m2.1"><semantics id="A5.SS0.SSS0.Px2.p3.4.m2.1a"><mrow id="A5.SS0.SSS0.Px2.p3.4.m2.1.1" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.cmml"><mi id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.2" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.2.cmml">α</mi><mo id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.1" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.1.cmml">=</mo><mn id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.3" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.4.m2.1b"><apply id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1"><eq id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.1"></eq><ci id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.2.cmml" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.2">𝛼</ci><cn id="A5.SS0.SSS0.Px2.p3.4.m2.1.1.3.cmml" type="float" xref="A5.SS0.SSS0.Px2.p3.4.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.4.m2.1c">\alpha=0.5</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.4.m2.1d">italic_α = 0.5</annotation></semantics></math>.
Results for alternative values of <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.5.m3.1"><semantics id="A5.SS0.SSS0.Px2.p3.5.m3.1a"><mi id="A5.SS0.SSS0.Px2.p3.5.m3.1.1" xref="A5.SS0.SSS0.Px2.p3.5.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.5.m3.1b"><ci id="A5.SS0.SSS0.Px2.p3.5.m3.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.5.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.5.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.5.m3.1d">italic_α</annotation></semantics></math> are presented in <a class="ltx_ref" href="https://arxiv.org/html/2505.20229v1#A5.F15" title="In Image-level red hue augmentation ‣ Appendix E Medical case study: melanoma detection ‣ From What to How: Attributing CLIP’s Latent Components Reveals Unexpected Semantic Reliance"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">15</span></a>.
The plot shows,
that the larger <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS0.SSS0.Px2.p3.6.m4.1"><semantics id="A5.SS0.SSS0.Px2.p3.6.m4.1a"><mi id="A5.SS0.SSS0.Px2.p3.6.m4.1.1" xref="A5.SS0.SSS0.Px2.p3.6.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS0.SSS0.Px2.p3.6.m4.1b"><ci id="A5.SS0.SSS0.Px2.p3.6.m4.1.1.cmml" xref="A5.SS0.SSS0.Px2.p3.6.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS0.SSS0.Px2.p3.6.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS0.SSS0.Px2.p3.6.m4.1d">italic_α</annotation></semantics></math>, the less effected is the performance (subset accuracy) by the input augmentation.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon May 26 17:06:09 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
