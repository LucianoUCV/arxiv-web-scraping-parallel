<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Proxy-Free GFlowNet</title>
<!--Generated on Mon May 26 13:59:22 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2505.20110v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S1" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.SS1" title="In 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>GFlowNets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.SS2" title="In 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Maximum causal entropy IRL</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.SS1" title="In 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Edge rewards extraction via IRL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.SS2" title="In 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Reward-guided pruning and prioritized backward sampling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS1" title="In 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Hypergrid</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS1.SSS0.Px1" title="In 4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Robustness to Dataset Uncertainty</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS1.SSS0.Px2" title="In 4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Robustness to Behavior Policy Quality</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS2" title="In 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Biosequence Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS3" title="In 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Molecule Design</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S5" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A1" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Algorithm Pseudocode</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A2" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Related works</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A2.SS0.SSS0.Px1" title="In Appendix B Related works ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Generative Flow Networks (GFlowNets).</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A2.SS0.SSS0.Px2" title="In Appendix B Related works ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Inverse Reinforcement Learning (IRL).</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experimental details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.SS1" title="In Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Hypergrid</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.SS2" title="In Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Biosequence Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.SS3" title="In Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Molecule Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.SS4" title="In Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Policy Model Architectures and Hyperparameters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional experimental results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS1" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Algorithm trained on extremely limited data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS2" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Algorithm Visualization on Hypergrid</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS3" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Time consumption and resource usage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS4" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS4.SSS0.Px1" title="In D.4 Ablation Study ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Dataset Rebalancing.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS4.SSS0.Px2" title="In D.4 Ablation Study ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Pruning and Backward Sampling.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS5" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.5 </span>Orthogonality to Training Paradigms</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS5.SSS0.Px1" title="In D.5 Orthogonality to Training Paradigms ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Replacing Flow Matching with Offline RL Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS5.SSS0.Px2" title="In D.5 Orthogonality to Training Paradigms ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title">Incorporating Quantile Matching</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS6" title="In Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.6 </span>Discussion on Baseline Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A5" title="In Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Future Directions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Proxy-Free GFlowNet</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruishuo Chen 
<br class="ltx_break"/>School of Mathematics
<br class="ltx_break"/>Nanjing University
<br class="ltx_break"/>Nanjing, China
<br class="ltx_break"/>&amp;Xun Wang 
<br class="ltx_break"/>IIIS
<br class="ltx_break"/>Tsinghua University
<br class="ltx_break"/>Beijing, China
<br class="ltx_break"/>&amp;Rui Hu 
<br class="ltx_break"/>IIIS
<br class="ltx_break"/>Tsinghua University
<br class="ltx_break"/>Beijing, China
<br class="ltx_break"/>Zhuoran Li 
<br class="ltx_break"/>IIIS
<br class="ltx_break"/>Tsinghua University
<br class="ltx_break"/>Beijing, China
<br class="ltx_break"/>&amp;Longbo Huang 
<br class="ltx_break"/>IIIS
<br class="ltx_break"/>Tsinghua University
<br class="ltx_break"/>Beijing, China
<br class="ltx_break"/>
</span><span class="ltx_author_notes">This work was done during a visit to IIIS, Tsinghua University.Corresponding author. Correspondence to: longbohuang@tsinghua.edu.cn</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Generative Flow Networks (GFlowNets) are a promising class of generative models designed to sample diverse, high-reward structures by modeling distributions over compositional objects. In many real-world applications, obtaining the reward function for such objects is expensive, time-consuming, or requires human input, making it necessary to train GFlowNets from historical datasets. Most existing methods adopt a model-based approach, learning a proxy model from the dataset to approximate the reward function. However, this strategy inherently ties the quality of the learned policy to the accuracy of the proxy, introducing additional complexity and uncertainty into the training process. To overcome these limitations, we propose <span class="ltx_text ltx_font_bold" id="id1.id1.1">Trajectory-Distilled GFlowNet (TD-GFN)</span>, a <em class="ltx_emph ltx_font_italic" id="id1.id1.2">proxy-free</em> training framework that eliminates the need for out-of-dataset reward queries. Our method is motivated by the key observation that different edges in the associated directed acyclic graph (DAG) contribute unequally to effective policy learning. TD-GFN leverages inverse reinforcement learning to estimate edge-level rewards from the offline dataset, which are then used to ingeniously prune the DAG and guide backward trajectory sampling during training. This approach directs the policy toward high-reward regions while reducing the complexity of model fitting. Empirical results across multiple tasks show that TD-GFN trains both efficiently and reliably, significantly outperforming existing baselines in convergence speed and sample quality.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Generative Flow Networks (GFlowNets or GFNs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib2" title="">2</a>]</cite> are generative models designed to sample compositional objects in proportion to their positive rewards, and have shown strong empirical success across diverse domains including molecule discovery <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>, biological sequence design <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>]</cite>, combinatorial optimization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib4" title="">4</a>]</cite>, fine-tuning of large language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib5" title="">5</a>]</cite> and diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the promising potential of GFlowNets, interacting with the environment to obtain reward feedback for policy updates is often impractical or infeasible in real-world applications—such as biological and chemical tasks involving costly experiments or simulations, or tasks requiring human evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib7" title="">7</a>]</cite>. As a result, learning GFlowNets from historically collected datasets becomes essential.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Current approaches typically adopt a model-based strategy, wherein a proxy model is trained on the dataset to approximate the reward signal from the environment for updating the policy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib10" title="">10</a>]</cite>.
However, reliance on such proxy reward models imposes a fundamental limitation on the performance of the learned policies, as their effectiveness is inherently constrained by the accuracy of the reward approximation. Inaccuracies or biases in the proxy model inevitably propagate through the learning pipeline, potentially resulting in suboptimal or misleading policies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib13" title="">13</a>]</cite>. This challenge is particularly pronounced in domains such as language modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib15" title="">15</a>]</cite>, recommendation systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib16" title="">16</a>]</cite>, and autonomous driving <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib17" title="">17</a>]</cite>, where surrogate reward models often struggle to generalize beyond the distribution of their training data. Furthermore, constructing a high-quality reward model typically demands a large and diverse dataset, along with substantial domain-specific expertise—both of which are resource-intensive <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib20" title="">20</a>]</cite>. Consequently, dependence on proxy reward models introduces considerable burden, complexity, and uncertainty into the training process, ultimately undermining the reliability and scalability of the overall algorithm.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The limitations of existing training methods naturally give rise to the following question:</p>
<p class="ltx_p ltx_align_center" id="S1.p4.2"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p4.2.1">Can we train GFlowNets effectively and efficiently without a proxy reward model?</span></p>
<p class="ltx_p" id="S1.p4.3">The absence of a proxy reward model implies that out-of-distribution feedback is unavailable during training—posing a significant challenge for GFlowNets, whose objectives inherently require broad coverage of the state space. Consequently, an effective training framework must fully leverage the available historical data, while also generalizing strategically to sufficiently broad unseen regions of the state space, in order to achieve a stronger balance between exploration and exploitation.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Several recent efforts have attempted to address this challenge. An early approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib21" title="">21</a>]</cite> uses offline action probabilities to constrain the learned policy, while COFlowNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>]</cite> penalizes flow on unseen edges to limit policy coverage to dataset-adjacent regions. Both methods aim to improve policy reliability by imposing coarse constraints that merely align policy behavior or coverage more closely with the dataset. However, such constraints impose blunt limitations that hinder generalization beyond the dataset and make performance highly sensitive to data quality and coverage, as they fail to fully exploit the trajectory-level information contained in the dataset. Additionally, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib23" title="">23</a>]</cite> explores an “offline” setting with backward sampling from terminal states, but primarily focuses on evaluating sampling strategies rather than proposing a concrete training framework.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.4">To address these challenges, we begin with a key insight: different edges in the environment’s directed acyclic graph (DAG) contribute <em class="ltx_emph ltx_font_italic" id="S1.p6.4.1">unequally</em> to effective GFlowNet training. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>(a), removing the red edge <math alttext="(n_{1}\rightarrow n_{2})" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mrow id="S1.p6.1.m1.1.1.1" xref="S1.p6.1.m1.1.1.1.1.cmml"><mo id="S1.p6.1.m1.1.1.1.2" stretchy="false" xref="S1.p6.1.m1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.1.m1.1.1.1.1" xref="S1.p6.1.m1.1.1.1.1.cmml"><msub id="S1.p6.1.m1.1.1.1.1.2" xref="S1.p6.1.m1.1.1.1.1.2.cmml"><mi id="S1.p6.1.m1.1.1.1.1.2.2" xref="S1.p6.1.m1.1.1.1.1.2.2.cmml">n</mi><mn id="S1.p6.1.m1.1.1.1.1.2.3" xref="S1.p6.1.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S1.p6.1.m1.1.1.1.1.1" stretchy="false" xref="S1.p6.1.m1.1.1.1.1.1.cmml">→</mo><msub id="S1.p6.1.m1.1.1.1.1.3" xref="S1.p6.1.m1.1.1.1.1.3.cmml"><mi id="S1.p6.1.m1.1.1.1.1.3.2" xref="S1.p6.1.m1.1.1.1.1.3.2.cmml">n</mi><mn id="S1.p6.1.m1.1.1.1.1.3.3" xref="S1.p6.1.m1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S1.p6.1.m1.1.1.1.3" stretchy="false" xref="S1.p6.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1"><ci id="S1.p6.1.m1.1.1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1.1.1">→</ci><apply id="S1.p6.1.m1.1.1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.p6.1.m1.1.1.1.1.2.1.cmml" xref="S1.p6.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S1.p6.1.m1.1.1.1.1.2.2.cmml" xref="S1.p6.1.m1.1.1.1.1.2.2">𝑛</ci><cn id="S1.p6.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="S1.p6.1.m1.1.1.1.1.2.3">1</cn></apply><apply id="S1.p6.1.m1.1.1.1.1.3.cmml" xref="S1.p6.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.p6.1.m1.1.1.1.1.3.1.cmml" xref="S1.p6.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S1.p6.1.m1.1.1.1.1.3.2.cmml" xref="S1.p6.1.m1.1.1.1.1.3.2">𝑛</ci><cn id="S1.p6.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S1.p6.1.m1.1.1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">(n_{1}\rightarrow n_{2})</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT → italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> blocks access to a terminal node with reward <math alttext="20" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><mn id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><cn id="S1.p6.2.m2.1.1.cmml" type="integer" xref="S1.p6.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">20</annotation></semantics></math>, while removing the green edge <math alttext="(n_{4}\rightarrow n_{7})" class="ltx_Math" display="inline" id="S1.p6.3.m3.1"><semantics id="S1.p6.3.m3.1a"><mrow id="S1.p6.3.m3.1.1.1" xref="S1.p6.3.m3.1.1.1.1.cmml"><mo id="S1.p6.3.m3.1.1.1.2" stretchy="false" xref="S1.p6.3.m3.1.1.1.1.cmml">(</mo><mrow id="S1.p6.3.m3.1.1.1.1" xref="S1.p6.3.m3.1.1.1.1.cmml"><msub id="S1.p6.3.m3.1.1.1.1.2" xref="S1.p6.3.m3.1.1.1.1.2.cmml"><mi id="S1.p6.3.m3.1.1.1.1.2.2" xref="S1.p6.3.m3.1.1.1.1.2.2.cmml">n</mi><mn id="S1.p6.3.m3.1.1.1.1.2.3" xref="S1.p6.3.m3.1.1.1.1.2.3.cmml">4</mn></msub><mo id="S1.p6.3.m3.1.1.1.1.1" stretchy="false" xref="S1.p6.3.m3.1.1.1.1.1.cmml">→</mo><msub id="S1.p6.3.m3.1.1.1.1.3" xref="S1.p6.3.m3.1.1.1.1.3.cmml"><mi id="S1.p6.3.m3.1.1.1.1.3.2" xref="S1.p6.3.m3.1.1.1.1.3.2.cmml">n</mi><mn id="S1.p6.3.m3.1.1.1.1.3.3" xref="S1.p6.3.m3.1.1.1.1.3.3.cmml">7</mn></msub></mrow><mo id="S1.p6.3.m3.1.1.1.3" stretchy="false" xref="S1.p6.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.3.m3.1b"><apply id="S1.p6.3.m3.1.1.1.1.cmml" xref="S1.p6.3.m3.1.1.1"><ci id="S1.p6.3.m3.1.1.1.1.1.cmml" xref="S1.p6.3.m3.1.1.1.1.1">→</ci><apply id="S1.p6.3.m3.1.1.1.1.2.cmml" xref="S1.p6.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.p6.3.m3.1.1.1.1.2.1.cmml" xref="S1.p6.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S1.p6.3.m3.1.1.1.1.2.2.cmml" xref="S1.p6.3.m3.1.1.1.1.2.2">𝑛</ci><cn id="S1.p6.3.m3.1.1.1.1.2.3.cmml" type="integer" xref="S1.p6.3.m3.1.1.1.1.2.3">4</cn></apply><apply id="S1.p6.3.m3.1.1.1.1.3.cmml" xref="S1.p6.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.p6.3.m3.1.1.1.1.3.1.cmml" xref="S1.p6.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S1.p6.3.m3.1.1.1.1.3.2.cmml" xref="S1.p6.3.m3.1.1.1.1.3.2">𝑛</ci><cn id="S1.p6.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S1.p6.3.m3.1.1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.m3.1c">(n_{4}\rightarrow n_{7})</annotation><annotation encoding="application/x-llamapun" id="S1.p6.3.m3.1d">( italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT → italic_n start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT )</annotation></semantics></math> only affects a low-reward node (<math alttext="0.1" class="ltx_Math" display="inline" id="S1.p6.4.m4.1"><semantics id="S1.p6.4.m4.1a"><mn id="S1.p6.4.m4.1.1" xref="S1.p6.4.m4.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S1.p6.4.m4.1b"><cn id="S1.p6.4.m4.1.1.cmml" type="float" xref="S1.p6.4.m4.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.m4.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S1.p6.4.m4.1d">0.1</annotation></semantics></math>). This disparity underscores the varying importance of edges in learning the target distribution (Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>(b)), which can in turn be leveraged to guide the policy in selectively exploring unseen regions (Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>(c)).</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S1.F1.g1" src="x1.png" width="763"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
Illustration of our motivation. All subfigures depict an environment DAG, where solid edges represent transitions observed in the dataset and dashed edges indicate unobserved transitions. Reward values are annotated next to the terminal states.
(a) Different edges contribute unequally to the final learned distribution.
(b) Edge contributions as inferred by TD-GFN.
(c) Selective exploration guided by the learned edge contributions.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Motivated by this insight, we propose a novel <em class="ltx_emph ltx_font_italic" id="S1.p7.1.1">proxy-free</em> GFlowNet training framework, <span class="ltx_text ltx_font_bold" id="S1.p7.1.2">Trajectory-Distilled GFlowNet (TD-GFN)</span>, which eliminates reliance on proxy models by avoiding out-of-distribution reward queries.
Unlike prior methods that primarily differentiate behaviors based on their proximity to the dataset, TD-GFN provides more informative supervision by capturing the varying importance of transitions across the environment DAG, thereby
enabling a more effective exploration–exploitation trade-off.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">Specifically, TD-GFN introduces a novel <em class="ltx_emph ltx_font_italic" id="S1.p8.1.1">edge reward function</em> that quantifies the contribution of each transition in the environment DAG. This function is inferred via inverse reinforcement learning (IRL) from a carefully rebalanced offline dataset, leveraging the theoretical equivalence between GFlowNet training and entropy-regularized reinforcement learning (RL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib24" title="">24</a>]</cite>. The structured supervision provided by the resulting edge rewards enables the policy to generalize strategically beyond observed trajectories, rather than remain confined to dataset-supported regions.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">To mitigate the sensitivity to function approximation errors introduced by directly incorporating edge rewards into the training objective—an issue analogous to the limitations observed with proxy reward models—we propose two indirect mechanisms for shaping the GFlowNet policy.
First, we prune the environment DAG by removing low-utility transitions as determined by the learned edge rewards. This yields a more compact yet expressive action space that prioritizes structurally informative and high-reward trajectories, while reducing the complexity of model fitting.
Second, we introduce a prioritized backward sampling procedure over the pruned DAG, which reinforces the core inductive bias of GFlowNets—allocating attention in proportion to reward—while improving training efficiency by focusing updates on high-value regions of the state space.</p>
</div>
<div class="ltx_para" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">Equipped with these novel components, TD-GFN exhibits strong empirical performance across diverse benchmark tasks. Compared to a broad range of baselines, including proxy-based GFlowNet training paradigms, TD-GFN consistently achieves superior performance and faster convergence, underscoring its potential as a more stable and reliable alternative for efficient GFlowNet training.</p>
</div>
<div class="ltx_para" id="S1.p11">
<p class="ltx_p" id="S1.p11.1">In summary, we introduce <span class="ltx_text ltx_font_bold" id="S1.p11.1.1">Trajectory-Distilled GFlowNet (TD-GFN)</span>, a novel proxy-free training framework that eliminates the need for proxy reward queries on out-of-distribution objects by extracting structural supervision from existing data. The key contributions of TD-GFN are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">TD-GFN employs inverse reinforcement learning to infer edge-level rewards from a rebalanced offline dataset, capturing the relative importance of transitions within the environment DAG. These edge rewards provide structured, transition-level supervision that enables the policy to generalize beyond the dataset while remaining grounded in reliable behavior.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Leveraging the inferred edge rewards, TD-GFN prunes low-utility transitions from the environment DAG and introduces a prioritized backward sampling procedure guided by both edge and terminal rewards. This approach concentrates learning on informative regions of the state space and enhances training efficiency by reducing the complexity of model fitting.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">TD-GFN consistently demonstrates strong empirical performance across diverse benchmark tasks, outperforming a wide range of baselines in both convergence speed and final policy quality. These results highlight its effectiveness as a stable and efficient training paradigm within the GFlowNet framework.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we describe Generative Flow Networks (GFlowNets or GFNs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib2" title="">2</a>]</cite> and the maximum causal entropy inverse reinforcement learning (IRL) framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib26" title="">26</a>]</cite>, which help clarify our proposed method. Additional related works are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A2" title="Appendix B Related works ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">B</span></a> for completeness.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>GFlowNets</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.10">GFlowNets are defined within an environment represented as a directed acyclic graph (DAG), denoted by <math alttext="G=(V,E)" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.2"><semantics id="S2.SS1.p1.1.m1.2a"><mrow id="S2.SS1.p1.1.m1.2.3" xref="S2.SS1.p1.1.m1.2.3.cmml"><mi id="S2.SS1.p1.1.m1.2.3.2" xref="S2.SS1.p1.1.m1.2.3.2.cmml">G</mi><mo id="S2.SS1.p1.1.m1.2.3.1" xref="S2.SS1.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.2.3.3.2" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml"><mo id="S2.SS1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">V</mi><mo id="S2.SS1.p1.1.m1.2.3.3.2.2" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" xref="S2.SS1.p1.1.m1.2.2.cmml">E</mi><mo id="S2.SS1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.2b"><apply id="S2.SS1.p1.1.m1.2.3.cmml" xref="S2.SS1.p1.1.m1.2.3"><eq id="S2.SS1.p1.1.m1.2.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.1"></eq><ci id="S2.SS1.p1.1.m1.2.3.2.cmml" xref="S2.SS1.p1.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S2.SS1.p1.1.m1.2.3.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.3.2"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑉</ci><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.2c">G=(V,E)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.2d">italic_G = ( italic_V , italic_E )</annotation></semantics></math>, where <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_V</annotation></semantics></math> is the set of nodes and <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_E</annotation></semantics></math> the set of directed edges. A node <math alttext="s^{\prime}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">s</mi><mo id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑠</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is said to be a child of node <math alttext="s" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_s</annotation></semantics></math> if and only if there exists a directed edge <math alttext="(s\rightarrow s^{\prime})\in E" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mrow id="S2.SS1.p1.6.m6.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.6.m6.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml">s</mi><mo id="S2.SS1.p1.6.m6.1.1.1.1.1.1" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml">→</mo><msup id="S2.SS1.p1.6.m6.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.2.cmml">s</mi><mo id="S2.SS1.p1.6.m6.1.1.1.1.1.3.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.SS1.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">∈</mo><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><in id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2"></in><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1"><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1">→</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.2">𝑠</ci><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.3.3">′</ci></apply></apply><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">(s\rightarrow s^{\prime})\in E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">( italic_s → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∈ italic_E</annotation></semantics></math>; correspondingly, <math alttext="s" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_s</annotation></semantics></math> is the parent of <math alttext="s^{\prime}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><msup id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">s</mi><mo id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">superscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">𝑠</ci><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. The graph includes a unique root node <math alttext="s_{0}\in V" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><msub id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2.2" xref="S2.SS1.p1.9.m9.1.1.2.2.cmml">s</mi><mn id="S2.SS1.p1.9.m9.1.1.2.3" xref="S2.SS1.p1.9.m9.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS1.p1.9.m9.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.cmml">∈</mo><mi id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><in id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1"></in><apply id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2.2">𝑠</ci><cn id="S2.SS1.p1.9.m9.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.9.m9.1.1.2.3">0</cn></apply><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">s_{0}\in V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ italic_V</annotation></semantics></math> with no incoming edges and a subset of terminal nodes <math alttext="\mathcal{X}\subseteq V" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝒳</mi><mo id="S2.SS1.p1.10.m10.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.cmml">⊆</mo><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><subset id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1"></subset><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝒳</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathcal{X}\subseteq V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">caligraphic_X ⊆ italic_V</annotation></semantics></math> with no outgoing edges.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.5">A positive reward function <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mi id="S2.SS1.p2.1.m1.1.2.2" xref="S2.SS1.p2.1.m1.1.2.2.cmml">R</mi><mo id="S2.SS1.p2.1.m1.1.2.1" xref="S2.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p2.1.m1.1.2.3.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mo id="S2.SS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.2"><times id="S2.SS1.p2.1.m1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.1"></times><ci id="S2.SS1.p2.1.m1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.2.2">𝑅</ci><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_R ( italic_x )</annotation></semantics></math> is defined over the terminal nodes <math alttext="x\in\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">x</mi><mo id="S2.SS1.p2.2.m2.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><in id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1"></in><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑥</ci><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">x\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_x ∈ caligraphic_X</annotation></semantics></math>. The objective of GFlowNets is to learn a stochastic forward policy <math alttext="\mathcal{P}_{F}(s^{\prime}|s)" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mrow id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><msub id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.3.m3.1.1.3.2" xref="S2.SS1.p2.3.m3.1.1.3.2.cmml">𝒫</mi><mi id="S2.SS1.p2.3.m3.1.1.3.3" xref="S2.SS1.p2.3.m3.1.1.3.3.cmml">F</mi></msub><mo id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.3.m3.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.3.m3.1.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.1.cmml"><msup id="S2.SS1.p2.3.m3.1.1.1.1.1.2" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.3.m3.1.1.1.1.1.2.2" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.2.cmml">s</mi><mo id="S2.SS1.p2.3.m3.1.1.1.1.1.2.3" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S2.SS1.p2.3.m3.1.1.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p2.3.m3.1.1.1.1.1.3" xref="S2.SS1.p2.3.m3.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S2.SS1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><times id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2"></times><apply id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.3.1.cmml" xref="S2.SS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.3.2.cmml" xref="S2.SS1.p2.3.m3.1.1.3.2">𝒫</ci><ci id="S2.SS1.p2.3.m3.1.1.3.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3.3">𝐹</ci></apply><apply id="S2.SS1.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.2">𝑠</ci><ci id="S2.SS1.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.3">′</ci></apply><ci id="S2.SS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathcal{P}_{F}(s^{\prime}|s)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s )</annotation></semantics></math> such that the probability of reaching a terminal node <math alttext="x\in\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">x</mi><mo id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><in id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"></in><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝑥</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">x\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_x ∈ caligraphic_X</annotation></semantics></math> is proportional to its associated reward <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mrow id="S2.SS1.p2.5.m5.1.2" xref="S2.SS1.p2.5.m5.1.2.cmml"><mi id="S2.SS1.p2.5.m5.1.2.2" xref="S2.SS1.p2.5.m5.1.2.2.cmml">R</mi><mo id="S2.SS1.p2.5.m5.1.2.1" xref="S2.SS1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p2.5.m5.1.2.3.2" xref="S2.SS1.p2.5.m5.1.2.cmml"><mo id="S2.SS1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S2.SS1.p2.5.m5.1.2.cmml">(</mo><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">x</mi><mo id="S2.SS1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S2.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.2.cmml" xref="S2.SS1.p2.5.m5.1.2"><times id="S2.SS1.p2.5.m5.1.2.1.cmml" xref="S2.SS1.p2.5.m5.1.2.1"></times><ci id="S2.SS1.p2.5.m5.1.2.2.cmml" xref="S2.SS1.p2.5.m5.1.2.2">𝑅</ci><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_R ( italic_x )</annotation></semantics></math>. This is accomplished by generating sequences of transitions, where at each step, the agent selects a child node of the current state. In this work, we focus on deterministic environment dynamics, where each action uniquely determines the next state by traversing the corresponding edge in the DAG, as is standard in most existing GFlowNet studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib10" title="">10</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.3">For training GFlowNets, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite> introduced a parameterized flow function and proposed the Flow-Matching (FM) objective, whose global minimization ensures that the induced policy satisfies the desired proportionality condition. Recent work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib24" title="">24</a>]</cite> establishes a formal equivalence between GFlowNet training and entropy-regularized RL under specific settings: a discount factor <math alttext="\gamma=1" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">γ</mi><mo id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><eq id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"></eq><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">𝛾</ci><cn id="S2.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S2.SS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\gamma=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_γ = 1</annotation></semantics></math>, an entropy regularization coefficient <math alttext="\lambda=1" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mrow id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">λ</mi><mo id="S2.SS1.p3.2.m2.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><eq id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"></eq><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝜆</ci><cn id="S2.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_λ = 1</annotation></semantics></math>, and a modified reward function defined by a fixed backward policy <math alttext="\mathcal{P}_{B}(s|s^{\prime})" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><mrow id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><msub id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.3.m3.1.1.3.2" xref="S2.SS1.p3.3.m3.1.1.3.2.cmml">𝒫</mi><mi id="S2.SS1.p3.3.m3.1.1.3.3" xref="S2.SS1.p3.3.m3.1.1.3.3.cmml">B</mi></msub><mo id="S2.SS1.p3.3.m3.1.1.2" xref="S2.SS1.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.p3.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.3.m3.1.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1.1.2" xref="S2.SS1.p3.3.m3.1.1.1.1.1.2.cmml">s</mi><mo fence="false" id="S2.SS1.p3.3.m3.1.1.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.1.1.cmml">|</mo><msup id="S2.SS1.p3.3.m3.1.1.1.1.1.3" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1.1.3.2" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3.2.cmml">s</mi><mo id="S2.SS1.p3.3.m3.1.1.1.1.1.3.3" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.SS1.p3.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1"><times id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2"></times><apply id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.p3.3.m3.1.1.3.2">𝒫</ci><ci id="S2.SS1.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3">𝐵</ci></apply><apply id="S2.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p3.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.2">𝑠</ci><apply id="S2.SS1.p3.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS1.p3.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">\mathcal{P}_{B}(s|s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s | italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> that samples parent nodes in the DAG in reverse from a given child node:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{R}(s,s^{\prime})=\begin{cases}\log\mathcal{P}_{B}(s|s^{\prime}),&amp;%
\text{if }s\notin\mathcal{X}\cup\{s_{f}\},\\
\log R(s),&amp;\text{if }s\in\mathcal{X},\\
0,&amp;\text{if }s=s_{f},\end{cases}" class="ltx_Math" display="block" id="S2.E1.m1.8"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml"><mrow id="S2.E1.m1.8.8.1" xref="S2.E1.m1.8.8.1.cmml"><mover accent="true" id="S2.E1.m1.8.8.1.3" xref="S2.E1.m1.8.8.1.3.cmml"><mi id="S2.E1.m1.8.8.1.3.2" xref="S2.E1.m1.8.8.1.3.2.cmml">R</mi><mo id="S2.E1.m1.8.8.1.3.1" xref="S2.E1.m1.8.8.1.3.1.cmml">~</mo></mover><mo id="S2.E1.m1.8.8.1.2" xref="S2.E1.m1.8.8.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.1.1.1" xref="S2.E1.m1.8.8.1.1.2.cmml"><mo id="S2.E1.m1.8.8.1.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.1.1.2.cmml">(</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">s</mi><mo id="S2.E1.m1.8.8.1.1.1.3" xref="S2.E1.m1.8.8.1.1.2.cmml">,</mo><msup id="S2.E1.m1.8.8.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.2.cmml">s</mi><mo id="S2.E1.m1.8.8.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.E1.m1.8.8.1.1.1.4" stretchy="false" xref="S2.E1.m1.8.8.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.2" xref="S2.E1.m1.8.8.2.cmml">=</mo><mrow id="S2.E1.m1.6.6" xref="S2.E1.m1.8.8.3.1.cmml"><mo id="S2.E1.m1.6.6.7" xref="S2.E1.m1.8.8.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E1.m1.6.6.6" rowspacing="0pt" xref="S2.E1.m1.8.8.3.1.cmml"><mtr id="S2.E1.m1.6.6.6a" xref="S2.E1.m1.8.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6b" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒫</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">B</mi></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mo fence="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6c" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.2.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.cmml"><mtext id="S2.E1.m1.2.2.2.2.2.1.1.1.3.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.2a.cmml">if </mtext><mo id="S2.E1.m1.2.2.2.2.2.1.1.1.3.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.3.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.3.cmml">s</mi></mrow><mo id="S2.E1.m1.2.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.2.cmml">∉</mo><mrow id="S2.E1.m1.2.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.2.2.1.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.3.cmml">𝒳</mi><mo id="S2.E1.m1.2.2.2.2.2.1.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.2.cmml">∪</mo><mrow id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml">f</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo id="S2.E1.m1.2.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S2.E1.m1.6.6.6d" xref="S2.E1.m1.8.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6e" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.3.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml"><mrow id="S2.E1.m1.3.3.3.3.1.1.2.1" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml"><mrow id="S2.E1.m1.3.3.3.3.1.1.2.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.2.1.2.1" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.1.cmml">log</mi><mo id="S2.E1.m1.3.3.3.3.1.1.2.1.2a" lspace="0.167em" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.cmml">⁡</mo><mi id="S2.E1.m1.3.3.3.3.1.1.2.1.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.2.cmml">R</mi></mrow><mo id="S2.E1.m1.3.3.3.3.1.1.2.1.1" xref="S2.E1.m1.3.3.3.3.1.1.2.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.2.1.3.2" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1.2.1.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml">(</mo><mi id="S2.E1.m1.3.3.3.3.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.cmml">s</mi><mo id="S2.E1.m1.3.3.3.3.1.1.2.1.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.1.2.2" xref="S2.E1.m1.3.3.3.3.1.1.2.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6f" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.4.4.4.4.2.1.1" xref="S2.E1.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.4.4.2.1.1.1" xref="S2.E1.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.4.4.2.1.1.1.2" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.cmml"><mtext id="S2.E1.m1.4.4.4.4.2.1.1.1.2.2" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.2a.cmml">if </mtext><mo id="S2.E1.m1.4.4.4.4.2.1.1.1.2.1" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.4.4.2.1.1.1.2.3" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.3.cmml">s</mi></mrow><mo id="S2.E1.m1.4.4.4.4.2.1.1.1.1" xref="S2.E1.m1.4.4.4.4.2.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.4.4.2.1.1.1.3" xref="S2.E1.m1.4.4.4.4.2.1.1.1.3.cmml">𝒳</mi></mrow><mo id="S2.E1.m1.4.4.4.4.2.1.1.2" xref="S2.E1.m1.4.4.4.4.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S2.E1.m1.6.6.6g" xref="S2.E1.m1.8.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6h" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.5.5.5.5.1.1.3" xref="S2.E1.m1.8.8.3.1.cmml"><mn id="S2.E1.m1.5.5.5.5.1.1.1" xref="S2.E1.m1.5.5.5.5.1.1.1.cmml">0</mn><mo id="S2.E1.m1.5.5.5.5.1.1.3.1" xref="S2.E1.m1.8.8.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.6.6.6i" xref="S2.E1.m1.8.8.3.1.cmml"><mrow id="S2.E1.m1.6.6.6.6.2.1.1" xref="S2.E1.m1.6.6.6.6.2.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.6.6.2.1.1.1" xref="S2.E1.m1.6.6.6.6.2.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.6.6.2.1.1.1.2" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.cmml"><mtext id="S2.E1.m1.6.6.6.6.2.1.1.1.2.2" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.2a.cmml">if </mtext><mo id="S2.E1.m1.6.6.6.6.2.1.1.1.2.1" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.6.6.6.6.2.1.1.1.2.3" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.3.cmml">s</mi></mrow><mo id="S2.E1.m1.6.6.6.6.2.1.1.1.1" xref="S2.E1.m1.6.6.6.6.2.1.1.1.1.cmml">=</mo><msub id="S2.E1.m1.6.6.6.6.2.1.1.1.3" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3.cmml"><mi id="S2.E1.m1.6.6.6.6.2.1.1.1.3.2" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3.2.cmml">s</mi><mi id="S2.E1.m1.6.6.6.6.2.1.1.1.3.3" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="S2.E1.m1.6.6.6.6.2.1.1.2" xref="S2.E1.m1.6.6.6.6.2.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8"><eq id="S2.E1.m1.8.8.2.cmml" xref="S2.E1.m1.8.8.2"></eq><apply id="S2.E1.m1.8.8.1.cmml" xref="S2.E1.m1.8.8.1"><times id="S2.E1.m1.8.8.1.2.cmml" xref="S2.E1.m1.8.8.1.2"></times><apply id="S2.E1.m1.8.8.1.3.cmml" xref="S2.E1.m1.8.8.1.3"><ci id="S2.E1.m1.8.8.1.3.1.cmml" xref="S2.E1.m1.8.8.1.3.1">~</ci><ci id="S2.E1.m1.8.8.1.3.2.cmml" xref="S2.E1.m1.8.8.1.3.2">𝑅</ci></apply><interval closure="open" id="S2.E1.m1.8.8.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1"><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝑠</ci><apply id="S2.E1.m1.8.8.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2">𝑠</ci><ci id="S2.E1.m1.8.8.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S2.E1.m1.8.8.3.1.cmml" xref="S2.E1.m1.6.6"><csymbol cd="latexml" id="S2.E1.m1.8.8.3.1.1.cmml" xref="S2.E1.m1.6.6.7">cases</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3"><log id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.2">𝒫</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.3">𝐵</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1"><notin id="S2.E1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.2"></notin><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3"><times id="S2.E1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.1"></times><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.3.2a.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.2"><mtext id="S2.E1.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.2">if </mtext></ci><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.3.3">𝑠</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1"><union id="S2.E1.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.2"></union><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.3">𝒳</ci><set id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1"><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3">𝑓</ci></apply></set></apply></apply><apply id="S2.E1.m1.3.3.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2"><times id="S2.E1.m1.3.3.3.3.1.1.2.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.1.1"></times><apply id="S2.E1.m1.3.3.3.3.1.1.2.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2"><log id="S2.E1.m1.3.3.3.3.1.1.2.1.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.1"></log><ci id="S2.E1.m1.3.3.3.3.1.1.2.1.2.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2.1.2.2">𝑅</ci></apply><ci id="S2.E1.m1.3.3.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1">𝑠</ci></apply><apply id="S2.E1.m1.4.4.4.4.2.1.1.1.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1"><in id="S2.E1.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.1"></in><apply id="S2.E1.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2"><times id="S2.E1.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.1"></times><ci id="S2.E1.m1.4.4.4.4.2.1.1.1.2.2a.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.2"><mtext id="S2.E1.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.2">if </mtext></ci><ci id="S2.E1.m1.4.4.4.4.2.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E1.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S2.E1.m1.4.4.4.4.2.1.1.1.3">𝒳</ci></apply><cn id="S2.E1.m1.5.5.5.5.1.1.1.cmml" type="integer" xref="S2.E1.m1.5.5.5.5.1.1.1">0</cn><apply id="S2.E1.m1.6.6.6.6.2.1.1.1.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1"><eq id="S2.E1.m1.6.6.6.6.2.1.1.1.1.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.1"></eq><apply id="S2.E1.m1.6.6.6.6.2.1.1.1.2.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2"><times id="S2.E1.m1.6.6.6.6.2.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.1"></times><ci id="S2.E1.m1.6.6.6.6.2.1.1.1.2.2a.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.2"><mtext id="S2.E1.m1.6.6.6.6.2.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.2">if </mtext></ci><ci id="S2.E1.m1.6.6.6.6.2.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E1.m1.6.6.6.6.2.1.1.1.3.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.6.6.2.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.6.6.6.6.2.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3.2">𝑠</ci><ci id="S2.E1.m1.6.6.6.6.2.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.6.6.2.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">\widetilde{R}(s,s^{\prime})=\begin{cases}\log\mathcal{P}_{B}(s|s^{\prime}),&amp;%
\text{if }s\notin\mathcal{X}\cup\{s_{f}\},\\
\log R(s),&amp;\text{if }s\in\mathcal{X},\\
0,&amp;\text{if }s=s_{f},\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.8d">over~ start_ARG italic_R end_ARG ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = { start_ROW start_CELL roman_log caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s | italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , end_CELL start_CELL if italic_s ∉ caligraphic_X ∪ { italic_s start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT } , end_CELL end_ROW start_ROW start_CELL roman_log italic_R ( italic_s ) , end_CELL start_CELL if italic_s ∈ caligraphic_X , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL if italic_s = italic_s start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p3.4">where <math alttext="s_{f}" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m1.1"><semantics id="S2.SS1.p3.4.m1.1a"><msub id="S2.SS1.p3.4.m1.1.1" xref="S2.SS1.p3.4.m1.1.1.cmml"><mi id="S2.SS1.p3.4.m1.1.1.2" xref="S2.SS1.p3.4.m1.1.1.2.cmml">s</mi><mi id="S2.SS1.p3.4.m1.1.1.3" xref="S2.SS1.p3.4.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m1.1b"><apply id="S2.SS1.p3.4.m1.1.1.cmml" xref="S2.SS1.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m1.1.1.1.cmml" xref="S2.SS1.p3.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m1.1.1.2.cmml" xref="S2.SS1.p3.4.m1.1.1.2">𝑠</ci><ci id="S2.SS1.p3.4.m1.1.1.3.cmml" xref="S2.SS1.p3.4.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m1.1c">s_{f}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m1.1d">italic_s start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> denotes an additional absorbing state. Consequently, learning the forward policy reduces to solving the following entropy-regularized policy optimization problem:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}_{F}^{*}=\mathop{\mathrm{arg\,max}}_{\pi}\left(\lambda\mathcal{H}(%
\pi)+\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}\widetilde{R}(s_{t},s_%
{t+1})\right]\right)," class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msubsup id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.3.2.2.cmml">𝒫</mi><mi id="S2.E2.m1.2.2.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.3.2.3.cmml">F</mi><mo id="S2.E2.m1.2.2.1.1.3.3" xref="S2.E2.m1.2.2.1.1.3.3.cmml">∗</mo></msubsup><mo id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><munder id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.2.2.2.cmml">arg</mi><mo id="S2.E2.m1.2.2.1.1.1.2.2.1" lspace="0.170em" xref="S2.E2.m1.2.2.1.1.1.2.2.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.2.2.3" xref="S2.E2.m1.2.2.1.1.1.2.2.3.cmml">max</mi></mrow><mi id="S2.E2.m1.2.2.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.2.3.cmml">π</mi></munder><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml">λ</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml">ℋ</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3.1a" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.3.4.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3.4.2.1" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">π</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.3.4.2.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">π</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2" lspace="0em" movablelimits="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">∞</mi></munderover><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">t</mi></msup><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mover accent="true" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.2.cmml">R</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.1.cmml">~</mo></mover><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3a" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">s</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml">+</mo><mn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"></eq><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.2">𝒫</ci><ci id="S2.E2.m1.2.2.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.3.2.3">𝐹</ci></apply><times id="S2.E2.m1.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.3.3"></times></apply><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><apply id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.2">subscript</csymbol><apply id="S2.E2.m1.2.2.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2.2"><times id="S2.E2.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.2.2.1"></times><ci id="S2.E2.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2.2.2">arg</ci><ci id="S2.E2.m1.2.2.1.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.2.2.3">max</ci></apply><ci id="S2.E2.m1.2.2.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.2.3">𝜋</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><plus id="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2"></plus><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3"><times id="S2.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.2">𝜆</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.3">ℋ</ci><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝜋</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.2">𝔼</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.3">𝜋</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><sum id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2"></sum><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3"><eq id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></eq><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3"></infinity></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><times id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.2">𝛾</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5"><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.1">~</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.5.2">𝑅</ci></apply><interval closure="open" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑠</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3"><plus id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.1"></plus><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><cn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathcal{P}_{F}^{*}=\mathop{\mathrm{arg\,max}}_{\pi}\left(\lambda\mathcal{H}(%
\pi)+\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}\widetilde{R}(s_{t},s_%
{t+1})\right]\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">caligraphic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( italic_λ caligraphic_H ( italic_π ) + blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT over~ start_ARG italic_R end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p3.9">where <math alttext="\mathcal{H}(\pi)=\mathbb{E}_{\pi}\left[-\log\pi(s^{\prime}|s)\right]" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m1.2"><semantics id="S2.SS1.p3.5.m1.2a"><mrow id="S2.SS1.p3.5.m1.2.2" xref="S2.SS1.p3.5.m1.2.2.cmml"><mrow id="S2.SS1.p3.5.m1.2.2.3" xref="S2.SS1.p3.5.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.5.m1.2.2.3.2" xref="S2.SS1.p3.5.m1.2.2.3.2.cmml">ℋ</mi><mo id="S2.SS1.p3.5.m1.2.2.3.1" xref="S2.SS1.p3.5.m1.2.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p3.5.m1.2.2.3.3.2" xref="S2.SS1.p3.5.m1.2.2.3.cmml"><mo id="S2.SS1.p3.5.m1.2.2.3.3.2.1" stretchy="false" xref="S2.SS1.p3.5.m1.2.2.3.cmml">(</mo><mi id="S2.SS1.p3.5.m1.1.1" xref="S2.SS1.p3.5.m1.1.1.cmml">π</mi><mo id="S2.SS1.p3.5.m1.2.2.3.3.2.2" stretchy="false" xref="S2.SS1.p3.5.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p3.5.m1.2.2.2" xref="S2.SS1.p3.5.m1.2.2.2.cmml">=</mo><mrow id="S2.SS1.p3.5.m1.2.2.1" xref="S2.SS1.p3.5.m1.2.2.1.cmml"><msub id="S2.SS1.p3.5.m1.2.2.1.3" xref="S2.SS1.p3.5.m1.2.2.1.3.cmml"><mi id="S2.SS1.p3.5.m1.2.2.1.3.2" xref="S2.SS1.p3.5.m1.2.2.1.3.2.cmml">𝔼</mi><mi id="S2.SS1.p3.5.m1.2.2.1.3.3" xref="S2.SS1.p3.5.m1.2.2.1.3.3.cmml">π</mi></msub><mo id="S2.SS1.p3.5.m1.2.2.1.2" xref="S2.SS1.p3.5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.2.cmml"><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.2" xref="S2.SS1.p3.5.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.cmml"><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1a" rspace="0.167em" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.cmml"><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.2" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.2.cmml">π</mi></mrow><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.2" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msup id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p3.5.m1.2.2.1.1.1.3" xref="S2.SS1.p3.5.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m1.2b"><apply id="S2.SS1.p3.5.m1.2.2.cmml" xref="S2.SS1.p3.5.m1.2.2"><eq id="S2.SS1.p3.5.m1.2.2.2.cmml" xref="S2.SS1.p3.5.m1.2.2.2"></eq><apply id="S2.SS1.p3.5.m1.2.2.3.cmml" xref="S2.SS1.p3.5.m1.2.2.3"><times id="S2.SS1.p3.5.m1.2.2.3.1.cmml" xref="S2.SS1.p3.5.m1.2.2.3.1"></times><ci id="S2.SS1.p3.5.m1.2.2.3.2.cmml" xref="S2.SS1.p3.5.m1.2.2.3.2">ℋ</ci><ci id="S2.SS1.p3.5.m1.1.1.cmml" xref="S2.SS1.p3.5.m1.1.1">𝜋</ci></apply><apply id="S2.SS1.p3.5.m1.2.2.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1"><times id="S2.SS1.p3.5.m1.2.2.1.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.2"></times><apply id="S2.SS1.p3.5.m1.2.2.1.3.cmml" xref="S2.SS1.p3.5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m1.2.2.1.3.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.3">subscript</csymbol><ci id="S2.SS1.p3.5.m1.2.2.1.3.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.3.2">𝔼</ci><ci id="S2.SS1.p3.5.m1.2.2.1.3.3.cmml" xref="S2.SS1.p3.5.m1.2.2.1.3.3">𝜋</ci></apply><apply id="S2.SS1.p3.5.m1.2.2.1.1.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.5.m1.2.2.1.1.2.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p3.5.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1"><minus id="S2.SS1.p3.5.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1"></minus><apply id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1"><times id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3"><log id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.1"></log><ci id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.3.2">𝜋</ci></apply><apply id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.5.m1.2.2.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m1.2c">\mathcal{H}(\pi)=\mathbb{E}_{\pi}\left[-\log\pi(s^{\prime}|s)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m1.2d">caligraphic_H ( italic_π ) = blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ - roman_log italic_π ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s ) ]</annotation></semantics></math> denotes the causal entropy of the policy. The expectation <math alttext="\mathbb{E}_{\pi}" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m2.1"><semantics id="S2.SS1.p3.6.m2.1a"><msub id="S2.SS1.p3.6.m2.1.1" xref="S2.SS1.p3.6.m2.1.1.cmml"><mi id="S2.SS1.p3.6.m2.1.1.2" xref="S2.SS1.p3.6.m2.1.1.2.cmml">𝔼</mi><mi id="S2.SS1.p3.6.m2.1.1.3" xref="S2.SS1.p3.6.m2.1.1.3.cmml">π</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m2.1b"><apply id="S2.SS1.p3.6.m2.1.1.cmml" xref="S2.SS1.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.6.m2.1.1.1.cmml" xref="S2.SS1.p3.6.m2.1.1">subscript</csymbol><ci id="S2.SS1.p3.6.m2.1.1.2.cmml" xref="S2.SS1.p3.6.m2.1.1.2">𝔼</ci><ci id="S2.SS1.p3.6.m2.1.1.3.cmml" xref="S2.SS1.p3.6.m2.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m2.1c">\mathbb{E}_{\pi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m2.1d">blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT</annotation></semantics></math> is taken with respect to trajectories generated by <math alttext="s_{0}\sim P_{0}" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m3.1"><semantics id="S2.SS1.p3.7.m3.1a"><mrow id="S2.SS1.p3.7.m3.1.1" xref="S2.SS1.p3.7.m3.1.1.cmml"><msub id="S2.SS1.p3.7.m3.1.1.2" xref="S2.SS1.p3.7.m3.1.1.2.cmml"><mi id="S2.SS1.p3.7.m3.1.1.2.2" xref="S2.SS1.p3.7.m3.1.1.2.2.cmml">s</mi><mn id="S2.SS1.p3.7.m3.1.1.2.3" xref="S2.SS1.p3.7.m3.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS1.p3.7.m3.1.1.1" xref="S2.SS1.p3.7.m3.1.1.1.cmml">∼</mo><msub id="S2.SS1.p3.7.m3.1.1.3" xref="S2.SS1.p3.7.m3.1.1.3.cmml"><mi id="S2.SS1.p3.7.m3.1.1.3.2" xref="S2.SS1.p3.7.m3.1.1.3.2.cmml">P</mi><mn id="S2.SS1.p3.7.m3.1.1.3.3" xref="S2.SS1.p3.7.m3.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m3.1b"><apply id="S2.SS1.p3.7.m3.1.1.cmml" xref="S2.SS1.p3.7.m3.1.1"><csymbol cd="latexml" id="S2.SS1.p3.7.m3.1.1.1.cmml" xref="S2.SS1.p3.7.m3.1.1.1">similar-to</csymbol><apply id="S2.SS1.p3.7.m3.1.1.2.cmml" xref="S2.SS1.p3.7.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m3.1.1.2.1.cmml" xref="S2.SS1.p3.7.m3.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.7.m3.1.1.2.2.cmml" xref="S2.SS1.p3.7.m3.1.1.2.2">𝑠</ci><cn id="S2.SS1.p3.7.m3.1.1.2.3.cmml" type="integer" xref="S2.SS1.p3.7.m3.1.1.2.3">0</cn></apply><apply id="S2.SS1.p3.7.m3.1.1.3.cmml" xref="S2.SS1.p3.7.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m3.1.1.3.1.cmml" xref="S2.SS1.p3.7.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.7.m3.1.1.3.2.cmml" xref="S2.SS1.p3.7.m3.1.1.3.2">𝑃</ci><cn id="S2.SS1.p3.7.m3.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.7.m3.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m3.1c">s_{0}\sim P_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m3.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{t+1}\sim\pi(\cdot|s_{t})" class="ltx_math_unparsed" display="inline" id="S2.SS1.p3.8.m4.1"><semantics id="S2.SS1.p3.8.m4.1a"><mrow id="S2.SS1.p3.8.m4.1b"><msub id="S2.SS1.p3.8.m4.1.1"><mi id="S2.SS1.p3.8.m4.1.1.2">s</mi><mrow id="S2.SS1.p3.8.m4.1.1.3"><mi id="S2.SS1.p3.8.m4.1.1.3.2">t</mi><mo id="S2.SS1.p3.8.m4.1.1.3.1">+</mo><mn id="S2.SS1.p3.8.m4.1.1.3.3">1</mn></mrow></msub><mo id="S2.SS1.p3.8.m4.1.2">∼</mo><mi id="S2.SS1.p3.8.m4.1.3">π</mi><mrow id="S2.SS1.p3.8.m4.1.4"><mo id="S2.SS1.p3.8.m4.1.4.1" stretchy="false">(</mo><mo id="S2.SS1.p3.8.m4.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.SS1.p3.8.m4.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="S2.SS1.p3.8.m4.1.4.4"><mi id="S2.SS1.p3.8.m4.1.4.4.2">s</mi><mi id="S2.SS1.p3.8.m4.1.4.4.3">t</mi></msub><mo id="S2.SS1.p3.8.m4.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m4.1c">s_{t+1}\sim\pi(\cdot|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.8.m4.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∼ italic_π ( ⋅ | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="P_{0}" class="ltx_Math" display="inline" id="S2.SS1.p3.9.m5.1"><semantics id="S2.SS1.p3.9.m5.1a"><msub id="S2.SS1.p3.9.m5.1.1" xref="S2.SS1.p3.9.m5.1.1.cmml"><mi id="S2.SS1.p3.9.m5.1.1.2" xref="S2.SS1.p3.9.m5.1.1.2.cmml">P</mi><mn id="S2.SS1.p3.9.m5.1.1.3" xref="S2.SS1.p3.9.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m5.1b"><apply id="S2.SS1.p3.9.m5.1.1.cmml" xref="S2.SS1.p3.9.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.9.m5.1.1.1.cmml" xref="S2.SS1.p3.9.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.9.m5.1.1.2.cmml" xref="S2.SS1.p3.9.m5.1.1.2">𝑃</ci><cn id="S2.SS1.p3.9.m5.1.1.3.cmml" type="integer" xref="S2.SS1.p3.9.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m5.1c">P_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.9.m5.1d">italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the initial state distribution that corresponds to a Dirac delta distribution in the GFlowNet setting.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">In this paper, we address the problem of training a GFlowNet using an offline dataset <math alttext="\mathcal{D}=\{\tau_{i}=(s_{0},s_{1},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.2"><semantics id="S2.SS1.p4.1.m1.2a"><mrow id="S2.SS1.p4.1.m1.2.2" xref="S2.SS1.p4.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.1.m1.2.2.3" xref="S2.SS1.p4.1.m1.2.2.3.cmml">𝒟</mi><mo id="S2.SS1.p4.1.m1.2.2.2" xref="S2.SS1.p4.1.m1.2.2.2.cmml">=</mo><msubsup id="S2.SS1.p4.1.m1.2.2.1" xref="S2.SS1.p4.1.m1.2.2.1.cmml"><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml"><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.cmml"><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.2.cmml">τ</mi><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.3.cmml">i</mi></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.5" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.5.cmml">=</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml"><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.5" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">(</mo><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.6" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">s</mi><mn id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.7" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><mi id="S2.SS1.p4.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p4.1.m1.1.1.cmml">…</mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.8" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml">s</mi><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.2.cmml">T</mi><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msub></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.9" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.3.cmml">R</mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.2.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.cmml"><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.2" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.cmml">(</mo><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.2.cmml">s</mi><msub id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.2.cmml">T</mi><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.3" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.10" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p4.1.m1.2.2.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.3.1" xref="S2.SS1.p4.1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p4.1.m1.2.2.1.1.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p4.1.m1.2.2.1.3" xref="S2.SS1.p4.1.m1.2.2.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.2b"><apply id="S2.SS1.p4.1.m1.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2"><eq id="S2.SS1.p4.1.m1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.2"></eq><ci id="S2.SS1.p4.1.m1.2.2.3.cmml" xref="S2.SS1.p4.1.m1.2.2.3">𝒟</ci><apply id="S2.SS1.p4.1.m1.2.2.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1">superscript</csymbol><apply id="S2.SS1.p4.1.m1.2.2.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1">subscript</csymbol><set id="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1"><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1"><eq id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.5.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.5"></eq><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.2">𝜏</ci><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.6.3">𝑖</ci></apply><vector id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.5.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4"><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑠</ci><cn id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2">𝑠</ci><cn id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">…</ci><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.2">𝑠</ci><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.2">𝑇</ci><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4"><times id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.2"></times><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.3">𝑅</ci><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.2">𝑠</ci><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.2">𝑇</ci><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.1.1.4.4.4.1.1.1.3.3">𝑖</ci></apply></apply></apply></vector></apply></set><apply id="S2.SS1.p4.1.m1.2.2.1.1.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3"><eq id="S2.SS1.p4.1.m1.2.2.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3.1"></eq><ci id="S2.SS1.p4.1.m1.2.2.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3.2">𝑖</ci><cn id="S2.SS1.p4.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S2.SS1.p4.1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p4.1.m1.2.2.1.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.2c">\mathcal{D}=\{\tau_{i}=(s_{0},s_{1},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.2d">caligraphic_D = { italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R ( italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, which consists of trajectories of constructed objects generated by an unknown behavior policy, along with their corresponding ground-truth rewards.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Maximum causal entropy IRL</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">Maximum causal entropy inverse reinforcement learning (IRL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib26" title="">26</a>]</cite> seeks to recover a reward function <math alttext="r(s,s^{\prime})" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.2"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml"><mi id="S2.SS2.p1.1.m1.2.2.3" xref="S2.SS2.p1.1.m1.2.2.3.cmml">r</mi><mo id="S2.SS2.p1.1.m1.2.2.2" xref="S2.SS2.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.2.2.1.1" xref="S2.SS2.p1.1.m1.2.2.1.2.cmml"><mo id="S2.SS2.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.2.2.1.2.cmml">(</mo><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">s</mi><mo id="S2.SS2.p1.1.m1.2.2.1.1.3" xref="S2.SS2.p1.1.m1.2.2.1.2.cmml">,</mo><msup id="S2.SS2.p1.1.m1.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.2.2.1.1.1.2" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml">s</mi><mo id="S2.SS2.p1.1.m1.2.2.1.1.1.3" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S2.SS2.p1.1.m1.2.2.1.1.4" stretchy="false" xref="S2.SS2.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2"><times id="S2.SS2.p1.1.m1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2.2"></times><ci id="S2.SS2.p1.1.m1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.2.2.3">𝑟</ci><interval closure="open" id="S2.SS2.p1.1.m1.2.2.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑠</ci><apply id="S2.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2">𝑠</ci><ci id="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">r(s,s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.2d">italic_r ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> that both explains expert behavior under a policy <math alttext="\pi_{E}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">π</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝜋</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\pi_{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> and promotes maximum entropy in the learned policy. This objective is formalized as the following minimax optimization problem:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{r}{\text{minimize}}\left(\max_{\pi}\left[\lambda\mathcal{H}(\pi)+%
\mathbb{E}_{\pi}\left(\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},s_{t+1})\right)%
\right]\right)-\mathbb{E}_{\pi_{E}}\left[\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},%
s_{t+1})\right]," class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><munder accentunder="true" id="S2.E3.m1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.3.cmml"><mtext id="S2.E3.m1.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.3.2a.cmml">minimize</mtext><mo id="S2.E3.m1.2.2.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.3.1.cmml">𝑟</mo></munder><mo id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><munder id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">max</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">π</mi></munder><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2a" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml">[</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.2.cmml">λ</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.3.cmml">ℋ</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1a" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.4.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.4.2.1" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">π</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.4.2.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.2.cmml">+</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.cmml">𝔼</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.cmml">π</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml"><munderover id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.2" lspace="0em" movablelimits="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">∞</mi></munderover><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml"><msup id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.3.cmml">t</mi></msup><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.5" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.5.cmml">r</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3a" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">s</mi><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">+</mo><mn id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml">]</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml">−</mo><mrow id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml"><msub id="S2.E3.m1.2.2.1.1.2.3" xref="S2.E3.m1.2.2.1.1.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.2.3.2" xref="S2.E3.m1.2.2.1.1.2.3.2.cmml">𝔼</mi><msub id="S2.E3.m1.2.2.1.1.2.3.3" xref="S2.E3.m1.2.2.1.1.2.3.3.cmml"><mi id="S2.E3.m1.2.2.1.1.2.3.3.2" xref="S2.E3.m1.2.2.1.1.2.3.3.2.cmml">π</mi><mi id="S2.E3.m1.2.2.1.1.2.3.3.3" xref="S2.E3.m1.2.2.1.1.2.3.3.3.cmml">E</mi></msub></msub><mo id="S2.E3.m1.2.2.1.1.2.2" xref="S2.E3.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.2.1.1" xref="S2.E3.m1.2.2.1.1.2.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.2.2.1.1.2.1.1.1" xref="S2.E3.m1.2.2.1.1.2.1.1.1.cmml"><munderover id="S2.E3.m1.2.2.1.1.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.2" lspace="0em" movablelimits="false" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.1" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.3.3" mathvariant="normal" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.3.cmml">∞</mi></munderover><mrow id="S2.E3.m1.2.2.1.1.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.cmml"><msup id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.cmml"><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.3.cmml">t</mi></msup><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.2.5" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.5.cmml">r</mi><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.3a" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.3.cmml"><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.3" stretchy="false" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.4" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.2.cmml">s</mi><mrow id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.2" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.1" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.1.cmml">+</mo><mn id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.3" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.5" stretchy="false" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.2.1.1.3" xref="S2.E3.m1.2.2.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2" xref="S2.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><minus id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"></minus><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3"><ci id="S2.E3.m1.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.3.1">𝑟</ci><ci id="S2.E3.m1.2.2.1.1.1.3.2a.cmml" xref="S2.E3.m1.2.2.1.1.1.3.2"><mtext id="S2.E3.m1.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.3.2">minimize</mtext></ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><max id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2"></max><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3">𝜋</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1"><plus id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.2"></plus><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.1"></times><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.2">𝜆</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.3.3">ℋ</ci><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝜋</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.2">𝔼</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.3.3">𝜋</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.2"></sum><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3"><eq id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.1"></eq><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.3.3"></infinity></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.3"></times><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4">superscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.2">𝛾</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.4.3">𝑡</ci></apply><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.5.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.5">𝑟</ci><interval closure="open" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.2">𝑠</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3"><plus id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.1"></plus><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"><times id="S2.E3.m1.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2"></times><apply id="S2.E3.m1.2.2.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.3.2">𝔼</ci><apply id="S2.E3.m1.2.2.1.1.2.3.3.cmml" xref="S2.E3.m1.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.3.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.3.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.3.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.3.3.2">𝜋</ci><ci id="S2.E3.m1.2.2.1.1.2.3.3.3.cmml" xref="S2.E3.m1.2.2.1.1.2.3.3.3">𝐸</ci></apply></apply><apply id="S2.E3.m1.2.2.1.1.2.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.2.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1"><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.2"></sum><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3"><eq id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.1"></eq><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S2.E3.m1.2.2.1.1.2.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.3.3"></infinity></apply><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2"><times id="S2.E3.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.3"></times><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4">superscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.2">𝛾</ci><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.4.3">𝑡</ci></apply><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.2.5.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.5">𝑟</ci><interval closure="open" id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2"><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.2">𝑠</ci><apply id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3"><plus id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.1"></plus><ci id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.2.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\underset{r}{\text{minimize}}\left(\max_{\pi}\left[\lambda\mathcal{H}(\pi)+%
\mathbb{E}_{\pi}\left(\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},s_{t+1})\right)%
\right]\right)-\mathbb{E}_{\pi_{E}}\left[\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},%
s_{t+1})\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">underitalic_r start_ARG minimize end_ARG ( roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ italic_λ caligraphic_H ( italic_π ) + blackboard_E start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ) ] ) - blackboard_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.5">where <math alttext="\mathcal{H}(\pi)" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m1.1"><semantics id="S2.SS2.p1.3.m1.1a"><mrow id="S2.SS2.p1.3.m1.1.2" xref="S2.SS2.p1.3.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.3.m1.1.2.2" xref="S2.SS2.p1.3.m1.1.2.2.cmml">ℋ</mi><mo id="S2.SS2.p1.3.m1.1.2.1" xref="S2.SS2.p1.3.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.3.m1.1.2.3.2" xref="S2.SS2.p1.3.m1.1.2.cmml"><mo id="S2.SS2.p1.3.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.3.m1.1.2.cmml">(</mo><mi id="S2.SS2.p1.3.m1.1.1" xref="S2.SS2.p1.3.m1.1.1.cmml">π</mi><mo id="S2.SS2.p1.3.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m1.1b"><apply id="S2.SS2.p1.3.m1.1.2.cmml" xref="S2.SS2.p1.3.m1.1.2"><times id="S2.SS2.p1.3.m1.1.2.1.cmml" xref="S2.SS2.p1.3.m1.1.2.1"></times><ci id="S2.SS2.p1.3.m1.1.2.2.cmml" xref="S2.SS2.p1.3.m1.1.2.2">ℋ</ci><ci id="S2.SS2.p1.3.m1.1.1.cmml" xref="S2.SS2.p1.3.m1.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m1.1c">\mathcal{H}(\pi)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m1.1d">caligraphic_H ( italic_π )</annotation></semantics></math> denotes the causal entropy of the policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m2.1"><semantics id="S2.SS2.p1.4.m2.1a"><mi id="S2.SS2.p1.4.m2.1.1" xref="S2.SS2.p1.4.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m2.1b"><ci id="S2.SS2.p1.4.m2.1.1.cmml" xref="S2.SS2.p1.4.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m2.1d">italic_π</annotation></semantics></math>, consistent with its definition in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.E2" title="In 2.1 GFlowNets ‣ 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>. In our approach, we adapt this framework to infer an edge-level reward function <math alttext="R_{E}:E\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m3.1"><semantics id="S2.SS2.p1.5.m3.1a"><mrow id="S2.SS2.p1.5.m3.1.1" xref="S2.SS2.p1.5.m3.1.1.cmml"><msub id="S2.SS2.p1.5.m3.1.1.2" xref="S2.SS2.p1.5.m3.1.1.2.cmml"><mi id="S2.SS2.p1.5.m3.1.1.2.2" xref="S2.SS2.p1.5.m3.1.1.2.2.cmml">R</mi><mi id="S2.SS2.p1.5.m3.1.1.2.3" xref="S2.SS2.p1.5.m3.1.1.2.3.cmml">E</mi></msub><mo id="S2.SS2.p1.5.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS2.p1.5.m3.1.1.1.cmml">:</mo><mrow id="S2.SS2.p1.5.m3.1.1.3" xref="S2.SS2.p1.5.m3.1.1.3.cmml"><mi id="S2.SS2.p1.5.m3.1.1.3.2" xref="S2.SS2.p1.5.m3.1.1.3.2.cmml">E</mi><mo id="S2.SS2.p1.5.m3.1.1.3.1" stretchy="false" xref="S2.SS2.p1.5.m3.1.1.3.1.cmml">→</mo><mi id="S2.SS2.p1.5.m3.1.1.3.3" xref="S2.SS2.p1.5.m3.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m3.1b"><apply id="S2.SS2.p1.5.m3.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1"><ci id="S2.SS2.p1.5.m3.1.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1">:</ci><apply id="S2.SS2.p1.5.m3.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m3.1.1.2.1.cmml" xref="S2.SS2.p1.5.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.5.m3.1.1.2.2.cmml" xref="S2.SS2.p1.5.m3.1.1.2.2">𝑅</ci><ci id="S2.SS2.p1.5.m3.1.1.2.3.cmml" xref="S2.SS2.p1.5.m3.1.1.2.3">𝐸</ci></apply><apply id="S2.SS2.p1.5.m3.1.1.3.cmml" xref="S2.SS2.p1.5.m3.1.1.3"><ci id="S2.SS2.p1.5.m3.1.1.3.1.cmml" xref="S2.SS2.p1.5.m3.1.1.3.1">→</ci><ci id="S2.SS2.p1.5.m3.1.1.3.2.cmml" xref="S2.SS2.p1.5.m3.1.1.3.2">𝐸</ci><ci id="S2.SS2.p1.5.m3.1.1.3.3.cmml" xref="S2.SS2.p1.5.m3.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m3.1c">R_{E}:E\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m3.1d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT : italic_E → blackboard_R</annotation></semantics></math> that reflects the expert policy’s preferences for allocating flow across specific edges in the graph.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we introduce <span class="ltx_text ltx_font_bold" id="S3.p1.1.1">Trajectory-Distilled GFlowNet (TD-GFN)</span>, a proxy-free training framework that eliminates the need to query rewards outside the dataset, thereby avoiding reliance on proxy reward models. Unlike prior methods that constrain the policy to remain close to the dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>]</cite>, TD-GFN achieves a more effective exploration–exploitation trade-off by strategically allocating attention across the environment DAG.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">The overall training pipeline is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>. First, TD-GFN learns an <em class="ltx_emph ltx_font_italic" id="S3.p2.1.1">edge reward function</em> from a rebalanced dataset using inverse reinforcement learning (IRL). This function captures the relative importance of each edge in the environment DAG, providing principled guidance for policy learning. Leveraging these edge-level rewards, TD-GFN then prunes the DAG to remove low-utility transitions and trains the policy via prioritized backward sampling over the resulting subgraph. This design enables strategic generalization to broad, unseen regions of the state space while maintaining alignment with high-reward behaviors. The following subsections detail each component.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="250" id="S3.F2.g1" src="x2.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
An overview of the complete training pipeline of the TD-GFN framework.
</figcaption>
</figure>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">A comprehensive summary of the full training procedure is presented in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg1" title="Algorithm 1 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a> (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A1" title="Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">A</span></a>). Notably, the contributions of TD-GFN are orthogonal to the specific training strategies employed after trajectory sampling, as discussed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS5" title="D.5 Orthogonality to Training Paradigms ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.5</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Edge rewards extraction via IRL</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Motivated by the insight that different edges in the environment DAG contribute <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.1.1">unequally</em> to effective policy learning, we aim to quantify this disparity to enable more targeted and generalizable training. Nevertheless, measuring the contribution of individual transitions under the inherently stochastic nature of GFlowNet policies poses a fundamental challenge. To tackle this, we leverage the theoretical equivalence between GFlowNet training and entropy-regularized reinforcement learning (Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.E2" title="In 2.1 GFlowNets ‣ 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>) and applying the maximum causal entropy IRL framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib26" title="">26</a>]</cite> (Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.E3" title="In 2.2 Maximum causal entropy IRL ‣ 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3</span></a>) to extract a fine-grained <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.1.2">edge-level reward function</em> from offline trajectories. These learned edge rewards act as structured supervision signals that capture the relative importance of transitions, guiding the policy to generalize effectively across the environment DAG.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.3">A central obstacle in applying IRL to offline data, however, lies in the fact that the behavior policy underlying the dataset may not reflect expert behavior. To mitigate this, we introduce a rebalancing strategy inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib27" title="">27</a>]</cite> that biases trajectory sampling according to the reward of terminal states. Specifically, when estimating expectations under the expert policy <math alttext="\mathbb{E}_{\pi_{E}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝔼</mi><msub id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">π</mi><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">E</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝔼</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝜋</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbb{E}_{\pi_{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">blackboard_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, we sample trajectories <math alttext="\tau=(s_{0},s_{1},\dots,s_{T})\in\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.4"><semantics id="S3.SS1.p2.2.m2.4a"><mrow id="S3.SS1.p2.2.m2.4.4" xref="S3.SS1.p2.2.m2.4.4.cmml"><mi id="S3.SS1.p2.2.m2.4.4.5" xref="S3.SS1.p2.2.m2.4.4.5.cmml">τ</mi><mo id="S3.SS1.p2.2.m2.4.4.6" xref="S3.SS1.p2.2.m2.4.4.6.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.4.4.3.3" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml"><mo id="S3.SS1.p2.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">(</mo><msub id="S3.SS1.p2.2.m2.2.2.1.1.1" xref="S3.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.2.2.1.1.1.2" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p2.2.m2.2.2.1.1.1.3" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.5" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.3.3.2.2.2" xref="S3.SS1.p2.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.3.3.2.2.2.2" xref="S3.SS1.p2.2.m2.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS1.p2.2.m2.3.3.2.2.2.3" xref="S3.SS1.p2.2.m2.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.6" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p2.2.m2.4.4.3.3.7" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.4.4.3.3.3" xref="S3.SS1.p2.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.2.m2.4.4.3.3.3.2" xref="S3.SS1.p2.2.m2.4.4.3.3.3.2.cmml">s</mi><mi id="S3.SS1.p2.2.m2.4.4.3.3.3.3" xref="S3.SS1.p2.2.m2.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">)</mo></mrow><mo id="S3.SS1.p2.2.m2.4.4.7" xref="S3.SS1.p2.2.m2.4.4.7.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.4.4.8" xref="S3.SS1.p2.2.m2.4.4.8.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.4b"><apply id="S3.SS1.p2.2.m2.4.4.cmml" xref="S3.SS1.p2.2.m2.4.4"><and id="S3.SS1.p2.2.m2.4.4a.cmml" xref="S3.SS1.p2.2.m2.4.4"></and><apply id="S3.SS1.p2.2.m2.4.4b.cmml" xref="S3.SS1.p2.2.m2.4.4"><eq id="S3.SS1.p2.2.m2.4.4.6.cmml" xref="S3.SS1.p2.2.m2.4.4.6"></eq><ci id="S3.SS1.p2.2.m2.4.4.5.cmml" xref="S3.SS1.p2.2.m2.4.4.5">𝜏</ci><vector id="S3.SS1.p2.2.m2.4.4.3.4.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3"><apply id="S3.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3">0</cn></apply><apply id="S3.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS1.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">…</ci><apply id="S3.SS1.p2.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3.2">𝑠</ci><ci id="S3.SS1.p2.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3.3">𝑇</ci></apply></vector></apply><apply id="S3.SS1.p2.2.m2.4.4c.cmml" xref="S3.SS1.p2.2.m2.4.4"><in id="S3.SS1.p2.2.m2.4.4.7.cmml" xref="S3.SS1.p2.2.m2.4.4.7"></in><share href="https://arxiv.org/html/2505.20110v1#S3.SS1.p2.2.m2.4.4.3.cmml" id="S3.SS1.p2.2.m2.4.4d.cmml" xref="S3.SS1.p2.2.m2.4.4"></share><ci id="S3.SS1.p2.2.m2.4.4.8.cmml" xref="S3.SS1.p2.2.m2.4.4.8">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.4c">\tau=(s_{0},s_{1},\dots,s_{T})\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.4d">italic_τ = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ∈ caligraphic_D</annotation></semantics></math> with probability <math alttext="P(\tau)\propto R(s_{T})" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.2"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml"><mrow id="S3.SS1.p2.3.m3.2.2.3" xref="S3.SS1.p2.3.m3.2.2.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.3.2" xref="S3.SS1.p2.3.m3.2.2.3.2.cmml">P</mi><mo id="S3.SS1.p2.3.m3.2.2.3.1" xref="S3.SS1.p2.3.m3.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.2.2.3.3.2" xref="S3.SS1.p2.3.m3.2.2.3.cmml"><mo id="S3.SS1.p2.3.m3.2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.3.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">τ</mi><mo id="S3.SS1.p2.3.m3.2.2.3.3.2.2" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.3.m3.2.2.2" xref="S3.SS1.p2.3.m3.2.2.2.cmml">∝</mo><mrow id="S3.SS1.p2.3.m3.2.2.1" xref="S3.SS1.p2.3.m3.2.2.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.3" xref="S3.SS1.p2.3.m3.2.2.1.3.cmml">R</mi><mo id="S3.SS1.p2.3.m3.2.2.1.2" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml"><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.3.m3.2.2.1.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.3" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><apply id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2"><csymbol cd="latexml" id="S3.SS1.p2.3.m3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2">proportional-to</csymbol><apply id="S3.SS1.p2.3.m3.2.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2.3"><times id="S3.SS1.p2.3.m3.2.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.3.1"></times><ci id="S3.SS1.p2.3.m3.2.2.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.3.2">𝑃</ci><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝜏</ci></apply><apply id="S3.SS1.p2.3.m3.2.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1"><times id="S3.SS1.p2.3.m3.2.2.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.2"></times><ci id="S3.SS1.p2.3.m3.2.2.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.3">𝑅</ci><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">P(\tau)\propto R(s_{T})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.2d">italic_P ( italic_τ ) ∝ italic_R ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math>, thereby constructing a <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.3.1">rebalanced dataset</em> that more closely approximates the visitation distribution of an expert policy. This reweighting adjusts edge visitation frequencies to favor high-reward regions, enabling more meaningful reward inference.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">Inspired by the well-known maximum causal entropy IRL framework GAIL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib28" title="">28</a>]</cite>, we adopt the following adversarial training objective based on the rebalanced dataset:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\underset{\phi}{\text{minimize}}\ \max_{\psi}" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.1"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml"><munder accentunder="true" id="S3.E4X.2.1.1.m1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.2.cmml"><mtext id="S3.E4X.2.1.1.m1.1.1.2.2" xref="S3.E4X.2.1.1.m1.1.1.2.2a.cmml">minimize</mtext><mo class="ltx_mathvariant_italic" id="S3.E4X.2.1.1.m1.1.1.2.1" mathvariant="italic" xref="S3.E4X.2.1.1.m1.1.1.2.1.cmml">ϕ</mo></munder><mo id="S3.E4X.2.1.1.m1.1.1.1" lspace="0.667em" xref="S3.E4X.2.1.1.m1.1.1.1.cmml">⁢</mo><munder id="S3.E4X.2.1.1.m1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.3.2.cmml">max</mi><mi id="S3.E4X.2.1.1.m1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.3.3.cmml">ψ</mi></munder></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1"><times id="S3.E4X.2.1.1.m1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1"></times><apply id="S3.E4X.2.1.1.m1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2"><ci id="S3.E4X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.1">italic-ϕ</ci><ci id="S3.E4X.2.1.1.m1.1.1.2.2a.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.2"><mtext id="S3.E4X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.2">minimize</mtext></ci></apply><apply id="S3.E4X.2.1.1.m1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3">subscript</csymbol><max id="S3.E4X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2"></max><ci id="S3.E4X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\underset{\phi}{\text{minimize}}\ \max_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.1d">underitalic_ϕ start_ARG minimize end_ARG roman_max start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}(\psi,\phi)=" class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.2"><semantics id="S3.E4X.3.2.2.m1.2a"><mrow id="S3.E4X.3.2.2.m1.2.3" xref="S3.E4X.3.2.2.m1.2.3.cmml"><mrow id="S3.E4X.3.2.2.m1.2.3.2" xref="S3.E4X.3.2.2.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4X.3.2.2.m1.2.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.2.2.cmml">ℒ</mi><mo id="S3.E4X.3.2.2.m1.2.3.2.1" xref="S3.E4X.3.2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.2.3.2.3.2" xref="S3.E4X.3.2.2.m1.2.3.2.3.1.cmml"><mo id="S3.E4X.3.2.2.m1.2.3.2.3.2.1" stretchy="false" xref="S3.E4X.3.2.2.m1.2.3.2.3.1.cmml">(</mo><mi id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">ψ</mi><mo id="S3.E4X.3.2.2.m1.2.3.2.3.2.2" xref="S3.E4X.3.2.2.m1.2.3.2.3.1.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml">ϕ</mi><mo id="S3.E4X.3.2.2.m1.2.3.2.3.2.3" stretchy="false" xref="S3.E4X.3.2.2.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.2.3.1" xref="S3.E4X.3.2.2.m1.2.3.1.cmml">=</mo><mi id="S3.E4X.3.2.2.m1.2.3.3" xref="S3.E4X.3.2.2.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.2b"><apply id="S3.E4X.3.2.2.m1.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.3"><eq id="S3.E4X.3.2.2.m1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.1"></eq><apply id="S3.E4X.3.2.2.m1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.2"><times id="S3.E4X.3.2.2.m1.2.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.2.1"></times><ci id="S3.E4X.3.2.2.m1.2.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.3.2.2">ℒ</ci><interval closure="open" id="S3.E4X.3.2.2.m1.2.3.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.3.2.3.2"><ci id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1">𝜓</ci><ci id="S3.E4X.3.2.2.m1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2">italic-ϕ</ci></interval></apply><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.2c">\displaystyle\mathcal{L}(\psi,\phi)=</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.3.2.2.m1.2d">caligraphic_L ( italic_ψ , italic_ϕ ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\big{(}\lambda\mathcal{H}(\pi_{\psi})+\mathbb{E}_{s\sim\widetilde%
{\mathcal{D}},s^{\prime}\sim\pi_{\psi}(\cdot|s)}\left[\log{D_{\phi}(s,s^{%
\prime})}\right]\big{)}+\mathbb{E}_{(s,s^{\prime})\sim\widetilde{\mathcal{D}}}%
\left[\log{\big{(}1-D_{\phi}(s,s^{\prime})\big{)}}\right]," class="ltx_math_unparsed" display="inline" id="S3.E4Xa.2.1.1.m1.6"><semantics id="S3.E4Xa.2.1.1.m1.6a"><mrow id="S3.E4Xa.2.1.1.m1.6.6.1"><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1"><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.2" maxsize="120%" minsize="120%">(</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1"><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.3">λ</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.2">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.4">ℋ</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.2a">⁢</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1.2">π</mi><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1.3">ψ</mi></msub><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.3">+</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2"><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.2">𝔼</mi><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.1">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.2">∼</mo><mover accent="true" id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.3"><mi class="ltx_font_mathcaligraphic" id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.3.2">𝒟</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.3.1">~</mo></mover><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.4">,</mo><msup id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.5"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.5.2">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.5.3">′</mo></msup><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.6">∼</mo><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.7"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.7.2">π</mi><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.7.3">ψ</mi></msub><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8.1" stretchy="false">(</mo><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8.4">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.3.3.8.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.2">⁢</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.2">[</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1"><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3.1">log</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3a" lspace="0.167em">⁡</mo><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3.2"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3.2.2">D</mi><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.3.2.3">ϕ</mi></msub></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.2">⁢</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false">(</mo><mi id="S3.E4Xa.2.1.1.m1.3.3">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.3">,</mo><msup id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.1"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.1.2">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.1.3">′</mo></msup><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.1.1.1.4" stretchy="false">)</mo></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.1.2.1.1.3">]</mo></mrow></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.1.1.3" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.3">+</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2"><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.3"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.3.2">𝔼</mi><mrow id="S3.E4Xa.2.1.1.m1.2.2.2"><mrow id="S3.E4Xa.2.1.1.m1.2.2.2.2.1"><mo id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.2" stretchy="false">(</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1">s</mi><mo id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.3">,</mo><msup id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.1"><mi id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.1.2">s</mi><mo id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.1.3">′</mo></msup><mo id="S3.E4Xa.2.1.1.m1.2.2.2.2.1.4" stretchy="false">)</mo></mrow><mo id="S3.E4Xa.2.1.1.m1.2.2.2.3">∼</mo><mover accent="true" id="S3.E4Xa.2.1.1.m1.2.2.2.4"><mi class="ltx_font_mathcaligraphic" id="S3.E4Xa.2.1.1.m1.2.2.2.4.2">𝒟</mi><mo id="S3.E4Xa.2.1.1.m1.2.2.2.4.1">~</mo></mover></mrow></msub><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.2">⁢</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.2">[</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1"><mi id="S3.E4Xa.2.1.1.m1.5.5">log</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1a">⁡</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.2" maxsize="120%" minsize="120%">(</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1"><mn id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.3">1</mn><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.2">−</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1"><msub id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.3"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.3.2">D</mi><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.3.3">ϕ</mi></msub><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.2">⁢</mo><mrow id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1"><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><mi id="S3.E4Xa.2.1.1.m1.4.4">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.3">,</mo><msup id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.2">s</mi><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.3">′</mo></msup><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.4" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.1.1.1.3" maxsize="120%" minsize="120%">)</mo></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.1.2.1.1.3">]</mo></mrow></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.6.6.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.6b">\displaystyle\big{(}\lambda\mathcal{H}(\pi_{\psi})+\mathbb{E}_{s\sim\widetilde%
{\mathcal{D}},s^{\prime}\sim\pi_{\psi}(\cdot|s)}\left[\log{D_{\phi}(s,s^{%
\prime})}\right]\big{)}+\mathbb{E}_{(s,s^{\prime})\sim\widetilde{\mathcal{D}}}%
\left[\log{\big{(}1-D_{\phi}(s,s^{\prime})\big{)}}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E4Xa.2.1.1.m1.6c">( italic_λ caligraphic_H ( italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ) + blackboard_E start_POSTSUBSCRIPT italic_s ∼ over~ start_ARG caligraphic_D end_ARG , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( ⋅ | italic_s ) end_POSTSUBSCRIPT [ roman_log italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] ) + blackboard_E start_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∼ over~ start_ARG caligraphic_D end_ARG end_POSTSUBSCRIPT [ roman_log ( 1 - italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.3">where <math alttext="\widetilde{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mover accent="true" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝒟</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><ci id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1">~</ci><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\widetilde{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">over~ start_ARG caligraphic_D end_ARG</annotation></semantics></math> denotes both the node and edge distributions (with slight abuse of notation), <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝜋</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> is a parameterized policy and <math alttext="D_{\phi}:E\rightarrow(0,1)" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.2"><semantics id="S3.SS1.p3.3.m3.2a"><mrow id="S3.SS1.p3.3.m3.2.3" xref="S3.SS1.p3.3.m3.2.3.cmml"><msub id="S3.SS1.p3.3.m3.2.3.2" xref="S3.SS1.p3.3.m3.2.3.2.cmml"><mi id="S3.SS1.p3.3.m3.2.3.2.2" xref="S3.SS1.p3.3.m3.2.3.2.2.cmml">D</mi><mi id="S3.SS1.p3.3.m3.2.3.2.3" xref="S3.SS1.p3.3.m3.2.3.2.3.cmml">ϕ</mi></msub><mo id="S3.SS1.p3.3.m3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p3.3.m3.2.3.1.cmml">:</mo><mrow id="S3.SS1.p3.3.m3.2.3.3" xref="S3.SS1.p3.3.m3.2.3.3.cmml"><mi id="S3.SS1.p3.3.m3.2.3.3.2" xref="S3.SS1.p3.3.m3.2.3.3.2.cmml">E</mi><mo id="S3.SS1.p3.3.m3.2.3.3.1" stretchy="false" xref="S3.SS1.p3.3.m3.2.3.3.1.cmml">→</mo><mrow id="S3.SS1.p3.3.m3.2.3.3.3.2" xref="S3.SS1.p3.3.m3.2.3.3.3.1.cmml"><mo id="S3.SS1.p3.3.m3.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p3.3.m3.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">0</mn><mo id="S3.SS1.p3.3.m3.2.3.3.3.2.2" xref="S3.SS1.p3.3.m3.2.3.3.3.1.cmml">,</mo><mn id="S3.SS1.p3.3.m3.2.2" xref="S3.SS1.p3.3.m3.2.2.cmml">1</mn><mo id="S3.SS1.p3.3.m3.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p3.3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.2b"><apply id="S3.SS1.p3.3.m3.2.3.cmml" xref="S3.SS1.p3.3.m3.2.3"><ci id="S3.SS1.p3.3.m3.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.3.1">:</ci><apply id="S3.SS1.p3.3.m3.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.3.2.1.cmml" xref="S3.SS1.p3.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.3.2.2.cmml" xref="S3.SS1.p3.3.m3.2.3.2.2">𝐷</ci><ci id="S3.SS1.p3.3.m3.2.3.2.3.cmml" xref="S3.SS1.p3.3.m3.2.3.2.3">italic-ϕ</ci></apply><apply id="S3.SS1.p3.3.m3.2.3.3.cmml" xref="S3.SS1.p3.3.m3.2.3.3"><ci id="S3.SS1.p3.3.m3.2.3.3.1.cmml" xref="S3.SS1.p3.3.m3.2.3.3.1">→</ci><ci id="S3.SS1.p3.3.m3.2.3.3.2.cmml" xref="S3.SS1.p3.3.m3.2.3.3.2">𝐸</ci><interval closure="open" id="S3.SS1.p3.3.m3.2.3.3.3.1.cmml" xref="S3.SS1.p3.3.m3.2.3.3.3.2"><cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">0</cn><cn id="S3.SS1.p3.3.m3.2.2.cmml" type="integer" xref="S3.SS1.p3.3.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.2c">D_{\phi}:E\rightarrow(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.2d">italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT : italic_E → ( 0 , 1 )</annotation></semantics></math> is a discriminative classifier, both optimized iteratively.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">Nevertheless, the original GAIL framework induces a reward function that is strictly non-negative, making it inherently incapable of recovering the true underlying reward in our setting, which may include negative values (Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.E1" title="In 2.1 GFlowNets ‣ 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>). To address this limitation, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib29" title="">29</a>]</cite> and extract an unbiased edge-level reward function <math alttext="R_{E}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝑅</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">R_{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> from the classifier:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{E}(s,s^{\prime})=\log D_{\phi}(s,s^{\prime})-\log\left(1-D_{\phi}(s,s^{%
\prime})\right)" class="ltx_Math" display="block" id="S3.E5.m1.7"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7" xref="S3.E5.m1.7.7.cmml"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.cmml"><msub id="S3.E5.m1.5.5.1.3" xref="S3.E5.m1.5.5.1.3.cmml"><mi id="S3.E5.m1.5.5.1.3.2" xref="S3.E5.m1.5.5.1.3.2.cmml">R</mi><mi id="S3.E5.m1.5.5.1.3.3" xref="S3.E5.m1.5.5.1.3.3.cmml">E</mi></msub><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.2.cmml"><mo id="S3.E5.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">s</mi><mo id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.2.cmml">,</mo><msup id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">s</mi><mo id="S3.E5.m1.5.5.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E5.m1.5.5.1.1.1.4" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.4" xref="S3.E5.m1.7.7.4.cmml">=</mo><mrow id="S3.E5.m1.7.7.3" xref="S3.E5.m1.7.7.3.cmml"><mrow id="S3.E5.m1.6.6.2.1" xref="S3.E5.m1.6.6.2.1.cmml"><mrow id="S3.E5.m1.6.6.2.1.3" xref="S3.E5.m1.6.6.2.1.3.cmml"><mi id="S3.E5.m1.6.6.2.1.3.1" xref="S3.E5.m1.6.6.2.1.3.1.cmml">log</mi><mo id="S3.E5.m1.6.6.2.1.3a" lspace="0.167em" xref="S3.E5.m1.6.6.2.1.3.cmml">⁡</mo><msub id="S3.E5.m1.6.6.2.1.3.2" xref="S3.E5.m1.6.6.2.1.3.2.cmml"><mi id="S3.E5.m1.6.6.2.1.3.2.2" xref="S3.E5.m1.6.6.2.1.3.2.2.cmml">D</mi><mi id="S3.E5.m1.6.6.2.1.3.2.3" xref="S3.E5.m1.6.6.2.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E5.m1.6.6.2.1.2" xref="S3.E5.m1.6.6.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.2.1.1.1" xref="S3.E5.m1.6.6.2.1.1.2.cmml"><mo id="S3.E5.m1.6.6.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.6.6.2.1.1.2.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">s</mi><mo id="S3.E5.m1.6.6.2.1.1.1.3" xref="S3.E5.m1.6.6.2.1.1.2.cmml">,</mo><msup id="S3.E5.m1.6.6.2.1.1.1.1" xref="S3.E5.m1.6.6.2.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.2.1.1.1.1.2" xref="S3.E5.m1.6.6.2.1.1.1.1.2.cmml">s</mi><mo id="S3.E5.m1.6.6.2.1.1.1.1.3" xref="S3.E5.m1.6.6.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E5.m1.6.6.2.1.1.1.4" stretchy="false" xref="S3.E5.m1.6.6.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.3.3" xref="S3.E5.m1.7.7.3.3.cmml">−</mo><mrow id="S3.E5.m1.7.7.3.2.1" xref="S3.E5.m1.7.7.3.2.2.cmml"><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">log</mi><mo id="S3.E5.m1.7.7.3.2.1a" xref="S3.E5.m1.7.7.3.2.2.cmml">⁡</mo><mrow id="S3.E5.m1.7.7.3.2.1.1" xref="S3.E5.m1.7.7.3.2.2.cmml"><mo id="S3.E5.m1.7.7.3.2.1.1.2" xref="S3.E5.m1.7.7.3.2.2.cmml">(</mo><mrow id="S3.E5.m1.7.7.3.2.1.1.1" xref="S3.E5.m1.7.7.3.2.1.1.1.cmml"><mn id="S3.E5.m1.7.7.3.2.1.1.1.3" xref="S3.E5.m1.7.7.3.2.1.1.1.3.cmml">1</mn><mo id="S3.E5.m1.7.7.3.2.1.1.1.2" xref="S3.E5.m1.7.7.3.2.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.7.7.3.2.1.1.1.1" xref="S3.E5.m1.7.7.3.2.1.1.1.1.cmml"><msub id="S3.E5.m1.7.7.3.2.1.1.1.1.3" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.3.2.1.1.1.1.3.2" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3.2.cmml">D</mi><mi id="S3.E5.m1.7.7.3.2.1.1.1.1.3.3" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.7.7.3.2.1.1.1.1.2" xref="S3.E5.m1.7.7.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">s</mi><mo id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.7.7.3.2.1.1.3" xref="S3.E5.m1.7.7.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.cmml" xref="S3.E5.m1.7.7"><eq id="S3.E5.m1.7.7.4.cmml" xref="S3.E5.m1.7.7.4"></eq><apply id="S3.E5.m1.5.5.1.cmml" xref="S3.E5.m1.5.5.1"><times id="S3.E5.m1.5.5.1.2.cmml" xref="S3.E5.m1.5.5.1.2"></times><apply id="S3.E5.m1.5.5.1.3.cmml" xref="S3.E5.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.3.1.cmml" xref="S3.E5.m1.5.5.1.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.3.2.cmml" xref="S3.E5.m1.5.5.1.3.2">𝑅</ci><ci id="S3.E5.m1.5.5.1.3.3.cmml" xref="S3.E5.m1.5.5.1.3.3">𝐸</ci></apply><interval closure="open" id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑠</ci><apply id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.5.5.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S3.E5.m1.7.7.3.cmml" xref="S3.E5.m1.7.7.3"><minus id="S3.E5.m1.7.7.3.3.cmml" xref="S3.E5.m1.7.7.3.3"></minus><apply id="S3.E5.m1.6.6.2.1.cmml" xref="S3.E5.m1.6.6.2.1"><times id="S3.E5.m1.6.6.2.1.2.cmml" xref="S3.E5.m1.6.6.2.1.2"></times><apply id="S3.E5.m1.6.6.2.1.3.cmml" xref="S3.E5.m1.6.6.2.1.3"><log id="S3.E5.m1.6.6.2.1.3.1.cmml" xref="S3.E5.m1.6.6.2.1.3.1"></log><apply id="S3.E5.m1.6.6.2.1.3.2.cmml" xref="S3.E5.m1.6.6.2.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.1.3.2.1.cmml" xref="S3.E5.m1.6.6.2.1.3.2">subscript</csymbol><ci id="S3.E5.m1.6.6.2.1.3.2.2.cmml" xref="S3.E5.m1.6.6.2.1.3.2.2">𝐷</ci><ci id="S3.E5.m1.6.6.2.1.3.2.3.cmml" xref="S3.E5.m1.6.6.2.1.3.2.3">italic-ϕ</ci></apply></apply><interval closure="open" id="S3.E5.m1.6.6.2.1.1.2.cmml" xref="S3.E5.m1.6.6.2.1.1.1"><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑠</ci><apply id="S3.E5.m1.6.6.2.1.1.1.1.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.6.6.2.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S3.E5.m1.7.7.3.2.2.cmml" xref="S3.E5.m1.7.7.3.2.1"><log id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"></log><apply id="S3.E5.m1.7.7.3.2.1.1.1.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1"><minus id="S3.E5.m1.7.7.3.2.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.2"></minus><cn id="S3.E5.m1.7.7.3.2.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.7.7.3.2.1.1.1.3">1</cn><apply id="S3.E5.m1.7.7.3.2.1.1.1.1.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1"><times id="S3.E5.m1.7.7.3.2.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.2"></times><apply id="S3.E5.m1.7.7.3.2.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.3.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3.2">𝐷</ci><ci id="S3.E5.m1.7.7.3.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E5.m1.7.7.3.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑠</ci><apply id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.3.2.1.1.1.1.1.1.1.3">′</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">R_{E}(s,s^{\prime})=\log D_{\phi}(s,s^{\prime})-\log\left(1-D_{\phi}(s,s^{%
\prime})\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.7d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = roman_log italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) - roman_log ( 1 - italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">Intuitively, the learned edge reward reflects the degree to which an expert policy will prefer to traverse a given edge, thereby quantifying the edge’s importance for learning a high-quality GFlowNet policy. The complete edge reward extraction procedure is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg2" title="Algorithm 2 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A1" title="Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>(b) and Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS2" title="D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.2</span></a>, the learned edge rewards exhibit strong generalization, assigning meaningful values even to transitions not observed in the dataset. This guides the policy to allocate attention across the entire environment DAG, rather than staying confined to regions near the training data, as in prior methods. Notably, such edge-level supervision aligns more closely with the original objective of GFlowNets: leveraging structured, multi-step decision-making to decompose the target distribution, rather than relying on proxy models for direct approximation.
Next, we leverage these edge rewards to guide both DAG pruning and prioritized backward sampling of training trajectories, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reward-guided pruning and prioritized backward sampling</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Although the learned edge reward provides a meaningful signal at the transition level, directly incorporating it into the training objective introduces sensitivity to function approximation errors, which can distort the optimization process and degrade policy performance—mirroring the limitations commonly observed with proxy reward models. To enhance both the robustness and efficiency of the algorithm, we propose two indirect mechanisms for shaping the GFlowNet policy: <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">reward-guided pruning</em> and <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.2">prioritized backward sampling</em>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.4">Guided by the learned edge reward, TD-GFN strategically removes low-utility edges from the environment DAG <math alttext="G=(V,E)" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.2"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.3" xref="S3.SS2.p2.1.m1.2.3.cmml"><mi id="S3.SS2.p2.1.m1.2.3.2" xref="S3.SS2.p2.1.m1.2.3.2.cmml">G</mi><mo id="S3.SS2.p2.1.m1.2.3.1" xref="S3.SS2.p2.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.2.3.3.2" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">V</mi><mo id="S3.SS2.p2.1.m1.2.3.3.2.2" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">E</mi><mo id="S3.SS2.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.3.cmml" xref="S3.SS2.p2.1.m1.2.3"><eq id="S3.SS2.p2.1.m1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.3.1"></eq><ci id="S3.SS2.p2.1.m1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S3.SS2.p2.1.m1.2.3.3.1.cmml" xref="S3.SS2.p2.1.m1.2.3.3.2"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑉</ci><ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">G=(V,E)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.2d">italic_G = ( italic_V , italic_E )</annotation></semantics></math>. Specifically, we approximate the distribution of edge rewards using a batch <math alttext="\mathcal{D}_{R_{E}}=\{R_{E}(s_{i},\text{selected}(\pi_{\psi}(\cdot\mid s_{i}))%
)\}_{i=1}^{\mathcal{B}}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1b"><msub id="S3.SS2.p2.2.m2.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.2.2">𝒟</mi><msub id="S3.SS2.p2.2.m2.1.2.3"><mi id="S3.SS2.p2.2.m2.1.2.3.2">R</mi><mi id="S3.SS2.p2.2.m2.1.2.3.3">E</mi></msub></msub><mo id="S3.SS2.p2.2.m2.1.3">=</mo><msubsup id="S3.SS2.p2.2.m2.1.4"><mrow id="S3.SS2.p2.2.m2.1.4.2.2"><mo id="S3.SS2.p2.2.m2.1.4.2.2.1" stretchy="false">{</mo><msub id="S3.SS2.p2.2.m2.1.4.2.2.2"><mi id="S3.SS2.p2.2.m2.1.4.2.2.2.2">R</mi><mi id="S3.SS2.p2.2.m2.1.4.2.2.2.3">E</mi></msub><mrow id="S3.SS2.p2.2.m2.1.4.2.2.3"><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.1" stretchy="false">(</mo><msub id="S3.SS2.p2.2.m2.1.4.2.2.3.2"><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.2.2">s</mi><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.2.3">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.3">,</mo><mtext id="S3.SS2.p2.2.m2.1.1">selected</mtext><mrow id="S3.SS2.p2.2.m2.1.4.2.2.3.4"><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.1" stretchy="false">(</mo><msub id="S3.SS2.p2.2.m2.1.4.2.2.3.4.2"><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.4.2.2">π</mi><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.4.2.3">ψ</mi></msub><mrow id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3"><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.1" stretchy="false">(</mo><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.2" lspace="0em" rspace="0em">⋅</mo><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.4"><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.4.2">s</mi><mi id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.4.3">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.3.5" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.4.4" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.2.m2.1.4.2.2.3.5" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.2.m2.1.4.2.2.4" stretchy="false">}</mo></mrow><mrow id="S3.SS2.p2.2.m2.1.4.2.3"><mi id="S3.SS2.p2.2.m2.1.4.2.3.2">i</mi><mo id="S3.SS2.p2.2.m2.1.4.2.3.1">=</mo><mn id="S3.SS2.p2.2.m2.1.4.2.3.3">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.4.3">ℬ</mi></msubsup></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{D}_{R_{E}}=\{R_{E}(s_{i},\text{selected}(\pi_{\psi}(\cdot\mid s_{i}))%
)\}_{i=1}^{\mathcal{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , selected ( italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( ⋅ ∣ italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_B end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">π</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝜋</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> denotes the imitation policy obtained during edge reward learning (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg2" title="Algorithm 2 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>), serving as a surrogate for expert behavior. An edge <math alttext="(s\rightarrow s^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml"><mo id="S3.SS2.p2.4.m4.1.1.1.2" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.4.m4.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.2.cmml">s</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.1" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.1.cmml">→</mo><msup id="S3.SS2.p2.4.m4.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.SS2.p2.4.m4.1.1.1.3" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1">→</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.2">𝑠</ci><apply id="S3.SS2.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">(s\rightarrow s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">( italic_s → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> is pruned from the graph if it lies in the low-density region of the reward distribution:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{E}(s,s^{\prime})&lt;\text{mean}(\mathcal{D}_{R_{E}})-K\cdot\text{std}(\mathcal%
{D}_{R_{E}})," class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.3.2.cmml">R</mi><mi id="S3.E6.m1.2.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.3.3.cmml">E</mi></msub><mo id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E6.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">s</mi><mo id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml">,</mo><msup id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E6.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.4" xref="S3.E6.m1.2.2.1.1.4.cmml">&lt;</mo><mrow id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml"><mrow id="S3.E6.m1.2.2.1.1.2.1" xref="S3.E6.m1.2.2.1.1.2.1.cmml"><mtext id="S3.E6.m1.2.2.1.1.2.1.3" xref="S3.E6.m1.2.2.1.1.2.1.3a.cmml">mean</mtext><mo id="S3.E6.m1.2.2.1.1.2.1.2" xref="S3.E6.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml">𝒟</mi><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">R</mi><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">E</mi></msub></msub><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.3" stretchy="false" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.3.3" xref="S3.E6.m1.2.2.1.1.3.3.cmml">−</mo><mrow id="S3.E6.m1.2.2.1.1.3.2" xref="S3.E6.m1.2.2.1.1.3.2.cmml"><mrow id="S3.E6.m1.2.2.1.1.3.2.3" xref="S3.E6.m1.2.2.1.1.3.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.3.2.3.2" xref="S3.E6.m1.2.2.1.1.3.2.3.2.cmml">K</mi><mo id="S3.E6.m1.2.2.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.2.2.1.1.3.2.3.1.cmml">⋅</mo><mtext id="S3.E6.m1.2.2.1.1.3.2.3.3" xref="S3.E6.m1.2.2.1.1.3.2.3.3a.cmml">std</mtext></mrow><mo id="S3.E6.m1.2.2.1.1.3.2.2" xref="S3.E6.m1.2.2.1.1.3.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.3.2.1.1" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.cmml"><mo id="S3.E6.m1.2.2.1.1.3.2.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.3.2.1.1.1" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.3.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.2.cmml">𝒟</mi><msub id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.2.cmml">R</mi><mi id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.3.cmml">E</mi></msub></msub><mo id="S3.E6.m1.2.2.1.1.3.2.1.1.3" stretchy="false" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><lt id="S3.E6.m1.2.2.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.4"></lt><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.3.2">𝑅</ci><ci id="S3.E6.m1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3.3">𝐸</ci></apply><interval closure="open" id="S3.E6.m1.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑠</ci><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"><minus id="S3.E6.m1.2.2.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.3.3"></minus><apply id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1"><times id="S3.E6.m1.2.2.1.1.2.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.2"></times><ci id="S3.E6.m1.2.2.1.1.2.1.3a.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3"><mtext id="S3.E6.m1.2.2.1.1.2.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3">mean</mtext></ci><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.2">𝒟</ci><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.2">𝑅</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.3.3">𝐸</ci></apply></apply></apply><apply id="S3.E6.m1.2.2.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2"><times id="S3.E6.m1.2.2.1.1.3.2.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2.2"></times><apply id="S3.E6.m1.2.2.1.1.3.2.3.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3"><ci id="S3.E6.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3.1">⋅</ci><ci id="S3.E6.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3.2">𝐾</ci><ci id="S3.E6.m1.2.2.1.1.3.2.3.3a.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3.3"><mtext id="S3.E6.m1.2.2.1.1.3.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3.3">std</mtext></ci></apply><apply id="S3.E6.m1.2.2.1.1.3.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.3.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.3.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.2">𝒟</ci><apply id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.2">𝑅</ci><ci id="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.3.2.1.1.1.3.3">𝐸</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">R_{E}(s,s^{\prime})&lt;\text{mean}(\mathcal{D}_{R_{E}})-K\cdot\text{std}(\mathcal%
{D}_{R_{E}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) &lt; mean ( caligraphic_D start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_K ⋅ std ( caligraphic_D start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.8">where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m1.1"><semantics id="S3.SS2.p2.5.m1.1a"><mi id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b"><ci id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m1.1d">italic_K</annotation></semantics></math> is a pruning threshold hyperparameter, and <math alttext="\text{mean}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m2.1"><semantics id="S3.SS2.p2.6.m2.1a"><mrow id="S3.SS2.p2.6.m2.1.2" xref="S3.SS2.p2.6.m2.1.2.cmml"><mtext id="S3.SS2.p2.6.m2.1.2.2" xref="S3.SS2.p2.6.m2.1.2.2a.cmml">mean</mtext><mo id="S3.SS2.p2.6.m2.1.2.1" xref="S3.SS2.p2.6.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.6.m2.1.2.3.2" xref="S3.SS2.p2.6.m2.1.2.cmml"><mo id="S3.SS2.p2.6.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.6.m2.1.2.cmml">(</mo><mo id="S3.SS2.p2.6.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.6.m2.1.1.cmml">⋅</mo><mo id="S3.SS2.p2.6.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m2.1b"><apply id="S3.SS2.p2.6.m2.1.2.cmml" xref="S3.SS2.p2.6.m2.1.2"><times id="S3.SS2.p2.6.m2.1.2.1.cmml" xref="S3.SS2.p2.6.m2.1.2.1"></times><ci id="S3.SS2.p2.6.m2.1.2.2a.cmml" xref="S3.SS2.p2.6.m2.1.2.2"><mtext id="S3.SS2.p2.6.m2.1.2.2.cmml" xref="S3.SS2.p2.6.m2.1.2.2">mean</mtext></ci><ci id="S3.SS2.p2.6.m2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m2.1c">\text{mean}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m2.1d">mean ( ⋅ )</annotation></semantics></math>, <math alttext="\text{std}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m3.1"><semantics id="S3.SS2.p2.7.m3.1a"><mrow id="S3.SS2.p2.7.m3.1.2" xref="S3.SS2.p2.7.m3.1.2.cmml"><mtext id="S3.SS2.p2.7.m3.1.2.2" xref="S3.SS2.p2.7.m3.1.2.2a.cmml">std</mtext><mo id="S3.SS2.p2.7.m3.1.2.1" xref="S3.SS2.p2.7.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.7.m3.1.2.3.2" xref="S3.SS2.p2.7.m3.1.2.cmml"><mo id="S3.SS2.p2.7.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.7.m3.1.2.cmml">(</mo><mo id="S3.SS2.p2.7.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.7.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.p2.7.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m3.1b"><apply id="S3.SS2.p2.7.m3.1.2.cmml" xref="S3.SS2.p2.7.m3.1.2"><times id="S3.SS2.p2.7.m3.1.2.1.cmml" xref="S3.SS2.p2.7.m3.1.2.1"></times><ci id="S3.SS2.p2.7.m3.1.2.2a.cmml" xref="S3.SS2.p2.7.m3.1.2.2"><mtext id="S3.SS2.p2.7.m3.1.2.2.cmml" xref="S3.SS2.p2.7.m3.1.2.2">std</mtext></ci><ci id="S3.SS2.p2.7.m3.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m3.1c">\text{std}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m3.1d">std ( ⋅ )</annotation></semantics></math> denote the empirical mean and standard deviation over the sampled batch <math alttext="\mathcal{D}_{R_{E}}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m4.1"><semantics id="S3.SS2.p2.8.m4.1a"><msub id="S3.SS2.p2.8.m4.1.1" xref="S3.SS2.p2.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m4.1.1.2" xref="S3.SS2.p2.8.m4.1.1.2.cmml">𝒟</mi><msub id="S3.SS2.p2.8.m4.1.1.3" xref="S3.SS2.p2.8.m4.1.1.3.cmml"><mi id="S3.SS2.p2.8.m4.1.1.3.2" xref="S3.SS2.p2.8.m4.1.1.3.2.cmml">R</mi><mi id="S3.SS2.p2.8.m4.1.1.3.3" xref="S3.SS2.p2.8.m4.1.1.3.3.cmml">E</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m4.1b"><apply id="S3.SS2.p2.8.m4.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m4.1.1.2.cmml" xref="S3.SS2.p2.8.m4.1.1.2">𝒟</ci><apply id="S3.SS2.p2.8.m4.1.1.3.cmml" xref="S3.SS2.p2.8.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.3.1.cmml" xref="S3.SS2.p2.8.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.8.m4.1.1.3.2.cmml" xref="S3.SS2.p2.8.m4.1.1.3.2">𝑅</ci><ci id="S3.SS2.p2.8.m4.1.1.3.3.cmml" xref="S3.SS2.p2.8.m4.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m4.1c">\mathcal{D}_{R_{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m4.1d">caligraphic_D start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.3">After applying this criterion, we remove all edges that are disconnected from the root node <math alttext="s_{0}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">s</mi><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑠</ci><cn id="S3.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in a pruned subgraph <math alttext="G^{\prime}=(V^{\prime},E^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.2"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml"><msup id="S3.SS2.p3.2.m2.2.2.4" xref="S3.SS2.p3.2.m2.2.2.4.cmml"><mi id="S3.SS2.p3.2.m2.2.2.4.2" xref="S3.SS2.p3.2.m2.2.2.4.2.cmml">G</mi><mo id="S3.SS2.p3.2.m2.2.2.4.3" xref="S3.SS2.p3.2.m2.2.2.4.3.cmml">′</mo></msup><mo id="S3.SS2.p3.2.m2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS2.p3.2.m2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml"><mo id="S3.SS2.p3.2.m2.2.2.2.2.3" stretchy="false" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">(</mo><msup id="S3.SS2.p3.2.m2.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.2" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml">V</mi><mo id="S3.SS2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS2.p3.2.m2.2.2.2.2.4" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><msup id="S3.SS2.p3.2.m2.2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.2.m2.2.2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.2.2.cmml">E</mi><mo id="S3.SS2.p3.2.m2.2.2.2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.SS2.p3.2.m2.2.2.2.2.5" stretchy="false" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2"><eq id="S3.SS2.p3.2.m2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.3"></eq><apply id="S3.SS2.p3.2.m2.2.2.4.cmml" xref="S3.SS2.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.4.1.cmml" xref="S3.SS2.p3.2.m2.2.2.4">superscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.4.2.cmml" xref="S3.SS2.p3.2.m2.2.2.4.2">𝐺</ci><ci id="S3.SS2.p3.2.m2.2.2.4.3.cmml" xref="S3.SS2.p3.2.m2.2.2.4.3">′</ci></apply><interval closure="open" id="S3.SS2.p3.2.m2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2"><apply id="S3.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2">𝑉</ci><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS2.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2.2">𝐸</ci><ci id="S3.SS2.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">G^{\prime}=(V^{\prime},E^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.2d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> and an updated set of terminal nodes <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">𝒳</mi><mo id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝒳</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Notably, pruning is conducted over the full environment DAG, rather than being limited to dataset-observed transitions, enabling the retention of transitions that, while unobserved in the dataset, may potentially lead to high-reward regions.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">This pruning approach concentrates learning on informative areas of the state space and improves training efficiency by reducing the complexity of model fitting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib31" title="">31</a>]</cite>. The resulting subgraph defines a more compact yet expressive action space that prioritizes structurally meaningful and high-reward trajectories, thereby supporting policy generalization beyond observed data while remaining anchored in reliable behavioral signals.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.5">To train the policy more efficiently on the pruned graph, we additionally propose a prioritized backward sampling mechanism that selects training trajectories from high-value terminal nodes. Terminal states are sampled from the intersection of the pruned terminal set <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msup id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">𝒳</mi><mo id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝒳</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and dataset-supported objects <math alttext="\{s_{T_{i}}\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><msubsup id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mrow id="S3.SS2.p5.2.m2.1.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS2.p5.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p5.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.p5.2.m2.1.1.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml">s</mi><msub id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S3.SS2.p5.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p5.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p5.2.m2.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p5.2.m2.1.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p5.2.m2.1.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><set id="S3.SS2.p5.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1"><apply id="S3.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set><apply id="S3.SS2.p5.2.m2.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3"><eq id="S3.SS2.p5.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3.1"></eq><ci id="S3.SS2.p5.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.p5.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p5.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\{s_{T_{i}}\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">{ italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, with probability proportional to their known rewards. From each sampled terminal node <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><mi id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_x</annotation></semantics></math>, we recursively perform backward sampling toward the root <math alttext="s_{0}" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">s</mi><mn id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑠</ci><cn id="S3.SS2.p5.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p5.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> using a learned backward policy <math alttext="\mathcal{P}_{B}" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><msub id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">𝒫</mi><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝒫</ci><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\mathcal{P}_{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}_{B}(s_{t}|s_{t+1})=\frac{\exp{\{R_{E}(s_{t},s_{t+1})\}}}{\sum_{(s,%
s_{t+1})\in E^{\prime}}\exp{\{R_{E}(s,s_{t+1})\}}}," class="ltx_Math" display="block" id="S3.E7.m1.8"><semantics id="S3.E7.m1.8a"><mrow id="S3.E7.m1.8.8.1" xref="S3.E7.m1.8.8.1.1.cmml"><mrow id="S3.E7.m1.8.8.1.1" xref="S3.E7.m1.8.8.1.1.cmml"><mrow id="S3.E7.m1.8.8.1.1.1" xref="S3.E7.m1.8.8.1.1.1.cmml"><msub id="S3.E7.m1.8.8.1.1.1.3" xref="S3.E7.m1.8.8.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.8.8.1.1.1.3.2" xref="S3.E7.m1.8.8.1.1.1.3.2.cmml">𝒫</mi><mi id="S3.E7.m1.8.8.1.1.1.3.3" xref="S3.E7.m1.8.8.1.1.1.3.3.cmml">B</mi></msub><mo id="S3.E7.m1.8.8.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.8.8.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.8.8.1.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.8.8.1.1.1.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.2.2" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.2.3" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E7.m1.8.8.1.1.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E7.m1.8.8.1.1.1.1.1.1.3" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.2" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.1" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.3" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E7.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.8.8.1.1.2" xref="S3.E7.m1.8.8.1.1.2.cmml">=</mo><mfrac id="S3.E7.m1.7.7" xref="S3.E7.m1.7.7.cmml"><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E7.m1.2.2.2.2a" xref="S3.E7.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E7.m1.2.2.2.2.1" xref="S3.E7.m1.2.2.2.3.cmml"><mo id="S3.E7.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E7.m1.2.2.2.3.cmml">{</mo><mrow id="S3.E7.m1.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.1.1.cmml"><msub id="S3.E7.m1.2.2.2.2.1.1.4" xref="S3.E7.m1.2.2.2.2.1.1.4.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.4.2" xref="S3.E7.m1.2.2.2.2.1.1.4.2.cmml">R</mi><mi id="S3.E7.m1.2.2.2.2.1.1.4.3" xref="S3.E7.m1.2.2.2.2.1.1.4.3.cmml">E</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.3.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.2.1.1.2.2" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml"><mo id="S3.E7.m1.2.2.2.2.1.1.2.2.3" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml">(</mo><msub id="S3.E7.m1.2.2.2.2.1.1.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.1.2.2.4" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E7.m1.2.2.2.2.1.1.2.2.2" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.2.cmml">s</mi><mrow id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.1" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.1.cmml">+</mo><mn id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.2.2.2.2.1.1.2.2.5" stretchy="false" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E7.m1.2.2.2.3.cmml">}</mo></mrow></mrow><mrow id="S3.E7.m1.7.7.7" xref="S3.E7.m1.7.7.7.cmml"><msub id="S3.E7.m1.7.7.7.6" xref="S3.E7.m1.7.7.7.6.cmml"><mo id="S3.E7.m1.7.7.7.6.2" xref="S3.E7.m1.7.7.7.6.2.cmml">∑</mo><mrow id="S3.E7.m1.4.4.4.2.2" xref="S3.E7.m1.4.4.4.2.2.cmml"><mrow id="S3.E7.m1.4.4.4.2.2.2.1" xref="S3.E7.m1.4.4.4.2.2.2.2.cmml"><mo id="S3.E7.m1.4.4.4.2.2.2.1.2" stretchy="false" xref="S3.E7.m1.4.4.4.2.2.2.2.cmml">(</mo><mi id="S3.E7.m1.3.3.3.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.cmml">s</mi><mo id="S3.E7.m1.4.4.4.2.2.2.1.3" xref="S3.E7.m1.4.4.4.2.2.2.2.cmml">,</mo><msub id="S3.E7.m1.4.4.4.2.2.2.1.1" xref="S3.E7.m1.4.4.4.2.2.2.1.1.cmml"><mi id="S3.E7.m1.4.4.4.2.2.2.1.1.2" xref="S3.E7.m1.4.4.4.2.2.2.1.1.2.cmml">s</mi><mrow id="S3.E7.m1.4.4.4.2.2.2.1.1.3" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.cmml"><mi id="S3.E7.m1.4.4.4.2.2.2.1.1.3.2" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.2.cmml">t</mi><mo id="S3.E7.m1.4.4.4.2.2.2.1.1.3.1" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.E7.m1.4.4.4.2.2.2.1.1.3.3" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.4.4.4.2.2.2.1.4" stretchy="false" xref="S3.E7.m1.4.4.4.2.2.2.2.cmml">)</mo></mrow><mo id="S3.E7.m1.4.4.4.2.2.3" xref="S3.E7.m1.4.4.4.2.2.3.cmml">∈</mo><msup id="S3.E7.m1.4.4.4.2.2.4" xref="S3.E7.m1.4.4.4.2.2.4.cmml"><mi id="S3.E7.m1.4.4.4.2.2.4.2" xref="S3.E7.m1.4.4.4.2.2.4.2.cmml">E</mi><mo id="S3.E7.m1.4.4.4.2.2.4.3" xref="S3.E7.m1.4.4.4.2.2.4.3.cmml">′</mo></msup></mrow></msub><mrow id="S3.E7.m1.7.7.7.5.1" xref="S3.E7.m1.7.7.7.5.2.cmml"><mi id="S3.E7.m1.6.6.6.4" xref="S3.E7.m1.6.6.6.4.cmml">exp</mi><mo id="S3.E7.m1.7.7.7.5.1a" xref="S3.E7.m1.7.7.7.5.2.cmml">⁡</mo><mrow id="S3.E7.m1.7.7.7.5.1.1" xref="S3.E7.m1.7.7.7.5.2.cmml"><mo id="S3.E7.m1.7.7.7.5.1.1.2" stretchy="false" xref="S3.E7.m1.7.7.7.5.2.cmml">{</mo><mrow id="S3.E7.m1.7.7.7.5.1.1.1" xref="S3.E7.m1.7.7.7.5.1.1.1.cmml"><msub id="S3.E7.m1.7.7.7.5.1.1.1.3" xref="S3.E7.m1.7.7.7.5.1.1.1.3.cmml"><mi id="S3.E7.m1.7.7.7.5.1.1.1.3.2" xref="S3.E7.m1.7.7.7.5.1.1.1.3.2.cmml">R</mi><mi id="S3.E7.m1.7.7.7.5.1.1.1.3.3" xref="S3.E7.m1.7.7.7.5.1.1.1.3.3.cmml">E</mi></msub><mo id="S3.E7.m1.7.7.7.5.1.1.1.2" xref="S3.E7.m1.7.7.7.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.7.7.7.5.1.1.1.1.1" xref="S3.E7.m1.7.7.7.5.1.1.1.1.2.cmml"><mo id="S3.E7.m1.7.7.7.5.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.7.7.7.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.5.5.5.3" xref="S3.E7.m1.5.5.5.3.cmml">s</mi><mo id="S3.E7.m1.7.7.7.5.1.1.1.1.1.3" xref="S3.E7.m1.7.7.7.5.1.1.1.1.2.cmml">,</mo><msub id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.2" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.2" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.1" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.3" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.7.7.7.5.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.7.7.7.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.7.7.7.5.1.1.3" stretchy="false" xref="S3.E7.m1.7.7.7.5.2.cmml">}</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E7.m1.8.8.1.2" xref="S3.E7.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.8b"><apply id="S3.E7.m1.8.8.1.1.cmml" xref="S3.E7.m1.8.8.1"><eq id="S3.E7.m1.8.8.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.2"></eq><apply id="S3.E7.m1.8.8.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1"><times id="S3.E7.m1.8.8.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.2"></times><apply id="S3.E7.m1.8.8.1.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.3.1.cmml" xref="S3.E7.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.3.2.cmml" xref="S3.E7.m1.8.8.1.1.1.3.2">𝒫</ci><ci id="S3.E7.m1.8.8.1.1.1.3.3.cmml" xref="S3.E7.m1.8.8.1.1.1.3.3">𝐵</ci></apply><apply id="S3.E7.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E7.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.2">𝑠</ci><apply id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3"><plus id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E7.m1.8.8.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7"><divide id="S3.E7.m1.7.7.8.cmml" xref="S3.E7.m1.7.7"></divide><apply id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2"><exp id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"></exp><apply id="S3.E7.m1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1"><times id="S3.E7.m1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3"></times><apply id="S3.E7.m1.2.2.2.2.1.1.4.cmml" xref="S3.E7.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.4.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.4.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.4.2">𝑅</ci><ci id="S3.E7.m1.2.2.2.2.1.1.4.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.4.3">𝐸</ci></apply><interval closure="open" id="S3.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2"><apply id="S3.E7.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.2">𝑠</ci><ci id="S3.E7.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.2">𝑠</ci><apply id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3"><plus id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.1"></plus><ci id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.2">𝑡</ci><cn id="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E7.m1.2.2.2.2.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply><apply id="S3.E7.m1.7.7.7.cmml" xref="S3.E7.m1.7.7.7"><apply id="S3.E7.m1.7.7.7.6.cmml" xref="S3.E7.m1.7.7.7.6"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.7.6.1.cmml" xref="S3.E7.m1.7.7.7.6">subscript</csymbol><sum id="S3.E7.m1.7.7.7.6.2.cmml" xref="S3.E7.m1.7.7.7.6.2"></sum><apply id="S3.E7.m1.4.4.4.2.2.cmml" xref="S3.E7.m1.4.4.4.2.2"><in id="S3.E7.m1.4.4.4.2.2.3.cmml" xref="S3.E7.m1.4.4.4.2.2.3"></in><interval closure="open" id="S3.E7.m1.4.4.4.2.2.2.2.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1"><ci id="S3.E7.m1.3.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1">𝑠</ci><apply id="S3.E7.m1.4.4.4.2.2.2.1.1.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.4.2.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E7.m1.4.4.4.2.2.2.1.1.2.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1.2">𝑠</ci><apply id="S3.E7.m1.4.4.4.2.2.2.1.1.3.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3"><plus id="S3.E7.m1.4.4.4.2.2.2.1.1.3.1.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.1"></plus><ci id="S3.E7.m1.4.4.4.2.2.2.1.1.3.2.cmml" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.2">𝑡</ci><cn id="S3.E7.m1.4.4.4.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.E7.m1.4.4.4.2.2.2.1.1.3.3">1</cn></apply></apply></interval><apply id="S3.E7.m1.4.4.4.2.2.4.cmml" xref="S3.E7.m1.4.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.4.2.2.4.1.cmml" xref="S3.E7.m1.4.4.4.2.2.4">superscript</csymbol><ci id="S3.E7.m1.4.4.4.2.2.4.2.cmml" xref="S3.E7.m1.4.4.4.2.2.4.2">𝐸</ci><ci id="S3.E7.m1.4.4.4.2.2.4.3.cmml" xref="S3.E7.m1.4.4.4.2.2.4.3">′</ci></apply></apply></apply><apply id="S3.E7.m1.7.7.7.5.2.cmml" xref="S3.E7.m1.7.7.7.5.1"><exp id="S3.E7.m1.6.6.6.4.cmml" xref="S3.E7.m1.6.6.6.4"></exp><apply id="S3.E7.m1.7.7.7.5.1.1.1.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1"><times id="S3.E7.m1.7.7.7.5.1.1.1.2.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.2"></times><apply id="S3.E7.m1.7.7.7.5.1.1.1.3.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.7.5.1.1.1.3.1.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.7.7.7.5.1.1.1.3.2.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.3.2">𝑅</ci><ci id="S3.E7.m1.7.7.7.5.1.1.1.3.3.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.3.3">𝐸</ci></apply><interval closure="open" id="S3.E7.m1.7.7.7.5.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1"><ci id="S3.E7.m1.5.5.5.3.cmml" xref="S3.E7.m1.5.5.5.3">𝑠</ci><apply id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3"><plus id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.1"></plus><ci id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E7.m1.7.7.7.5.1.1.1.1.1.1.3.3">1</cn></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.8c">\mathcal{P}_{B}(s_{t}|s_{t+1})=\frac{\exp{\{R_{E}(s_{t},s_{t+1})\}}}{\sum_{(s,%
s_{t+1})\in E^{\prime}}\exp{\{R_{E}(s,s_{t+1})\}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.8d">caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) = divide start_ARG roman_exp { italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) } end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ∈ italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_exp { italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) } end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.6">This formulation is consistent with the reward shaping principles in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S2.E1" title="In 2.1 GFlowNets ‣ 2 Preliminaries ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>. By sharpening policy updates toward the most informative regions of the state space, this prioritized strategy reinforces the GFlowNet inductive bias of allocating sampling effort in proportion to reward, significantly improving sample efficiency <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib33" title="">33</a>]</cite>. Moreover, when combined with the pruning method described above, it helps mitigate the under-exploitation of terminal nodes discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib34" title="">34</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.3">Finally, we optimize the policy on the pruned DAG using the Flow-Matching (FM) objective <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>. By setting <math alttext="R(s)=0" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.2" xref="S3.SS2.p6.1.m1.1.2.cmml"><mrow id="S3.SS2.p6.1.m1.1.2.2" xref="S3.SS2.p6.1.m1.1.2.2.cmml"><mi id="S3.SS2.p6.1.m1.1.2.2.2" xref="S3.SS2.p6.1.m1.1.2.2.2.cmml">R</mi><mo id="S3.SS2.p6.1.m1.1.2.2.1" xref="S3.SS2.p6.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p6.1.m1.1.2.2.3.2" xref="S3.SS2.p6.1.m1.1.2.2.cmml"><mo id="S3.SS2.p6.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.p6.1.m1.1.2.2.cmml">(</mo><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">s</mi><mo id="S3.SS2.p6.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.p6.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p6.1.m1.1.2.1" xref="S3.SS2.p6.1.m1.1.2.1.cmml">=</mo><mn id="S3.SS2.p6.1.m1.1.2.3" xref="S3.SS2.p6.1.m1.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.2"><eq id="S3.SS2.p6.1.m1.1.2.1.cmml" xref="S3.SS2.p6.1.m1.1.2.1"></eq><apply id="S3.SS2.p6.1.m1.1.2.2.cmml" xref="S3.SS2.p6.1.m1.1.2.2"><times id="S3.SS2.p6.1.m1.1.2.2.1.cmml" xref="S3.SS2.p6.1.m1.1.2.2.1"></times><ci id="S3.SS2.p6.1.m1.1.2.2.2.cmml" xref="S3.SS2.p6.1.m1.1.2.2.2">𝑅</ci><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝑠</ci></apply><cn id="S3.SS2.p6.1.m1.1.2.3.cmml" type="integer" xref="S3.SS2.p6.1.m1.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">R(s)=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_R ( italic_s ) = 0</annotation></semantics></math> for all non-terminal states <math alttext="s" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.1"><semantics id="S3.SS2.p6.2.m2.1a"><mi id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.2.m2.1d">italic_s</annotation></semantics></math>, the objective for each sampled trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.1"><semantics id="S3.SS2.p6.3.m3.1a"><mi id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><ci id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.3.m3.1d">italic_τ</annotation></semantics></math> is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{FM}(\tau;\theta)=\sum_{s^{\prime}\in\tau}\left(\sum_{s:(s%
\rightarrow s^{\prime})\in E^{\prime}}F_{\theta}(s,s^{\prime})-R(s^{\prime})-%
\sum_{s^{\prime\prime}:(s^{\prime}\rightarrow s^{\prime\prime})\in E^{\prime}}%
F_{\theta}(s^{\prime},s^{\prime\prime})\right)^{2}," class="ltx_Math" display="block" id="S3.E8.m1.6"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.3" xref="S3.E8.m1.6.6.1.1.3.cmml"><msub id="S3.E8.m1.6.6.1.1.3.2" xref="S3.E8.m1.6.6.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.6.6.1.1.3.2.2" xref="S3.E8.m1.6.6.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.6.6.1.1.3.2.3" xref="S3.E8.m1.6.6.1.1.3.2.3.cmml"><mi id="S3.E8.m1.6.6.1.1.3.2.3.2" xref="S3.E8.m1.6.6.1.1.3.2.3.2.cmml">F</mi><mo id="S3.E8.m1.6.6.1.1.3.2.3.1" xref="S3.E8.m1.6.6.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.6.6.1.1.3.2.3.3" xref="S3.E8.m1.6.6.1.1.3.2.3.3.cmml">M</mi></mrow></msub><mo id="S3.E8.m1.6.6.1.1.3.1" xref="S3.E8.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.3.3.2" xref="S3.E8.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E8.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">τ</mi><mo id="S3.E8.m1.6.6.1.1.3.3.2.2" xref="S3.E8.m1.6.6.1.1.3.3.1.cmml">;</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">θ</mi><mo id="S3.E8.m1.6.6.1.1.3.3.2.3" stretchy="false" xref="S3.E8.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.2" rspace="0.111em" xref="S3.E8.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.6.6.1.1.1" xref="S3.E8.m1.6.6.1.1.1.cmml"><munder id="S3.E8.m1.6.6.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.6.6.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.6.6.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.2.3.cmml"><msup id="S3.E8.m1.6.6.1.1.1.2.3.2" xref="S3.E8.m1.6.6.1.1.1.2.3.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.2.3.2.2" xref="S3.E8.m1.6.6.1.1.1.2.3.2.2.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.2.3.2.3" xref="S3.E8.m1.6.6.1.1.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.E8.m1.6.6.1.1.1.2.3.1" xref="S3.E8.m1.6.6.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.E8.m1.6.6.1.1.1.2.3.3" xref="S3.E8.m1.6.6.1.1.1.2.3.3.cmml">τ</mi></mrow></munder><msup id="S3.E8.m1.6.6.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml"><munder id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.3.cmml">s</mi><mo id="S3.E8.m1.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.1.1.1.2.cmml">:</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">→</mo><msup id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.E8.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">∈</mo><msup id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml">E</mi><mo id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml">′</mo></msup></mrow></mrow></munder><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.5" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">R</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msup id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.2.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.5a" rspace="0.055em" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.cmml"><munder id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.2" movablelimits="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.cmml"><msup id="S3.E8.m1.2.2.1.3" xref="S3.E8.m1.2.2.1.3.cmml"><mi id="S3.E8.m1.2.2.1.3.2" xref="S3.E8.m1.2.2.1.3.2.cmml">s</mi><mo id="S3.E8.m1.2.2.1.3.3" xref="S3.E8.m1.2.2.1.3.3.cmml">′′</mo></msup><mo id="S3.E8.m1.2.2.1.2" lspace="0.278em" rspace="0.278em" xref="S3.E8.m1.2.2.1.2.cmml">:</mo><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.cmml"><msup id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">→</mo><msup id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.3.3.cmml">′′</mo></msup></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml">∈</mo><msup id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml">E</mi><mo id="S3.E8.m1.2.2.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.3.cmml">′</mo></msup></mrow></mrow></munder><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.cmml"><msub id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.2.cmml">F</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.3.cmml">θ</mi></msub><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.3.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.3" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.3.cmml">(</mo><msup id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.4" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.3.cmml">,</mo><msup id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml">s</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.3.cmml">′′</mo></msup><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.5" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E8.m1.6.6.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><eq id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"></eq><apply id="S3.E8.m1.6.6.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.3"><times id="S3.E8.m1.6.6.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.3.1"></times><apply id="S3.E8.m1.6.6.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.3.2.1.cmml" xref="S3.E8.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.3.2.2.cmml" xref="S3.E8.m1.6.6.1.1.3.2.2">ℒ</ci><apply id="S3.E8.m1.6.6.1.1.3.2.3.cmml" xref="S3.E8.m1.6.6.1.1.3.2.3"><times id="S3.E8.m1.6.6.1.1.3.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.3.2.3.1"></times><ci id="S3.E8.m1.6.6.1.1.3.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.3.2.3.2">𝐹</ci><ci id="S3.E8.m1.6.6.1.1.3.2.3.3.cmml" xref="S3.E8.m1.6.6.1.1.3.2.3.3">𝑀</ci></apply></apply><list id="S3.E8.m1.6.6.1.1.3.3.1.cmml" xref="S3.E8.m1.6.6.1.1.3.3.2"><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝜏</ci><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝜃</ci></list></apply><apply id="S3.E8.m1.6.6.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2.2"></sum><apply id="S3.E8.m1.6.6.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3"><in id="S3.E8.m1.6.6.1.1.1.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.1"></in><apply id="S3.E8.m1.6.6.1.1.1.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.2.3.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.2.3.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.2.2">𝑠</ci><ci id="S3.E8.m1.6.6.1.1.1.2.3.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.2.3">′</ci></apply><ci id="S3.E8.m1.6.6.1.1.1.2.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.2.3.3">𝜏</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><minus id="S3.E8.m1.6.6.1.1.1.1.1.1.1.5.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.5"></minus><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><ci id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.2">:</ci><ci id="S3.E8.m1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.3">𝑠</ci><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><in id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"></in><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1">→</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝑠</ci><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></interval></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2"><times id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.2"></times><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.3">𝑅</ci><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.2">𝑠</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.2.1.1.1.3">′</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.3.2"></sum><apply id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2.1"><ci id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.2">:</ci><apply id="S3.E8.m1.2.2.1.3.cmml" xref="S3.E8.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.3.1.cmml" xref="S3.E8.m1.2.2.1.3">superscript</csymbol><ci id="S3.E8.m1.2.2.1.3.2.cmml" xref="S3.E8.m1.2.2.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.3.3.cmml" xref="S3.E8.m1.2.2.1.3.3">′′</ci></apply><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1.1"><in id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"></in><apply id="S3.E8.m1.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1">→</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.2.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.3.3">′′</ci></apply></apply><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2">𝐸</ci><ci id="S3.E8.m1.2.2.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.3">′</ci></apply></apply></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2"><times id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.3"></times><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.2">𝐹</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.4.3">𝜃</ci></apply><interval closure="open" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.2">𝑠</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.3.1.1.1.1.3">′</ci></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2">superscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.2">𝑠</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.4.2.2.2.2.3">′′</ci></apply></interval></apply></apply></apply><cn id="S3.E8.m1.6.6.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.6.6.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\mathcal{L}_{FM}(\tau;\theta)=\sum_{s^{\prime}\in\tau}\left(\sum_{s:(s%
\rightarrow s^{\prime})\in E^{\prime}}F_{\theta}(s,s^{\prime})-R(s^{\prime})-%
\sum_{s^{\prime\prime}:(s^{\prime}\rightarrow s^{\prime\prime})\in E^{\prime}}%
F_{\theta}(s^{\prime},s^{\prime\prime})\right)^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.6d">caligraphic_L start_POSTSUBSCRIPT italic_F italic_M end_POSTSUBSCRIPT ( italic_τ ; italic_θ ) = ∑ start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_τ end_POSTSUBSCRIPT ( ∑ start_POSTSUBSCRIPT italic_s : ( italic_s → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∈ italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) - italic_R ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) - ∑ start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT : ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT → italic_s start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) ∈ italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_s start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p6.5">where <math alttext="F_{\theta}(s,s^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.p6.4.m1.2"><semantics id="S3.SS2.p6.4.m1.2a"><mrow id="S3.SS2.p6.4.m1.2.2" xref="S3.SS2.p6.4.m1.2.2.cmml"><msub id="S3.SS2.p6.4.m1.2.2.3" xref="S3.SS2.p6.4.m1.2.2.3.cmml"><mi id="S3.SS2.p6.4.m1.2.2.3.2" xref="S3.SS2.p6.4.m1.2.2.3.2.cmml">F</mi><mi id="S3.SS2.p6.4.m1.2.2.3.3" xref="S3.SS2.p6.4.m1.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p6.4.m1.2.2.2" xref="S3.SS2.p6.4.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p6.4.m1.2.2.1.1" xref="S3.SS2.p6.4.m1.2.2.1.2.cmml"><mo id="S3.SS2.p6.4.m1.2.2.1.1.2" stretchy="false" xref="S3.SS2.p6.4.m1.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p6.4.m1.1.1" xref="S3.SS2.p6.4.m1.1.1.cmml">s</mi><mo id="S3.SS2.p6.4.m1.2.2.1.1.3" xref="S3.SS2.p6.4.m1.2.2.1.2.cmml">,</mo><msup id="S3.SS2.p6.4.m1.2.2.1.1.1" xref="S3.SS2.p6.4.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p6.4.m1.2.2.1.1.1.2" xref="S3.SS2.p6.4.m1.2.2.1.1.1.2.cmml">s</mi><mo id="S3.SS2.p6.4.m1.2.2.1.1.1.3" xref="S3.SS2.p6.4.m1.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS2.p6.4.m1.2.2.1.1.4" stretchy="false" xref="S3.SS2.p6.4.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m1.2b"><apply id="S3.SS2.p6.4.m1.2.2.cmml" xref="S3.SS2.p6.4.m1.2.2"><times id="S3.SS2.p6.4.m1.2.2.2.cmml" xref="S3.SS2.p6.4.m1.2.2.2"></times><apply id="S3.SS2.p6.4.m1.2.2.3.cmml" xref="S3.SS2.p6.4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m1.2.2.3.1.cmml" xref="S3.SS2.p6.4.m1.2.2.3">subscript</csymbol><ci id="S3.SS2.p6.4.m1.2.2.3.2.cmml" xref="S3.SS2.p6.4.m1.2.2.3.2">𝐹</ci><ci id="S3.SS2.p6.4.m1.2.2.3.3.cmml" xref="S3.SS2.p6.4.m1.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p6.4.m1.2.2.1.2.cmml" xref="S3.SS2.p6.4.m1.2.2.1.1"><ci id="S3.SS2.p6.4.m1.1.1.cmml" xref="S3.SS2.p6.4.m1.1.1">𝑠</ci><apply id="S3.SS2.p6.4.m1.2.2.1.1.1.cmml" xref="S3.SS2.p6.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p6.4.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p6.4.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p6.4.m1.2.2.1.1.1.2">𝑠</ci><ci id="S3.SS2.p6.4.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p6.4.m1.2.2.1.1.1.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m1.2c">F_{\theta}(s,s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.4.m1.2d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the flow along edge <math alttext="(s\rightarrow s^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.p6.5.m2.1"><semantics id="S3.SS2.p6.5.m2.1a"><mrow id="S3.SS2.p6.5.m2.1.1.1" xref="S3.SS2.p6.5.m2.1.1.1.1.cmml"><mo id="S3.SS2.p6.5.m2.1.1.1.2" stretchy="false" xref="S3.SS2.p6.5.m2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p6.5.m2.1.1.1.1" xref="S3.SS2.p6.5.m2.1.1.1.1.cmml"><mi id="S3.SS2.p6.5.m2.1.1.1.1.2" xref="S3.SS2.p6.5.m2.1.1.1.1.2.cmml">s</mi><mo id="S3.SS2.p6.5.m2.1.1.1.1.1" stretchy="false" xref="S3.SS2.p6.5.m2.1.1.1.1.1.cmml">→</mo><msup id="S3.SS2.p6.5.m2.1.1.1.1.3" xref="S3.SS2.p6.5.m2.1.1.1.1.3.cmml"><mi id="S3.SS2.p6.5.m2.1.1.1.1.3.2" xref="S3.SS2.p6.5.m2.1.1.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p6.5.m2.1.1.1.1.3.3" xref="S3.SS2.p6.5.m2.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.SS2.p6.5.m2.1.1.1.3" stretchy="false" xref="S3.SS2.p6.5.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m2.1b"><apply id="S3.SS2.p6.5.m2.1.1.1.1.cmml" xref="S3.SS2.p6.5.m2.1.1.1"><ci id="S3.SS2.p6.5.m2.1.1.1.1.1.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.1">→</ci><ci id="S3.SS2.p6.5.m2.1.1.1.1.2.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.2">𝑠</ci><apply id="S3.SS2.p6.5.m2.1.1.1.1.3.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p6.5.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p6.5.m2.1.1.1.1.3.2.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p6.5.m2.1.1.1.1.3.3.cmml" xref="S3.SS2.p6.5.m2.1.1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m2.1c">(s\rightarrow s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.5.m2.1d">( italic_s → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>. The resulting flow-based policy is then defined by sampling child states in proportion to the learned flows at each parent state.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we empirically demonstrate the effectiveness of the proposed TD-GFN through extensive experiments. Specifically, we aim to answer the following questions:
(i) Can TD-GFN effectively sample from the target reward distribution, and generate high-reward and diverse samples?
(ii) Is TD-GFN training efficient?
(iii) Does TD-GFN consistently improve performance across different scenarios?
We also conduct ablation studies to evaluate the individual contributions of each component within our method, as presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS4" title="D.4 Ablation Study ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.4</span></a>. Comprehensive task descriptions and implementation details of the algorithm are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3" title="Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Hypergrid</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.8">We begin with experiments on the Hypergrid task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>, a <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_D</annotation></semantics></math>-dimensional grid environment with side length <math alttext="H" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_H</annotation></semantics></math>, resulting in a discrete space of size <math alttext="H^{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msup id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">H</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝐻</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">H^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. High-reward modes are narrowly concentrated near the <math alttext="2^{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msup id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mn id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">2</mn><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">superscript</csymbol><cn id="S4.SS1.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.2">2</cn><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">2^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">2 start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> corners, making the task particularly challenging for both exploration-based and offline learning algorithms.
Our main experiments are conducted on a <math alttext="8^{4}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><msup id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mn id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">8</mn><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">superscript</csymbol><cn id="S4.SS1.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.2">8</cn><cn id="S4.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">8^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid (<math alttext="H=8" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">H</mi><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><eq id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></eq><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝐻</ci><cn id="S4.SS1.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.SS1.p1.6.m6.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">H=8</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_H = 8</annotation></semantics></math>, <math alttext="D=4" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">D</mi><mo id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><eq id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"></eq><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝐷</ci><cn id="S4.SS1.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">D=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">italic_D = 4</annotation></semantics></math>) following the setup in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>. Additionally, in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS2" title="D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.2</span></a>, we visualize a <math alttext="8\times 8" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mrow id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml"><mn id="S4.SS1.p1.8.m8.1.1.2" xref="S4.SS1.p1.8.m8.1.1.2.cmml">8</mn><mo id="S4.SS1.p1.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.8.m8.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.8.m8.1.1.3" xref="S4.SS1.p1.8.m8.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"><times id="S4.SS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1"></times><cn id="S4.SS1.p1.8.m8.1.1.2.cmml" type="integer" xref="S4.SS1.p1.8.m8.1.1.2">8</cn><cn id="S4.SS1.p1.8.m8.1.1.3.cmml" type="integer" xref="S4.SS1.p1.8.m8.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">8\times 8</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">8 × 8</annotation></semantics></math> Hypergrid instance and illustrate the TD-GFN workflow on this task.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Due to the lack of existing proxy-free training methods for GFlowNets, we compare TD-GFN against a broad range of baselines trained on offline datasets. These include popular offline RL algorithms such as CQL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib35" title="">35</a>]</cite> and IQL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib36" title="">36</a>]</cite>, imitation learning methods such as Behavior Cloning (BC) and GAIL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib28" title="">28</a>]</cite>, and the offline GFlowNet variant COFlowNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>]</cite>.
We additionally include a baseline termed <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.1">Dataset-GFN</span>, which trains a GFlowNet directly on offline trajectories without modification, serving as a vanilla proxy-free variant. For both offline RL and imitation learning methods, we adopt their soft RL formulations to enable stochastic policy sampling rather than pure reward maximization.
To ensure a fair comparison, we train GAIL using the rebalanced dataset described in Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.SS1" title="3.1 Edge rewards extraction via IRL ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3.1</span></a>, which improves its performance relative to training on the original dataset. Accordingly, we evaluate GAIL using the imitation policy learned via Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg2" title="Algorithm 2 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.4">Each algorithm is evaluated using two standard metrics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib38" title="">38</a>]</cite>. The first is <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.4.1">Empirical L1 Error</span>, which measures the <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">ℒ</mi><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">ℒ</ci><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance between the empirical distribution <math alttext="\pi(x)" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.2" xref="S4.SS1.p3.2.m2.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.2.2" xref="S4.SS1.p3.2.m2.1.2.2.cmml">π</mi><mo id="S4.SS1.p3.2.m2.1.2.1" xref="S4.SS1.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.2.m2.1.2.3.2" xref="S4.SS1.p3.2.m2.1.2.cmml"><mo id="S4.SS1.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p3.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">x</mi><mo id="S4.SS1.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.2.cmml" xref="S4.SS1.p3.2.m2.1.2"><times id="S4.SS1.p3.2.m2.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.2.1"></times><ci id="S4.SS1.p3.2.m2.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.2.2">𝜋</ci><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\pi(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_π ( italic_x )</annotation></semantics></math> from model samples and the normalized reward distribution <math alttext="p(x)=R(x)/Z" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.2"><semantics id="S4.SS1.p3.3.m3.2a"><mrow id="S4.SS1.p3.3.m3.2.3" xref="S4.SS1.p3.3.m3.2.3.cmml"><mrow id="S4.SS1.p3.3.m3.2.3.2" xref="S4.SS1.p3.3.m3.2.3.2.cmml"><mi id="S4.SS1.p3.3.m3.2.3.2.2" xref="S4.SS1.p3.3.m3.2.3.2.2.cmml">p</mi><mo id="S4.SS1.p3.3.m3.2.3.2.1" xref="S4.SS1.p3.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.3.m3.2.3.2.3.2" xref="S4.SS1.p3.3.m3.2.3.2.cmml"><mo id="S4.SS1.p3.3.m3.2.3.2.3.2.1" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.2.cmml">(</mo><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">x</mi><mo id="S4.SS1.p3.3.m3.2.3.2.3.2.2" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.3.m3.2.3.1" xref="S4.SS1.p3.3.m3.2.3.1.cmml">=</mo><mrow id="S4.SS1.p3.3.m3.2.3.3" xref="S4.SS1.p3.3.m3.2.3.3.cmml"><mrow id="S4.SS1.p3.3.m3.2.3.3.2" xref="S4.SS1.p3.3.m3.2.3.3.2.cmml"><mi id="S4.SS1.p3.3.m3.2.3.3.2.2" xref="S4.SS1.p3.3.m3.2.3.3.2.2.cmml">R</mi><mo id="S4.SS1.p3.3.m3.2.3.3.2.1" xref="S4.SS1.p3.3.m3.2.3.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.3.m3.2.3.3.2.3.2" xref="S4.SS1.p3.3.m3.2.3.3.2.cmml"><mo id="S4.SS1.p3.3.m3.2.3.3.2.3.2.1" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.3.2.cmml">(</mo><mi id="S4.SS1.p3.3.m3.2.2" xref="S4.SS1.p3.3.m3.2.2.cmml">x</mi><mo id="S4.SS1.p3.3.m3.2.3.3.2.3.2.2" stretchy="false" xref="S4.SS1.p3.3.m3.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.3.m3.2.3.3.1" xref="S4.SS1.p3.3.m3.2.3.3.1.cmml">/</mo><mi id="S4.SS1.p3.3.m3.2.3.3.3" xref="S4.SS1.p3.3.m3.2.3.3.3.cmml">Z</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.2b"><apply id="S4.SS1.p3.3.m3.2.3.cmml" xref="S4.SS1.p3.3.m3.2.3"><eq id="S4.SS1.p3.3.m3.2.3.1.cmml" xref="S4.SS1.p3.3.m3.2.3.1"></eq><apply id="S4.SS1.p3.3.m3.2.3.2.cmml" xref="S4.SS1.p3.3.m3.2.3.2"><times id="S4.SS1.p3.3.m3.2.3.2.1.cmml" xref="S4.SS1.p3.3.m3.2.3.2.1"></times><ci id="S4.SS1.p3.3.m3.2.3.2.2.cmml" xref="S4.SS1.p3.3.m3.2.3.2.2">𝑝</ci><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑥</ci></apply><apply id="S4.SS1.p3.3.m3.2.3.3.cmml" xref="S4.SS1.p3.3.m3.2.3.3"><divide id="S4.SS1.p3.3.m3.2.3.3.1.cmml" xref="S4.SS1.p3.3.m3.2.3.3.1"></divide><apply id="S4.SS1.p3.3.m3.2.3.3.2.cmml" xref="S4.SS1.p3.3.m3.2.3.3.2"><times id="S4.SS1.p3.3.m3.2.3.3.2.1.cmml" xref="S4.SS1.p3.3.m3.2.3.3.2.1"></times><ci id="S4.SS1.p3.3.m3.2.3.3.2.2.cmml" xref="S4.SS1.p3.3.m3.2.3.3.2.2">𝑅</ci><ci id="S4.SS1.p3.3.m3.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2">𝑥</ci></apply><ci id="S4.SS1.p3.3.m3.2.3.3.3.cmml" xref="S4.SS1.p3.3.m3.2.3.3.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.2c">p(x)=R(x)/Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.2d">italic_p ( italic_x ) = italic_R ( italic_x ) / italic_Z</annotation></semantics></math>, computed as <math alttext="\mathbb{E}[|\pi(x)-p(x)|]" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.3"><semantics id="S4.SS1.p3.4.m4.3a"><mrow id="S4.SS1.p3.4.m4.3.3" xref="S4.SS1.p3.4.m4.3.3.cmml"><mi id="S4.SS1.p3.4.m4.3.3.3" xref="S4.SS1.p3.4.m4.3.3.3.cmml">𝔼</mi><mo id="S4.SS1.p3.4.m4.3.3.2" xref="S4.SS1.p3.4.m4.3.3.2.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1" xref="S4.SS1.p3.4.m4.3.3.1.2.cmml"><mo id="S4.SS1.p3.4.m4.3.3.1.1.2" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.2.1.cmml">[</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.cmml"><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.1.cmml">|</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.cmml"><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.2.cmml">π</mi><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.3.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">x</mi><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.2.cmml">p</mi><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.3.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.cmml"><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.cmml">(</mo><mi id="S4.SS1.p3.4.m4.2.2" xref="S4.SS1.p3.4.m4.2.2.cmml">x</mi><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.p3.4.m4.3.3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.p3.4.m4.3.3.1.1.3" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.3b"><apply id="S4.SS1.p3.4.m4.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3"><times id="S4.SS1.p3.4.m4.3.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.2"></times><ci id="S4.SS1.p3.4.m4.3.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3.3">𝔼</ci><apply id="S4.SS1.p3.4.m4.3.3.1.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1"><csymbol cd="latexml" id="S4.SS1.p3.4.m4.3.3.1.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.p3.4.m4.3.3.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1"><abs id="S4.SS1.p3.4.m4.3.3.1.1.1.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.2"></abs><apply id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1"><minus id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1"></minus><apply id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2"><times id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.1"></times><ci id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.2.2">𝜋</ci><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝑥</ci></apply><apply id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3"><times id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.1"></times><ci id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.3.2">𝑝</ci><ci id="S4.SS1.p3.4.m4.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.3c">\mathbb{E}[|\pi(x)-p(x)|]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.3d">blackboard_E [ | italic_π ( italic_x ) - italic_p ( italic_x ) | ]</annotation></semantics></math>. The second is <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.4.2">Modes Found</span>, defined as the number of distinct reward modes discovered during training.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.4">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.F3" title="Figure 3 ‣ 4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3</span></a>(a), when trained on an <span class="ltx_text ltx_font_italic" id="S4.SS1.p4.4.1">Expert</span> dataset of <math alttext="1,500" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mrow id="S4.SS1.p4.1.m1.2.3.2" xref="S4.SS1.p4.1.m1.2.3.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.p4.1.m1.2.3.2.1" xref="S4.SS1.p4.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><list id="S4.SS1.p4.1.m1.2.3.1.cmml" xref="S4.SS1.p4.1.m1.2.3.2"><cn id="S4.SS1.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1">1</cn><cn id="S4.SS1.p4.1.m1.2.2.cmml" type="integer" xref="S4.SS1.p4.1.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">1,500</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">1 , 500</annotation></semantics></math> trajectories collected by a well-trained GFlowNet policy, all baseline methods require at least <math alttext="30,000" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.2"><semantics id="S4.SS1.p4.2.m2.2a"><mrow id="S4.SS1.p4.2.m2.2.3.2" xref="S4.SS1.p4.2.m2.2.3.1.cmml"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">30</mn><mo id="S4.SS1.p4.2.m2.2.3.2.1" xref="S4.SS1.p4.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.p4.2.m2.2.2" xref="S4.SS1.p4.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.2b"><list id="S4.SS1.p4.2.m2.2.3.1.cmml" xref="S4.SS1.p4.2.m2.2.3.2"><cn id="S4.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1">30</cn><cn id="S4.SS1.p4.2.m2.2.2.cmml" type="integer" xref="S4.SS1.p4.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.2c">30,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.2d">30 , 000</annotation></semantics></math> state visits to uncover all <math alttext="16" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mn id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><cn id="S4.SS1.p4.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p4.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">16</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">16</annotation></semantics></math> modes, whereas TD-GFN discovers all modes with fewer than <math alttext="500" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mn id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><cn id="S4.SS1.p4.4.m4.1.1.cmml" type="integer" xref="S4.SS1.p4.4.m4.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">500</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">500</annotation></semantics></math> visits. Although both TD-GFN and COFlowNet achieve the lowest <span class="ltx_text ltx_font_italic" id="S4.SS1.p4.4.2">Empirical L1 Error</span>, TD-GFN converges in less than half the number of state visits required by COFlowNet, demonstrating its superior training efficiency. Additional baseline analysis is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS6" title="D.6 Discussion on Baseline Performance ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="345" id="S4.F3.g1" src="x3.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance comparison on the <math alttext="8^{4}" class="ltx_Math" display="inline" id="S4.F3.4.m1.1"><semantics id="S4.F3.4.m1.1b"><msup id="S4.F3.4.m1.1.1" xref="S4.F3.4.m1.1.1.cmml"><mn id="S4.F3.4.m1.1.1.2" xref="S4.F3.4.m1.1.1.2.cmml">8</mn><mn id="S4.F3.4.m1.1.1.3" xref="S4.F3.4.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F3.4.m1.1c"><apply id="S4.F3.4.m1.1.1.cmml" xref="S4.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S4.F3.4.m1.1.1.1.cmml" xref="S4.F3.4.m1.1.1">superscript</csymbol><cn id="S4.F3.4.m1.1.1.2.cmml" type="integer" xref="S4.F3.4.m1.1.1.2">8</cn><cn id="S4.F3.4.m1.1.1.3.cmml" type="integer" xref="S4.F3.4.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m1.1d">8^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.m1.1e">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid task. The top row shows results using <math alttext="1,500" class="ltx_Math" display="inline" id="S4.F3.5.m2.2"><semantics id="S4.F3.5.m2.2b"><mrow id="S4.F3.5.m2.2.3.2" xref="S4.F3.5.m2.2.3.1.cmml"><mn id="S4.F3.5.m2.1.1" xref="S4.F3.5.m2.1.1.cmml">1</mn><mo id="S4.F3.5.m2.2.3.2.1" xref="S4.F3.5.m2.2.3.1.cmml">,</mo><mn id="S4.F3.5.m2.2.2" xref="S4.F3.5.m2.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.5.m2.2c"><list id="S4.F3.5.m2.2.3.1.cmml" xref="S4.F3.5.m2.2.3.2"><cn id="S4.F3.5.m2.1.1.cmml" type="integer" xref="S4.F3.5.m2.1.1">1</cn><cn id="S4.F3.5.m2.2.2.cmml" type="integer" xref="S4.F3.5.m2.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m2.2d">1,500</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.m2.2e">1 , 500</annotation></semantics></math> trajectories from the <span class="ltx_text ltx_font_italic" id="S4.F3.9.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="S4.F3.10.2">Mixed</span> datasets for policy training, while the bottom row shows results using only <math alttext="150" class="ltx_Math" display="inline" id="S4.F3.6.m3.1"><semantics id="S4.F3.6.m3.1b"><mn id="S4.F3.6.m3.1.1" xref="S4.F3.6.m3.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="S4.F3.6.m3.1c"><cn id="S4.F3.6.m3.1.1.cmml" type="integer" xref="S4.F3.6.m3.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m3.1d">150</annotation><annotation encoding="application/x-llamapun" id="S4.F3.6.m3.1e">150</annotation></semantics></math> trajectories. The solid line and shaded region represent the mean and standard deviation, respectively.</figcaption>
</figure>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Robustness to Dataset Uncertainty</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We first assess the robustness of TD-GFN under dataset uncertainty by introducing greater variability in the training data. In the <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.1">Mixed</span> setting, we augment the <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.2">Expert</span> dataset with an equal number of trajectories generated by a random policy similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib39" title="">39</a>]</cite>, thereby introducing noise. In another setting, we significantly reduce the number of available trajectories—using only one-tenth of the original dataset—to simulate data scarcity as an additional source of uncertainty <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib40" title="">40</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.F3" title="Figure 3 ‣ 4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3</span></a>, TD-GFN performs robustly under both types of uncertainty. It consistently models the target distribution more accurately and finds high-reward modes significantly faster than baseline methods. These results highlight TD-GFN’s resilience to noisy and limited data. Further evaluation under extreme data scarcity appears in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS1" title="D.1 Algorithm trained on extremely limited data ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.1</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Robustness to Behavior Policy Quality</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">We also examine the sensitivity of TD-GFN to the quality of the behavior policy used during data collection. To this end, we construct two offline datasets. The first, denoted <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.1.1">Median</span>, is collected using a suboptimal GFlowNet trained for only half the number of steps required for convergence. The second, denoted <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.1.2">Bad</span>, is generated by a GFlowNet trained with an inverted reward function <math alttext="IR=R^{-0.1}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">I</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><msup id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">R</mi><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3a" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">0.1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1"><eq id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1"></eq><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2"><times id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.1"></times><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.2">𝐼</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.3">𝑅</ci></apply><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">𝑅</ci><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3"><minus id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" type="float" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2">0.1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">IR=R^{-0.1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.1d">italic_I italic_R = italic_R start_POSTSUPERSCRIPT - 0.1 end_POSTSUPERSCRIPT</annotation></semantics></math>, while the dataset still contains the true rewards.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.F4" title="Figure 4 ‣ Robustness to Behavior Policy Quality ‣ 4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4</span></a>, TD-GFN adapts effectively in both scenarios, achieving faster alignment with the target reward distribution and recovering all reward modes earlier than baseline methods. Notably, when the behavior policy diverges substantially from the expert (<span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p2.1.1">Bad</span>), TD-GFN exhibits significantly more accurate distribution modeling, underscoring its robustness under adverse conditions.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="171" id="S4.F4.g1" src="x4.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance comparison on the <math alttext="8^{4}" class="ltx_Math" display="inline" id="S4.F4.3.m1.1"><semantics id="S4.F4.3.m1.1b"><msup id="S4.F4.3.m1.1.1" xref="S4.F4.3.m1.1.1.cmml"><mn id="S4.F4.3.m1.1.1.2" xref="S4.F4.3.m1.1.1.2.cmml">8</mn><mn id="S4.F4.3.m1.1.1.3" xref="S4.F4.3.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F4.3.m1.1c"><apply id="S4.F4.3.m1.1.1.cmml" xref="S4.F4.3.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.3.m1.1.1.1.cmml" xref="S4.F4.3.m1.1.1">superscript</csymbol><cn id="S4.F4.3.m1.1.1.2.cmml" type="integer" xref="S4.F4.3.m1.1.1.2">8</cn><cn id="S4.F4.3.m1.1.1.3.cmml" type="integer" xref="S4.F4.3.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.m1.1d">8^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.3.m1.1e">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid task. Policies are trained using the <span class="ltx_text ltx_font_italic" id="S4.F4.7.1">Median</span> and <span class="ltx_text ltx_font_italic" id="S4.F4.8.2">Bad</span> datasets, each consisting of <math alttext="1,500" class="ltx_Math" display="inline" id="S4.F4.4.m2.2"><semantics id="S4.F4.4.m2.2b"><mrow id="S4.F4.4.m2.2.3.2" xref="S4.F4.4.m2.2.3.1.cmml"><mn id="S4.F4.4.m2.1.1" xref="S4.F4.4.m2.1.1.cmml">1</mn><mo id="S4.F4.4.m2.2.3.2.1" xref="S4.F4.4.m2.2.3.1.cmml">,</mo><mn id="S4.F4.4.m2.2.2" xref="S4.F4.4.m2.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.4.m2.2c"><list id="S4.F4.4.m2.2.3.1.cmml" xref="S4.F4.4.m2.2.3.2"><cn id="S4.F4.4.m2.1.1.cmml" type="integer" xref="S4.F4.4.m2.1.1">1</cn><cn id="S4.F4.4.m2.2.2.cmml" type="integer" xref="S4.F4.4.m2.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m2.2d">1,500</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.m2.2e">1 , 500</annotation></semantics></math> trajectories. The solid line and shaded region represent the mean and standard deviation, respectively.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Biosequence Design</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We next evaluate the performance of TD-GFN on a more challenging task—designing anti-microbial peptides (AMPs), i.e., short protein sequences—introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>]</cite>. The experimental setup leverages two datasets curated from the DBAASP database <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib41" title="">41</a>]</cite>: one for training a proxy model to approximate reward values, and another for training an oracle that provides ground-truth reward labels.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2">Following the methodology of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>, we train a Proxy-GFN using the proxy model and compare its performance with TD-GFN, as well as with other baseline methods previously evaluated on the Hypergrid task (Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS1" title="4.1 Hypergrid ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4.1</span></a>). All methods are trained on the same dataset used for proxy learning, which includes <math alttext="3,219" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.2"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">3</mn><mo id="S4.SS2.p2.1.m1.2.3.2.1" xref="S4.SS2.p2.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">219</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><list id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.2"><cn id="S4.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1">3</cn><cn id="S4.SS2.p2.1.m1.2.2.cmml" type="integer" xref="S4.SS2.p2.1.m1.2.2">219</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">3,219</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.2d">3 , 219</annotation></semantics></math> positive AMPs and <math alttext="4,761" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.2"><semantics id="S4.SS2.p2.2.m2.2a"><mrow id="S4.SS2.p2.2.m2.2.3.2" xref="S4.SS2.p2.2.m2.2.3.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">4</mn><mo id="S4.SS2.p2.2.m2.2.3.2.1" xref="S4.SS2.p2.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS2.p2.2.m2.2.2" xref="S4.SS2.p2.2.m2.2.2.cmml">761</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><list id="S4.SS2.p2.2.m2.2.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.2"><cn id="S4.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1">4</cn><cn id="S4.SS2.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.2">761</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">4,761</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.2d">4 , 761</annotation></semantics></math> non-AMPs.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="S4.F5.g1" src="x5.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of reward and diversity among the top <math alttext="100" class="ltx_Math" display="inline" id="S4.F5.2.m1.1"><semantics id="S4.F5.2.m1.1b"><mn id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><cn id="S4.F5.2.m1.1.1.cmml" type="integer" xref="S4.F5.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">100</annotation><annotation encoding="application/x-llamapun" id="S4.F5.2.m1.1e">100</annotation></semantics></math> sequences ranked by reward. The <span class="ltx_text ltx_font_italic" id="S4.F5.4.1">Diversity</span> metric is defined in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.SS2" title="C.2 Biosequence Design ‣ Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">C.2</span></a>. All results are averaged over three random seeds, and error bars indicate the standard deviation.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.2">We generate <math alttext="5,000" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.2"><semantics id="S4.SS2.p3.1.m1.2a"><mrow id="S4.SS2.p3.1.m1.2.3.2" xref="S4.SS2.p3.1.m1.2.3.1.cmml"><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">5</mn><mo id="S4.SS2.p3.1.m1.2.3.2.1" xref="S4.SS2.p3.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.2b"><list id="S4.SS2.p3.1.m1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.2.3.2"><cn id="S4.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1">5</cn><cn id="S4.SS2.p3.1.m1.2.2.cmml" type="integer" xref="S4.SS2.p3.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.2c">5,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.2d">5 , 000</annotation></semantics></math> sequences using each learned policy and report the reward and diversity metrics for the top <math alttext="100" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mn id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><cn id="S4.SS2.p3.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">100</annotation></semantics></math> sequences ranked by reward, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.F5" title="Figure 5 ‣ 4.2 Biosequence Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">5</span></a>. TD-GFN consistently produces sequences with the highest rewards and greatest diversity. Notably, although rebalanced GAIL merely imitates the policy implied by the rebalanced dataset, it still achieves strong performance—outperforming Dataset-GFN, which is trained directly on the dataset trajectories, in both reward and diversity. These findings highlight the effectiveness of our dataset rebalancing strategy.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Molecule Design</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We further evaluate the effectiveness of our method on a real-world molecular design task introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>. A training dataset is constructed to simulate historical data produced by human experts, which comprises <math alttext="1,500" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.2"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">1</mn><mo id="S4.SS3.p1.1.m1.2.3.2.1" xref="S4.SS3.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><list id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.2"><cn id="S4.SS3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1">1</cn><cn id="S4.SS3.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">1,500</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.2d">1 , 500</annotation></semantics></math> trajectories generated by a well-trained GFlowNet policy, with corresponding reward values provided by an oracle <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of methods on the Molecule Design task. The <span class="ltx_text ltx_font_italic" id="S4.T1.45.1">Convergence</span> column indicates the number of trajectories required for policy convergence. Results are reported as mean <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T1.2.m1.1"><semantics id="S4.T1.2.m1.1b"><mo id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><csymbol cd="latexml" id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.m1.1e">±</annotation></semantics></math> standard deviation over three random seeds. Bold numbers indicate the best performance in each column.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.43">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.9.7">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.9.7.8">Method</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.2.2">Reward-<math alttext="10" class="ltx_Math" display="inline" id="S4.T1.3.1.1.m1.1"><semantics id="S4.T1.3.1.1.m1.1a"><mn id="S4.T1.3.1.1.m1.1.1" xref="S4.T1.3.1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.m1.1b"><cn id="S4.T1.3.1.1.m1.1.1.cmml" type="integer" xref="S4.T1.3.1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.1.1.m1.1d">10</annotation></semantics></math> (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.2.2.m2.1"><semantics id="S4.T1.4.2.2.m2.1a"><mo id="S4.T1.4.2.2.m2.1.1" stretchy="false" xref="S4.T1.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.m2.1b"><ci id="S4.T1.4.2.2.m2.1.1.cmml" xref="S4.T1.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.2.2.m2.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.4.4">Reward-<math alttext="100" class="ltx_Math" display="inline" id="S4.T1.5.3.3.m1.1"><semantics id="S4.T1.5.3.3.m1.1a"><mn id="S4.T1.5.3.3.m1.1.1" xref="S4.T1.5.3.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.m1.1b"><cn id="S4.T1.5.3.3.m1.1.1.cmml" type="integer" xref="S4.T1.5.3.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.3.3.m1.1d">100</annotation></semantics></math> (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.6.4.4.m2.1"><semantics id="S4.T1.6.4.4.m2.1a"><mo id="S4.T1.6.4.4.m2.1.1" stretchy="false" xref="S4.T1.6.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.4.4.m2.1b"><ci id="S4.T1.6.4.4.m2.1.1.cmml" xref="S4.T1.6.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.4.4.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.4.4.m2.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.8.6.6">Reward-<math alttext="1000" class="ltx_Math" display="inline" id="S4.T1.7.5.5.m1.1"><semantics id="S4.T1.7.5.5.m1.1a"><mn id="S4.T1.7.5.5.m1.1.1" xref="S4.T1.7.5.5.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.7.5.5.m1.1b"><cn id="S4.T1.7.5.5.m1.1.1.cmml" type="integer" xref="S4.T1.7.5.5.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.5.5.m1.1c">1000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.5.5.m1.1d">1000</annotation></semantics></math> (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.8.6.6.m2.1"><semantics id="S4.T1.8.6.6.m2.1a"><mo id="S4.T1.8.6.6.m2.1.1" stretchy="false" xref="S4.T1.8.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.6.6.m2.1b"><ci id="S4.T1.8.6.6.m2.1.1.cmml" xref="S4.T1.8.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.6.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.6.6.m2.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.9.7.7">Convergence (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.9.7.7.m1.1"><semantics id="S4.T1.9.7.7.m1.1a"><mo id="S4.T1.9.7.7.m1.1.1" stretchy="false" xref="S4.T1.9.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.7.7.m1.1b"><ci id="S4.T1.9.7.7.m1.1.1.cmml" xref="S4.T1.9.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.7.7.m1.1d">↓</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S4.T1.13.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.13.11.5">CQL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.10.8.1"><math alttext="7.069" class="ltx_Math" display="inline" id="S4.T1.10.8.1.m1.1"><semantics id="S4.T1.10.8.1.m1.1a"><mn id="S4.T1.10.8.1.m1.1.1" xref="S4.T1.10.8.1.m1.1.1.cmml">7.069</mn><annotation-xml encoding="MathML-Content" id="S4.T1.10.8.1.m1.1b"><cn id="S4.T1.10.8.1.m1.1.1.cmml" type="float" xref="S4.T1.10.8.1.m1.1.1">7.069</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.8.1.m1.1c">7.069</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.8.1.m1.1d">7.069</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.11.9.2"><math alttext="6.643" class="ltx_Math" display="inline" id="S4.T1.11.9.2.m1.1"><semantics id="S4.T1.11.9.2.m1.1a"><mn id="S4.T1.11.9.2.m1.1.1" xref="S4.T1.11.9.2.m1.1.1.cmml">6.643</mn><annotation-xml encoding="MathML-Content" id="S4.T1.11.9.2.m1.1b"><cn id="S4.T1.11.9.2.m1.1.1.cmml" type="float" xref="S4.T1.11.9.2.m1.1.1">6.643</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.9.2.m1.1c">6.643</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.9.2.m1.1d">6.643</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.12.10.3"><math alttext="5.401" class="ltx_Math" display="inline" id="S4.T1.12.10.3.m1.1"><semantics id="S4.T1.12.10.3.m1.1a"><mn id="S4.T1.12.10.3.m1.1.1" xref="S4.T1.12.10.3.m1.1.1.cmml">5.401</mn><annotation-xml encoding="MathML-Content" id="S4.T1.12.10.3.m1.1b"><cn id="S4.T1.12.10.3.m1.1.1.cmml" type="float" xref="S4.T1.12.10.3.m1.1.1">5.401</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.10.3.m1.1c">5.401</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.10.3.m1.1d">5.401</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.13.11.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.13.11.4.1">0.803</span> <math alttext="\bm{\times 10^{4}}" class="ltx_Math" display="inline" id="S4.T1.13.11.4.m1.1"><semantics id="S4.T1.13.11.4.m1.1a"><mrow id="S4.T1.13.11.4.m1.1.1" xref="S4.T1.13.11.4.m1.1.1.cmml"><mi id="S4.T1.13.11.4.m1.1.1.2" xref="S4.T1.13.11.4.m1.1.1.2.cmml"></mi><mo class="ltx_mathvariant_bold" id="S4.T1.13.11.4.m1.1.1.1" lspace="0.222em" mathvariant="bold" rspace="0.222em" xref="S4.T1.13.11.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.13.11.4.m1.1.1.3" xref="S4.T1.13.11.4.m1.1.1.3.cmml"><mn id="S4.T1.13.11.4.m1.1.1.3.2" xref="S4.T1.13.11.4.m1.1.1.3.2.cmml">𝟏𝟎</mn><mn id="S4.T1.13.11.4.m1.1.1.3.3" xref="S4.T1.13.11.4.m1.1.1.3.3.cmml">𝟒</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.11.4.m1.1b"><apply id="S4.T1.13.11.4.m1.1.1.cmml" xref="S4.T1.13.11.4.m1.1.1"><times id="S4.T1.13.11.4.m1.1.1.1.cmml" xref="S4.T1.13.11.4.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T1.13.11.4.m1.1.1.2.cmml" xref="S4.T1.13.11.4.m1.1.1.2">absent</csymbol><apply id="S4.T1.13.11.4.m1.1.1.3.cmml" xref="S4.T1.13.11.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.13.11.4.m1.1.1.3.1.cmml" xref="S4.T1.13.11.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.13.11.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.13.11.4.m1.1.1.3.2">10</cn><cn id="S4.T1.13.11.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.13.11.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.11.4.m1.1c">\bm{\times 10^{4}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.11.4.m1.1d">bold_× bold_10 start_POSTSUPERSCRIPT bold_4 end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.17.15">
<td class="ltx_td ltx_align_center" id="S4.T1.17.15.5">IQL</td>
<td class="ltx_td ltx_align_center" id="S4.T1.14.12.1"><math alttext="6.902" class="ltx_Math" display="inline" id="S4.T1.14.12.1.m1.1"><semantics id="S4.T1.14.12.1.m1.1a"><mn id="S4.T1.14.12.1.m1.1.1" xref="S4.T1.14.12.1.m1.1.1.cmml">6.902</mn><annotation-xml encoding="MathML-Content" id="S4.T1.14.12.1.m1.1b"><cn id="S4.T1.14.12.1.m1.1.1.cmml" type="float" xref="S4.T1.14.12.1.m1.1.1">6.902</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.12.1.m1.1c">6.902</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.12.1.m1.1d">6.902</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.13.2"><math alttext="5.980" class="ltx_Math" display="inline" id="S4.T1.15.13.2.m1.1"><semantics id="S4.T1.15.13.2.m1.1a"><mn id="S4.T1.15.13.2.m1.1.1" xref="S4.T1.15.13.2.m1.1.1.cmml">5.980</mn><annotation-xml encoding="MathML-Content" id="S4.T1.15.13.2.m1.1b"><cn id="S4.T1.15.13.2.m1.1.1.cmml" type="float" xref="S4.T1.15.13.2.m1.1.1">5.980</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.13.2.m1.1c">5.980</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.13.2.m1.1d">5.980</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.16.14.3"><math alttext="4.628" class="ltx_Math" display="inline" id="S4.T1.16.14.3.m1.1"><semantics id="S4.T1.16.14.3.m1.1a"><mn id="S4.T1.16.14.3.m1.1.1" xref="S4.T1.16.14.3.m1.1.1.cmml">4.628</mn><annotation-xml encoding="MathML-Content" id="S4.T1.16.14.3.m1.1b"><cn id="S4.T1.16.14.3.m1.1.1.cmml" type="float" xref="S4.T1.16.14.3.m1.1.1">4.628</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.14.3.m1.1c">4.628</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.14.3.m1.1d">4.628</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.17.15.4"><math alttext="4.104\times 10^{4}" class="ltx_Math" display="inline" id="S4.T1.17.15.4.m1.1"><semantics id="S4.T1.17.15.4.m1.1a"><mrow id="S4.T1.17.15.4.m1.1.1" xref="S4.T1.17.15.4.m1.1.1.cmml"><mn id="S4.T1.17.15.4.m1.1.1.2" xref="S4.T1.17.15.4.m1.1.1.2.cmml">4.104</mn><mo id="S4.T1.17.15.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.17.15.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.17.15.4.m1.1.1.3" xref="S4.T1.17.15.4.m1.1.1.3.cmml"><mn id="S4.T1.17.15.4.m1.1.1.3.2" xref="S4.T1.17.15.4.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.17.15.4.m1.1.1.3.3" xref="S4.T1.17.15.4.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.17.15.4.m1.1b"><apply id="S4.T1.17.15.4.m1.1.1.cmml" xref="S4.T1.17.15.4.m1.1.1"><times id="S4.T1.17.15.4.m1.1.1.1.cmml" xref="S4.T1.17.15.4.m1.1.1.1"></times><cn id="S4.T1.17.15.4.m1.1.1.2.cmml" type="float" xref="S4.T1.17.15.4.m1.1.1.2">4.104</cn><apply id="S4.T1.17.15.4.m1.1.1.3.cmml" xref="S4.T1.17.15.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.17.15.4.m1.1.1.3.1.cmml" xref="S4.T1.17.15.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.17.15.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.17.15.4.m1.1.1.3.2">10</cn><cn id="S4.T1.17.15.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.17.15.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.15.4.m1.1c">4.104\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.15.4.m1.1d">4.104 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.20.18">
<td class="ltx_td ltx_align_center" id="S4.T1.20.18.4">BC</td>
<td class="ltx_td ltx_align_center" id="S4.T1.18.16.1"><math alttext="7.652\pm 0.053" class="ltx_Math" display="inline" id="S4.T1.18.16.1.m1.1"><semantics id="S4.T1.18.16.1.m1.1a"><mrow id="S4.T1.18.16.1.m1.1.1" xref="S4.T1.18.16.1.m1.1.1.cmml"><mn id="S4.T1.18.16.1.m1.1.1.2" xref="S4.T1.18.16.1.m1.1.1.2.cmml">7.652</mn><mo id="S4.T1.18.16.1.m1.1.1.1" xref="S4.T1.18.16.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.18.16.1.m1.1.1.3" xref="S4.T1.18.16.1.m1.1.1.3.cmml">0.053</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.18.16.1.m1.1b"><apply id="S4.T1.18.16.1.m1.1.1.cmml" xref="S4.T1.18.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.18.16.1.m1.1.1.1.cmml" xref="S4.T1.18.16.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.18.16.1.m1.1.1.2.cmml" type="float" xref="S4.T1.18.16.1.m1.1.1.2">7.652</cn><cn id="S4.T1.18.16.1.m1.1.1.3.cmml" type="float" xref="S4.T1.18.16.1.m1.1.1.3">0.053</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.16.1.m1.1c">7.652\pm 0.053</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.16.1.m1.1d">7.652 ± 0.053</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.19.17.2"><math alttext="7.223\pm 0.035" class="ltx_Math" display="inline" id="S4.T1.19.17.2.m1.1"><semantics id="S4.T1.19.17.2.m1.1a"><mrow id="S4.T1.19.17.2.m1.1.1" xref="S4.T1.19.17.2.m1.1.1.cmml"><mn id="S4.T1.19.17.2.m1.1.1.2" xref="S4.T1.19.17.2.m1.1.1.2.cmml">7.223</mn><mo id="S4.T1.19.17.2.m1.1.1.1" xref="S4.T1.19.17.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.19.17.2.m1.1.1.3" xref="S4.T1.19.17.2.m1.1.1.3.cmml">0.035</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.19.17.2.m1.1b"><apply id="S4.T1.19.17.2.m1.1.1.cmml" xref="S4.T1.19.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.19.17.2.m1.1.1.1.cmml" xref="S4.T1.19.17.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.19.17.2.m1.1.1.2.cmml" type="float" xref="S4.T1.19.17.2.m1.1.1.2">7.223</cn><cn id="S4.T1.19.17.2.m1.1.1.3.cmml" type="float" xref="S4.T1.19.17.2.m1.1.1.3">0.035</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.17.2.m1.1c">7.223\pm 0.035</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.17.2.m1.1d">7.223 ± 0.035</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.20.18.3"><math alttext="6.459\pm 0.016" class="ltx_Math" display="inline" id="S4.T1.20.18.3.m1.1"><semantics id="S4.T1.20.18.3.m1.1a"><mrow id="S4.T1.20.18.3.m1.1.1" xref="S4.T1.20.18.3.m1.1.1.cmml"><mn id="S4.T1.20.18.3.m1.1.1.2" xref="S4.T1.20.18.3.m1.1.1.2.cmml">6.459</mn><mo id="S4.T1.20.18.3.m1.1.1.1" xref="S4.T1.20.18.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.20.18.3.m1.1.1.3" xref="S4.T1.20.18.3.m1.1.1.3.cmml">0.016</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.20.18.3.m1.1b"><apply id="S4.T1.20.18.3.m1.1.1.cmml" xref="S4.T1.20.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.20.18.3.m1.1.1.1.cmml" xref="S4.T1.20.18.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.20.18.3.m1.1.1.2.cmml" type="float" xref="S4.T1.20.18.3.m1.1.1.2">6.459</cn><cn id="S4.T1.20.18.3.m1.1.1.3.cmml" type="float" xref="S4.T1.20.18.3.m1.1.1.3">0.016</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.18.3.m1.1c">6.459\pm 0.016</annotation><annotation encoding="application/x-llamapun" id="S4.T1.20.18.3.m1.1d">6.459 ± 0.016</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.20.18.5">/</td>
</tr>
<tr class="ltx_tr" id="S4.T1.23.21">
<td class="ltx_td ltx_align_center" id="S4.T1.23.21.4">GAIL</td>
<td class="ltx_td ltx_align_center" id="S4.T1.21.19.1"><math alttext="7.528\pm 0.068" class="ltx_Math" display="inline" id="S4.T1.21.19.1.m1.1"><semantics id="S4.T1.21.19.1.m1.1a"><mrow id="S4.T1.21.19.1.m1.1.1" xref="S4.T1.21.19.1.m1.1.1.cmml"><mn id="S4.T1.21.19.1.m1.1.1.2" xref="S4.T1.21.19.1.m1.1.1.2.cmml">7.528</mn><mo id="S4.T1.21.19.1.m1.1.1.1" xref="S4.T1.21.19.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.21.19.1.m1.1.1.3" xref="S4.T1.21.19.1.m1.1.1.3.cmml">0.068</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.21.19.1.m1.1b"><apply id="S4.T1.21.19.1.m1.1.1.cmml" xref="S4.T1.21.19.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.21.19.1.m1.1.1.1.cmml" xref="S4.T1.21.19.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.21.19.1.m1.1.1.2.cmml" type="float" xref="S4.T1.21.19.1.m1.1.1.2">7.528</cn><cn id="S4.T1.21.19.1.m1.1.1.3.cmml" type="float" xref="S4.T1.21.19.1.m1.1.1.3">0.068</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.19.1.m1.1c">7.528\pm 0.068</annotation><annotation encoding="application/x-llamapun" id="S4.T1.21.19.1.m1.1d">7.528 ± 0.068</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.22.20.2"><math alttext="7.152\pm 0.085" class="ltx_Math" display="inline" id="S4.T1.22.20.2.m1.1"><semantics id="S4.T1.22.20.2.m1.1a"><mrow id="S4.T1.22.20.2.m1.1.1" xref="S4.T1.22.20.2.m1.1.1.cmml"><mn id="S4.T1.22.20.2.m1.1.1.2" xref="S4.T1.22.20.2.m1.1.1.2.cmml">7.152</mn><mo id="S4.T1.22.20.2.m1.1.1.1" xref="S4.T1.22.20.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.22.20.2.m1.1.1.3" xref="S4.T1.22.20.2.m1.1.1.3.cmml">0.085</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.22.20.2.m1.1b"><apply id="S4.T1.22.20.2.m1.1.1.cmml" xref="S4.T1.22.20.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.22.20.2.m1.1.1.1.cmml" xref="S4.T1.22.20.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.22.20.2.m1.1.1.2.cmml" type="float" xref="S4.T1.22.20.2.m1.1.1.2">7.152</cn><cn id="S4.T1.22.20.2.m1.1.1.3.cmml" type="float" xref="S4.T1.22.20.2.m1.1.1.3">0.085</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.20.2.m1.1c">7.152\pm 0.085</annotation><annotation encoding="application/x-llamapun" id="S4.T1.22.20.2.m1.1d">7.152 ± 0.085</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.23.21.3"><math alttext="6.406\pm 0.033" class="ltx_Math" display="inline" id="S4.T1.23.21.3.m1.1"><semantics id="S4.T1.23.21.3.m1.1a"><mrow id="S4.T1.23.21.3.m1.1.1" xref="S4.T1.23.21.3.m1.1.1.cmml"><mn id="S4.T1.23.21.3.m1.1.1.2" xref="S4.T1.23.21.3.m1.1.1.2.cmml">6.406</mn><mo id="S4.T1.23.21.3.m1.1.1.1" xref="S4.T1.23.21.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.23.21.3.m1.1.1.3" xref="S4.T1.23.21.3.m1.1.1.3.cmml">0.033</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.23.21.3.m1.1b"><apply id="S4.T1.23.21.3.m1.1.1.cmml" xref="S4.T1.23.21.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.23.21.3.m1.1.1.1.cmml" xref="S4.T1.23.21.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.23.21.3.m1.1.1.2.cmml" type="float" xref="S4.T1.23.21.3.m1.1.1.2">6.406</cn><cn id="S4.T1.23.21.3.m1.1.1.3.cmml" type="float" xref="S4.T1.23.21.3.m1.1.1.3">0.033</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.21.3.m1.1c">6.406\pm 0.033</annotation><annotation encoding="application/x-llamapun" id="S4.T1.23.21.3.m1.1d">6.406 ± 0.033</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.23.21.5">/</td>
</tr>
<tr class="ltx_tr" id="S4.T1.27.25">
<td class="ltx_td ltx_align_center" id="S4.T1.27.25.5">Proxy-GFN</td>
<td class="ltx_td ltx_align_center" id="S4.T1.24.22.1"><math alttext="7.625\pm 0.063" class="ltx_Math" display="inline" id="S4.T1.24.22.1.m1.1"><semantics id="S4.T1.24.22.1.m1.1a"><mrow id="S4.T1.24.22.1.m1.1.1" xref="S4.T1.24.22.1.m1.1.1.cmml"><mn id="S4.T1.24.22.1.m1.1.1.2" xref="S4.T1.24.22.1.m1.1.1.2.cmml">7.625</mn><mo id="S4.T1.24.22.1.m1.1.1.1" xref="S4.T1.24.22.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.24.22.1.m1.1.1.3" xref="S4.T1.24.22.1.m1.1.1.3.cmml">0.063</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.24.22.1.m1.1b"><apply id="S4.T1.24.22.1.m1.1.1.cmml" xref="S4.T1.24.22.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.24.22.1.m1.1.1.1.cmml" xref="S4.T1.24.22.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.24.22.1.m1.1.1.2.cmml" type="float" xref="S4.T1.24.22.1.m1.1.1.2">7.625</cn><cn id="S4.T1.24.22.1.m1.1.1.3.cmml" type="float" xref="S4.T1.24.22.1.m1.1.1.3">0.063</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.24.22.1.m1.1c">7.625\pm 0.063</annotation><annotation encoding="application/x-llamapun" id="S4.T1.24.22.1.m1.1d">7.625 ± 0.063</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.25.23.2"><math alttext="7.281\pm 0.067" class="ltx_Math" display="inline" id="S4.T1.25.23.2.m1.1"><semantics id="S4.T1.25.23.2.m1.1a"><mrow id="S4.T1.25.23.2.m1.1.1" xref="S4.T1.25.23.2.m1.1.1.cmml"><mn id="S4.T1.25.23.2.m1.1.1.2" xref="S4.T1.25.23.2.m1.1.1.2.cmml">7.281</mn><mo id="S4.T1.25.23.2.m1.1.1.1" xref="S4.T1.25.23.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.25.23.2.m1.1.1.3" xref="S4.T1.25.23.2.m1.1.1.3.cmml">0.067</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.25.23.2.m1.1b"><apply id="S4.T1.25.23.2.m1.1.1.cmml" xref="S4.T1.25.23.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.25.23.2.m1.1.1.1.cmml" xref="S4.T1.25.23.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.25.23.2.m1.1.1.2.cmml" type="float" xref="S4.T1.25.23.2.m1.1.1.2">7.281</cn><cn id="S4.T1.25.23.2.m1.1.1.3.cmml" type="float" xref="S4.T1.25.23.2.m1.1.1.3">0.067</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.25.23.2.m1.1c">7.281\pm 0.067</annotation><annotation encoding="application/x-llamapun" id="S4.T1.25.23.2.m1.1d">7.281 ± 0.067</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.26.24.3"><math alttext="6.636\pm 0.097" class="ltx_Math" display="inline" id="S4.T1.26.24.3.m1.1"><semantics id="S4.T1.26.24.3.m1.1a"><mrow id="S4.T1.26.24.3.m1.1.1" xref="S4.T1.26.24.3.m1.1.1.cmml"><mn id="S4.T1.26.24.3.m1.1.1.2" xref="S4.T1.26.24.3.m1.1.1.2.cmml">6.636</mn><mo id="S4.T1.26.24.3.m1.1.1.1" xref="S4.T1.26.24.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.26.24.3.m1.1.1.3" xref="S4.T1.26.24.3.m1.1.1.3.cmml">0.097</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.26.24.3.m1.1b"><apply id="S4.T1.26.24.3.m1.1.1.cmml" xref="S4.T1.26.24.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.26.24.3.m1.1.1.1.cmml" xref="S4.T1.26.24.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.26.24.3.m1.1.1.2.cmml" type="float" xref="S4.T1.26.24.3.m1.1.1.2">6.636</cn><cn id="S4.T1.26.24.3.m1.1.1.3.cmml" type="float" xref="S4.T1.26.24.3.m1.1.1.3">0.097</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.26.24.3.m1.1c">6.636\pm 0.097</annotation><annotation encoding="application/x-llamapun" id="S4.T1.26.24.3.m1.1d">6.636 ± 0.097</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.27.25.4"><math alttext="43.735\times 10^{4}" class="ltx_Math" display="inline" id="S4.T1.27.25.4.m1.1"><semantics id="S4.T1.27.25.4.m1.1a"><mrow id="S4.T1.27.25.4.m1.1.1" xref="S4.T1.27.25.4.m1.1.1.cmml"><mn id="S4.T1.27.25.4.m1.1.1.2" xref="S4.T1.27.25.4.m1.1.1.2.cmml">43.735</mn><mo id="S4.T1.27.25.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.27.25.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.27.25.4.m1.1.1.3" xref="S4.T1.27.25.4.m1.1.1.3.cmml"><mn id="S4.T1.27.25.4.m1.1.1.3.2" xref="S4.T1.27.25.4.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.27.25.4.m1.1.1.3.3" xref="S4.T1.27.25.4.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.27.25.4.m1.1b"><apply id="S4.T1.27.25.4.m1.1.1.cmml" xref="S4.T1.27.25.4.m1.1.1"><times id="S4.T1.27.25.4.m1.1.1.1.cmml" xref="S4.T1.27.25.4.m1.1.1.1"></times><cn id="S4.T1.27.25.4.m1.1.1.2.cmml" type="float" xref="S4.T1.27.25.4.m1.1.1.2">43.735</cn><apply id="S4.T1.27.25.4.m1.1.1.3.cmml" xref="S4.T1.27.25.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.27.25.4.m1.1.1.3.1.cmml" xref="S4.T1.27.25.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.27.25.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.27.25.4.m1.1.1.3.2">10</cn><cn id="S4.T1.27.25.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.27.25.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.27.25.4.m1.1c">43.735\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.27.25.4.m1.1d">43.735 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.31.29">
<td class="ltx_td ltx_align_center" id="S4.T1.31.29.5">Dataset-GFN</td>
<td class="ltx_td ltx_align_center" id="S4.T1.28.26.1"><math alttext="7.550\pm 0.045" class="ltx_Math" display="inline" id="S4.T1.28.26.1.m1.1"><semantics id="S4.T1.28.26.1.m1.1a"><mrow id="S4.T1.28.26.1.m1.1.1" xref="S4.T1.28.26.1.m1.1.1.cmml"><mn id="S4.T1.28.26.1.m1.1.1.2" xref="S4.T1.28.26.1.m1.1.1.2.cmml">7.550</mn><mo id="S4.T1.28.26.1.m1.1.1.1" xref="S4.T1.28.26.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.28.26.1.m1.1.1.3" xref="S4.T1.28.26.1.m1.1.1.3.cmml">0.045</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.28.26.1.m1.1b"><apply id="S4.T1.28.26.1.m1.1.1.cmml" xref="S4.T1.28.26.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.28.26.1.m1.1.1.1.cmml" xref="S4.T1.28.26.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.28.26.1.m1.1.1.2.cmml" type="float" xref="S4.T1.28.26.1.m1.1.1.2">7.550</cn><cn id="S4.T1.28.26.1.m1.1.1.3.cmml" type="float" xref="S4.T1.28.26.1.m1.1.1.3">0.045</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.28.26.1.m1.1c">7.550\pm 0.045</annotation><annotation encoding="application/x-llamapun" id="S4.T1.28.26.1.m1.1d">7.550 ± 0.045</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.29.27.2"><math alttext="7.198\pm 0.018" class="ltx_Math" display="inline" id="S4.T1.29.27.2.m1.1"><semantics id="S4.T1.29.27.2.m1.1a"><mrow id="S4.T1.29.27.2.m1.1.1" xref="S4.T1.29.27.2.m1.1.1.cmml"><mn id="S4.T1.29.27.2.m1.1.1.2" xref="S4.T1.29.27.2.m1.1.1.2.cmml">7.198</mn><mo id="S4.T1.29.27.2.m1.1.1.1" xref="S4.T1.29.27.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.29.27.2.m1.1.1.3" xref="S4.T1.29.27.2.m1.1.1.3.cmml">0.018</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.29.27.2.m1.1b"><apply id="S4.T1.29.27.2.m1.1.1.cmml" xref="S4.T1.29.27.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.29.27.2.m1.1.1.1.cmml" xref="S4.T1.29.27.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.29.27.2.m1.1.1.2.cmml" type="float" xref="S4.T1.29.27.2.m1.1.1.2">7.198</cn><cn id="S4.T1.29.27.2.m1.1.1.3.cmml" type="float" xref="S4.T1.29.27.2.m1.1.1.3">0.018</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.29.27.2.m1.1c">7.198\pm 0.018</annotation><annotation encoding="application/x-llamapun" id="S4.T1.29.27.2.m1.1d">7.198 ± 0.018</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.30.28.3"><math alttext="6.474\pm 0.018" class="ltx_Math" display="inline" id="S4.T1.30.28.3.m1.1"><semantics id="S4.T1.30.28.3.m1.1a"><mrow id="S4.T1.30.28.3.m1.1.1" xref="S4.T1.30.28.3.m1.1.1.cmml"><mn id="S4.T1.30.28.3.m1.1.1.2" xref="S4.T1.30.28.3.m1.1.1.2.cmml">6.474</mn><mo id="S4.T1.30.28.3.m1.1.1.1" xref="S4.T1.30.28.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.30.28.3.m1.1.1.3" xref="S4.T1.30.28.3.m1.1.1.3.cmml">0.018</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.30.28.3.m1.1b"><apply id="S4.T1.30.28.3.m1.1.1.cmml" xref="S4.T1.30.28.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.30.28.3.m1.1.1.1.cmml" xref="S4.T1.30.28.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.30.28.3.m1.1.1.2.cmml" type="float" xref="S4.T1.30.28.3.m1.1.1.2">6.474</cn><cn id="S4.T1.30.28.3.m1.1.1.3.cmml" type="float" xref="S4.T1.30.28.3.m1.1.1.3">0.018</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.30.28.3.m1.1c">6.474\pm 0.018</annotation><annotation encoding="application/x-llamapun" id="S4.T1.30.28.3.m1.1d">6.474 ± 0.018</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.31.29.4"><math alttext="6.030\times 10^{4}" class="ltx_Math" display="inline" id="S4.T1.31.29.4.m1.1"><semantics id="S4.T1.31.29.4.m1.1a"><mrow id="S4.T1.31.29.4.m1.1.1" xref="S4.T1.31.29.4.m1.1.1.cmml"><mn id="S4.T1.31.29.4.m1.1.1.2" xref="S4.T1.31.29.4.m1.1.1.2.cmml">6.030</mn><mo id="S4.T1.31.29.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.31.29.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.31.29.4.m1.1.1.3" xref="S4.T1.31.29.4.m1.1.1.3.cmml"><mn id="S4.T1.31.29.4.m1.1.1.3.2" xref="S4.T1.31.29.4.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.31.29.4.m1.1.1.3.3" xref="S4.T1.31.29.4.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.31.29.4.m1.1b"><apply id="S4.T1.31.29.4.m1.1.1.cmml" xref="S4.T1.31.29.4.m1.1.1"><times id="S4.T1.31.29.4.m1.1.1.1.cmml" xref="S4.T1.31.29.4.m1.1.1.1"></times><cn id="S4.T1.31.29.4.m1.1.1.2.cmml" type="float" xref="S4.T1.31.29.4.m1.1.1.2">6.030</cn><apply id="S4.T1.31.29.4.m1.1.1.3.cmml" xref="S4.T1.31.29.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.31.29.4.m1.1.1.3.1.cmml" xref="S4.T1.31.29.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.31.29.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.31.29.4.m1.1.1.3.2">10</cn><cn id="S4.T1.31.29.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.31.29.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.31.29.4.m1.1c">6.030\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.31.29.4.m1.1d">6.030 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.35.33">
<td class="ltx_td ltx_align_center" id="S4.T1.35.33.5">FM-COFlowNet</td>
<td class="ltx_td ltx_align_center" id="S4.T1.32.30.1"><math alttext="7.582\pm 0.057" class="ltx_Math" display="inline" id="S4.T1.32.30.1.m1.1"><semantics id="S4.T1.32.30.1.m1.1a"><mrow id="S4.T1.32.30.1.m1.1.1" xref="S4.T1.32.30.1.m1.1.1.cmml"><mn id="S4.T1.32.30.1.m1.1.1.2" xref="S4.T1.32.30.1.m1.1.1.2.cmml">7.582</mn><mo id="S4.T1.32.30.1.m1.1.1.1" xref="S4.T1.32.30.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.32.30.1.m1.1.1.3" xref="S4.T1.32.30.1.m1.1.1.3.cmml">0.057</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.32.30.1.m1.1b"><apply id="S4.T1.32.30.1.m1.1.1.cmml" xref="S4.T1.32.30.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.32.30.1.m1.1.1.1.cmml" xref="S4.T1.32.30.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.32.30.1.m1.1.1.2.cmml" type="float" xref="S4.T1.32.30.1.m1.1.1.2">7.582</cn><cn id="S4.T1.32.30.1.m1.1.1.3.cmml" type="float" xref="S4.T1.32.30.1.m1.1.1.3">0.057</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.32.30.1.m1.1c">7.582\pm 0.057</annotation><annotation encoding="application/x-llamapun" id="S4.T1.32.30.1.m1.1d">7.582 ± 0.057</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.33.31.2"><math alttext="7.201\pm 0.015" class="ltx_Math" display="inline" id="S4.T1.33.31.2.m1.1"><semantics id="S4.T1.33.31.2.m1.1a"><mrow id="S4.T1.33.31.2.m1.1.1" xref="S4.T1.33.31.2.m1.1.1.cmml"><mn id="S4.T1.33.31.2.m1.1.1.2" xref="S4.T1.33.31.2.m1.1.1.2.cmml">7.201</mn><mo id="S4.T1.33.31.2.m1.1.1.1" xref="S4.T1.33.31.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.33.31.2.m1.1.1.3" xref="S4.T1.33.31.2.m1.1.1.3.cmml">0.015</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.33.31.2.m1.1b"><apply id="S4.T1.33.31.2.m1.1.1.cmml" xref="S4.T1.33.31.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.33.31.2.m1.1.1.1.cmml" xref="S4.T1.33.31.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.33.31.2.m1.1.1.2.cmml" type="float" xref="S4.T1.33.31.2.m1.1.1.2">7.201</cn><cn id="S4.T1.33.31.2.m1.1.1.3.cmml" type="float" xref="S4.T1.33.31.2.m1.1.1.3">0.015</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.33.31.2.m1.1c">7.201\pm 0.015</annotation><annotation encoding="application/x-llamapun" id="S4.T1.33.31.2.m1.1d">7.201 ± 0.015</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.34.32.3"><math alttext="6.485\pm 0.016" class="ltx_Math" display="inline" id="S4.T1.34.32.3.m1.1"><semantics id="S4.T1.34.32.3.m1.1a"><mrow id="S4.T1.34.32.3.m1.1.1" xref="S4.T1.34.32.3.m1.1.1.cmml"><mn id="S4.T1.34.32.3.m1.1.1.2" xref="S4.T1.34.32.3.m1.1.1.2.cmml">6.485</mn><mo id="S4.T1.34.32.3.m1.1.1.1" xref="S4.T1.34.32.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.34.32.3.m1.1.1.3" xref="S4.T1.34.32.3.m1.1.1.3.cmml">0.016</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.34.32.3.m1.1b"><apply id="S4.T1.34.32.3.m1.1.1.cmml" xref="S4.T1.34.32.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.34.32.3.m1.1.1.1.cmml" xref="S4.T1.34.32.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.34.32.3.m1.1.1.2.cmml" type="float" xref="S4.T1.34.32.3.m1.1.1.2">6.485</cn><cn id="S4.T1.34.32.3.m1.1.1.3.cmml" type="float" xref="S4.T1.34.32.3.m1.1.1.3">0.016</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.34.32.3.m1.1c">6.485\pm 0.016</annotation><annotation encoding="application/x-llamapun" id="S4.T1.34.32.3.m1.1d">6.485 ± 0.016</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.35.33.4"><math alttext="5.829\times 10^{4}" class="ltx_Math" display="inline" id="S4.T1.35.33.4.m1.1"><semantics id="S4.T1.35.33.4.m1.1a"><mrow id="S4.T1.35.33.4.m1.1.1" xref="S4.T1.35.33.4.m1.1.1.cmml"><mn id="S4.T1.35.33.4.m1.1.1.2" xref="S4.T1.35.33.4.m1.1.1.2.cmml">5.829</mn><mo id="S4.T1.35.33.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.35.33.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.35.33.4.m1.1.1.3" xref="S4.T1.35.33.4.m1.1.1.3.cmml"><mn id="S4.T1.35.33.4.m1.1.1.3.2" xref="S4.T1.35.33.4.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.35.33.4.m1.1.1.3.3" xref="S4.T1.35.33.4.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.35.33.4.m1.1b"><apply id="S4.T1.35.33.4.m1.1.1.cmml" xref="S4.T1.35.33.4.m1.1.1"><times id="S4.T1.35.33.4.m1.1.1.1.cmml" xref="S4.T1.35.33.4.m1.1.1.1"></times><cn id="S4.T1.35.33.4.m1.1.1.2.cmml" type="float" xref="S4.T1.35.33.4.m1.1.1.2">5.829</cn><apply id="S4.T1.35.33.4.m1.1.1.3.cmml" xref="S4.T1.35.33.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.35.33.4.m1.1.1.3.1.cmml" xref="S4.T1.35.33.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.35.33.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.35.33.4.m1.1.1.3.2">10</cn><cn id="S4.T1.35.33.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.35.33.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.35.33.4.m1.1c">5.829\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.35.33.4.m1.1d">5.829 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.39.37">
<td class="ltx_td ltx_align_center" id="S4.T1.39.37.5">QM-COFlowNet</td>
<td class="ltx_td ltx_align_center" id="S4.T1.36.34.1"><math alttext="7.611\pm 0.020" class="ltx_Math" display="inline" id="S4.T1.36.34.1.m1.1"><semantics id="S4.T1.36.34.1.m1.1a"><mrow id="S4.T1.36.34.1.m1.1.1" xref="S4.T1.36.34.1.m1.1.1.cmml"><mn id="S4.T1.36.34.1.m1.1.1.2" xref="S4.T1.36.34.1.m1.1.1.2.cmml">7.611</mn><mo id="S4.T1.36.34.1.m1.1.1.1" xref="S4.T1.36.34.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.36.34.1.m1.1.1.3" xref="S4.T1.36.34.1.m1.1.1.3.cmml">0.020</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.36.34.1.m1.1b"><apply id="S4.T1.36.34.1.m1.1.1.cmml" xref="S4.T1.36.34.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.36.34.1.m1.1.1.1.cmml" xref="S4.T1.36.34.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.36.34.1.m1.1.1.2.cmml" type="float" xref="S4.T1.36.34.1.m1.1.1.2">7.611</cn><cn id="S4.T1.36.34.1.m1.1.1.3.cmml" type="float" xref="S4.T1.36.34.1.m1.1.1.3">0.020</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.36.34.1.m1.1c">7.611\pm 0.020</annotation><annotation encoding="application/x-llamapun" id="S4.T1.36.34.1.m1.1d">7.611 ± 0.020</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.37.35.2"><math alttext="7.296\pm 0.022" class="ltx_Math" display="inline" id="S4.T1.37.35.2.m1.1"><semantics id="S4.T1.37.35.2.m1.1a"><mrow id="S4.T1.37.35.2.m1.1.1" xref="S4.T1.37.35.2.m1.1.1.cmml"><mn id="S4.T1.37.35.2.m1.1.1.2" xref="S4.T1.37.35.2.m1.1.1.2.cmml">7.296</mn><mo id="S4.T1.37.35.2.m1.1.1.1" xref="S4.T1.37.35.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.37.35.2.m1.1.1.3" xref="S4.T1.37.35.2.m1.1.1.3.cmml">0.022</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.37.35.2.m1.1b"><apply id="S4.T1.37.35.2.m1.1.1.cmml" xref="S4.T1.37.35.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.37.35.2.m1.1.1.1.cmml" xref="S4.T1.37.35.2.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.37.35.2.m1.1.1.2.cmml" type="float" xref="S4.T1.37.35.2.m1.1.1.2">7.296</cn><cn id="S4.T1.37.35.2.m1.1.1.3.cmml" type="float" xref="S4.T1.37.35.2.m1.1.1.3">0.022</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.37.35.2.m1.1c">7.296\pm 0.022</annotation><annotation encoding="application/x-llamapun" id="S4.T1.37.35.2.m1.1d">7.296 ± 0.022</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.38.36.3"><math alttext="6.638\pm 0.010" class="ltx_Math" display="inline" id="S4.T1.38.36.3.m1.1"><semantics id="S4.T1.38.36.3.m1.1a"><mrow id="S4.T1.38.36.3.m1.1.1" xref="S4.T1.38.36.3.m1.1.1.cmml"><mn id="S4.T1.38.36.3.m1.1.1.2" xref="S4.T1.38.36.3.m1.1.1.2.cmml">6.638</mn><mo id="S4.T1.38.36.3.m1.1.1.1" xref="S4.T1.38.36.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.38.36.3.m1.1.1.3" xref="S4.T1.38.36.3.m1.1.1.3.cmml">0.010</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.38.36.3.m1.1b"><apply id="S4.T1.38.36.3.m1.1.1.cmml" xref="S4.T1.38.36.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.38.36.3.m1.1.1.1.cmml" xref="S4.T1.38.36.3.m1.1.1.1">plus-or-minus</csymbol><cn id="S4.T1.38.36.3.m1.1.1.2.cmml" type="float" xref="S4.T1.38.36.3.m1.1.1.2">6.638</cn><cn id="S4.T1.38.36.3.m1.1.1.3.cmml" type="float" xref="S4.T1.38.36.3.m1.1.1.3">0.010</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.38.36.3.m1.1c">6.638\pm 0.010</annotation><annotation encoding="application/x-llamapun" id="S4.T1.38.36.3.m1.1d">6.638 ± 0.010</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.39.37.4"><math alttext="4.423\times 10^{4}" class="ltx_Math" display="inline" id="S4.T1.39.37.4.m1.1"><semantics id="S4.T1.39.37.4.m1.1a"><mrow id="S4.T1.39.37.4.m1.1.1" xref="S4.T1.39.37.4.m1.1.1.cmml"><mn id="S4.T1.39.37.4.m1.1.1.2" xref="S4.T1.39.37.4.m1.1.1.2.cmml">4.423</mn><mo id="S4.T1.39.37.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.39.37.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.39.37.4.m1.1.1.3" xref="S4.T1.39.37.4.m1.1.1.3.cmml"><mn id="S4.T1.39.37.4.m1.1.1.3.2" xref="S4.T1.39.37.4.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.39.37.4.m1.1.1.3.3" xref="S4.T1.39.37.4.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.39.37.4.m1.1b"><apply id="S4.T1.39.37.4.m1.1.1.cmml" xref="S4.T1.39.37.4.m1.1.1"><times id="S4.T1.39.37.4.m1.1.1.1.cmml" xref="S4.T1.39.37.4.m1.1.1.1"></times><cn id="S4.T1.39.37.4.m1.1.1.2.cmml" type="float" xref="S4.T1.39.37.4.m1.1.1.2">4.423</cn><apply id="S4.T1.39.37.4.m1.1.1.3.cmml" xref="S4.T1.39.37.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.39.37.4.m1.1.1.3.1.cmml" xref="S4.T1.39.37.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.39.37.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.39.37.4.m1.1.1.3.2">10</cn><cn id="S4.T1.39.37.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.39.37.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.39.37.4.m1.1c">4.423\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.39.37.4.m1.1d">4.423 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.43.41">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.43.41.5">TD-GFN (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.40.38.1"><span class="ltx_text ltx_font_bold" id="S4.T1.40.38.1.1">7.733 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T1.40.38.1.1.m1.1"><semantics id="S4.T1.40.38.1.1.m1.1a"><mo id="S4.T1.40.38.1.1.m1.1.1" xref="S4.T1.40.38.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.40.38.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.40.38.1.1.m1.1.1.cmml" xref="S4.T1.40.38.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.40.38.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T1.40.38.1.1.m1.1d">±</annotation></semantics></math> 0.036</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.41.39.2"><span class="ltx_text ltx_font_bold" id="S4.T1.41.39.2.1">7.450 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T1.41.39.2.1.m1.1"><semantics id="S4.T1.41.39.2.1.m1.1a"><mo id="S4.T1.41.39.2.1.m1.1.1" xref="S4.T1.41.39.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.41.39.2.1.m1.1b"><csymbol cd="latexml" id="S4.T1.41.39.2.1.m1.1.1.cmml" xref="S4.T1.41.39.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.41.39.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T1.41.39.2.1.m1.1d">±</annotation></semantics></math> 0.037</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.42.40.3"><span class="ltx_text ltx_font_bold" id="S4.T1.42.40.3.1">6.810 <math alttext="\pm" class="ltx_Math" display="inline" id="S4.T1.42.40.3.1.m1.1"><semantics id="S4.T1.42.40.3.1.m1.1a"><mo id="S4.T1.42.40.3.1.m1.1.1" xref="S4.T1.42.40.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.42.40.3.1.m1.1b"><csymbol cd="latexml" id="S4.T1.42.40.3.1.m1.1.1.cmml" xref="S4.T1.42.40.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.42.40.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T1.42.40.3.1.m1.1d">±</annotation></semantics></math> 0.035</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.43.41.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.43.41.4.1">2.749</span> <math alttext="\bm{\times 10^{4}}" class="ltx_Math" display="inline" id="S4.T1.43.41.4.m1.1"><semantics id="S4.T1.43.41.4.m1.1a"><mrow id="S4.T1.43.41.4.m1.1.1" xref="S4.T1.43.41.4.m1.1.1.cmml"><mi id="S4.T1.43.41.4.m1.1.1.2" xref="S4.T1.43.41.4.m1.1.1.2.cmml"></mi><mo class="ltx_mathvariant_bold" id="S4.T1.43.41.4.m1.1.1.1" lspace="0.222em" mathvariant="bold" rspace="0.222em" xref="S4.T1.43.41.4.m1.1.1.1.cmml">×</mo><msup id="S4.T1.43.41.4.m1.1.1.3" xref="S4.T1.43.41.4.m1.1.1.3.cmml"><mn id="S4.T1.43.41.4.m1.1.1.3.2" xref="S4.T1.43.41.4.m1.1.1.3.2.cmml">𝟏𝟎</mn><mn id="S4.T1.43.41.4.m1.1.1.3.3" xref="S4.T1.43.41.4.m1.1.1.3.3.cmml">𝟒</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.43.41.4.m1.1b"><apply id="S4.T1.43.41.4.m1.1.1.cmml" xref="S4.T1.43.41.4.m1.1.1"><times id="S4.T1.43.41.4.m1.1.1.1.cmml" xref="S4.T1.43.41.4.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T1.43.41.4.m1.1.1.2.cmml" xref="S4.T1.43.41.4.m1.1.1.2">absent</csymbol><apply id="S4.T1.43.41.4.m1.1.1.3.cmml" xref="S4.T1.43.41.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.43.41.4.m1.1.1.3.1.cmml" xref="S4.T1.43.41.4.m1.1.1.3">superscript</csymbol><cn id="S4.T1.43.41.4.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.43.41.4.m1.1.1.3.2">10</cn><cn id="S4.T1.43.41.4.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.43.41.4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.43.41.4.m1.1c">\bm{\times 10^{4}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.43.41.4.m1.1d">bold_× bold_10 start_POSTSUPERSCRIPT bold_4 end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Following the approach used in the Biosequence Design task (Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS2" title="4.2 Biosequence Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4.2</span></a>), we train a proxy model on this dataset using the architecture and methodology commonly adopted in prior GFlowNet research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib43" title="">43</a>]</cite>, resulting in a baseline referred to as Proxy-GFN. Moreover, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>]</cite> proposed an enhanced COFlowNet incorporating quantile matching <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib38" title="">38</a>]</cite> to improve candidate diversity. Accordingly, we evaluate both the original and quantile-augmented variants (FM/QM).</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.2">We report the average top-<math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_k</annotation></semantics></math> reward obtained from <math alttext="5,000" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.2"><semantics id="S4.SS3.p3.2.m2.2a"><mrow id="S4.SS3.p3.2.m2.2.3.2" xref="S4.SS3.p3.2.m2.2.3.1.cmml"><mn id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">5</mn><mo id="S4.SS3.p3.2.m2.2.3.2.1" xref="S4.SS3.p3.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS3.p3.2.m2.2.2" xref="S4.SS3.p3.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.2b"><list id="S4.SS3.p3.2.m2.2.3.1.cmml" xref="S4.SS3.p3.2.m2.2.3.2"><cn id="S4.SS3.p3.2.m2.1.1.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1">5</cn><cn id="S4.SS3.p3.2.m2.2.2.cmml" type="integer" xref="S4.SS3.p3.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.2c">5,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.2d">5 , 000</annotation></semantics></math> samples generated by policies trained with different algorithms, along with the number of training trajectories required for policy convergence, in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.T1" title="Table 1 ‣ 4.3 Molecule Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>. Due to the instability of offline RL methods under sparse rewards, results for CQL and IQL are reported using only their best-performing random seed.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">As shown in the table, CQL converges fastest in terms of sample efficiency but struggles to generate a diverse set of high-reward candidates, resulting in substantially lower top-<math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_k</annotation></semantics></math> average rewards than GFN-based and even imitation learning methods. Excluding CQL, TD-GFN achieves the best performance in discovering high-reward molecules with the fewest trajectories, highlighting its training effectiveness and efficiency.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="388" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Number of high-reward modes (reward <math alttext="&gt;7" class="ltx_Math" display="inline" id="S4.F6.3.m1.1"><semantics id="S4.F6.3.m1.1b"><mrow id="S4.F6.3.m1.1.1" xref="S4.F6.3.m1.1.1.cmml"><mi id="S4.F6.3.m1.1.1.2" xref="S4.F6.3.m1.1.1.2.cmml"></mi><mo id="S4.F6.3.m1.1.1.1" xref="S4.F6.3.m1.1.1.1.cmml">&gt;</mo><mn id="S4.F6.3.m1.1.1.3" xref="S4.F6.3.m1.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.3.m1.1c"><apply id="S4.F6.3.m1.1.1.cmml" xref="S4.F6.3.m1.1.1"><gt id="S4.F6.3.m1.1.1.1.cmml" xref="S4.F6.3.m1.1.1.1"></gt><csymbol cd="latexml" id="S4.F6.3.m1.1.1.2.cmml" xref="S4.F6.3.m1.1.1.2">absent</csymbol><cn id="S4.F6.3.m1.1.1.3.cmml" type="integer" xref="S4.F6.3.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">&gt;7</annotation><annotation encoding="application/x-llamapun" id="S4.F6.3.m1.1e">&gt; 7</annotation></semantics></math> and <math alttext="&gt;7.5" class="ltx_Math" display="inline" id="S4.F6.4.m2.1"><semantics id="S4.F6.4.m2.1b"><mrow id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml"><mi id="S4.F6.4.m2.1.1.2" xref="S4.F6.4.m2.1.1.2.cmml"></mi><mo id="S4.F6.4.m2.1.1.1" xref="S4.F6.4.m2.1.1.1.cmml">&gt;</mo><mn id="S4.F6.4.m2.1.1.3" xref="S4.F6.4.m2.1.1.3.cmml">7.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><apply id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1"><gt id="S4.F6.4.m2.1.1.1.cmml" xref="S4.F6.4.m2.1.1.1"></gt><csymbol cd="latexml" id="S4.F6.4.m2.1.1.2.cmml" xref="S4.F6.4.m2.1.1.2">absent</csymbol><cn id="S4.F6.4.m2.1.1.3.cmml" type="float" xref="S4.F6.4.m2.1.1.3">7.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">&gt;7.5</annotation><annotation encoding="application/x-llamapun" id="S4.F6.4.m2.1e">&gt; 7.5</annotation></semantics></math>) discovered during training in the Molecule Design task. The solid line and shaded region represent the mean and standard deviation, respectively.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1">In contrast, although Proxy-GFN performs competitively and is comparable to QM-COFlowNet in terms of reward quality, it requires significantly more trajectory rollouts during training. This further underscores the efficiency of learning directly from offline data. Additional comparisons of training time and computational resource usage are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.SS3" title="D.3 Time consumption and resource usage ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">D.3</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.2">To evaluate the diversity of molecules generated by TD-GFN, we measure the number of distinct high-reward modes identified by each algorithm. Modes are defined as clusters of high-reward molecules based on Tanimoto similarity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib44" title="">44</a>]</cite>. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.F6" title="Figure 6 ‣ 4.3 Molecule Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">6</span></a>, TD-GFN consistently discovers <math alttext="1.5" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mn id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><cn id="S4.SS3.p6.1.m1.1.1.cmml" type="float" xref="S4.SS3.p6.1.m1.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">1.5</annotation></semantics></math> to <math alttext="2" class="ltx_Math" display="inline" id="S4.SS3.p6.2.m2.1"><semantics id="S4.SS3.p6.2.m2.1a"><mn id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><cn id="S4.SS3.p6.2.m2.1.1.cmml" type="integer" xref="S4.SS3.p6.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.2.m2.1d">2</annotation></semantics></math> times more high-reward modes than the strongest baselines, indicating superior exploration. Notably, despite incorporating DAG pruning, TD-GFN does not overfit to narrow regions of the search space. Instead, it guides the policy toward a broader set of high-reward regions, balancing targeted exploitation with diverse exploration.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We introduced <span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Trajectory-Distilled GFlowNet (TD-GFN)</span>, a proxy-free training framework for learning GFlowNets from offline datasets without requiring out-of-distribution reward queries. Leveraging edge-level supervision learned via IRL, TD-GFN consistently guides the policy toward improved performance and training efficiency through DAG pruning and prioritized backward trajectory sampling. Extensive experiments validate the effectiveness of the proposed approach.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
E. Bengio, M. Jain, M. Korablyov, D. Precup, and Y. Bengio, “Flow network based generative models for non-iterative diverse candidate generation,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, pp. 27 381–27 394, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Y. Bengio, S. Lahlou, T. Deleu, E. J. Hu, M. Tiwari, and E. Bengio, “Gflownet foundations,” <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Journal of Machine Learning Research</em>, vol. 24, no. 210, pp. 1–55, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M. Jain, E. Bengio, A. Hernandez-Garcia, J. Rector-Brooks, B. F. Dossou, C. A. Ekbote, J. Fu, T. Zhang, M. Kilgour, D. Zhang <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">et al.</em>, “Biological sequence design with gflownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib3.2.2">International Conference on Machine Learning</em>.   PMLR, 2022, pp. 9786–9801.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
N. Zhang, J. Yang, Z. Cao, and X. Chi, “Adversarial generative flow network for solving vehicle routing problems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=tBom4xOW1H" title="">https://openreview.net/forum?id=tBom4xOW1H</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
E. J. Hu, M. Jain, E. Elmoznino, Y. Kaddar, G. Lajoie, Y. Bengio, and N. Malkin, “Amortizing intractable inference in large language models,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">The Twelfth International Conference on Learning Representations</em>, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Ouj6p4ca60" title="">https://openreview.net/forum?id=Ouj6p4ca60</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Z. Liu, T. Z. Xiao, W. Liu, Y. Bengio, and D. Zhang, “Efficient diversity-preserving diffusion alignment via gradient-informed GFlownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Aye5wL6TCn" title="">https://openreview.net/forum?id=Aye5wL6TCn</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. da Silva, E. Silva, A. Góis, D. Heider, S. Kaski, D. Mesquita, and A. Ribeiro, “Human-in-the-loop causal discovery under latent confounding using ancestral gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2309.12032</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
C. Angermueller, D. Dohan, D. Belanger, R. Deshpande, K. Murphy, and L. Colwell, “Model-based reinforcement learning for biological sequence design,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International Conference on Learning Representations</em>, 2020. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=HklxbgBKvr" title="">https://openreview.net/forum?id=HklxbgBKvr</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. Jang, M. Kim, and S. Ahn, “Learning energy decompositions for partial inference of gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2310.03301</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
M. Kim, T. Yun, E. Bengio, D. Zhang, Y. Bengio, S. Ahn, and J. Park, “Local search gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">URL https://arxiv. org/abs/2310</em>, vol. 2710, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Z. JIANG, X. Feng, P. Weng, Y. Zhu, Y. Song, T. Zhou, Y. Hu, T. Lv, and C. Fan, “Reinforcement learning from imperfect corrective actions and proxy rewards,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=JTji0Jfh5a" title="">https://openreview.net/forum?id=JTji0Jfh5a</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S. Wang, S. Zhang, J. Zhang, R. Hu, X. Li, T. Zhang, J. Li, F. Wu, G. Wang, and E. Hovy, “Reinforcement learning enhanced llms: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2412.10400</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
C. Laidlaw, S. Singhal, and A. Dragan, “Correlated proxies: A new definition and improved mitigation for reward hacking,” in <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=msEr27EejF" title="">https://openreview.net/forum?id=msEr27EejF</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
D. M. Ziegler, N. Stiennon, J. Wu, T. B. Brown, A. Radford, D. Amodei, P. Christiano, and G. Irving, “Fine-tuning language models from human preferences,” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1909.08593</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D. Dalrymple, J. Skalse, Y. Bengio, S. Russell, M. Tegmark, S. Seshia, S. Omohundro, C. Szegedy, B. Goldhaber, N. Ammann <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">et al.</em>, “Towards guaranteed safe ai: A framework for ensuring robust and reliable ai systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib15.2.2">arXiv preprint arXiv:2405.06624</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
X. Chen, S. Wang, J. McAuley, D. Jannach, and L. Yao, “On the opportunities and challenges of offline reinforcement learning for recommender systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ACM Transactions on Information Systems</em>, vol. 42, no. 6, pp. 1–26, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Xie, X. Guo, C. Wang, K. Liu, and L. Chen, “Advdiffuser: Generating adversarial safety-critical driving scenarios via guided diffusion,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">2024 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)</em>.   IEEE, 2024, pp. 9983–9989.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Jain, T. Deleu, J. Hartford, C.-H. Liu, A. Hernandez-Garcia, and Y. Bengio, “Gflownets for ai-driven scientific discovery,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Digital Discovery</em>, vol. 2, no. 3, pp. 557–577, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
A. H. Cheng, C. T. Ser, M. Skreta, A. Guzmán-Cordero, L. Thiede, A. Burger, A. Aldossary, S. X. Leong, S. Pablo-García, F. Strieth-Kalthoff <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">et al.</em>, “Spiers memorial lecture: How to do impactful research in artificial intelligence for chemistry and materials science,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.2.2">Faraday Discussions</em>, vol. 256, pp. 10–60, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang, S. Agarwal, K. Slama, A. Ray <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">et al.</em>, “Training language models to follow instructions with human feedback,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.2.2">Advances in neural information processing systems</em>, vol. 35, pp. 27 730–27 744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
H. Wang, Y. Li, yunfeng shao, and J. HAO, “Regularized offline GFlownets,” 2023. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=kbhUUAMZmQT" title="">https://openreview.net/forum?id=kbhUUAMZmQT</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Zhang, X. Yu, X. Wang, Z. Sun, C. Zhang, P. Wang, and Y. Wang, “COFlownet: Conservative constraints on flows enable high-quality candidate generation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=tXUkT709OJ" title="">https://openreview.net/forum?id=tXUkT709OJ</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
L. Atanackovic and E. Bengio, “Investigating generalization behaviours of generative flow networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2402.05309</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
D. Tiapkin, N. Morozov, A. Naumov, and D. P. Vetrov, “Generative flow networks as entropy-regularized rl,” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">International Conference on Artificial Intelligence and Statistics</em>.   PMLR, 2024, pp. 4213–4221.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
B. D. Ziebart, A. L. Maas, J. A. Bagnell, A. K. Dey <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">et al.</em>, “Maximum entropy inverse reinforcement learning.” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.2.2">Aaai</em>, vol. 8.   Chicago, IL, USA, 2008, pp. 1433–1438.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
B. D. Ziebart, J. A. Bagnell, and A. K. Dey, “Modeling interaction via the principle of maximum causal entropy,” in <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 27th International Conference on International Conference on Machine Learning</em>, ser. ICML’10.   Madison, WI, USA: Omnipress, 2010, p. 1255–1262.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z.-W. Hong, P. Agrawal, R. T. d. Combes, and R. Laroche, “Harnessing mixed offline reinforcement learning datasets via trajectory weighting,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2306.13085</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Ho and S. Ermon, “Generative adversarial imitation learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in neural information processing systems</em>, vol. 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
I. Kostrikov, K. K. Agrawal, D. Dwibedi, S. Levine, and J. Tompson, “Discriminator-actor-critic: Addressing sample inefficiency and reward bias in adversarial imitation learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:1809.02925</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
T. Zahavy, M. Haroush, N. Merlis, D. J. Mankowitz, and S. Mannor, “Learn what not to learn: Action elimination with deep reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in neural information processing systems</em>, vol. 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Zhang, P. Abbeel, and L. Pinto, “Automatic curriculum learning through value disagreement,” <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Advances in Neural Information Processing Systems</em>, vol. 33, pp. 7648–7659, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
M. W. Shen, E. Bengio, E. Hajiramezanali, A. Loukas, K. Cho, and T. Biancalani, “Towards understanding and improving gflownet training,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">International conference on machine learning</em>.   PMLR, 2023, pp. 30 956–30 975.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
T. Schaul, J. Quan, I. Antonoglou, and D. Silver, “Prioritized experience replay,” <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:1511.05952</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
H. Jang, Y. Jang, M. Kim, J. Park, and S. Ahn, “Pessimistic backward policy for gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2405.16012</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. Kumar, A. Zhou, G. Tucker, and S. Levine, “Conservative q-learning for offline reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Advances in neural information processing systems</em>, vol. 33, pp. 1179–1191, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
I. Kostrikov, A. Nair, and S. Levine, “Offline reinforcement learning with implicit q-learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2110.06169</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
L. Pan, D. Zhang, A. Courville, L. Huang, and Y. Bengio, “Generative augmented flow networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2210.03308</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
D. Zhang, L. Pan, R. T. Chen, A. Courville, and Y. Bengio, “Distributional gflownets with quantile flows,” <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2302.05793</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C. Cao, Z. Yan, R. Lu, J. Tan, and X. Wang, “Offline goal-conditioned reinforcement learning for safety-critical tasks with recovery policy,” in <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">2024 IEEE International Conference on Robotics and Automation (ICRA)</em>.   IEEE, 2024, pp. 2838–2844.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
S. Depeweg, J.-M. Hernandez-Lobato, F. Doshi-Velez, and S. Udluft, “Decomposition of uncertainty in bayesian deep learning for efficient and risk-sensitive learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">International conference on machine learning</em>.   PMLR, 2018, pp. 1184–1193.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
M. Pirtskhalava, A. A. Amstrong, M. Grigolava, M. Chubinidze, E. Alimbarashvili, B. Vishnepolsky, A. Gabrielian, A. Rosenthal, D. E. Hurt, and M. Tartakovsky, “Dbaasp v3: database of antimicrobial/cytotoxic activity and structure of peptides as a resource for development of new therapeutics,” <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Nucleic acids research</em>, vol. 49, no. D1, pp. D288–D297, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
N. Malkin, M. Jain, E. Bengio, C. Sun, and Y. Bengio, “Trajectory balance: Improved credit assignment in gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Advances in Neural Information Processing Systems</em>, vol. 35, pp. 5955–5967, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
H. He, E. Bengio, Q. Cai, and L. Pan, “Random policy evaluation uncovers policies of generative flow networks,” 2025. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2406.02213" title="">https://arxiv.org/abs/2406.02213</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
D. Bajusz, A. Rácz, and K. Héberger, “Why is tanimoto index an appropriate choice for fingerprint-based similarity calculations?” <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Journal of cheminformatics</em>, vol. 7, pp. 1–13, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
S. Mohammadpour, E. Bengio, E. Frejinger, and P.-L. Bacon, “Maximum entropy gflownets with soft q-learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Artificial Intelligence and Statistics</em>.   PMLR, 2024, pp. 2593–2601.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
N. Malkin, S. Lahlou, T. Deleu, X. Ji, E. Hu, K. Everett, D. Zhang, and Y. Bengio, “Gflownets and variational inference,” <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">URL https://arxiv. org/abs/2210.00580</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
H. Zimmermann, F. Lindsten, J.-W. van de Meent, and C. A. Naesseth, “A variational perspective on generative flow networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Transactions on Machine Learning Research</em>, 2023. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=AZ4GobeSLq" title="">https://openreview.net/forum?id=AZ4GobeSLq</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
K. Madan, J. Rector-Brooks, M. Korablyov, E. Bengio, M. Jain, A. C. Nica, T. Bosc, Y. Bengio, and N. Malkin, “Learning gflownets from partial episodes for improved convergence and stability,” in <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">International Conference on Machine Learning</em>.   PMLR, 2023, pp. 23 467–23 483.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
L. Pan, N. Malkin, D. Zhang, and Y. Bengio, “Better training of gflownets with local credit and incomplete trajectories,” in <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">International Conference on Machine Learning</em>.   PMLR, 2023, pp. 26 878–26 890.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
T. Gritsaev, N. Morozov, S. Samsonov, and D. Tiapkin, “Optimizing backward policies in gflownets via trajectory likelihood maximization,” <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2410.15474</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
M. Kim, S. Choi, T. Yun, E. Bengio, L. Feng, J. Rector-Brooks, S. Ahn, J. Park, N. Malkin, and Y. Bengio, “Adaptive teachers for amortized samplers,” <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">arXiv preprint arXiv:2410.01432</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
E. Lau, S. Lu, L. Pan, D. Precup, and E. Bengio, “Qgfn: Controllable greediness with action values,” <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Advances in neural information processing systems</em>, vol. 37, pp. 81 645–81 676, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
K. Madan, A. Lamb, E. Bengio, G. Berseth, and Y. Bengio, “Towards improving exploration through sibling augmented gflownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">The Thirteenth International Conference on Learning Representations</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
T. Silva, E. de Souza da Silva, and D. Mesquita, “On divergence measures for training GFlownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">The Thirty-eighth Annual Conference on Neural Information Processing Systems</em>, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=N5H4z0Pzvn" title="">https://openreview.net/forum?id=N5H4z0Pzvn</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
R. Hu, Y. Zhang, Z. Li, and L. Huang, “Beyond squared error: Exploring loss design for enhanced training of generative flow networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2410.02596</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
L. Pan, D. Zhang, M. Jain, L. Huang, and Y. Bengio, “Stochastic generative flow networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Uncertainty in Artificial Intelligence</em>.   PMLR, 2023, pp. 1628–1638.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
S. Lahlou, T. Deleu, P. Lemos, D. Zhang, A. Volokhova, A. Hernández-Garcıa, L. N. Ezzine, Y. Bengio, and N. Malkin, “A theory of continuous generative flow networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">International Conference on Machine Learning</em>.   PMLR, 2023, pp. 18 269–18 300.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
L. Brunswic, Y. Li, Y. Xu, Y. Feng, S. Jui, and L. Ma, “A theory of non-acyclic generative flow networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 38, no. 10, 2024, pp. 11 124–11 131.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Y. Chen and L. Mauch, “Order-preserving GFlownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">The Twelfth International Conference on Learning Representations</em>, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=VXDPXuq4oG" title="">https://openreview.net/forum?id=VXDPXuq4oG</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
M. Jain, S. C. Raparthy, A. Hernández-Garcıa, J. Rector-Brooks, Y. Bengio, S. Miret, and E. Bengio, “Multi-objective gflownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">International conference on machine learning</em>.   PMLR, 2023, pp. 14 631–14 653.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Y. Zhu, J. Wu, C. Hu, J. Yan, T. Hou, J. Wu <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">et al.</em>, “Sample-efficient multi-objective molecular optimization with gflownets,” <em class="ltx_emph ltx_font_italic" id="bib.bib61.2.2">Advances in Neural Information Processing Systems</em>, vol. 36, pp. 79 667–79 684, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
J. Roy, P.-L. Bacon, C. Pal, and E. Bengio, “Goal-conditioned gflownets for controllable multi-objective molecular design,” <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">arXiv preprint arXiv:2306.04620</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
P. M. Ghari, A. Tseng, G. Eraslan, R. Lopez, T. Biancalani, G. Scalia, and E. Hajiramezanali, “Generative flow networks assisted biological sequence editing,” in <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">NeurIPS 2023 Generative AI and Biology (GenBio) Workshop</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
D. Zhang, H. Dai, N. Malkin, A. Courville, Y. Bengio, and L. Pan, “Let the flows tell: Solving graph combinatorial problems with GFlownets,” in <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=sTjW3JHs2V" title="">https://openreview.net/forum?id=sTjW3JHs2V</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
M. Kim, S. Choi, J. Son, H. Kim, J. Park, and Y. Bengio, “Ant colony sampling with gflownets for combinatorial optimization,” <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">CoRR</em>, vol. abs/2403.07041, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2403.07041" title="">https://doi.org/10.48550/arXiv.2403.07041</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
D. Zhang, N. Malkin, Z. Liu, A. Volokhova, A. Courville, and Y. Bengio, “Generative flow networks for discrete probabilistic modeling,” in <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">International Conference on Machine Learning</em>.   PMLR, 2022, pp. 26 412–26 428.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
T. Deleu, A. Góis, C. Emezue, M. Rankawat, S. Lacoste-Julien, S. Bauer, and Y. Bengio, “Bayesian structure learning with generative flow networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Uncertainty in Artificial Intelligence</em>.   PMLR, 2022, pp. 518–528.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
S. Liu, Q. Cai, Z. He, B. Sun, J. McAuley, D. Zheng, P. Jiang, and K. Gai, “Generative flow network for listwise recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 2023, pp. 1524–1534.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
F. Yu, L. Jiang, H. Kang, S. Hao, and L. Qin, “Flow of reasoning: Training llms for divergent problem solving with minimal examples,” <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">arXiv preprint arXiv:2406.05673</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
S. Venkatraman, M. Jain, L. Scimeca, M. Kim, M. Sendera, M. Hasan, L. Rowe, S. Mittal, P. Lemos, E. Bengio, A. Adam, J. Rector-Brooks, Y. Bengio, G. Berseth, and N. Malkin, “Amortizing intractable inference in diffusion models for vision, language, and control,” in <em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">The Thirty-eighth Annual Conference on Neural Information Processing Systems</em>, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=gVTkMsaaGI" title="">https://openreview.net/forum?id=gVTkMsaaGI</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
A. Y. Ng, S. Russell <em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">et al.</em>, “Algorithms for inverse reinforcement learning.” in <em class="ltx_emph ltx_font_italic" id="bib.bib71.2.2">Icml</em>, vol. 1, no. 2, 2000, p. 2.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
J. Fu, K. Luo, and S. Levine, “Learning robust rewards with adversarial inverse reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">arXiv preprint arXiv:1710.11248</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
I. Kostrikov, O. Nachum, and J. Tompson, “Imitation learning via off-policy distribution matching,” <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">arXiv preprint arXiv:1912.05032</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
D. Garg, S. Chakraborty, C. Cundy, J. Song, and S. Ermon, “Iq-learn: Inverse soft-q learning for imitation,” <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, pp. 4028–4039, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
F.-M. Luo, X. Cao, R.-J. Qin, and Y. Yu, “Transferable reward learning by dynamics-agnostic discriminator ensemble,” <em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">arXiv preprint arXiv:2206.00238</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
F.-M. Luo, T. Xu, X. Cao, and Y. Yu, “Reward-consistent dynamics models are strongly generalizable for offline reinforcement learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">arXiv preprint arXiv:2310.05422</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
W. Jin, R. Barzilay, and T. Jaakkola, “Junction tree variational autoencoder for molecular graph generation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">International conference on machine learning</em>.   PMLR, 2018, pp. 2323–2332.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock">
J. Gilmer, S. S. Schoenholz, P. F. Riley, O. Vinyals, and G. E. Dahl, “Neural message passing for quantum chemistry,” in <em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">International conference on machine learning</em>.   PMLR, 2017, pp. 1263–1272.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\appendixpage</span><span class="ltx_ERROR undefined" id="p1.2">\startcontents</span>
<p class="ltx_p" id="p1.3">[section]
<span class="ltx_ERROR undefined" id="p1.3.1">\printcontents</span>[section]l1</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Algorithm Pseudocode</h2>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Trajectory-Distilled GFlowNet (TD-GFN)</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> Offline dataset <math alttext="\mathcal{D}=\{\tau_{i}=(s_{0},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}" class="ltx_Math" display="inline" id="alg1.l1.m1.2"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2.3" xref="alg1.l1.m1.2.2.3.cmml">𝒟</mi><mo id="alg1.l1.m1.2.2.2" xref="alg1.l1.m1.2.2.2.cmml">=</mo><msubsup id="alg1.l1.m1.2.2.1" xref="alg1.l1.m1.2.2.1.cmml"><mrow id="alg1.l1.m1.2.2.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.2.cmml"><mo id="alg1.l1.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.2.cmml">{</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.1.cmml"><msub id="alg1.l1.m1.2.2.1.1.1.1.1.5" xref="alg1.l1.m1.2.2.1.1.1.1.1.5.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.5.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.5.2.cmml">τ</mi><mi id="alg1.l1.m1.2.2.1.1.1.1.1.5.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="alg1.l1.m1.2.2.1.1.1.1.1.4" xref="alg1.l1.m1.2.2.1.1.1.1.1.4.cmml">=</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1.1.3.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml"><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.4" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml">(</mo><msub id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.5" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><mi id="alg1.l1.m1.1.1" mathvariant="normal" xref="alg1.l1.m1.1.1.cmml">…</mi><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.6" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><msub id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">s</mi><msub id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml">T</mi><mi id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.7" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml">R</mi><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.2" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2.cmml">s</mi><msub id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2.cmml">T</mi><mi id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.3" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.8" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="alg1.l1.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg1.l1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m1.2.2.1.1.3" xref="alg1.l1.m1.2.2.1.1.3.cmml"><mi id="alg1.l1.m1.2.2.1.1.3.2" xref="alg1.l1.m1.2.2.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m1.2.2.1.1.3.1" xref="alg1.l1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m1.2.2.1.1.3.3" xref="alg1.l1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m1.2.2.1.3" xref="alg1.l1.m1.2.2.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2"><eq id="alg1.l1.m1.2.2.2.cmml" xref="alg1.l1.m1.2.2.2"></eq><ci id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.3">𝒟</ci><apply id="alg1.l1.m1.2.2.1.cmml" xref="alg1.l1.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.2.cmml" xref="alg1.l1.m1.2.2.1">superscript</csymbol><apply id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1">subscript</csymbol><set id="alg1.l1.m1.2.2.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1"><apply id="alg1.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1"><eq id="alg1.l1.m1.2.2.1.1.1.1.1.4.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.4"></eq><apply id="alg1.l1.m1.2.2.1.1.1.1.1.5.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.5"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.5.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.5">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.5.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.5.2">𝜏</ci><ci id="alg1.l1.m1.2.2.1.1.1.1.1.5.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.5.3">𝑖</ci></apply><vector id="alg1.l1.m1.2.2.1.1.1.1.1.3.4.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3"><apply id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑠</ci><cn id="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l1.m1.2.2.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">…</ci><apply id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.2">𝑠</ci><apply id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2">𝑇</ci><ci id="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3"><times id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.2"></times><ci id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.3">𝑅</ci><apply id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2">𝑠</ci><apply id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2">𝑇</ci><ci id="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3">𝑖</ci></apply></apply></apply></vector></apply></set><apply id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.3"><eq id="alg1.l1.m1.2.2.1.1.3.1.cmml" xref="alg1.l1.m1.2.2.1.1.3.1"></eq><ci id="alg1.l1.m1.2.2.1.1.3.2.cmml" xref="alg1.l1.m1.2.2.1.1.3.2">𝑖</ci><cn id="alg1.l1.m1.2.2.1.1.3.3.cmml" type="integer" xref="alg1.l1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m1.2.2.1.3.cmml" xref="alg1.l1.m1.2.2.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\mathcal{D}=\{\tau_{i}=(s_{0},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.2d">caligraphic_D = { italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R ( italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>; number of training iterations <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_N</annotation></semantics></math>; batch size <math alttext="B" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_B</annotation></semantics></math>; GFlowNet learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_η</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Phase 1: Edge Reward Extraction</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>Learn edge rewards <math alttext="R_{E}(s,s^{\prime})" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><msub id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml"><mi id="alg1.l3.m1.2.2.3.2" xref="alg1.l3.m1.2.2.3.2.cmml">R</mi><mi id="alg1.l3.m1.2.2.3.3" xref="alg1.l3.m1.2.2.3.3.cmml">E</mi></msub><mo id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.2.cmml">⁢</mo><mrow id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.2.cmml"><mo id="alg1.l3.m1.2.2.1.1.2" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">s</mi><mo id="alg1.l3.m1.2.2.1.1.3" xref="alg1.l3.m1.2.2.1.2.cmml">,</mo><msup id="alg1.l3.m1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.2.cmml">s</mi><mo id="alg1.l3.m1.2.2.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l3.m1.2.2.1.1.4" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><times id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2"></times><apply id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.3.1.cmml" xref="alg1.l3.m1.2.2.3">subscript</csymbol><ci id="alg1.l3.m1.2.2.3.2.cmml" xref="alg1.l3.m1.2.2.3.2">𝑅</ci><ci id="alg1.l3.m1.2.2.3.3.cmml" xref="alg1.l3.m1.2.2.3.3">𝐸</ci></apply><interval closure="open" id="alg1.l3.m1.2.2.1.2.cmml" xref="alg1.l3.m1.2.2.1.1"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑠</ci><apply id="alg1.l3.m1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l3.m1.2.2.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">R_{E}(s,s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> and the imitation policy <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">π</mi><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝜋</ci><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> via Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg2" title="Algorithm 2 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a>.

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l4.2">Phase 2: DAG Pruning</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>Collect edge rewards <math alttext="\mathcal{D}_{R_{E}}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">𝒟</mi><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">R</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">E</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝒟</ci><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑅</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{D}_{R_{E}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> using <math alttext="R_{E}(s,s^{\prime})" class="ltx_Math" display="inline" id="alg1.l5.m2.2"><semantics id="alg1.l5.m2.2a"><mrow id="alg1.l5.m2.2.2" xref="alg1.l5.m2.2.2.cmml"><msub id="alg1.l5.m2.2.2.3" xref="alg1.l5.m2.2.2.3.cmml"><mi id="alg1.l5.m2.2.2.3.2" xref="alg1.l5.m2.2.2.3.2.cmml">R</mi><mi id="alg1.l5.m2.2.2.3.3" xref="alg1.l5.m2.2.2.3.3.cmml">E</mi></msub><mo id="alg1.l5.m2.2.2.2" xref="alg1.l5.m2.2.2.2.cmml">⁢</mo><mrow id="alg1.l5.m2.2.2.1.1" xref="alg1.l5.m2.2.2.1.2.cmml"><mo id="alg1.l5.m2.2.2.1.1.2" stretchy="false" xref="alg1.l5.m2.2.2.1.2.cmml">(</mo><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">s</mi><mo id="alg1.l5.m2.2.2.1.1.3" xref="alg1.l5.m2.2.2.1.2.cmml">,</mo><msup id="alg1.l5.m2.2.2.1.1.1" xref="alg1.l5.m2.2.2.1.1.1.cmml"><mi id="alg1.l5.m2.2.2.1.1.1.2" xref="alg1.l5.m2.2.2.1.1.1.2.cmml">s</mi><mo id="alg1.l5.m2.2.2.1.1.1.3" xref="alg1.l5.m2.2.2.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l5.m2.2.2.1.1.4" stretchy="false" xref="alg1.l5.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.2b"><apply id="alg1.l5.m2.2.2.cmml" xref="alg1.l5.m2.2.2"><times id="alg1.l5.m2.2.2.2.cmml" xref="alg1.l5.m2.2.2.2"></times><apply id="alg1.l5.m2.2.2.3.cmml" xref="alg1.l5.m2.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m2.2.2.3.1.cmml" xref="alg1.l5.m2.2.2.3">subscript</csymbol><ci id="alg1.l5.m2.2.2.3.2.cmml" xref="alg1.l5.m2.2.2.3.2">𝑅</ci><ci id="alg1.l5.m2.2.2.3.3.cmml" xref="alg1.l5.m2.2.2.3.3">𝐸</ci></apply><interval closure="open" id="alg1.l5.m2.2.2.1.2.cmml" xref="alg1.l5.m2.2.2.1.1"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑠</ci><apply id="alg1.l5.m2.2.2.1.1.1.cmml" xref="alg1.l5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.2.2.1.1.1.1.cmml" xref="alg1.l5.m2.2.2.1.1.1">superscript</csymbol><ci id="alg1.l5.m2.2.2.1.1.1.2.cmml" xref="alg1.l5.m2.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l5.m2.2.2.1.1.1.3.cmml" xref="alg1.l5.m2.2.2.1.1.1.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.2c">R_{E}(s,s^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.2d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="alg1.l5.m3.1"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">π</mi><mi id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝜋</ci><ci id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m3.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>Prune the environment DAG <math alttext="G=(V,E)" class="ltx_Math" display="inline" id="alg1.l6.m1.2"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mi id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml">G</mi><mo id="alg1.l6.m1.2.3.1" xref="alg1.l6.m1.2.3.1.cmml">=</mo><mrow id="alg1.l6.m1.2.3.3.2" xref="alg1.l6.m1.2.3.3.1.cmml"><mo id="alg1.l6.m1.2.3.3.2.1" stretchy="false" xref="alg1.l6.m1.2.3.3.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">V</mi><mo id="alg1.l6.m1.2.3.3.2.2" xref="alg1.l6.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">E</mi><mo id="alg1.l6.m1.2.3.3.2.3" stretchy="false" xref="alg1.l6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><eq id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1"></eq><ci id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2">𝐺</ci><interval closure="open" id="alg1.l6.m1.2.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑉</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">G=(V,E)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.2d">italic_G = ( italic_V , italic_E )</annotation></semantics></math> based on the thresholding rule defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.E6" title="In 3.2 Reward-guided pruning and prioritized backward sampling ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">6</span></a>.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>Remove disconnected edges to obtain the pruned DAG <math alttext="G^{\prime}=(V^{\prime},E^{\prime})" class="ltx_Math" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msup id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"><mi id="alg1.l7.m1.2.2.4.2" xref="alg1.l7.m1.2.2.4.2.cmml">G</mi><mo id="alg1.l7.m1.2.2.4.3" xref="alg1.l7.m1.2.2.4.3.cmml">′</mo></msup><mo id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">=</mo><mrow id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.3.cmml"><mo id="alg1.l7.m1.2.2.2.2.3" stretchy="false" xref="alg1.l7.m1.2.2.2.3.cmml">(</mo><msup id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">V</mi><mo id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l7.m1.2.2.2.2.4" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml">E</mi><mo id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="alg1.l7.m1.2.2.2.2.5" stretchy="false" xref="alg1.l7.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><eq id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3"></eq><apply id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.4.1.cmml" xref="alg1.l7.m1.2.2.4">superscript</csymbol><ci id="alg1.l7.m1.2.2.4.2.cmml" xref="alg1.l7.m1.2.2.4.2">𝐺</ci><ci id="alg1.l7.m1.2.2.4.3.cmml" xref="alg1.l7.m1.2.2.4.3">′</ci></apply><interval closure="open" id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">𝑉</ci><ci id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2">𝐸</ci><ci id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">G^{\prime}=(V^{\prime},E^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = ( italic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l8.2">Phase 3: Policy Training</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>Initialize the GFlowNet flow function <math alttext="F_{\theta}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">F</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝐹</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">F_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l10.2">for</span> <math alttext="n=1" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">n</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">=</mo><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></eq><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑛</ci><cn id="alg1.l10.m1.1.1.3.cmml" type="integer" xref="alg1.l10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">n=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_n = 1</annotation></semantics></math> to <math alttext="N" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>     Initialize a batch of trajectories <math alttext="\mathcal{T}=\varnothing" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝒯</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">=</mo><mi id="alg1.l11.m1.1.1.3" mathvariant="normal" xref="alg1.l11.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><eq id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></eq><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝒯</ci><emptyset id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{T}=\varnothing</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">caligraphic_T = ∅</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span> <math alttext="j=1" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">j</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></eq><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑗</ci><cn id="alg1.l12.m1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">j=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_j = 1</annotation></semantics></math> to <math alttext="B" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mi id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_B</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l12.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>         Sample a terminal node <math alttext="x_{j}\in\mathcal{X}^{\prime}\cap\{s_{T_{i}}\}_{i=1}^{M}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">x</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">j</mi></msub><mo id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">∈</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><msup id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.3.2.cmml">𝒳</mi><mo id="alg1.l13.m1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="alg1.l13.m1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.cmml">∩</mo><msubsup id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l13.m1.1.1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.2.cmml">s</mi><msub id="alg1.l13.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg1.l13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1.1.1.3.1" xref="alg1.l13.m1.1.1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l13.m1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.3.cmml">M</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><in id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"></in><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑥</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑗</ci></apply><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><intersect id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></intersect><apply id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.3">superscript</csymbol><ci id="alg1.l13.m1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.3.2">𝒳</ci><ci id="alg1.l13.m1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.3.3">′</ci></apply><apply id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1">subscript</csymbol><set id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1"><apply id="alg1.l13.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set><apply id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3"><eq id="alg1.l13.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.3.1"></eq><ci id="alg1.l13.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l13.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l13.m1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l13.m1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">x_{j}\in\mathcal{X}^{\prime}\cap\{s_{T_{i}}\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∩ { italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> with probability <math alttext="P(x)\propto R(x)" class="ltx_Math" display="inline" id="alg1.l13.m2.2"><semantics id="alg1.l13.m2.2a"><mrow id="alg1.l13.m2.2.3" xref="alg1.l13.m2.2.3.cmml"><mrow id="alg1.l13.m2.2.3.2" xref="alg1.l13.m2.2.3.2.cmml"><mi id="alg1.l13.m2.2.3.2.2" xref="alg1.l13.m2.2.3.2.2.cmml">P</mi><mo id="alg1.l13.m2.2.3.2.1" xref="alg1.l13.m2.2.3.2.1.cmml">⁢</mo><mrow id="alg1.l13.m2.2.3.2.3.2" xref="alg1.l13.m2.2.3.2.cmml"><mo id="alg1.l13.m2.2.3.2.3.2.1" stretchy="false" xref="alg1.l13.m2.2.3.2.cmml">(</mo><mi id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">x</mi><mo id="alg1.l13.m2.2.3.2.3.2.2" stretchy="false" xref="alg1.l13.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m2.2.3.1" xref="alg1.l13.m2.2.3.1.cmml">∝</mo><mrow id="alg1.l13.m2.2.3.3" xref="alg1.l13.m2.2.3.3.cmml"><mi id="alg1.l13.m2.2.3.3.2" xref="alg1.l13.m2.2.3.3.2.cmml">R</mi><mo id="alg1.l13.m2.2.3.3.1" xref="alg1.l13.m2.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l13.m2.2.3.3.3.2" xref="alg1.l13.m2.2.3.3.cmml"><mo id="alg1.l13.m2.2.3.3.3.2.1" stretchy="false" xref="alg1.l13.m2.2.3.3.cmml">(</mo><mi id="alg1.l13.m2.2.2" xref="alg1.l13.m2.2.2.cmml">x</mi><mo id="alg1.l13.m2.2.3.3.3.2.2" stretchy="false" xref="alg1.l13.m2.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.2b"><apply id="alg1.l13.m2.2.3.cmml" xref="alg1.l13.m2.2.3"><csymbol cd="latexml" id="alg1.l13.m2.2.3.1.cmml" xref="alg1.l13.m2.2.3.1">proportional-to</csymbol><apply id="alg1.l13.m2.2.3.2.cmml" xref="alg1.l13.m2.2.3.2"><times id="alg1.l13.m2.2.3.2.1.cmml" xref="alg1.l13.m2.2.3.2.1"></times><ci id="alg1.l13.m2.2.3.2.2.cmml" xref="alg1.l13.m2.2.3.2.2">𝑃</ci><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">𝑥</ci></apply><apply id="alg1.l13.m2.2.3.3.cmml" xref="alg1.l13.m2.2.3.3"><times id="alg1.l13.m2.2.3.3.1.cmml" xref="alg1.l13.m2.2.3.3.1"></times><ci id="alg1.l13.m2.2.3.3.2.cmml" xref="alg1.l13.m2.2.3.3.2">𝑅</ci><ci id="alg1.l13.m2.2.2.cmml" xref="alg1.l13.m2.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.2c">P(x)\propto R(x)</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.2d">italic_P ( italic_x ) ∝ italic_R ( italic_x )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>         Initialize a trajectory <math alttext="\tau_{j}=\varnothing" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">τ</mi><mi id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">=</mo><mi id="alg1.l14.m1.1.1.3" mathvariant="normal" xref="alg1.l14.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></eq><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝜏</ci><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑗</ci></apply><emptyset id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\tau_{j}=\varnothing</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ∅</annotation></semantics></math>, <math alttext="s_{now}=x_{j}" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><mrow id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><msub id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml"><mi id="alg1.l14.m2.1.1.2.2" xref="alg1.l14.m2.1.1.2.2.cmml">s</mi><mrow id="alg1.l14.m2.1.1.2.3" xref="alg1.l14.m2.1.1.2.3.cmml"><mi id="alg1.l14.m2.1.1.2.3.2" xref="alg1.l14.m2.1.1.2.3.2.cmml">n</mi><mo id="alg1.l14.m2.1.1.2.3.1" xref="alg1.l14.m2.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.2.3.3" xref="alg1.l14.m2.1.1.2.3.3.cmml">o</mi><mo id="alg1.l14.m2.1.1.2.3.1a" xref="alg1.l14.m2.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.2.3.4" xref="alg1.l14.m2.1.1.2.3.4.cmml">w</mi></mrow></msub><mo id="alg1.l14.m2.1.1.1" xref="alg1.l14.m2.1.1.1.cmml">=</mo><msub id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml"><mi id="alg1.l14.m2.1.1.3.2" xref="alg1.l14.m2.1.1.3.2.cmml">x</mi><mi id="alg1.l14.m2.1.1.3.3" xref="alg1.l14.m2.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><eq id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1.1"></eq><apply id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.2.1.cmml" xref="alg1.l14.m2.1.1.2">subscript</csymbol><ci id="alg1.l14.m2.1.1.2.2.cmml" xref="alg1.l14.m2.1.1.2.2">𝑠</ci><apply id="alg1.l14.m2.1.1.2.3.cmml" xref="alg1.l14.m2.1.1.2.3"><times id="alg1.l14.m2.1.1.2.3.1.cmml" xref="alg1.l14.m2.1.1.2.3.1"></times><ci id="alg1.l14.m2.1.1.2.3.2.cmml" xref="alg1.l14.m2.1.1.2.3.2">𝑛</ci><ci id="alg1.l14.m2.1.1.2.3.3.cmml" xref="alg1.l14.m2.1.1.2.3.3">𝑜</ci><ci id="alg1.l14.m2.1.1.2.3.4.cmml" xref="alg1.l14.m2.1.1.2.3.4">𝑤</ci></apply></apply><apply id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.3.1.cmml" xref="alg1.l14.m2.1.1.3">subscript</csymbol><ci id="alg1.l14.m2.1.1.3.2.cmml" xref="alg1.l14.m2.1.1.3.2">𝑥</ci><ci id="alg1.l14.m2.1.1.3.3.cmml" xref="alg1.l14.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">s_{now}=x_{j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">italic_s start_POSTSUBSCRIPT italic_n italic_o italic_w end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="s_{pre}=x_{j}" class="ltx_Math" display="inline" id="alg1.l14.m3.1"><semantics id="alg1.l14.m3.1a"><mrow id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml"><msub id="alg1.l14.m3.1.1.2" xref="alg1.l14.m3.1.1.2.cmml"><mi id="alg1.l14.m3.1.1.2.2" xref="alg1.l14.m3.1.1.2.2.cmml">s</mi><mrow id="alg1.l14.m3.1.1.2.3" xref="alg1.l14.m3.1.1.2.3.cmml"><mi id="alg1.l14.m3.1.1.2.3.2" xref="alg1.l14.m3.1.1.2.3.2.cmml">p</mi><mo id="alg1.l14.m3.1.1.2.3.1" xref="alg1.l14.m3.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m3.1.1.2.3.3" xref="alg1.l14.m3.1.1.2.3.3.cmml">r</mi><mo id="alg1.l14.m3.1.1.2.3.1a" xref="alg1.l14.m3.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m3.1.1.2.3.4" xref="alg1.l14.m3.1.1.2.3.4.cmml">e</mi></mrow></msub><mo id="alg1.l14.m3.1.1.1" xref="alg1.l14.m3.1.1.1.cmml">=</mo><msub id="alg1.l14.m3.1.1.3" xref="alg1.l14.m3.1.1.3.cmml"><mi id="alg1.l14.m3.1.1.3.2" xref="alg1.l14.m3.1.1.3.2.cmml">x</mi><mi id="alg1.l14.m3.1.1.3.3" xref="alg1.l14.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.1b"><apply id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1"><eq id="alg1.l14.m3.1.1.1.cmml" xref="alg1.l14.m3.1.1.1"></eq><apply id="alg1.l14.m3.1.1.2.cmml" xref="alg1.l14.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m3.1.1.2.1.cmml" xref="alg1.l14.m3.1.1.2">subscript</csymbol><ci id="alg1.l14.m3.1.1.2.2.cmml" xref="alg1.l14.m3.1.1.2.2">𝑠</ci><apply id="alg1.l14.m3.1.1.2.3.cmml" xref="alg1.l14.m3.1.1.2.3"><times id="alg1.l14.m3.1.1.2.3.1.cmml" xref="alg1.l14.m3.1.1.2.3.1"></times><ci id="alg1.l14.m3.1.1.2.3.2.cmml" xref="alg1.l14.m3.1.1.2.3.2">𝑝</ci><ci id="alg1.l14.m3.1.1.2.3.3.cmml" xref="alg1.l14.m3.1.1.2.3.3">𝑟</ci><ci id="alg1.l14.m3.1.1.2.3.4.cmml" xref="alg1.l14.m3.1.1.2.3.4">𝑒</ci></apply></apply><apply id="alg1.l14.m3.1.1.3.cmml" xref="alg1.l14.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m3.1.1.3.1.cmml" xref="alg1.l14.m3.1.1.3">subscript</csymbol><ci id="alg1.l14.m3.1.1.3.2.cmml" xref="alg1.l14.m3.1.1.3.2">𝑥</ci><ci id="alg1.l14.m3.1.1.3.3.cmml" xref="alg1.l14.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.1c">s_{pre}=x_{j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m3.1d">italic_s start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l15.2">while</span> <math alttext="s_{now}\neq s_{0}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">s</mi><mrow id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml"><mi id="alg1.l15.m1.1.1.2.3.2" xref="alg1.l15.m1.1.1.2.3.2.cmml">n</mi><mo id="alg1.l15.m1.1.1.2.3.1" xref="alg1.l15.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.2.3.3" xref="alg1.l15.m1.1.1.2.3.3.cmml">o</mi><mo id="alg1.l15.m1.1.1.2.3.1a" xref="alg1.l15.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.2.3.4" xref="alg1.l15.m1.1.1.2.3.4.cmml">w</mi></mrow></msub><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">≠</mo><msub id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">s</mi><mn id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><neq id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></neq><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝑠</ci><apply id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3"><times id="alg1.l15.m1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.2.3.1"></times><ci id="alg1.l15.m1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.2.3.2">𝑛</ci><ci id="alg1.l15.m1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.2.3.3">𝑜</ci><ci id="alg1.l15.m1.1.1.2.3.4.cmml" xref="alg1.l15.m1.1.1.2.3.4">𝑤</ci></apply></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝑠</ci><cn id="alg1.l15.m1.1.1.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">s_{now}\neq s_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_s start_POSTSUBSCRIPT italic_n italic_o italic_w end_POSTSUBSCRIPT ≠ italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l15.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>              Sample <math alttext="s_{pre}\sim\mathcal{P}_{B}(\cdot|s_{now})" class="ltx_math_unparsed" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1b"><msub id="alg1.l16.m1.1.1"><mi id="alg1.l16.m1.1.1.2">s</mi><mrow id="alg1.l16.m1.1.1.3"><mi id="alg1.l16.m1.1.1.3.2">p</mi><mo id="alg1.l16.m1.1.1.3.1">⁢</mo><mi id="alg1.l16.m1.1.1.3.3">r</mi><mo id="alg1.l16.m1.1.1.3.1a">⁢</mo><mi id="alg1.l16.m1.1.1.3.4">e</mi></mrow></msub><mo id="alg1.l16.m1.1.2">∼</mo><msub id="alg1.l16.m1.1.3"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.3.2">𝒫</mi><mi id="alg1.l16.m1.1.3.3">B</mi></msub><mrow id="alg1.l16.m1.1.4"><mo id="alg1.l16.m1.1.4.1" stretchy="false">(</mo><mo id="alg1.l16.m1.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="alg1.l16.m1.1.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="alg1.l16.m1.1.4.4"><mi id="alg1.l16.m1.1.4.4.2">s</mi><mrow id="alg1.l16.m1.1.4.4.3"><mi id="alg1.l16.m1.1.4.4.3.2">n</mi><mo id="alg1.l16.m1.1.4.4.3.1">⁢</mo><mi id="alg1.l16.m1.1.4.4.3.3">o</mi><mo id="alg1.l16.m1.1.4.4.3.1a">⁢</mo><mi id="alg1.l16.m1.1.4.4.3.4">w</mi></mrow></msub><mo id="alg1.l16.m1.1.4.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">s_{pre}\sim\mathcal{P}_{B}(\cdot|s_{now})</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_s start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT ∼ caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_n italic_o italic_w end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathcal{P}_{B}" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><msub id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml">𝒫</mi><mi id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1">subscript</csymbol><ci id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">𝒫</ci><ci id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\mathcal{P}_{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">caligraphic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> is defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.E7" title="In 3.2 Reward-guided pruning and prioritized backward sampling ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">7</span></a> over <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="alg1.l16.m3.1"><semantics id="alg1.l16.m3.1a"><msup id="alg1.l16.m3.1.1" xref="alg1.l16.m3.1.1.cmml"><mi id="alg1.l16.m3.1.1.2" xref="alg1.l16.m3.1.1.2.cmml">G</mi><mo id="alg1.l16.m3.1.1.3" xref="alg1.l16.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l16.m3.1b"><apply id="alg1.l16.m3.1.1.cmml" xref="alg1.l16.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m3.1.1.1.cmml" xref="alg1.l16.m3.1.1">superscript</csymbol><ci id="alg1.l16.m3.1.1.2.cmml" xref="alg1.l16.m3.1.1.2">𝐺</ci><ci id="alg1.l16.m3.1.1.3.cmml" xref="alg1.l16.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m3.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m3.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>              <math alttext="\tau_{j}=\tau_{j}\cup\{(s_{pre}\rightarrow s_{now})\}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msub id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">τ</mi><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">j</mi></msub><mo id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">=</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><msub id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml">τ</mi><mi id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">∪</mo><mrow id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.2.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l17.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">r</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.4" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">e</mi></mrow></msub><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.1" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.cmml">→</mo><msub id="alg1.l17.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">n</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">o</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.4" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">w</mi></mrow></msub></mrow><mo id="alg1.l17.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l17.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l17.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2"></eq><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝜏</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑗</ci></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><union id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></union><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2">𝜏</ci><ci id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3">𝑗</ci></apply><set id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1"><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1">→</ci><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">𝑠</ci><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3"><times id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.3">𝑟</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.4">𝑒</ci></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3"><times id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.3.4">𝑤</ci></apply></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\tau_{j}=\tau_{j}\cup\{(s_{pre}\rightarrow s_{now})\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∪ { ( italic_s start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT → italic_s start_POSTSUBSCRIPT italic_n italic_o italic_w end_POSTSUBSCRIPT ) }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>              <math alttext="s_{now}=s_{pre}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msub id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2" xref="alg1.l18.m1.1.1.2.2.cmml">s</mi><mrow id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml"><mi id="alg1.l18.m1.1.1.2.3.2" xref="alg1.l18.m1.1.1.2.3.2.cmml">n</mi><mo id="alg1.l18.m1.1.1.2.3.1" xref="alg1.l18.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.2.3.3" xref="alg1.l18.m1.1.1.2.3.3.cmml">o</mi><mo id="alg1.l18.m1.1.1.2.3.1a" xref="alg1.l18.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.2.3.4" xref="alg1.l18.m1.1.1.2.3.4.cmml">w</mi></mrow></msub><mo id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">=</mo><msub id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml">s</mi><mrow id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.2" xref="alg1.l18.m1.1.1.3.3.2.cmml">p</mi><mo id="alg1.l18.m1.1.1.3.3.1" xref="alg1.l18.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3" xref="alg1.l18.m1.1.1.3.3.3.cmml">r</mi><mo id="alg1.l18.m1.1.1.3.3.1a" xref="alg1.l18.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.4" xref="alg1.l18.m1.1.1.3.3.4.cmml">e</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><eq id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"></eq><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝑠</ci><apply id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3"><times id="alg1.l18.m1.1.1.2.3.1.cmml" xref="alg1.l18.m1.1.1.2.3.1"></times><ci id="alg1.l18.m1.1.1.2.3.2.cmml" xref="alg1.l18.m1.1.1.2.3.2">𝑛</ci><ci id="alg1.l18.m1.1.1.2.3.3.cmml" xref="alg1.l18.m1.1.1.2.3.3">𝑜</ci><ci id="alg1.l18.m1.1.1.2.3.4.cmml" xref="alg1.l18.m1.1.1.2.3.4">𝑤</ci></apply></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2">𝑠</ci><apply id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3"><times id="alg1.l18.m1.1.1.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.1"></times><ci id="alg1.l18.m1.1.1.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.2">𝑝</ci><ci id="alg1.l18.m1.1.1.3.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3">𝑟</ci><ci id="alg1.l18.m1.1.1.3.3.4.cmml" xref="alg1.l18.m1.1.1.3.3.4">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">s_{now}=s_{pre}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_s start_POSTSUBSCRIPT italic_n italic_o italic_w end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l19.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l19.3">while</span> <span class="ltx_text" id="alg1.l19.4" style="color:#0000FF;">// Backward sampling.</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>         <math alttext="\mathcal{T}=\mathcal{T}\cup\{\tau_{j}\}" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">𝒯</mi><mo id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">=</mo><mrow id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.1.1.1.3" xref="alg1.l20.m1.1.1.1.3.cmml">𝒯</mi><mo id="alg1.l20.m1.1.1.1.2" xref="alg1.l20.m1.1.1.1.2.cmml">∪</mo><mrow id="alg1.l20.m1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.2.cmml"><mo id="alg1.l20.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l20.m1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l20.m1.1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m1.1.1.1.1.1.1.2" xref="alg1.l20.m1.1.1.1.1.1.1.2.cmml">τ</mi><mi id="alg1.l20.m1.1.1.1.1.1.1.3" xref="alg1.l20.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l20.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l20.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><eq id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2"></eq><ci id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">𝒯</ci><apply id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"><union id="alg1.l20.m1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.2"></union><ci id="alg1.l20.m1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.3">𝒯</ci><set id="alg1.l20.m1.1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.1.1"><apply id="alg1.l20.m1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.2">𝜏</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.3">𝑗</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\mathcal{T}=\mathcal{T}\cup\{\tau_{j}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">caligraphic_T = caligraphic_T ∪ { italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l21.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l21.3">for</span> <span class="ltx_text" id="alg1.l21.4" style="color:#0000FF;">// Backward sample trajectories.</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>     Optimize <math alttext="F_{\theta}" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><msub id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">F</mi><mi id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1">subscript</csymbol><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">𝐹</ci><ci id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">F_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="alg1.l22.m2.1"><semantics id="alg1.l22.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><ci id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m2.1d">caligraphic_T</annotation></semantics></math> using the FM loss over <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="alg1.l22.m3.1"><semantics id="alg1.l22.m3.1a"><msup id="alg1.l22.m3.1.1" xref="alg1.l22.m3.1.1.cmml"><mi id="alg1.l22.m3.1.1.2" xref="alg1.l22.m3.1.1.2.cmml">G</mi><mo id="alg1.l22.m3.1.1.3" xref="alg1.l22.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l22.m3.1b"><apply id="alg1.l22.m3.1.1.cmml" xref="alg1.l22.m3.1.1"><csymbol cd="ambiguous" id="alg1.l22.m3.1.1.1.cmml" xref="alg1.l22.m3.1.1">superscript</csymbol><ci id="alg1.l22.m3.1.1.2.cmml" xref="alg1.l22.m3.1.1.2">𝐺</ci><ci id="alg1.l22.m3.1.1.3.cmml" xref="alg1.l22.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m3.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m3.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, as formulated in Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.E8" title="In 3.2 Reward-guided pruning and prioritized backward sampling ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">8</span></a>. <span class="ltx_text" id="alg1.l22.2" style="color:#0000FF;">// Update flow function</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l23.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l23.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>Extract the GFlowNet policy:

<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}_{F}(s^{\prime}|s)=\pi_{\theta}(s^{\prime}|s)=\begin{cases}\frac{F_%
{\theta}(s,s^{\prime})}{\sum_{(s\rightarrow s^{\prime\prime})\in E^{\prime}}F_%
{\theta}(s,s^{\prime\prime})},&amp;\text{if }(s\rightarrow s^{\prime})\in E^{%
\prime},\\
0,&amp;\text{otherwise}.\end{cases}" class="ltx_Math" display="block" id="A1.Ex1.m1.6"><semantics id="A1.Ex1.m1.6a"><mrow id="A1.Ex1.m1.6.6" xref="A1.Ex1.m1.6.6.cmml"><mrow id="A1.Ex1.m1.5.5.1" xref="A1.Ex1.m1.5.5.1.cmml"><msub id="A1.Ex1.m1.5.5.1.3" xref="A1.Ex1.m1.5.5.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.5.5.1.3.2" xref="A1.Ex1.m1.5.5.1.3.2.cmml">𝒫</mi><mi id="A1.Ex1.m1.5.5.1.3.3" xref="A1.Ex1.m1.5.5.1.3.3.cmml">F</mi></msub><mo id="A1.Ex1.m1.5.5.1.2" xref="A1.Ex1.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.5.5.1.1.1" xref="A1.Ex1.m1.5.5.1.1.1.1.cmml"><mo id="A1.Ex1.m1.5.5.1.1.1.2" stretchy="false" xref="A1.Ex1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.5.5.1.1.1.1" xref="A1.Ex1.m1.5.5.1.1.1.1.cmml"><msup id="A1.Ex1.m1.5.5.1.1.1.1.2" xref="A1.Ex1.m1.5.5.1.1.1.1.2.cmml"><mi id="A1.Ex1.m1.5.5.1.1.1.1.2.2" xref="A1.Ex1.m1.5.5.1.1.1.1.2.2.cmml">s</mi><mo id="A1.Ex1.m1.5.5.1.1.1.1.2.3" xref="A1.Ex1.m1.5.5.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A1.Ex1.m1.5.5.1.1.1.1.1" xref="A1.Ex1.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex1.m1.5.5.1.1.1.1.3" xref="A1.Ex1.m1.5.5.1.1.1.1.3.cmml">s</mi></mrow><mo id="A1.Ex1.m1.5.5.1.1.1.3" stretchy="false" xref="A1.Ex1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.6.6.4" xref="A1.Ex1.m1.6.6.4.cmml">=</mo><mrow id="A1.Ex1.m1.6.6.2" xref="A1.Ex1.m1.6.6.2.cmml"><msub id="A1.Ex1.m1.6.6.2.3" xref="A1.Ex1.m1.6.6.2.3.cmml"><mi id="A1.Ex1.m1.6.6.2.3.2" xref="A1.Ex1.m1.6.6.2.3.2.cmml">π</mi><mi id="A1.Ex1.m1.6.6.2.3.3" xref="A1.Ex1.m1.6.6.2.3.3.cmml">θ</mi></msub><mo id="A1.Ex1.m1.6.6.2.2" xref="A1.Ex1.m1.6.6.2.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.6.6.2.1.1" xref="A1.Ex1.m1.6.6.2.1.1.1.cmml"><mo id="A1.Ex1.m1.6.6.2.1.1.2" stretchy="false" xref="A1.Ex1.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.6.6.2.1.1.1" xref="A1.Ex1.m1.6.6.2.1.1.1.cmml"><msup id="A1.Ex1.m1.6.6.2.1.1.1.2" xref="A1.Ex1.m1.6.6.2.1.1.1.2.cmml"><mi id="A1.Ex1.m1.6.6.2.1.1.1.2.2" xref="A1.Ex1.m1.6.6.2.1.1.1.2.2.cmml">s</mi><mo id="A1.Ex1.m1.6.6.2.1.1.1.2.3" xref="A1.Ex1.m1.6.6.2.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A1.Ex1.m1.6.6.2.1.1.1.1" xref="A1.Ex1.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex1.m1.6.6.2.1.1.1.3" xref="A1.Ex1.m1.6.6.2.1.1.1.3.cmml">s</mi></mrow><mo id="A1.Ex1.m1.6.6.2.1.1.3" stretchy="false" xref="A1.Ex1.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.6.6.5" xref="A1.Ex1.m1.6.6.5.cmml">=</mo><mrow id="A1.Ex1.m1.4.4" xref="A1.Ex1.m1.6.6.6.1.cmml"><mo id="A1.Ex1.m1.4.4.5" xref="A1.Ex1.m1.6.6.6.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.Ex1.m1.4.4.4" rowspacing="0pt" xref="A1.Ex1.m1.6.6.6.1.cmml"><mtr id="A1.Ex1.m1.4.4.4a" xref="A1.Ex1.m1.6.6.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.Ex1.m1.4.4.4b" xref="A1.Ex1.m1.6.6.6.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.1.1.7" xref="A1.Ex1.m1.1.1.1.1.1.1.5.cmml"><mstyle displaystyle="false" id="A1.Ex1.m1.1.1.1.1.1.1.5" xref="A1.Ex1.m1.1.1.1.1.1.1.5.cmml"><mfrac id="A1.Ex1.m1.1.1.1.1.1.1.5a" xref="A1.Ex1.m1.1.1.1.1.1.1.5.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.1.1.2.2" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.2" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.2.cmml">F</mi><mi id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.3" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.3.cmml">θ</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.1.1.2.2.3" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="A1.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.2.cmml">,</mo><msup id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml">′</mo></msup><mo id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.4" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mrow id="A1.Ex1.m1.1.1.1.1.1.1.5.5" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.cmml"><mstyle displaystyle="false" id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4a" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.2" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.2.cmml">∑</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.2" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.1" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.1.cmml">→</mo><msup id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.3.cmml">′′</mo></msup></mrow><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.3" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.2.cmml">∈</mo><msup id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.2.cmml">E</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.3.cmml">′</mo></msup></mrow></msub></mstyle><mrow id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.2.cmml">F</mi><mi id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.3.cmml">θ</mi></msub><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.2.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.2" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.2.cmml">(</mo><mi id="A1.Ex1.m1.1.1.1.1.1.1.4.4.2" xref="A1.Ex1.m1.1.1.1.1.1.1.4.4.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.2.cmml">,</mo><msup id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.3.cmml">′′</mo></msup><mo id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.4" stretchy="false" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.Ex1.m1.1.1.1.1.1.1.7.1" xref="A1.Ex1.m1.1.1.1.1.1.1.5.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.Ex1.m1.4.4.4c" xref="A1.Ex1.m1.6.6.6.1.cmml"><mrow id="A1.Ex1.m1.2.2.2.2.2.1.1" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="A1.Ex1.m1.2.2.2.2.2.1.1.1" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.cmml"><mtext id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3a.cmml">if </mtext><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.1" stretchy="false" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml">→</mo><msup id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.2.cmml">∈</mo><msup id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.2.cmml">E</mi><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.3" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A1.Ex1.m1.2.2.2.2.2.1.1.2" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="A1.Ex1.m1.4.4.4d" xref="A1.Ex1.m1.6.6.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.Ex1.m1.4.4.4e" xref="A1.Ex1.m1.6.6.6.1.cmml"><mrow id="A1.Ex1.m1.3.3.3.3.1.1.3" xref="A1.Ex1.m1.6.6.6.1.cmml"><mn id="A1.Ex1.m1.3.3.3.3.1.1.1" xref="A1.Ex1.m1.3.3.3.3.1.1.1.cmml">0</mn><mo id="A1.Ex1.m1.3.3.3.3.1.1.3.1" xref="A1.Ex1.m1.6.6.6.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.Ex1.m1.4.4.4f" xref="A1.Ex1.m1.6.6.6.1.cmml"><mrow id="A1.Ex1.m1.4.4.4.4.2.1.3" xref="A1.Ex1.m1.4.4.4.4.2.1.1a.cmml"><mtext id="A1.Ex1.m1.4.4.4.4.2.1.1" xref="A1.Ex1.m1.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="A1.Ex1.m1.4.4.4.4.2.1.3.1" lspace="0em" xref="A1.Ex1.m1.4.4.4.4.2.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.6b"><apply id="A1.Ex1.m1.6.6.cmml" xref="A1.Ex1.m1.6.6"><and id="A1.Ex1.m1.6.6a.cmml" xref="A1.Ex1.m1.6.6"></and><apply id="A1.Ex1.m1.6.6b.cmml" xref="A1.Ex1.m1.6.6"><eq id="A1.Ex1.m1.6.6.4.cmml" xref="A1.Ex1.m1.6.6.4"></eq><apply id="A1.Ex1.m1.5.5.1.cmml" xref="A1.Ex1.m1.5.5.1"><times id="A1.Ex1.m1.5.5.1.2.cmml" xref="A1.Ex1.m1.5.5.1.2"></times><apply id="A1.Ex1.m1.5.5.1.3.cmml" xref="A1.Ex1.m1.5.5.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.1.3.1.cmml" xref="A1.Ex1.m1.5.5.1.3">subscript</csymbol><ci id="A1.Ex1.m1.5.5.1.3.2.cmml" xref="A1.Ex1.m1.5.5.1.3.2">𝒫</ci><ci id="A1.Ex1.m1.5.5.1.3.3.cmml" xref="A1.Ex1.m1.5.5.1.3.3">𝐹</ci></apply><apply id="A1.Ex1.m1.5.5.1.1.1.1.cmml" xref="A1.Ex1.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.5.5.1.1.1.1.1.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex1.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.2">superscript</csymbol><ci id="A1.Ex1.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.2.2">𝑠</ci><ci id="A1.Ex1.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.2.3">′</ci></apply><ci id="A1.Ex1.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex1.m1.5.5.1.1.1.1.3">𝑠</ci></apply></apply><apply id="A1.Ex1.m1.6.6.2.cmml" xref="A1.Ex1.m1.6.6.2"><times id="A1.Ex1.m1.6.6.2.2.cmml" xref="A1.Ex1.m1.6.6.2.2"></times><apply id="A1.Ex1.m1.6.6.2.3.cmml" xref="A1.Ex1.m1.6.6.2.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.6.6.2.3.1.cmml" xref="A1.Ex1.m1.6.6.2.3">subscript</csymbol><ci id="A1.Ex1.m1.6.6.2.3.2.cmml" xref="A1.Ex1.m1.6.6.2.3.2">𝜋</ci><ci id="A1.Ex1.m1.6.6.2.3.3.cmml" xref="A1.Ex1.m1.6.6.2.3.3">𝜃</ci></apply><apply id="A1.Ex1.m1.6.6.2.1.1.1.cmml" xref="A1.Ex1.m1.6.6.2.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.6.6.2.1.1.1.1.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex1.m1.6.6.2.1.1.1.2.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.6.6.2.1.1.1.2.1.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.2">superscript</csymbol><ci id="A1.Ex1.m1.6.6.2.1.1.1.2.2.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.2.2">𝑠</ci><ci id="A1.Ex1.m1.6.6.2.1.1.1.2.3.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.2.3">′</ci></apply><ci id="A1.Ex1.m1.6.6.2.1.1.1.3.cmml" xref="A1.Ex1.m1.6.6.2.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="A1.Ex1.m1.6.6c.cmml" xref="A1.Ex1.m1.6.6"><eq id="A1.Ex1.m1.6.6.5.cmml" xref="A1.Ex1.m1.6.6.5"></eq><share href="https://arxiv.org/html/2505.20110v1#A1.Ex1.m1.6.6.2.cmml" id="A1.Ex1.m1.6.6d.cmml" xref="A1.Ex1.m1.6.6"></share><apply id="A1.Ex1.m1.6.6.6.1.cmml" xref="A1.Ex1.m1.4.4"><csymbol cd="latexml" id="A1.Ex1.m1.6.6.6.1.1.cmml" xref="A1.Ex1.m1.4.4.5">cases</csymbol><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.7"><divide id="A1.Ex1.m1.1.1.1.1.1.1.5.6.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.7"></divide><apply id="A1.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2"><times id="A1.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.3"></times><apply id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.2">𝐹</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.4.3">𝜃</ci></apply><interval closure="open" id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1"><ci id="A1.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.1">𝑠</ci><apply id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1">superscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2.2.2.1.1.3">′</ci></apply></interval></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.5.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5"><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4">subscript</csymbol><sum id="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.4.2"></sum><apply id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1"><in id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.2"></in><apply id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1"><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.1">→</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2">𝑠</ci><apply id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.3">′′</ci></apply></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3">superscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.2">𝐸</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.1.1.3.3">′</ci></apply></apply></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3"><times id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.2"></times><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.2">𝐹</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.3.3">𝜃</ci></apply><interval closure="open" id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1"><ci id="A1.Ex1.m1.1.1.1.1.1.1.4.4.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.4.4.2">𝑠</ci><apply id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1">superscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.5.5.3.1.1.1.3">′′</ci></apply></interval></apply></apply></apply><apply id="A1.Ex1.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1"><in id="A1.Ex1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.2"></in><apply id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1"><times id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.2"></times><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3a.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3"><mtext id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.3">if </mtext></ci><apply id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1"><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.1">→</ci><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.2">𝑠</ci><apply id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply><apply id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.2">𝐸</ci><ci id="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1.1.1.3.3">′</ci></apply></apply><cn id="A1.Ex1.m1.3.3.3.3.1.1.1.cmml" type="integer" xref="A1.Ex1.m1.3.3.3.3.1.1.1">0</cn><ci id="A1.Ex1.m1.4.4.4.4.2.1.1a.cmml" xref="A1.Ex1.m1.4.4.4.4.2.1.3"><mtext id="A1.Ex1.m1.4.4.4.4.2.1.1.cmml" xref="A1.Ex1.m1.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.6c">\mathcal{P}_{F}(s^{\prime}|s)=\pi_{\theta}(s^{\prime}|s)=\begin{cases}\frac{F_%
{\theta}(s,s^{\prime})}{\sum_{(s\rightarrow s^{\prime\prime})\in E^{\prime}}F_%
{\theta}(s,s^{\prime\prime})},&amp;\text{if }(s\rightarrow s^{\prime})\in E^{%
\prime},\\
0,&amp;\text{otherwise}.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.6d">caligraphic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s ) = italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s ) = { start_ROW start_CELL divide start_ARG italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_s → italic_s start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) ∈ italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s , italic_s start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) end_ARG , end_CELL start_CELL if ( italic_s → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∈ italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table> <span class="ltx_text" id="alg1.l24.2" style="color:#0000FF;">// Obtain policy from flow</span>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l25.2">Output:</span> Trained GFlowNet policy <math alttext="\mathcal{P}_{F}" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><msub id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml">𝒫</mi><mi id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1">subscript</csymbol><ci id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2">𝒫</ci><ci id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">\mathcal{P}_{F}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">caligraphic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Edge Reward Extraction</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l1.2">Input:</span> Offline dataset <math alttext="\mathcal{D}=\{\tau_{i}=(s_{0},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}" class="ltx_Math" display="inline" id="alg2.l1.m1.2"><semantics id="alg2.l1.m1.2a"><mrow id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.2.2.3" xref="alg2.l1.m1.2.2.3.cmml">𝒟</mi><mo id="alg2.l1.m1.2.2.2" xref="alg2.l1.m1.2.2.2.cmml">=</mo><msubsup id="alg2.l1.m1.2.2.1" xref="alg2.l1.m1.2.2.1.cmml"><mrow id="alg2.l1.m1.2.2.1.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.2.cmml"><mo id="alg2.l1.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.2.cmml">{</mo><mrow id="alg2.l1.m1.2.2.1.1.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.1.cmml"><msub id="alg2.l1.m1.2.2.1.1.1.1.1.5" xref="alg2.l1.m1.2.2.1.1.1.1.1.5.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.5.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.5.2.cmml">τ</mi><mi id="alg2.l1.m1.2.2.1.1.1.1.1.5.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="alg2.l1.m1.2.2.1.1.1.1.1.4" xref="alg2.l1.m1.2.2.1.1.1.1.1.4.cmml">=</mo><mrow id="alg2.l1.m1.2.2.1.1.1.1.1.3.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml"><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.4" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml">(</mo><msub id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.5" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><mi id="alg2.l1.m1.1.1" mathvariant="normal" xref="alg2.l1.m1.1.1.cmml">…</mi><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.6" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><msub id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">s</mi><msub id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml">T</mi><mi id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub></msub><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.7" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml">,</mo><mrow id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml">R</mi><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml">⁢</mo><mrow id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.2" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><msub id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2.cmml">s</mi><msub id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.cmml"><mi id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2.cmml">T</mi><mi id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.3" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.8" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="alg2.l1.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg2.l1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m1.2.2.1.1.3" xref="alg2.l1.m1.2.2.1.1.3.cmml"><mi id="alg2.l1.m1.2.2.1.1.3.2" xref="alg2.l1.m1.2.2.1.1.3.2.cmml">i</mi><mo id="alg2.l1.m1.2.2.1.1.3.1" xref="alg2.l1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="alg2.l1.m1.2.2.1.1.3.3" xref="alg2.l1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m1.2.2.1.3" xref="alg2.l1.m1.2.2.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.2b"><apply id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2"><eq id="alg2.l1.m1.2.2.2.cmml" xref="alg2.l1.m1.2.2.2"></eq><ci id="alg2.l1.m1.2.2.3.cmml" xref="alg2.l1.m1.2.2.3">𝒟</ci><apply id="alg2.l1.m1.2.2.1.cmml" xref="alg2.l1.m1.2.2.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.2.cmml" xref="alg2.l1.m1.2.2.1">superscript</csymbol><apply id="alg2.l1.m1.2.2.1.1.cmml" xref="alg2.l1.m1.2.2.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.2.cmml" xref="alg2.l1.m1.2.2.1">subscript</csymbol><set id="alg2.l1.m1.2.2.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1"><apply id="alg2.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1"><eq id="alg2.l1.m1.2.2.1.1.1.1.1.4.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.4"></eq><apply id="alg2.l1.m1.2.2.1.1.1.1.1.5.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.5"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.5.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.5">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.5.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.5.2">𝜏</ci><ci id="alg2.l1.m1.2.2.1.1.1.1.1.5.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.5.3">𝑖</ci></apply><vector id="alg2.l1.m1.2.2.1.1.1.1.1.3.4.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3"><apply id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑠</ci><cn id="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l1.m1.2.2.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">…</ci><apply id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.2">𝑠</ci><apply id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.2">𝑇</ci><ci id="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3"><times id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.2"></times><ci id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.3">𝑅</ci><apply id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.2">𝑠</ci><apply id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.1.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.2">𝑇</ci><ci id="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.1.3.3.3.1.1.1.3.3">𝑖</ci></apply></apply></apply></vector></apply></set><apply id="alg2.l1.m1.2.2.1.1.3.cmml" xref="alg2.l1.m1.2.2.1.1.3"><eq id="alg2.l1.m1.2.2.1.1.3.1.cmml" xref="alg2.l1.m1.2.2.1.1.3.1"></eq><ci id="alg2.l1.m1.2.2.1.1.3.2.cmml" xref="alg2.l1.m1.2.2.1.1.3.2">𝑖</ci><cn id="alg2.l1.m1.2.2.1.1.3.3.cmml" type="integer" xref="alg2.l1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m1.2.2.1.3.cmml" xref="alg2.l1.m1.2.2.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.2c">\mathcal{D}=\{\tau_{i}=(s_{0},\dots,s_{T_{i}},R(s_{T_{i}}))\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.2d">caligraphic_D = { italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R ( italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>; number of training iterations <math alttext="N^{\prime}" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><msup id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">N</mi><mo id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1">superscript</csymbol><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝑁</ci><ci id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">N^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_N start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>; batch size <math alttext="B^{\prime}" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><msup id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">B</mi><mo id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1">superscript</csymbol><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">𝐵</ci><ci id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">B^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>; policy learning rate <math alttext="\alpha" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><mi id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_α</annotation></semantics></math>; discriminator learning rate <math alttext="\beta" class="ltx_Math" display="inline" id="alg2.l1.m5.1"><semantics id="alg2.l1.m5.1a"><mi id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><ci id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m5.1d">italic_β</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>Initialize policy <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><msub id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">π</mi><mi id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝜋</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> and discriminator <math alttext="D_{\phi}:E\rightarrow(0,1)" class="ltx_Math" display="inline" id="alg2.l2.m2.2"><semantics id="alg2.l2.m2.2a"><mrow id="alg2.l2.m2.2.3" xref="alg2.l2.m2.2.3.cmml"><msub id="alg2.l2.m2.2.3.2" xref="alg2.l2.m2.2.3.2.cmml"><mi id="alg2.l2.m2.2.3.2.2" xref="alg2.l2.m2.2.3.2.2.cmml">D</mi><mi id="alg2.l2.m2.2.3.2.3" xref="alg2.l2.m2.2.3.2.3.cmml">ϕ</mi></msub><mo id="alg2.l2.m2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.l2.m2.2.3.1.cmml">:</mo><mrow id="alg2.l2.m2.2.3.3" xref="alg2.l2.m2.2.3.3.cmml"><mi id="alg2.l2.m2.2.3.3.2" xref="alg2.l2.m2.2.3.3.2.cmml">E</mi><mo id="alg2.l2.m2.2.3.3.1" stretchy="false" xref="alg2.l2.m2.2.3.3.1.cmml">→</mo><mrow id="alg2.l2.m2.2.3.3.3.2" xref="alg2.l2.m2.2.3.3.3.1.cmml"><mo id="alg2.l2.m2.2.3.3.3.2.1" stretchy="false" xref="alg2.l2.m2.2.3.3.3.1.cmml">(</mo><mn id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">0</mn><mo id="alg2.l2.m2.2.3.3.3.2.2" xref="alg2.l2.m2.2.3.3.3.1.cmml">,</mo><mn id="alg2.l2.m2.2.2" xref="alg2.l2.m2.2.2.cmml">1</mn><mo id="alg2.l2.m2.2.3.3.3.2.3" stretchy="false" xref="alg2.l2.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.2b"><apply id="alg2.l2.m2.2.3.cmml" xref="alg2.l2.m2.2.3"><ci id="alg2.l2.m2.2.3.1.cmml" xref="alg2.l2.m2.2.3.1">:</ci><apply id="alg2.l2.m2.2.3.2.cmml" xref="alg2.l2.m2.2.3.2"><csymbol cd="ambiguous" id="alg2.l2.m2.2.3.2.1.cmml" xref="alg2.l2.m2.2.3.2">subscript</csymbol><ci id="alg2.l2.m2.2.3.2.2.cmml" xref="alg2.l2.m2.2.3.2.2">𝐷</ci><ci id="alg2.l2.m2.2.3.2.3.cmml" xref="alg2.l2.m2.2.3.2.3">italic-ϕ</ci></apply><apply id="alg2.l2.m2.2.3.3.cmml" xref="alg2.l2.m2.2.3.3"><ci id="alg2.l2.m2.2.3.3.1.cmml" xref="alg2.l2.m2.2.3.3.1">→</ci><ci id="alg2.l2.m2.2.3.3.2.cmml" xref="alg2.l2.m2.2.3.3.2">𝐸</ci><interval closure="open" id="alg2.l2.m2.2.3.3.3.1.cmml" xref="alg2.l2.m2.2.3.3.3.2"><cn id="alg2.l2.m2.1.1.cmml" type="integer" xref="alg2.l2.m2.1.1">0</cn><cn id="alg2.l2.m2.2.2.cmml" type="integer" xref="alg2.l2.m2.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.2c">D_{\phi}:E\rightarrow(0,1)</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m2.2d">italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT : italic_E → ( 0 , 1 )</annotation></semantics></math> with random parameters <math alttext="\psi" class="ltx_Math" display="inline" id="alg2.l2.m3.1"><semantics id="alg2.l2.m3.1a"><mi id="alg2.l2.m3.1.1" xref="alg2.l2.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><ci id="alg2.l2.m3.1.1.cmml" xref="alg2.l2.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m3.1d">italic_ψ</annotation></semantics></math> and <math alttext="\phi" class="ltx_Math" display="inline" id="alg2.l2.m4.1"><semantics id="alg2.l2.m4.1a"><mi id="alg2.l2.m4.1.1" xref="alg2.l2.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m4.1b"><ci id="alg2.l2.m4.1.1.cmml" xref="alg2.l2.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m4.1d">italic_ϕ</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l3.2">for</span> <math alttext="n=1" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">n</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mn id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑛</ci><cn id="alg2.l3.m1.1.1.3.cmml" type="integer" xref="alg2.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">n=1</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_n = 1</annotation></semantics></math> to <math alttext="N^{\prime}" class="ltx_Math" display="inline" id="alg2.l3.m2.1"><semantics id="alg2.l3.m2.1a"><msup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2.cmml">N</mi><mo id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2">𝑁</ci><ci id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">N^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m2.1d">italic_N start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>     Initialize a batch of trajectories <math alttext="\mathcal{T}^{\prime}=\varnothing" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msup id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">𝒯</mi><mo id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">=</mo><mi id="alg2.l4.m1.1.1.3" mathvariant="normal" xref="alg2.l4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></eq><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">superscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝒯</ci><ci id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">′</ci></apply><emptyset id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{T}^{\prime}=\varnothing</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = ∅</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l5.2">for</span> <math alttext="j=1" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">j</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">=</mo><mn id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></eq><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑗</ci><cn id="alg2.l5.m1.1.1.3.cmml" type="integer" xref="alg2.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">j=1</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_j = 1</annotation></semantics></math> to <math alttext="B^{\prime}" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><msup id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">B</mi><mo id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">superscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝐵</ci><ci id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">B^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>         Sample a trajectory <math alttext="\tau_{j}\in\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msub id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">τ</mi><mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><in id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1"></in><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝜏</ci><ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">𝑗</ci></apply><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\tau_{j}\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_D</annotation></semantics></math> with probability <math alttext="P(\tau_{j})\propto R(s_{T_{j}})" class="ltx_Math" display="inline" id="alg2.l6.m2.2"><semantics id="alg2.l6.m2.2a"><mrow id="alg2.l6.m2.2.2" xref="alg2.l6.m2.2.2.cmml"><mrow id="alg2.l6.m2.1.1.1" xref="alg2.l6.m2.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.3" xref="alg2.l6.m2.1.1.1.3.cmml">P</mi><mo id="alg2.l6.m2.1.1.1.2" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l6.m2.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.1.1.cmml"><mo id="alg2.l6.m2.1.1.1.1.1.2" stretchy="false" xref="alg2.l6.m2.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l6.m2.1.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.1.1.1.2" xref="alg2.l6.m2.1.1.1.1.1.1.2.cmml">τ</mi><mi id="alg2.l6.m2.1.1.1.1.1.1.3" xref="alg2.l6.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg2.l6.m2.1.1.1.1.1.3" stretchy="false" xref="alg2.l6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l6.m2.2.2.3" xref="alg2.l6.m2.2.2.3.cmml">∝</mo><mrow id="alg2.l6.m2.2.2.2" xref="alg2.l6.m2.2.2.2.cmml"><mi id="alg2.l6.m2.2.2.2.3" xref="alg2.l6.m2.2.2.2.3.cmml">R</mi><mo id="alg2.l6.m2.2.2.2.2" xref="alg2.l6.m2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l6.m2.2.2.2.1.1" xref="alg2.l6.m2.2.2.2.1.1.1.cmml"><mo id="alg2.l6.m2.2.2.2.1.1.2" stretchy="false" xref="alg2.l6.m2.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l6.m2.2.2.2.1.1.1" xref="alg2.l6.m2.2.2.2.1.1.1.cmml"><mi id="alg2.l6.m2.2.2.2.1.1.1.2" xref="alg2.l6.m2.2.2.2.1.1.1.2.cmml">s</mi><msub id="alg2.l6.m2.2.2.2.1.1.1.3" xref="alg2.l6.m2.2.2.2.1.1.1.3.cmml"><mi id="alg2.l6.m2.2.2.2.1.1.1.3.2" xref="alg2.l6.m2.2.2.2.1.1.1.3.2.cmml">T</mi><mi id="alg2.l6.m2.2.2.2.1.1.1.3.3" xref="alg2.l6.m2.2.2.2.1.1.1.3.3.cmml">j</mi></msub></msub><mo id="alg2.l6.m2.2.2.2.1.1.3" stretchy="false" xref="alg2.l6.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.2b"><apply id="alg2.l6.m2.2.2.cmml" xref="alg2.l6.m2.2.2"><csymbol cd="latexml" id="alg2.l6.m2.2.2.3.cmml" xref="alg2.l6.m2.2.2.3">proportional-to</csymbol><apply id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1"><times id="alg2.l6.m2.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.2"></times><ci id="alg2.l6.m2.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.3">𝑃</ci><apply id="alg2.l6.m2.1.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.2">𝜏</ci><ci id="alg2.l6.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="alg2.l6.m2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2"><times id="alg2.l6.m2.2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2.2"></times><ci id="alg2.l6.m2.2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2.3">𝑅</ci><apply id="alg2.l6.m2.2.2.2.1.1.1.cmml" xref="alg2.l6.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.2.2.2.1.1.1.1.cmml" xref="alg2.l6.m2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l6.m2.2.2.2.1.1.1.2.cmml" xref="alg2.l6.m2.2.2.2.1.1.1.2">𝑠</ci><apply id="alg2.l6.m2.2.2.2.1.1.1.3.cmml" xref="alg2.l6.m2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m2.2.2.2.1.1.1.3.1.cmml" xref="alg2.l6.m2.2.2.2.1.1.1.3">subscript</csymbol><ci id="alg2.l6.m2.2.2.2.1.1.1.3.2.cmml" xref="alg2.l6.m2.2.2.2.1.1.1.3.2">𝑇</ci><ci id="alg2.l6.m2.2.2.2.1.1.1.3.3.cmml" xref="alg2.l6.m2.2.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.2c">P(\tau_{j})\propto R(s_{T_{j}})</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.2d">italic_P ( italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∝ italic_R ( italic_s start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> .

</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>         <math alttext="\mathcal{T}^{\prime}=\mathcal{T}^{\prime}\cup\{\tau_{j}\}" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msup id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">𝒯</mi><mo id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">=</mo><mrow id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml"><msup id="alg2.l7.m1.1.1.1.3" xref="alg2.l7.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.3.2.cmml">𝒯</mi><mo id="alg2.l7.m1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l7.m1.1.1.1.2" xref="alg2.l7.m1.1.1.1.2.cmml">∪</mo><mrow id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.2.cmml"><mo id="alg2.l7.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l7.m1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">τ</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg2.l7.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l7.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><eq id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"></eq><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">superscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝒯</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">′</ci></apply><apply id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"><union id="alg2.l7.m1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.2"></union><apply id="alg2.l7.m1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l7.m1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.3.2">𝒯</ci><ci id="alg2.l7.m1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.3.3">′</ci></apply><set id="alg2.l7.m1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1"><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2">𝜏</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3">𝑗</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\mathcal{T}^{\prime}=\mathcal{T}^{\prime}\cup\{\tau_{j}\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∪ { italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l8.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l8.3">for</span> <span class="ltx_text" id="alg2.l8.4" style="color:#0000FF;">//Sample from the rebalanced dataset</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>     Extract edge transitions <math alttext="\{(s,s^{\prime})\}" class="ltx_Math" display="inline" id="alg2.l9.m1.2"><semantics id="alg2.l9.m1.2a"><mrow id="alg2.l9.m1.2.2.1" xref="alg2.l9.m1.2.2.2.cmml"><mo id="alg2.l9.m1.2.2.1.2" stretchy="false" xref="alg2.l9.m1.2.2.2.cmml">{</mo><mrow id="alg2.l9.m1.2.2.1.1.1" xref="alg2.l9.m1.2.2.1.1.2.cmml"><mo id="alg2.l9.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l9.m1.2.2.1.1.2.cmml">(</mo><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">s</mi><mo id="alg2.l9.m1.2.2.1.1.1.3" xref="alg2.l9.m1.2.2.1.1.2.cmml">,</mo><msup id="alg2.l9.m1.2.2.1.1.1.1" xref="alg2.l9.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l9.m1.2.2.1.1.1.1.2" xref="alg2.l9.m1.2.2.1.1.1.1.2.cmml">s</mi><mo id="alg2.l9.m1.2.2.1.1.1.1.3" xref="alg2.l9.m1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l9.m1.2.2.1.1.1.4" stretchy="false" xref="alg2.l9.m1.2.2.1.1.2.cmml">)</mo></mrow><mo id="alg2.l9.m1.2.2.1.3" stretchy="false" xref="alg2.l9.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.2b"><set id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.1"><interval closure="open" id="alg2.l9.m1.2.2.1.1.2.cmml" xref="alg2.l9.m1.2.2.1.1.1"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑠</ci><apply id="alg2.l9.m1.2.2.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg2.l9.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.2">𝑠</ci><ci id="alg2.l9.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.1.1.1.1.3">′</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.2c">\{(s,s^{\prime})\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.2d">{ ( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) }</annotation></semantics></math> from <math alttext="\mathcal{T}^{\prime}" class="ltx_Math" display="inline" id="alg2.l9.m2.1"><semantics id="alg2.l9.m2.1a"><msup id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2.cmml">𝒯</mi><mo id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1">superscript</csymbol><ci id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2">𝒯</ci><ci id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\mathcal{T}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.1d">caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as a minibatch <math alttext="\overline{E}" class="ltx_Math" display="inline" id="alg2.l9.m3.1"><semantics id="alg2.l9.m3.1a"><mover accent="true" id="alg2.l9.m3.1.1" xref="alg2.l9.m3.1.1.cmml"><mi id="alg2.l9.m3.1.1.2" xref="alg2.l9.m3.1.1.2.cmml">E</mi><mo id="alg2.l9.m3.1.1.1" xref="alg2.l9.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.l9.m3.1b"><apply id="alg2.l9.m3.1.1.cmml" xref="alg2.l9.m3.1.1"><ci id="alg2.l9.m3.1.1.1.cmml" xref="alg2.l9.m3.1.1.1">¯</ci><ci id="alg2.l9.m3.1.1.2.cmml" xref="alg2.l9.m3.1.1.2">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m3.1c">\overline{E}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m3.1d">over¯ start_ARG italic_E end_ARG</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>     Compute <math alttext="\nabla_{\phi}L" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml"><mo id="alg2.l10.m1.1.1.1.2" xref="alg2.l10.m1.1.1.1.2.cmml">∇</mo><mi id="alg2.l10.m1.1.1.1.3" xref="alg2.l10.m1.1.1.1.3.cmml">ϕ</mi></msub><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><apply id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.2">∇</ci><ci id="alg2.l10.m1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.3">italic-ϕ</ci></apply><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\nabla_{\phi}L</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L</annotation></semantics></math> on <math alttext="\overline{E}" class="ltx_Math" display="inline" id="alg2.l10.m2.1"><semantics id="alg2.l10.m2.1a"><mover accent="true" id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mi id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml">E</mi><mo id="alg2.l10.m2.1.1.1" xref="alg2.l10.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><ci id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1.1">¯</ci><ci id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">\overline{E}</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m2.1d">over¯ start_ARG italic_E end_ARG</annotation></semantics></math>; update <math alttext="\phi\leftarrow\phi-\beta\nabla_{\phi}L" class="ltx_Math" display="inline" id="alg2.l10.m3.1"><semantics id="alg2.l10.m3.1a"><mrow id="alg2.l10.m3.1.1" xref="alg2.l10.m3.1.1.cmml"><mi id="alg2.l10.m3.1.1.2" xref="alg2.l10.m3.1.1.2.cmml">ϕ</mi><mo id="alg2.l10.m3.1.1.1" stretchy="false" xref="alg2.l10.m3.1.1.1.cmml">←</mo><mrow id="alg2.l10.m3.1.1.3" xref="alg2.l10.m3.1.1.3.cmml"><mi id="alg2.l10.m3.1.1.3.2" xref="alg2.l10.m3.1.1.3.2.cmml">ϕ</mi><mo id="alg2.l10.m3.1.1.3.1" xref="alg2.l10.m3.1.1.3.1.cmml">−</mo><mrow id="alg2.l10.m3.1.1.3.3" xref="alg2.l10.m3.1.1.3.3.cmml"><mi id="alg2.l10.m3.1.1.3.3.2" xref="alg2.l10.m3.1.1.3.3.2.cmml">β</mi><mo id="alg2.l10.m3.1.1.3.3.1" lspace="0.167em" xref="alg2.l10.m3.1.1.3.3.1.cmml">⁢</mo><mrow id="alg2.l10.m3.1.1.3.3.3" xref="alg2.l10.m3.1.1.3.3.3.cmml"><msub id="alg2.l10.m3.1.1.3.3.3.1" xref="alg2.l10.m3.1.1.3.3.3.1.cmml"><mo id="alg2.l10.m3.1.1.3.3.3.1.2" rspace="0.167em" xref="alg2.l10.m3.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg2.l10.m3.1.1.3.3.3.1.3" xref="alg2.l10.m3.1.1.3.3.3.1.3.cmml">ϕ</mi></msub><mi id="alg2.l10.m3.1.1.3.3.3.2" xref="alg2.l10.m3.1.1.3.3.3.2.cmml">L</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m3.1b"><apply id="alg2.l10.m3.1.1.cmml" xref="alg2.l10.m3.1.1"><ci id="alg2.l10.m3.1.1.1.cmml" xref="alg2.l10.m3.1.1.1">←</ci><ci id="alg2.l10.m3.1.1.2.cmml" xref="alg2.l10.m3.1.1.2">italic-ϕ</ci><apply id="alg2.l10.m3.1.1.3.cmml" xref="alg2.l10.m3.1.1.3"><minus id="alg2.l10.m3.1.1.3.1.cmml" xref="alg2.l10.m3.1.1.3.1"></minus><ci id="alg2.l10.m3.1.1.3.2.cmml" xref="alg2.l10.m3.1.1.3.2">italic-ϕ</ci><apply id="alg2.l10.m3.1.1.3.3.cmml" xref="alg2.l10.m3.1.1.3.3"><times id="alg2.l10.m3.1.1.3.3.1.cmml" xref="alg2.l10.m3.1.1.3.3.1"></times><ci id="alg2.l10.m3.1.1.3.3.2.cmml" xref="alg2.l10.m3.1.1.3.3.2">𝛽</ci><apply id="alg2.l10.m3.1.1.3.3.3.cmml" xref="alg2.l10.m3.1.1.3.3.3"><apply id="alg2.l10.m3.1.1.3.3.3.1.cmml" xref="alg2.l10.m3.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l10.m3.1.1.3.3.3.1.1.cmml" xref="alg2.l10.m3.1.1.3.3.3.1">subscript</csymbol><ci id="alg2.l10.m3.1.1.3.3.3.1.2.cmml" xref="alg2.l10.m3.1.1.3.3.3.1.2">∇</ci><ci id="alg2.l10.m3.1.1.3.3.3.1.3.cmml" xref="alg2.l10.m3.1.1.3.3.3.1.3">italic-ϕ</ci></apply><ci id="alg2.l10.m3.1.1.3.3.3.2.cmml" xref="alg2.l10.m3.1.1.3.3.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m3.1c">\phi\leftarrow\phi-\beta\nabla_{\phi}L</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m3.1d">italic_ϕ ← italic_ϕ - italic_β ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L</annotation></semantics></math>. <span class="ltx_text" id="alg2.l10.2" style="color:#0000FF;">// Update discriminator</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>     Compute <math alttext="\nabla_{\psi}L" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><msub id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml"><mo id="alg2.l11.m1.1.1.1.2" xref="alg2.l11.m1.1.1.1.2.cmml">∇</mo><mi id="alg2.l11.m1.1.1.1.3" xref="alg2.l11.m1.1.1.1.3.cmml">ψ</mi></msub><mi id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><apply id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.2">∇</ci><ci id="alg2.l11.m1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.3">𝜓</ci></apply><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\nabla_{\psi}L</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">∇ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT italic_L</annotation></semantics></math> on <math alttext="\overline{E}" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><mover accent="true" id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml">E</mi><mo id="alg2.l11.m2.1.1.1" xref="alg2.l11.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><ci id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1.1">¯</ci><ci id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">\overline{E}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">over¯ start_ARG italic_E end_ARG</annotation></semantics></math>; update <math alttext="\psi\leftarrow\psi-\alpha\nabla_{\psi}L" class="ltx_Math" display="inline" id="alg2.l11.m3.1"><semantics id="alg2.l11.m3.1a"><mrow id="alg2.l11.m3.1.1" xref="alg2.l11.m3.1.1.cmml"><mi id="alg2.l11.m3.1.1.2" xref="alg2.l11.m3.1.1.2.cmml">ψ</mi><mo id="alg2.l11.m3.1.1.1" stretchy="false" xref="alg2.l11.m3.1.1.1.cmml">←</mo><mrow id="alg2.l11.m3.1.1.3" xref="alg2.l11.m3.1.1.3.cmml"><mi id="alg2.l11.m3.1.1.3.2" xref="alg2.l11.m3.1.1.3.2.cmml">ψ</mi><mo id="alg2.l11.m3.1.1.3.1" xref="alg2.l11.m3.1.1.3.1.cmml">−</mo><mrow id="alg2.l11.m3.1.1.3.3" xref="alg2.l11.m3.1.1.3.3.cmml"><mi id="alg2.l11.m3.1.1.3.3.2" xref="alg2.l11.m3.1.1.3.3.2.cmml">α</mi><mo id="alg2.l11.m3.1.1.3.3.1" lspace="0.167em" xref="alg2.l11.m3.1.1.3.3.1.cmml">⁢</mo><mrow id="alg2.l11.m3.1.1.3.3.3" xref="alg2.l11.m3.1.1.3.3.3.cmml"><msub id="alg2.l11.m3.1.1.3.3.3.1" xref="alg2.l11.m3.1.1.3.3.3.1.cmml"><mo id="alg2.l11.m3.1.1.3.3.3.1.2" rspace="0.167em" xref="alg2.l11.m3.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg2.l11.m3.1.1.3.3.3.1.3" xref="alg2.l11.m3.1.1.3.3.3.1.3.cmml">ψ</mi></msub><mi id="alg2.l11.m3.1.1.3.3.3.2" xref="alg2.l11.m3.1.1.3.3.3.2.cmml">L</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m3.1b"><apply id="alg2.l11.m3.1.1.cmml" xref="alg2.l11.m3.1.1"><ci id="alg2.l11.m3.1.1.1.cmml" xref="alg2.l11.m3.1.1.1">←</ci><ci id="alg2.l11.m3.1.1.2.cmml" xref="alg2.l11.m3.1.1.2">𝜓</ci><apply id="alg2.l11.m3.1.1.3.cmml" xref="alg2.l11.m3.1.1.3"><minus id="alg2.l11.m3.1.1.3.1.cmml" xref="alg2.l11.m3.1.1.3.1"></minus><ci id="alg2.l11.m3.1.1.3.2.cmml" xref="alg2.l11.m3.1.1.3.2">𝜓</ci><apply id="alg2.l11.m3.1.1.3.3.cmml" xref="alg2.l11.m3.1.1.3.3"><times id="alg2.l11.m3.1.1.3.3.1.cmml" xref="alg2.l11.m3.1.1.3.3.1"></times><ci id="alg2.l11.m3.1.1.3.3.2.cmml" xref="alg2.l11.m3.1.1.3.3.2">𝛼</ci><apply id="alg2.l11.m3.1.1.3.3.3.cmml" xref="alg2.l11.m3.1.1.3.3.3"><apply id="alg2.l11.m3.1.1.3.3.3.1.cmml" xref="alg2.l11.m3.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l11.m3.1.1.3.3.3.1.1.cmml" xref="alg2.l11.m3.1.1.3.3.3.1">subscript</csymbol><ci id="alg2.l11.m3.1.1.3.3.3.1.2.cmml" xref="alg2.l11.m3.1.1.3.3.3.1.2">∇</ci><ci id="alg2.l11.m3.1.1.3.3.3.1.3.cmml" xref="alg2.l11.m3.1.1.3.3.3.1.3">𝜓</ci></apply><ci id="alg2.l11.m3.1.1.3.3.3.2.cmml" xref="alg2.l11.m3.1.1.3.3.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m3.1c">\psi\leftarrow\psi-\alpha\nabla_{\psi}L</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m3.1d">italic_ψ ← italic_ψ - italic_α ∇ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT italic_L</annotation></semantics></math> or apply a policy gradient method. <span class="ltx_text" id="alg2.l11.2" style="color:#0000FF;">// Update policy</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l12.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l12.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span>Extract the edge reward function <math alttext="R_{E}" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><msub id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">R</mi><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">𝑅</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">R_{E}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> according to Equation <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.E5" title="In 3.1 Edge rewards extraction via IRL ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">5</span></a>.

</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l14.2">Output:</span> Edge reward function <math alttext="R_{E}" class="ltx_Math" display="inline" id="alg2.l14.m1.1"><semantics id="alg2.l14.m1.1a"><msub id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><mi id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml">R</mi><mi id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2">𝑅</ci><ci id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">R_{E}</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.1d">italic_R start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math>; imitation policy <math alttext="\pi_{\psi}" class="ltx_Math" display="inline" id="alg2.l14.m2.1"><semantics id="alg2.l14.m2.1a"><msub id="alg2.l14.m2.1.1" xref="alg2.l14.m2.1.1.cmml"><mi id="alg2.l14.m2.1.1.2" xref="alg2.l14.m2.1.1.2.cmml">π</mi><mi id="alg2.l14.m2.1.1.3" xref="alg2.l14.m2.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><apply id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.1.cmml" xref="alg2.l14.m2.1.1">subscript</csymbol><ci id="alg2.l14.m2.1.1.2.cmml" xref="alg2.l14.m2.1.1.2">𝜋</ci><ci id="alg2.l14.m2.1.1.3.cmml" xref="alg2.l14.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\pi_{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m2.1d">italic_π start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
</div>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Related works</h2>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Generative Flow Networks (GFlowNets).</h4>
<div class="ltx_para" id="A2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px1.p1.1">GFlowNets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib2" title="">2</a>]</cite> are a class of generative models designed to sample compositional objects from an unnormalized reward distribution via sequential action selection. They have been theoretically linked to entropy-regularized reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib45" title="">45</a>]</cite> and variational inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib47" title="">47</a>]</cite>, offering a principled framework for distribution matching.
Recent research has focused on improving GFlowNet training by proposing new balance conditions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib48" title="">48</a>]</cite>, enhancing credit assignment through intermediate rewards <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib9" title="">9</a>]</cite>, designing backward policies for improved sampling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib50" title="">50</a>]</cite>, refining sampling and resampling strategies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib53" title="">53</a>]</cite>, and exploring alternative training objectives <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib55" title="">55</a>]</cite>.
Extensions to the GFlowNet framework have expanded its applicability to stochastic dynamics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib56" title="">56</a>]</cite>, continuous action spaces <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib57" title="">57</a>]</cite>, non-acyclic transitions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib58" title="">58</a>]</cite>, and implicit reward feedback <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib59" title="">59</a>]</cite>. These advances have broadened the scope of GFlowNets, enabling impactful applications in molecule design <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib62" title="">62</a>]</cite>, biological sequence generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib63" title="">63</a>]</cite>, combinatorial optimization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib65" title="">65</a>]</cite>, causal inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib66" title="">66</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib67" title="">67</a>]</cite>, recommendation systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib68" title="">68</a>]</cite>, and fine-tuning of large language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib69" title="">69</a>]</cite> and diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib70" title="">70</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Inverse Reinforcement Learning (IRL).</h4>
<div class="ltx_para" id="A2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px2.p1.1">Inverse reinforcement learning (IRL) aims to recover a reward function that explains observed expert behavior in a Markov decision process <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib71" title="">71</a>]</cite>.
Among its variants, maximum causal entropy IRL is particularly noteworthy, as it addresses reward ambiguity by formulating the objective as finding a policy that maximizes entropy while matching the observed expert behavior <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib26" title="">26</a>]</cite>. Building on this framework, Generative Adversarial Imitation Learning (GAIL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib28" title="">28</a>]</cite> reinterprets imitation as a distribution matching problem via adversarial training, where a discriminator distinguishes expert from policy-generated trajectories, and its output serves as a learned reward for policy training. GAIL eliminates the need to explicitly solve the inner IRL loop, significantly improving scalability, and has inspired a broad class of Adversarial Imitation Learning (AIL) methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib72" title="">72</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib73" title="">73</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib74" title="">74</a>]</cite>. This line of work has since been extended in various directions, including efforts to improve reward generalization and robustness <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib75" title="">75</a>, <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib76" title="">76</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experimental details</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Hypergrid</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">The Hypergrid task is a synthetic benchmark introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite> to evaluate the exploration and generalization capabilities of GFlowNet algorithms. It presents a significant challenge due to its high-dimensional, sparse reward landscape.</p>
</div>
<div class="ltx_para" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.5">The environment consists of a <math alttext="D" class="ltx_Math" display="inline" id="A3.SS1.p2.1.m1.1"><semantics id="A3.SS1.p2.1.m1.1a"><mi id="A3.SS1.p2.1.m1.1.1" xref="A3.SS1.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.1b"><ci id="A3.SS1.p2.1.m1.1.1.cmml" xref="A3.SS1.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.1.m1.1d">italic_D</annotation></semantics></math>-dimensional hypercubic grid with side length <math alttext="H" class="ltx_Math" display="inline" id="A3.SS1.p2.2.m2.1"><semantics id="A3.SS1.p2.2.m2.1a"><mi id="A3.SS1.p2.2.m2.1.1" xref="A3.SS1.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.1b"><ci id="A3.SS1.p2.2.m2.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.2.m2.1d">italic_H</annotation></semantics></math>, defining a discrete state space of size <math alttext="H^{D}" class="ltx_Math" display="inline" id="A3.SS1.p2.3.m3.1"><semantics id="A3.SS1.p2.3.m3.1a"><msup id="A3.SS1.p2.3.m3.1.1" xref="A3.SS1.p2.3.m3.1.1.cmml"><mi id="A3.SS1.p2.3.m3.1.1.2" xref="A3.SS1.p2.3.m3.1.1.2.cmml">H</mi><mi id="A3.SS1.p2.3.m3.1.1.3" xref="A3.SS1.p2.3.m3.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><apply id="A3.SS1.p2.3.m3.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="A3.SS1.p2.3.m3.1.1.2.cmml" xref="A3.SS1.p2.3.m3.1.1.2">𝐻</ci><ci id="A3.SS1.p2.3.m3.1.1.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">H^{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.3.m3.1d">italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. Each state corresponds to a coordinate <math alttext="x=(x_{1},\ldots,x_{D})\in\{0,\ldots,H-1\}^{D}" class="ltx_Math" display="inline" id="A3.SS1.p2.4.m4.6"><semantics id="A3.SS1.p2.4.m4.6a"><mrow id="A3.SS1.p2.4.m4.6.6" xref="A3.SS1.p2.4.m4.6.6.cmml"><mi id="A3.SS1.p2.4.m4.6.6.5" xref="A3.SS1.p2.4.m4.6.6.5.cmml">x</mi><mo id="A3.SS1.p2.4.m4.6.6.6" xref="A3.SS1.p2.4.m4.6.6.6.cmml">=</mo><mrow id="A3.SS1.p2.4.m4.5.5.2.2" xref="A3.SS1.p2.4.m4.5.5.2.3.cmml"><mo id="A3.SS1.p2.4.m4.5.5.2.2.3" stretchy="false" xref="A3.SS1.p2.4.m4.5.5.2.3.cmml">(</mo><msub id="A3.SS1.p2.4.m4.4.4.1.1.1" xref="A3.SS1.p2.4.m4.4.4.1.1.1.cmml"><mi id="A3.SS1.p2.4.m4.4.4.1.1.1.2" xref="A3.SS1.p2.4.m4.4.4.1.1.1.2.cmml">x</mi><mn id="A3.SS1.p2.4.m4.4.4.1.1.1.3" xref="A3.SS1.p2.4.m4.4.4.1.1.1.3.cmml">1</mn></msub><mo id="A3.SS1.p2.4.m4.5.5.2.2.4" xref="A3.SS1.p2.4.m4.5.5.2.3.cmml">,</mo><mi id="A3.SS1.p2.4.m4.1.1" mathvariant="normal" xref="A3.SS1.p2.4.m4.1.1.cmml">…</mi><mo id="A3.SS1.p2.4.m4.5.5.2.2.5" xref="A3.SS1.p2.4.m4.5.5.2.3.cmml">,</mo><msub id="A3.SS1.p2.4.m4.5.5.2.2.2" xref="A3.SS1.p2.4.m4.5.5.2.2.2.cmml"><mi id="A3.SS1.p2.4.m4.5.5.2.2.2.2" xref="A3.SS1.p2.4.m4.5.5.2.2.2.2.cmml">x</mi><mi id="A3.SS1.p2.4.m4.5.5.2.2.2.3" xref="A3.SS1.p2.4.m4.5.5.2.2.2.3.cmml">D</mi></msub><mo id="A3.SS1.p2.4.m4.5.5.2.2.6" stretchy="false" xref="A3.SS1.p2.4.m4.5.5.2.3.cmml">)</mo></mrow><mo id="A3.SS1.p2.4.m4.6.6.7" xref="A3.SS1.p2.4.m4.6.6.7.cmml">∈</mo><msup id="A3.SS1.p2.4.m4.6.6.3" xref="A3.SS1.p2.4.m4.6.6.3.cmml"><mrow id="A3.SS1.p2.4.m4.6.6.3.1.1" xref="A3.SS1.p2.4.m4.6.6.3.1.2.cmml"><mo id="A3.SS1.p2.4.m4.6.6.3.1.1.2" stretchy="false" xref="A3.SS1.p2.4.m4.6.6.3.1.2.cmml">{</mo><mn id="A3.SS1.p2.4.m4.2.2" xref="A3.SS1.p2.4.m4.2.2.cmml">0</mn><mo id="A3.SS1.p2.4.m4.6.6.3.1.1.3" xref="A3.SS1.p2.4.m4.6.6.3.1.2.cmml">,</mo><mi id="A3.SS1.p2.4.m4.3.3" mathvariant="normal" xref="A3.SS1.p2.4.m4.3.3.cmml">…</mi><mo id="A3.SS1.p2.4.m4.6.6.3.1.1.4" xref="A3.SS1.p2.4.m4.6.6.3.1.2.cmml">,</mo><mrow id="A3.SS1.p2.4.m4.6.6.3.1.1.1" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.cmml"><mi id="A3.SS1.p2.4.m4.6.6.3.1.1.1.2" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.2.cmml">H</mi><mo id="A3.SS1.p2.4.m4.6.6.3.1.1.1.1" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.1.cmml">−</mo><mn id="A3.SS1.p2.4.m4.6.6.3.1.1.1.3" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.3.cmml">1</mn></mrow><mo id="A3.SS1.p2.4.m4.6.6.3.1.1.5" stretchy="false" xref="A3.SS1.p2.4.m4.6.6.3.1.2.cmml">}</mo></mrow><mi id="A3.SS1.p2.4.m4.6.6.3.3" xref="A3.SS1.p2.4.m4.6.6.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.4.m4.6b"><apply id="A3.SS1.p2.4.m4.6.6.cmml" xref="A3.SS1.p2.4.m4.6.6"><and id="A3.SS1.p2.4.m4.6.6a.cmml" xref="A3.SS1.p2.4.m4.6.6"></and><apply id="A3.SS1.p2.4.m4.6.6b.cmml" xref="A3.SS1.p2.4.m4.6.6"><eq id="A3.SS1.p2.4.m4.6.6.6.cmml" xref="A3.SS1.p2.4.m4.6.6.6"></eq><ci id="A3.SS1.p2.4.m4.6.6.5.cmml" xref="A3.SS1.p2.4.m4.6.6.5">𝑥</ci><vector id="A3.SS1.p2.4.m4.5.5.2.3.cmml" xref="A3.SS1.p2.4.m4.5.5.2.2"><apply id="A3.SS1.p2.4.m4.4.4.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.4.4.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1">subscript</csymbol><ci id="A3.SS1.p2.4.m4.4.4.1.1.1.2.cmml" xref="A3.SS1.p2.4.m4.4.4.1.1.1.2">𝑥</ci><cn id="A3.SS1.p2.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="A3.SS1.p2.4.m4.4.4.1.1.1.3">1</cn></apply><ci id="A3.SS1.p2.4.m4.1.1.cmml" xref="A3.SS1.p2.4.m4.1.1">…</ci><apply id="A3.SS1.p2.4.m4.5.5.2.2.2.cmml" xref="A3.SS1.p2.4.m4.5.5.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.5.5.2.2.2.1.cmml" xref="A3.SS1.p2.4.m4.5.5.2.2.2">subscript</csymbol><ci id="A3.SS1.p2.4.m4.5.5.2.2.2.2.cmml" xref="A3.SS1.p2.4.m4.5.5.2.2.2.2">𝑥</ci><ci id="A3.SS1.p2.4.m4.5.5.2.2.2.3.cmml" xref="A3.SS1.p2.4.m4.5.5.2.2.2.3">𝐷</ci></apply></vector></apply><apply id="A3.SS1.p2.4.m4.6.6c.cmml" xref="A3.SS1.p2.4.m4.6.6"><in id="A3.SS1.p2.4.m4.6.6.7.cmml" xref="A3.SS1.p2.4.m4.6.6.7"></in><share href="https://arxiv.org/html/2505.20110v1#A3.SS1.p2.4.m4.5.5.2.cmml" id="A3.SS1.p2.4.m4.6.6d.cmml" xref="A3.SS1.p2.4.m4.6.6"></share><apply id="A3.SS1.p2.4.m4.6.6.3.cmml" xref="A3.SS1.p2.4.m4.6.6.3"><csymbol cd="ambiguous" id="A3.SS1.p2.4.m4.6.6.3.2.cmml" xref="A3.SS1.p2.4.m4.6.6.3">superscript</csymbol><set id="A3.SS1.p2.4.m4.6.6.3.1.2.cmml" xref="A3.SS1.p2.4.m4.6.6.3.1.1"><cn id="A3.SS1.p2.4.m4.2.2.cmml" type="integer" xref="A3.SS1.p2.4.m4.2.2">0</cn><ci id="A3.SS1.p2.4.m4.3.3.cmml" xref="A3.SS1.p2.4.m4.3.3">…</ci><apply id="A3.SS1.p2.4.m4.6.6.3.1.1.1.cmml" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1"><minus id="A3.SS1.p2.4.m4.6.6.3.1.1.1.1.cmml" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.1"></minus><ci id="A3.SS1.p2.4.m4.6.6.3.1.1.1.2.cmml" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.2">𝐻</ci><cn id="A3.SS1.p2.4.m4.6.6.3.1.1.1.3.cmml" type="integer" xref="A3.SS1.p2.4.m4.6.6.3.1.1.1.3">1</cn></apply></set><ci id="A3.SS1.p2.4.m4.6.6.3.3.cmml" xref="A3.SS1.p2.4.m4.6.6.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.4.m4.6c">x=(x_{1},\ldots,x_{D})\in\{0,\ldots,H-1\}^{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.4.m4.6d">italic_x = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT ) ∈ { 0 , … , italic_H - 1 } start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. The agent starts at the origin <math alttext="x=(0,\ldots,0)" class="ltx_Math" display="inline" id="A3.SS1.p2.5.m5.3"><semantics id="A3.SS1.p2.5.m5.3a"><mrow id="A3.SS1.p2.5.m5.3.4" xref="A3.SS1.p2.5.m5.3.4.cmml"><mi id="A3.SS1.p2.5.m5.3.4.2" xref="A3.SS1.p2.5.m5.3.4.2.cmml">x</mi><mo id="A3.SS1.p2.5.m5.3.4.1" xref="A3.SS1.p2.5.m5.3.4.1.cmml">=</mo><mrow id="A3.SS1.p2.5.m5.3.4.3.2" xref="A3.SS1.p2.5.m5.3.4.3.1.cmml"><mo id="A3.SS1.p2.5.m5.3.4.3.2.1" stretchy="false" xref="A3.SS1.p2.5.m5.3.4.3.1.cmml">(</mo><mn id="A3.SS1.p2.5.m5.1.1" xref="A3.SS1.p2.5.m5.1.1.cmml">0</mn><mo id="A3.SS1.p2.5.m5.3.4.3.2.2" xref="A3.SS1.p2.5.m5.3.4.3.1.cmml">,</mo><mi id="A3.SS1.p2.5.m5.2.2" mathvariant="normal" xref="A3.SS1.p2.5.m5.2.2.cmml">…</mi><mo id="A3.SS1.p2.5.m5.3.4.3.2.3" xref="A3.SS1.p2.5.m5.3.4.3.1.cmml">,</mo><mn id="A3.SS1.p2.5.m5.3.3" xref="A3.SS1.p2.5.m5.3.3.cmml">0</mn><mo id="A3.SS1.p2.5.m5.3.4.3.2.4" stretchy="false" xref="A3.SS1.p2.5.m5.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.5.m5.3b"><apply id="A3.SS1.p2.5.m5.3.4.cmml" xref="A3.SS1.p2.5.m5.3.4"><eq id="A3.SS1.p2.5.m5.3.4.1.cmml" xref="A3.SS1.p2.5.m5.3.4.1"></eq><ci id="A3.SS1.p2.5.m5.3.4.2.cmml" xref="A3.SS1.p2.5.m5.3.4.2">𝑥</ci><vector id="A3.SS1.p2.5.m5.3.4.3.1.cmml" xref="A3.SS1.p2.5.m5.3.4.3.2"><cn id="A3.SS1.p2.5.m5.1.1.cmml" type="integer" xref="A3.SS1.p2.5.m5.1.1">0</cn><ci id="A3.SS1.p2.5.m5.2.2.cmml" xref="A3.SS1.p2.5.m5.2.2">…</ci><cn id="A3.SS1.p2.5.m5.3.3.cmml" type="integer" xref="A3.SS1.p2.5.m5.3.3">0</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.5.m5.3c">x=(0,\ldots,0)</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.5.m5.3d">italic_x = ( 0 , … , 0 )</annotation></semantics></math> and can increment any individual coordinate by one at each step. A trajectory terminates when a special stop action is taken, and the reward is assigned based on the final state.</p>
</div>
<div class="ltx_para" id="A3.SS1.p3">
<p class="ltx_p" id="A3.SS1.p3.1">The reward function is designed to produce multiple sharp reward modes near the corners of the hypercube. Formally, the reward at a terminal state <math alttext="x" class="ltx_Math" display="inline" id="A3.SS1.p3.1.m1.1"><semantics id="A3.SS1.p3.1.m1.1a"><mi id="A3.SS1.p3.1.m1.1.1" xref="A3.SS1.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.1.m1.1b"><ci id="A3.SS1.p3.1.m1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.1.m1.1d">italic_x</annotation></semantics></math> is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R(x)=R_{0}+R_{1}\prod_{d=1}^{D}\mathbb{I}\left(\left|\frac{x_{d}}{H}-0.5\right%
|&gt;0.25\right)+R_{2}\prod_{d=1}^{D}\mathbb{I}\left(0.3&lt;\left|\frac{x_{d}}{H}-0.%
5\right|&lt;0.4\right)," class="ltx_Math" display="block" id="A3.Ex2.m1.2"><semantics id="A3.Ex2.m1.2a"><mrow id="A3.Ex2.m1.2.2.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1.4" xref="A3.Ex2.m1.2.2.1.1.4.cmml"><mi id="A3.Ex2.m1.2.2.1.1.4.2" xref="A3.Ex2.m1.2.2.1.1.4.2.cmml">R</mi><mo id="A3.Ex2.m1.2.2.1.1.4.1" xref="A3.Ex2.m1.2.2.1.1.4.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.4.3.2" xref="A3.Ex2.m1.2.2.1.1.4.cmml"><mo id="A3.Ex2.m1.2.2.1.1.4.3.2.1" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.4.cmml">(</mo><mi id="A3.Ex2.m1.1.1" xref="A3.Ex2.m1.1.1.cmml">x</mi><mo id="A3.Ex2.m1.2.2.1.1.4.3.2.2" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.4.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.4" xref="A3.Ex2.m1.2.2.1.1.2.4.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.4.2" xref="A3.Ex2.m1.2.2.1.1.2.4.2.cmml">R</mi><mn id="A3.Ex2.m1.2.2.1.1.2.4.3" xref="A3.Ex2.m1.2.2.1.1.2.4.3.cmml">0</mn></msub><mo id="A3.Ex2.m1.2.2.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.2.3.cmml">+</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.1.1.3.2.cmml">R</mi><mn id="A3.Ex2.m1.2.2.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A3.Ex2.m1.2.2.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.2" movablelimits="false" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">d</mi><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.3.cmml">D</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml">𝕀</mi><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mfrac id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">d</mi></msub><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">H</mi></mfrac><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0.5</mn></mrow><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">&gt;</mo><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">0.25</mn></mrow><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.2.3a" xref="A3.Ex2.m1.2.2.1.1.2.3.cmml">+</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.2.2.3.2.cmml">R</mi><mn id="A3.Ex2.m1.2.2.1.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.2.2.3.3.cmml">2</mn></msub><mo id="A3.Ex2.m1.2.2.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.2.2.1.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.2" movablelimits="false" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.2.cmml">∏</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.2.cmml">d</mi><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.3.cmml">D</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.3.cmml">𝕀</mi><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml">0.3</mn><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.4" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.4.cmml">&lt;</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mfrac id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">d</mi></msub><mi id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">H</mi></mfrac><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">0.5</mn></mrow><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.5" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.5.cmml">&lt;</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.6" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.6.cmml">0.4</mn></mrow><mo id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.2" xref="A3.Ex2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.2b"><apply id="A3.Ex2.m1.2.2.1.1.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3"></eq><apply id="A3.Ex2.m1.2.2.1.1.4.cmml" xref="A3.Ex2.m1.2.2.1.1.4"><times id="A3.Ex2.m1.2.2.1.1.4.1.cmml" xref="A3.Ex2.m1.2.2.1.1.4.1"></times><ci id="A3.Ex2.m1.2.2.1.1.4.2.cmml" xref="A3.Ex2.m1.2.2.1.1.4.2">𝑅</ci><ci id="A3.Ex2.m1.1.1.cmml" xref="A3.Ex2.m1.1.1">𝑥</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2"><plus id="A3.Ex2.m1.2.2.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.3"></plus><apply id="A3.Ex2.m1.2.2.1.1.2.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.4.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.4">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.4.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.4.2">𝑅</ci><cn id="A3.Ex2.m1.2.2.1.1.2.4.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.2.4.3">0</cn></apply><apply id="A3.Ex2.m1.2.2.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.3.2">𝑅</ci><cn id="A3.Ex2.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.1.1.3.3">1</cn></apply><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1"><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.2">product</csymbol><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.2">𝑑</ci><cn id="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.2.3">𝐷</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2"></times><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3">𝕀</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1"><gt id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2"></gt><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><abs id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2"><divide id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2"></divide><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑑</ci></apply><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝐻</ci></apply><cn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="float" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">0.5</cn></apply></apply><cn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="float" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3">0.25</cn></apply></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><times id="A3.Ex2.m1.2.2.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2"></times><apply id="A3.Ex2.m1.2.2.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3.2">𝑅</ci><cn id="A3.Ex2.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.2.2.3.3">2</cn></apply><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1"><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.2">product</csymbol><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.2">𝑑</ci><cn id="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.2.3">𝐷</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1"><times id="A3.Ex2.m1.2.2.1.1.2.2.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.2"></times><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.3">𝕀</ci><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1"><and id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1a.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1"></and><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1b.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1"><lt id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.4"></lt><cn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml" type="float" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.3">0.3</cn><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1"><abs id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2"></abs><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1"><minus id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2"><divide id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2"></divide><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑑</ci></apply><ci id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.3">𝐻</ci></apply><cn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="float" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3">0.5</cn></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1c.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1"><lt id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.5.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.5"></lt><share href="https://arxiv.org/html/2505.20110v1#A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml" id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1d.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1"></share><cn id="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.6.cmml" type="float" xref="A3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.1.6">0.4</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.2c">R(x)=R_{0}+R_{1}\prod_{d=1}^{D}\mathbb{I}\left(\left|\frac{x_{d}}{H}-0.5\right%
|&gt;0.25\right)+R_{2}\prod_{d=1}^{D}\mathbb{I}\left(0.3&lt;\left|\frac{x_{d}}{H}-0.%
5\right|&lt;0.4\right),</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.2d">italic_R ( italic_x ) = italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∏ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT blackboard_I ( | divide start_ARG italic_x start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG start_ARG italic_H end_ARG - 0.5 | &gt; 0.25 ) + italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∏ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT blackboard_I ( 0.3 &lt; | divide start_ARG italic_x start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG start_ARG italic_H end_ARG - 0.5 | &lt; 0.4 ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.p3.6">where <math alttext="R_{0}&lt;R_{1}\ll R_{2}" class="ltx_Math" display="inline" id="A3.SS1.p3.2.m1.1"><semantics id="A3.SS1.p3.2.m1.1a"><mrow id="A3.SS1.p3.2.m1.1.1" xref="A3.SS1.p3.2.m1.1.1.cmml"><msub id="A3.SS1.p3.2.m1.1.1.2" xref="A3.SS1.p3.2.m1.1.1.2.cmml"><mi id="A3.SS1.p3.2.m1.1.1.2.2" xref="A3.SS1.p3.2.m1.1.1.2.2.cmml">R</mi><mn id="A3.SS1.p3.2.m1.1.1.2.3" xref="A3.SS1.p3.2.m1.1.1.2.3.cmml">0</mn></msub><mo id="A3.SS1.p3.2.m1.1.1.3" xref="A3.SS1.p3.2.m1.1.1.3.cmml">&lt;</mo><msub id="A3.SS1.p3.2.m1.1.1.4" xref="A3.SS1.p3.2.m1.1.1.4.cmml"><mi id="A3.SS1.p3.2.m1.1.1.4.2" xref="A3.SS1.p3.2.m1.1.1.4.2.cmml">R</mi><mn id="A3.SS1.p3.2.m1.1.1.4.3" xref="A3.SS1.p3.2.m1.1.1.4.3.cmml">1</mn></msub><mo id="A3.SS1.p3.2.m1.1.1.5" xref="A3.SS1.p3.2.m1.1.1.5.cmml">≪</mo><msub id="A3.SS1.p3.2.m1.1.1.6" xref="A3.SS1.p3.2.m1.1.1.6.cmml"><mi id="A3.SS1.p3.2.m1.1.1.6.2" xref="A3.SS1.p3.2.m1.1.1.6.2.cmml">R</mi><mn id="A3.SS1.p3.2.m1.1.1.6.3" xref="A3.SS1.p3.2.m1.1.1.6.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.2.m1.1b"><apply id="A3.SS1.p3.2.m1.1.1.cmml" xref="A3.SS1.p3.2.m1.1.1"><and id="A3.SS1.p3.2.m1.1.1a.cmml" xref="A3.SS1.p3.2.m1.1.1"></and><apply id="A3.SS1.p3.2.m1.1.1b.cmml" xref="A3.SS1.p3.2.m1.1.1"><lt id="A3.SS1.p3.2.m1.1.1.3.cmml" xref="A3.SS1.p3.2.m1.1.1.3"></lt><apply id="A3.SS1.p3.2.m1.1.1.2.cmml" xref="A3.SS1.p3.2.m1.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m1.1.1.2.1.cmml" xref="A3.SS1.p3.2.m1.1.1.2">subscript</csymbol><ci id="A3.SS1.p3.2.m1.1.1.2.2.cmml" xref="A3.SS1.p3.2.m1.1.1.2.2">𝑅</ci><cn id="A3.SS1.p3.2.m1.1.1.2.3.cmml" type="integer" xref="A3.SS1.p3.2.m1.1.1.2.3">0</cn></apply><apply id="A3.SS1.p3.2.m1.1.1.4.cmml" xref="A3.SS1.p3.2.m1.1.1.4"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m1.1.1.4.1.cmml" xref="A3.SS1.p3.2.m1.1.1.4">subscript</csymbol><ci id="A3.SS1.p3.2.m1.1.1.4.2.cmml" xref="A3.SS1.p3.2.m1.1.1.4.2">𝑅</ci><cn id="A3.SS1.p3.2.m1.1.1.4.3.cmml" type="integer" xref="A3.SS1.p3.2.m1.1.1.4.3">1</cn></apply></apply><apply id="A3.SS1.p3.2.m1.1.1c.cmml" xref="A3.SS1.p3.2.m1.1.1"><csymbol cd="latexml" id="A3.SS1.p3.2.m1.1.1.5.cmml" xref="A3.SS1.p3.2.m1.1.1.5">much-less-than</csymbol><share href="https://arxiv.org/html/2505.20110v1#A3.SS1.p3.2.m1.1.1.4.cmml" id="A3.SS1.p3.2.m1.1.1d.cmml" xref="A3.SS1.p3.2.m1.1.1"></share><apply id="A3.SS1.p3.2.m1.1.1.6.cmml" xref="A3.SS1.p3.2.m1.1.1.6"><csymbol cd="ambiguous" id="A3.SS1.p3.2.m1.1.1.6.1.cmml" xref="A3.SS1.p3.2.m1.1.1.6">subscript</csymbol><ci id="A3.SS1.p3.2.m1.1.1.6.2.cmml" xref="A3.SS1.p3.2.m1.1.1.6.2">𝑅</ci><cn id="A3.SS1.p3.2.m1.1.1.6.3.cmml" type="integer" xref="A3.SS1.p3.2.m1.1.1.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.2.m1.1c">R_{0}&lt;R_{1}\ll R_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.2.m1.1d">italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT &lt; italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≪ italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbb{I}(\cdot)" class="ltx_Math" display="inline" id="A3.SS1.p3.3.m2.1"><semantics id="A3.SS1.p3.3.m2.1a"><mrow id="A3.SS1.p3.3.m2.1.2" xref="A3.SS1.p3.3.m2.1.2.cmml"><mi id="A3.SS1.p3.3.m2.1.2.2" xref="A3.SS1.p3.3.m2.1.2.2.cmml">𝕀</mi><mo id="A3.SS1.p3.3.m2.1.2.1" xref="A3.SS1.p3.3.m2.1.2.1.cmml">⁢</mo><mrow id="A3.SS1.p3.3.m2.1.2.3.2" xref="A3.SS1.p3.3.m2.1.2.cmml"><mo id="A3.SS1.p3.3.m2.1.2.3.2.1" stretchy="false" xref="A3.SS1.p3.3.m2.1.2.cmml">(</mo><mo id="A3.SS1.p3.3.m2.1.1" lspace="0em" rspace="0em" xref="A3.SS1.p3.3.m2.1.1.cmml">⋅</mo><mo id="A3.SS1.p3.3.m2.1.2.3.2.2" stretchy="false" xref="A3.SS1.p3.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.3.m2.1b"><apply id="A3.SS1.p3.3.m2.1.2.cmml" xref="A3.SS1.p3.3.m2.1.2"><times id="A3.SS1.p3.3.m2.1.2.1.cmml" xref="A3.SS1.p3.3.m2.1.2.1"></times><ci id="A3.SS1.p3.3.m2.1.2.2.cmml" xref="A3.SS1.p3.3.m2.1.2.2">𝕀</ci><ci id="A3.SS1.p3.3.m2.1.1.cmml" xref="A3.SS1.p3.3.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.3.m2.1c">\mathbb{I}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.3.m2.1d">blackboard_I ( ⋅ )</annotation></semantics></math> denotes the indicator function. The first term, weighted by <math alttext="R_{1}" class="ltx_Math" display="inline" id="A3.SS1.p3.4.m3.1"><semantics id="A3.SS1.p3.4.m3.1a"><msub id="A3.SS1.p3.4.m3.1.1" xref="A3.SS1.p3.4.m3.1.1.cmml"><mi id="A3.SS1.p3.4.m3.1.1.2" xref="A3.SS1.p3.4.m3.1.1.2.cmml">R</mi><mn id="A3.SS1.p3.4.m3.1.1.3" xref="A3.SS1.p3.4.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.4.m3.1b"><apply id="A3.SS1.p3.4.m3.1.1.cmml" xref="A3.SS1.p3.4.m3.1.1"><csymbol cd="ambiguous" id="A3.SS1.p3.4.m3.1.1.1.cmml" xref="A3.SS1.p3.4.m3.1.1">subscript</csymbol><ci id="A3.SS1.p3.4.m3.1.1.2.cmml" xref="A3.SS1.p3.4.m3.1.1.2">𝑅</ci><cn id="A3.SS1.p3.4.m3.1.1.3.cmml" type="integer" xref="A3.SS1.p3.4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.4.m3.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.4.m3.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, introduces <math alttext="2^{D}" class="ltx_Math" display="inline" id="A3.SS1.p3.5.m4.1"><semantics id="A3.SS1.p3.5.m4.1a"><msup id="A3.SS1.p3.5.m4.1.1" xref="A3.SS1.p3.5.m4.1.1.cmml"><mn id="A3.SS1.p3.5.m4.1.1.2" xref="A3.SS1.p3.5.m4.1.1.2.cmml">2</mn><mi id="A3.SS1.p3.5.m4.1.1.3" xref="A3.SS1.p3.5.m4.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.5.m4.1b"><apply id="A3.SS1.p3.5.m4.1.1.cmml" xref="A3.SS1.p3.5.m4.1.1"><csymbol cd="ambiguous" id="A3.SS1.p3.5.m4.1.1.1.cmml" xref="A3.SS1.p3.5.m4.1.1">superscript</csymbol><cn id="A3.SS1.p3.5.m4.1.1.2.cmml" type="integer" xref="A3.SS1.p3.5.m4.1.1.2">2</cn><ci id="A3.SS1.p3.5.m4.1.1.3.cmml" xref="A3.SS1.p3.5.m4.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.5.m4.1c">2^{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.5.m4.1d">2 start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> high-reward modes near the grid’s corners, while the second term, weighted by <math alttext="R_{2}" class="ltx_Math" display="inline" id="A3.SS1.p3.6.m5.1"><semantics id="A3.SS1.p3.6.m5.1a"><msub id="A3.SS1.p3.6.m5.1.1" xref="A3.SS1.p3.6.m5.1.1.cmml"><mi id="A3.SS1.p3.6.m5.1.1.2" xref="A3.SS1.p3.6.m5.1.1.2.cmml">R</mi><mn id="A3.SS1.p3.6.m5.1.1.3" xref="A3.SS1.p3.6.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.6.m5.1b"><apply id="A3.SS1.p3.6.m5.1.1.cmml" xref="A3.SS1.p3.6.m5.1.1"><csymbol cd="ambiguous" id="A3.SS1.p3.6.m5.1.1.1.cmml" xref="A3.SS1.p3.6.m5.1.1">subscript</csymbol><ci id="A3.SS1.p3.6.m5.1.1.2.cmml" xref="A3.SS1.p3.6.m5.1.1.2">𝑅</ci><cn id="A3.SS1.p3.6.m5.1.1.3.cmml" type="integer" xref="A3.SS1.p3.6.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.6.m5.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.6.m5.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, creates even sparser regions of extremely high reward, thereby increasing the difficulty of discovering them through exploration alone.</p>
</div>
<div class="ltx_para" id="A3.SS1.p4">
<p class="ltx_p" id="A3.SS1.p4.1">Following the most challenging configuration proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>, we set the environment parameters to <math alttext="R_{0}=10^{-3},R_{1}=0.5,R_{2}=2" class="ltx_Math" display="inline" id="A3.SS1.p4.1.m1.2"><semantics id="A3.SS1.p4.1.m1.2a"><mrow id="A3.SS1.p4.1.m1.2.2.2" xref="A3.SS1.p4.1.m1.2.2.3.cmml"><mrow id="A3.SS1.p4.1.m1.1.1.1.1" xref="A3.SS1.p4.1.m1.1.1.1.1.cmml"><msub id="A3.SS1.p4.1.m1.1.1.1.1.2" xref="A3.SS1.p4.1.m1.1.1.1.1.2.cmml"><mi id="A3.SS1.p4.1.m1.1.1.1.1.2.2" xref="A3.SS1.p4.1.m1.1.1.1.1.2.2.cmml">R</mi><mn id="A3.SS1.p4.1.m1.1.1.1.1.2.3" xref="A3.SS1.p4.1.m1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="A3.SS1.p4.1.m1.1.1.1.1.1" xref="A3.SS1.p4.1.m1.1.1.1.1.1.cmml">=</mo><msup id="A3.SS1.p4.1.m1.1.1.1.1.3" xref="A3.SS1.p4.1.m1.1.1.1.1.3.cmml"><mn id="A3.SS1.p4.1.m1.1.1.1.1.3.2" xref="A3.SS1.p4.1.m1.1.1.1.1.3.2.cmml">10</mn><mrow id="A3.SS1.p4.1.m1.1.1.1.1.3.3" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3.cmml"><mo id="A3.SS1.p4.1.m1.1.1.1.1.3.3a" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3.cmml">−</mo><mn id="A3.SS1.p4.1.m1.1.1.1.1.3.3.2" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><mo id="A3.SS1.p4.1.m1.2.2.2.3" xref="A3.SS1.p4.1.m1.2.2.3a.cmml">,</mo><mrow id="A3.SS1.p4.1.m1.2.2.2.2.2" xref="A3.SS1.p4.1.m1.2.2.2.2.3.cmml"><mrow id="A3.SS1.p4.1.m1.2.2.2.2.1.1" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.cmml"><msub id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.cmml"><mi id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.2" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.2.cmml">R</mi><mn id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.3" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.3.cmml">1</mn></msub><mo id="A3.SS1.p4.1.m1.2.2.2.2.1.1.1" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="A3.SS1.p4.1.m1.2.2.2.2.1.1.3" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.3.cmml">0.5</mn></mrow><mo id="A3.SS1.p4.1.m1.2.2.2.2.2.3" xref="A3.SS1.p4.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A3.SS1.p4.1.m1.2.2.2.2.2.2" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.cmml"><msub id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.2" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.2.cmml">R</mi><mn id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.3" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A3.SS1.p4.1.m1.2.2.2.2.2.2.1" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="A3.SS1.p4.1.m1.2.2.2.2.2.2.3" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.3.cmml">2</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p4.1.m1.2b"><apply id="A3.SS1.p4.1.m1.2.2.3.cmml" xref="A3.SS1.p4.1.m1.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.2.2.3a.cmml" xref="A3.SS1.p4.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A3.SS1.p4.1.m1.1.1.1.1.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1"><eq id="A3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.1"></eq><apply id="A3.SS1.p4.1.m1.1.1.1.1.2.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.1.1.1.1.2.1.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.2">subscript</csymbol><ci id="A3.SS1.p4.1.m1.1.1.1.1.2.2.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.2.2">𝑅</ci><cn id="A3.SS1.p4.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="A3.SS1.p4.1.m1.1.1.1.1.2.3">0</cn></apply><apply id="A3.SS1.p4.1.m1.1.1.1.1.3.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.1.1.1.1.3.1.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.3">superscript</csymbol><cn id="A3.SS1.p4.1.m1.1.1.1.1.3.2.cmml" type="integer" xref="A3.SS1.p4.1.m1.1.1.1.1.3.2">10</cn><apply id="A3.SS1.p4.1.m1.1.1.1.1.3.3.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3"><minus id="A3.SS1.p4.1.m1.1.1.1.1.3.3.1.cmml" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3"></minus><cn id="A3.SS1.p4.1.m1.1.1.1.1.3.3.2.cmml" type="integer" xref="A3.SS1.p4.1.m1.1.1.1.1.3.3.2">3</cn></apply></apply></apply><apply id="A3.SS1.p4.1.m1.2.2.2.2.3.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.2.2.2.2.3a.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A3.SS1.p4.1.m1.2.2.2.2.1.1.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1"><eq id="A3.SS1.p4.1.m1.2.2.2.2.1.1.1.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.1"></eq><apply id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.1.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.2.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.2">𝑅</ci><cn id="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.3.cmml" type="integer" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.2.3">1</cn></apply><cn id="A3.SS1.p4.1.m1.2.2.2.2.1.1.3.cmml" type="float" xref="A3.SS1.p4.1.m1.2.2.2.2.1.1.3">0.5</cn></apply><apply id="A3.SS1.p4.1.m1.2.2.2.2.2.2.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2"><eq id="A3.SS1.p4.1.m1.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.1"></eq><apply id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.2">𝑅</ci><cn id="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.3.cmml" type="integer" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.2.3">2</cn></apply><cn id="A3.SS1.p4.1.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="A3.SS1.p4.1.m1.2.2.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p4.1.m1.2c">R_{0}=10^{-3},R_{1}=0.5,R_{2}=2</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p4.1.m1.2d">italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.5 , italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 2</annotation></semantics></math>. This configuration results in a highly multi-modal and sparsely rewarded environment, making it well-suited for evaluating the effectiveness of offline training strategies.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Biosequence Design</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">The Anti-Microbial Peptide (AMP) Design task, introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>]</cite>, is a realistic sequence generation benchmark aimed at designing short peptide sequences with strong anti-microbial properties.</p>
</div>
<div class="ltx_para" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.2">The agent constructs sequences by selecting amino acids from a fixed vocabulary of <math alttext="20" class="ltx_Math" display="inline" id="A3.SS2.p2.1.m1.1"><semantics id="A3.SS2.p2.1.m1.1a"><mn id="A3.SS2.p2.1.m1.1.1" xref="A3.SS2.p2.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.1.m1.1b"><cn id="A3.SS2.p2.1.m1.1.1.cmml" type="integer" xref="A3.SS2.p2.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.1.m1.1c">20</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.1.m1.1d">20</annotation></semantics></math> standard residues, with a maximum sequence length of <math alttext="50" class="ltx_Math" display="inline" id="A3.SS2.p2.2.m2.1"><semantics id="A3.SS2.p2.2.m2.1a"><mn id="A3.SS2.p2.2.m2.1.1" xref="A3.SS2.p2.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.2.m2.1b"><cn id="A3.SS2.p2.2.m2.1.1.cmml" type="integer" xref="A3.SS2.p2.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.2.m2.1c">50</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p2.2.m2.1d">50</annotation></semantics></math>. At each time step, the agent chooses either an amino acid or a special end-of-sequence token, proceeding in a left-to-right manner. As a result, the transition structure forms a tree.</p>
</div>
<div class="ltx_para" id="A3.SS2.p3">
<p class="ltx_p" id="A3.SS2.p3.1">Notably, when the environment DAG degenerates into a tree, the prioritized backward sampling strategy in TD-GFN simplifies to sampling trajectories from the dataset in proportion to their terminal rewards. Despite this simplification, TD-GFN remains effective on this task, which presents substantial challenges due to the large combinatorial space of valid sequences (<math alttext="\approx 20^{50}" class="ltx_Math" display="inline" id="A3.SS2.p3.1.m1.1"><semantics id="A3.SS2.p3.1.m1.1a"><mrow id="A3.SS2.p3.1.m1.1.1" xref="A3.SS2.p3.1.m1.1.1.cmml"><mi id="A3.SS2.p3.1.m1.1.1.2" xref="A3.SS2.p3.1.m1.1.1.2.cmml"></mi><mo id="A3.SS2.p3.1.m1.1.1.1" xref="A3.SS2.p3.1.m1.1.1.1.cmml">≈</mo><msup id="A3.SS2.p3.1.m1.1.1.3" xref="A3.SS2.p3.1.m1.1.1.3.cmml"><mn id="A3.SS2.p3.1.m1.1.1.3.2" xref="A3.SS2.p3.1.m1.1.1.3.2.cmml">20</mn><mn id="A3.SS2.p3.1.m1.1.1.3.3" xref="A3.SS2.p3.1.m1.1.1.3.3.cmml">50</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p3.1.m1.1b"><apply id="A3.SS2.p3.1.m1.1.1.cmml" xref="A3.SS2.p3.1.m1.1.1"><approx id="A3.SS2.p3.1.m1.1.1.1.cmml" xref="A3.SS2.p3.1.m1.1.1.1"></approx><csymbol cd="latexml" id="A3.SS2.p3.1.m1.1.1.2.cmml" xref="A3.SS2.p3.1.m1.1.1.2">absent</csymbol><apply id="A3.SS2.p3.1.m1.1.1.3.cmml" xref="A3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p3.1.m1.1.1.3.1.cmml" xref="A3.SS2.p3.1.m1.1.1.3">superscript</csymbol><cn id="A3.SS2.p3.1.m1.1.1.3.2.cmml" type="integer" xref="A3.SS2.p3.1.m1.1.1.3.2">20</cn><cn id="A3.SS2.p3.1.m1.1.1.3.3.cmml" type="integer" xref="A3.SS2.p3.1.m1.1.1.3.3">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p3.1.m1.1c">\approx 20^{50}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p3.1.m1.1d">≈ 20 start_POSTSUPERSCRIPT 50 end_POSTSUPERSCRIPT</annotation></semantics></math>) and the extreme sparsity of high-reward regions.</p>
</div>
<div class="ltx_para" id="A3.SS2.p4">
<p class="ltx_p" id="A3.SS2.p4.1">In our experiments, we adopt the <span class="ltx_text ltx_font_italic" id="A3.SS2.p4.1.1">Diversity</span> metric to evaluate algorithmic performance, following the methodology in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>]</cite>. For a set of biological sequences <math alttext="C" class="ltx_Math" display="inline" id="A3.SS2.p4.1.m1.1"><semantics id="A3.SS2.p4.1.m1.1a"><mi id="A3.SS2.p4.1.m1.1.1" xref="A3.SS2.p4.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS2.p4.1.m1.1b"><ci id="A3.SS2.p4.1.m1.1.1.cmml" xref="A3.SS2.p4.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p4.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p4.1.m1.1d">italic_C</annotation></semantics></math>, the metric is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Diversity}(C)=\frac{\sum_{x_{i},x_{j}\in C}\text{Lev}(x_{i},x_{j})}{|C|(%
|C|-1)}," class="ltx_Math" display="block" id="A3.Ex3.m1.9"><semantics id="A3.Ex3.m1.9a"><mrow id="A3.Ex3.m1.9.9.1" xref="A3.Ex3.m1.9.9.1.1.cmml"><mrow id="A3.Ex3.m1.9.9.1.1" xref="A3.Ex3.m1.9.9.1.1.cmml"><mrow id="A3.Ex3.m1.9.9.1.1.2" xref="A3.Ex3.m1.9.9.1.1.2.cmml"><mtext id="A3.Ex3.m1.9.9.1.1.2.2" xref="A3.Ex3.m1.9.9.1.1.2.2a.cmml">Diversity</mtext><mo id="A3.Ex3.m1.9.9.1.1.2.1" xref="A3.Ex3.m1.9.9.1.1.2.1.cmml">⁢</mo><mrow id="A3.Ex3.m1.9.9.1.1.2.3.2" xref="A3.Ex3.m1.9.9.1.1.2.cmml"><mo id="A3.Ex3.m1.9.9.1.1.2.3.2.1" stretchy="false" xref="A3.Ex3.m1.9.9.1.1.2.cmml">(</mo><mi id="A3.Ex3.m1.8.8" xref="A3.Ex3.m1.8.8.cmml">C</mi><mo id="A3.Ex3.m1.9.9.1.1.2.3.2.2" stretchy="false" xref="A3.Ex3.m1.9.9.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex3.m1.9.9.1.1.1" xref="A3.Ex3.m1.9.9.1.1.1.cmml">=</mo><mfrac id="A3.Ex3.m1.7.7" xref="A3.Ex3.m1.7.7.cmml"><mrow id="A3.Ex3.m1.4.4.4" xref="A3.Ex3.m1.4.4.4.cmml"><msub id="A3.Ex3.m1.4.4.4.5" xref="A3.Ex3.m1.4.4.4.5.cmml"><mo id="A3.Ex3.m1.4.4.4.5.2" xref="A3.Ex3.m1.4.4.4.5.2.cmml">∑</mo><mrow id="A3.Ex3.m1.2.2.2.2.2" xref="A3.Ex3.m1.2.2.2.2.2.cmml"><mrow id="A3.Ex3.m1.2.2.2.2.2.2.2" xref="A3.Ex3.m1.2.2.2.2.2.2.3.cmml"><msub id="A3.Ex3.m1.1.1.1.1.1.1.1.1" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex3.m1.1.1.1.1.1.1.1.1.2" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A3.Ex3.m1.1.1.1.1.1.1.1.1.3" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.Ex3.m1.2.2.2.2.2.2.2.3" xref="A3.Ex3.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="A3.Ex3.m1.2.2.2.2.2.2.2.2" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2.cmml"><mi id="A3.Ex3.m1.2.2.2.2.2.2.2.2.2" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="A3.Ex3.m1.2.2.2.2.2.2.2.2.3" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="A3.Ex3.m1.2.2.2.2.2.3" xref="A3.Ex3.m1.2.2.2.2.2.3.cmml">∈</mo><mi id="A3.Ex3.m1.2.2.2.2.2.4" xref="A3.Ex3.m1.2.2.2.2.2.4.cmml">C</mi></mrow></msub><mrow id="A3.Ex3.m1.4.4.4.4" xref="A3.Ex3.m1.4.4.4.4.cmml"><mtext id="A3.Ex3.m1.4.4.4.4.4" xref="A3.Ex3.m1.4.4.4.4.4a.cmml">Lev</mtext><mo id="A3.Ex3.m1.4.4.4.4.3" xref="A3.Ex3.m1.4.4.4.4.3.cmml">⁢</mo><mrow id="A3.Ex3.m1.4.4.4.4.2.2" xref="A3.Ex3.m1.4.4.4.4.2.3.cmml"><mo id="A3.Ex3.m1.4.4.4.4.2.2.3" stretchy="false" xref="A3.Ex3.m1.4.4.4.4.2.3.cmml">(</mo><msub id="A3.Ex3.m1.3.3.3.3.1.1.1" xref="A3.Ex3.m1.3.3.3.3.1.1.1.cmml"><mi id="A3.Ex3.m1.3.3.3.3.1.1.1.2" xref="A3.Ex3.m1.3.3.3.3.1.1.1.2.cmml">x</mi><mi id="A3.Ex3.m1.3.3.3.3.1.1.1.3" xref="A3.Ex3.m1.3.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="A3.Ex3.m1.4.4.4.4.2.2.4" xref="A3.Ex3.m1.4.4.4.4.2.3.cmml">,</mo><msub id="A3.Ex3.m1.4.4.4.4.2.2.2" xref="A3.Ex3.m1.4.4.4.4.2.2.2.cmml"><mi id="A3.Ex3.m1.4.4.4.4.2.2.2.2" xref="A3.Ex3.m1.4.4.4.4.2.2.2.2.cmml">x</mi><mi id="A3.Ex3.m1.4.4.4.4.2.2.2.3" xref="A3.Ex3.m1.4.4.4.4.2.2.2.3.cmml">j</mi></msub><mo id="A3.Ex3.m1.4.4.4.4.2.2.5" stretchy="false" xref="A3.Ex3.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A3.Ex3.m1.7.7.7" xref="A3.Ex3.m1.7.7.7.cmml"><mrow id="A3.Ex3.m1.7.7.7.5.2" xref="A3.Ex3.m1.7.7.7.5.1.cmml"><mo id="A3.Ex3.m1.7.7.7.5.2.1" stretchy="false" xref="A3.Ex3.m1.7.7.7.5.1.1.cmml">|</mo><mi id="A3.Ex3.m1.5.5.5.1" xref="A3.Ex3.m1.5.5.5.1.cmml">C</mi><mo id="A3.Ex3.m1.7.7.7.5.2.2" stretchy="false" xref="A3.Ex3.m1.7.7.7.5.1.1.cmml">|</mo></mrow><mo id="A3.Ex3.m1.7.7.7.4" xref="A3.Ex3.m1.7.7.7.4.cmml">⁢</mo><mrow id="A3.Ex3.m1.7.7.7.3.1" xref="A3.Ex3.m1.7.7.7.3.1.1.cmml"><mo id="A3.Ex3.m1.7.7.7.3.1.2" stretchy="false" xref="A3.Ex3.m1.7.7.7.3.1.1.cmml">(</mo><mrow id="A3.Ex3.m1.7.7.7.3.1.1" xref="A3.Ex3.m1.7.7.7.3.1.1.cmml"><mrow id="A3.Ex3.m1.7.7.7.3.1.1.2.2" xref="A3.Ex3.m1.7.7.7.3.1.1.2.1.cmml"><mo id="A3.Ex3.m1.7.7.7.3.1.1.2.2.1" stretchy="false" xref="A3.Ex3.m1.7.7.7.3.1.1.2.1.1.cmml">|</mo><mi id="A3.Ex3.m1.6.6.6.2" xref="A3.Ex3.m1.6.6.6.2.cmml">C</mi><mo id="A3.Ex3.m1.7.7.7.3.1.1.2.2.2" stretchy="false" xref="A3.Ex3.m1.7.7.7.3.1.1.2.1.1.cmml">|</mo></mrow><mo id="A3.Ex3.m1.7.7.7.3.1.1.1" xref="A3.Ex3.m1.7.7.7.3.1.1.1.cmml">−</mo><mn id="A3.Ex3.m1.7.7.7.3.1.1.3" xref="A3.Ex3.m1.7.7.7.3.1.1.3.cmml">1</mn></mrow><mo id="A3.Ex3.m1.7.7.7.3.1.3" stretchy="false" xref="A3.Ex3.m1.7.7.7.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A3.Ex3.m1.9.9.1.2" xref="A3.Ex3.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex3.m1.9b"><apply id="A3.Ex3.m1.9.9.1.1.cmml" xref="A3.Ex3.m1.9.9.1"><eq id="A3.Ex3.m1.9.9.1.1.1.cmml" xref="A3.Ex3.m1.9.9.1.1.1"></eq><apply id="A3.Ex3.m1.9.9.1.1.2.cmml" xref="A3.Ex3.m1.9.9.1.1.2"><times id="A3.Ex3.m1.9.9.1.1.2.1.cmml" xref="A3.Ex3.m1.9.9.1.1.2.1"></times><ci id="A3.Ex3.m1.9.9.1.1.2.2a.cmml" xref="A3.Ex3.m1.9.9.1.1.2.2"><mtext id="A3.Ex3.m1.9.9.1.1.2.2.cmml" xref="A3.Ex3.m1.9.9.1.1.2.2">Diversity</mtext></ci><ci id="A3.Ex3.m1.8.8.cmml" xref="A3.Ex3.m1.8.8">𝐶</ci></apply><apply id="A3.Ex3.m1.7.7.cmml" xref="A3.Ex3.m1.7.7"><divide id="A3.Ex3.m1.7.7.8.cmml" xref="A3.Ex3.m1.7.7"></divide><apply id="A3.Ex3.m1.4.4.4.cmml" xref="A3.Ex3.m1.4.4.4"><apply id="A3.Ex3.m1.4.4.4.5.cmml" xref="A3.Ex3.m1.4.4.4.5"><csymbol cd="ambiguous" id="A3.Ex3.m1.4.4.4.5.1.cmml" xref="A3.Ex3.m1.4.4.4.5">subscript</csymbol><sum id="A3.Ex3.m1.4.4.4.5.2.cmml" xref="A3.Ex3.m1.4.4.4.5.2"></sum><apply id="A3.Ex3.m1.2.2.2.2.2.cmml" xref="A3.Ex3.m1.2.2.2.2.2"><in id="A3.Ex3.m1.2.2.2.2.2.3.cmml" xref="A3.Ex3.m1.2.2.2.2.2.3"></in><list id="A3.Ex3.m1.2.2.2.2.2.2.3.cmml" xref="A3.Ex3.m1.2.2.2.2.2.2.2"><apply id="A3.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A3.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex3.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.Ex3.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A3.Ex3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2.2">𝑥</ci><ci id="A3.Ex3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A3.Ex3.m1.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></list><ci id="A3.Ex3.m1.2.2.2.2.2.4.cmml" xref="A3.Ex3.m1.2.2.2.2.2.4">𝐶</ci></apply></apply><apply id="A3.Ex3.m1.4.4.4.4.cmml" xref="A3.Ex3.m1.4.4.4.4"><times id="A3.Ex3.m1.4.4.4.4.3.cmml" xref="A3.Ex3.m1.4.4.4.4.3"></times><ci id="A3.Ex3.m1.4.4.4.4.4a.cmml" xref="A3.Ex3.m1.4.4.4.4.4"><mtext id="A3.Ex3.m1.4.4.4.4.4.cmml" xref="A3.Ex3.m1.4.4.4.4.4">Lev</mtext></ci><interval closure="open" id="A3.Ex3.m1.4.4.4.4.2.3.cmml" xref="A3.Ex3.m1.4.4.4.4.2.2"><apply id="A3.Ex3.m1.3.3.3.3.1.1.1.cmml" xref="A3.Ex3.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.Ex3.m1.3.3.3.3.1.1.1.1.cmml" xref="A3.Ex3.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="A3.Ex3.m1.3.3.3.3.1.1.1.2.cmml" xref="A3.Ex3.m1.3.3.3.3.1.1.1.2">𝑥</ci><ci id="A3.Ex3.m1.3.3.3.3.1.1.1.3.cmml" xref="A3.Ex3.m1.3.3.3.3.1.1.1.3">𝑖</ci></apply><apply id="A3.Ex3.m1.4.4.4.4.2.2.2.cmml" xref="A3.Ex3.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="A3.Ex3.m1.4.4.4.4.2.2.2.1.cmml" xref="A3.Ex3.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="A3.Ex3.m1.4.4.4.4.2.2.2.2.cmml" xref="A3.Ex3.m1.4.4.4.4.2.2.2.2">𝑥</ci><ci id="A3.Ex3.m1.4.4.4.4.2.2.2.3.cmml" xref="A3.Ex3.m1.4.4.4.4.2.2.2.3">𝑗</ci></apply></interval></apply></apply><apply id="A3.Ex3.m1.7.7.7.cmml" xref="A3.Ex3.m1.7.7.7"><times id="A3.Ex3.m1.7.7.7.4.cmml" xref="A3.Ex3.m1.7.7.7.4"></times><apply id="A3.Ex3.m1.7.7.7.5.1.cmml" xref="A3.Ex3.m1.7.7.7.5.2"><abs id="A3.Ex3.m1.7.7.7.5.1.1.cmml" xref="A3.Ex3.m1.7.7.7.5.2.1"></abs><ci id="A3.Ex3.m1.5.5.5.1.cmml" xref="A3.Ex3.m1.5.5.5.1">𝐶</ci></apply><apply id="A3.Ex3.m1.7.7.7.3.1.1.cmml" xref="A3.Ex3.m1.7.7.7.3.1"><minus id="A3.Ex3.m1.7.7.7.3.1.1.1.cmml" xref="A3.Ex3.m1.7.7.7.3.1.1.1"></minus><apply id="A3.Ex3.m1.7.7.7.3.1.1.2.1.cmml" xref="A3.Ex3.m1.7.7.7.3.1.1.2.2"><abs id="A3.Ex3.m1.7.7.7.3.1.1.2.1.1.cmml" xref="A3.Ex3.m1.7.7.7.3.1.1.2.2.1"></abs><ci id="A3.Ex3.m1.6.6.6.2.cmml" xref="A3.Ex3.m1.6.6.6.2">𝐶</ci></apply><cn id="A3.Ex3.m1.7.7.7.3.1.1.3.cmml" type="integer" xref="A3.Ex3.m1.7.7.7.3.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex3.m1.9c">\text{Diversity}(C)=\frac{\sum_{x_{i},x_{j}\in C}\text{Lev}(x_{i},x_{j})}{|C|(%
|C|-1)},</annotation><annotation encoding="application/x-llamapun" id="A3.Ex3.m1.9d">Diversity ( italic_C ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_C end_POSTSUBSCRIPT Lev ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG | italic_C | ( | italic_C | - 1 ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS2.p4.2">where <math alttext="\text{Lev}(\cdot,\cdot)" class="ltx_Math" display="inline" id="A3.SS2.p4.2.m1.2"><semantics id="A3.SS2.p4.2.m1.2a"><mrow id="A3.SS2.p4.2.m1.2.3" xref="A3.SS2.p4.2.m1.2.3.cmml"><mtext id="A3.SS2.p4.2.m1.2.3.2" xref="A3.SS2.p4.2.m1.2.3.2a.cmml">Lev</mtext><mo id="A3.SS2.p4.2.m1.2.3.1" xref="A3.SS2.p4.2.m1.2.3.1.cmml">⁢</mo><mrow id="A3.SS2.p4.2.m1.2.3.3.2" xref="A3.SS2.p4.2.m1.2.3.3.1.cmml"><mo id="A3.SS2.p4.2.m1.2.3.3.2.1" stretchy="false" xref="A3.SS2.p4.2.m1.2.3.3.1.cmml">(</mo><mo id="A3.SS2.p4.2.m1.1.1" lspace="0em" rspace="0em" xref="A3.SS2.p4.2.m1.1.1.cmml">⋅</mo><mo id="A3.SS2.p4.2.m1.2.3.3.2.2" rspace="0em" xref="A3.SS2.p4.2.m1.2.3.3.1.cmml">,</mo><mo id="A3.SS2.p4.2.m1.2.2" lspace="0em" rspace="0em" xref="A3.SS2.p4.2.m1.2.2.cmml">⋅</mo><mo id="A3.SS2.p4.2.m1.2.3.3.2.3" stretchy="false" xref="A3.SS2.p4.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p4.2.m1.2b"><apply id="A3.SS2.p4.2.m1.2.3.cmml" xref="A3.SS2.p4.2.m1.2.3"><times id="A3.SS2.p4.2.m1.2.3.1.cmml" xref="A3.SS2.p4.2.m1.2.3.1"></times><ci id="A3.SS2.p4.2.m1.2.3.2a.cmml" xref="A3.SS2.p4.2.m1.2.3.2"><mtext id="A3.SS2.p4.2.m1.2.3.2.cmml" xref="A3.SS2.p4.2.m1.2.3.2">Lev</mtext></ci><interval closure="open" id="A3.SS2.p4.2.m1.2.3.3.1.cmml" xref="A3.SS2.p4.2.m1.2.3.3.2"><ci id="A3.SS2.p4.2.m1.1.1.cmml" xref="A3.SS2.p4.2.m1.1.1">⋅</ci><ci id="A3.SS2.p4.2.m1.2.2.cmml" xref="A3.SS2.p4.2.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p4.2.m1.2c">\text{Lev}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p4.2.m1.2d">Lev ( ⋅ , ⋅ )</annotation></semantics></math> denotes the Levenshtein distance. All environmental parameters are kept consistent with those used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib3" title="">3</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Molecule Design</h3>
<div class="ltx_para" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.1">We evaluate our method on a fragment-based molecular generation task targeting protein binding affinity, specifically for soluble epoxide hydrolase (sEH). The goal is to construct candidate molecules with high predicted affinity for the target protein. Molecules are generated sequentially using the junction tree framework introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib77" title="">77</a>]</cite>, where each action involves selecting an attachment atom and adding a fragment from a predefined vocabulary of <math alttext="105" class="ltx_Math" display="inline" id="A3.SS3.p1.1.m1.1"><semantics id="A3.SS3.p1.1.m1.1a"><mn id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml">105</mn><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><cn id="A3.SS3.p1.1.m1.1.1.cmml" type="integer" xref="A3.SS3.p1.1.m1.1.1">105</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">105</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.1.m1.1d">105</annotation></semantics></math> building blocks.</p>
</div>
<div class="ltx_para" id="A3.SS3.p2">
<p class="ltx_p" id="A3.SS3.p2.5">The reward is defined as the negative binding energy between the generated molecule and the target protein, as predicted by an oracle model pre-trained on <math alttext="300k" class="ltx_Math" display="inline" id="A3.SS3.p2.1.m1.1"><semantics id="A3.SS3.p2.1.m1.1a"><mrow id="A3.SS3.p2.1.m1.1.1" xref="A3.SS3.p2.1.m1.1.1.cmml"><mn id="A3.SS3.p2.1.m1.1.1.2" xref="A3.SS3.p2.1.m1.1.1.2.cmml">300</mn><mo id="A3.SS3.p2.1.m1.1.1.1" xref="A3.SS3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.SS3.p2.1.m1.1.1.3" xref="A3.SS3.p2.1.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.1.m1.1b"><apply id="A3.SS3.p2.1.m1.1.1.cmml" xref="A3.SS3.p2.1.m1.1.1"><times id="A3.SS3.p2.1.m1.1.1.1.cmml" xref="A3.SS3.p2.1.m1.1.1.1"></times><cn id="A3.SS3.p2.1.m1.1.1.2.cmml" type="integer" xref="A3.SS3.p2.1.m1.1.1.2">300</cn><ci id="A3.SS3.p2.1.m1.1.1.3.cmml" xref="A3.SS3.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.1.m1.1c">300k</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.1.m1.1d">300 italic_k</annotation></semantics></math> molecules, following the setup in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>. To balance reward maximization with output diversity, the final reward is modulated using a reward exponent <math alttext="\omega" class="ltx_Math" display="inline" id="A3.SS3.p2.2.m2.1"><semantics id="A3.SS3.p2.2.m2.1a"><mi id="A3.SS3.p2.2.m2.1.1" xref="A3.SS3.p2.2.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.2.m2.1b"><ci id="A3.SS3.p2.2.m2.1.1.cmml" xref="A3.SS3.p2.2.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.2.m2.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.2.m2.1d">italic_ω</annotation></semantics></math>, such that <math alttext="R^{\prime}(x)=R(x)^{\omega}" class="ltx_Math" display="inline" id="A3.SS3.p2.3.m3.2"><semantics id="A3.SS3.p2.3.m3.2a"><mrow id="A3.SS3.p2.3.m3.2.3" xref="A3.SS3.p2.3.m3.2.3.cmml"><mrow id="A3.SS3.p2.3.m3.2.3.2" xref="A3.SS3.p2.3.m3.2.3.2.cmml"><msup id="A3.SS3.p2.3.m3.2.3.2.2" xref="A3.SS3.p2.3.m3.2.3.2.2.cmml"><mi id="A3.SS3.p2.3.m3.2.3.2.2.2" xref="A3.SS3.p2.3.m3.2.3.2.2.2.cmml">R</mi><mo id="A3.SS3.p2.3.m3.2.3.2.2.3" xref="A3.SS3.p2.3.m3.2.3.2.2.3.cmml">′</mo></msup><mo id="A3.SS3.p2.3.m3.2.3.2.1" xref="A3.SS3.p2.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="A3.SS3.p2.3.m3.2.3.2.3.2" xref="A3.SS3.p2.3.m3.2.3.2.cmml"><mo id="A3.SS3.p2.3.m3.2.3.2.3.2.1" stretchy="false" xref="A3.SS3.p2.3.m3.2.3.2.cmml">(</mo><mi id="A3.SS3.p2.3.m3.1.1" xref="A3.SS3.p2.3.m3.1.1.cmml">x</mi><mo id="A3.SS3.p2.3.m3.2.3.2.3.2.2" stretchy="false" xref="A3.SS3.p2.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="A3.SS3.p2.3.m3.2.3.1" xref="A3.SS3.p2.3.m3.2.3.1.cmml">=</mo><mrow id="A3.SS3.p2.3.m3.2.3.3" xref="A3.SS3.p2.3.m3.2.3.3.cmml"><mi id="A3.SS3.p2.3.m3.2.3.3.2" xref="A3.SS3.p2.3.m3.2.3.3.2.cmml">R</mi><mo id="A3.SS3.p2.3.m3.2.3.3.1" xref="A3.SS3.p2.3.m3.2.3.3.1.cmml">⁢</mo><msup id="A3.SS3.p2.3.m3.2.3.3.3" xref="A3.SS3.p2.3.m3.2.3.3.3.cmml"><mrow id="A3.SS3.p2.3.m3.2.3.3.3.2.2" xref="A3.SS3.p2.3.m3.2.3.3.3.cmml"><mo id="A3.SS3.p2.3.m3.2.3.3.3.2.2.1" stretchy="false" xref="A3.SS3.p2.3.m3.2.3.3.3.cmml">(</mo><mi id="A3.SS3.p2.3.m3.2.2" xref="A3.SS3.p2.3.m3.2.2.cmml">x</mi><mo id="A3.SS3.p2.3.m3.2.3.3.3.2.2.2" stretchy="false" xref="A3.SS3.p2.3.m3.2.3.3.3.cmml">)</mo></mrow><mi id="A3.SS3.p2.3.m3.2.3.3.3.3" xref="A3.SS3.p2.3.m3.2.3.3.3.3.cmml">ω</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.3.m3.2b"><apply id="A3.SS3.p2.3.m3.2.3.cmml" xref="A3.SS3.p2.3.m3.2.3"><eq id="A3.SS3.p2.3.m3.2.3.1.cmml" xref="A3.SS3.p2.3.m3.2.3.1"></eq><apply id="A3.SS3.p2.3.m3.2.3.2.cmml" xref="A3.SS3.p2.3.m3.2.3.2"><times id="A3.SS3.p2.3.m3.2.3.2.1.cmml" xref="A3.SS3.p2.3.m3.2.3.2.1"></times><apply id="A3.SS3.p2.3.m3.2.3.2.2.cmml" xref="A3.SS3.p2.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="A3.SS3.p2.3.m3.2.3.2.2.1.cmml" xref="A3.SS3.p2.3.m3.2.3.2.2">superscript</csymbol><ci id="A3.SS3.p2.3.m3.2.3.2.2.2.cmml" xref="A3.SS3.p2.3.m3.2.3.2.2.2">𝑅</ci><ci id="A3.SS3.p2.3.m3.2.3.2.2.3.cmml" xref="A3.SS3.p2.3.m3.2.3.2.2.3">′</ci></apply><ci id="A3.SS3.p2.3.m3.1.1.cmml" xref="A3.SS3.p2.3.m3.1.1">𝑥</ci></apply><apply id="A3.SS3.p2.3.m3.2.3.3.cmml" xref="A3.SS3.p2.3.m3.2.3.3"><times id="A3.SS3.p2.3.m3.2.3.3.1.cmml" xref="A3.SS3.p2.3.m3.2.3.3.1"></times><ci id="A3.SS3.p2.3.m3.2.3.3.2.cmml" xref="A3.SS3.p2.3.m3.2.3.3.2">𝑅</ci><apply id="A3.SS3.p2.3.m3.2.3.3.3.cmml" xref="A3.SS3.p2.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="A3.SS3.p2.3.m3.2.3.3.3.1.cmml" xref="A3.SS3.p2.3.m3.2.3.3.3">superscript</csymbol><ci id="A3.SS3.p2.3.m3.2.2.cmml" xref="A3.SS3.p2.3.m3.2.2">𝑥</ci><ci id="A3.SS3.p2.3.m3.2.3.3.3.3.cmml" xref="A3.SS3.p2.3.m3.2.3.3.3.3">𝜔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.3.m3.2c">R^{\prime}(x)=R(x)^{\omega}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.3.m3.2d">italic_R start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x ) = italic_R ( italic_x ) start_POSTSUPERSCRIPT italic_ω end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="R(x)" class="ltx_Math" display="inline" id="A3.SS3.p2.4.m4.1"><semantics id="A3.SS3.p2.4.m4.1a"><mrow id="A3.SS3.p2.4.m4.1.2" xref="A3.SS3.p2.4.m4.1.2.cmml"><mi id="A3.SS3.p2.4.m4.1.2.2" xref="A3.SS3.p2.4.m4.1.2.2.cmml">R</mi><mo id="A3.SS3.p2.4.m4.1.2.1" xref="A3.SS3.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="A3.SS3.p2.4.m4.1.2.3.2" xref="A3.SS3.p2.4.m4.1.2.cmml"><mo id="A3.SS3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="A3.SS3.p2.4.m4.1.2.cmml">(</mo><mi id="A3.SS3.p2.4.m4.1.1" xref="A3.SS3.p2.4.m4.1.1.cmml">x</mi><mo id="A3.SS3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="A3.SS3.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.4.m4.1b"><apply id="A3.SS3.p2.4.m4.1.2.cmml" xref="A3.SS3.p2.4.m4.1.2"><times id="A3.SS3.p2.4.m4.1.2.1.cmml" xref="A3.SS3.p2.4.m4.1.2.1"></times><ci id="A3.SS3.p2.4.m4.1.2.2.cmml" xref="A3.SS3.p2.4.m4.1.2.2">𝑅</ci><ci id="A3.SS3.p2.4.m4.1.1.cmml" xref="A3.SS3.p2.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.4.m4.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.4.m4.1d">italic_R ( italic_x )</annotation></semantics></math> denotes the raw oracle prediction. All environmental parameters, including <math alttext="\omega" class="ltx_Math" display="inline" id="A3.SS3.p2.5.m5.1"><semantics id="A3.SS3.p2.5.m5.1a"><mi id="A3.SS3.p2.5.m5.1.1" xref="A3.SS3.p2.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p2.5.m5.1b"><ci id="A3.SS3.p2.5.m5.1.1.cmml" xref="A3.SS3.p2.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p2.5.m5.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p2.5.m5.1d">italic_ω</annotation></semantics></math>, are kept consistent with those used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Policy Model Architectures and Hyperparameters</h3>
<div class="ltx_para" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.1">Across the experimental tasks presented in this work, we adopt the model architectures listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.T2" title="Table 2 ‣ C.4 Policy Model Architectures and Hyperparameters ‣ Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a> as the backbone structures for the policy networks.</p>
</div>
<figure class="ltx_table" id="A3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Policy network architectures used across different experimental tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A3.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A3.T2.1.1.1.1.1">Task</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A3.T2.1.1.1.2.1">Model architecture</span></td>
</tr>
<tr class="ltx_tr" id="A3.T2.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A3.T2.1.2.2.1">Hypergrid</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.1.2.2.2">MLP([input, 256, 256, output])</td>
</tr>
<tr class="ltx_tr" id="A3.T2.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A3.T2.1.3.3.1">Biosequence Design</th>
<td class="ltx_td ltx_align_center" id="A3.T2.1.3.3.2">MLP([input, 128, 128, output])</td>
</tr>
<tr class="ltx_tr" id="A3.T2.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A3.T2.1.4.4.1">Molecule Design</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.1.4.4.2">MPNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib78" title="">78</a>]</cite> v4</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A3.SS4.p2">
<p class="ltx_p" id="A3.SS4.p2.1">Key algorithmic hyperparameters used across different tasks and methods are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A3.T3" title="Table 3 ‣ C.4 Policy Model Architectures and Hyperparameters ‣ Appendix C Experimental details ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3</span></a>. These values were selected through empirical tuning to ensure stable training and fair comparisons among baselines.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our implementation of COFlowNet is based on the official open-source repository available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yuxuan9982/COflownet" title="">https://github.com/yuxuan9982/COflownet</a>.</span></span></span> Specifically, the pruning threshold coefficient <math alttext="K" class="ltx_Math" display="inline" id="A3.SS4.p2.1.m1.1"><semantics id="A3.SS4.p2.1.m1.1a"><mi id="A3.SS4.p2.1.m1.1.1" xref="A3.SS4.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.1.m1.1b"><ci id="A3.SS4.p2.1.m1.1.1.cmml" xref="A3.SS4.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.1.m1.1d">italic_K</annotation></semantics></math> is tuned by selecting the value that yields the highest ratio of retained expert transitions to retained randomly selected transitions.</p>
</div>
<figure class="ltx_table" id="A3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Hyperparameters used across different tasks and methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T3.25">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T3.25.26.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T3.25.26.1.1"><span class="ltx_text ltx_font_bold" id="A3.T3.25.26.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T3.25.26.1.2"><span class="ltx_text ltx_font_bold" id="A3.T3.25.26.1.2.1">Hyperparameter</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T3.25.26.1.3"><span class="ltx_text ltx_font_bold" id="A3.T3.25.26.1.3.1">Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T3.25.26.1.4"><span class="ltx_text ltx_font_bold" id="A3.T3.25.26.1.4.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A3.T3.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.2.2.3" rowspan="5"><span class="ltx_text" id="A3.T3.2.2.3.1">All</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.1.1.1" rowspan="3"><span class="ltx_text" id="A3.T3.1.1.1.1">Policy learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="A3.T3.1.1.1.1.m1.1"><semantics id="A3.T3.1.1.1.1.m1.1a"><mi id="A3.T3.1.1.1.1.m1.1.1" xref="A3.T3.1.1.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A3.T3.1.1.1.1.m1.1b"><ci id="A3.T3.1.1.1.1.m1.1.1.cmml" xref="A3.T3.1.1.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.1.1.1.1.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="A3.T3.1.1.1.1.m1.1d">italic_η</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.2.2.4">Hypergrid</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.2.2.2"><math alttext="1\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T3.2.2.2.m1.1"><semantics id="A3.T3.2.2.2.m1.1a"><mrow id="A3.T3.2.2.2.m1.1.1" xref="A3.T3.2.2.2.m1.1.1.cmml"><mn id="A3.T3.2.2.2.m1.1.1.2" xref="A3.T3.2.2.2.m1.1.1.2.cmml">1</mn><mo id="A3.T3.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.2.2.2.m1.1.1.1.cmml">×</mo><msup id="A3.T3.2.2.2.m1.1.1.3" xref="A3.T3.2.2.2.m1.1.1.3.cmml"><mn id="A3.T3.2.2.2.m1.1.1.3.2" xref="A3.T3.2.2.2.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.2.2.2.m1.1.1.3.3" xref="A3.T3.2.2.2.m1.1.1.3.3.cmml"><mo id="A3.T3.2.2.2.m1.1.1.3.3a" xref="A3.T3.2.2.2.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.2.2.2.m1.1.1.3.3.2" xref="A3.T3.2.2.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.2.2.2.m1.1b"><apply id="A3.T3.2.2.2.m1.1.1.cmml" xref="A3.T3.2.2.2.m1.1.1"><times id="A3.T3.2.2.2.m1.1.1.1.cmml" xref="A3.T3.2.2.2.m1.1.1.1"></times><cn id="A3.T3.2.2.2.m1.1.1.2.cmml" type="integer" xref="A3.T3.2.2.2.m1.1.1.2">1</cn><apply id="A3.T3.2.2.2.m1.1.1.3.cmml" xref="A3.T3.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.2.2.2.m1.1.1.3.1.cmml" xref="A3.T3.2.2.2.m1.1.1.3">superscript</csymbol><cn id="A3.T3.2.2.2.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.2.2.2.m1.1.1.3.2">10</cn><apply id="A3.T3.2.2.2.m1.1.1.3.3.cmml" xref="A3.T3.2.2.2.m1.1.1.3.3"><minus id="A3.T3.2.2.2.m1.1.1.3.3.1.cmml" xref="A3.T3.2.2.2.m1.1.1.3.3"></minus><cn id="A3.T3.2.2.2.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.2.2.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.2.2.2.m1.1c">1\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.2.2.2.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.3.3">
<td class="ltx_td ltx_align_center" id="A3.T3.3.3.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.3.3.1"><math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A3.T3.3.3.1.m1.1"><semantics id="A3.T3.3.3.1.m1.1a"><mrow id="A3.T3.3.3.1.m1.1.1" xref="A3.T3.3.3.1.m1.1.1.cmml"><mn id="A3.T3.3.3.1.m1.1.1.2" xref="A3.T3.3.3.1.m1.1.1.2.cmml">1</mn><mo id="A3.T3.3.3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.3.3.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.3.3.1.m1.1.1.3" xref="A3.T3.3.3.1.m1.1.1.3.cmml"><mn id="A3.T3.3.3.1.m1.1.1.3.2" xref="A3.T3.3.3.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.3.3.1.m1.1.1.3.3" xref="A3.T3.3.3.1.m1.1.1.3.3.cmml"><mo id="A3.T3.3.3.1.m1.1.1.3.3a" xref="A3.T3.3.3.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.3.3.1.m1.1.1.3.3.2" xref="A3.T3.3.3.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.3.3.1.m1.1b"><apply id="A3.T3.3.3.1.m1.1.1.cmml" xref="A3.T3.3.3.1.m1.1.1"><times id="A3.T3.3.3.1.m1.1.1.1.cmml" xref="A3.T3.3.3.1.m1.1.1.1"></times><cn id="A3.T3.3.3.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.3.3.1.m1.1.1.2">1</cn><apply id="A3.T3.3.3.1.m1.1.1.3.cmml" xref="A3.T3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.3.3.1.m1.1.1.3.1.cmml" xref="A3.T3.3.3.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.3.3.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.3.3.1.m1.1.1.3.2">10</cn><apply id="A3.T3.3.3.1.m1.1.1.3.3.cmml" xref="A3.T3.3.3.1.m1.1.1.3.3"><minus id="A3.T3.3.3.1.m1.1.1.3.3.1.cmml" xref="A3.T3.3.3.1.m1.1.1.3.3"></minus><cn id="A3.T3.3.3.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.3.3.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.3.3.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.3.3.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.4.4">
<td class="ltx_td ltx_align_center" id="A3.T3.4.4.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.4.4.1"><math alttext="1\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T3.4.4.1.m1.1"><semantics id="A3.T3.4.4.1.m1.1a"><mrow id="A3.T3.4.4.1.m1.1.1" xref="A3.T3.4.4.1.m1.1.1.cmml"><mn id="A3.T3.4.4.1.m1.1.1.2" xref="A3.T3.4.4.1.m1.1.1.2.cmml">1</mn><mo id="A3.T3.4.4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.4.4.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.4.4.1.m1.1.1.3" xref="A3.T3.4.4.1.m1.1.1.3.cmml"><mn id="A3.T3.4.4.1.m1.1.1.3.2" xref="A3.T3.4.4.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.4.4.1.m1.1.1.3.3" xref="A3.T3.4.4.1.m1.1.1.3.3.cmml"><mo id="A3.T3.4.4.1.m1.1.1.3.3a" xref="A3.T3.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.4.4.1.m1.1.1.3.3.2" xref="A3.T3.4.4.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.4.4.1.m1.1b"><apply id="A3.T3.4.4.1.m1.1.1.cmml" xref="A3.T3.4.4.1.m1.1.1"><times id="A3.T3.4.4.1.m1.1.1.1.cmml" xref="A3.T3.4.4.1.m1.1.1.1"></times><cn id="A3.T3.4.4.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.4.4.1.m1.1.1.2">1</cn><apply id="A3.T3.4.4.1.m1.1.1.3.cmml" xref="A3.T3.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.4.4.1.m1.1.1.3.1.cmml" xref="A3.T3.4.4.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.4.4.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.4.4.1.m1.1.1.3.2">10</cn><apply id="A3.T3.4.4.1.m1.1.1.3.3.cmml" xref="A3.T3.4.4.1.m1.1.1.3.3"><minus id="A3.T3.4.4.1.m1.1.1.3.3.1.cmml" xref="A3.T3.4.4.1.m1.1.1.3.3"></minus><cn id="A3.T3.4.4.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.4.4.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.4.4.1.m1.1c">1\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.4.4.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.5.5">
<td class="ltx_td ltx_align_center" id="A3.T3.5.5.1"><span class="ltx_text" id="A3.T3.5.5.1.1">Entropy coef. <math alttext="\lambda" class="ltx_Math" display="inline" id="A3.T3.5.5.1.1.m1.1"><semantics id="A3.T3.5.5.1.1.m1.1a"><mi id="A3.T3.5.5.1.1.m1.1.1" xref="A3.T3.5.5.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A3.T3.5.5.1.1.m1.1b"><ci id="A3.T3.5.5.1.1.m1.1.1.cmml" xref="A3.T3.5.5.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.5.5.1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A3.T3.5.5.1.1.m1.1d">italic_λ</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="A3.T3.5.5.2">All</td>
<td class="ltx_td ltx_align_center" id="A3.T3.5.5.3">0.01</td>
</tr>
<tr class="ltx_tr" id="A3.T3.25.27.2">
<td class="ltx_td ltx_align_center" id="A3.T3.25.27.2.1"><span class="ltx_text" id="A3.T3.25.27.2.1.1">Seeds</span></td>
<td class="ltx_td ltx_align_center" id="A3.T3.25.27.2.2">All</td>
<td class="ltx_td ltx_align_center" id="A3.T3.25.27.2.3">0,1,2</td>
</tr>
<tr class="ltx_tr" id="A3.T3.7.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.7.7.3" rowspan="9"><span class="ltx_text" id="A3.T3.7.7.3.1">TD-GFN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.6.6.1" rowspan="3"><span class="ltx_text" id="A3.T3.6.6.1.1">Pruning coef. <math alttext="K" class="ltx_Math" display="inline" id="A3.T3.6.6.1.1.m1.1"><semantics id="A3.T3.6.6.1.1.m1.1a"><mi id="A3.T3.6.6.1.1.m1.1.1" xref="A3.T3.6.6.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.T3.6.6.1.1.m1.1b"><ci id="A3.T3.6.6.1.1.m1.1.1.cmml" xref="A3.T3.6.6.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.6.6.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.T3.6.6.1.1.m1.1d">italic_K</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.7.7.4">Hypergrid</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.7.7.2"><math alttext="7.0" class="ltx_Math" display="inline" id="A3.T3.7.7.2.m1.1"><semantics id="A3.T3.7.7.2.m1.1a"><mn id="A3.T3.7.7.2.m1.1.1" xref="A3.T3.7.7.2.m1.1.1.cmml">7.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.7.7.2.m1.1b"><cn id="A3.T3.7.7.2.m1.1.1.cmml" type="float" xref="A3.T3.7.7.2.m1.1.1">7.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.7.7.2.m1.1c">7.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.7.7.2.m1.1d">7.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.8.8">
<td class="ltx_td ltx_align_center" id="A3.T3.8.8.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.8.8.1"><math alttext="1.0" class="ltx_Math" display="inline" id="A3.T3.8.8.1.m1.1"><semantics id="A3.T3.8.8.1.m1.1a"><mn id="A3.T3.8.8.1.m1.1.1" xref="A3.T3.8.8.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.8.8.1.m1.1b"><cn id="A3.T3.8.8.1.m1.1.1.cmml" type="float" xref="A3.T3.8.8.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.8.8.1.m1.1c">1.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.8.8.1.m1.1d">1.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.9.9">
<td class="ltx_td ltx_align_center" id="A3.T3.9.9.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.9.9.1"><math alttext="2.0" class="ltx_Math" display="inline" id="A3.T3.9.9.1.m1.1"><semantics id="A3.T3.9.9.1.m1.1a"><mn id="A3.T3.9.9.1.m1.1.1" xref="A3.T3.9.9.1.m1.1.1.cmml">2.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.9.9.1.m1.1b"><cn id="A3.T3.9.9.1.m1.1.1.cmml" type="float" xref="A3.T3.9.9.1.m1.1.1">2.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.9.9.1.m1.1c">2.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.9.9.1.m1.1d">2.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.11.11">
<td class="ltx_td ltx_align_center" id="A3.T3.10.10.1" rowspan="3"><span class="ltx_text" id="A3.T3.10.10.1.1">Actor learning rate <math alttext="\alpha" class="ltx_Math" display="inline" id="A3.T3.10.10.1.1.m1.1"><semantics id="A3.T3.10.10.1.1.m1.1a"><mi id="A3.T3.10.10.1.1.m1.1.1" xref="A3.T3.10.10.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.T3.10.10.1.1.m1.1b"><ci id="A3.T3.10.10.1.1.m1.1.1.cmml" xref="A3.T3.10.10.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.10.10.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A3.T3.10.10.1.1.m1.1d">italic_α</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="A3.T3.11.11.3">Hypergrid</td>
<td class="ltx_td ltx_align_center" id="A3.T3.11.11.2"><math alttext="1\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T3.11.11.2.m1.1"><semantics id="A3.T3.11.11.2.m1.1a"><mrow id="A3.T3.11.11.2.m1.1.1" xref="A3.T3.11.11.2.m1.1.1.cmml"><mn id="A3.T3.11.11.2.m1.1.1.2" xref="A3.T3.11.11.2.m1.1.1.2.cmml">1</mn><mo id="A3.T3.11.11.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.11.11.2.m1.1.1.1.cmml">×</mo><msup id="A3.T3.11.11.2.m1.1.1.3" xref="A3.T3.11.11.2.m1.1.1.3.cmml"><mn id="A3.T3.11.11.2.m1.1.1.3.2" xref="A3.T3.11.11.2.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.11.11.2.m1.1.1.3.3" xref="A3.T3.11.11.2.m1.1.1.3.3.cmml"><mo id="A3.T3.11.11.2.m1.1.1.3.3a" xref="A3.T3.11.11.2.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.11.11.2.m1.1.1.3.3.2" xref="A3.T3.11.11.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.11.11.2.m1.1b"><apply id="A3.T3.11.11.2.m1.1.1.cmml" xref="A3.T3.11.11.2.m1.1.1"><times id="A3.T3.11.11.2.m1.1.1.1.cmml" xref="A3.T3.11.11.2.m1.1.1.1"></times><cn id="A3.T3.11.11.2.m1.1.1.2.cmml" type="integer" xref="A3.T3.11.11.2.m1.1.1.2">1</cn><apply id="A3.T3.11.11.2.m1.1.1.3.cmml" xref="A3.T3.11.11.2.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.11.11.2.m1.1.1.3.1.cmml" xref="A3.T3.11.11.2.m1.1.1.3">superscript</csymbol><cn id="A3.T3.11.11.2.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.11.11.2.m1.1.1.3.2">10</cn><apply id="A3.T3.11.11.2.m1.1.1.3.3.cmml" xref="A3.T3.11.11.2.m1.1.1.3.3"><minus id="A3.T3.11.11.2.m1.1.1.3.3.1.cmml" xref="A3.T3.11.11.2.m1.1.1.3.3"></minus><cn id="A3.T3.11.11.2.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.11.11.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.11.11.2.m1.1c">1\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.11.11.2.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.12.12">
<td class="ltx_td ltx_align_center" id="A3.T3.12.12.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.12.12.1"><math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A3.T3.12.12.1.m1.1"><semantics id="A3.T3.12.12.1.m1.1a"><mrow id="A3.T3.12.12.1.m1.1.1" xref="A3.T3.12.12.1.m1.1.1.cmml"><mn id="A3.T3.12.12.1.m1.1.1.2" xref="A3.T3.12.12.1.m1.1.1.2.cmml">1</mn><mo id="A3.T3.12.12.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.12.12.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.12.12.1.m1.1.1.3" xref="A3.T3.12.12.1.m1.1.1.3.cmml"><mn id="A3.T3.12.12.1.m1.1.1.3.2" xref="A3.T3.12.12.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.12.12.1.m1.1.1.3.3" xref="A3.T3.12.12.1.m1.1.1.3.3.cmml"><mo id="A3.T3.12.12.1.m1.1.1.3.3a" xref="A3.T3.12.12.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.12.12.1.m1.1.1.3.3.2" xref="A3.T3.12.12.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.12.12.1.m1.1b"><apply id="A3.T3.12.12.1.m1.1.1.cmml" xref="A3.T3.12.12.1.m1.1.1"><times id="A3.T3.12.12.1.m1.1.1.1.cmml" xref="A3.T3.12.12.1.m1.1.1.1"></times><cn id="A3.T3.12.12.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.12.12.1.m1.1.1.2">1</cn><apply id="A3.T3.12.12.1.m1.1.1.3.cmml" xref="A3.T3.12.12.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.12.12.1.m1.1.1.3.1.cmml" xref="A3.T3.12.12.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.12.12.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.12.12.1.m1.1.1.3.2">10</cn><apply id="A3.T3.12.12.1.m1.1.1.3.3.cmml" xref="A3.T3.12.12.1.m1.1.1.3.3"><minus id="A3.T3.12.12.1.m1.1.1.3.3.1.cmml" xref="A3.T3.12.12.1.m1.1.1.3.3"></minus><cn id="A3.T3.12.12.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.12.12.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.12.12.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.12.12.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.13.13">
<td class="ltx_td ltx_align_center" id="A3.T3.13.13.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.13.13.1"><math alttext="1\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T3.13.13.1.m1.1"><semantics id="A3.T3.13.13.1.m1.1a"><mrow id="A3.T3.13.13.1.m1.1.1" xref="A3.T3.13.13.1.m1.1.1.cmml"><mn id="A3.T3.13.13.1.m1.1.1.2" xref="A3.T3.13.13.1.m1.1.1.2.cmml">1</mn><mo id="A3.T3.13.13.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.13.13.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.13.13.1.m1.1.1.3" xref="A3.T3.13.13.1.m1.1.1.3.cmml"><mn id="A3.T3.13.13.1.m1.1.1.3.2" xref="A3.T3.13.13.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.13.13.1.m1.1.1.3.3" xref="A3.T3.13.13.1.m1.1.1.3.3.cmml"><mo id="A3.T3.13.13.1.m1.1.1.3.3a" xref="A3.T3.13.13.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.13.13.1.m1.1.1.3.3.2" xref="A3.T3.13.13.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.13.13.1.m1.1b"><apply id="A3.T3.13.13.1.m1.1.1.cmml" xref="A3.T3.13.13.1.m1.1.1"><times id="A3.T3.13.13.1.m1.1.1.1.cmml" xref="A3.T3.13.13.1.m1.1.1.1"></times><cn id="A3.T3.13.13.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.13.13.1.m1.1.1.2">1</cn><apply id="A3.T3.13.13.1.m1.1.1.3.cmml" xref="A3.T3.13.13.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.13.13.1.m1.1.1.3.1.cmml" xref="A3.T3.13.13.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.13.13.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.13.13.1.m1.1.1.3.2">10</cn><apply id="A3.T3.13.13.1.m1.1.1.3.3.cmml" xref="A3.T3.13.13.1.m1.1.1.3.3"><minus id="A3.T3.13.13.1.m1.1.1.3.3.1.cmml" xref="A3.T3.13.13.1.m1.1.1.3.3"></minus><cn id="A3.T3.13.13.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.13.13.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.13.13.1.m1.1c">1\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.13.13.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.15.15">
<td class="ltx_td ltx_align_center" id="A3.T3.14.14.1" rowspan="3"><span class="ltx_text" id="A3.T3.14.14.1.1">Discriminator learning rate <math alttext="\beta" class="ltx_Math" display="inline" id="A3.T3.14.14.1.1.m1.1"><semantics id="A3.T3.14.14.1.1.m1.1a"><mi id="A3.T3.14.14.1.1.m1.1.1" xref="A3.T3.14.14.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A3.T3.14.14.1.1.m1.1b"><ci id="A3.T3.14.14.1.1.m1.1.1.cmml" xref="A3.T3.14.14.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.14.14.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A3.T3.14.14.1.1.m1.1d">italic_β</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="A3.T3.15.15.3">Hypergrid</td>
<td class="ltx_td ltx_align_center" id="A3.T3.15.15.2"><math alttext="3\times 10^{-5}" class="ltx_Math" display="inline" id="A3.T3.15.15.2.m1.1"><semantics id="A3.T3.15.15.2.m1.1a"><mrow id="A3.T3.15.15.2.m1.1.1" xref="A3.T3.15.15.2.m1.1.1.cmml"><mn id="A3.T3.15.15.2.m1.1.1.2" xref="A3.T3.15.15.2.m1.1.1.2.cmml">3</mn><mo id="A3.T3.15.15.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.15.15.2.m1.1.1.1.cmml">×</mo><msup id="A3.T3.15.15.2.m1.1.1.3" xref="A3.T3.15.15.2.m1.1.1.3.cmml"><mn id="A3.T3.15.15.2.m1.1.1.3.2" xref="A3.T3.15.15.2.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.15.15.2.m1.1.1.3.3" xref="A3.T3.15.15.2.m1.1.1.3.3.cmml"><mo id="A3.T3.15.15.2.m1.1.1.3.3a" xref="A3.T3.15.15.2.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.15.15.2.m1.1.1.3.3.2" xref="A3.T3.15.15.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.15.15.2.m1.1b"><apply id="A3.T3.15.15.2.m1.1.1.cmml" xref="A3.T3.15.15.2.m1.1.1"><times id="A3.T3.15.15.2.m1.1.1.1.cmml" xref="A3.T3.15.15.2.m1.1.1.1"></times><cn id="A3.T3.15.15.2.m1.1.1.2.cmml" type="integer" xref="A3.T3.15.15.2.m1.1.1.2">3</cn><apply id="A3.T3.15.15.2.m1.1.1.3.cmml" xref="A3.T3.15.15.2.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.15.15.2.m1.1.1.3.1.cmml" xref="A3.T3.15.15.2.m1.1.1.3">superscript</csymbol><cn id="A3.T3.15.15.2.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.15.15.2.m1.1.1.3.2">10</cn><apply id="A3.T3.15.15.2.m1.1.1.3.3.cmml" xref="A3.T3.15.15.2.m1.1.1.3.3"><minus id="A3.T3.15.15.2.m1.1.1.3.3.1.cmml" xref="A3.T3.15.15.2.m1.1.1.3.3"></minus><cn id="A3.T3.15.15.2.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.15.15.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.15.15.2.m1.1c">3\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.15.15.2.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.16.16">
<td class="ltx_td ltx_align_center" id="A3.T3.16.16.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.16.16.1"><math alttext="3\times 10^{-4}" class="ltx_Math" display="inline" id="A3.T3.16.16.1.m1.1"><semantics id="A3.T3.16.16.1.m1.1a"><mrow id="A3.T3.16.16.1.m1.1.1" xref="A3.T3.16.16.1.m1.1.1.cmml"><mn id="A3.T3.16.16.1.m1.1.1.2" xref="A3.T3.16.16.1.m1.1.1.2.cmml">3</mn><mo id="A3.T3.16.16.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.16.16.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.16.16.1.m1.1.1.3" xref="A3.T3.16.16.1.m1.1.1.3.cmml"><mn id="A3.T3.16.16.1.m1.1.1.3.2" xref="A3.T3.16.16.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.16.16.1.m1.1.1.3.3" xref="A3.T3.16.16.1.m1.1.1.3.3.cmml"><mo id="A3.T3.16.16.1.m1.1.1.3.3a" xref="A3.T3.16.16.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.16.16.1.m1.1.1.3.3.2" xref="A3.T3.16.16.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.16.16.1.m1.1b"><apply id="A3.T3.16.16.1.m1.1.1.cmml" xref="A3.T3.16.16.1.m1.1.1"><times id="A3.T3.16.16.1.m1.1.1.1.cmml" xref="A3.T3.16.16.1.m1.1.1.1"></times><cn id="A3.T3.16.16.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.16.16.1.m1.1.1.2">3</cn><apply id="A3.T3.16.16.1.m1.1.1.3.cmml" xref="A3.T3.16.16.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.16.16.1.m1.1.1.3.1.cmml" xref="A3.T3.16.16.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.16.16.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.16.16.1.m1.1.1.3.2">10</cn><apply id="A3.T3.16.16.1.m1.1.1.3.3.cmml" xref="A3.T3.16.16.1.m1.1.1.3.3"><minus id="A3.T3.16.16.1.m1.1.1.3.3.1.cmml" xref="A3.T3.16.16.1.m1.1.1.3.3"></minus><cn id="A3.T3.16.16.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.16.16.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.16.16.1.m1.1c">3\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.16.16.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.17.17">
<td class="ltx_td ltx_align_center" id="A3.T3.17.17.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.17.17.1"><math alttext="3\times 10^{-3}" class="ltx_Math" display="inline" id="A3.T3.17.17.1.m1.1"><semantics id="A3.T3.17.17.1.m1.1a"><mrow id="A3.T3.17.17.1.m1.1.1" xref="A3.T3.17.17.1.m1.1.1.cmml"><mn id="A3.T3.17.17.1.m1.1.1.2" xref="A3.T3.17.17.1.m1.1.1.2.cmml">3</mn><mo id="A3.T3.17.17.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T3.17.17.1.m1.1.1.1.cmml">×</mo><msup id="A3.T3.17.17.1.m1.1.1.3" xref="A3.T3.17.17.1.m1.1.1.3.cmml"><mn id="A3.T3.17.17.1.m1.1.1.3.2" xref="A3.T3.17.17.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T3.17.17.1.m1.1.1.3.3" xref="A3.T3.17.17.1.m1.1.1.3.3.cmml"><mo id="A3.T3.17.17.1.m1.1.1.3.3a" xref="A3.T3.17.17.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T3.17.17.1.m1.1.1.3.3.2" xref="A3.T3.17.17.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T3.17.17.1.m1.1b"><apply id="A3.T3.17.17.1.m1.1.1.cmml" xref="A3.T3.17.17.1.m1.1.1"><times id="A3.T3.17.17.1.m1.1.1.1.cmml" xref="A3.T3.17.17.1.m1.1.1.1"></times><cn id="A3.T3.17.17.1.m1.1.1.2.cmml" type="integer" xref="A3.T3.17.17.1.m1.1.1.2">3</cn><apply id="A3.T3.17.17.1.m1.1.1.3.cmml" xref="A3.T3.17.17.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T3.17.17.1.m1.1.1.3.1.cmml" xref="A3.T3.17.17.1.m1.1.1.3">superscript</csymbol><cn id="A3.T3.17.17.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T3.17.17.1.m1.1.1.3.2">10</cn><apply id="A3.T3.17.17.1.m1.1.1.3.3.cmml" xref="A3.T3.17.17.1.m1.1.1.3.3"><minus id="A3.T3.17.17.1.m1.1.1.3.3.1.cmml" xref="A3.T3.17.17.1.m1.1.1.3.3"></minus><cn id="A3.T3.17.17.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T3.17.17.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.17.17.1.m1.1c">3\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.T3.17.17.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.18.18">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.18.18.2" rowspan="6"><span class="ltx_text" id="A3.T3.18.18.2.1">COFlowNet</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.18.18.3" rowspan="3"><span class="ltx_text" id="A3.T3.18.18.3.1">Regularizing coef. 1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.18.18.4">Hypergrid</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.18.18.1"><math alttext="1.0" class="ltx_Math" display="inline" id="A3.T3.18.18.1.m1.1"><semantics id="A3.T3.18.18.1.m1.1a"><mn id="A3.T3.18.18.1.m1.1.1" xref="A3.T3.18.18.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.18.18.1.m1.1b"><cn id="A3.T3.18.18.1.m1.1.1.cmml" type="float" xref="A3.T3.18.18.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.18.18.1.m1.1c">1.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.18.18.1.m1.1d">1.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.19.19">
<td class="ltx_td ltx_align_center" id="A3.T3.19.19.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.19.19.1"><math alttext="1.0" class="ltx_Math" display="inline" id="A3.T3.19.19.1.m1.1"><semantics id="A3.T3.19.19.1.m1.1a"><mn id="A3.T3.19.19.1.m1.1.1" xref="A3.T3.19.19.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.19.19.1.m1.1b"><cn id="A3.T3.19.19.1.m1.1.1.cmml" type="float" xref="A3.T3.19.19.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.19.19.1.m1.1c">1.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.19.19.1.m1.1d">1.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.25.28.3">
<td class="ltx_td ltx_align_center" id="A3.T3.25.28.3.1">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.25.28.3.2">/</td>
</tr>
<tr class="ltx_tr" id="A3.T3.20.20">
<td class="ltx_td ltx_align_center" id="A3.T3.20.20.2" rowspan="3"><span class="ltx_text" id="A3.T3.20.20.2.1">Regularizing coef. 2</span></td>
<td class="ltx_td ltx_align_center" id="A3.T3.20.20.3">Hypergrid</td>
<td class="ltx_td ltx_align_center" id="A3.T3.20.20.1"><math alttext="1.0" class="ltx_Math" display="inline" id="A3.T3.20.20.1.m1.1"><semantics id="A3.T3.20.20.1.m1.1a"><mn id="A3.T3.20.20.1.m1.1.1" xref="A3.T3.20.20.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.20.20.1.m1.1b"><cn id="A3.T3.20.20.1.m1.1.1.cmml" type="float" xref="A3.T3.20.20.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.20.20.1.m1.1c">1.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.20.20.1.m1.1d">1.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.21.21">
<td class="ltx_td ltx_align_center" id="A3.T3.21.21.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.21.21.1"><math alttext="10.0" class="ltx_Math" display="inline" id="A3.T3.21.21.1.m1.1"><semantics id="A3.T3.21.21.1.m1.1a"><mn id="A3.T3.21.21.1.m1.1.1" xref="A3.T3.21.21.1.m1.1.1.cmml">10.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.21.21.1.m1.1b"><cn id="A3.T3.21.21.1.m1.1.1.cmml" type="float" xref="A3.T3.21.21.1.m1.1.1">10.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.21.21.1.m1.1c">10.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.21.21.1.m1.1d">10.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.22.22">
<td class="ltx_td ltx_align_center" id="A3.T3.22.22.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.22.22.1"><math alttext="25.0" class="ltx_Math" display="inline" id="A3.T3.22.22.1.m1.1"><semantics id="A3.T3.22.22.1.m1.1a"><mn id="A3.T3.22.22.1.m1.1.1" xref="A3.T3.22.22.1.m1.1.1.cmml">25.0</mn><annotation-xml encoding="MathML-Content" id="A3.T3.22.22.1.m1.1b"><cn id="A3.T3.22.22.1.m1.1.1.cmml" type="float" xref="A3.T3.22.22.1.m1.1.1">25.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.22.22.1.m1.1c">25.0</annotation><annotation encoding="application/x-llamapun" id="A3.T3.22.22.1.m1.1d">25.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.23.23">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.23.23.2" rowspan="3"><span class="ltx_text" id="A3.T3.23.23.2.1">IQL</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.23.23.3" rowspan="3"><span class="ltx_text" id="A3.T3.23.23.3.1">Expectile</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.23.23.4">Hypergrid</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T3.23.23.1"><math alttext="0.9" class="ltx_Math" display="inline" id="A3.T3.23.23.1.m1.1"><semantics id="A3.T3.23.23.1.m1.1a"><mn id="A3.T3.23.23.1.m1.1.1" xref="A3.T3.23.23.1.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A3.T3.23.23.1.m1.1b"><cn id="A3.T3.23.23.1.m1.1.1.cmml" type="float" xref="A3.T3.23.23.1.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.23.23.1.m1.1c">0.9</annotation><annotation encoding="application/x-llamapun" id="A3.T3.23.23.1.m1.1d">0.9</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.24.24">
<td class="ltx_td ltx_align_center" id="A3.T3.24.24.2">Molecule Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.24.24.1"><math alttext="0.9" class="ltx_Math" display="inline" id="A3.T3.24.24.1.m1.1"><semantics id="A3.T3.24.24.1.m1.1a"><mn id="A3.T3.24.24.1.m1.1.1" xref="A3.T3.24.24.1.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A3.T3.24.24.1.m1.1b"><cn id="A3.T3.24.24.1.m1.1.1.cmml" type="float" xref="A3.T3.24.24.1.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.24.24.1.m1.1c">0.9</annotation><annotation encoding="application/x-llamapun" id="A3.T3.24.24.1.m1.1d">0.9</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.25.25">
<td class="ltx_td ltx_align_center" id="A3.T3.25.25.2">Biosequence Design</td>
<td class="ltx_td ltx_align_center" id="A3.T3.25.25.1"><math alttext="0.8" class="ltx_Math" display="inline" id="A3.T3.25.25.1.m1.1"><semantics id="A3.T3.25.25.1.m1.1a"><mn id="A3.T3.25.25.1.m1.1.1" xref="A3.T3.25.25.1.m1.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="A3.T3.25.25.1.m1.1b"><cn id="A3.T3.25.25.1.m1.1.1.cmml" type="float" xref="A3.T3.25.25.1.m1.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.25.25.1.m1.1c">0.8</annotation><annotation encoding="application/x-llamapun" id="A3.T3.25.25.1.m1.1d">0.8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T3.25.29.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T3.25.29.4.1">BC</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T3.25.29.4.2">Loss</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T3.25.29.4.3">All</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T3.25.29.4.4">Cross Entropy Loss</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional experimental results</h2>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Algorithm trained on extremely limited data</h3>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.3">To further assess the robustness of TD-GFN under extreme data scarcity, we conduct experiments on the <math alttext="H=8" class="ltx_Math" display="inline" id="A4.SS1.p1.1.m1.1"><semantics id="A4.SS1.p1.1.m1.1a"><mrow id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml"><mi id="A4.SS1.p1.1.m1.1.1.2" xref="A4.SS1.p1.1.m1.1.1.2.cmml">H</mi><mo id="A4.SS1.p1.1.m1.1.1.1" xref="A4.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.1.m1.1.1.3" xref="A4.SS1.p1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><apply id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1"><eq id="A4.SS1.p1.1.m1.1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1.1"></eq><ci id="A4.SS1.p1.1.m1.1.1.2.cmml" xref="A4.SS1.p1.1.m1.1.1.2">𝐻</ci><cn id="A4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS1.p1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">H=8</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.1.m1.1d">italic_H = 8</annotation></semantics></math>, <math alttext="D=4" class="ltx_Math" display="inline" id="A4.SS1.p1.2.m2.1"><semantics id="A4.SS1.p1.2.m2.1a"><mrow id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml"><mi id="A4.SS1.p1.2.m2.1.1.2" xref="A4.SS1.p1.2.m2.1.1.2.cmml">D</mi><mo id="A4.SS1.p1.2.m2.1.1.1" xref="A4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.2.m2.1.1.3" xref="A4.SS1.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><apply id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1"><eq id="A4.SS1.p1.2.m2.1.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1.1"></eq><ci id="A4.SS1.p1.2.m2.1.1.2.cmml" xref="A4.SS1.p1.2.m2.1.1.2">𝐷</ci><cn id="A4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A4.SS1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">D=4</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.2.m2.1d">italic_D = 4</annotation></semantics></math> Hypergrid environment using only <math alttext="30" class="ltx_Math" display="inline" id="A4.SS1.p1.3.m3.1"><semantics id="A4.SS1.p1.3.m3.1a"><mn id="A4.SS1.p1.3.m3.1.1" xref="A4.SS1.p1.3.m3.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m3.1b"><cn id="A4.SS1.p1.3.m3.1.1.cmml" type="integer" xref="A4.SS1.p1.3.m3.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m3.1c">30</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.3.m3.1d">30</annotation></semantics></math> training trajectories, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F7" title="Figure 7 ‣ D.1 Algorithm trained on extremely limited data ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">7</span></a>. In this setting, algorithms are prone to overfitting due to the limited data. For example, both COFlowNet and CQL exhibit non-monotonic trends in <span class="ltx_text ltx_font_italic" id="A4.SS1.p1.3.1">Empirical L1 Error</span>, initially decreasing but later increasing during training, indicating overfitting to the limited known regions.</p>
</div>
<div class="ltx_para" id="A4.SS1.p2">
<p class="ltx_p" id="A4.SS1.p2.1">In contrast, TD-GFN consistently converges toward the target distribution throughout training. Owing to the strong generalization capabilities of the learned edge rewards, it avoids overfitting to the dataset and quickly identifies high-reward modes. These results highlight TD-GFN’s ability to maintain a favorable balance between exploration and exploitation, even under severely constrained data conditions.</p>
</div>
<figure class="ltx_figure" id="A4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="A4.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Performance comparison on the <math alttext="8^{4}" class="ltx_Math" display="inline" id="A4.F7.3.m1.1"><semantics id="A4.F7.3.m1.1b"><msup id="A4.F7.3.m1.1.1" xref="A4.F7.3.m1.1.1.cmml"><mn id="A4.F7.3.m1.1.1.2" xref="A4.F7.3.m1.1.1.2.cmml">8</mn><mn id="A4.F7.3.m1.1.1.3" xref="A4.F7.3.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A4.F7.3.m1.1c"><apply id="A4.F7.3.m1.1.1.cmml" xref="A4.F7.3.m1.1.1"><csymbol cd="ambiguous" id="A4.F7.3.m1.1.1.1.cmml" xref="A4.F7.3.m1.1.1">superscript</csymbol><cn id="A4.F7.3.m1.1.1.2.cmml" type="integer" xref="A4.F7.3.m1.1.1.2">8</cn><cn id="A4.F7.3.m1.1.1.3.cmml" type="integer" xref="A4.F7.3.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.3.m1.1d">8^{4}</annotation><annotation encoding="application/x-llamapun" id="A4.F7.3.m1.1e">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid task using <math alttext="30" class="ltx_Math" display="inline" id="A4.F7.4.m2.1"><semantics id="A4.F7.4.m2.1b"><mn id="A4.F7.4.m2.1.1" xref="A4.F7.4.m2.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A4.F7.4.m2.1c"><cn id="A4.F7.4.m2.1.1.cmml" type="integer" xref="A4.F7.4.m2.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.F7.4.m2.1d">30</annotation><annotation encoding="application/x-llamapun" id="A4.F7.4.m2.1e">30</annotation></semantics></math> trajectories from the <span class="ltx_text ltx_font_italic" id="A4.F7.7.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.F7.8.2">Mixed</span> datasets.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Algorithm Visualization on Hypergrid</h3>
<div class="ltx_para" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.3">We visualize the behavior of out proposed TD-GFN in an <math alttext="8\times 8" class="ltx_Math" display="inline" id="A4.SS2.p1.1.m1.1"><semantics id="A4.SS2.p1.1.m1.1a"><mrow id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml"><mn id="A4.SS2.p1.1.m1.1.1.2" xref="A4.SS2.p1.1.m1.1.1.2.cmml">8</mn><mo id="A4.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A4.SS2.p1.1.m1.1.1.3" xref="A4.SS2.p1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><apply id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1"><times id="A4.SS2.p1.1.m1.1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1.1"></times><cn id="A4.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.SS2.p1.1.m1.1.1.2">8</cn><cn id="A4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS2.p1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">8\times 8</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.1.m1.1d">8 × 8</annotation></semantics></math> Hypergrid environment using a dataset comprising 400 transitions, constructed by combining trajectories collected from an expert policy (<math alttext="50\%" class="ltx_Math" display="inline" id="A4.SS2.p1.2.m2.1"><semantics id="A4.SS2.p1.2.m2.1a"><mrow id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml"><mn id="A4.SS2.p1.2.m2.1.1.2" xref="A4.SS2.p1.2.m2.1.1.2.cmml">50</mn><mo id="A4.SS2.p1.2.m2.1.1.1" xref="A4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><apply id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="A4.SS2.p1.2.m2.1.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn id="A4.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="A4.SS2.p1.2.m2.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.2.m2.1d">50 %</annotation></semantics></math>) and a random policy (<math alttext="50\%" class="ltx_Math" display="inline" id="A4.SS2.p1.3.m3.1"><semantics id="A4.SS2.p1.3.m3.1a"><mrow id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml"><mn id="A4.SS2.p1.3.m3.1.1.2" xref="A4.SS2.p1.3.m3.1.1.2.cmml">50</mn><mo id="A4.SS2.p1.3.m3.1.1.1" xref="A4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><apply id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="A4.SS2.p1.3.m3.1.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn id="A4.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="A4.SS2.p1.3.m3.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.3.m3.1d">50 %</annotation></semantics></math>). The edge rewards learned via IRL using Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg2" title="Algorithm 2 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">2</span></a> are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F8" title="Figure 8 ‣ D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">8</span></a>(b). Compared to the raw edge visitation frequencies from the dataset (Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F8" title="Figure 8 ‣ D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">8</span></a>(a)), the learned edge rewards place greater emphasis on transitions that lead toward high-reward modes.</p>
</div>
<div class="ltx_para" id="A4.SS2.p2">
<p class="ltx_p" id="A4.SS2.p2.1">Notably, the learned edge rewards exhibit strong generalization: they assign meaningful values even to transitions that do not appear in the dataset (e.g., those in the topmost row), thereby guiding the policy toward out-of-distribution high-reward states, such as the modes in the top-right corner.</p>
</div>
<div class="ltx_para" id="A4.SS2.p3">
<p class="ltx_p" id="A4.SS2.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F8" title="Figure 8 ‣ D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">8</span></a>(c) shows the pruned DAG based on the edge rewards in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F8" title="Figure 8 ‣ D.2 Algorithm Visualization on Hypergrid ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">8</span></a>(b). As illustrated, the resulting subgraph not only removes many transitions leading to low-reward regions—despite their presence in the dataset—but also constructs clear pathways toward high-reward modes, even when such paths were never encountered during data collection.</p>
</div>
<figure class="ltx_figure" id="A4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="606" id="A4.F8.g1" src="x8.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Visualization of TD-GFN in the <math alttext="8\times 8" class="ltx_Math" display="inline" id="A4.F8.5.m1.1"><semantics id="A4.F8.5.m1.1b"><mrow id="A4.F8.5.m1.1.1" xref="A4.F8.5.m1.1.1.cmml"><mn id="A4.F8.5.m1.1.1.2" xref="A4.F8.5.m1.1.1.2.cmml">8</mn><mo id="A4.F8.5.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.F8.5.m1.1.1.1.cmml">×</mo><mn id="A4.F8.5.m1.1.1.3" xref="A4.F8.5.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F8.5.m1.1c"><apply id="A4.F8.5.m1.1.1.cmml" xref="A4.F8.5.m1.1.1"><times id="A4.F8.5.m1.1.1.1.cmml" xref="A4.F8.5.m1.1.1.1"></times><cn id="A4.F8.5.m1.1.1.2.cmml" type="integer" xref="A4.F8.5.m1.1.1.2">8</cn><cn id="A4.F8.5.m1.1.1.3.cmml" type="integer" xref="A4.F8.5.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F8.5.m1.1d">8\times 8</annotation><annotation encoding="application/x-llamapun" id="A4.F8.5.m1.1e">8 × 8</annotation></semantics></math> Hypergrid environment. (a) Normalized edge visitation frequencies in a dataset composed of <math alttext="400" class="ltx_Math" display="inline" id="A4.F8.6.m2.1"><semantics id="A4.F8.6.m2.1b"><mn id="A4.F8.6.m2.1.1" xref="A4.F8.6.m2.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="A4.F8.6.m2.1c"><cn id="A4.F8.6.m2.1.1.cmml" type="integer" xref="A4.F8.6.m2.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.F8.6.m2.1d">400</annotation><annotation encoding="application/x-llamapun" id="A4.F8.6.m2.1e">400</annotation></semantics></math> transitions obtained by combining trajectories collected separately from an expert policy (<math alttext="50\%" class="ltx_Math" display="inline" id="A4.F8.7.m3.1"><semantics id="A4.F8.7.m3.1b"><mrow id="A4.F8.7.m3.1.1" xref="A4.F8.7.m3.1.1.cmml"><mn id="A4.F8.7.m3.1.1.2" xref="A4.F8.7.m3.1.1.2.cmml">50</mn><mo id="A4.F8.7.m3.1.1.1" xref="A4.F8.7.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F8.7.m3.1c"><apply id="A4.F8.7.m3.1.1.cmml" xref="A4.F8.7.m3.1.1"><csymbol cd="latexml" id="A4.F8.7.m3.1.1.1.cmml" xref="A4.F8.7.m3.1.1.1">percent</csymbol><cn id="A4.F8.7.m3.1.1.2.cmml" type="integer" xref="A4.F8.7.m3.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F8.7.m3.1d">50\%</annotation><annotation encoding="application/x-llamapun" id="A4.F8.7.m3.1e">50 %</annotation></semantics></math>) and a random policy (<math alttext="50\%" class="ltx_Math" display="inline" id="A4.F8.8.m4.1"><semantics id="A4.F8.8.m4.1b"><mrow id="A4.F8.8.m4.1.1" xref="A4.F8.8.m4.1.1.cmml"><mn id="A4.F8.8.m4.1.1.2" xref="A4.F8.8.m4.1.1.2.cmml">50</mn><mo id="A4.F8.8.m4.1.1.1" xref="A4.F8.8.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F8.8.m4.1c"><apply id="A4.F8.8.m4.1.1.cmml" xref="A4.F8.8.m4.1.1"><csymbol cd="latexml" id="A4.F8.8.m4.1.1.1.cmml" xref="A4.F8.8.m4.1.1.1">percent</csymbol><cn id="A4.F8.8.m4.1.1.2.cmml" type="integer" xref="A4.F8.8.m4.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F8.8.m4.1d">50\%</annotation><annotation encoding="application/x-llamapun" id="A4.F8.8.m4.1e">50 %</annotation></semantics></math>); (b) Edge rewards learned via inverse reinforcement learning (IRL); (c) The pruned sub-DAG consisting of high-reward edges (highlighted in yellow) based on edge rewards; (d) The sampling probability of edges under backward policy induced by edge rewards and object rewards.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Time consumption and resource usage</h3>
<div class="ltx_para" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">For the Molecule Design task (Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS3" title="4.3 Molecule Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4.3</span></a>), all algorithms are trained on an NVIDIA Tesla A100 80GB GPU. We report preprocessing time, per-epoch training time, total convergence time, and peak GPU memory usage for various GFlowNet training methods in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.T4" title="Table 4 ‣ D.3 Time consumption and resource usage ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="A4.SS3.p2">
<p class="ltx_p" id="A4.SS3.p2.1">For Proxy-GFN, preprocessing refers to training the proxy model. For COFlowNet, it involves constructing a dictionary that indexes all child nodes from the dataset for each state. For TD-GFN, preprocessing includes both learning the edge rewards and pruning the environment DAG, corresponding to Phase 1 and Phase 2 in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg1" title="Algorithm 1 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Training time and GPU memory usage comparison across GFlowNet variants on the Molecule Design task.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.2.1">Preprocessing Time</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.3.1">Epoch Time</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.4.1">Convergence Time</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.5.1">GPU Memory</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.1.2.1.1">Proxy-GFN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.1.2.1.2">10h</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.1.2.1.3">4.82s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.1.2.1.4">4h</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T4.1.2.1.5">22.88G</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.3.2">
<td class="ltx_td ltx_align_center" id="A4.T4.1.3.2.1">Dataset-GFN</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.3.2.2">/</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.3.2.3"><span class="ltx_text ltx_font_bold" id="A4.T4.1.3.2.3.1">0.56s</span></td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.3.2.4">0.47h</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.3.2.5">10.08G</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.4.3">
<td class="ltx_td ltx_align_center" id="A4.T4.1.4.3.1">FM-COFlowNet</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.4.3.2">2h</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.4.3.3">0.76s</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.4.3.4">0.63h</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.4.3.5">12.81G</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.5.4">
<td class="ltx_td ltx_align_center" id="A4.T4.1.5.4.1">QM-COFlowNet</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.5.4.2">2h</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.5.4.3">1.16s</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.5.4.4">0.71h</td>
<td class="ltx_td ltx_align_center" id="A4.T4.1.5.4.5">63.80G</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.1.6.5.1">TD-GFN (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.1.6.5.2"><span class="ltx_text ltx_font_bold" id="A4.T4.1.6.5.2.1">0.1h</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.1.6.5.3"><span class="ltx_text ltx_font_bold" id="A4.T4.1.6.5.3.1">0.59s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.1.6.5.4"><span class="ltx_text ltx_font_bold" id="A4.T4.1.6.5.4.1">0.20h</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.1.6.5.5">12.01G</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A4.SS3.p3">
<p class="ltx_p" id="A4.SS3.p3.1">As shown, by predicting pruned edges through a single forward pass of a neural network—rather than querying from a pre-constructed dictionary—TD-GFN significantly reduces preprocessing time and incurs minimal computational overhead during training. Furthermore, owing to its rapid convergence (as demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.T1" title="Table 1 ‣ 4.3 Molecule Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>), TD-GFN can learn a high-performing GFlowNet policy in under 30 minutes, highlighting its strong time efficiency.</p>
</div>
<div class="ltx_para" id="A4.SS3.p4">
<p class="ltx_p" id="A4.SS3.p4.1">Although the edge reward learning component introduces a modest computational cost, it remains negligible compared to the overhead of more complex mechanisms such as quantile matching. Despite this, TD-GFN outperforms methods enhanced with quantile-based techniques, underscoring its effectiveness and scalability.</p>
</div>
</section>
<section class="ltx_subsection" id="A4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Ablation Study</h3>
<div class="ltx_para" id="A4.SS4.p1">
<p class="ltx_p" id="A4.SS4.p1.1">In this section, we conduct ablation experiments on the <math alttext="8^{4}" class="ltx_Math" display="inline" id="A4.SS4.p1.1.m1.1"><semantics id="A4.SS4.p1.1.m1.1a"><msup id="A4.SS4.p1.1.m1.1.1" xref="A4.SS4.p1.1.m1.1.1.cmml"><mn id="A4.SS4.p1.1.m1.1.1.2" xref="A4.SS4.p1.1.m1.1.1.2.cmml">8</mn><mn id="A4.SS4.p1.1.m1.1.1.3" xref="A4.SS4.p1.1.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A4.SS4.p1.1.m1.1b"><apply id="A4.SS4.p1.1.m1.1.1.cmml" xref="A4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS4.p1.1.m1.1.1.1.cmml" xref="A4.SS4.p1.1.m1.1.1">superscript</csymbol><cn id="A4.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.SS4.p1.1.m1.1.1.2">8</cn><cn id="A4.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS4.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS4.p1.1.m1.1c">8^{4}</annotation><annotation encoding="application/x-llamapun" id="A4.SS4.p1.1.m1.1d">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid task to evaluate the contribution of individual components within the proposed TD-GFN framework.</p>
</div>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Dataset Rebalancing.</h4>
<div class="ltx_para" id="A4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px1.p1.1">As described in Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S3.SS1" title="3.1 Edge rewards extraction via IRL ‣ 3 Method ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we perform dataset rebalancing to adjust the offline data distribution to better approximate that of an expert policy. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F9" title="Figure 9 ‣ Dataset Rebalancing. ‣ D.4 Ablation Study ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">9</span></a>, we evaluate TD-GFN with and without rebalancing on both the <span class="ltx_text ltx_font_italic" id="A4.SS4.SSS0.Px1.p1.1.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.SS4.SSS0.Px1.p1.1.2">Bad</span> datasets. For additional comparison, we also train the offline GFlowNet method COFlowNet on the rebalanced datasets.</p>
</div>
<div class="ltx_para" id="A4.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="A4.SS4.SSS0.Px1.p2.1">The results show that rebalancing the <span class="ltx_text ltx_font_italic" id="A4.SS4.SSS0.Px1.p2.1.1">Expert</span> dataset does not degrade policy learning, despite the mild distortion introduced to the original data distribution. More importantly, rebalancing significantly improves policy performance when the dataset is collected under a behavior policy that diverges substantially from the expert.</p>
</div>
<figure class="ltx_figure" id="A4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="A4.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Performance comparison with and without dataset rebalancing on <span class="ltx_text ltx_font_italic" id="A4.F9.5.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.F9.6.2">Bad</span> datasets, each consisting of <math alttext="1,500" class="ltx_Math" display="inline" id="A4.F9.2.m1.2"><semantics id="A4.F9.2.m1.2b"><mrow id="A4.F9.2.m1.2.3.2" xref="A4.F9.2.m1.2.3.1.cmml"><mn id="A4.F9.2.m1.1.1" xref="A4.F9.2.m1.1.1.cmml">1</mn><mo id="A4.F9.2.m1.2.3.2.1" xref="A4.F9.2.m1.2.3.1.cmml">,</mo><mn id="A4.F9.2.m1.2.2" xref="A4.F9.2.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F9.2.m1.2c"><list id="A4.F9.2.m1.2.3.1.cmml" xref="A4.F9.2.m1.2.3.2"><cn id="A4.F9.2.m1.1.1.cmml" type="integer" xref="A4.F9.2.m1.1.1">1</cn><cn id="A4.F9.2.m1.2.2.cmml" type="integer" xref="A4.F9.2.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.F9.2.m1.2d">1,500</annotation><annotation encoding="application/x-llamapun" id="A4.F9.2.m1.2e">1 , 500</annotation></semantics></math> trajectories.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A4.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Pruning and Backward Sampling.</h4>
<div class="ltx_para" id="A4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS4.SSS0.Px2.p1.1">To assess the individual impact of TD-GFN’s components, we conduct ablations on the <span class="ltx_text ltx_font_italic" id="A4.SS4.SSS0.Px2.p1.1.1">Mixed</span> dataset. We compare the full TD-GFN with three variants: (i) a baseline without DAG pruning; (ii) a dataset-pruned variant that removes all edges not observed in the dataset; and (iii) a backward sampling baseline in which trajectories are sampled uniformly in reverse from terminal nodes, without using learned edge rewards. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F10" title="Figure 10 ‣ Pruning and Backward Sampling. ‣ D.4 Ablation Study ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">10</span></a>, both the reward-guided pruning strategy and the prioritized backward sampling procedure are critical to the overall performance of TD-GFN.</p>
</div>
<figure class="ltx_figure" id="A4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="252" id="A4.F10.g1" src="x10.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Ablation study on the <span class="ltx_text ltx_font_italic" id="A4.F10.2.1">Mixed</span> dataset. We evaluate three TD-GFN variants: (i) no pruning; (ii) dataset-based pruning that removes unseen edges; and (iii) uniform backward sampling from terminal nodes. Each TD-GFN component proves essential for achieving optimal performance.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Orthogonality to Training Paradigms</h3>
<div class="ltx_para" id="A4.SS5.p1">
<p class="ltx_p" id="A4.SS5.p1.1">As shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#alg1" title="Algorithm 1 ‣ Appendix A Algorithm Pseudocode ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">1</span></a>, the improvements introduced by TD-GFN are orthogonal to the specific training paradigm employed after trajectory collection. While we adopt the Flow-Matching (FM) objective <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib1" title="">1</a>]</cite> in this work, our framework is also compatible with alternative GFlowNet training objectives—such as DB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib2" title="">2</a>]</cite>, TB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib42" title="">42</a>]</cite>, and SubTB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib48" title="">48</a>]</cite>—without requiring substantial modification.</p>
</div>
<div class="ltx_para" id="A4.SS5.p2">
<p class="ltx_p" id="A4.SS5.p2.1">Due to time and space constraints, we focus our empirical analysis on the integration of TD-GFN with offline RL methods and the quantile matching technique proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib38" title="">38</a>]</cite>.</p>
</div>
<section class="ltx_paragraph" id="A4.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Replacing Flow Matching with Offline RL Training</h4>
<div class="ltx_para" id="A4.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS5.SSS0.Px1.p1.1">Instead of using the standard flow-matching objective in GFlowNet training, we examine the effect of replacing it with the Conservative Q-Learning (CQL) objective from offline reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib35" title="">35</a>]</cite>, resulting in a variant we refer to as TD-CQL. We evaluate TD-CQL on both the <span class="ltx_text ltx_font_italic" id="A4.SS5.SSS0.Px1.p1.1.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.SS5.SSS0.Px1.p1.1.2">Mixed</span> datasets, each consisting of <math alttext="1,500" class="ltx_Math" display="inline" id="A4.SS5.SSS0.Px1.p1.1.m1.2"><semantics id="A4.SS5.SSS0.Px1.p1.1.m1.2a"><mrow id="A4.SS5.SSS0.Px1.p1.1.m1.2.3.2" xref="A4.SS5.SSS0.Px1.p1.1.m1.2.3.1.cmml"><mn id="A4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="A4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml">1</mn><mo id="A4.SS5.SSS0.Px1.p1.1.m1.2.3.2.1" xref="A4.SS5.SSS0.Px1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A4.SS5.SSS0.Px1.p1.1.m1.2.2" xref="A4.SS5.SSS0.Px1.p1.1.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS5.SSS0.Px1.p1.1.m1.2b"><list id="A4.SS5.SSS0.Px1.p1.1.m1.2.3.1.cmml" xref="A4.SS5.SSS0.Px1.p1.1.m1.2.3.2"><cn id="A4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="A4.SS5.SSS0.Px1.p1.1.m1.1.1">1</cn><cn id="A4.SS5.SSS0.Px1.p1.1.m1.2.2.cmml" type="integer" xref="A4.SS5.SSS0.Px1.p1.1.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.SSS0.Px1.p1.1.m1.2c">1,500</annotation><annotation encoding="application/x-llamapun" id="A4.SS5.SSS0.Px1.p1.1.m1.2d">1 , 500</annotation></semantics></math> trajectories. Results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F11" title="Figure 11 ‣ Replacing Flow Matching with Offline RL Training ‣ D.5 Orthogonality to Training Paradigms ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<div class="ltx_para" id="A4.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="A4.SS5.SSS0.Px1.p2.1">With training components inherited from TD-GFN, TD-CQL successfully discovers all modes using a comparable number of state visits and achieves an <span class="ltx_text ltx_font_italic" id="A4.SS5.SSS0.Px1.p2.1.1">Empirical L1 Error</span> below <math alttext="10^{-4}" class="ltx_Math" display="inline" id="A4.SS5.SSS0.Px1.p2.1.m1.1"><semantics id="A4.SS5.SSS0.Px1.p2.1.m1.1a"><msup id="A4.SS5.SSS0.Px1.p2.1.m1.1.1" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.2" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml">10</mn><mrow id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml"><mo id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3a" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml">−</mo><mn id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.2" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A4.SS5.SSS0.Px1.p2.1.m1.1b"><apply id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><cn id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml" type="integer" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.2">10</cn><apply id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3"><minus id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.1.cmml" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3"></minus><cn id="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.2.cmml" type="integer" xref="A4.SS5.SSS0.Px1.p2.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.SSS0.Px1.p2.1.m1.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A4.SS5.SSS0.Px1.p2.1.m1.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> with fewer visits than TD-GFN, demonstrating strong sample efficiency and early-stage accuracy in modeling the target distribution. However, beyond this point, the <span class="ltx_text ltx_font_italic" id="A4.SS5.SSS0.Px1.p2.1.2">Empirical L1 Error</span> increases, indicating a decline in distributional approximation quality. This degradation arises from the nature of the offline RL objective, which tends to overfit the policy toward only the highest-reward objects, thereby limiting its ability to accurately model the full reward distribution.</p>
</div>
<figure class="ltx_figure" id="A4.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="A4.F11.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Performance comparison of TD-CQL on the <span class="ltx_text ltx_font_italic" id="A4.F11.5.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.F11.6.2">Mixed</span> datasets, each consisting of <math alttext="1,500" class="ltx_Math" display="inline" id="A4.F11.2.m1.2"><semantics id="A4.F11.2.m1.2b"><mrow id="A4.F11.2.m1.2.3.2" xref="A4.F11.2.m1.2.3.1.cmml"><mn id="A4.F11.2.m1.1.1" xref="A4.F11.2.m1.1.1.cmml">1</mn><mo id="A4.F11.2.m1.2.3.2.1" xref="A4.F11.2.m1.2.3.1.cmml">,</mo><mn id="A4.F11.2.m1.2.2" xref="A4.F11.2.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F11.2.m1.2c"><list id="A4.F11.2.m1.2.3.1.cmml" xref="A4.F11.2.m1.2.3.2"><cn id="A4.F11.2.m1.1.1.cmml" type="integer" xref="A4.F11.2.m1.1.1">1</cn><cn id="A4.F11.2.m1.2.2.cmml" type="integer" xref="A4.F11.2.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.F11.2.m1.2d">1,500</annotation><annotation encoding="application/x-llamapun" id="A4.F11.2.m1.2e">1 , 500</annotation></semantics></math> trajectories.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A4.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Incorporating Quantile Matching</h4>
<div class="ltx_para" id="A4.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS5.SSS0.Px2.p1.1">Following the approach of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib22" title="">22</a>]</cite>, we augment TD-GFN with the quantile matching technique proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib38" title="">38</a>]</cite>, resulting in a variant referred to as QM-TD-GFN. We evaluate QM-TD-GFN on the Molecule Design task (Section <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#S4.SS3" title="4.3 Molecule Design ‣ 4 Experiments ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">4.3</span></a>) to assess its impact on the diversity of generated samples.</p>
</div>
<div class="ltx_para" id="A4.SS5.SSS0.Px2.p2">
<p class="ltx_p" id="A4.SS5.SSS0.Px2.p2.1">We observe that incorporating quantile matching into TD-GFN introduces significant training instability. This may be due to the pruned structure of the environment DAG, which reduces the need for a highly uncertain policy. Nevertheless, in cases where training remains stable, QM-TD-GFN is able to discover more high-reward modes than the original TD-GFN, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F12" title="Figure 12 ‣ Incorporating Quantile Matching ‣ D.5 Orthogonality to Training Paradigms ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">12</span></a>. These findings highlight the potential of quantile matching to enhance the diversity of generated molecules.</p>
</div>
<figure class="ltx_figure" id="A4.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="310" id="A4.F12.g1" src="x12.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Number of high-reward modes discovered by QM-TD-GFN compared to TD-GFN.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.6 </span>Discussion on Baseline Performance</h3>
<div class="ltx_para" id="A4.SS6.p1">
<p class="ltx_p" id="A4.SS6.p1.1">To gain deeper insight into the behavior of baseline methods, we analyze results on the Hypergrid task, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#A4.F13" title="Figure 13 ‣ D.6 Discussion on Baseline Performance ‣ Appendix D Additional experimental results ‣ Proxy-Free GFlowNet"><span class="ltx_text ltx_ref_tag">13</span></a>.</p>
</div>
<figure class="ltx_figure" id="A4.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="363" id="A4.F13.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Performance comparison on the <math alttext="8^{4}" class="ltx_Math" display="inline" id="A4.F13.4.m1.1"><semantics id="A4.F13.4.m1.1b"><msup id="A4.F13.4.m1.1.1" xref="A4.F13.4.m1.1.1.cmml"><mn id="A4.F13.4.m1.1.1.2" xref="A4.F13.4.m1.1.1.2.cmml">8</mn><mn id="A4.F13.4.m1.1.1.3" xref="A4.F13.4.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="A4.F13.4.m1.1c"><apply id="A4.F13.4.m1.1.1.cmml" xref="A4.F13.4.m1.1.1"><csymbol cd="ambiguous" id="A4.F13.4.m1.1.1.1.cmml" xref="A4.F13.4.m1.1.1">superscript</csymbol><cn id="A4.F13.4.m1.1.1.2.cmml" type="integer" xref="A4.F13.4.m1.1.1.2">8</cn><cn id="A4.F13.4.m1.1.1.3.cmml" type="integer" xref="A4.F13.4.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F13.4.m1.1d">8^{4}</annotation><annotation encoding="application/x-llamapun" id="A4.F13.4.m1.1e">8 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math> Hypergrid task. The top row uses <math alttext="1,500" class="ltx_Math" display="inline" id="A4.F13.5.m2.2"><semantics id="A4.F13.5.m2.2b"><mrow id="A4.F13.5.m2.2.3.2" xref="A4.F13.5.m2.2.3.1.cmml"><mn id="A4.F13.5.m2.1.1" xref="A4.F13.5.m2.1.1.cmml">1</mn><mo id="A4.F13.5.m2.2.3.2.1" xref="A4.F13.5.m2.2.3.1.cmml">,</mo><mn id="A4.F13.5.m2.2.2" xref="A4.F13.5.m2.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F13.5.m2.2c"><list id="A4.F13.5.m2.2.3.1.cmml" xref="A4.F13.5.m2.2.3.2"><cn id="A4.F13.5.m2.1.1.cmml" type="integer" xref="A4.F13.5.m2.1.1">1</cn><cn id="A4.F13.5.m2.2.2.cmml" type="integer" xref="A4.F13.5.m2.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.F13.5.m2.2d">1,500</annotation><annotation encoding="application/x-llamapun" id="A4.F13.5.m2.2e">1 , 500</annotation></semantics></math> trajectories from the <span class="ltx_text ltx_font_italic" id="A4.F13.9.1">Expert</span> and <span class="ltx_text ltx_font_italic" id="A4.F13.10.2">Mixed</span> datasets for policy training, while the bottom row uses only <math alttext="150" class="ltx_Math" display="inline" id="A4.F13.6.m3.1"><semantics id="A4.F13.6.m3.1b"><mn id="A4.F13.6.m3.1.1" xref="A4.F13.6.m3.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="A4.F13.6.m3.1c"><cn id="A4.F13.6.m3.1.1.cmml" type="integer" xref="A4.F13.6.m3.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.F13.6.m3.1d">150</annotation><annotation encoding="application/x-llamapun" id="A4.F13.6.m3.1e">150</annotation></semantics></math> trajectories.</figcaption>
</figure>
<div class="ltx_para" id="A4.SS6.p2">
<p class="ltx_p" id="A4.SS6.p2.1">Across datasets with varying levels of uncertainty, IQL excels at identifying high-reward modes. However, it also exhibits the highest <span class="ltx_text ltx_font_italic" id="A4.SS6.p2.1.1">Empirical L1 Error</span>, underscoring a core characteristic of offline reinforcement learning algorithms: their objective often prioritizes recovering the most rewarding trajectories over accurately modeling the full reward distribution.</p>
</div>
<div class="ltx_para" id="A4.SS6.p3">
<p class="ltx_p" id="A4.SS6.p3.1">Although CQL is also an offline RL algorithm, its performance differs from IQL due to a distinct training paradigm. Unlike IQL, which learns exclusively from transitions in the dataset, CQL explicitly constrains policy actions to regions supported by the dataset by penalizing overestimation of Q-values. As a result, its performance is highly sensitive to dataset quality. A similar sensitivity is observed in COFlowNet, which applies conservative regularization to restrict the policy’s behavior to the data distribution’s support.</p>
</div>
<div class="ltx_para" id="A4.SS6.p4">
<p class="ltx_p" id="A4.SS6.p4.1">In contrast, GAIL—when trained on a rebalanced dataset—demonstrates stable performance across datasets. It consistently maintains coverage over all modes and achieves an <span class="ltx_text ltx_font_italic" id="A4.SS6.p4.1.1">Empirical L1 Error</span> slightly above <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A4.SS6.p4.1.m1.1"><semantics id="A4.SS6.p4.1.m1.1a"><mrow id="A4.SS6.p4.1.m1.1.1" xref="A4.SS6.p4.1.m1.1.1.cmml"><mn id="A4.SS6.p4.1.m1.1.1.2" xref="A4.SS6.p4.1.m1.1.1.2.cmml">1</mn><mo id="A4.SS6.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS6.p4.1.m1.1.1.1.cmml">×</mo><msup id="A4.SS6.p4.1.m1.1.1.3" xref="A4.SS6.p4.1.m1.1.1.3.cmml"><mn id="A4.SS6.p4.1.m1.1.1.3.2" xref="A4.SS6.p4.1.m1.1.1.3.2.cmml">10</mn><mrow id="A4.SS6.p4.1.m1.1.1.3.3" xref="A4.SS6.p4.1.m1.1.1.3.3.cmml"><mo id="A4.SS6.p4.1.m1.1.1.3.3a" xref="A4.SS6.p4.1.m1.1.1.3.3.cmml">−</mo><mn id="A4.SS6.p4.1.m1.1.1.3.3.2" xref="A4.SS6.p4.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS6.p4.1.m1.1b"><apply id="A4.SS6.p4.1.m1.1.1.cmml" xref="A4.SS6.p4.1.m1.1.1"><times id="A4.SS6.p4.1.m1.1.1.1.cmml" xref="A4.SS6.p4.1.m1.1.1.1"></times><cn id="A4.SS6.p4.1.m1.1.1.2.cmml" type="integer" xref="A4.SS6.p4.1.m1.1.1.2">1</cn><apply id="A4.SS6.p4.1.m1.1.1.3.cmml" xref="A4.SS6.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS6.p4.1.m1.1.1.3.1.cmml" xref="A4.SS6.p4.1.m1.1.1.3">superscript</csymbol><cn id="A4.SS6.p4.1.m1.1.1.3.2.cmml" type="integer" xref="A4.SS6.p4.1.m1.1.1.3.2">10</cn><apply id="A4.SS6.p4.1.m1.1.1.3.3.cmml" xref="A4.SS6.p4.1.m1.1.1.3.3"><minus id="A4.SS6.p4.1.m1.1.1.3.3.1.cmml" xref="A4.SS6.p4.1.m1.1.1.3.3"></minus><cn id="A4.SS6.p4.1.m1.1.1.3.3.2.cmml" type="integer" xref="A4.SS6.p4.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS6.p4.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A4.SS6.p4.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. Although GAIL performs slightly worse than Behavior Cloning (BC) in scenarios with abundant expert data, it significantly outperforms BC under noisy or sparse data conditions and achieves performance comparable to COFlowNet. These results highlight the benefit of incorporating reward signals from terminal states during training by rebalancing the dataset.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Future Directions</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">While TD-GFN demonstrates strong empirical performance and improved robustness over existing GFlowNet training methods, several limitations remain, suggesting promising directions for future research.</p>
</div>
<div class="ltx_para" id="A5.p2">
<p class="ltx_p" id="A5.p2.1">First, TD-GFN relies on an adversarial approach to estimate edge-level rewards, which can introduce training instability and requires careful hyperparameter tuning. Developing more stable and generalizable techniques for edge reward estimation—potentially drawing on recent advances in inverse reinforcement learning—could enhance the reliability and scalability of the framework.</p>
</div>
<div class="ltx_para" id="A5.p3">
<p class="ltx_p" id="A5.p3.1">Second, the current formulation of TD-GFN assumes a deterministic environment. Extending the method to accommodate stochastic rewards or non-deterministic transitions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2505.20110v1#bib.bib56" title="">56</a>]</cite> is a critical direction, particularly for real-world applications where uncertainty is inherent in both reward evaluation and environment dynamics.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon May 26 13:59:22 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
